/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

@import '../../styles/shared-styles.scss';
@import '../../../../../node_modules/office-ui-fabric-core/dist/sass/References';

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

@import '../../styles/shared-styles.scss';
@import '../../../../../node_modules/office-ui-fabric-core/dist/sass/References';

$task-icon-alignment: var(--task-icon-alignment, flex-start);
$task-icon-background: var(--task-icon-background, transparent);
$task-icon-background-completed: var(--task-icon-background-completed, $ms-color-sharedGreenCyan10);
$task-icon-border: var(--task-icon-border, solid 1px $ms-color-gray120);
$task-icon-border-completed: var(--task-icon-border-completed, solid 1px white);
$task-icon-border-radius: var(--task-icon-border-radius, 50%);
$task-icon-color-completed: var(--task-icon-color-completed, white);
$task-border-completed: var(--task-complete-border, 2px dotted inherit);

:host {
  background-color: var(--neutral-layer-2);
  padding: 12px;

  .Header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-bottom: 14px;

    .Title {
      justify-content: left;
    }

    .NewTaskButton {
      justify-content: right;

      &::part(control) {
        font-weight: 700;
      }
    }
  }

  .Tasks {
    display: flex;
    flex-direction: column;
    row-gap: 20px;

    .Task {
      background-color: var(--neutral-layer-1);
      border-radius: 4px;
      padding: 10px;
      display: flex;
      column-gap: 4px;
      align-items: flex-start;
      justify-content: space-between;

      &.Complete {
        border: $task-border-completed;
      }

      &.Incomplete {
        border: 1px dotted var(--neutral-layer-3);
      }

      .TaskDetailsContainer {
        display: flex;
        flex-direction: column;
        row-gap: 12px;
        width: 100%;

        .Top {
          display: flex;
          justify-content: space-between;
          column-gap: 4px;

          &.AddNewTask {
            flex-direction: row;
          }

          .CheckAndTitle {
            display: flex;
            align-items: flex-start;
            flex-direction: column;
            width: 100%;
            row-gap: 12px;

            .TaskContent {
              display: grid;
              grid-auto-flow: column;
              column-gap: 12px;
            }
          }

          .TaskOptions {
            &.NewTaskActionButtons {
              display: flex;
              flex-direction: column;
              row-gap: 12px;
            }
          }
        }

        .Bottom {
          display: grid;
          grid-auto-flow: column;
          grid-auto-columns: 25%;

          .TaskGroup,
          .TaskBucket,
          .TaskDue {
            display: flex;
            align-items: center;
            gap: 6px;

            .TaskIcon {
              display: flex;
              place-content: center;
            }

            .TaskIconText {
              color: var(--neutral-foreground-hint);
              font-size: 12px;
              font-weight: 600;
              white-space: normal;
            }
          }
        }

        .TaskDetails {
          display: flex;
          flex-direction: column;
          row-gap: 8px;

          .TaskTitle {
            color: var(--foreground-on-neutral-rest);
          }

          .TaskBody {
            display: flex;
          }
        }
      }
    }
  }

  fluent-checkbox {
    padding-top: 1px;

    &::part(control) {
      border-radius: 50%;
    }

    &::part(label) {
      font-size: medium;
      font-weight: 600;
    }

    &.checked {
      &::part(label) {
        text-decoration: line-through;
      }
    }
  }

  fluent-text-field {
    &.NewTask {
      width: 100%;
    }
  }

  mgt-people {
    [slot='no-data'] {
      margin-top: 8px;
    }
  }
}

@media only screen and (max-width: 600px) {
  :host {
    fluent-select {
      width: 100%;
    }

    .Tasks {
      .Task {
        .TaskDetailsContainer {
          .Bottom {
            display: grid;
            grid-auto-flow: row;
            grid-auto-columns: unset;
            row-gap: 4px;

            .TaskGroup,
            .TaskBucket,
            .TaskDue {
              margin-inline-start: 8px;
            }
          }

          .Top {
            &.AddNewTask {
              flex-direction: column;
              row-gap: 12px;

              .CheckAndTitle {
                .TaskContent {
                  display: grid;
                  grid-auto-flow: row;
                  row-gap: 12px;
                  width: 100%;
                }
              }

              .TaskOptions {
                &.NewTaskActionButtons {
                  flex-direction: row;
                  column-gap: 4px;
                }
              }
            }
          }
        }
      }
    }
  }
}
