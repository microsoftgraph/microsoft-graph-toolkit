/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

@import '../../../../../node_modules/office-ui-fabric-core/dist/sass/References';
@import '../../styles/shared-styles';
@import './mgt-teams-channel-picker.theme';

:host,
:host mgt-teams-channel-picker {
  font-family: $font-family;

  .container {
    display: flex;
    flex-direction: column;
  }

  .dropdown {
    z-index: 1;
    display: none;
    margin-top: 4px;

    &.visible {
      display: flex;
    }

    .team {
      &-photo {
        width: 24px;
        position: inherit;
        border-radius: 50%;
        margin: 0 6px;
      }

      &-start-slot {
        width: max-content;
      }

      &-parent-name {
        width: auto;
      }
    }
  }

  .search-error-text,
  .loading-text {
    font-family: $font-family;
    font-style: normal;
    font-weight: 400;
    font-size: 14px;
    line-height: 20px;
  }

  .message-parent {
    display: flex;
    flex-direction: row;
    gap: 5px;
    padding: 5px;

    .loading-text {
      color: $channel-picker-loading-text-color;
      margin: auto;
    }
  }
}

:host {
  fluent-card {
    --fill-color: var(--channel-picker-dropdown-background-color, --fill-color);
    --card-height: auto;
    --width: var(--card-width);
  }

  fluent-text-field {
    width: 100%;
    --fill-color: var(--channel-picker-color, $color);
    --neutral-fill-input-rest: var(--channel-picker-input-background-color, #ffffff);
    --input-placeholder-rest: var(--channel-picker-placeholder-color, --input-placeholder-rest);
    --input-placeholder-hover: var(--channel-picker-placeholder-color--focus, --input-placeholder-hover);
  }

  fluent-tree-view {
    min-width: 100%;

    --tree-item-nested-width: 2em;
  }

  fluent-tree-item {
    --tree-item-nested-width: 2em;
    --neutral-foreground-rest: var(--channel-picker-color, $color);
    --neutral-fill-stealth-hover: var(--channel-picker-dropdown-item-hover-background, --neutral-fill-stealth-hover);
    --neutral-fill-secondary-rest: var(--channel-picker-dropdown-item-selected-background, --neutral-fill-secondary-rest);
    --neutral-fill-stealth-rest: var(--channel-picker-dropdown-background-color, --neutral-fill-stealth-rest);
  }

  fluent-breadcrumb-item {
    .team-parent-name {
      font-weight: bold;
    }

    .team-photo {
      width: 19px;
      position: inherit;
      border-radius: 50%;
    }

    .arrow {
      margin-left: 8px;
      margin-right: 8px;

      svg {
        stroke: $channel-picker-arrow-fill-color;
      }
    }
  }

}

[dir='rtl'] {
  :host {
    --direction: rtl;
  }

  .dropdown {
    text-align: right;
  }

  .arrow {
    transform: scaleX(-1);
    filter: fliph;
    filter: 'FlipH';
    margin-right: 0;
    margin-left: 5px;
  }

  .selected-team {
    padding-left: 10px;
  }

  .message-parent {
    .loading-text {
      right: auto;
      left: 10px;
      padding-right: 8px;
      text-align: right;
    }
  }
}

@media (forced-colors: active) and (prefers-color-scheme: dark) {
  :host fluent-text-field {
    svg {
      stroke: rgb(255 255 255) !important;
    }
  }
}

@media (forced-colors: active) and (prefers-color-scheme: light) {
  :host fluent-text-field {
    svg {
      stroke: rgb(0 0 0) !important;
    }
  }
}