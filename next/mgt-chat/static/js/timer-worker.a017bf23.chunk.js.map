{"version":3,"file":"static/js/timer-worker.a017bf23.chunk.js","mappings":"yBAAe,SAASA,EAAQC,GAG9B,OAAOD,EAAU,mBAAqBE,QAAU,iBAAmBA,OAAOC,SAAW,SAAUF,GAC7F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAK,mBAAqBC,QAAUD,EAAEG,cAAgBF,QAAUD,IAAMC,OAAOG,UAAY,gBAAkBJ,CACpH,EAAGD,EAAQC,EACb,CCNe,SAASK,EAAcC,GACpC,IAAIC,ECFS,SAAqBD,EAAGE,GACrC,GAAI,UAAYT,EAAQO,KAAOA,EAAG,OAAOA,EACzC,IAAIG,EAAIH,EAAEL,OAAOS,aACjB,QAAI,IAAWD,EAAG,CAChB,IAAIF,EAAIE,EAAEE,KAAKL,EAAGE,GAAK,WACvB,GAAI,UAAYT,EAAQQ,GAAI,OAAOA,EACnC,MAAM,IAAIK,UAAU,+CACtB,CACA,OAAQ,WAAaJ,EAAIK,OAASC,QAAQR,EAC5C,CDPUI,CAAYJ,EAAG,UACvB,MAAO,UAAYP,EAAQQ,GAAKA,EAAIM,OAAON,EAC7C,CEJA,SAASQ,EAAQN,EAAGD,GAClB,IAAIF,EAAIU,OAAOC,KAAKR,GACpB,GAAIO,OAAOE,sBAAuB,CAChC,IAAIlB,EAAIgB,OAAOE,sBAAsBT,GACrCD,IAAMR,EAAIA,EAAEmB,QAAO,SAAUX,GAC3B,OAAOQ,OAAOI,yBAAyBX,EAAGD,GAAGa,UAC/C,KAAKf,EAAEgB,KAAKC,MAAMjB,EAAGN,EACvB,CACA,OAAOM,CACT,CACe,SAASkB,EAAef,GACrC,IAAK,IAAID,EAAI,EAAGA,EAAIiB,UAAUC,OAAQlB,IAAK,CACzC,IAAIF,EAAI,MAAQmB,UAAUjB,GAAKiB,UAAUjB,GAAK,CAAC,EAC/CA,EAAI,EAAIO,EAAQC,OAAOV,IAAI,GAAIqB,SAAQ,SAAUnB,GCbtC,IAAyBoB,EAAKC,EAAKC,EAAVF,EDcnBnB,ECdwBoB,EDcrBrB,ECd0BsB,EDcvBxB,EAAEE,ICb3BqB,EAAMxB,EAAcwB,MACTD,EACTZ,OAAOe,eAAeH,EAAKC,EAAK,CAC9BC,MAAOA,EACPT,YAAY,EACZW,cAAc,EACdC,UAAU,IAGZL,EAAIC,GAAOC,CDKX,IAAKd,OAAOkB,0BAA4BlB,OAAOmB,iBAAiB1B,EAAGO,OAAOkB,0BAA0B5B,IAAMS,EAAQC,OAAOV,IAAIqB,SAAQ,SAAUnB,GAC7IQ,OAAOe,eAAetB,EAAGD,EAAGQ,OAAOI,yBAAyBd,EAAGE,GACjE,GACF,CACA,OAAOC,CACT,CEfA,IAAM2B,EAA+BC,KAE/BC,EAAY,IAAIC,IAEtBH,EAAII,UAAY,SAAC/B,GACf,IAAMgC,EAAOhC,EAAEiC,MAAM,GAgCrBD,EAAKE,UA/BiB,SAACC,GACrB,IAAMC,EAAkBD,EAAMC,KACxBC,EAAQD,EAAKC,MACbC,EAAQF,EAAKG,GACnB,OAAQH,EAAKI,MACX,IAAK,cACH,IAAMC,EAAWC,aAAY,WAC3B,IAAMC,EAAOC,EAAAA,EAAA,GAAmBT,EAAMC,MAAS,CAAEI,KAAM,gBACvDR,EAAKa,YAAYF,EACnB,GAAGN,GACHR,EAAUiB,IAAIR,EAAOG,GACrB,MAEF,IAAK,aACH,IAAMM,EAAUC,YAAW,WACzB,IAAML,EAAOC,EAAAA,EAAA,GAAmBT,EAAMC,MAAS,CAAEI,KAAM,gBACvDR,EAAKa,YAAYF,EACnB,GAAGN,GACHR,EAAUiB,IAAIR,EAAOS,GACrB,MAEF,IAAK,eACHE,aAAapB,EAAUqB,IAAIZ,IAC3BT,EAAUsB,OAAOb,GACjB,MAEF,IAAK,gBACHc,cAAcvB,EAAUqB,IAAIZ,IAC5BT,EAAUsB,OAAOb,GAEvB,CAEF,C","sources":["../../../node_modules/@babel/runtime/helpers/esm/typeof.js","../../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../packages/mgt-chat/src/utils/timerWorker.ts"],"sourcesContent":["export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nexport default function _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","export interface TimerWork {\n  id: string;\n  type: 'clearInterval' | 'setInterval' | 'runCallback' | 'setTimeout' | 'clearTimeout';\n  delay?: number;\n}\n\nconst ctx: SharedWorkerGlobalScope = self as unknown as SharedWorkerGlobalScope;\n\nconst intervals = new Map<string, number>();\n\nctx.onconnect = (e: MessageEvent<unknown>) => {\n  const port = e.ports[0];\n  const handleMessage = (event: MessageEvent<TimerWork>) => {\n    const data: TimerWork = event.data;\n    const delay = data.delay;\n    const jobId = data.id;\n    switch (data.type) {\n      case 'setInterval': {\n        const interval = setInterval(() => {\n          const message: TimerWork = { ...event.data, ...{ type: 'runCallback' } };\n          port.postMessage(message);\n        }, delay);\n        intervals.set(jobId, interval);\n        break;\n      }\n      case 'setTimeout': {\n        const timeout = setTimeout(() => {\n          const message: TimerWork = { ...event.data, ...{ type: 'runCallback' } };\n          port.postMessage(message);\n        }, delay);\n        intervals.set(jobId, timeout);\n        break;\n      }\n      case 'clearTimeout': {\n        clearTimeout(intervals.get(jobId));\n        intervals.delete(jobId);\n        break;\n      }\n      case 'clearInterval':\n        clearInterval(intervals.get(jobId));\n        intervals.delete(jobId);\n    }\n  };\n  port.onmessage = handleMessage;\n};\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","TypeError","String","Number","ownKeys","Object","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","arguments","length","forEach","obj","key","value","defineProperty","configurable","writable","getOwnPropertyDescriptors","defineProperties","ctx","self","intervals","Map","onconnect","port","ports","onmessage","event","data","delay","jobId","id","type","interval","setInterval","message","_objectSpread","postMessage","set","timeout","setTimeout","clearTimeout","get","delete","clearInterval"],"sourceRoot":""}