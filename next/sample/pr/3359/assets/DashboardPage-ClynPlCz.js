import{_ as ut,p as z,b as Ne,a as Me,r as oe,j as p,R as re}from"./index-BMz1tdeA.js";import{P as ft}from"./PageHeader-DNsB96wQ.js";import{e as Pe,O as L,S as pt,D as j,H as mt,a as kt,_ as u,b as m,n as ye,F as Q,k as we,c as Ue,d as Ge,f as me,g as ke,o as k,h as gt,i as vt,j as qe,l as Ke,m as x,p as bt,q as yt,s as wt,r as xt,t as Ct,u as Tt,v as Dt,A as $t,x as Ie,y as q,z as Qe,B as It,C as Rt,E as Re,G as _t,I as Ft,J as le,K as de,L as Bt,M as ce,N as Ot,P as _e,Q as Et,R as he,T as St,U as Lt,V as jt,W as At,X as Ht,Y as W,Z as Vt,$ as g,a0 as We,a1 as Ye,a2 as I,a3 as zt,a4 as J,a5 as X,a6 as ee,a7 as ue,a8 as Nt,a9 as Mt,w as Pt,aa as Ut,ab as K,ac as Gt,ad as Ze,ae as Je,af as ge,ag as qt,ah as Kt,ai as ne,aj as Xe,ak as xe,al as Qt,am as Wt,an as et,ao as Yt,ap as Zt,aq as Jt,ar as Xt,as as Fe}from"./App-DLomwBpO.js";import{G as es}from"./get-Beq8lczP.js";import{e as H,a as V,b as Be,c as Oe,O as tt,g as ts,D as ss,d as as,f as Ee,h as is,i as ns,j as os,k as te,T as se,S as ae}from"./DataGridHeaderCell-CFvi2v3Z.js";import{c as Se}from"./repeat-BDqLl10X.js";import{r as rs}from"./mgt-picker-BSu6RBWc.js";import{D as ls}from"./index-CA0kCsOp.js";import{f as ds,a as cs}from"./index-B99G2udP.js";import"./mgt-get-1TvcCzn7.js";function $(a,e,t){return{index:a,removed:e,addedCount:t}}const st=0,at=1,ve=2,be=3;function hs(a,e,t,s,i,n){const o=n-i+1,l=t-e+1,r=new Array(o);let h,c;for(let d=0;d<o;++d)r[d]=new Array(l),r[d][0]=d;for(let d=0;d<l;++d)r[0][d]=d;for(let d=1;d<o;++d)for(let f=1;f<l;++f)a[e+f-1]===s[i+d-1]?r[d][f]=r[d-1][f-1]:(h=r[d-1][f]+1,c=r[d][f-1]+1,r[d][f]=h<c?h:c);return r}function us(a){let e=a.length-1,t=a[0].length-1,s=a[e][t];const i=[];for(;e>0||t>0;){if(e===0){i.push(ve),t--;continue}if(t===0){i.push(be),e--;continue}const n=a[e-1][t-1],o=a[e-1][t],l=a[e][t-1];let r;o<l?r=o<n?o:n:r=l<n?l:n,r===n?(n===s?i.push(st):(i.push(at),s=n),e--,t--):r===o?(i.push(be),e--,s=o):(i.push(ve),t--,s=l)}return i.reverse(),i}function fs(a,e,t){for(let s=0;s<t;++s)if(a[s]!==e[s])return s;return t}function ps(a,e,t){let s=a.length,i=e.length,n=0;for(;n<t&&a[--s]===e[--i];)n++;return n}function ms(a,e,t,s){return e<t||s<a?-1:e===t||s===a?0:a<t?e<s?e-t:s-t:s<e?s-a:e-a}function it(a,e,t,s,i,n){let o=0,l=0;const r=Math.min(t-e,n-i);if(e===0&&i===0&&(o=fs(a,s,r)),t===a.length&&n===s.length&&(l=ps(a,s,r-o)),e+=o,i+=o,t-=l,n-=l,t-e===0&&n-i===0)return Pe;if(e===t){const D=$(e,[],0);for(;i<n;)D.removed.push(s[i++]);return[D]}else if(i===n)return[$(e,[],t-e)];const h=us(hs(a,e,t,s,i,n)),c=[];let d,f=e,v=i;for(let D=0;D<h.length;++D)switch(h[D]){case st:d!==void 0&&(c.push(d),d=void 0),f++,v++;break;case at:d===void 0&&(d=$(f,[],0)),d.addedCount++,f++,d.removed.push(s[v]),v++;break;case ve:d===void 0&&(d=$(f,[],0)),d.addedCount++,f++;break;case be:d===void 0&&(d=$(f,[],0)),d.removed.push(s[v]),v++;break}return d!==void 0&&c.push(d),c}const Le=Array.prototype.push;function ks(a,e,t,s){const i=$(e,t,s);let n=!1,o=0;for(let l=0;l<a.length;l++){const r=a[l];if(r.index+=o,n)continue;const h=ms(i.index,i.index+i.removed.length,r.index,r.index+r.addedCount);if(h>=0){a.splice(l,1),l--,o-=r.addedCount-r.removed.length,i.addedCount+=r.addedCount-h;const c=i.removed.length+r.removed.length-h;if(!i.addedCount&&!c)n=!0;else{let d=r.removed;if(i.index<r.index){const f=i.removed.slice(0,r.index-i.index);Le.apply(f,d),d=f}if(i.index+i.removed.length>r.index+r.addedCount){const f=i.removed.slice(r.index+r.addedCount-i.index);Le.apply(d,f)}i.removed=d,r.index<i.index&&(i.index=r.index)}}else if(i.index<r.index){n=!0,a.splice(l,0,i),l++;const c=i.addedCount-i.removed.length;r.index+=c,o+=c}}n||a.push(i)}function gs(a){const e=[];for(let t=0,s=a.length;t<s;t++){const i=a[t];ks(e,i.index,i.removed,i.addedCount)}return e}function vs(a,e){let t=[];const s=gs(e);for(let i=0,n=s.length;i<n;++i){const o=s[i];if(o.addedCount===1&&o.removed.length===1){o.removed[0]!==a[o.index]&&t.push(o);continue}t=t.concat(it(a,o.index,o.index+o.addedCount,o.removed,0,o.removed.length))}return t}let je=!1;function fe(a,e){let t=a.index;const s=e.length;return t>s?t=s-a.addedCount:t<0&&(t=s+a.removed.length+t-a.addedCount),t<0&&(t=0),a.index=t,a}class bs extends pt{constructor(e){super(e),this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this.call=this.flush,Reflect.defineProperty(e,"$fastController",{value:this,enumerable:!1})}subscribe(e){this.flush(),super.subscribe(e)}addSplice(e){this.splices===void 0?this.splices=[e]:this.splices.push(e),this.needsQueue&&(this.needsQueue=!1,j.queueUpdate(this))}reset(e){this.oldCollection=e,this.needsQueue&&(this.needsQueue=!1,j.queueUpdate(this))}flush(){const e=this.splices,t=this.oldCollection;if(e===void 0&&t===void 0)return;this.needsQueue=!0,this.splices=void 0,this.oldCollection=void 0;const s=t===void 0?vs(this.source,e):it(this.source,0,this.source.length,t,0,t.length);this.notify(s)}}function ys(){if(je)return;je=!0,L.setArrayObserverFactory(r=>new bs(r));const a=Array.prototype;if(a.$fastPatch)return;Reflect.defineProperty(a,"$fastPatch",{value:1,enumerable:!1});const e=a.pop,t=a.push,s=a.reverse,i=a.shift,n=a.sort,o=a.splice,l=a.unshift;a.pop=function(){const r=this.length>0,h=e.apply(this,arguments),c=this.$fastController;return c!==void 0&&r&&c.addSplice($(this.length,[h],0)),h},a.push=function(){const r=t.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(fe($(this.length-arguments.length,[],arguments.length),this)),r},a.reverse=function(){let r;const h=this.$fastController;h!==void 0&&(h.flush(),r=this.slice());const c=s.apply(this,arguments);return h!==void 0&&h.reset(r),c},a.shift=function(){const r=this.length>0,h=i.apply(this,arguments),c=this.$fastController;return c!==void 0&&r&&c.addSplice($(0,[h],0)),h},a.sort=function(){let r;const h=this.$fastController;h!==void 0&&(h.flush(),r=this.slice());const c=n.apply(this,arguments);return h!==void 0&&h.reset(r),c},a.splice=function(){const r=o.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(fe($(+arguments[0],r,arguments.length>2?arguments.length-2:0),this)),r},a.unshift=function(){const r=l.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(fe($(0,[],arguments.length),this)),r}}const Ae=Object.freeze({positioning:!1,recycle:!0});function ws(a,e,t,s){a.bind(e[t],s)}function xs(a,e,t,s){const i=Object.create(s);i.index=t,i.length=e.length,a.bind(e[t],i)}class Cs{constructor(e,t,s,i,n,o){this.location=e,this.itemsBinding=t,this.templateBinding=i,this.options=o,this.source=null,this.views=[],this.items=null,this.itemsObserver=null,this.originalContext=void 0,this.childContext=void 0,this.bindView=ws,this.itemsBindingObserver=L.binding(t,this,s),this.templateBindingObserver=L.binding(i,this,n),o.positioning&&(this.bindView=xs)}bind(e,t){this.source=e,this.originalContext=t,this.childContext=Object.create(t),this.childContext.parent=e,this.childContext.parentContext=this.originalContext,this.items=this.itemsBindingObserver.observe(e,this.originalContext),this.template=this.templateBindingObserver.observe(e,this.originalContext),this.observeItems(!0),this.refreshAllViews()}unbind(){this.source=null,this.items=null,this.itemsObserver!==null&&this.itemsObserver.unsubscribe(this),this.unbindAllViews(),this.itemsBindingObserver.disconnect(),this.templateBindingObserver.disconnect()}handleChange(e,t){e===this.itemsBinding?(this.items=this.itemsBindingObserver.observe(this.source,this.originalContext),this.observeItems(),this.refreshAllViews()):e===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.originalContext),this.refreshAllViews(!0)):this.updateViews(t)}observeItems(e=!1){if(!this.items){this.items=Pe;return}const t=this.itemsObserver,s=this.itemsObserver=L.getNotifier(this.items),i=t!==s;i&&t!==null&&t.unsubscribe(this),(i||e)&&s.subscribe(this)}updateViews(e){const t=this.childContext,s=this.views,i=this.bindView,n=this.items,o=this.template,l=this.options.recycle,r=[];let h=0,c=0;for(let d=0,f=e.length;d<f;++d){const v=e[d],D=v.removed;let w=0,B=v.index;const dt=B+v.addedCount,U=s.splice(v.index,D.length),ct=c=r.length+U.length;for(;B<dt;++B){const $e=s[B],ht=$e?$e.firstChild:this.location;let S;l&&c>0?(w<=ct&&U.length>0?(S=U[w],w++):(S=r[h],h++),c--):S=o.create(),s.splice(B,0,S),i(S,n,B,t),S.insertBefore(ht)}U[w]&&r.push(...U.slice(w))}for(let d=h,f=r.length;d<f;++d)r[d].dispose();if(this.options.positioning)for(let d=0,f=s.length;d<f;++d){const v=s[d].context;v.length=f,v.index=d}}refreshAllViews(e=!1){const t=this.items,s=this.childContext,i=this.template,n=this.location,o=this.bindView;let l=t.length,r=this.views,h=r.length;if((l===0||e||!this.options.recycle)&&(kt.disposeContiguousBatch(r),h=0),h===0){this.views=r=new Array(l);for(let c=0;c<l;++c){const d=i.create();o(d,t,c,s),r[c]=d,d.insertBefore(n)}}else{let c=0;for(;c<l;++c)if(c<h){const f=r[c];o(f,t,c,s)}else{const f=i.create();o(f,t,c,s),r.push(f),f.insertBefore(n)}const d=r.splice(c,h-c);for(c=0,l=d.length;c<l;++c)d[c].dispose()}}unbindAllViews(){const e=this.views;for(let t=0,s=e.length;t<s;++t)e[t].unbind()}}class Ce extends mt{constructor(e,t,s){super(),this.itemsBinding=e,this.templateBinding=t,this.options=s,this.createPlaceholder=j.createBlockPlaceholder,ys(),this.isItemsBindingVolatile=L.isVolatileBinding(e),this.isTemplateBindingVolatile=L.isVolatileBinding(t)}createBehavior(e){return new Cs(e,this.itemsBinding,this.isItemsBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile,this.options)}}function A(a,e,t=Ae){const s=typeof e=="function"?e:()=>e;return new Ce(a,s,Object.assign(Object.assign({},Ae),t))}class Ts{constructor(e){if(this.dayFormat="numeric",this.weekdayFormat="long",this.monthFormat="long",this.yearFormat="numeric",this.date=new Date,e)for(const t in e){const s=e[t];t==="date"?this.date=this.getDateObject(s):this[t]=s}}getDateObject(e){if(typeof e=="string"){const t=e.split(/[/-]/);return t.length<3?new Date:new Date(parseInt(t[2],10),parseInt(t[0],10)-1,parseInt(t[1],10))}else if("day"in e&&"month"in e&&"year"in e){const{day:t,month:s,year:i}=e;return new Date(i,s-1,t)}return e}getDate(e=this.date,t={weekday:this.weekdayFormat,month:this.monthFormat,day:this.dayFormat,year:this.yearFormat},s=this.locale){const i=this.getDateObject(e);if(!i.getTime())return"";const n=Object.assign({timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},t);return new Intl.DateTimeFormat(s,n).format(i)}getDay(e=this.date.getDate(),t=this.dayFormat,s=this.locale){return this.getDate({month:1,day:e,year:2020},{day:t},s)}getMonth(e=this.date.getMonth()+1,t=this.monthFormat,s=this.locale){return this.getDate({month:e,day:2,year:2020},{month:t},s)}getYear(e=this.date.getFullYear(),t=this.yearFormat,s=this.locale){return this.getDate({month:2,day:2,year:e},{year:t},s)}getWeekday(e=0,t=this.weekdayFormat,s=this.locale){const i=`1-${e+1}-2017`;return this.getDate(i,{weekday:t},s)}getWeekdays(e=this.weekdayFormat,t=this.locale){return Array(7).fill(null).map((s,i)=>this.getWeekday(i,e,t))}}let C=class extends Q{constructor(){super(...arguments),this.dateFormatter=new Ts,this.readonly=!1,this.locale="en-US",this.month=new Date().getMonth()+1,this.year=new Date().getFullYear(),this.dayFormat="numeric",this.weekdayFormat="short",this.monthFormat="long",this.yearFormat="numeric",this.minWeeks=0,this.disabledDates="",this.selectedDates="",this.oneDayInMs=864e5}localeChanged(){this.dateFormatter.locale=this.locale}dayFormatChanged(){this.dateFormatter.dayFormat=this.dayFormat}weekdayFormatChanged(){this.dateFormatter.weekdayFormat=this.weekdayFormat}monthFormatChanged(){this.dateFormatter.monthFormat=this.monthFormat}yearFormatChanged(){this.dateFormatter.yearFormat=this.yearFormat}getMonthInfo(e=this.month,t=this.year){const s=r=>new Date(r.getFullYear(),r.getMonth(),1).getDay(),i=r=>{const h=new Date(r.getFullYear(),r.getMonth()+1,1);return new Date(h.getTime()-this.oneDayInMs).getDate()},n=new Date(t,e-1),o=new Date(t,e),l=new Date(t,e-2);return{length:i(n),month:e,start:s(n),year:t,previous:{length:i(l),month:l.getMonth()+1,start:s(l),year:l.getFullYear()},next:{length:i(o),month:o.getMonth()+1,start:s(o),year:o.getFullYear()}}}getDays(e=this.getMonthInfo(),t=this.minWeeks){t=t>10?10:t;const{start:s,length:i,previous:n,next:o}=e,l=[];let r=1-s;for(;r<i+1||l.length<t||l[l.length-1].length%7!==0;){const{month:h,year:c}=r<1?n:r>i?o:e,d=r<1?n.length+r:r>i?r-i:r,f=`${h}-${d}-${c}`,v=this.dateInString(f,this.disabledDates),D=this.dateInString(f,this.selectedDates),w={day:d,month:h,year:c,disabled:v,selected:D},B=l[l.length-1];l.length===0||B.length%7===0?l.push([w]):B.push(w),r++}return l}dateInString(e,t){const s=t.split(",").map(i=>i.trim());return e=typeof e=="string"?e:`${e.getMonth()+1}-${e.getDate()}-${e.getFullYear()}`,s.some(i=>i===e)}getDayClassNames(e,t){const{day:s,month:i,year:n,disabled:o,selected:l}=e,r=t===`${i}-${s}-${n}`,h=this.month!==i;return["day",r&&"today",h&&"inactive",o&&"disabled",l&&"selected"].filter(Boolean).join(" ")}getWeekdayText(){const e=this.dateFormatter.getWeekdays().map(t=>({text:t}));if(this.weekdayFormat!=="long"){const t=this.dateFormatter.getWeekdays("long");e.forEach((s,i)=>{s.abbr=t[i]})}return e}handleDateSelect(e,t){e.preventDefault,this.$emit("dateselected",t)}handleKeydown(e,t){return e.key===we&&this.handleDateSelect(e,t),!0}};u([m({mode:"boolean"})],C.prototype,"readonly",void 0);u([m],C.prototype,"locale",void 0);u([m({converter:ye})],C.prototype,"month",void 0);u([m({converter:ye})],C.prototype,"year",void 0);u([m({attribute:"day-format",mode:"fromView"})],C.prototype,"dayFormat",void 0);u([m({attribute:"weekday-format",mode:"fromView"})],C.prototype,"weekdayFormat",void 0);u([m({attribute:"month-format",mode:"fromView"})],C.prototype,"monthFormat",void 0);u([m({attribute:"year-format",mode:"fromView"})],C.prototype,"yearFormat",void 0);u([m({attribute:"min-weeks",converter:ye})],C.prototype,"minWeeks",void 0);u([m({attribute:"disabled-dates"})],C.prototype,"disabledDates",void 0);u([m({attribute:"selected-dates"})],C.prototype,"selectedDates",void 0);const ie={none:"none",default:"default",sticky:"sticky"},O={default:"default",columnHeader:"columnheader",rowHeader:"rowheader"},G={default:"default",header:"header",stickyHeader:"sticky-header"};class y extends Q{constructor(){super(...arguments),this.rowType=G.default,this.rowData=null,this.columnDefinitions=null,this.isActiveRow=!1,this.cellsRepeatBehavior=null,this.cellsPlaceholder=null,this.focusColumnIndex=0,this.refocusOnLoad=!1,this.updateRowStyle=()=>{this.style.gridTemplateColumns=this.gridTemplateColumns}}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowStyle()}rowTypeChanged(){this.$fastController.isConnected&&this.updateItemTemplate()}rowDataChanged(){if(this.rowData!==null&&this.isActiveRow){this.refocusOnLoad=!0;return}}cellItemTemplateChanged(){this.updateItemTemplate()}headerCellItemTemplateChanged(){this.updateItemTemplate()}connectedCallback(){super.connectedCallback(),this.cellsRepeatBehavior===null&&(this.cellsPlaceholder=document.createComment(""),this.appendChild(this.cellsPlaceholder),this.updateItemTemplate(),this.cellsRepeatBehavior=new Ce(e=>e.columnDefinitions,e=>e.activeCellItemTemplate,{positioning:!0}).createBehavior(this.cellsPlaceholder),this.$fastController.addBehaviors([this.cellsRepeatBehavior])),this.addEventListener("cell-focused",this.handleCellFocus),this.addEventListener(H,this.handleFocusout),this.addEventListener(V,this.handleKeydown),this.updateRowStyle(),this.refocusOnLoad&&(this.refocusOnLoad=!1,this.cellElements.length>this.focusColumnIndex&&this.cellElements[this.focusColumnIndex].focus())}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("cell-focused",this.handleCellFocus),this.removeEventListener(H,this.handleFocusout),this.removeEventListener(V,this.handleKeydown)}handleFocusout(e){this.contains(e.target)||(this.isActiveRow=!1,this.focusColumnIndex=0)}handleCellFocus(e){this.isActiveRow=!0,this.focusColumnIndex=this.cellElements.indexOf(e.target),this.$emit("row-focused",this)}handleKeydown(e){if(e.defaultPrevented)return;let t=0;switch(e.key){case ke:t=Math.max(0,this.focusColumnIndex-1),this.cellElements[t].focus(),e.preventDefault();break;case me:t=Math.min(this.cellElements.length-1,this.focusColumnIndex+1),this.cellElements[t].focus(),e.preventDefault();break;case Ge:e.ctrlKey||(this.cellElements[0].focus(),e.preventDefault());break;case Ue:e.ctrlKey||(this.cellElements[this.cellElements.length-1].focus(),e.preventDefault());break}}updateItemTemplate(){this.activeCellItemTemplate=this.rowType===G.default&&this.cellItemTemplate!==void 0?this.cellItemTemplate:this.rowType===G.default&&this.cellItemTemplate===void 0?this.defaultCellItemTemplate:this.headerCellItemTemplate!==void 0?this.headerCellItemTemplate:this.defaultHeaderCellItemTemplate}}u([m({attribute:"grid-template-columns"})],y.prototype,"gridTemplateColumns",void 0);u([m({attribute:"row-type"})],y.prototype,"rowType",void 0);u([k],y.prototype,"rowData",void 0);u([k],y.prototype,"columnDefinitions",void 0);u([k],y.prototype,"cellItemTemplate",void 0);u([k],y.prototype,"headerCellItemTemplate",void 0);u([k],y.prototype,"rowIndex",void 0);u([k],y.prototype,"isActiveRow",void 0);u([k],y.prototype,"activeCellItemTemplate",void 0);u([k],y.prototype,"defaultCellItemTemplate",void 0);u([k],y.prototype,"defaultHeaderCellItemTemplate",void 0);u([k],y.prototype,"cellElements",void 0);class b extends Q{constructor(){super(),this.noTabbing=!1,this.generateHeader=ie.default,this.rowsData=[],this.columnDefinitions=null,this.focusRowIndex=0,this.focusColumnIndex=0,this.rowsPlaceholder=null,this.generatedHeader=null,this.isUpdatingFocus=!1,this.pendingFocusUpdate=!1,this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!0,this.generatedGridTemplateColumns="",this.focusOnCell=(e,t,s)=>{if(this.rowElements.length===0){this.focusRowIndex=0,this.focusColumnIndex=0;return}const i=Math.max(0,Math.min(this.rowElements.length-1,e)),o=this.rowElements[i].querySelectorAll('[role="cell"], [role="gridcell"], [role="columnheader"], [role="rowheader"]'),l=Math.max(0,Math.min(o.length-1,t)),r=o[l];s&&this.scrollHeight!==this.clientHeight&&(i<this.focusRowIndex&&this.scrollTop>0||i>this.focusRowIndex&&this.scrollTop<this.scrollHeight-this.clientHeight)&&r.scrollIntoView({block:"center",inline:"center"}),r.focus()},this.onChildListChange=(e,t)=>{e&&e.length&&(e.forEach(s=>{s.addedNodes.forEach(i=>{i.nodeType===1&&i.getAttribute("role")==="row"&&(i.columnDefinitions=this.columnDefinitions)})}),this.queueRowIndexUpdate())},this.queueRowIndexUpdate=()=>{this.rowindexUpdateQueued||(this.rowindexUpdateQueued=!0,j.queueUpdate(this.updateRowIndexes))},this.updateRowIndexes=()=>{let e=this.gridTemplateColumns;if(e===void 0){if(this.generatedGridTemplateColumns===""&&this.rowElements.length>0){const t=this.rowElements[0];this.generatedGridTemplateColumns=new Array(t.cellElements.length).fill("1fr").join(" ")}e=this.generatedGridTemplateColumns}this.rowElements.forEach((t,s)=>{const i=t;i.rowIndex=s,i.gridTemplateColumns=e,this.columnDefinitionsStale&&(i.columnDefinitions=this.columnDefinitions)}),this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!1}}static generateTemplateColumns(e){let t="";return e.forEach(s=>{t=`${t}${t===""?"":" "}1fr`}),t}noTabbingChanged(){this.$fastController.isConnected&&(this.noTabbing?this.setAttribute("tabIndex","-1"):this.setAttribute("tabIndex",this.contains(document.activeElement)||this===document.activeElement?"-1":"0"))}generateHeaderChanged(){this.$fastController.isConnected&&this.toggleGeneratedHeader()}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowIndexes()}rowsDataChanged(){this.columnDefinitions===null&&this.rowsData.length>0&&(this.columnDefinitions=b.generateColumns(this.rowsData[0])),this.$fastController.isConnected&&this.toggleGeneratedHeader()}columnDefinitionsChanged(){if(this.columnDefinitions===null){this.generatedGridTemplateColumns="";return}this.generatedGridTemplateColumns=b.generateTemplateColumns(this.columnDefinitions),this.$fastController.isConnected&&(this.columnDefinitionsStale=!0,this.queueRowIndexUpdate())}headerCellItemTemplateChanged(){this.$fastController.isConnected&&this.generatedHeader!==null&&(this.generatedHeader.headerCellItemTemplate=this.headerCellItemTemplate)}focusRowIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}focusColumnIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}connectedCallback(){super.connectedCallback(),this.rowItemTemplate===void 0&&(this.rowItemTemplate=this.defaultRowItemTemplate),this.rowsPlaceholder=document.createComment(""),this.appendChild(this.rowsPlaceholder),this.toggleGeneratedHeader(),this.rowsRepeatBehavior=new Ce(e=>e.rowsData,e=>e.rowItemTemplate,{positioning:!0}).createBehavior(this.rowsPlaceholder),this.$fastController.addBehaviors([this.rowsRepeatBehavior]),this.addEventListener("row-focused",this.handleRowFocus),this.addEventListener(Be,this.handleFocus),this.addEventListener(V,this.handleKeydown),this.addEventListener(H,this.handleFocusOut),this.observer=new MutationObserver(this.onChildListChange),this.observer.observe(this,{childList:!0}),this.noTabbing&&this.setAttribute("tabindex","-1"),j.queueUpdate(this.queueRowIndexUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("row-focused",this.handleRowFocus),this.removeEventListener(Be,this.handleFocus),this.removeEventListener(V,this.handleKeydown),this.removeEventListener(H,this.handleFocusOut),this.observer.disconnect(),this.rowsPlaceholder=null,this.generatedHeader=null}handleRowFocus(e){this.isUpdatingFocus=!0;const t=e.target;this.focusRowIndex=this.rowElements.indexOf(t),this.focusColumnIndex=t.focusColumnIndex,this.setAttribute("tabIndex","-1"),this.isUpdatingFocus=!1}handleFocus(e){this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}handleFocusOut(e){(e.relatedTarget===null||!this.contains(e.relatedTarget))&&this.setAttribute("tabIndex",this.noTabbing?"-1":"0")}handleKeydown(e){if(e.defaultPrevented)return;let t;const s=this.rowElements.length-1,i=this.offsetHeight+this.scrollTop,n=this.rowElements[s];switch(e.key){case Ke:e.preventDefault(),this.focusOnCell(this.focusRowIndex-1,this.focusColumnIndex,!0);break;case qe:e.preventDefault(),this.focusOnCell(this.focusRowIndex+1,this.focusColumnIndex,!0);break;case vt:if(e.preventDefault(),this.rowElements.length===0){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex===0){this.focusOnCell(0,this.focusColumnIndex,!1);return}for(t=this.focusRowIndex-1,t;t>=0;t--){const o=this.rowElements[t];if(o.offsetTop<this.scrollTop){this.scrollTop=o.offsetTop+o.clientHeight-this.clientHeight;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case gt:if(e.preventDefault(),this.rowElements.length===0){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex>=s||n.offsetTop+n.offsetHeight<=i){this.focusOnCell(s,this.focusColumnIndex,!1);return}for(t=this.focusRowIndex+1,t;t<=s;t++){const o=this.rowElements[t];if(o.offsetTop+o.offsetHeight>i){let l=0;this.generateHeader===ie.sticky&&this.generatedHeader!==null&&(l=this.generatedHeader.clientHeight),this.scrollTop=o.offsetTop-l;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case Ge:e.ctrlKey&&(e.preventDefault(),this.focusOnCell(0,0,!0));break;case Ue:e.ctrlKey&&this.columnDefinitions!==null&&(e.preventDefault(),this.focusOnCell(this.rowElements.length-1,this.columnDefinitions.length-1,!0));break}}queueFocusUpdate(){this.isUpdatingFocus&&(this.contains(document.activeElement)||this===document.activeElement)||this.pendingFocusUpdate===!1&&(this.pendingFocusUpdate=!0,j.queueUpdate(()=>this.updateFocus()))}updateFocus(){this.pendingFocusUpdate=!1,this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}toggleGeneratedHeader(){if(this.generatedHeader!==null&&(this.removeChild(this.generatedHeader),this.generatedHeader=null),this.generateHeader!==ie.none&&this.rowsData.length>0){const e=document.createElement(this.rowElementTag);this.generatedHeader=e,this.generatedHeader.columnDefinitions=this.columnDefinitions,this.generatedHeader.gridTemplateColumns=this.gridTemplateColumns,this.generatedHeader.rowType=this.generateHeader===ie.sticky?G.stickyHeader:G.header,(this.firstChild!==null||this.rowsPlaceholder!==null)&&this.insertBefore(e,this.firstChild!==null?this.firstChild:this.rowsPlaceholder);return}}}b.generateColumns=a=>Object.getOwnPropertyNames(a).map((e,t)=>({columnDataKey:e,gridColumn:`${t}`}));u([m({attribute:"no-tabbing",mode:"boolean"})],b.prototype,"noTabbing",void 0);u([m({attribute:"generate-header"})],b.prototype,"generateHeader",void 0);u([m({attribute:"grid-template-columns"})],b.prototype,"gridTemplateColumns",void 0);u([k],b.prototype,"rowsData",void 0);u([k],b.prototype,"columnDefinitions",void 0);u([k],b.prototype,"rowItemTemplate",void 0);u([k],b.prototype,"cellItemTemplate",void 0);u([k],b.prototype,"headerCellItemTemplate",void 0);u([k],b.prototype,"focusRowIndex",void 0);u([k],b.prototype,"focusColumnIndex",void 0);u([k],b.prototype,"defaultRowItemTemplate",void 0);u([k],b.prototype,"rowElementTag",void 0);u([k],b.prototype,"rowElements",void 0);const Ds=x`
    <template>
        ${a=>a.rowData===null||a.columnDefinition===null||a.columnDefinition.columnDataKey===null?null:a.rowData[a.columnDefinition.columnDataKey]}
    </template>
`,$s=x`
    <template>
        ${a=>a.columnDefinition===null?null:a.columnDefinition.title===void 0?a.columnDefinition.columnDataKey:a.columnDefinition.title}
    </template>
`;class N extends Q{constructor(){super(...arguments),this.cellType=O.default,this.rowData=null,this.columnDefinition=null,this.isActiveCell=!1,this.customCellView=null,this.updateCellStyle=()=>{this.style.gridColumn=this.gridColumn}}cellTypeChanged(){this.$fastController.isConnected&&this.updateCellView()}gridColumnChanged(){this.$fastController.isConnected&&this.updateCellStyle()}columnDefinitionChanged(e,t){this.$fastController.isConnected&&this.updateCellView()}connectedCallback(){var e;super.connectedCallback(),this.addEventListener(Oe,this.handleFocusin),this.addEventListener(H,this.handleFocusout),this.addEventListener(V,this.handleKeydown),this.style.gridColumn=`${((e=this.columnDefinition)===null||e===void 0?void 0:e.gridColumn)===void 0?0:this.columnDefinition.gridColumn}`,this.updateCellView(),this.updateCellStyle()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(Oe,this.handleFocusin),this.removeEventListener(H,this.handleFocusout),this.removeEventListener(V,this.handleKeydown),this.disconnectCellView()}handleFocusin(e){if(!this.isActiveCell){switch(this.isActiveCell=!0,this.cellType){case O.columnHeader:if(this.columnDefinition!==null&&this.columnDefinition.headerCellInternalFocusQueue!==!0&&typeof this.columnDefinition.headerCellFocusTargetCallback=="function"){const t=this.columnDefinition.headerCellFocusTargetCallback(this);t!==null&&t.focus()}break;default:if(this.columnDefinition!==null&&this.columnDefinition.cellInternalFocusQueue!==!0&&typeof this.columnDefinition.cellFocusTargetCallback=="function"){const t=this.columnDefinition.cellFocusTargetCallback(this);t!==null&&t.focus()}break}this.$emit("cell-focused",this)}}handleFocusout(e){this!==document.activeElement&&!this.contains(document.activeElement)&&(this.isActiveCell=!1)}handleKeydown(e){if(!(e.defaultPrevented||this.columnDefinition===null||this.cellType===O.default&&this.columnDefinition.cellInternalFocusQueue!==!0||this.cellType===O.columnHeader&&this.columnDefinition.headerCellInternalFocusQueue!==!0))switch(e.key){case we:case yt:if(this.contains(document.activeElement)&&document.activeElement!==this)return;switch(this.cellType){case O.columnHeader:if(this.columnDefinition.headerCellFocusTargetCallback!==void 0){const t=this.columnDefinition.headerCellFocusTargetCallback(this);t!==null&&t.focus(),e.preventDefault()}break;default:if(this.columnDefinition.cellFocusTargetCallback!==void 0){const t=this.columnDefinition.cellFocusTargetCallback(this);t!==null&&t.focus(),e.preventDefault()}break}break;case bt:this.contains(document.activeElement)&&document.activeElement!==this&&(this.focus(),e.preventDefault());break}}updateCellView(){if(this.disconnectCellView(),this.columnDefinition!==null)switch(this.cellType){case O.columnHeader:this.columnDefinition.headerCellTemplate!==void 0?this.customCellView=this.columnDefinition.headerCellTemplate.render(this,this):this.customCellView=$s.render(this,this);break;case void 0:case O.rowHeader:case O.default:this.columnDefinition.cellTemplate!==void 0?this.customCellView=this.columnDefinition.cellTemplate.render(this,this):this.customCellView=Ds.render(this,this);break}}disconnectCellView(){this.customCellView!==null&&(this.customCellView.dispose(),this.customCellView=null)}}u([m({attribute:"cell-type"})],N.prototype,"cellType",void 0);u([m({attribute:"grid-column"})],N.prototype,"gridColumn",void 0);u([k],N.prototype,"rowData",void 0);u([k],N.prototype,"columnDefinition",void 0);const Is=x`
    <div
        class="title"
        part="title"
        aria-label="${a=>a.dateFormatter.getDate(`${a.month}-2-${a.year}`,{month:"long",year:"numeric"})}"
    >
        <span part="month">
            ${a=>a.dateFormatter.getMonth(a.month)}
        </span>
        <span part="year">${a=>a.dateFormatter.getYear(a.year)}</span>
    </div>
`,Rs=a=>{const e=a.tagFor(N);return x`
        <${e}
            class="week-day"
            part="week-day"
            tabindex="-1"
            grid-column="${(t,s)=>s.index+1}"
            abbr="${t=>t.abbr}"
        >
            ${t=>t.text}
        </${e}>
    `},_s=(a,e)=>{const t=a.tagFor(N);return x`
        <${t}
            class="${(s,i)=>i.parentContext.parent.getDayClassNames(s,e)}"
            part="day"
            tabindex="-1"
            role="gridcell"
            grid-column="${(s,i)=>i.index+1}"
            @click="${(s,i)=>i.parentContext.parent.handleDateSelect(i.event,s)}"
            @keydown="${(s,i)=>i.parentContext.parent.handleKeydown(i.event,s)}"
            aria-label="${(s,i)=>i.parentContext.parent.dateFormatter.getDate(`${s.month}-${s.day}-${s.year}`,{month:"long",day:"numeric"})}"
        >
            <div
                class="date"
                part="${s=>e===`${s.month}-${s.day}-${s.year}`?"today":"date"}"
            >
                ${(s,i)=>i.parentContext.parent.dateFormatter.getDay(s.day)}
            </div>
            <slot name="${s=>s.month}-${s=>s.day}-${s=>s.year}"></slot>
        </${t}>
    `},Fs=(a,e)=>{const t=a.tagFor(y);return x`
        <${t}
            class="week"
            part="week"
            role="row"
            role-type="default"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
        ${A(s=>s,_s(a,e),{positioning:!0})}
        </${t}>
    `},Bs=(a,e)=>{const t=a.tagFor(b),s=a.tagFor(y);return x`
    <${t} class="days interact" part="days" generate-header="none">
        <${s}
            class="week-days"
            part="week-days"
            role="row"
            row-type="header"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
            ${A(i=>i.getWeekdayText(),Rs(a),{positioning:!0})}
        </${s}>
        ${A(i=>i.getDays(),Fs(a,e))}
    </${t}>
`},Os=a=>x`
        <div class="days" part="days">
            <div class="week-days" part="week-days">
                ${A(e=>e.getWeekdayText(),x`
                        <div class="week-day" part="week-day" abbr="${e=>e.abbr}">
                            ${e=>e.text}
                        </div>
                    `)}
            </div>
            ${A(e=>e.getDays(),x`
                    <div class="week">
                        ${A(e=>e,x`
                                <div
                                    class="${(e,t)=>t.parentContext.parent.getDayClassNames(e,a)}"
                                    part="day"
                                    aria-label="${(e,t)=>t.parentContext.parent.dateFormatter.getDate(`${e.month}-${e.day}-${e.year}`,{month:"long",day:"numeric"})}"
                                >
                                    <div
                                        class="date"
                                        part="${e=>a===`${e.month}-${e.day}-${e.year}`?"today":"date"}"
                                    >
                                        ${(e,t)=>t.parentContext.parent.dateFormatter.getDay(e.day)}
                                    </div>
                                    <slot
                                        name="${e=>e.month}-${e=>e.day}-${e=>e.year}"
                                    ></slot>
                                </div>
                            `)}
                    </div>
                `)}
        </div>
    `,Es=(a,e)=>{var t;const s=new Date,i=`${s.getMonth()+1}-${s.getDate()}-${s.getFullYear()}`;return x`
        <template>
            ${wt}
            ${e.title instanceof Function?e.title(a,e):(t=e.title)!==null&&t!==void 0?t:""}
            <slot></slot>
            ${xt(n=>n.readonly,Os(i),Bs(a,i))}
            ${Ct}
        </template>
    `},Ss=(a,e)=>x`
    <template
        role="radiogroup"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        @click="${(t,s)=>t.clickHandler(s.event)}"
        @keydown="${(t,s)=>t.keydownHandler(s.event)}"
        @focusout="${(t,s)=>t.focusOutHandler(s.event)}"
    >
        <slot name="label"></slot>
        <div
            class="positioning-region ${t=>t.orientation===tt.horizontal?"horizontal":"vertical"}"
            part="positioning-region"
        >
            <slot
                ${Tt({property:"slottedRadioButtons",filter:Dt("[role=radio]")})}
            ></slot>
        </div>
    </template>
`;class E extends Q{constructor(){super(...arguments),this.orientation=tt.horizontal,this.radioChangeHandler=e=>{const t=e.target;t.checked&&(this.slottedRadioButtons.forEach(s=>{s!==t&&(s.checked=!1,this.isInsideFoundationToolbar||s.setAttribute("tabindex","-1"))}),this.selectedRadio=t,this.value=t.value,t.setAttribute("tabindex","0"),this.focusedRadio=t),e.stopPropagation()},this.moveToRadioByIndex=(e,t)=>{const s=e[t];this.isInsideToolbar||(s.setAttribute("tabindex","0"),s.readOnly?this.slottedRadioButtons.forEach(i=>{i!==s&&i.setAttribute("tabindex","-1")}):(s.checked=!0,this.selectedRadio=s)),this.focusedRadio=s,s.focus()},this.moveRightOffGroup=()=>{var e;(e=this.nextElementSibling)===null||e===void 0||e.focus()},this.moveLeftOffGroup=()=>{var e;(e=this.previousElementSibling)===null||e===void 0||e.focus()},this.focusOutHandler=e=>{const t=this.slottedRadioButtons,s=e.target,i=s!==null?t.indexOf(s):0,n=this.focusedRadio?t.indexOf(this.focusedRadio):-1;return(n===0&&i===n||n===t.length-1&&n===i)&&(this.selectedRadio?(this.focusedRadio=this.selectedRadio,this.isInsideFoundationToolbar||(this.selectedRadio.setAttribute("tabindex","0"),t.forEach(o=>{o!==this.selectedRadio&&o.setAttribute("tabindex","-1")}))):(this.focusedRadio=t[0],this.focusedRadio.setAttribute("tabindex","0"),t.forEach(o=>{o!==this.focusedRadio&&o.setAttribute("tabindex","-1")}))),!0},this.clickHandler=e=>{const t=e.target;if(t){const s=this.slottedRadioButtons;t.checked||s.indexOf(t)===0?(t.setAttribute("tabindex","0"),this.selectedRadio=t):(t.setAttribute("tabindex","-1"),this.selectedRadio=null),this.focusedRadio=t}e.preventDefault()},this.shouldMoveOffGroupToTheRight=(e,t,s)=>e===t.length&&this.isInsideToolbar&&s===me,this.shouldMoveOffGroupToTheLeft=(e,t)=>(this.focusedRadio?e.indexOf(this.focusedRadio)-1:0)<0&&this.isInsideToolbar&&t===ke,this.checkFocusedRadio=()=>{this.focusedRadio!==null&&!this.focusedRadio.readOnly&&!this.focusedRadio.checked&&(this.focusedRadio.checked=!0,this.focusedRadio.setAttribute("tabindex","0"),this.focusedRadio.focus(),this.selectedRadio=this.focusedRadio)},this.moveRight=e=>{const t=this.slottedRadioButtons;let s=0;if(s=this.focusedRadio?t.indexOf(this.focusedRadio)+1:1,this.shouldMoveOffGroupToTheRight(s,t,e.key)){this.moveRightOffGroup();return}else s===t.length&&(s=0);for(;s<t.length&&t.length>1;)if(t[s].disabled){if(this.focusedRadio&&s===t.indexOf(this.focusedRadio))break;if(s+1>=t.length){if(this.isInsideToolbar)break;s=0}else s+=1}else{this.moveToRadioByIndex(t,s);break}},this.moveLeft=e=>{const t=this.slottedRadioButtons;let s=0;if(s=this.focusedRadio?t.indexOf(this.focusedRadio)-1:0,s=s<0?t.length-1:s,this.shouldMoveOffGroupToTheLeft(t,e.key)){this.moveLeftOffGroup();return}for(;s>=0&&t.length>1;)if(t[s].disabled){if(this.focusedRadio&&s===t.indexOf(this.focusedRadio))break;s-1<0?s=t.length-1:s-=1}else{this.moveToRadioByIndex(t,s);break}},this.keydownHandler=e=>{const t=e.key;if(t in $t&&this.isInsideFoundationToolbar)return!0;switch(t){case we:{this.checkFocusedRadio();break}case me:case qe:{this.direction===Ie.ltr?this.moveRight(e):this.moveLeft(e);break}case ke:case Ke:{this.direction===Ie.ltr?this.moveLeft(e):this.moveRight(e);break}default:return!0}}}readOnlyChanged(){this.slottedRadioButtons!==void 0&&this.slottedRadioButtons.forEach(e=>{this.readOnly?e.readOnly=!0:e.readOnly=!1})}disabledChanged(){this.slottedRadioButtons!==void 0&&this.slottedRadioButtons.forEach(e=>{this.disabled?e.disabled=!0:e.disabled=!1})}nameChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach(e=>{e.setAttribute("name",this.name)})}valueChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach(e=>{e.value===this.value&&(e.checked=!0,this.selectedRadio=e)}),this.$emit("change")}slottedRadioButtonsChanged(e,t){this.slottedRadioButtons&&this.slottedRadioButtons.length>0&&this.setupRadioButtons()}get parentToolbar(){return this.closest('[role="toolbar"]')}get isInsideToolbar(){var e;return(e=this.parentToolbar)!==null&&e!==void 0?e:!1}get isInsideFoundationToolbar(){var e;return!!(!((e=this.parentToolbar)===null||e===void 0)&&e.$fastController)}connectedCallback(){super.connectedCallback(),this.direction=ts(this),this.setupRadioButtons()}disconnectedCallback(){this.slottedRadioButtons.forEach(e=>{e.removeEventListener("change",this.radioChangeHandler)})}setupRadioButtons(){const e=this.slottedRadioButtons.filter(i=>i.hasAttribute("checked")),t=e?e.length:0;if(t>1){const i=e[t-1];i.checked=!0}let s=!1;if(this.slottedRadioButtons.forEach(i=>{this.name!==void 0&&i.setAttribute("name",this.name),this.disabled&&(i.disabled=!0),this.readOnly&&(i.readOnly=!0),this.value&&this.value===i.value?(this.selectedRadio=i,this.focusedRadio=i,i.checked=!0,i.setAttribute("tabindex","0"),s=!0):(this.isInsideFoundationToolbar||i.setAttribute("tabindex","-1"),i.checked=!1),i.addEventListener("change",this.radioChangeHandler)}),this.value===void 0&&this.slottedRadioButtons.length>0){const i=this.slottedRadioButtons.filter(o=>o.hasAttribute("checked")),n=i!==null?i.length:0;if(n>0&&!s){const o=i[n-1];o.checked=!0,this.focusedRadio=o,o.setAttribute("tabindex","0")}else this.slottedRadioButtons[0].setAttribute("tabindex","0"),this.focusedRadio=this.slottedRadioButtons[0]}}}u([m({attribute:"readonly",mode:"boolean"})],E.prototype,"readOnly",void 0);u([m({attribute:"disabled",mode:"boolean"})],E.prototype,"disabled",void 0);u([m],E.prototype,"name",void 0);u([m],E.prototype,"value",void 0);u([m],E.prototype,"orientation",void 0);u([k],E.prototype,"childItems",void 0);u([k],E.prototype,"slottedRadioButtons",void 0);const Ls=q`
.day.disabled::before {
  transform: translate(-50%, 0) rotate(45deg);
}
`,js=q`
.day.disabled::before {
  transform: translate(50%, 0) rotate(-45deg);
}
`,As=(a,e)=>q`
${Qe("inline-block")} :host {
  --calendar-cell-size: calc((${It} + 2 + ${Rt}) * ${Re} * 1px);
  --calendar-gap: 2px;
  ${_t}
  color: ${Ft};
}

.title {
  padding: calc(${Re} * 2px);
  font-weight: 600;
}

.days {
  text-align: center;
}

.week-days,
.week {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  grid-gap: var(--calendar-gap);
  border: 0;
  padding: 0;
}

.day,
.week-day {
  border: 0;
  width: var(--calendar-cell-size);
  height: var(--calendar-cell-size);
  line-height: var(--calendar-cell-size);
  padding: 0;
  box-sizing: initial;
}

.week-day {
  font-weight: 600;
}

.day {
  border: calc(${le} * 1px) solid transparent;
  border-radius: calc(${de} * 1px);
}

.interact .day {
  cursor: pointer;
}

.date {
  height: 100%;
}

.inactive .date,
.inactive.disabled::before {
  color: ${Bt};
}

.disabled::before {
  content: '';
  display: inline-block;
  width: calc(var(--calendar-cell-size) * .8);
  height: calc(${le} * 1px);
  background: currentColor;
  position: absolute;
  margin-top: calc(var(--calendar-cell-size) / 2);
  transform-origin: center;
  z-index: 1;
}

.selected {
  color: ${ce};
  border: 1px solid ${ce};
  background: ${Ot};
}

.selected + .selected {
  border-start-start-radius: 0;
  border-end-start-radius: 0;
  border-inline-start-width: 0;
  padding-inline-start: calc(var(--calendar-gap) + (${le} + ${de}) * 1px);
  margin-inline-start: calc((${de} * -1px) - var(--calendar-gap));
}

.today.disabled::before {
  color: ${_e};
}

.today .date {
  color: ${_e};
  background: ${ce};
  border-radius: 50%;
  position: relative;
}
`.withBehaviors(Et(q`
          .day.selected {
              color: ${he.Highlight};
          }

          .today .date {
              background: ${he.Highlight};
              color: ${he.HighlightText};
          }
      `),new ls(Ls,js));class nt extends C{constructor(){super(...arguments),this.readonly=!0}}ut([m({converter:St})],nt.prototype,"readonly",void 0);const Hs=nt.compose({baseName:"calendar",template:Es,styles:As,title:Is}),Vs=(a,e)=>q`
  ${Qe("flex")} :host {
    align-items: flex-start;
    flex-direction: column;
  }

  .positioning-region {
    display: flex;
    flex-wrap: wrap;
  }

  :host([orientation='vertical']) .positioning-region {
    flex-direction: column;
  }

  :host([orientation='horizontal']) .positioning-region {
    flex-direction: row;
  }
`,zs=E.compose({baseName:"radio-group",template:Ss,styles:Vs}),Ns=a=>{const e=Lt.getValueFor(a);return jt(At.create(e,e,e))};var M=function(a,e,t,s){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(c){try{h(s.next(c))}catch(d){o(d)}}function r(c){try{h(s.throw(c))}catch(d){o(d)}}function h(c){c.done?n(c.value):i(c.value).then(l,r)}h((s=s.apply(a,e||[])).next())})};const Te=["Tasks.ReadWrite"],De=["Tasks.Read","Tasks.ReadWrite"],pe=(a,e)=>M(void 0,void 0,void 0,function*(){const t=yield a.api(`/me/todo/lists/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(z(De)).get();return t==null?void 0:t.value}),Ms=a=>M(void 0,void 0,void 0,function*(){const e=yield a.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(z(De)).get();return e==null?void 0:e.value}),He=(a,e)=>M(void 0,void 0,void 0,function*(){return yield a.api(`/me/todo/lists/${e}`).header("Cache-Control","no-store").middlewareOptions(z(De)).get()}),Ps=(a,e,t)=>M(void 0,void 0,void 0,function*(){return yield a.api(`/me/todo/lists/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(z(Te)).post(t)}),Us=(a,e,t)=>M(void 0,void 0,void 0,function*(){yield a.api(`/me/todo/lists/${e}/tasks/${t}`).header("Cache-Control","no-store").middlewareOptions(z(Te)).delete()}),Ve=(a,e,t,s)=>M(void 0,void 0,void 0,function*(){return yield a.api(`/me/todo/lists/${e}/tasks/${t}`).header("Cache-Control","no-store").middlewareOptions(z(Te)).patch(s)}),Gs=[Ht`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{display:flex;flex-direction:column;color:var(--color,var(--neutral-foreground-rest))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;appearance:none}:host .task-icon{font-family:FabricMDL2Icons;user-select:none}:host .task-icon.divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .header{margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .header select{font-size:var(--tasks-plan-title-font-size, 1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;appearance:none;cursor:pointer}:host .header select::-ms-expand{display:none}:host .header .plan-title{font-size:var(--tasks-plan-title-font-size, 1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .header .add-bar{display:flex}:host .header .add-bar .add-bar-item{flex:1 1 auto}:host .header .new-task-due{display:flex}:host .header .new-task-due input{flex:1 1 auto;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .header .title-cont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .header .new-task-button{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;cursor:pointer}:host .header .new-task-button span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .header .new-task-button .task-icon{margin-right:8px}:host .header .new-task-button.hidden{visibility:hidden}:host .header .new-task-button:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .header .new-task-button:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .task{position:relative;margin:var(--task-margin,0 0 0 0);padding:var(--task-padding,0 0 0 0);background-color:var(--task-background-color,var(--neutral-layer-floating));border:var(--task-border,var(--neutral-stroke-input-active));border-radius:8px}:host .task .task-content{display:flex}:host .task .task-content .divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-content .task-details-container{flex:1;display:grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .task .task-content .task-details-container .task-detail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .task .task-content .task-details-container .task-title{color:var(--task-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;grid-row:1;grid-column:1/3;grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .task .task-content .task-details-container .task-group{min-height:24px;grid-row:2;grid-column:1}:host .task .task-content .task-details-container .task-bucket{min-height:24px;grid-row:2;grid-column:2}:host .task .task-content .task-details-container .task-due{justify-content:flex-end;align-items:flex-start;grid-row:4;grid-column:1/3;grid-column:1;-ms-grid-column-span:2}:host .task .task-content .task-details-container.tablet{grid-template-columns:1fr 0.5fr 1fr 0.5fr;-ms-grid-columns:1fr 0.5fr 1fr 0.5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .task .task-content .task-details-container.tablet.no-plan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .task .task-content .task-details-container.tablet .task-detail{margin:4px 24px 6px 0}:host .task .task-content .task-details-container.tablet .task-title{grid-row:1;grid-column:1/5;grid-column:1;-ms-grid-column-span:4}:host .task .task-content .task-details-container.tablet .task-group{grid-row:2;grid-column:1}:host .task .task-content .task-details-container.tablet .task-bucket{grid-row:2;grid-column:2}:host .task .task-content .task-details-container.tablet .task-assignee{grid-row:2;grid-column:3}:host .task .task-content .task-details-container.tablet .task-due{justify-content:flex-start;align-items:center;grid-row:2;grid-column:4}:host .task .task-content .task-details-container.desktop{grid-template-columns:2fr 1fr 0.5fr 1fr 0.5fr;-ms-grid-columns:2fr 1fr 0.5fr 1fr 0.5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .task .task-content .task-details-container.desktop.no-plan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .task .task-content .task-details-container.desktop .task-detail{margin:0 24px 0 0}:host .task .task-content .task-details-container.desktop .task-title{padding:0;grid-row:1;grid-column:1}:host .task .task-content .task-details-container.desktop .task-group{min-height:61px;grid-row:1;grid-column:2}:host .task .task-content .task-details-container.desktop .task-bucket{grid-row:1;grid-column:3}:host .task .task-content .task-details-container.desktop .task-assignee{grid-row:1;grid-column:4}:host .task .task-content .task-details-container.desktop .task-due{justify-content:flex-start;align-items:center;grid-row:1;grid-column:5}:host .task .task-content .task-details-container svg{vertical-align:middle;margin-right:4px}:host .task .task-content .task-details-container svg path{fill:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container select,:host .task .task-content .task-details-container span{vertical-align:middle;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .task-icon{color:#797775;margin-right:8px}:host .task .task-content .task-details-container .people{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:16px}:host .task .task-content .task-details-container .person{display:inline-block}:host .task .task-content .task-details-container .picker{background-color:var(--task-background-color,var(--neutral-layer-floating));background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .task .task-content .task-details-container input,:host .task .task-content .task-details-container select{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:.9em;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-check-container{font-family:FabricMDL2Icons;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none}:host .task .task-check-container.complete .task-check{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .task .task-check-container.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-check-container .task-check{font-family:FabricMDL2Icons;font-size:12px;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-color,var(--neutral-foreground-rest));display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none}:host .task .task-check-container .task-check.loading .task-check-content{animation:rotate-icon 2s infinite linear}:host .task .task-options{cursor:pointer;user-select:none;margin:16px 8px 0 0}:host .task.read-only .task-check-container{cursor:default}:host .task.complete{background:var(--task-complete-background,var(--neutral-layer-1));border:var(--task-complete-border,2px dotted inherit)}:host .task.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task.new-task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .task.new-task .self-assign{display:none}:host .task.new-task .assign-to{border:0;background:0 0}:host .task.new-task .fake-check-box{width:15px;height:15px;cursor:pointer;margin:0 5px}:host .task.new-task .fake-check-box::after{font-family:FabricMDL2Icons;content:"uE739"}:host .task.new-task .fake-check-box~:checked{font-family:FabricMDL2Icons;content:"uE73A"}:host .task.new-task .task-content{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .task.new-task .task-content .task-details-container{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .task.new-task .task-content .task-details-container .task-title{display:flex;height:32px;padding:2px}:host .task.new-task .task-content .task-details-container .task-title input{flex:1;margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size, 14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task .task-content .task-details-container .task-title input:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-title input:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-title input:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-content .task-details-container .task-details{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .task.new-task .task-content .task-details-container .task-details .new-task-group{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-bucket{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-due{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-assignee{margin:8px 16px;min-width:80px}:host .task.new-task .task-content .task-details-container .task-details .task-people label{display:flex;align-content:center;align-items:center}:host .task.new-task .task-content .task-details-container .task-details input,:host .task.new-task .task-content .task-details-container .task-details select{font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .task.new-task .task-content .task-details-container .task-details input:hover,:host .task.new-task .task-content .task-details-container .task-details select:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-details input:active,:host .task.new-task .task-content .task-details-container .task-details select:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-details input:focus,:host .task.new-task .task-content .task-details-container .task-details select:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-add-button-container{margin-right:28px}:host .task.new-task .task-add-button-container .task-add,:host .task.new-task .task-add-button-container .task-cancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-size:14px;line-height:20px}:host .task.new-task .task-add-button-container .task-add{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .task.new-task .task-add-button-container .task-cancel{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest))}:host .task.new-task .task-add-button-container.disabled .task-add{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}@keyframes rotate-icon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translatex:translateX(60px)}[dir=rtl] .task-details{margin-right:14px!important}[dir=rtl] .task-icon{margin-left:8px}[dir=rtl] .task-detail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px;width:100%}:host .task,:host.loading-task{margin-block:1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active));width:100%;display:flex;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task,:host.loading-task.new-task{margin:14px 0 1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active))}:host .task.complete,:host.loading-task.complete{border:1px solid var(--task-border-completed,var(--neutral-stroke-input-active));background:var(--task-complete-background,var(--neutral-layer-1))}:host .task.complete .task-details .task-due,:host .task.complete .task-details .title,:host.loading-task.complete .task-details .task-due,:host.loading-task.complete .task-details .title{text-decoration:line-through}:host .task.read-only,:host.loading-task.read-only{opacity:1}:host .task:hover,:host.loading-task:hover{background-color:var(--task-background-color-hover,var(--neutral-fill-hover));border-radius:8px}:host .task .task-details,:host.loading-task .task-details{box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:2px;line-height:24px;border-radius:4px;width:100%}:host .task .task-details .task>div,:host.loading-task .task-details .task>div{display:flex;align-items:center;width:200px}:host .task .task-details .task-delete,:host.loading-task .task-details .task-delete{display:flex}:host .task .task-details .container,:host.loading-task .task-details .container{display:flex;width:100%}:host .task .task-details .task-due,:host.loading-task .task-details .task-due{min-width:120px;margin-inline-end:12px;height:32px;text-decoration:inherit;display:flex}:host fluent-text-field::part(end),:host fluent-text-field::part(start){margin-inline:unset}:host fluent-text-field::part(control){padding:0;cursor:pointer}:host fluent-text-field::part(root){background:0 0}:host fluent-text-field.new-task{width:100%;height:34px}:host fluent-text-field.new-task div.start .add-icon{display:flex;margin-inline:10px}:host fluent-text-field.new-task div:nth-child(2){display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar{display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar .date{margin-inline-start:10px;color:var(--task-color,var(--neutral-foreground-rest));width:auto;cursor:pointer}:host fluent-text-field.new-task div:nth-child(2) .calendar input{flex:1;border:none;border-bottom:1px solid var(--task-color,var(--neutral-foreground-rest));outline:0;border-radius:0}:host fluent-text-field.new-task div:nth-child(2) .calendar input:hover{border-bottom:1px solid var(--task-date-input-hover-color,var(--neutral-layer-1))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:active,:host fluent-text-field.new-task div:nth-child(2) .calendar input:focus{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-text-field.title{flex-grow:1;display:inline}:host fluent-text-field.date{color:var(--task-detail-color,var(--neutral-foreground-hint))}:host fluent-text-field::after{border-bottom:none}:host fluent-text-field.dark::part(control){color-scheme:dark}:host fluent-button.task-add-icon.neutral,:host fluent-button.task-cancel-icon.neutral,:host fluent-button.task-delete.neutral{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-button.task-add-icon.neutral::part(control),:host fluent-button.task-cancel-icon.neutral::part(control),:host fluent-button.task-delete.neutral::part(control){border:none;background:inherit}:host fluent-button.task-add-icon.neutral::part(control) svg,:host fluent-button.task-cancel-icon.neutral::part(control) svg,:host fluent-button.task-delete.neutral::part(control) svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-checkbox.complete div>svg .filled{display:block}:host fluent-checkbox.complete div>svg .regular{display:none}:host fluent-checkbox.complete div>svg path{fill:var(--task-radio-background-color,var(--accent-fill-rest))}:host fluent-checkbox div>svg .filled{display:none}:host fluent-checkbox div>svg .regular{display:block}:host fluent-checkbox div>svg path{fill:var(--task-background-color,var(--neutral-layer-floating))}:host fluent-checkbox::part(control){margin-inline-start:10px;background:0 0;border-radius:50%}:host fluent-checkbox::part(label){margin-inline-end:unset;width:100%}
`],qs={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",newTaskLabel:"New Task Input",editTaskLabel:"Edit Task Input",addTaskButtonSubtitle:"Add",deleteTaskOption:"Delete",editTaskOption:"Edit",dueDate:"Due date",newTaskDateInputLabel:"New Task Date Input",changeTaskDateInputLabel:"Change Task Date Input",newTaskNameInputLabel:"New Task Name Input",cancelAddingTask:"Cancel adding a new task"},Ks={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var Y=function(a,e,t,s){var i=arguments.length,n=i<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(a,e,t,s);else for(var l=a.length-1;l>=0;l--)(o=a[l])&&(n=(i<3?o(n):i>3?o(e,t,n):o(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Z=function(a,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,e)};class P extends Vt{get strings(){return Ks}constructor(){super(),this.renderLoading=()=>this.renderLoadingTask(),this.renderContent=()=>{const e=Ne.globalProvider;if(!e||e.state!==Me.SignedIn)return g``;const t=this.renderPicker(),s=this.renderNewTask(),i=this.renderTasks();return g`
      ${t}
      ${s}
      <div class="tasks" dir=${this.direction}>
        ${i}
      </div>
    `},this.handleTaskClick=e=>{this.fireCustomEvent("taskClick",{task:e})},this.onResize=()=>{this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())},We(ds,Ye,Hs),this.clearState(),this._previousMediaQuery=this.mediaQuery}args(){return[this.providerState,this.targetId,this.initialId]}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}renderLoadingTask(){return g`
      <div class="task loading-task">
        <div class="task-details">
          <div class="title"></div>
          <div class="task-due"></div>
          <div class="task-delete"></div>
        </div>
      </div>
    `}clearState(){this.requestUpdate()}dateToInputValue(e){return e?new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().split("T")[0]:null}}Y([W({attribute:"read-only",type:Boolean}),Z("design:type",Boolean)],P.prototype,"readOnly",void 0);Y([W({attribute:"hide-header",type:Boolean}),Z("design:type",Boolean)],P.prototype,"hideHeader",void 0);Y([W({attribute:"hide-options",type:Boolean}),Z("design:type",Boolean)],P.prototype,"hideOptions",void 0);Y([W({attribute:"target-id",type:String}),Z("design:type",String)],P.prototype,"targetId",void 0);Y([W({attribute:"initial-id",type:String}),Z("design:type",String)],P.prototype,"initialId",void 0);var R=function(a,e,t,s){var i=arguments.length,n=i<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(a,e,t,s);else for(var l=a.length-1;l>=0;l--)(o=a[l])&&(n=(i<3?o(n):i>3?o(e,t,n):o(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},_=function(a,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,e)},F=function(a,e,t,s){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(c){try{h(s.next(c))}catch(d){o(d)}}function r(c){try{h(s.throw(c))}catch(d){o(d)}}function h(c){c.done?n(c.value):i(c.value).then(l,r)}h((s=s.apply(a,e||[])).next())})};const Qs=()=>{We(cs,zs,Ye),rs(),zt("todo",T)};class T extends P{static get styles(){return Gs}get strings(){return qs}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}constructor(){super(),this._isChangedDueDate=!1,this._isDarkMode=!1,this.onThemeChanged=()=>{this._isDarkMode=Ns(this)},this.renderNewTask=()=>{const e=this._newTaskName?g`
        <fluent-checkbox
          class="task-add-icon"
          @click="${this.addTask}">
        </fluent-checkbox>
      `:g`
        <span class="add-icon">${J(X.Add)}</span>
      `,t=g`
      <fluent-button
        aria-label=${this.strings.cancelAddingTask}
        class="task-cancel-icon" 
        @click="${this.clearNewTaskData}"
      >
        ${J(X.Cancel)}
      </fluent-button>
    `,s={dark:this._isDarkMode,date:!0},i=g`
      <fluent-text-field
        autocomplete="off"
        type="date"
        id="new-taskDate-input"
        class="${ee(s)}"
        aria-label="${this.strings.newTaskDateInputLabel}"
        .value="${this.dateToInputValue(this._newTaskDueDate)}"
        @change="${this.handleDateChange}"
      >
      </fluent-text-field>
    `,n=this.readOnly?ue:g`
      <fluent-text-field
        autocomplete="off"
        appearance="outline"
        class="new-task"
        id="new-task-name-input"
        aria-label="${this.strings.newTaskLabel}"
        .value=${this._newTaskName}
        placeholder="${this.strings.newTaskPlaceholder}"
        @keydown="${this.handleKeyDown}"
        @input="${this.handleInput}"
      >
        <div slot="start" class="start">${e}</div>
        ${this._newTaskName?g`
              <div slot="end" class="end">
                <span class="calendar">${i}</span>
                ${t}
              </div> `:g``}
      </fluent-text-field>
    `;return g`
      ${this.currentList?g`
            <div dir=${this.direction} class="task new-task incomplete">
              ${n}
            </div>
        `:g``}  
     `},this.handleSelectionChanged=e=>{this.currentList=e.detail,this.loadTasks(this.currentList)},this.renderTaskDetails=e=>{const t={task:e,list:this.currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",t,e.id);let s=null;const i=g`
      <fluent-button class="task-delete"
        @click="${()=>this.removeTask(e.id)}"
        aria-label="${this.strings.deleteTaskOption}">
        ${J(X.Delete)}
      </fluent-button>`;if(this.hasTemplate("task-details"))s=this.renderTemplate("task-details",t,`task-details-${e.id}`);else{const n={dark:this._isDarkMode,date:!0,"task-due":!0},o=g`
        <fluent-text-field
          autocomplete="off"
          type="date"
          id="${e.id}-taskDate-input"
          class="${ee(n)}"
          aria-label="${this.strings.changeTaskDateInputLabel}"
          .value="${e.dueDateTime?this.dateToInputValue(new Date(e.dueDateTime.dateTime)):this._taskBeingUpdated===e?this.dateToInputValue(this._newTaskDueDate):ue}"
          @change="${this.handleDateUpdate}"
          @focus="${r=>this.updatingTask(r,e)}"
          @blur="${this.handleBlur}"
        >
        </fluent-text-field>
      `,l=g`
          <fluent-text-field 
            autocomplete="off"
            appearance="outline"
            class="title"
            id=${e.id}
            .value="${e.title?e.title:this._taskBeingUpdated===e?this._changedTaskName:""}"
            aria-label="${this.strings.editTaskLabel}"
            @keydown="${r=>this.handleChange(r,e)}"
            @input="${r=>this.handleChange(r,e)}"
            @focus="${r=>this.updatingTask(r,e)}"
          >
          </fluent-text-field>
          ${e.dueDateTime||this._taskBeingUpdated===e?g`${o}`:ue}
          ${i}
      `;s=g`
      <div class="task-details">
        ${l}
      </div>
      `}return g`${s}`},this.renderTask=e=>{const t=e.status==="completed",s=ee({complete:t,"read-only":this.readOnly,task:!0}),i=ee({complete:t}),n=g`${J(X.CheckMark)}`;return g`
      <div class=${s} @blur="${this.handleBlur}">
        <fluent-checkbox 
          id=${e.id} 
          class=${i}
          ?checked=${t}
          @click="${()=>this.handleTaskCheckClick(e)}"
          @keydown="${o=>this.handleTaskCheckKeydown(o,e)}"
        >
          <div slot="checked-indicator">
            ${n}
          </div>
        </fluent-checkbox>
        ${this.renderTaskDetails(e)}
      </div>
    `},this.loadState=()=>F(this,void 0,void 0,function*(){const e=Ne.globalProvider;if(!(!e||e.state!==Me.SignedIn)){if(!this._graph){const t=e.graph.forComponent(this);this._graph=t}if(!this.currentList&&!this.initialId){const t=yield Ms(this._graph),s=t==null?void 0:t.find(i=>i.wellknownListName==="defaultList");s&&(yield this.loadTasks(s))}this.targetId?(this.currentList=yield He(this._graph,this.targetId),this._tasks=yield pe(this._graph,this.targetId)):this.initialId&&(this.currentList=yield He(this._graph,this.initialId),this._tasks=yield pe(this._graph,this.initialId))}}),this.addTask=()=>F(this,void 0,void 0,function*(){if(!(this._isNewTaskBeingAdded||!this._newTaskName)){this._isNewTaskBeingAdded=!0;try{yield this.createNewTask()}finally{this.clearNewTaskData(),this._isNewTaskBeingAdded=!1}}}),this.updateTask=e=>F(this,void 0,void 0,function*(){try{if(!this._changedTaskName&&!this._isChangedDueDate)return;yield this.updateTaskItem(e)}finally{this.clearNewTaskData()}}),this.clearNewTaskData=()=>{this._newTaskDueDate=null,this._newTaskName="",this._changedTaskName="",this._isChangedDueDate=!1,this.focusOnTaskInput()},this.focusOnTaskInput=()=>{const e=this.renderRoot.querySelector("#new-task-name-input"),t=e==null?void 0:e.shadowRoot.querySelector("input");t&&t.focus()},this.clearState=()=>{super.clearState(),this.currentList=null,this._tasks=[],this._taskBeingUpdated=null},this.loadTasks=e=>F(this,void 0,void 0,function*(){this.currentList=e,this._tasks=yield pe(this._graph,e.id)}),this.updateTaskStatus=(e,t)=>F(this,void 0,void 0,function*(){e.status=t;const s=this.currentList.id;e=yield Ve(this._graph,s,e.id,e);const i=this._tasks.findIndex(n=>n.id===e.id);this._tasks[i]=e,yield this._task.run()}),this.removeTask=e=>F(this,void 0,void 0,function*(){this._tasks=this._tasks.filter(s=>s.id!==e),this.requestUpdate();const t=this.currentList.id;yield Us(this._graph,t,e),this._tasks=this._tasks.filter(s=>s.id!==e)}),this.handleInput=e=>{e.target.id==="new-task-name-input"&&(this._newTaskName=e.target.value)},this.handleChange=(e,t)=>F(this,void 0,void 0,function*(){var s;e.target.id===t.id&&(e.key==="Enter"&&(yield this.updateTask(t),(s=e.target)===null||s===void 0||s.blur()),this._changedTaskName=e.target.value)}),this.handleKeyDown=e=>F(this,void 0,void 0,function*(){e.key==="Enter"&&e.target.id==="new-task-name-input"&&(yield this.addTask())}),this.updatingTask=(e,t)=>{e.target.id===t.id&&(this._taskBeingUpdated=t),e.target.id===`${t.id}-taskDate-input`&&(this._updatingTaskDate=!0,this._taskBeingUpdated=t)},this.handleBlur=()=>{const e=this._taskBeingUpdated,t=this.renderRoot.querySelectorAll("fluent-text-field");for(const s of t)e&&(s.id===e.id||s.id===`${e.id}-taskDate-input`)&&(this.updateTask(e),s==null||s.blur(),this._taskBeingUpdated=null,this._updatingTaskDate=!1)},this.handleDateChange=e=>{const t=e.target.value;t?this._newTaskDueDate=new Date(t+"T17:00"):this._newTaskDueDate=null},this.handleDateUpdate=e=>{const t=this._taskBeingUpdated;if(t){const s=e.target.value;s?this._newTaskDueDate=new Date(s+"T17:00"):this._newTaskDueDate=null,t.dueDateTime&&this._newTaskDueDate?this._isChangedDueDate=new Date(t.dueDateTime.dateTime)!==this._newTaskDueDate:t.dueDateTime||this._newTaskDueDate?this._isChangedDueDate=!0:this._isChangedDueDate=!1}},this._graph=null,this._newTaskDueDate=null,this._tasks=[],this.addEventListener("selectionChanged",this.handleSelectionChanged),this.addEventListener("blur",this.handleBlur)}connectedCallback(){super.connectedCallback(),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}renderTasks(){let e=this._tasks;e&&this.taskFilter&&(e=e.filter(n=>this.taskFilter(n)));const t=e.filter(n=>n.status==="completed"),s=Se(e.filter(n=>n.status!=="completed"),n=>n.id,n=>this.renderTask(n)),i=Se(t.sort((n,o)=>n.lastModifiedDateTime<o.lastModifiedDateTime?-1:1).filter(n=>n.status==="completed"),n=>n.id,n=>this.renderTask(n));return g`
      ${s}
      ${i}
    `}renderPicker(){var e,t;return this.targetId?g`<p>${(e=this.currentList)===null||e===void 0?void 0:e.displayName}</p>`:Nt`
        <mgt-picker
          resource="me/todo/lists"
          scopes="tasks.read, tasks.readwrite"
          key-name="displayName"
          selected-value="${Mt((t=this.currentList)===null||t===void 0?void 0:t.displayName)}"
          placeholder="Select a task list">
        </mgt-picker>`}createNewTask(){return F(this,void 0,void 0,function*(){const e=this.currentList.id,t={title:this._newTaskName};this._newTaskDueDate&&(t.dueDateTime={dateTime:new Date(this._newTaskDueDate).toLocaleDateString(),timeZone:"UTC"});const s=yield Ps(this._graph,e,t);this._tasks.unshift(s)})}updateTaskItem(e){return F(this,void 0,void 0,function*(){const t=this.currentList.id;let s={};if(this._changedTaskName&&this._changedTaskName!==e.title&&(s={title:this._changedTaskName}),this._updatingTaskDate){if(!this._isChangedDueDate)return;this._newTaskDueDate?s.dueDateTime={dateTime:new Date(this._newTaskDueDate).toLocaleDateString(),timeZone:"UTC"}:(this._isChangedDueDate&&this._newTaskDueDate,s.dueDateTime=null)}if(!Object.keys(s).length)return;const i=yield Ve(this._graph,t,e.id,s),n=this._tasks.findIndex(o=>o.id===i.id);this._tasks[n]=i})}handleTaskCheckClick(e){this.handleTaskClick(e),this.readOnly||(e.status==="completed"?this.updateTaskStatus(e,"notStarted"):this.updateTaskStatus(e,"completed"))}handleTaskCheckKeydown(e,t){e.key==="Enter"&&!this.readOnly&&(this.handleTaskClick(t),t.status==="completed"?this.updateTaskStatus(t,"notStarted"):this.updateTaskStatus(t,"completed"))}}R([I(),_("design:type",Array)],T.prototype,"_tasks",void 0);R([I(),_("design:type",Object)],T.prototype,"_taskBeingUpdated",void 0);R([I(),_("design:type",Boolean)],T.prototype,"_updatingTaskDate",void 0);R([I(),_("design:type",Object)],T.prototype,"_isChangedDueDate",void 0);R([I(),_("design:type",Date)],T.prototype,"_newTaskDueDate",void 0);R([I(),_("design:type",String)],T.prototype,"_newTaskName",void 0);R([I(),_("design:type",String)],T.prototype,"_changedTaskName",void 0);R([I(),_("design:type",Boolean)],T.prototype,"_isNewTaskBeingAdded",void 0);R([I(),_("design:type",Object)],T.prototype,"_graph",void 0);R([I(),_("design:type",Object)],T.prototype,"currentList",void 0);R([I(),_("design:type",Object)],T.prototype,"_isDarkMode",void 0);const Ws=Pt("todo",Qs),Ys=a=>{const{iconOnly:e,iconPosition:t}=a;return Ut(a.root,{children:[t!=="after"&&a.icon&&K(a.icon,{}),!e&&a.root.children,t==="after"&&a.icon&&K(a.icon,{})]})},Zs=(a,e)=>{const{size:t="medium",vertical:s=!1}=a,i=Gt({circular:!0,axis:"both"}),n={size:t,vertical:s,components:{root:"div"},root:Ze(Je("div",{role:"toolbar",ref:e,...s&&{"aria-orientation":"vertical"},...i,...a}),{elementType:"div"})},[o,l]=Js({checkedValues:a.checkedValues,defaultCheckedValues:a.defaultCheckedValues,onCheckedValueChange:a.onCheckedValueChange}),r=ge((c,d,f,v)=>{if(d&&f){const w=[...(o==null?void 0:o[d])||[]];v?w.splice(w.indexOf(f),1):w.push(f),l==null||l(c,{name:d,checkedItems:w})}}),h=ge((c,d,f,v)=>{d&&f&&(l==null||l(c,{name:d,checkedItems:[f]}))});return{...n,handleToggleButton:r,handleRadio:h,checkedValues:o??{}}},Js=a=>{const[e,t]=qt({state:a.checkedValues,defaultState:a.defaultCheckedValues,initialState:{}}),{onCheckedValueChange:s}=a,i=ge((n,{name:o,checkedItems:l})=>{s&&s(n,{name:o,checkedItems:l}),t(r=>r?{...r,[o]:l}:{[o]:l})});return[e,i]},Xs=Kt(void 0),ea=(a,e)=>K(Xs.Provider,{value:e.toolbar,children:K(a.root,{children:a.root.children})}),ta={root:"fui-Toolbar"},sa=Xe({root:{mc9l5x:"f22iagw",Bt984gj:"f122n59",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1yqiaad"},vertical:{Beiy3e4:"f1vx9l62",a9b677:"f1acs6jw"},small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fvz760z"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1yqiaad"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1ms6bdn"}},{d:[".f22iagw{display:flex;}",".f122n59{align-items:center;}",[".f1yqiaad{padding:4px 8px;}",{p:-1}],".f1vx9l62{flex-direction:column;}",".f1acs6jw{width:fit-content;}",[".fvz760z{padding:0px 4px;}",{p:-1}],[".f1yqiaad{padding:4px 8px;}",{p:-1}],[".f1ms6bdn{padding:4px 20px;}",{p:-1}]]}),aa=a=>{const e=sa(),{vertical:t,size:s}=a;return a.root.className=ne(ta.root,e.root,t&&e.vertical,s==="small"&&!t&&e.small,s==="medium"&&!t&&e.medium,s==="large"&&!t&&e.large,a.root.className),a};function ia(a){const{size:e,handleToggleButton:t,vertical:s,checkedValues:i,handleRadio:n}=a;return{toolbar:{size:e,vertical:s,handleToggleButton:t,handleRadio:n,checkedValues:i}}}const ot=oe.forwardRef((a,e)=>{const t=Zs(a,e),s=ia(t);return aa(t),xe("useToolbarStyles_unstable")(t),ea(t,s)});ot.displayName="Toolbar";const na=Xe({vertical:{Beiy3e4:"f1vx9l62"},verticalIcon:{Be2twd7:"f1rt2boy",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1s184ao"}},{d:[".f1vx9l62{flex-direction:column;}",".f1rt2boy{font-size:24px;}",[".f1s184ao{margin:0;}",{p:-1}]]}),oa=a=>{Qt(a);const e=na();a.root.className=ne(a.root.className,a.vertical&&e.vertical),a.icon&&(a.icon.className=ne(a.icon.className,a.vertical&&e.verticalIcon))},ra=(a,e)=>{const{vertical:t=!1,...s}=a,i=Wt({appearance:"subtle",...s},e);return{vertical:t,...i}},rt=oe.forwardRef((a,e)=>{const t=ra(a,e);return oa(t),xe("useToolbarButtonStyles_unstable")(t),Ys(t)});rt.displayName="ToolbarButton";const la=(a,e)=>({components:{root:"div"},root:Ze(Je("div",{ref:e,role:"presentation",...a}),{elementType:"div"})}),da={root:"fui-ToolbarGroup"},ca=a=>(a.root.className=ne(da.root,a.root.className),a),ha=a=>K(a.root,{children:a.root.children}),lt=oe.forwardRef((a,e)=>{const t=la(a,e);return ca(t),xe("useToolbarGroupStyles_unstable")(t),ha(t)});lt.displayName="ToolbarGroup";const ua=et({toolbar:{justifyContent:"space-between"}}),fa=a=>[te({columnId:"name",renderHeaderCell:()=>"Name",renderCell:t=>p.jsx(se,{children:a?p.jsx(ae,{shape:"rectangle",style:{width:"120px"}}):p.jsx(Zt,{userId:t.id,view:"oneline",personCardInteraction:"hover"})})}),te({columnId:"jobTitle",renderHeaderCell:()=>"Job Title",renderCell:t=>p.jsx(se,{children:a?p.jsx(ae,{shape:"rectangle",style:{width:"120px"}}):t.jobTitle})}),te({columnId:"mobilePhone",renderHeaderCell:()=>"Mobile Phone",renderCell:t=>p.jsx(se,{children:a?p.jsx(ae,{shape:"rectangle",style:{width:"120px"}}):t.mobilePhone})}),te({columnId:"officeLocation",renderHeaderCell:()=>"Office Location",renderCell:t=>p.jsx(se,{children:a?p.jsx(ae,{shape:"rectangle",style:{width:"120px"}}):t.officeLocation})})];function pa(a){return p.jsxs(es,{resource:"me/directReports",children:[p.jsx(ze,{template:"default"}),p.jsx(ze,{template:"loading"}),p.jsx(ma,{template:"no-data"})]})}const ze=a=>{const e=ua(),[t]=re.useState(a.dataContext.value),[s]=re.useState(a.dataContext&&!a.dataContext.value),[i,n]=re.useState(null),o=(l,r)=>{const[h]=r.selectedItems,c=t.find(d=>d.id===h);n(c)};return p.jsxs("div",{children:[p.jsx(ot,{className:e.toolbar,children:p.jsx(lt,{role:"presentation",children:p.jsx(rt,{icon:p.jsx(Yt,{}),disabled:!i,as:"a",href:`https://www.office.com/feed?auth=2#/user/${i==null?void 0:i.id}`,target:"_blank",children:"View feed"})})}),p.jsxs(ss,{columns:fa(s),items:s?[...Array(5)]:t,selectionMode:"single",onSelectionChange:o,getRowId:l=>s?Math.random():l.id,children:[p.jsx(as,{children:p.jsx(Ee,{children:({renderHeaderCell:l})=>p.jsx(is,{children:l()})})}),p.jsx(ns,{children:({item:l,rowId:r})=>p.jsx(Ee,{children:({renderCell:h})=>p.jsx(os,{children:h(l)})},r)})]})]})},ma=a=>p.jsx(p.Fragment,{children:"You don't have direct reports"}),ka=et({panels:{...Jt.padding("10px")}}),Ra=()=>{const a=ka(),[e,t]=oe.useState("tasks"),s=(i,n)=>{t(n.value)};return p.jsxs(p.Fragment,{children:[p.jsx(ft,{title:"My Dashboard",description:"This dashboard helps you being productive with your tasks and your incidents."}),p.jsxs("div",{children:[p.jsxs(Xt,{selectedValue:e,onTabSelect:s,children:[p.jsx(Fe,{value:"tasks",children:"My Tasks"}),p.jsx(Fe,{value:"directReports",children:"My Direct Reports"})]}),p.jsxs("div",{className:a.panels,children:[e==="tasks"&&p.jsx(Ws,{}),e==="directReports"&&p.jsx(pa,{})]})]})]})};export{Ra as default};
