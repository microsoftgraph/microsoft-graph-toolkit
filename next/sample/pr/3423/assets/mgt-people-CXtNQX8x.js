import{X as g,Y as d,a2 as m,av as b,a3 as w,Z as x,aw as P,$ as f,a8 as _,ax as S,ay as C,az as I,aA as M,aB as L,aC as k,aD as A}from"./App-Rd5Uswdo.js";import{c as $}from"./repeat-CpMGhjBm.js";import{b as R,a as z}from"./index-DvmOMpH6.js";const D=[g`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .people-list .people-person{--person-avatar-size:var(--people-person-avatar-size, 24px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size, 12px);font-weight:var(--people-overflow-font-weight,400)}
`];var l=function(i,t,e,o){var c=arguments.length,r=c<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,e):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,o);else for(var h=i.length-1;h>=0;h--)(s=i[h])&&(r=(c<3?s(r):c>3?s(t,e,r):s(t,e))||r);return c>3&&r&&Object.defineProperty(t,e,r),r},p=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},E=function(i,t,e,o){function c(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function h(u){try{a(o.next(u))}catch(y){s(y)}}function v(u){try{a(o.throw(u))}catch(y){s(y)}}function a(u){u.done?r(u.value):c(u.value).then(h,v)}a((o=o.apply(i,t||[])).next())})};const T=()=>{b(),w("people",n)};class n extends x{static get styles(){return D}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...P.requiredScopes])]}constructor(){super(),this.personCardInteraction="hover",this.version="v1.0",this.scopes=[],this._peoplePresence={},this._arrowKeyLocation=-1,this.renderContent=()=>!this.people||this.people.length===0?this.renderNoData():this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople(),this.renderLoading=()=>this.renderTemplate("loading",null)||f``,this.handleKeyDown=t=>{const e=this.shadowRoot.querySelector(".people-list");let o;const c=e==null?void 0:e.children,r=t.key;for(const v of c){const a=v;a.removeAttribute("tabindex"),o=a==null?void 0:a.querySelector("mgt-person"),o=o==null?void 0:o.shadowRoot.querySelector(".person-root"),o==null||o.removeAttribute("tabindex"),a.blur()}t.target===e&&(r==="Tab"||r==="Escape")&&(this._arrowKeyLocation=-1,e==null||e.blur());let s=e==null?void 0:e.childElementCount,h=e==null?void 0:e.querySelector(".overflow");if(h&&(h=h,h.removeAttribute("tabindex"),s--),r==="ArrowRight")this._arrowKeyLocation=(this._arrowKeyLocation+1+s)%s;else if(r==="ArrowLeft")this._arrowKeyLocation=(this._arrowKeyLocation-1+s)%s;else if(["Enter","space"," "].includes(r)&&this.personCardInteraction!=="none"){const a=c[this._arrowKeyLocation].querySelector("mgt-person");a&&a.showPersonCard()}this._arrowKeyLocation>-1&&(o=c[this._arrowKeyLocation],o.setAttribute("tabindex","0"),o.focus(),o=o.querySelector(".people-person"),o==null||o.shadowRoot.querySelector(".person-root").setAttribute("tabindex","0"))},this.showMax=3}clearState(){this.people=null}args(){return[this.providerState,this.groupId,this.userIds,this.peopleQueries,this.showMax,this.resource,this.version,this.fallbackDetails]}updated(t){super.updated(t),this.checkPeopleListAndFireEvent()}checkPeopleListAndFireEvent(){var t;const e=(t=this.shadowRoot)===null||t===void 0?void 0:t.querySelector(".people-list");(e==null?void 0:e.childElementCount)>0&&this.fireCustomEvent("people-rendered")}renderPeople(){const t=this.people.slice(0,this.showMax).filter(e=>e);return f`
      <ul
        tabindex="0"
        class="people-list"
        aria-label="people"
        @keydown=${this.handleKeyDown}>
        ${$(t,e=>e.id?e.id:e.displayName,e=>f`
            <li class="people-person">
              ${this.renderPerson(e)}
            </li>
          `)}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){const t=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:t,max:this.showMax,people:this.people})||f`
        <li aria-label="and ${t} more attendees" class="overflow"><span>+${t}</span></li>
      `}renderPerson(t){let e={activity:"Offline",availability:"Offline",id:null};return this.showPresence&&this._peoplePresence&&(e=this._peoplePresence[t.id]),this.renderTemplate("person",{person:t},t.id)||_`
        <mgt-person
          .personDetails=${t}
          .fetchImage=${!0}
          .avatarSize=${"small"}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${e}
          .usage=${"people"}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||f``}loadState(){return E(this,void 0,void 0,function*(){if(!this.people){const t=R.globalProvider;if(t&&t.state===z.SignedIn){const e=t.graph.forComponent(this);this.groupId?this.people=yield S(e,null,this.groupId,this.showMax,"person"):this.userIds?this.people=yield C(e,this.userIds,"","",this.fallbackDetails):this.peopleQueries?this.people=yield I(e,this.peopleQueries,this.fallbackDetails):this.resource?this.people=yield M(e,this.version,this.resource,this.scopes):this.people=yield L(e),this.showPresence?this._peoplePresence=yield k(e,this.people):this._peoplePresence=null}}})}}l([d({attribute:"group-id",type:String}),p("design:type",String)],n.prototype,"groupId",void 0);l([d({attribute:"user-ids",converter:(i,t)=>i.split(",").map(e=>e.trim())}),p("design:type",Array)],n.prototype,"userIds",void 0);l([d({attribute:"people",type:Object}),p("design:type",Array)],n.prototype,"people",void 0);l([d({attribute:"people-queries",converter:(i,t)=>i.split(",").map(e=>e.trim())}),p("design:type",Array)],n.prototype,"peopleQueries",void 0);l([d({attribute:"show-max",type:Number}),p("design:type",Number)],n.prototype,"showMax",void 0);l([d({attribute:"show-presence",type:Boolean}),p("design:type",Boolean)],n.prototype,"showPresence",void 0);l([d({attribute:"person-card",converter:(i,t)=>A(i,"hover")}),p("design:type",String)],n.prototype,"personCardInteraction",void 0);l([d({attribute:"resource",type:String}),p("design:type",String)],n.prototype,"resource",void 0);l([d({attribute:"version",type:String}),p("design:type",Object)],n.prototype,"version",void 0);l([d({attribute:"scopes",converter:i=>i?i.toLowerCase().split(","):null,reflect:!0}),p("design:type",Array)],n.prototype,"scopes",void 0);l([d({attribute:"fallback-details",type:Array}),p("design:type",Array)],n.prototype,"fallbackDetails",void 0);l([m(),p("design:type",Object)],n.prototype,"_arrowKeyLocation",void 0);export{n as M,T as r};
