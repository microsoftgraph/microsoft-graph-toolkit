try{
(()=>{var m7=Object.defineProperty;var qv=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var y=(r,e)=>()=>(r&&(e=r(r=0)),e);var g7=(r,e)=>{for(var t in e)m7(r,t,{get:e[t],enumerable:!0})};var l=y(()=>{});var c=y(()=>{});var d=y(()=>{});var Gi,qd=y(()=>{l();c();d();Gi=class{constructor(){this.eventHandlers=[]}fire(e){for(let t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}});var Gd,ek,jd=y(()=>{l();c();d();Gd="https://graph.microsoft.com",ek=new Set([Gd,"https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn","https://canary.graph.microsoft.com"])});var gp,vp=y(()=>{l();c();d();jd();gp=r=>{try{let t=new URL(r).origin;if(ek.has(t))return t}catch{return}}});var Ka,Xn,oe,bn=y(()=>{l();c();d();vp();jd();qd();Ka=class{get isMultiAccountSupportedAndEnabled(){return!1}get approvedScopes(){return this._approvedScopes}set approvedScopes(e){this._approvedScopes=e.map(t=>t.toLowerCase())}hasAtLeastOneApprovedScope(e){return e.some(t=>this.approvedScopes.includes(t.toLowerCase().trim()))}hasAllOneApprovedScope(e){return e.some(t=>!this.approvedScopes.includes(t.toLowerCase().trim()))}needsAdditionalScopes(e){let t=[];return e.length&&!this.hasAtLeastOneApprovedScope(e)&&t.push(e[0].trim()),t}set baseURL(e){if(gp(e)){this._baseURL=e;return}else throw new Error(`${e} is not a valid Graph URL endpoint.`)}get baseURL(){return this._baseURL}set customHosts(e){this._customHosts=e}get customHosts(){return this._customHosts}get isMultiAccountSupported(){return this.isMultipleAccountSupported}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(e){this._isIncrementalConsentDisabled=e}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new Gi,this._activeAccountChangedDispatcher=new Gi,this._baseURL=Gd,this._approvedScopes=[],this._customHosts=void 0,this._isIncrementalConsentDisabled=!1,this.isMultipleAccountSupported=!1,this._state=oe.Loading}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}setActiveAccount(e){this.fireActiveAccountChanged()}onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}removeActiveAccountChangedHandler(e){this._activeAccountChangedDispatcher.remove(e)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...e){return this.getAccessToken({scopes:e})}};(function(r){r[r.Popup=0]="Popup",r[r.Redirect=1]="Redirect"})(Xn||(Xn={}));(function(r){r[r.Loading=0]="Loading",r[r.SignedOut=1]="SignedOut",r[r.SignedIn=2]="SignedIn"})(oe||(oe={}))});var yp,V,bp,es=y(()=>{l();c();d();qd();bn();yp=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},V=class r{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.isMultiAccountSupportedAndEnabled&&this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.isMultiAccountSupportedAndEnabled&&e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(bp.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}static removeActiveAccountChangedListener(e){this._activeAccountChangedDispatcher.remove(e)}static me(){return this.client?(this._mePromise||(this._mePromise=this.getMe()),this._mePromise):(this._mePromise=null,null)}static getMe(){return yp(this,void 0,void 0,function*(){try{let e=yield this.client.api("me").get();if(e?.id)return e}catch{}return null})}static getCacheId(){var e;return yp(this,void 0,void 0,function*(){if(this._cacheId)return this._cacheId;if(((e=r.globalProvider)===null||e===void 0?void 0:e.state)===oe.SignedIn&&!this._cacheId&&this.client)try{this._cacheId=yield this.createCacheId()}catch{}return this._cacheId})}static unsetCacheId(){this._cacheId=null,this._mePromise=null}static createCacheId(){return yp(this,void 0,void 0,function*(){if(r.globalProvider.isMultiAccountSupportedAndEnabled){let e=this.createCacheIdWithAccountDetails();if(e)return e}return yield this.createCacheIdWithUserDetails()})}static createCacheIdWithUserDetails(){return yp(this,void 0,void 0,function*(){let e=yield this.me();return e?.id?e.id+"-"+e.userPrincipalName:null})}static createCacheIdWithAccountDetails(){let e=r.globalProvider.getActiveAccount();return e.tenantId&&e.id?e.tenantId+e.id:null}static get client(){return r.globalProvider&&r.globalProvider.state===oe.SignedIn?r.globalProvider.graph.client:null}};V._eventDispatcher=new Gi;V._activeAccountChangedDispatcher=new Gi;V.handleProviderStateChanged=()=>{(!V.globalProvider||V.globalProvider.state!==oe.SignedIn)&&(V._mePromise=null),V._eventDispatcher.fire(bp.ProviderStateChanged)};V.handleActiveAccountChanged=()=>{V.unsetCacheId(),V._activeAccountChangedDispatcher.fire(null)};(function(r){r[r.ProviderChanged=0]="ProviderChanged",r[r.ProviderStateChanged=1]="ProviderStateChanged"})(bp||(bp={}))});var wp,t0=y(()=>{l();c();d();wp=class{}});function J(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n}function _e(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})}var kt=y(()=>{l();c();d()});var mr,Kd=y(()=>{l();c();d();(function(r){r.GET="GET",r.PATCH="PATCH",r.POST="POST",r.PUT="PUT",r.DELETE="DELETE"})(mr||(mr={}))});var hc,tk=y(()=>{l();c();d();kt();Kd();hc=class r{constructor(e){if(this.requests=new Map,typeof e<"u"){let t=r.requestLimit;if(e.length>t){let o=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw o.name="Limit Exceeded Error",o}for(let o of e)this.addRequest(o)}}static validateDependencies(e){let t=n=>{let s=n.entries(),a=s.next();for(;!a.done;){let u=a.value[1];if(u.dependsOn!==void 0&&u.dependsOn.length>0)return!1;a=s.next()}return!0},o=n=>{let s=n.entries(),a=s.next(),u=a.value[1];if(u.dependsOn!==void 0&&u.dependsOn.length>0)return!1;let h=a;for(a=s.next();!a.done;){let p=a.value[1];if(p.dependsOn===void 0||p.dependsOn.length!==1||p.dependsOn[0]!==h.value[1].id)return!1;h=a,a=s.next()}return!0},i=n=>{let s=n.entries(),a=s.next(),u=a.value[1],h;if(u.dependsOn===void 0||u.dependsOn.length===0)h=u.id;else if(u.dependsOn.length===1){let p=u.dependsOn[0];if(p!==u.id&&n.has(p))h=p;else return!1}else return!1;for(a=s.next();!a.done;){let p=a.value[1];if((p.dependsOn===void 0||p.dependsOn.length===0)&&h!==p.id||p.dependsOn!==void 0&&p.dependsOn.length!==0&&(p.dependsOn.length===1&&(p.id===h||p.dependsOn[0]!==h)||p.dependsOn.length>1))return!1;a=s.next()}return!0};if(e.size===0){let n=new Error("Empty requests map, Please provide at least one request.");throw n.name="Empty Requests Error",n}return t(e)||o(e)||i(e)}static getRequestData(e){return _e(this,void 0,void 0,function*(){let t={url:""},o=new RegExp("^https?://");t.url=o.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;let i={};return e.headers.forEach((n,s)=>{i[s]=n}),Object.keys(i).length&&(t.headers=i),(e.method===mr.PATCH||e.method===mr.POST||e.method===mr.PUT)&&(t.body=yield r.getRequestBody(e)),t})}static getRequestBody(e){return _e(this,void 0,void 0,function*(){let t=!1,o;try{o=yield e.clone().json(),t=!0}catch{}if(!t)try{if(typeof Blob<"u"){let i=yield e.blob(),n=new FileReader;o=yield new Promise(s=>{n.addEventListener("load",()=>{let a=n.result,h=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(a);s(h[4])},!1),n.readAsDataURL(i)})}else typeof Buffer<"u"&&(o=(yield e.buffer()).toString("base64"));t=!0}catch{}return o})}addRequest(e){let t=r.requestLimit;if(e.id===""){let o=new Error("Id for a request is empty, Please provide an unique id");throw o.name="Empty Id For Request",o}if(this.requests.size===t){let o=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw o.name="Limit Exceeded Error",o}if(this.requests.has(e.id)){let o=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw o.name="Duplicate RequestId Error",o}return this.requests.set(e.id,e),e.id}removeRequest(e){let t=this.requests.delete(e),o=this.requests.entries(),i=o.next();for(;!i.done;){let n=i.value[1].dependsOn;if(typeof n<"u"){let s=n.indexOf(e);s!==-1&&n.splice(s,1),n.length===0&&delete i.value[1].dependsOn}i=o.next()}return t}getContent(){return _e(this,void 0,void 0,function*(){let e=[],t={requests:e},o=this.requests.entries(),i=o.next();if(i.done){let n=new Error("No requests added yet, Please add at least one request.");throw n.name="Empty Payload",n}if(!r.validateDependencies(this.requests)){let n=new Error(`Invalid dependency found, Dependency should be:
1. Parallel - no individual request states a dependency in the dependsOn property.
2. Serial - all individual requests depend on the previous individual request.
3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);throw n.name="Invalid Dependency",n}for(;!i.done;){let n=i.value[1],s=yield r.getRequestData(n.request);if(s.body!==void 0&&(s.headers===void 0||s.headers["content-type"]===void 0)){let a=new Error(`Content-type header is not mentioned for request #${n.id}, For request having body, Content-type header should be mentioned`);throw a.name="Invalid Content-type header",a}s.id=n.id,n.dependsOn!==void 0&&n.dependsOn.length>0&&(s.dependsOn=n.dependsOn),e.push(s),i=o.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){let o=new Error(`Dependent ${e} does not exists, Please check the id`);throw o.name="Invalid Dependent",o}if(typeof t<"u"&&!this.requests.has(t)){let o=new Error(`Dependency ${t} does not exists, Please check the id`);throw o.name="Invalid Dependency",o}if(typeof t<"u"){let o=this.requests.get(e);if(o.dependsOn===void 0&&(o.dependsOn=[]),o.dependsOn.indexOf(t)!==-1){let i=new Error(`Dependency ${t} is already added for the request ${e}`);throw i.name="Duplicate Dependency",i}o.dependsOn.push(t)}else{let o=this.requests.entries(),i,n=o.next();for(;!n.done&&n.value[1].id!==e;)i=n,n=o.next();if(typeof i<"u"){let s=i.value[0];if(n.value[1].dependsOn===void 0&&(n.value[1].dependsOn=[]),n.value[1].dependsOn.indexOf(s)!==-1){let a=new Error(`Dependency ${s} is already added for the request ${e}`);throw a.name="Duplicate Dependency",a}n.value[1].dependsOn.push(s)}else{let s=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw s.name="Invalid Dependency Addition",s}}}removeDependency(e,t){let o=this.requests.get(e);if(typeof o>"u"||o.dependsOn===void 0||o.dependsOn.length===0)return!1;if(typeof t<"u"){let i=o.dependsOn.indexOf(t);return i===-1?!1:(o.dependsOn.splice(i,1),!0)}else return delete o.dependsOn,!0}};hc.requestLimit=20});var rk=y(()=>{l();c();d()});var ok,ik,nk,r0=y(()=>{l();c();d();ok="v1.0",ik="https://graph.microsoft.com/",nk=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"])});var gr,ts=y(()=>{l();c();d();gr=class r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,r.prototype)}static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new r,t.customError=e),t}}});var sk,ak,Cp,xp,kp,lk,iO,Sp=y(()=>{l();c();d();r0();ts();sk=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],ak=r=>{let e=n=>n.replace(/\/+$/,""),t=n=>n.replace(/^\/+/,""),o=(n,s)=>[e(n),t(s)].join("/");return Array.prototype.slice.call(r).reduce(o)},Cp=r=>{let e=r&&r.constructor&&r.constructor.name;if(e==="Buffer"||e==="Blob"||e==="File"||e==="FormData"||typeof r=="string")return r;if(e==="ArrayBuffer")r=Buffer.from(r);else if(e==="Int8Array"||e==="Int16Array"||e==="Int32Array"||e==="Uint8Array"||e==="Uint16Array"||e==="Uint32Array"||e==="Uint8ClampedArray"||e==="Float32Array"||e==="Float64Array"||e==="DataView")r=Buffer.from(r.buffer);else try{r=JSON.stringify(r)}catch{throw new Error("Unable to stringify the content")}return r},xp=r=>lk(r),kp=(r,e)=>(e.forEach(t=>iO(t)),lk(r,e)),lk=(r,e=nk)=>{if(r=r.toLowerCase(),r.indexOf("https://")!==-1){r=r.replace("https://","");let t=r.indexOf(":"),o=r.indexOf("/"),i="";if(o!==-1)return t!==-1&&t<o?(i=r.substring(0,t),e.has(i)):(i=r.substring(0,o),e.has(i))}return!1},iO=r=>{if(r.indexOf("/")!==-1)throw new gr("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")}});var go,Qs=y(()=>{l();c();d();go=class{constructor(e=[]){this.middlewareOptions=new Map;for(let t of e){let o=t.constructor;this.middlewareOptions.set(o,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}});var o0,pc,fc,_p,ck,Wa=y(()=>{l();c();d();kt();o0=()=>{let r="";for(let e=0;e<32;e++)(e===8||e===12||e===16||e===20)&&(r+="-"),r+=Math.floor(Math.random()*16).toString(16);return r},pc=(r,e,t)=>{let o=null;if(typeof Request<"u"&&r instanceof Request)o=r.headers.get(t);else if(typeof e<"u"&&e.headers!==void 0)if(typeof Headers<"u"&&e.headers instanceof Headers)o=e.headers.get(t);else if(e.headers instanceof Array){let i=e.headers;for(let n=0,s=i.length;n<s;n++)if(i[n][0]===t){o=i[n][1];break}}else e.headers[t]!==void 0&&(o=e.headers[t]);return o},fc=(r,e,t,o)=>{if(typeof Request<"u"&&r instanceof Request)r.headers.set(t,o);else if(typeof e<"u")if(e.headers===void 0)e.headers=new Headers({[t]:o});else if(typeof Headers<"u"&&e.headers instanceof Headers)e.headers.set(t,o);else if(e.headers instanceof Array){let i=0,n=e.headers.length;for(;i<n;i++){let s=e.headers[i];if(s[0]===t){s[1]=o;break}}i===n&&e.headers.push([t,o])}else Object.assign(e.headers,{[t]:o})},_p=(r,e,t,o)=>{typeof Request<"u"&&r instanceof Request?r.headers.append(t,o):typeof e<"u"&&(e.headers===void 0?e.headers=new Headers({[t]:o}):typeof Headers<"u"&&e.headers instanceof Headers?e.headers.append(t,o):e.headers instanceof Array?e.headers.push([t,o]):e.headers===void 0?e.headers={[t]:o}:e.headers[t]===void 0?e.headers[t]=o:e.headers[t]+=`, ${o}`)},ck=(r,e)=>_e(void 0,void 0,void 0,function*(){let t=e.headers.get("Content-Type")?yield e.blob():yield Promise.resolve(void 0),{method:o,headers:i,referrer:n,referrerPolicy:s,mode:a,credentials:u,cache:h,redirect:p,integrity:f,keepalive:b,signal:C}=e;return new Request(r,{method:o,headers:i,body:t,referrer:n,referrerPolicy:s,mode:a,credentials:u,cache:h,redirect:p,integrity:f,keepalive:b,signal:C})})});var Qa,i0=y(()=>{l();c();d();Qa=class{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}});var wn,ji,mc=y(()=>{l();c();d();Qs();(function(r){r[r.NONE=0]="NONE",r[r.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",r[r.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",r[r.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(wn||(wn={}));ji=class r{constructor(){this.featureUsage=wn.NONE}static updateFeatureUsageFlag(e,t){let o;e.middlewareControl instanceof go?o=e.middlewareControl.getMiddlewareOptions(r):e.middlewareControl=new go,typeof o>"u"&&(o=new r,e.middlewareControl.setMiddlewareOptions(r,o)),o.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}});var Ki,Tp=y(()=>{l();c();d();kt();Sp();Qs();Wa();i0();mc();Ki=class r{constructor(e){this.authenticationProvider=e}execute(e){return _e(this,void 0,void 0,function*(){let t=typeof e.request=="string"?e.request:e.request.url;if(xp(t)||e.customHosts&&kp(t,e.customHosts)){let o;e.middlewareControl instanceof go&&(o=e.middlewareControl.getMiddlewareOptions(Qa));let i,n;o&&(i=o.authenticationProvider,n=o.authenticationProviderOptions),i||(i=this.authenticationProvider);let a=`Bearer ${yield i.getAccessToken(n)}`;_p(e.request,e.options,r.AUTHORIZATION_HEADER,a),ji.updateFeatureUsageFlag(e,wn.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[r.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}};Ki.AUTHORIZATION_HEADER="Authorization"});var Cn,Ep=y(()=>{l();c();d();kt();Cn=class{execute(e){return _e(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}});var Dr,Wd=y(()=>{l();c();d();Dr=class r{constructor(e=r.DEFAULT_DELAY,t=r.DEFAULT_MAX_RETRIES,o=r.defaultShouldRetry){if(e>r.MAX_DELAY&&t>r.MAX_MAX_RETRIES){let i=new Error(`Delay and MaxRetries should not be more than ${r.MAX_DELAY} and ${r.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e>r.MAX_DELAY){let i=new Error(`Delay should not be more than ${r.MAX_DELAY}`);throw i.name="MaxLimitExceeded",i}else if(t>r.MAX_MAX_RETRIES){let i=new Error(`MaxRetries should not be more than ${r.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e<0&&t<0){let i=new Error("Delay and MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}else if(e<0){let i=new Error("Delay should not be negative");throw i.name="MinExpectationNotMet",i}else if(t<0){let i=new Error("MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}this.delay=Math.min(e,r.MAX_DELAY),this.maxRetries=Math.min(t,r.MAX_MAX_RETRIES),this.shouldRetry=o}getMaxDelay(){return r.MAX_DELAY}};Dr.DEFAULT_DELAY=3;Dr.DEFAULT_MAX_RETRIES=3;Dr.MAX_DELAY=180;Dr.MAX_MAX_RETRIES=10;Dr.defaultShouldRetry=()=>!0});var ii,Ip=y(()=>{l();c();d();kt();Kd();Qs();Wa();Wd();mc();ii=class r{constructor(e=new Dr){this.options=e}isRetry(e){return r.RETRY_STATUS_CODES.indexOf(e.status)!==-1}isBuffered(e,t){let o=typeof e=="string"?t.method:e.method;return!((o===mr.PUT||o===mr.PATCH||o===mr.POST)&&pc(e,t,"Content-Type")==="application/octet-stream")}getDelay(e,t,o){let i=()=>Number(Math.random().toFixed(3)),n=e.headers!==void 0?e.headers.get(r.RETRY_AFTER_HEADER):null,s;return n!==null?Number.isNaN(Number(n))?s=Math.round((new Date(n).getTime()-Date.now())/1e3):s=Number(n):s=t>=2?this.getExponentialBackOffTime(t)+o+i():o+i(),Math.min(s,this.options.getMaxDelay()+i())}getExponentialBackOffTime(e){return Math.round(1/2*(Math.pow(2,e)-1))}sleep(e){return _e(this,void 0,void 0,function*(){let t=e*1e3;return new Promise(o=>setTimeout(o,t))})}getOptions(e){let t;return e.middlewareControl instanceof go&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),typeof t>"u"&&(t=Object.assign(new Dr,this.options)),t}executeWithRetry(e,t,o){return _e(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),t<o.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&o.shouldRetry(o.delay,t,e.request,e.options,e.response)){++t,fc(e.request,e.options,r.RETRY_ATTEMPT_HEADER,t.toString());let i=this.getDelay(e.response,t,o.delay);return yield this.sleep(i),yield this.executeWithRetry(e,t,o)}else return})}execute(e){return _e(this,void 0,void 0,function*(){let o=this.getOptions(e);return ji.updateFeatureUsageFlag(e,wn.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,o)})}setNext(e){this.nextMiddleware=e}};ii.RETRY_STATUS_CODES=[429,503,504];ii.RETRY_ATTEMPT_HEADER="Retry-Attempt";ii.RETRY_AFTER_HEADER="Retry-After"});var ni,Qd=y(()=>{l();c();d();ni=class r{constructor(e=r.DEFAULT_MAX_REDIRECTS,t=r.defaultShouldRedirect){if(e>r.MAX_MAX_REDIRECTS){let o=new Error(`MaxRedirects should not be more than ${r.MAX_MAX_REDIRECTS}`);throw o.name="MaxLimitExceeded",o}if(e<0){let o=new Error("MaxRedirects should not be negative");throw o.name="MinExpectationNotMet",o}this.maxRedirects=e,this.shouldRedirect=t}};ni.DEFAULT_MAX_REDIRECTS=5;ni.MAX_MAX_REDIRECTS=20;ni.defaultShouldRedirect=()=>!0});var Wi,Ap=y(()=>{l();c();d();kt();Kd();Qs();Wa();Qd();mc();Wi=class r{constructor(e=new ni){this.options=e}isRedirect(e){return r.REDIRECT_STATUS_CODES.indexOf(e.status)!==-1}hasLocationHeader(e){return e.headers.has(r.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(r.LOCATION_HEADER)}isRelativeURL(e){return e.indexOf("://")===-1}shouldDropAuthorizationHeader(e,t){let o=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=o.exec(e),n,s;i!==null&&(n=i[0]);let a=o.exec(t);return a!==null&&(s=a[0]),typeof n<"u"&&typeof s<"u"&&n!==s}updateRequestUrl(e,t){return _e(this,void 0,void 0,function*(){t.request=typeof t.request=="string"?e:yield ck(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof go&&(t=e.middlewareControl.getMiddlewareOptions(ni)),typeof t>"u"&&(t=Object.assign(new ni,this.options)),t}executeWithRedirect(e,t,o){return _e(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);let i=e.response;if(t<o.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&o.shouldRedirect(i)){if(++t,i.status===r.STATUS_CODE_SEE_OTHER)e.options.method=mr.GET,delete e.options.body;else{let n=this.getLocationHeader(i);!this.isRelativeURL(n)&&this.shouldDropAuthorizationHeader(i.url,n)&&delete e.options.headers[r.AUTHORIZATION_HEADER],yield this.updateRequestUrl(n,e)}yield this.executeWithRedirect(e,t,o)}else return})}execute(e){return _e(this,void 0,void 0,function*(){let o=this.getOptions(e);return e.options.redirect=r.MANUAL_REDIRECT,ji.updateFeatureUsageFlag(e,wn.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,o)})}setNext(e){this.nextMiddleware=e}};Wi.REDIRECT_STATUS_CODES=[301,302,303,307,308];Wi.STATUS_CODE_SEE_OTHER=303;Wi.LOCATION_HEADER="Location";Wi.AUTHORIZATION_HEADER="Authorization";Wi.MANUAL_REDIRECT="manual"});var dk,uk=y(()=>{l();c();d();dk="3.0.2"});var Ho,Rp=y(()=>{l();c();d();kt();Sp();uk();Qs();Wa();mc();Ho=class r{execute(e){return _e(this,void 0,void 0,function*(){let t=typeof e.request=="string"?e.request:e.request.url;if(xp(t)||e.customHosts&&kp(t,e.customHosts)){let o=pc(e.request,e.options,r.CLIENT_REQUEST_ID_HEADER);o||(o=o0(),fc(e.request,e.options,r.CLIENT_REQUEST_ID_HEADER,o));let i=`${r.PRODUCT_NAME}/${dk}`,n;if(e.middlewareControl instanceof go&&(n=e.middlewareControl.getMiddlewareOptions(ji)),n){let s=n.getFeatureUsage();i+=` (${r.FEATURE_USAGE_STRING}=${s})`}_p(e.request,e.options,r.SDK_VERSION_HEADER,i)}else delete e.options.headers[r.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[r.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}};Ho.CLIENT_REQUEST_ID_HEADER="client-request-id";Ho.SDK_VERSION_HEADER="SdkVersion";Ho.PRODUCT_NAME="graph-js";Ho.FEATURE_USAGE_STRING="featureUsage"});var hk=y(()=>{l();c();d();Tp();Ep();Qd();Wd();Ap();Ip();Rp()});var Yd,Pp=y(()=>{l();c();d();(function(r){r[r.MANUAL=0]="MANUAL",r[r.RANDOM=1]="RANDOM"})(Yd||(Yd={}))});var n0=y(()=>{l();c();d();Pp()});var pk=y(()=>{l();c();d()});var fk=y(()=>{l();c();d();kt();Qs();Wa();pk();n0();Pp()});var vr,Zd=y(()=>{l();c();d();(function(r){r.ARRAYBUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.RAW="raw",r.STREAM="stream",r.TEXT="text"})(vr||(vr={}))});var s0,$p,Op,gc,a0=y(()=>{l();c();d();kt();Zd();(function(r){r.TEXT_HTML="text/html",r.TEXT_XML="text/xml",r.APPLICATION_XML="application/xml",r.APPLICATION_XHTML="application/xhtml+xml"})(s0||(s0={}));(function(r){r.TEXT_PLAIN="text/plain",r.APPLICATION_JSON="application/json"})($p||($p={}));(function(r){r.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",r.IMAGE="^image\\/.+"})(Op||(Op={}));gc=class r{static parseDocumentResponse(e,t){return typeof DOMParser<"u"?new Promise((o,i)=>{e.text().then(n=>{try{let a=new DOMParser().parseFromString(n,t);o(a)}catch(s){i(s)}})}):Promise.resolve(e.body)}static convertResponse(e,t){return _e(this,void 0,void 0,function*(){if(e.status===204)return Promise.resolve();let o,i=e.headers.get("Content-type");switch(t){case vr.ARRAYBUFFER:o=yield e.arrayBuffer();break;case vr.BLOB:o=yield e.blob();break;case vr.DOCUMENT:o=yield r.parseDocumentResponse(e,s0.TEXT_XML);break;case vr.JSON:o=yield e.json();break;case vr.STREAM:o=yield Promise.resolve(e.body);break;case vr.TEXT:o=yield e.text();break;default:if(i!==null){let n=i.split(";")[0];new RegExp(Op.DOCUMENT).test(n)?o=yield r.parseDocumentResponse(e,n):new RegExp(Op.IMAGE).test(n)?o=e.blob():n===$p.TEXT_PLAIN?o=yield e.text():n===$p.APPLICATION_JSON?o=yield e.json():o=Promise.resolve(e.body)}else o=Promise.resolve(e.body);break}return o})}static getResponse(e,t,o){return _e(this,void 0,void 0,function*(){if(t===vr.RAW)return Promise.resolve(e);{let i=yield r.convertResponse(e,t);if(e.ok)if(typeof o=="function")o(null,i);else return i;else throw i}})}}});var Ys,l0=y(()=>{l();c();d();Ys=class{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}});var Jd,c0=y(()=>{l();c();d();Jd=class r{constructor(e,t){this._location=t,this._responseBody=e}get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}static CreateUploadResult(e,t){return new r(e,t.get("location"))}}});var Xd,d0=y(()=>{l();c();d();kt();ts();a0();Zd();l0();c0();Xd=class{constructor(e,t,o,i={}){if(this.DEFAULT_FILE_SIZE=5*1024*1024,this.client=e,t.sliceFile)this.file=t;else throw new gr("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,i.rangeSize||(i.rangeSize=this.DEFAULT_FILE_SIZE),this.options=i,this.uploadSession=o,this.nextRange=new Ys(0,this.options.rangeSize-1)}static createUploadSession(e,t,o,i={}){return _e(this,void 0,void 0,function*(){let n=yield e.api(t).headers(i).post(o);return{url:n.uploadUrl,expiry:new Date(n.expirationDateTime),isCancelled:!1}})}parseRange(e){let t=e[0];if(typeof t>"u"||t==="")return new Ys;let o=t.split("-"),i=parseInt(o[0],10),n=parseInt(o[1],10);return Number.isNaN(n)&&(n=this.file.size-1),new Ys(i,n)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(this.nextRange.minValue===-1)return this.nextRange;let e=this.nextRange.minValue,t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new Ys(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new gr("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return _e(this,void 0,void 0,function*(){let e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){let t=this.getNextRange();if(t.maxValue===-1){let a=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw a.name="Invalid Session",a}let o=yield this.file.sliceFile(t),i=yield this.uploadSliceGetRawResponse(o,t,this.file.size);if(!i)throw new gr("Something went wrong! Large file upload slice response is null.");let n=yield gc.getResponse(i);if(i.status===201||i.status===200&&n.id)return Jd.CreateUploadResult(n,i.headers);let s={expirationDateTime:n.expirationDateTime||n.ExpirationDateTime,nextExpectedRanges:n.NextExpectedRanges||n.nextExpectedRanges};this.updateTaskStatus(s),e&&e.progress&&e.progress(t,e.extraCallbackParam)}})}uploadSlice(e,t,o){return _e(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${o}`,"Content-Type":"application/octet-stream"}).put(e)})}uploadSliceGetRawResponse(e,t,o){return _e(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${o}`,"Content-Type":"application/octet-stream"}).responseType(vr.RAW).put(e)})}cancel(){return _e(this,void 0,void 0,function*(){let e=yield this.client.api(this.uploadSession.url).responseType(vr.RAW).delete();return e.status===204&&(this.uploadSession.isCancelled=!0),e})}getStatus(){return _e(this,void 0,void 0,function*(){let e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e})}resume(){return _e(this,void 0,void 0,function*(){return yield this.getStatus(),yield this.upload()})}getUploadSession(){return this.uploadSession}}});var eu,u0=y(()=>{l();c();d();ts();eu=class{constructor(e,t,o){if(this.content=e,this.name=t,this.size=o,!e||!t||!o)throw new gr("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}});var sO,h0,p0=y(()=>{l();c();d();sO=r=>(r>327680&&(r=Math.floor(r/327680)*320*1024),r),h0=(r=5242880)=>(r>62914560&&(r=62914560),sO(r))});var Mp,mk=y(()=>{l();c();d();kt();ts();u0();d0();p0();Mp=class r extends Xd{constructor(e,t,o,i){super(e,t,o,i)}static constructCreateSessionUrl(e,t=r.DEFAULT_UPLOAD_PATH){return e=e.trim(),t=t.trim(),t===""&&(t="/"),t[0]!=="/"&&(t=`/${t}`),t[t.length-1]!=="/"&&(t=`${t}/`),`/me/drive/root:${t.split("/").map(o=>encodeURIComponent(o)).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let o,i;if(typeof Blob<"u"&&e instanceof Blob)o=new File([e],t),i=o.size;else if(typeof File<"u"&&e instanceof File)o=e,i=o.size;else if(typeof Uint8Array<"u"&&e instanceof Uint8Array){let n=e;i=n.byteLength,o=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}return{content:o,size:i}}static create(e,t,o){return _e(this,void 0,void 0,function*(){if(!e||!t||!o)throw new gr("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");let i=o.fileName,n=r.getFileInfo(t,i),s=new eu(n.content,i,n.size);return this.createTaskWithFileObject(e,s,o)})}static createTaskWithFileObject(e,t,o){return _e(this,void 0,void 0,function*(){if(!e||!t||!o)throw new gr("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");let i=r.constructCreateSessionUrl(o.fileName,o.path),n={fileName:o.fileName,fileDescription:o.fileDescription,conflictBehavior:o.conflictBehavior},s=yield r.createUploadSession(e,i,n),a=h0(o.rangeSize);return new r(e,t,s,{rangeSize:a,uploadEventHandlers:o.uploadEventHandlers})})}static createUploadSession(e,t,o){let i=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return _e(this,void 0,void 0,function*(){let n={item:{"@microsoft.graph.conflictBehavior":o?.conflictBehavior||"rename",name:o?.fileName,description:o?.fileDescription}};return i.createUploadSession.call(this,e,t,n)})}commit(e,t="rename"){return _e(this,void 0,void 0,function*(){let o={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(o)})}};Mp.DEFAULT_UPLOAD_PATH="/"});var gk=y(()=>{l();c();d();kt();ts()});var vk=y(()=>{l();c();d();kt()});var tu,f0=y(()=>{l();c();d();kt();ts();tu=class{constructor(e){this.provider=e}getAccessToken(){return _e(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((o,i)=>_e(this,void 0,void 0,function*(){if(i)e(i);else{if(!o){let s="Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md";o=new gr(s)}let n=yield gr.setGraphClientError(o);t(n)}}))})})}}});var Ya,m0=y(()=>{l();c();d();Ya=class r extends Error{constructor(e=-1,t,o){super(t||o&&o.message),Object.setPrototypeOf(this,r.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=o?o.stack:this.stack}}});var Fp,yk=y(()=>{l();c();d();kt();m0();Fp=class r{static constructError(e,t){let o=new Ya(t,"",e);return e.name!==void 0&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o}static constructErrorFromResponse(e,t){let o=e.error,i=new Ya(t,o.message);return i.code=o.code,o.innerError!==void 0&&(i.requestId=o.innerError["request-id"],i.date=new Date(o.innerError.date)),i.body=JSON.stringify(o),i}static getError(e=null,t=-1,o){return _e(this,void 0,void 0,function*(){let i;if(e&&e.error?i=r.constructErrorFromResponse(e,t):e instanceof Error?i=r.constructError(e,t):(i=new Ya(t),i.body=e),typeof o=="function")o(i,null);else return i})}}});var ru,g0=y(()=>{l();c();d();kt();ts();yk();Sp();a0();Qs();Kd();Zd();ru=class{constructor(e,t,o){this.parsePath=i=>{if(i.indexOf("https://")!==-1){i=i.replace("https://","");let s=i.indexOf("/");s!==-1&&(this.urlComponents.host="https://"+i.substring(0,s),i=i.substring(s+1,i.length));let a=i.indexOf("/");a!==-1&&(this.urlComponents.version=i.substring(0,a),i=i.substring(a+1,i.length))}i.charAt(0)==="/"&&(i=i.substr(1));let n=i.indexOf("?");if(n===-1)this.urlComponents.path=i;else{this.urlComponents.path=i.substr(0,n);let s=i.substring(n+1,i.length).split("&");for(let a of s)this.parseQueryParameter(a)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(o)}addCsvQueryParameter(e,t,o){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let i=[];o.length>1&&typeof t=="string"?i=Array.prototype.slice.call(o):typeof t=="string"?i.push(t):i=i.concat(t),this.urlComponents.oDataQueryParams[e]+=i.join(",")}buildFullUrl(){let e=ak([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){let e=this.urlComponents,t=[];if(Object.keys(e.oDataQueryParams).length!==0)for(let o in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,o)&&t.push(o+"="+e.oDataQueryParams[o]);if(Object.keys(e.otherURLQueryParams).length!==0)for(let o in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,o)&&t.push(o+"="+e.otherURLQueryParams[o]);if(e.otherURLQueryOptions.length!==0)for(let o of e.otherURLQueryOptions)t.push(o);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if(typeof e=="string")if(e.charAt(0)==="?"&&(e=e.substring(1)),e.indexOf("&")!==-1){let t=e.split("&");for(let o of t)this.parseQueryParamenterString(o)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){let t=e.indexOf("="),o=e.substring(0,t),i=e.substring(t+1);this.setURLComponentsQueryParamater(o,i)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(sk.indexOf(e)!==-1){let o=this.urlComponents.oDataQueryParams[e],i=o&&(e==="$expand"||e==="$select"||e==="$orderby");this.urlComponents.oDataQueryParams[e]=i?o+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){let t=e.indexOf("=");return!(t===-1||e.indexOf("(")!==-1&&e.indexOf("(")<t)}updateRequestOptions(e){let t=Object.assign({},e.headers);if(this.config.fetchOptions!==void 0){let o=Object.assign({},this.config.fetchOptions);Object.assign(e,o),typeof this.config.fetchOptions.headers!==void 0&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),e.headers!==void 0&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,o){var i;return _e(this,void 0,void 0,function*(){let n,s=new go(this._middlewareOptions);this.updateRequestOptions(t);let a=(i=this.config)===null||i===void 0?void 0:i.customHosts;try{return n=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:s,customHosts:a})).response,yield gc.getResponse(n,this._responseType,o)}catch(u){if(u instanceof gr)throw u;let h;throw n&&(h=n.status),yield Fp.getError(u,h,o)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}let e=Object.keys(this._headers);for(let t of e)if(t.toLowerCase()==="content-type")return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return _e(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:mr.GET};return yield this.send(t,o,e)})}post(e,t){return _e(this,void 0,void 0,function*(){let o=this.buildFullUrl(),i={method:mr.POST,body:Cp(e)};return(e&&e.constructor&&e.constructor.name)==="FormData"?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers),yield this.send(o,i,t)})}create(e,t){return _e(this,void 0,void 0,function*(){return yield this.post(e,t)})}put(e,t){return _e(this,void 0,void 0,function*(){let o=this.buildFullUrl();this.setHeaderContentType();let i={method:mr.PUT,body:Cp(e)};return yield this.send(o,i,t)})}patch(e,t){return _e(this,void 0,void 0,function*(){let o=this.buildFullUrl();this.setHeaderContentType();let i={method:mr.PATCH,body:Cp(e)};return yield this.send(o,i,t)})}update(e,t){return _e(this,void 0,void 0,function*(){return yield this.patch(e,t)})}delete(e){return _e(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:mr.DELETE};return yield this.send(t,o,e)})}del(e){return _e(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return _e(this,void 0,void 0,function*(){let t=this.buildFullUrl(),o={method:mr.GET};return this.responseType(vr.STREAM),yield this.send(t,o,e)})}putStream(e,t){return _e(this,void 0,void 0,function*(){let o=this.buildFullUrl(),i={method:mr.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(o,i,t)})}}});var vc,v0=y(()=>{l();c();d();kt();vc=class{constructor(...e){if(!e||!e.length){let t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,o)=>{o<e.length-1&&t.setNext(e[o+1])}),this.middleware=e[0]}sendRequest(e){return _e(this,void 0,void 0,function*(){if(typeof e.request=="string"&&e.options===void 0){let t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(e),e})}}});var aO,Dp,bk=y(()=>{l();c();d();v0();Tp();Ep();Qd();Wd();Ap();Ip();Rp();aO=()=>typeof process=="object"&&typeof qv=="function",Dp=class r{static createWithAuthenticationProvider(e){let t=new Ki(e),o=new ii(new Dr),i=new Ho,n=new Cn;if(t.setNext(o),aO()){let s=new Wi(new ni);o.setNext(s),s.setNext(i)}else o.setNext(i);return i.setNext(n),r.createWithMiddleware(t)}static createWithMiddleware(...e){return new vc(...e)}}});var wk,Ck=y(()=>{l();c();d();wk=()=>{if(typeof Promise>"u"&&typeof fetch>"u"){let r=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw r.name="PolyFillNotAvailable",r}else if(typeof Promise>"u"){let r=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}else if(typeof fetch>"u"){let r=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}return!0}});var Za,xk=y(()=>{l();c();d();r0();f0();g0();v0();bk();Ck();Za=class r{constructor(e){this.config={baseUrl:ik,debugLogging:!1,defaultVersion:ok},wk();for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&(this.config[o]=e[o]);let t;if(e.authProvider!==void 0&&e.middleware!==void 0){let o=new Error;throw o.name="AmbiguityInInitialization",o.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",o}else if(e.authProvider!==void 0)t=Dp.createWithAuthenticationProvider(e.authProvider);else if(e.middleware!==void 0)t=new vc(...[].concat(e.middleware));else{let o=new Error;throw o.name="InvalidMiddlewareChain",o.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",o}this.httpClient=t}static init(e){let t={};for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=o==="authProvider"?new tu(e[o]):e[o]);return r.initWithMiddleware(t)}static initWithMiddleware(e){return new r(e)}api(e){return new ru(this.httpClient,this.config,e)}}});var Ja=y(()=>{l();c();d();tk();rk();Tp();Ep();Ip();Ap();Rp();hk();i0();Wd();Qd();mc();n0();Pp();fk();d0();mk();p0();gk();u0();c0();l0();vk();xk();f0();m0();ts();g0();Zd()});var lO,kk,Sk=y(()=>{l();c();d();lO=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},kk=r=>lO(void 0,void 0,void 0,function*(){return new Promise(e=>{setTimeout(e,r)})})});var be,y0=y(()=>{l();c();d();Ja();es();be=(r,e=V.globalProvider)=>{let o={scopes:e.needsAdditionalScopes(r)};return e.isIncrementalConsentDisabled?[]:[new Qa(void 0,o)]}});var Lp,_k=y(()=>{l();c();d();Lp=class{constructor(e,t,o,i){this.resource=o.startsWith("/")?o:`/${o}`,this.method=i,this.index=e,this.id=t}}});var Tk,Np,Ek=y(()=>{l();c();d();t0();Ja();Sk();y0();_k();Tk=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Np=class r{static get baseUrl(){return"https://graph.microsoft.com"}constructor(e){this.graph=e,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(e,t,o,i){let n=this.nextIndex++,s=new Lp(n,e,t,"GET");s.headers=i,this.allRequests.push(s),this.requestsQueue.push(n),o&&(this.scopes=this.scopes.concat(o))}executeNext(){return Tk(this,void 0,void 0,function*(){let e=new Map;if(this.retryAfter&&(yield kk(this.retryAfter*1e3),this.retryAfter=0),!this.hasRequests)return e;let t=this.requestsQueue.splice(0,20),o=new hc;for(let u of t.map(h=>this.allRequests[h]))o.addRequest({id:u.index.toString(),request:new Request(r.baseUrl+u.resource,{method:u.method,headers:u.headers})});let i=this.scopes.length?be(this.scopes):[],n=this.graph.api("$batch").middlewareOptions(i),s=yield o.getContent(),a=yield n.post(s);for(let u of a.responses){let h=new wp,p=parseInt(u.id,10),f=this.allRequests[p];if(h.id=f.id,h.index=f.index,h.headers=u.headers,u.status!==200){if(u.status===429){this.requestsQueue.unshift(p);let b=u.headers["Retry-After"];this.retryAfter=Math.max(this.retryAfter,parseInt(b,10)||1)}continue}else typeof u.body=="string"?u.headers["Content-Type"].includes("image/jpeg")?h.content="data:image/jpeg;base64,"+u.body:u.headers["Content-Type"].includes("image/pjpeg")?h.content="data:image/pjpeg;base64,"+u.body:u.headers["Content-Type"].includes("image/png")&&(h.content="data:image/png;base64,"+u.body):h.content=u.body;e.set(f.id,h)}return e})}executeAll(){return Tk(this,void 0,void 0,function*(){let e=new Map;for(;this.hasRequests;){let t=yield this.executeNext();for(let[o,i]of t)e.set(o,i)}return e})}}});var yc,b0=y(()=>{l();c();d();yc=class{constructor(e){typeof e=="string"?this.componentName=e:this.componentName=e.tagName.toLowerCase()}}});var Hp,Up=y(()=>{l();c();d();Hp=(...r)=>{let e=r[0],t=e;for(let o=1;o<r.length;++o){let i=r[o];t.setNext&&t.setNext(i),t=i}return e}});var cO,Bp,Ik=y(()=>{l();c();d();Wa();b0();vp();cO=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Bp=class{constructor(e,t){this._packageVersion=e,this._providerName=t}execute(e){var t;return cO(this,void 0,void 0,function*(){try{if(typeof e.request=="string")if(gp(e.request)){let o=[],i=e.middlewareControl.getMiddlewareOptions(yc);if(i){let a=`${i.componentName}/${this._packageVersion}`;o.push(a)}if(this._providerName){let a=`${this._providerName}/${this._packageVersion}`;o.push(a)}let n=`mgt/${this._packageVersion}`;o.push(n),o.push(pc(e.request,e.options,"SdkVersion"));let s=o.join(", ");fc(e.request,e.options,"SdkVersion",s)}else(t=e?.options)===null||t===void 0||delete t.headers.SdkVersion}catch{}return yield this._nextMiddleware.execute(e)})}setNext(e){this._nextMiddleware=e}}});var rs,ou=y(()=>{l();c();d();rs="4.6.0-pr.3465.a423316"});var w0,yr,bc=y(()=>{l();c();d();w0=class{constructor(){this._disambiguation=""}get defaultPrefix(){return"mgt"}withDisambiguation(e){return e&&!this._disambiguation&&(this._disambiguation=e.toLowerCase(),e!==this._disambiguation&&console.warn(`\u{1F992}: Disambiguation value, ${e}, should be lowercase. Value has been converted to lowercase, ${this._disambiguation}.`)),this}get prefix(){return this._disambiguation?`${this.defaultPrefix}-${this._disambiguation}`:this.defaultPrefix}get disambiguation(){return this._disambiguation}get isDisambiguated(){return!!this._disambiguation}normalize(e){return this.isDisambiguated?e.toUpperCase().replace(this.prefix.toUpperCase(),this.defaultPrefix.toUpperCase()):e}},yr=new w0});var dO,Xa,C0,iu=y(()=>{l();c();d();Ja();jd();Ek();b0();Up();Ik();ou();bc();dO="v1.0",Xa=class r{get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}constructor(e,t=dO){this._client=e,this._version=t}forComponent(e){let t=new r(this._client,this._version);return t.setComponent(e),t}api(e){let t=this._client.api(e).version(this._version);return this._componentName&&(t.middlewareOptions=o=>(t._middlewareOptions=t._middlewareOptions.concat(o),t),t=t.middlewareOptions([new yc(this._componentName)])),t}createBatch(){return new Np(this)}setComponent(e){this._componentName=e instanceof Element?yr.normalize(e.tagName):e}},C0=(r,e,t)=>{let o=[new Ki(r),new ii(new Dr),new Ho,new Bp(rs,r.name),new Cn],i=r.baseURL?r.baseURL:Gd,n=Za.initWithMiddleware({middleware:Hp(...o),customHosts:r.customHosts?new Set(r.customHosts):null,baseUrl:i}),s=new Xa(n,e);return t?s.forComponent(t):s}});var uO,wc,Ak=y(()=>{l();c();d();iu();uO="beta",wc=class r extends Xa{static fromGraph(e){let t=new r(e.client);return t.setComponent(e.componentName),t}constructor(e,t=uO){super(e,t)}forComponent(e){let t=new r(this.client);return this.setComponent(e),t}}});var zp,qp,Pk,Rk,Vp,$k,x0,Gp,k0=y(()=>{l();c();d();zp=globalThis,qp=zp.ShadowRoot&&(zp.ShadyCSS===void 0||zp.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Pk=Symbol(),Rk=new WeakMap,Vp=class{constructor(e,t,o){if(this._$cssResult$=!0,o!==Pk)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o,t=this.t;if(qp&&e===void 0){let o=t!==void 0&&t.length===1;o&&(e=Rk.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&Rk.set(t,e))}return e}toString(){return this.cssText}},$k=r=>new Vp(typeof r=="string"?r:r+"",void 0,Pk),x0=(r,e)=>{if(qp)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(let t of e){let o=document.createElement("style"),i=zp.litNonce;i!==void 0&&o.setAttribute("nonce",i),o.textContent=t.cssText,r.appendChild(o)}},Gp=qp?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(let o of e.cssRules)t+=o.cssText;return $k(t)})(r):r});var hO,pO,fO,mO,gO,vO,jp,Ok,yO,bO,nu,su,Kp,Mk,el,S0=y(()=>{l();c();d();k0();k0();({is:hO,defineProperty:pO,getOwnPropertyDescriptor:fO,getOwnPropertyNames:mO,getOwnPropertySymbols:gO,getPrototypeOf:vO}=Object),jp=globalThis,Ok=jp.trustedTypes,yO=Ok?Ok.emptyScript:"",bO=jp.reactiveElementPolyfillSupport,nu=(r,e)=>r,su={toAttribute(r,e){switch(e){case Boolean:r=r?yO:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},Kp=(r,e)=>!hO(r,e),Mk={attribute:!0,type:String,converter:su,reflect:!1,hasChanged:Kp};Symbol.metadata??=Symbol("metadata"),jp.litPropertyMetadata??=new WeakMap;el=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Mk){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){let o=Symbol(),i=this.getPropertyDescriptor(e,o,t);i!==void 0&&pO(this.prototype,e,i)}}static getPropertyDescriptor(e,t,o){let{get:i,set:n}=fO(this.prototype,e)??{get(){return this[t]},set(s){this[t]=s}};return{get(){return i?.call(this)},set(s){let a=i?.call(this);n.call(this,s),this.requestUpdate(e,a,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Mk}static _$Ei(){if(this.hasOwnProperty(nu("elementProperties")))return;let e=vO(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(nu("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(nu("properties"))){let t=this.properties,o=[...mO(t),...gO(t)];for(let i of o)this.createProperty(i,t[i])}let e=this[Symbol.metadata];if(e!==null){let t=litPropertyMetadata.get(e);if(t!==void 0)for(let[o,i]of t)this.elementProperties.set(o,i)}this._$Eh=new Map;for(let[t,o]of this.elementProperties){let i=this._$Eu(t,o);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e)){let o=new Set(e.flat(1/0).reverse());for(let i of o)t.unshift(Gp(i))}else e!==void 0&&t.push(Gp(e));return t}static _$Eu(e,t){let o=t.attribute;return o===!1?void 0:typeof o=="string"?o:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){let e=new Map,t=this.constructor.elementProperties;for(let o of t.keys())this.hasOwnProperty(o)&&(e.set(o,this[o]),delete this[o]);e.size>0&&(this._$Ep=e)}createRenderRoot(){let e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return x0(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EC(e,t){let o=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,o);if(i!==void 0&&o.reflect===!0){let n=(o.converter?.toAttribute!==void 0?o.converter:su).toAttribute(t,o.type);this._$Em=e,n==null?this.removeAttribute(i):this.setAttribute(i,n),this._$Em=null}}_$AK(e,t){let o=this.constructor,i=o._$Eh.get(e);if(i!==void 0&&this._$Em!==i){let n=o.getPropertyOptions(i),s=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:su;this._$Em=i,this[i]=s.fromAttribute(t,n.type),this._$Em=null}}requestUpdate(e,t,o){if(e!==void 0){if(o??=this.constructor.getPropertyOptions(e),!(o.hasChanged??Kp)(this[e],t))return;this.P(e,t,o)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,o){this._$AL.has(e)||this._$AL.set(e,t),o.reflect===!0&&this._$Em!==e&&(this._$Ej??=new Set).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}let e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(let[i,n]of this._$Ep)this[i]=n;this._$Ep=void 0}let o=this.constructor.elementProperties;if(o.size>0)for(let[i,n]of o)n.wrapped!==!0||this._$AL.has(i)||this[i]===void 0||this.P(i,this[i],n)}let e=!1,t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(o=>o.hostUpdate?.()),this.update(t)):this._$EU()}catch(o){throw e=!1,this._$EU(),o}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&=this._$Ej.forEach(t=>this._$EC(t,this[t])),this._$EU()}updated(e){}firstUpdated(e){}};el.elementStyles=[],el.shadowRootOptions={mode:"open"},el[nu("elementProperties")]=new Map,el[nu("finalized")]=new Map,bO?.({ReactiveElement:el}),(jp.reactiveElementVersions??=[]).push("2.0.4")});function Gk(r,e){if(!Array.isArray(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return Fk!==void 0?Fk.createHTML(e):e}function il(r,e,t=r,o){if(e===is)return e;let i=o!==void 0?t._$Co?.[o]:t._$Cl,n=lu(e)?void 0:e._$litDirective$;return i?.constructor!==n&&(i?._$AO?.(!1),n===void 0?i=void 0:(i=new n(r),i._$AT(r,t,o)),o!==void 0?(t._$Co??=[])[o]=i:t._$Cl=i),i!==void 0&&(e=il(r,i._$AS(r,e.values),i,o)),e}var T0,Wp,Fk,E0,os,I0,wO,ol,Qp,lu,Bk,zk,_0,au,Dk,Lk,tl,Nk,Hk,Vk,qk,Oj,Mj,is,br,Uk,rl,jk,cu,Yp,du,nl,Zp,Jp,Xp,ef,Kk,CO,Cc=y(()=>{l();c();d();T0=globalThis,Wp=T0.trustedTypes,Fk=Wp?Wp.createPolicy("lit-html",{createHTML:r=>r}):void 0,E0="$lit$",os=`lit$${(Math.random()+"").slice(9)}$`,I0="?"+os,wO=`<${I0}>`,ol=document,Qp=()=>ol.createComment(""),lu=r=>r===null||typeof r!="object"&&typeof r!="function",Bk=Array.isArray,zk=r=>Bk(r)||typeof r?.[Symbol.iterator]=="function",_0=`[ 	
\f\r]`,au=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Dk=/-->/g,Lk=/>/g,tl=RegExp(`>|${_0}(?:([^\\s"'>=/]+)(${_0}*=${_0}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Nk=/'/g,Hk=/"/g,Vk=/^(?:script|style|textarea|title)$/i,qk=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),Oj=qk(1),Mj=qk(2),is=Symbol.for("lit-noChange"),br=Symbol.for("lit-nothing"),Uk=new WeakMap,rl=ol.createTreeWalker(ol,129);jk=(r,e)=>{let t=r.length-1,o=[],i,n=e===2?"<svg>":"",s=au;for(let a=0;a<t;a++){let u=r[a],h,p,f=-1,b=0;for(;b<u.length&&(s.lastIndex=b,p=s.exec(u),p!==null);)b=s.lastIndex,s===au?p[1]==="!--"?s=Dk:p[1]!==void 0?s=Lk:p[2]!==void 0?(Vk.test(p[2])&&(i=RegExp("</"+p[2],"g")),s=tl):p[3]!==void 0&&(s=tl):s===tl?p[0]===">"?(s=i??au,f=-1):p[1]===void 0?f=-2:(f=s.lastIndex-p[2].length,h=p[1],s=p[3]===void 0?tl:p[3]==='"'?Hk:Nk):s===Hk||s===Nk?s=tl:s===Dk||s===Lk?s=au:(s=tl,i=void 0);let C=s===tl&&r[a+1].startsWith("/>")?" ":"";n+=s===au?u+wO:f>=0?(o.push(h),u.slice(0,f)+E0+u.slice(f)+os+C):u+os+(f===-2?a:C)}return[Gk(r,n+(r[t]||"<?>")+(e===2?"</svg>":"")),o]},cu=class r{constructor({strings:e,_$litType$:t},o){let i;this.parts=[];let n=0,s=0,a=e.length-1,u=this.parts,[h,p]=jk(e,t);if(this.el=r.createElement(h,o),rl.currentNode=this.el.content,t===2){let f=this.el.content.firstChild;f.replaceWith(...f.childNodes)}for(;(i=rl.nextNode())!==null&&u.length<a;){if(i.nodeType===1){if(i.hasAttributes())for(let f of i.getAttributeNames())if(f.endsWith(E0)){let b=p[s++],C=i.getAttribute(f).split(os),S=/([.?@])?(.*)/.exec(b);u.push({type:1,index:n,name:S[2],strings:C,ctor:S[1]==="."?Zp:S[1]==="?"?Jp:S[1]==="@"?Xp:nl}),i.removeAttribute(f)}else f.startsWith(os)&&(u.push({type:6,index:n}),i.removeAttribute(f));if(Vk.test(i.tagName)){let f=i.textContent.split(os),b=f.length-1;if(b>0){i.textContent=Wp?Wp.emptyScript:"";for(let C=0;C<b;C++)i.append(f[C],Qp()),rl.nextNode(),u.push({type:2,index:++n});i.append(f[b],Qp())}}}else if(i.nodeType===8)if(i.data===I0)u.push({type:2,index:n});else{let f=-1;for(;(f=i.data.indexOf(os,f+1))!==-1;)u.push({type:7,index:n}),f+=os.length-1}n++}}static createElement(e,t){let o=ol.createElement("template");return o.innerHTML=e,o}};Yp=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){let{el:{content:t},parts:o}=this._$AD,i=(e?.creationScope??ol).importNode(t,!0);rl.currentNode=i;let n=rl.nextNode(),s=0,a=0,u=o[0];for(;u!==void 0;){if(s===u.index){let h;u.type===2?h=new du(n,n.nextSibling,this,e):u.type===1?h=new u.ctor(n,u.name,u.strings,this,e):u.type===6&&(h=new ef(n,this,e)),this._$AV.push(h),u=o[++a]}s!==u?.index&&(n=rl.nextNode(),s++)}return rl.currentNode=ol,i}p(e){let t=0;for(let o of this._$AV)o!==void 0&&(o.strings!==void 0?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}},du=class r{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,o,i){this.type=2,this._$AH=br,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode,t=this._$AM;return t!==void 0&&e?.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=il(this,e,t),lu(e)?e===br||e==null||e===""?(this._$AH!==br&&this._$AR(),this._$AH=br):e!==this._$AH&&e!==is&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):zk(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==br&&lu(this._$AH)?this._$AA.nextSibling.data=e:this.T(ol.createTextNode(e)),this._$AH=e}$(e){let{values:t,_$litType$:o}=e,i=typeof o=="number"?this._$AC(e):(o.el===void 0&&(o.el=cu.createElement(Gk(o.h,o.h[0]),this.options)),o);if(this._$AH?._$AD===i)this._$AH.p(t);else{let n=new Yp(i,this),s=n.u(this.options);n.p(t),this.T(s),this._$AH=n}}_$AC(e){let t=Uk.get(e.strings);return t===void 0&&Uk.set(e.strings,t=new cu(e)),t}k(e){Bk(this._$AH)||(this._$AH=[],this._$AR());let t=this._$AH,o,i=0;for(let n of e)i===t.length?t.push(o=new r(this.S(Qp()),this.S(Qp()),this,this.options)):o=t[i],o._$AI(n),i++;i<t.length&&(this._$AR(o&&o._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e&&e!==this._$AB;){let o=e.nextSibling;e.remove(),e=o}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},nl=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,o,i,n){this.type=1,this._$AH=br,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=n,o.length>2||o[0]!==""||o[1]!==""?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=br}_$AI(e,t=this,o,i){let n=this.strings,s=!1;if(n===void 0)e=il(this,e,t,0),s=!lu(e)||e!==this._$AH&&e!==is,s&&(this._$AH=e);else{let a=e,u,h;for(e=n[0],u=0;u<n.length-1;u++)h=il(this,a[o+u],t,u),h===is&&(h=this._$AH[u]),s||=!lu(h)||h!==this._$AH[u],h===br?e=br:e!==br&&(e+=(h??"")+n[u+1]),this._$AH[u]=h}s&&!i&&this.j(e)}j(e){e===br?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},Zp=class extends nl{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===br?void 0:e}},Jp=class extends nl{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==br)}},Xp=class extends nl{constructor(e,t,o,i,n){super(e,t,o,i,n),this.type=5}_$AI(e,t=this){if((e=il(this,e,t,0)??br)===is)return;let o=this._$AH,i=e===br&&o!==br||e.capture!==o.capture||e.once!==o.once||e.passive!==o.passive,n=e!==br&&(o===br||i);i&&this.element.removeEventListener(this.name,this,o),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},ef=class{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){il(this,e)}},Kk={P:E0,A:os,C:I0,M:1,L:jk,R:Yp,D:zk,V:il,I:du,H:nl,N:Jp,U:Xp,B:Zp,F:ef},CO=T0.litHtmlPolyfillSupport;CO?.(cu,du),(T0.litHtmlVersions??=[]).push("3.1.2")});var tf,rf,A0,Wk,uu,Qk,Oe,R0,of,P0=y(()=>{l();c();d();tf=globalThis,rf=tf.ShadowRoot&&(tf.ShadyCSS===void 0||tf.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,A0=Symbol(),Wk=new WeakMap,uu=class{constructor(e,t,o){if(this._$cssResult$=!0,o!==A0)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o,t=this.t;if(rf&&e===void 0){let o=t!==void 0&&t.length===1;o&&(e=Wk.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&Wk.set(t,e))}return e}toString(){return this.cssText}},Qk=r=>new uu(typeof r=="string"?r:r+"",void 0,A0),Oe=(r,...e)=>{let t=r.length===1?r[0]:e.reduce((o,i,n)=>o+(s=>{if(s._$cssResult$===!0)return s.cssText;if(typeof s=="number")return s;throw Error("Value passed to 'css' function must be a 'css' function result: "+s+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+r[n+1],r[0]);return new uu(t,r,A0)},R0=(r,e)=>{if(rf)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(let t of e){let o=document.createElement("style"),i=tf.litNonce;i!==void 0&&o.setAttribute("nonce",i),o.textContent=t.cssText,r.appendChild(o)}},of=rf?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(let o of e.cssRules)t+=o.cssText;return Qk(t)})(r):r});var xO,kO,SO,_O,TO,EO,nf,Yk,IO,AO,hu,$0,Jk,Zk,ns,O0=y(()=>{l();c();d();P0();P0();({is:xO,defineProperty:kO,getOwnPropertyDescriptor:SO,getOwnPropertyNames:_O,getOwnPropertySymbols:TO,getPrototypeOf:EO}=Object),nf=globalThis,Yk=nf.trustedTypes,IO=Yk?Yk.emptyScript:"",AO=nf.reactiveElementPolyfillSupport,hu=(r,e)=>r,$0={toAttribute(r,e){switch(e){case Boolean:r=r?IO:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},Jk=(r,e)=>!xO(r,e),Zk={attribute:!0,type:String,converter:$0,reflect:!1,hasChanged:Jk};Symbol.metadata??=Symbol("metadata"),nf.litPropertyMetadata??=new WeakMap;ns=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Zk){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){let o=Symbol(),i=this.getPropertyDescriptor(e,o,t);i!==void 0&&kO(this.prototype,e,i)}}static getPropertyDescriptor(e,t,o){let{get:i,set:n}=SO(this.prototype,e)??{get(){return this[t]},set(s){this[t]=s}};return{get(){return i?.call(this)},set(s){let a=i?.call(this);n.call(this,s),this.requestUpdate(e,a,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Zk}static _$Ei(){if(this.hasOwnProperty(hu("elementProperties")))return;let e=EO(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(hu("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(hu("properties"))){let t=this.properties,o=[..._O(t),...TO(t)];for(let i of o)this.createProperty(i,t[i])}let e=this[Symbol.metadata];if(e!==null){let t=litPropertyMetadata.get(e);if(t!==void 0)for(let[o,i]of t)this.elementProperties.set(o,i)}this._$Eh=new Map;for(let[t,o]of this.elementProperties){let i=this._$Eu(t,o);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e)){let o=new Set(e.flat(1/0).reverse());for(let i of o)t.unshift(of(i))}else e!==void 0&&t.push(of(e));return t}static _$Eu(e,t){let o=t.attribute;return o===!1?void 0:typeof o=="string"?o:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){let e=new Map,t=this.constructor.elementProperties;for(let o of t.keys())this.hasOwnProperty(o)&&(e.set(o,this[o]),delete this[o]);e.size>0&&(this._$Ep=e)}createRenderRoot(){let e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return R0(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EC(e,t){let o=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,o);if(i!==void 0&&o.reflect===!0){let n=(o.converter?.toAttribute!==void 0?o.converter:$0).toAttribute(t,o.type);this._$Em=e,n==null?this.removeAttribute(i):this.setAttribute(i,n),this._$Em=null}}_$AK(e,t){let o=this.constructor,i=o._$Eh.get(e);if(i!==void 0&&this._$Em!==i){let n=o.getPropertyOptions(i),s=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:$0;this._$Em=i,this[i]=s.fromAttribute(t,n.type),this._$Em=null}}requestUpdate(e,t,o){if(e!==void 0){if(o??=this.constructor.getPropertyOptions(e),!(o.hasChanged??Jk)(this[e],t))return;this.P(e,t,o)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,o){this._$AL.has(e)||this._$AL.set(e,t),o.reflect===!0&&this._$Em!==e&&(this._$Ej??=new Set).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}let e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(let[i,n]of this._$Ep)this[i]=n;this._$Ep=void 0}let o=this.constructor.elementProperties;if(o.size>0)for(let[i,n]of o)n.wrapped!==!0||this._$AL.has(i)||this[i]===void 0||this.P(i,this[i],n)}let e=!1,t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(o=>o.hostUpdate?.()),this.update(t)):this._$EU()}catch(o){throw e=!1,this._$EU(),o}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&=this._$Ej.forEach(t=>this._$EC(t,this[t])),this._$EU()}updated(e){}firstUpdated(e){}};ns.elementStyles=[],ns.shadowRootOptions={mode:"open"},ns[hu("elementProperties")]=new Map,ns[hu("finalized")]=new Map,AO?.({ReactiveElement:ns}),(nf.reactiveElementVersions??=[]).push("2.0.4")});function dS(r,e){if(!Array.isArray(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return Xk!==void 0?Xk.createHTML(e):e}function xc(r,e,t=r,o){if(e===cl)return e;let i=o!==void 0?t._$Co?.[o]:t._$Cl,n=mu(e)?void 0:e._$litDirective$;return i?.constructor!==n&&(i?._$AO?.(!1),n===void 0?i=void 0:(i=new n(r),i._$AT(r,t,o)),o!==void 0?(t._$Co??=[])[o]=i:t._$Cl=i),i!==void 0&&(e=xc(r,i._$AS(r,e.values),i,o)),e}var U0,sf,Xk,nS,Zs,sS,RO,ll,fu,mu,aS,PO,M0,pu,eS,tS,sl,rS,oS,lS,cS,x,Qj,cl,ot,iS,al,$O,gu,F0,vu,kc,D0,L0,N0,H0,OO,uS,B0=y(()=>{l();c();d();U0=globalThis,sf=U0.trustedTypes,Xk=sf?sf.createPolicy("lit-html",{createHTML:r=>r}):void 0,nS="$lit$",Zs=`lit$${(Math.random()+"").slice(9)}$`,sS="?"+Zs,RO=`<${sS}>`,ll=document,fu=()=>ll.createComment(""),mu=r=>r===null||typeof r!="object"&&typeof r!="function",aS=Array.isArray,PO=r=>aS(r)||typeof r?.[Symbol.iterator]=="function",M0=`[ 	
\f\r]`,pu=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,eS=/-->/g,tS=/>/g,sl=RegExp(`>|${M0}(?:([^\\s"'>=/]+)(${M0}*=${M0}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),rS=/'/g,oS=/"/g,lS=/^(?:script|style|textarea|title)$/i,cS=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),x=cS(1),Qj=cS(2),cl=Symbol.for("lit-noChange"),ot=Symbol.for("lit-nothing"),iS=new WeakMap,al=ll.createTreeWalker(ll,129);$O=(r,e)=>{let t=r.length-1,o=[],i,n=e===2?"<svg>":"",s=pu;for(let a=0;a<t;a++){let u=r[a],h,p,f=-1,b=0;for(;b<u.length&&(s.lastIndex=b,p=s.exec(u),p!==null);)b=s.lastIndex,s===pu?p[1]==="!--"?s=eS:p[1]!==void 0?s=tS:p[2]!==void 0?(lS.test(p[2])&&(i=RegExp("</"+p[2],"g")),s=sl):p[3]!==void 0&&(s=sl):s===sl?p[0]===">"?(s=i??pu,f=-1):p[1]===void 0?f=-2:(f=s.lastIndex-p[2].length,h=p[1],s=p[3]===void 0?sl:p[3]==='"'?oS:rS):s===oS||s===rS?s=sl:s===eS||s===tS?s=pu:(s=sl,i=void 0);let C=s===sl&&r[a+1].startsWith("/>")?" ":"";n+=s===pu?u+RO:f>=0?(o.push(h),u.slice(0,f)+nS+u.slice(f)+Zs+C):u+Zs+(f===-2?a:C)}return[dS(r,n+(r[t]||"<?>")+(e===2?"</svg>":"")),o]},gu=class r{constructor({strings:e,_$litType$:t},o){let i;this.parts=[];let n=0,s=0,a=e.length-1,u=this.parts,[h,p]=$O(e,t);if(this.el=r.createElement(h,o),al.currentNode=this.el.content,t===2){let f=this.el.content.firstChild;f.replaceWith(...f.childNodes)}for(;(i=al.nextNode())!==null&&u.length<a;){if(i.nodeType===1){if(i.hasAttributes())for(let f of i.getAttributeNames())if(f.endsWith(nS)){let b=p[s++],C=i.getAttribute(f).split(Zs),S=/([.?@])?(.*)/.exec(b);u.push({type:1,index:n,name:S[2],strings:C,ctor:S[1]==="."?D0:S[1]==="?"?L0:S[1]==="@"?N0:kc}),i.removeAttribute(f)}else f.startsWith(Zs)&&(u.push({type:6,index:n}),i.removeAttribute(f));if(lS.test(i.tagName)){let f=i.textContent.split(Zs),b=f.length-1;if(b>0){i.textContent=sf?sf.emptyScript:"";for(let C=0;C<b;C++)i.append(f[C],fu()),al.nextNode(),u.push({type:2,index:++n});i.append(f[b],fu())}}}else if(i.nodeType===8)if(i.data===sS)u.push({type:2,index:n});else{let f=-1;for(;(f=i.data.indexOf(Zs,f+1))!==-1;)u.push({type:7,index:n}),f+=Zs.length-1}n++}}static createElement(e,t){let o=ll.createElement("template");return o.innerHTML=e,o}};F0=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){let{el:{content:t},parts:o}=this._$AD,i=(e?.creationScope??ll).importNode(t,!0);al.currentNode=i;let n=al.nextNode(),s=0,a=0,u=o[0];for(;u!==void 0;){if(s===u.index){let h;u.type===2?h=new vu(n,n.nextSibling,this,e):u.type===1?h=new u.ctor(n,u.name,u.strings,this,e):u.type===6&&(h=new H0(n,this,e)),this._$AV.push(h),u=o[++a]}s!==u?.index&&(n=al.nextNode(),s++)}return al.currentNode=ll,i}p(e){let t=0;for(let o of this._$AV)o!==void 0&&(o.strings!==void 0?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}},vu=class r{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,o,i){this.type=2,this._$AH=ot,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode,t=this._$AM;return t!==void 0&&e?.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=xc(this,e,t),mu(e)?e===ot||e==null||e===""?(this._$AH!==ot&&this._$AR(),this._$AH=ot):e!==this._$AH&&e!==cl&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):PO(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==ot&&mu(this._$AH)?this._$AA.nextSibling.data=e:this.T(ll.createTextNode(e)),this._$AH=e}$(e){let{values:t,_$litType$:o}=e,i=typeof o=="number"?this._$AC(e):(o.el===void 0&&(o.el=gu.createElement(dS(o.h,o.h[0]),this.options)),o);if(this._$AH?._$AD===i)this._$AH.p(t);else{let n=new F0(i,this),s=n.u(this.options);n.p(t),this.T(s),this._$AH=n}}_$AC(e){let t=iS.get(e.strings);return t===void 0&&iS.set(e.strings,t=new gu(e)),t}k(e){aS(this._$AH)||(this._$AH=[],this._$AR());let t=this._$AH,o,i=0;for(let n of e)i===t.length?t.push(o=new r(this.S(fu()),this.S(fu()),this,this.options)):o=t[i],o._$AI(n),i++;i<t.length&&(this._$AR(o&&o._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e&&e!==this._$AB;){let o=e.nextSibling;e.remove(),e=o}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},kc=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,o,i,n){this.type=1,this._$AH=ot,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=n,o.length>2||o[0]!==""||o[1]!==""?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=ot}_$AI(e,t=this,o,i){let n=this.strings,s=!1;if(n===void 0)e=xc(this,e,t,0),s=!mu(e)||e!==this._$AH&&e!==cl,s&&(this._$AH=e);else{let a=e,u,h;for(e=n[0],u=0;u<n.length-1;u++)h=xc(this,a[o+u],t,u),h===cl&&(h=this._$AH[u]),s||=!mu(h)||h!==this._$AH[u],h===ot?e=ot:e!==ot&&(e+=(h??"")+n[u+1]),this._$AH[u]=h}s&&!i&&this.j(e)}j(e){e===ot?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},D0=class extends kc{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===ot?void 0:e}},L0=class extends kc{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==ot)}},N0=class extends kc{constructor(e,t,o,i,n){super(e,t,o,i,n),this.type=5}_$AI(e,t=this){if((e=xc(this,e,t,0)??ot)===cl)return;let o=this._$AH,i=e===ot&&o!==ot||e.capture!==o.capture||e.once!==o.once||e.passive!==o.passive,n=e!==ot&&(o===ot||i);i&&this.element.removeEventListener(this.name,this,o),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},H0=class{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){xc(this,e)}},OO=U0.litHtmlPolyfillSupport;OO?.(gu,vu),(U0.litHtmlVersions??=[]).push("3.1.2");uS=(r,e,t)=>{let o=t?.renderBefore??e,i=o._$litPart$;if(i===void 0){let n=t?.renderBefore??null;o._$litPart$=i=new vu(e.insertBefore(fu(),n),n,void 0,t??{})}return i._$AI(r),i}});var xn,MO,hS=y(()=>{l();c();d();O0();O0();B0();B0();xn=class extends ns{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){let e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){let t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=uS(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return cl}};xn._$litElement$=!0,xn["finalized"]=!0,globalThis.litElementHydrateSupport?.({LitElement:xn});MO=globalThis.litElementPolyfillSupport;MO?.({LitElement:xn});(globalThis.litElementVersions??=[]).push("4.0.4")});var pS=y(()=>{l();c();d();});var xe=y(()=>{l();c();d();S0();Cc();hS();pS()});var fS=y(()=>{l();c();d();});function E(r){return(e,t)=>typeof t=="object"?DO(r,e,t):((o,i,n)=>{let s=i.hasOwnProperty(n);return i.constructor.createProperty(n,s?{...o,wrapped:!0}:o),s?Object.getOwnPropertyDescriptor(i,n):void 0})(r,e,t)}var FO,DO,z0=y(()=>{l();c();d();S0();FO={attribute:!0,type:String,converter:su,reflect:!1,hasChanged:Kp},DO=(r=FO,e,t)=>{let{kind:o,metadata:i}=t,n=globalThis.litPropertyMetadata.get(i);if(n===void 0&&globalThis.litPropertyMetadata.set(i,n=new Map),n.set(t.name,r),o==="accessor"){let{name:s}=t;return{set(a){let u=e.get.call(this);e.set.call(this,a),this.requestUpdate(s,u,r)},init(a){return a!==void 0&&this.P(s,void 0,r),a}}}if(o==="setter"){let{name:s}=t;return function(a){let u=this[s];e.call(this,a),this.requestUpdate(s,u,r)}}throw Error("Unsupported decorator location: "+o)}});function X(r){return E({...r,state:!0,attribute:!1})}var mS=y(()=>{l();c();d();z0();});var gS=y(()=>{l();c();d();});var Sc=y(()=>{l();c();d();});var vS=y(()=>{l();c();d();Sc();});var yS=y(()=>{l();c();d();Sc();});var bS=y(()=>{l();c();d();Sc();});var wS=y(()=>{l();c();d();Sc();});var CS=y(()=>{l();c();d();Sc();});var gt=y(()=>{l();c();d();fS();z0();mS();gS();vS();yS();bS();wS();CS()});var Ir,lf=y(()=>{l();c();d();qd();Ir=class{static get strings(){return this._strings}static set strings(e){this._strings=e,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){var e,t;switch(((e=document.body)===null||e===void 0?void 0:e.getAttribute("dir"))||((t=document.documentElement)===null||t===void 0?void 0:t.getAttribute("dir"))){case"rtl":return"rtl";case"auto":return"auto";case"ltr":default:return"ltr"}}static onStringsUpdated(e){this._stringsEventDispatcher.add(e)}static removeOnStringsUpdated(e){this._stringsEventDispatcher.remove(e)}static onDirectionUpdated(e){this._directionEventDispatcher.add(e),this.initDirection()}static removeOnDirectionUpdated(e){this._directionEventDispatcher.remove(e)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver(t=>{t.forEach(o=>{o.attributeName==="dir"&&this._directionEventDispatcher.fire(null)})});let e={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,e),this.mutationObserver.observe(document.documentElement,e)}static updateStringsForTag(e,t){var o;if(e=e.toLowerCase(),e.startsWith("mgt-")&&(e=e.substring(4)),this._strings&&t){for(let i of Object.entries(t)){let n=this._strings[i[0]];typeof n=="string"&&(t[i[0]]=n)}if(!((o=this._strings._components)===null||o===void 0)&&o[e]){let i=this._strings._components[e];for(let n of Object.keys(i))t[n]&&(t[n]=i[n])}}return t}};Ir._stringsEventDispatcher=new Gi;Ir._directionEventDispatcher=new Gi;Ir._isDirectionInit=!1});var kS,SS,xS,ss,kn,yu=y(()=>{l();c();d();xe();gt();bn();es();lf();ou();kS=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},SS=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},xS=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})};(function(r){r.mobile="",r.tablet="tablet",r.desktop="desktop"})(ss||(ss={}));kn=class extends xn{static get packageVersion(){return rs}get mediaQuery(){return this.offsetWidth<768?ss.mobile:this.offsetWidth<1200?ss.tablet:ss.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}constructor(){super(),this.providerState=oe.Loading,this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.setLoadingState=e=>{this._isLoadingState!==e&&(this._isLoadingState=e,this.requestUpdate("isLoadingState"))},this.handleProviderUpdates=()=>{var e,t;this.providerState=(t=(e=V.globalProvider)===null||e===void 0?void 0:e.state)!==null&&t!==void 0?t:oe.Loading,this.requestStateUpdate()},this.handleActiveAccountUpdates=()=>{this.clearState(),this.requestStateUpdate()},this.handleLocalizationChanged=()=>{Ir.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()},this.handleDirectionChanged=()=>{this.direction=Ir.getDocumentDirection()},this.handleDirectionChanged(),this.handleLocalizationChanged()}connectedCallback(){super.connectedCallback(),Ir.onStringsUpdated(this.handleLocalizationChanged),Ir.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),Ir.removeOnStringsUpdated(this.handleLocalizationChanged),Ir.removeOnDirectionUpdated(this.handleDirectionChanged),V.removeProviderUpdatedListener(this.handleProviderUpdates),V.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(e){super.firstUpdated(e),this._isFirstUpdated=!0,V.onProviderUpdated(this.handleProviderUpdates),V.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(e,t,o=!1,i=!1,n=!1){let s=new CustomEvent(e,{bubbles:o,cancelable:i,composed:n,detail:t});return this.dispatchEvent(s)}updated(e){super.updated(e);let t=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(t)}requestStateUpdate(e=!1){return xS(this,void 0,void 0,function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!e&&(yield this._currentLoadStatePromise);let t=V.globalProvider;if(!t)return Promise.resolve();if(t.state===oe.SignedOut){this.clearState();return}else{if(t.state===oe.Loading)return Promise.resolve();{let o=new Promise((i,n)=>xS(this,void 0,void 0,function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),i()}catch(s){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),n(s)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&e?this._currentLoadStatePromise.then(()=>o):o}))}}})}};kS([X(),SS("design:type",Number)],kn.prototype,"providerState",void 0);kS([X(),SS("design:type",String)],kn.prototype,"direction",void 0)});var V0,q0,_c,_S=y(()=>{l();c();d();gt();yu();V0=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},q0=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},_c=class extends kn{constructor(){super(...arguments),this.stateChangedHandler=()=>{this.fireCustomEvent("onStateChanged",this.provider.state)}}get provider(){return this._provider}set provider(e){this._provider&&this.provider.removeStateChangedHandler(()=>this.stateChangedHandler),this._provider=e,this._provider&&this.provider.onStateChanged(()=>this.stateChangedHandler)}get isAvailable(){return!0}firstUpdated(e){super.firstUpdated(e);let t=!1;if(this.dependsOn){let o=this.dependsOn;for(;o;){if(o.isAvailable){t=!0;break}o=o.dependsOn}}!t&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}};V0([E({attribute:"depends-on",converter:r=>document.querySelector(r),type:String}),q0("design:type",_c)],_c.prototype,"dependsOn",void 0);V0([E({attribute:"base-url",type:String}),q0("design:type",String)],_c.prototype,"baseUrl",void 0);V0([E({attribute:"custom-hosts",type:String,converter:r=>r.split(",").map(e=>e.trim())}),q0("design:type",Array)],_c.prototype,"customHosts",void 0)});var cf,uf,ES,TS,df,IS,G0,hf,j0=y(()=>{l();c();d();cf=globalThis,uf=cf.ShadowRoot&&(cf.ShadyCSS===void 0||cf.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,ES=Symbol(),TS=new WeakMap,df=class{constructor(e,t,o){if(this._$cssResult$=!0,o!==ES)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o,t=this.t;if(uf&&e===void 0){let o=t!==void 0&&t.length===1;o&&(e=TS.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&TS.set(t,e))}return e}toString(){return this.cssText}},IS=r=>new df(typeof r=="string"?r:r+"",void 0,ES),G0=(r,e)=>{if(uf)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(let t of e){let o=document.createElement("style"),i=cf.litNonce;i!==void 0&&o.setAttribute("nonce",i),o.textContent=t.cssText,r.appendChild(o)}},hf=uf?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(let o of e.cssRules)t+=o.cssText;return IS(t)})(r):r});var LO,NO,HO,UO,BO,zO,pf,AS,VO,qO,bu,K0,ff,RS,dl,PS=y(()=>{l();c();d();j0();j0();({is:LO,defineProperty:NO,getOwnPropertyDescriptor:HO,getOwnPropertyNames:UO,getOwnPropertySymbols:BO,getPrototypeOf:zO}=Object),pf=globalThis,AS=pf.trustedTypes,VO=AS?AS.emptyScript:"",qO=pf.reactiveElementPolyfillSupport,bu=(r,e)=>r,K0={toAttribute(r,e){switch(e){case Boolean:r=r?VO:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},ff=(r,e)=>!LO(r,e),RS={attribute:!0,type:String,converter:K0,reflect:!1,hasChanged:ff};Symbol.metadata??=Symbol("metadata"),pf.litPropertyMetadata??=new WeakMap;dl=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=RS){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){let o=Symbol(),i=this.getPropertyDescriptor(e,o,t);i!==void 0&&NO(this.prototype,e,i)}}static getPropertyDescriptor(e,t,o){let{get:i,set:n}=HO(this.prototype,e)??{get(){return this[t]},set(s){this[t]=s}};return{get(){return i?.call(this)},set(s){let a=i?.call(this);n.call(this,s),this.requestUpdate(e,a,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??RS}static _$Ei(){if(this.hasOwnProperty(bu("elementProperties")))return;let e=zO(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(bu("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(bu("properties"))){let t=this.properties,o=[...UO(t),...BO(t)];for(let i of o)this.createProperty(i,t[i])}let e=this[Symbol.metadata];if(e!==null){let t=litPropertyMetadata.get(e);if(t!==void 0)for(let[o,i]of t)this.elementProperties.set(o,i)}this._$Eh=new Map;for(let[t,o]of this.elementProperties){let i=this._$Eu(t,o);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e)){let o=new Set(e.flat(1/0).reverse());for(let i of o)t.unshift(hf(i))}else e!==void 0&&t.push(hf(e));return t}static _$Eu(e,t){let o=t.attribute;return o===!1?void 0:typeof o=="string"?o:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$Eg=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$ES(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$E_??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$E_?.delete(e)}_$ES(){let e=new Map,t=this.constructor.elementProperties;for(let o of t.keys())this.hasOwnProperty(o)&&(e.set(o,this[o]),delete this[o]);e.size>0&&(this._$Ep=e)}createRenderRoot(){let e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return G0(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$E_?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$E_?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EO(e,t){let o=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,o);if(i!==void 0&&o.reflect===!0){let n=(o.converter?.toAttribute!==void 0?o.converter:K0).toAttribute(t,o.type);this._$Em=e,n==null?this.removeAttribute(i):this.setAttribute(i,n),this._$Em=null}}_$AK(e,t){let o=this.constructor,i=o._$Eh.get(e);if(i!==void 0&&this._$Em!==i){let n=o.getPropertyOptions(i),s=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:K0;this._$Em=i,this[i]=s.fromAttribute(t,n.type),this._$Em=null}}requestUpdate(e,t,o){if(e!==void 0){if(o??=this.constructor.getPropertyOptions(e),!(o.hasChanged??ff)(this[e],t))return;this.C(e,t,o)}this.isUpdatePending===!1&&(this._$Eg=this._$EP())}C(e,t,o){this._$AL.has(e)||this._$AL.set(e,t),o.reflect===!0&&this._$Em!==e&&(this._$ET??=new Set).add(e)}async _$EP(){this.isUpdatePending=!0;try{await this._$Eg}catch(t){Promise.reject(t)}let e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(let[i,n]of this._$Ep)this[i]=n;this._$Ep=void 0}let o=this.constructor.elementProperties;if(o.size>0)for(let[i,n]of o)n.wrapped!==!0||this._$AL.has(i)||this[i]===void 0||this.C(i,this[i],n)}let e=!1,t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$E_?.forEach(o=>o.hostUpdate?.()),this.update(t)):this._$Ej()}catch(o){throw e=!1,this._$Ej(),o}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$E_?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ej(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Eg}shouldUpdate(e){return!0}update(e){this._$ET&&=this._$ET.forEach(t=>this._$EO(t,this[t])),this._$Ej()}updated(e){}firstUpdated(e){}};dl.elementStyles=[],dl.shadowRootOptions={mode:"open"},dl[bu("elementProperties")]=new Map,dl[bu("finalized")]=new Map,qO?.({ReactiveElement:dl}),(pf.reactiveElementVersions??=[]).push("2.0.3")});var Js,$S,wu,OS,MS=y(()=>{l();c();d();PS();Js={INITIAL:0,PENDING:1,COMPLETE:2,ERROR:3},$S=Symbol(),wu=class{get taskComplete(){return this.t||(this.status===1?this.t=new Promise((e,t)=>{this.i=e,this.o=t}):this.status===3?this.t=Promise.reject(this.h):this.t=Promise.resolve(this.l)),this.t}constructor(e,t,o){this.u=0,this.status=0,(this.p=e).addController(this);let i=typeof t=="object"?t:{task:t,args:o};this._=i.task,this.v=i.args,this.j=i.argsEqual??OS,this.m=i.onComplete,this.g=i.onError,this.autoRun=i.autoRun??!0,"initialValue"in i&&(this.l=i.initialValue,this.status=2,this.k=this.A?.())}hostUpdate(){this.autoRun===!0&&this.O()}hostUpdated(){this.autoRun==="afterUpdate"&&this.O()}A(){if(this.v===void 0)return;let e=this.v();if(!Array.isArray(e))throw Error("The args function must return an array");return e}async O(){let e=this.A(),t=this.k;this.k=e,e===t||e===void 0||t!==void 0&&this.j(t,e)||await this.run(e)}async run(e){let t,o;e??=this.A(),this.k=e,this.status===1?this.T?.abort():(this.t=void 0,this.i=void 0,this.o=void 0),this.status=1,this.autoRun==="afterUpdate"?queueMicrotask(()=>this.p.requestUpdate()):this.p.requestUpdate();let i=++this.u;this.T=new AbortController;let n=!1;try{t=await this._(e,{signal:this.T.signal})}catch(s){n=!0,o=s}if(this.u===i){if(t===$S)this.status=0;else{if(n===!1){try{this.m?.(t)}catch{}this.status=2,this.i?.(t)}else{try{this.g?.(o)}catch{}this.status=3,this.o?.(o)}this.l=t,this.h=o}this.p.requestUpdate()}}abort(e){this.status===1&&this.T?.abort(e)}get value(){return this.l}get error(){return this.h}render(e){switch(this.status){case 0:return e.initial?.();case 1:return e.pending?.();case 2:return e.complete?.(this.value);case 3:return e.error?.(this.error);default:throw Error("Unexpected status: "+this.status)}}},OS=(r,e)=>r===e||r.length===e.length&&r.every((t,o)=>!ff(t,e[o]))});var Cu=y(()=>{l();c();d();MS()});var FS,DS,GO,Lr,W0=y(()=>{l();c();d();Cu();xe();gt();bn();es();lf();ou();yu();FS=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},DS=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},GO=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Lr=class extends xn{static get packageVersion(){return rs}get mediaQuery(){return this.offsetWidth<768?ss.mobile:this.offsetWidth<1200?ss.tablet:ss.desktop}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}constructor(){super(),this.providerState=oe.Loading,this.direction="ltr",this._isFirstUpdated=!1,this._task=new wu(this,{task:()=>this.loadState(),args:()=>this.args()}),this.renderLoading=()=>x`<span>Loading...</span>`,this.renderError=e=>x`<p>Error: ${e}</p>`,this.renderContent=()=>x`<!-- baseTaskComponent, please implement renderContent -->`,this.handleProviderUpdates=()=>{var e,t;this.providerState=(t=(e=V.globalProvider)===null||e===void 0?void 0:e.state)!==null&&t!==void 0?t:oe.Loading},this.handleActiveAccountUpdates=()=>{this.clearState()},this.handleLocalizationChanged=()=>{Ir.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()},this.handleDirectionChanged=()=>{this.direction=Ir.getDocumentDirection()},this.handleDirectionChanged(),this.handleLocalizationChanged()}connectedCallback(){super.connectedCallback(),Ir.onStringsUpdated(this.handleLocalizationChanged),Ir.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),Ir.removeOnStringsUpdated(this.handleLocalizationChanged),Ir.removeOnDirectionUpdated(this.handleDirectionChanged),V.removeProviderUpdatedListener(this.handleProviderUpdates),V.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(e){super.firstUpdated(e),this._isFirstUpdated=!0,V.onProviderUpdated(this.handleProviderUpdates),V.onActiveAccountChanged(this.handleActiveAccountUpdates)}clearState(){}fireCustomEvent(e,t,o=!1,i=!1,n=!1){let s=new CustomEvent(e,{bubbles:o,cancelable:i,composed:n,detail:t});return this.dispatchEvent(s)}updated(e){super.updated(e),this.fireCustomEvent("updated",void 0,!0,!1)}loadState(){return GO(this,void 0,void 0,function*(){return Promise.resolve()})}args(){return[this.providerState]}render(){return this._task.render({pending:this.renderLoading,complete:this.renderContent,error:this.renderError})}};FS([X(),DS("design:type",Number)],Lr.prototype,"providerState",void 0);FS([X(),DS("design:type",String)],Lr.prototype,"direction",void 0)});var as,Q0,LS,mf=y(()=>{l();c();d();as=(r,e)=>Q0(r,e,new Set),Q0=(r,e,t)=>{let o=Object.prototype.toString.call(r),i=Object.prototype.toString.call(e);if(typeof r=="object"&&typeof e=="object"&&o===i&&o==="[object Object]"&&!t.has(r)){t.add(r);for(let n in r)if(!Q0(r[n],e[n],t))return!1;for(let n in e)if(!Object.prototype.hasOwnProperty.call(r,n))return!1;return!0}if(Array.isArray(r)&&Array.isArray(e)&&!t.has(r)){if(t.add(r),r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!Q0(r[n],e[n],t))return!1;return!0}return r===e},LS=(r,e)=>{if(r===e)return!0;if(!r||!e||r.length!==e.length)return!1;if(r.length===0)return!0;let t=new Set(r);for(let o of e)if(!t.has(o))return!1;return!0}});var ul,gf=y(()=>{l();c();d();ul=class{static renderTemplate(e,t,o){var i;t.$parentTemplateContext&&(o=Object.assign(Object.assign({},o),{$parent:t.$parentTemplateContext}));let n;if(!((i=t.content)===null||i===void 0)&&i.childNodes.length){let s=t.content.cloneNode(!0);n=this.renderNode(s,e,o)}else if(t.childNodes.length){let s=document.createElement("div");for(let a of t.childNodes)s.appendChild(this.simpleCloneNode(a));n=this.renderNode(s,e,o)}n&&e.appendChild(n)}static setBindingSyntax(e,t){this._startExpression=e,this._endExpression=t;let o=this.escapeRegex(this._startExpression),i=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${o}\\s*([$\\w\\.,'"\\s()\\[\\]]+)\\s*${i}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(e){if(!e)return null;let t=e.cloneNode(!1);for(let o of e.childNodes){let i=this.simpleCloneNode(o);i&&t.appendChild(i)}return t}static expandExpressionsAsString(e,t){return e.replace(this.expression,(o,i)=>{let n=this.evalInContext(i||this.trimExpression(o),t);return n?typeof n=="object"?JSON.stringify(n):n.toString():""})}static renderNode(e,t,o){if(e.nodeName==="#text")return e.textContent=this.expandExpressionsAsString(e.textContent,o),e;if(e.nodeName==="TEMPLATE")return e.$parentTemplateContext=o,e;let i=e;if(i.attributes)for(let u of i.attributes)if(u.name==="data-props"){let h=this.trimExpression(u.value);for(let p of h.split(",")){let f=p.trim().split(":");if(f.length===2){let b=f[0].trim(),C=this.evalInContext(f[1].trim(),o);b.startsWith("@")?typeof C=="function"&&i.addEventListener(b.substring(1),S=>C(S,o,t)):i[b]=C}}}else i.setAttribute(u.name,this.expandExpressionsAsString(u.value,o));let n=[],s=[],a=!1;for(let u of e.childNodes){let h=u,p=!1;if(h.dataset){let f=!1;if(h.dataset.if){let b=h.dataset.if;this.evalBoolInContext(this.trimExpression(b),o)?(h.removeAttribute("data-if"),a=!0,p=!0):(s.push(h),f=!0)}else typeof h.dataset.else<"u"&&(a?(s.push(h),f=!0):h.removeAttribute("data-else"));h.dataset.for&&!f?n.push(h):f||this.renderNode(u,t,o)}else this.renderNode(u,t,o);!p&&u.nodeName!=="#text"&&(a=!1)}for(let u of s)i.removeChild(u);for(let u of n){let h=u.dataset.for,p=this.trimExpression(h).split(/\s(in|of)\s/i);if(p.length===3){let f=p[0].trim(),b=p[2].trim(),C=this.evalInContext(b,o);if(Array.isArray(C)){u.removeAttribute("data-for");for(let S=0;S<C.length;S++){let R=Object.assign({$index:S},o);R[f]=C[S];let N=u.cloneNode(!0);this.renderNode(N,t,R),i.insertBefore(N,u)}}i.removeChild(u)}}return e}static evalBoolInContext(e,t){return t=Object.assign(Object.assign({},t),this.globalContext),new Function("with(this) { return !!("+e+")}").call(t)}static evalInContext(e,t){t=Object.assign(Object.assign({},t),this.globalContext);let o=new Function("with(this) { return "+e+";}"),i;try{i=o.call(t)}catch{}return i}static trimExpression(e){return e=e.trim(),e.startsWith(this._startExpression)&&e.endsWith(this._endExpression)&&(e=e.substr(this._startExpression.length,e.length-this._startExpression.length-this._endExpression.length),e=e.trim()),e}};ul._globalContext={}});var NS,HS,vf,US=y(()=>{l();c();d();gt();xe();mf();yu();gf();NS=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},HS=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},vf=class extends kn{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,o){if(!this.hasTemplate(e))return null;o=o||e,this._slotNamesAddedDuringRender.push(o),this._renderedSlots=!0;let i=x`
      <slot name=${o}></slot>
    `,n=Object.assign(Object.assign({},t),this.templateContext);if(Object.prototype.hasOwnProperty.call(this._renderedTemplates,o)){let{context:u,slot:h}=this._renderedTemplates[o];if(as(u,n))return i;this.removeChild(h)}let s=document.createElement("div");s.slot=o,s.dataset.generated="template",ul.renderTemplate(s,this.templates[e],n),this.appendChild(s),this._renderedTemplates[o]={context:n,slot:s};let a={templateType:e,context:n,element:s};return this.fireCustomEvent("templateRendered",a),i}hasTemplate(e){var t;return!!(!((t=this.templates)===null||t===void 0)&&t[e])}getTemplates(){let e={};for(let t=0;t<this.children.length;t++){let o=this.children[t];if(o.nodeName==="TEMPLATE"){let i=o;i.dataset.type?e[i.dataset.type]=i:e.default=i,i.templateOrder=t}}return e}renderError(){return this.hasTemplate("error")?this.renderTemplate("error",this.error):x`
      <div class="error">
        ${this.error}
      </div>
    `}removeUnusedSlottedElements(){var e;if(this._renderedSlots){for(let t=0;t<this.children.length;t++){let o=this.children[t];!((e=o.dataset)===null||e===void 0)&&e.generated&&!this._slotNamesAddedDuringRender.includes(o.slot)&&(this.removeChild(o),delete this._renderedTemplates[o.slot],t--)}this._renderedSlots=!1}}};NS([E({attribute:!1}),HS("design:type",Object)],vf.prototype,"templateContext",void 0);NS([X(),HS("design:type",Object)],vf.prototype,"error",void 0)});var BS,zS,it,VS=y(()=>{l();c();d();gt();xe();mf();gf();W0();BS=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},zS=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},it=class extends Lr{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.renderLoading=()=>this.renderTemplate("loading",null)||x``,this.renderError=e=>this.hasTemplate("error")?this.renderTemplate("error",e):x`
      <div class="error">
        ${e}
      </div>
    `,this.templateContext=this.templateContext||{}}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,o){if(!this.hasTemplate(e))return null;o=o||e,this._slotNamesAddedDuringRender.push(o),this._renderedSlots=!0;let i=x`
      <slot name=${o}></slot>
    `,n=Object.assign(Object.assign({},t),this.templateContext);if(Object.prototype.hasOwnProperty.call(this._renderedTemplates,o)){let{context:u,slot:h}=this._renderedTemplates[o];if(as(u,n))return i;this.removeChild(h)}let s=document.createElement("div");s.slot=o,s.dataset.generated="template",ul.renderTemplate(s,this.templates[e],n),this.appendChild(s),this._renderedTemplates[o]={context:n,slot:s};let a={templateType:e,context:n,element:s};return this.fireCustomEvent("templateRendered",a),i}hasTemplate(e){var t;return!!(!((t=this.templates)===null||t===void 0)&&t[e])}getTemplates(){let e={};for(let t=0;t<this.children.length;t++){let o=this.children[t];if(o.nodeName==="TEMPLATE"){let i=o;i.dataset.type?e[i.dataset.type]=i:e.default=i,i.templateOrder=t}}return e}removeUnusedSlottedElements(){var e;if(this._renderedSlots){for(let t=0;t<this.children.length;t++){let o=this.children[t];!((e=o.dataset)===null||e===void 0)&&e.generated&&!this._slotNamesAddedDuringRender.includes(o.slot)&&(this.removeChild(o),delete this._renderedTemplates[o.slot],t--)}this._renderedSlots=!1}}};BS([E({attribute:!1}),zS("design:type",Object)],it.prototype,"templateContext",void 0);BS([X(),zS("design:type",Object)],it.prototype,"error",void 0)});var qS=y(()=>{l();c();d();iu();bn()});var GS=y(()=>{l();c();d()});var jS=y(()=>{l();c();d()});function jO(){return KS||(KS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function KO(){return WS||(WS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}function WO(r){let e=new Promise((t,o)=>{let i=()=>{r.removeEventListener("success",n),r.removeEventListener("error",s)},n=()=>{t(hl(r.result)),i()},s=()=>{o(r.error),i()};r.addEventListener("success",n),r.addEventListener("error",s)});return yf.set(e,r),e}function QO(r){if(X0.has(r))return;let e=new Promise((t,o)=>{let i=()=>{r.removeEventListener("complete",n),r.removeEventListener("error",s),r.removeEventListener("abort",s)},n=()=>{t(),i()},s=()=>{o(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",n),r.addEventListener("error",s),r.addEventListener("abort",s)});X0.set(r,e)}function JS(r){ey=r(ey)}function YO(r){return KO().includes(r)?function(...e){return r.apply(ty(this),e),hl(this.request)}:function(...e){return hl(r.apply(ty(this),e))}}function ZO(r){return typeof r=="function"?YO(r):(r instanceof IDBTransaction&&QO(r),J0(r,jO())?new Proxy(r,ey):r)}function hl(r){if(r instanceof IDBRequest)return WO(r);if(Y0.has(r))return Y0.get(r);let e=ZO(r);return e!==r&&(Y0.set(r,e),yf.set(e,r)),e}function XS(r,e,{blocked:t,upgrade:o,blocking:i,terminated:n}={}){let s=indexedDB.open(r,e),a=hl(s);return o&&s.addEventListener("upgradeneeded",u=>{o(hl(s.result),u.oldVersion,u.newVersion,hl(s.transaction),u)}),t&&s.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{n&&u.addEventListener("close",()=>n()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}function QS(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Z0.get(e))return Z0.get(e);let t=e.replace(/FromIndex$/,""),o=e!==t,i=XO.includes(t);if(!(t in(o?IDBIndex:IDBObjectStore).prototype)||!(i||JO.includes(t)))return;let n=async function(s,...a){let u=this.transaction(s,i?"readwrite":"readonly"),h=u.store;return o&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),i&&u.done]))[0]};return Z0.set(e,n),n}async function*r9(...r){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...r)),!e)return;e=e;let t=new Proxy(e,t9);for(e_.set(t,e),yf.set(t,ty(e));e;)yield t,e=await(ry.get(t)||e.continue()),ry.delete(t)}function ZS(r,e){return e===Symbol.asyncIterator&&J0(r,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&J0(r,[IDBIndex,IDBObjectStore])}var J0,KS,WS,X0,Y0,yf,ey,ty,JO,XO,Z0,e9,YS,ry,e_,t9,t_=y(()=>{l();c();d();J0=(r,e)=>e.some(t=>r instanceof t);X0=new WeakMap,Y0=new WeakMap,yf=new WeakMap;ey={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return X0.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return hl(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};ty=r=>yf.get(r);JO=["get","getKey","getAll","getAllKeys","count"],XO=["put","add","delete","clear"],Z0=new Map;JS(r=>({...r,get:(e,t,o)=>QS(e,t)||r.get(e,t,o),has:(e,t)=>!!QS(e,t)||r.has(e,t)}));e9=["continue","continuePrimaryKey","advance"],YS={},ry=new WeakMap,e_=new WeakMap,t9={get(r,e){if(!e9.includes(e))return r[e];let t=YS[e];return t||(t=YS[e]=function(...o){ry.set(this,e_.get(this)[e](...o))}),t}};JS(r=>({...r,get(e,t,o){return ZS(e,t)?r9:r.get(e,t,o)},has(e,t){return ZS(e,t)||r.has(e,t)}}))});var pl,bf=y(()=>{l();c();d();pl="mgt-db-list"});var xu,wf,oy=y(()=>{l();c();d();t_();es();bf();xu=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},wf=class{constructor(e,t){if(!(t in e.stores))throw Error('"store" must be defined in the "schema"');this.schema=e,this.store=t}getValue(e){return xu(this,void 0,void 0,function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,e)}catch{return null}})}putValue(e,t){return xu(this,void 0,void 0,function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},t),{timeCached:Date.now()}),e)}catch{return}})}clearStore(){return xu(this,void 0,void 0,function*(){if(window.indexedDB)try{yield(yield this.getDb()).clear(this.store)}catch{return}})}getDBName(){return xu(this,void 0,void 0,function*(){let e=yield V.getCacheId();if(e)return`mgt-${this.schema.name}-${e}`})}getDb(){return xu(this,void 0,void 0,function*(){let e=yield this.getDBName();if(e)return XS(e,this.schema.version,{upgrade:(t,o,i,n)=>{let s=JSON.parse(localStorage.getItem(pl))||[];s.includes(e)||s.push(e),localStorage.setItem(pl,JSON.stringify(s));for(let a in this.schema.stores)Object.prototype.hasOwnProperty.call(this.schema.stores,a)&&!t.objectStoreNames.contains(a)&&t.createObjectStore(a)}})})}}});var o9,W,r_=y(()=>{l();c();d();es();bn();oy();bf();o9=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},W=class{static getCache(e,t){let o=`${e.name}/${t}`;return this.isInitialized||this.init(),this.cacheStore.has(t)||this.cacheStore.set(o,new wf(e,t)),this.cacheStore.get(o)}static clearCacheById(e){let t=[],o=JSON.parse(localStorage.getItem(pl));if(o){let i=[];o.forEach(n=>{n.includes(e)?t.push(new Promise((s,a)=>{let u=indexedDB.deleteDatabase(n);u.onsuccess=()=>s(),u.onerror=()=>{console.error(`\u{1F992}: ${u.error.name} occurred deleting cache: ${n}`,u.error.message),a()}})):i.push(n)}),i.length>0?localStorage.setItem(pl,JSON.stringify(i)):localStorage.removeItem(pl)}return Promise.all(t)}static get config(){return this.cacheConfig}static init(){let e;V.globalProvider&&(e=V.globalProvider.state),V.onProviderUpdated(()=>o9(this,void 0,void 0,function*(){if(e===oe.SignedIn&&V.globalProvider.state===oe.SignedOut){let t=yield V.getCacheId();t!==null&&(yield this.clearCacheById(t))}e=V.globalProvider.state})),this.isInitialized=!0}};W.cacheStore=new Map;W.isInitialized=!1;W.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}}});var Sn,o_=y(()=>{l();c();d();Sn=class{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(e){this._microsoftTeamsLib=e}static get isAvailable(){return this.microsoftTeamsLib?window.parent===window.self&&window.nativeInterface?!0:window.name==="embedded-page-container"||window.name==="extension-tab-frame":!1}static executeDeepLink(e,t){let o=this.microsoftTeamsLib;o.initialize(),o.executeDeepLink(e,t)}}});var i_=y(()=>{l();c();d()});var n_,ls,s_=y(()=>{l();c();d();n_=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},ls=class r{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(e,t,o){return n_(this,void 0,void 0,function*(){let i=yield t.get();if(i?.value){let n=new r;return n._graph=e,n._value=i.value,n._nextLink=i["@odata.nextLink"],n._version=o||e.version,n}return null})}static createFromValue(e,t,o=null){let i=new r;return i._graph=e,i._value=t,i._nextLink=o,i._version=e.version,i}get nextLink(){return this._nextLink||""}next(){var e;return n_(this,void 0,void 0,function*(){if(this._nextLink){let t=this._nextLink.split(this._version)[1],o=yield this._graph.api(t).version(this._version).get();if(!((e=o?.value)===null||e===void 0)&&e.length)return this._value=this._value.concat(o.value),this._nextLink=o["@odata.nextLink"],o.value}return null})}}});var a_,l_,i9,Te,c_=y(()=>{l();c();d();xe();bc();a_=new WeakMap,l_=(r,e,t)=>{let o=[];for(let i of r)o.push(i.replace(e,t));return o},i9=(r,...e)=>{if(yr.isDisambiguated){let t=a_.get(r);if(!t){let o=new RegExp("(</?)mgt-(?!"+yr.disambiguation+"-)"),i=`$1${yr.prefix}-`;t=Object.assign(l_(r,o,i),{raw:l_(r.raw,o,i)}),a_.set(r,t)}r=t}return x(r,...e)},Te=i9});var d_=y(()=>{l();c();d();gt();bc()});var ku,Re,u_=y(()=>{l();c();d();bc();ku=r=>`${yr.prefix}-${r}`,Re=(r,e,t)=>{let o=ku(r);customElements.get(o)||customElements.define(o,e,t)}});var h_=y(()=>{l();c();d();bn();es()});var p_=y(()=>{l();c();d()});var Cf,f_,m_=y(()=>{l();c();d();Cf=class{constructor(){this.session=window.sessionStorage}setItem(e,t){this.session.setItem(e,t)}getItem(e){return this.session.getItem(e)}clear(){this.session.clear()}},f_=r=>{let e;try{r==="sessionStorage"?e=window.sessionStorage:e=window.localStorage;let t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0}}});var g_,Su,v_=y(()=>{l();c();d();m_();g_=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Su=class r{static get _sessionCache(){return!this._cache&&f_("sessionStorage")&&(this._cache=new Cf),this._cache}execute(e){return g_(this,void 0,void 0,function*(){try{let t=yield r.getBaseUrl();e.request=t+encodeURIComponent(e.request)}catch{}return yield this._nextMiddleware.execute(e)})}setNext(e){this._nextMiddleware=e}static getBaseUrl(){var e,t;return g_(this,void 0,void 0,function*(){if(!this._baseUrl){let o=(e=this._sessionCache)===null||e===void 0?void 0:e.getItem("endpointURL");if(o)this._baseUrl=o;else{try{let n=yield(yield fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint")).json();typeof n!="string"?r.setBaseFallbackUrl():this._baseUrl=n+"?url="}catch{r.setBaseFallbackUrl()}(t=this._sessionCache)===null||t===void 0||t.setItem("endpointURL",this._baseUrl)}}return this._baseUrl})}static setBaseFallbackUrl(){this._baseUrl="https://graph.office.net/en-us/graph/api/proxy?url="}}});var n9,xf,y_=y(()=>{l();c();d();Ja();iu();Up();v_();n9=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},xf=class r extends Xa{static create(e){return n9(this,void 0,void 0,function*(){let t=[new Ki(e),new ii(new Dr),new Ho,new Su,new Cn];return new r(Za.initWithMiddleware({middleware:Hp(...t),customHosts:new Set([new URL(yield Su.getBaseUrl()).hostname])}))})}forComponent(e){return this}}});var iy,kf,b_=y(()=>{l();c();d();bn();y_();iy=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},kf=class extends Ka{constructor(e=!1,t=[]){super(),this._accounts=[],this._mockGraphPromise=xf.create(this);let o=!!t.length;this.isMultipleAccountSupported=o,this.isMultipleAccountDisabled=!o,this._accounts=t,this.initializeMockGraph(e)}get isMultiAccountSupportedAndEnabled(){return!this.isMultipleAccountDisabled&&this.isMultipleAccountSupported}getAllAccounts(){return this._accounts}getActiveAccount(){if(this._accounts.length)return this._accounts[0]}login(){return iy(this,void 0,void 0,function*(){this.setState(oe.Loading),yield this._mockGraphPromise,yield new Promise(e=>setTimeout(e,3e3)),this.setState(oe.SignedIn)})}logout(){return iy(this,void 0,void 0,function*(){this.setState(oe.Loading),yield this._mockGraphPromise,yield new Promise(e=>setTimeout(e,3e3)),this.setState(oe.SignedOut)})}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}initializeMockGraph(e=!1){return iy(this,void 0,void 0,function*(){this.graph=yield this._mockGraphPromise,e?this.setState(oe.SignedIn):this.setState(oe.SignedOut)})}}});var ge=y(()=>{l();c();d();t0();jd();iu();Ak();yu();_S();W0();US();VS();bc();bn();es();qS();GS();jS();r_();oy();bf();qd();mf();Up();y0();vp();o_();i_();gf();s_();lf();c_();d_();u_();h_();ou();p_();b_()});var Y_,Z_=y(()=>{l();c();d();xe();Y_=[Oe`

`]});var J_,X_,ys=y(()=>{l();c();d();Z_();J_=document.createElement("style");J_.appendChild(document.createTextNode(`
@font-face {
    font-family: 'FabricMDL2Icons';
    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),
    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format("woff"),
    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format("truetype");
}
`));document.head.appendChild(J_);X_=document.createElement("style");X_.innerHTML=Y_.toString();document.head.appendChild(X_)});function zf(){let r=new WeakMap;return function(e){let t=r.get(e);if(t===void 0){let o=Reflect.getPrototypeOf(e);for(;t===void 0&&o!==null;)t=r.get(o),o=Reflect.getPrototypeOf(o);t=t===void 0?[]:t.slice(0),r.set(e,t)}return t}}var tn,eT,kl,wi,bs=y(()=>{l();c();d();tn=function(){if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof window<"u")return window;try{return new Function("return this")()}catch{return{}}}();tn.trustedTypes===void 0&&(tn.trustedTypes={createPolicy:(r,e)=>e});eT={configurable:!1,enumerable:!1,writable:!1};tn.FAST===void 0&&Reflect.defineProperty(tn,"FAST",Object.assign({value:Object.create(null)},eT));kl=tn.FAST;if(kl.getById===void 0){let r=Object.create(null);Reflect.defineProperty(kl,"getById",Object.assign({value(e,t){let o=r[e];return o===void 0&&(o=t?r[e]=t():null),o}},eT))}wi=Object.freeze([])});var Dy,tT,Ly,Du,Ny,Vf,Y,Ci=y(()=>{l();c();d();bs();Dy=tn.FAST.getById(1,()=>{let r=[],e=[];function t(){if(e.length)throw e.shift()}function o(s){try{s.call()}catch(a){e.push(a),setTimeout(t,0)}}function i(){let a=0;for(;a<r.length;)if(o(r[a]),a++,a>1024){for(let u=0,h=r.length-a;u<h;u++)r[u]=r[u+a];r.length-=a,a=0}r.length=0}function n(s){r.length<1&&tn.requestAnimationFrame(i),r.push(s)}return Object.freeze({enqueue:n,process:i})}),tT=tn.trustedTypes.createPolicy("fast-html",{createHTML:r=>r}),Ly=tT,Du=`fast-${Math.random().toString(36).substring(2,8)}`,Ny=`${Du}{`,Vf=`}${Du}`,Y=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(r){if(Ly!==tT)throw new Error("The HTML policy can only be set once.");Ly=r},createHTML(r){return Ly.createHTML(r)},isMarker(r){return r&&r.nodeType===8&&r.data.startsWith(Du)},extractDirectiveIndexFromMarker(r){return parseInt(r.data.replace(`${Du}:`,""))},createInterpolationPlaceholder(r){return`${Ny}${r}${Vf}`},createCustomAttributePlaceholder(r,e){return`${r}="${this.createInterpolationPlaceholder(e)}"`},createBlockPlaceholder(r){return`<!--${Du}:${r}-->`},queueUpdate:Dy.enqueue,processUpdates:Dy.process,nextUpdate(){return new Promise(Dy.enqueue)},setAttribute(r,e,t){t==null?r.removeAttribute(e):r.setAttribute(e,t)},setBooleanAttribute(r,e,t){t?r.setAttribute(e,""):r.removeAttribute(e)},removeChildNodes(r){for(let e=r.firstChild;e!==null;e=r.firstChild)r.removeChild(e)},createTemplateWalker(r){return document.createTreeWalker(r,133,null,!1)}})});var Rn,Fc,Lu=y(()=>{l();c();d();Rn=class{constructor(e,t){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=e,this.sub1=t}has(e){return this.spillover===void 0?this.sub1===e||this.sub2===e:this.spillover.indexOf(e)!==-1}subscribe(e){let t=this.spillover;if(t===void 0){if(this.has(e))return;if(this.sub1===void 0){this.sub1=e;return}if(this.sub2===void 0){this.sub2=e;return}this.spillover=[this.sub1,this.sub2,e],this.sub1=void 0,this.sub2=void 0}else t.indexOf(e)===-1&&t.push(e)}unsubscribe(e){let t=this.spillover;if(t===void 0)this.sub1===e?this.sub1=void 0:this.sub2===e&&(this.sub2=void 0);else{let o=t.indexOf(e);o!==-1&&t.splice(o,1)}}notify(e){let t=this.spillover,o=this.source;if(t===void 0){let i=this.sub1,n=this.sub2;i!==void 0&&i.handleChange(o,e),n!==void 0&&n.handleChange(o,e)}else for(let i=0,n=t.length;i<n;++i)t[i].handleChange(o,e)}},Fc=class{constructor(e){this.subscribers={},this.sourceSubscribers=null,this.source=e}notify(e){var t;let o=this.subscribers[e];o!==void 0&&o.notify(e),(t=this.sourceSubscribers)===null||t===void 0||t.notify(e)}subscribe(e,t){var o;if(t){let i=this.subscribers[t];i===void 0&&(this.subscribers[t]=i=new Rn(this.source)),i.subscribe(e)}else this.sourceSubscribers=(o=this.sourceSubscribers)!==null&&o!==void 0?o:new Rn(this.source),this.sourceSubscribers.subscribe(e)}unsubscribe(e,t){var o;if(t){let i=this.subscribers[t];i!==void 0&&i.unsubscribe(e)}else(o=this.sourceSubscribers)===null||o===void 0||o.unsubscribe(e)}}});function I(r,e){pe.defineProperty(r,e)}function oT(r,e,t){return Object.assign({},t,{get:function(){return pe.trackVolatile(),t.get.apply(this)}})}var pe,rT,aa,la,Pn=y(()=>{l();c();d();Ci();bs();Lu();pe=kl.getById(2,()=>{let r=/(:|&&|\|\||if)/,e=new WeakMap,t=Y.queueUpdate,o,i=h=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function n(h){let p=h.$fastController||e.get(h);return p===void 0&&(Array.isArray(h)?p=i(h):e.set(h,p=new Fc(h))),p}let s=zf();class a{constructor(p){this.name=p,this.field=`_${p}`,this.callback=`${p}Changed`}getValue(p){return o!==void 0&&o.watch(p,this.name),p[this.field]}setValue(p,f){let b=this.field,C=p[b];if(C!==f){p[b]=f;let S=p[this.callback];typeof S=="function"&&S.call(p,C,f),n(p).notify(this.name)}}}class u extends Rn{constructor(p,f,b=!1){super(p,f),this.binding=p,this.isVolatileBinding=b,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(p,f){this.needsRefresh&&this.last!==null&&this.disconnect();let b=o;o=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;let C=this.binding(p,f);return o=b,C}disconnect(){if(this.last!==null){let p=this.first;for(;p!==void 0;)p.notifier.unsubscribe(this,p.propertyName),p=p.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(p,f){let b=this.last,C=n(p),S=b===null?this.first:{};if(S.propertySource=p,S.propertyName=f,S.notifier=C,C.subscribe(this,f),b!==null){if(!this.needsRefresh){let R;o=void 0,R=b.propertySource[b.propertyName],o=this,p===R&&(this.needsRefresh=!0)}b.next=S}this.last=S}handleChange(){this.needsQueue&&(this.needsQueue=!1,t(this))}call(){this.last!==null&&(this.needsQueue=!0,this.notify(this))}records(){let p=this.first;return{next:()=>{let f=p;return f===void 0?{value:void 0,done:!0}:(p=p.next,{value:f,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(h){i=h},getNotifier:n,track(h,p){o!==void 0&&o.watch(h,p)},trackVolatile(){o!==void 0&&(o.needsRefresh=!0)},notify(h,p){n(h).notify(p)},defineProperty(h,p){typeof p=="string"&&(p=new a(p)),s(h).push(p),Reflect.defineProperty(h,p.name,{enumerable:!0,get:function(){return p.getValue(this)},set:function(f){p.setValue(this,f)}})},getAccessors:s,binding(h,p,f=this.isVolatileBinding(h)){return new u(h,p,f)},isVolatileBinding(h){return r.test(h.toString())}})});rT=kl.getById(3,()=>{let r=null;return{get(){return r},set(e){r=e}}}),aa=class{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return rT.get()}get isEven(){return this.index%2===0}get isOdd(){return this.index%2!==0}get isFirst(){return this.index===0}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(e){rT.set(e)}};pe.defineProperty(aa.prototype,"index");pe.defineProperty(aa.prototype,"length");la=Object.seal(new aa)});var ca,Dc,ws,da=y(()=>{l();c();d();Ci();ca=class{constructor(){this.targetIndex=0}},Dc=class extends ca{constructor(){super(...arguments),this.createPlaceholder=Y.createInterpolationPlaceholder}},ws=class extends ca{constructor(e,t,o){super(),this.name=e,this.behavior=t,this.options=o}createPlaceholder(e){return Y.createCustomAttributePlaceholder(this.name,e)}createBehavior(e){return new this.behavior(e,this.options)}}});function P9(r,e){this.source=r,this.context=e,this.bindingObserver===null&&(this.bindingObserver=pe.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(r,e))}function $9(r,e){this.source=r,this.context=e,this.target.addEventListener(this.targetName,this)}function O9(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function M9(){this.bindingObserver.disconnect(),this.source=null,this.context=null;let r=this.target.$fastView;r!==void 0&&r.isComposed&&(r.unbind(),r.needsBindOnly=!0)}function F9(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function D9(r){Y.setAttribute(this.target,this.targetName,r)}function L9(r){Y.setBooleanAttribute(this.target,this.targetName,r)}function N9(r){if(r==null&&(r=""),r.create){this.target.textContent="";let e=this.target.$fastView;e===void 0?e=r.create():this.target.$fastTemplate!==r&&(e.isComposed&&(e.remove(),e.unbind()),e=r.create()),e.isComposed?e.needsBindOnly&&(e.needsBindOnly=!1,e.bind(this.source,this.context)):(e.isComposed=!0,e.bind(this.source,this.context),e.insertBefore(this.target),this.target.$fastView=e,this.target.$fastTemplate=r)}else{let e=this.target.$fastView;e!==void 0&&e.isComposed&&(e.isComposed=!1,e.remove(),e.needsBindOnly?e.needsBindOnly=!1:e.unbind()),this.target.textContent=r}}function H9(r){this.target[this.targetName]=r}function U9(r){let e=this.classVersions||Object.create(null),t=this.target,o=this.version||0;if(r!=null&&r.length){let i=r.split(/\s+/);for(let n=0,s=i.length;n<s;++n){let a=i[n];a!==""&&(e[a]=o,t.classList.add(a))}}if(this.classVersions=e,this.version=o+1,o!==0){o-=1;for(let i in e)e[i]===o&&t.classList.remove(i)}}var Sl,Hy,qf=y(()=>{l();c();d();Ci();Pn();da();Sl=class extends Dc{constructor(e){super(),this.binding=e,this.bind=P9,this.unbind=O9,this.updateTarget=D9,this.isBindingVolatile=pe.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(e){if(this.originalTargetName=e,e!==void 0)switch(e[0]){case":":if(this.cleanedTargetName=e.substr(1),this.updateTarget=H9,this.cleanedTargetName==="innerHTML"){let t=this.binding;this.binding=(o,i)=>Y.createHTML(t(o,i))}break;case"?":this.cleanedTargetName=e.substr(1),this.updateTarget=L9;break;case"@":this.cleanedTargetName=e.substr(1),this.bind=$9,this.unbind=F9;break;default:this.cleanedTargetName=e,e==="class"&&(this.updateTarget=U9);break}}targetAtContent(){this.updateTarget=N9,this.unbind=M9}createBehavior(e){return new Hy(e,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}},Hy=class{constructor(e,t,o,i,n,s,a){this.source=null,this.context=null,this.bindingObserver=null,this.target=e,this.binding=t,this.isBindingVolatile=o,this.bind=i,this.unbind=n,this.updateTarget=s,this.targetName=a}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(e){aa.setEvent(e);let t=this.binding(this.source,this.context);aa.setEvent(null),t!==!0&&e.preventDefault()}}});function B9(r){if(r.length===1)return r[0];let e,t=r.length,o=r.map(s=>typeof s=="string"?()=>s:(e=s.targetName||e,s.binding)),i=(s,a)=>{let u="";for(let h=0;h<t;++h)u+=o[h](s,a);return u},n=new Sl(i);return n.targetName=e,n}function nT(r,e){let t=e.split(Ny);if(t.length===1)return null;let o=[];for(let i=0,n=t.length;i<n;++i){let s=t[i],a=s.indexOf(Vf),u;if(a===-1)u=s;else{let h=parseInt(s.substring(0,a));o.push(r.directives[h]),u=s.substring(a+z9)}u!==""&&o.push(u)}return o}function iT(r,e,t=!1){let o=e.attributes;for(let i=0,n=o.length;i<n;++i){let s=o[i],a=s.value,u=nT(r,a),h=null;u===null?t&&(h=new Sl(()=>a),h.targetName=s.name):h=B9(u),h!==null&&(e.removeAttributeNode(s),i--,n--,r.addFactory(h))}}function V9(r,e,t){let o=nT(r,e.textContent);if(o!==null){let i=e;for(let n=0,s=o.length;n<s;++n){let a=o[n],u=n===0?e:i.parentNode.insertBefore(document.createTextNode(""),i.nextSibling);typeof a=="string"?u.textContent=a:(u.textContent=" ",r.captureContentBinding(a)),i=u,r.targetIndex++,u!==e&&t.nextNode()}r.targetIndex--}}function sT(r,e){let t=r.content;document.adoptNode(t);let o=By.borrow(e);iT(o,r,!0);let i=o.behaviorFactories;o.reset();let n=Y.createTemplateWalker(t),s;for(;s=n.nextNode();)switch(o.targetIndex++,s.nodeType){case 1:iT(o,s);break;case 3:V9(o,s,n);break;case 8:Y.isMarker(s)&&o.addFactory(e[Y.extractDirectiveIndexFromMarker(s)])}let a=0;(Y.isMarker(t.firstChild)||t.childNodes.length===1&&e.length)&&(t.insertBefore(document.createComment(""),t.firstChild),a=-1);let u=o.behaviorFactories;return o.release(),{fragment:t,viewBehaviorFactories:u,hostBehaviorFactories:i,targetOffset:a}}var Uy,By,z9,zy=y(()=>{l();c();d();Ci();qf();Uy=null,By=class r{addFactory(e){e.targetIndex=this.targetIndex,this.behaviorFactories.push(e)}captureContentBinding(e){e.targetAtContent(),this.addFactory(e)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){Uy=this}static borrow(e){let t=Uy||new r;return t.directives=e,t.reset(),Uy=null,t}};z9=Vf.length});var Vy,Lc,Gf=y(()=>{l();c();d();Vy=document.createRange(),Lc=class{constructor(e,t){this.fragment=e,this.behaviors=t,this.source=null,this.context=null,this.firstChild=e.firstChild,this.lastChild=e.lastChild}appendTo(e){e.appendChild(this.fragment)}insertBefore(e){if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{let t=this.lastChild;if(e.previousSibling===t)return;let o=e.parentNode,i=this.firstChild,n;for(;i!==t;)n=i.nextSibling,o.insertBefore(i,e),i=n;o.insertBefore(t,e)}}remove(){let e=this.fragment,t=this.lastChild,o=this.firstChild,i;for(;o!==t;)i=o.nextSibling,e.appendChild(o),o=i;e.appendChild(t)}dispose(){let e=this.firstChild.parentNode,t=this.lastChild,o=this.firstChild,i;for(;o!==t;)i=o.nextSibling,e.removeChild(o),o=i;e.removeChild(t);let n=this.behaviors,s=this.source;for(let a=0,u=n.length;a<u;++a)n[a].unbind(s)}bind(e,t){let o=this.behaviors;if(this.source!==e)if(this.source!==null){let i=this.source;this.source=e,this.context=t;for(let n=0,s=o.length;n<s;++n){let a=o[n];a.unbind(i),a.bind(e,t)}}else{this.source=e,this.context=t;for(let i=0,n=o.length;i<n;++i)o[i].bind(e,t)}}unbind(){if(this.source===null)return;let e=this.behaviors,t=this.source;for(let o=0,i=e.length;o<i;++o)e[o].unbind(t);this.source=null}static disposeContiguousBatch(e){if(e.length!==0){Vy.setStartBefore(e[0].firstChild),Vy.setEndAfter(e[e.length-1].lastChild),Vy.deleteContents();for(let t=0,o=e.length;t<o;++t){let i=e[t],n=i.behaviors,s=i.source;for(let a=0,u=n.length;a<u;++a)n[a].unbind(s)}}}}});function O(r,...e){let t=[],o="";for(let i=0,n=r.length-1;i<n;++i){let s=r[i],a=e[i];if(o+=s,a instanceof jf){let u=a;a=()=>u}if(typeof a=="function"&&(a=new Sl(a)),a instanceof Dc){let u=q9.exec(s);u!==null&&(a.targetName=u[2])}a instanceof ca?(o+=a.createPlaceholder(t.length),t.push(a)):o+=a}return o+=r[r.length-1],new jf(o,t)}var jf,q9,aT=y(()=>{l();c();d();Ci();Pn();zy();Gf();da();qf();jf=class{constructor(e,t){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=e,this.directives=t}create(e){if(this.fragment===null){let h,p=this.html;if(typeof p=="string"){h=document.createElement("template"),h.innerHTML=Y.createHTML(p);let b=h.content.firstElementChild;b!==null&&b.tagName==="TEMPLATE"&&(h=b)}else h=p;let f=sT(h,this.directives);this.fragment=f.fragment,this.viewBehaviorFactories=f.viewBehaviorFactories,this.hostBehaviorFactories=f.hostBehaviorFactories,this.targetOffset=f.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}let t=this.fragment.cloneNode(!0),o=this.viewBehaviorFactories,i=new Array(this.behaviorCount),n=Y.createTemplateWalker(t),s=0,a=this.targetOffset,u=n.nextNode();for(let h=o.length;s<h;++s){let p=o[s],f=p.targetIndex;for(;u!==null;)if(a===f){i[s]=p.createBehavior(u);break}else u=n.nextNode(),a++}if(this.hasHostBehaviors){let h=this.hostBehaviorFactories;for(let p=0,f=h.length;p<f;++p,++s)i[s]=h[p].createBehavior(e)}return new Lc(t,i)}render(e,t,o){typeof t=="string"&&(t=document.getElementById(t)),o===void 0&&(o=t);let i=this.create(o);return i.bind(e,la),i.appendTo(t),i}},q9=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/});function jy(r){return r.map(e=>e instanceof nr?jy(e.styles):[e]).reduce((e,t)=>e.concat(t),[])}function lT(r){return r.map(e=>e instanceof nr?e.behaviors:null).reduce((e,t)=>t===null?e:(e===null&&(e=[]),e.concat(t)),null)}function cT(r){let e=[],t=[];return r.forEach(o=>(o[Kf]?e:t).push(o)),{prepend:e,append:t}}function j9(){return`fast-style-class-${++G9}`}var nr,Kf,dT,uT,qy,G9,Gy,Wf=y(()=>{l();c();d();Ci();nr=class{constructor(){this.targets=new WeakSet}addStylesTo(e){this.targets.add(e)}removeStylesFrom(e){this.targets.delete(e)}isAttachedTo(e){return this.targets.has(e)}withBehaviors(...e){return this.behaviors=this.behaviors===null?e:this.behaviors.concat(e),this}};nr.create=(()=>{if(Y.supportsAdoptedStyleSheets){let r=new Map;return e=>new qy(e,r)}return r=>new Gy(r)})();Kf=Symbol("prependToAdoptedStyleSheets");dT=(r,e)=>{let{prepend:t,append:o}=cT(e);r.adoptedStyleSheets=[...t,...r.adoptedStyleSheets,...o]},uT=(r,e)=>{r.adoptedStyleSheets=r.adoptedStyleSheets.filter(t=>e.indexOf(t)===-1)};if(Y.supportsAdoptedStyleSheets)try{document.adoptedStyleSheets.push(),document.adoptedStyleSheets.splice(),dT=(r,e)=>{let{prepend:t,append:o}=cT(e);r.adoptedStyleSheets.splice(0,0,...t),r.adoptedStyleSheets.push(...o)},uT=(r,e)=>{for(let t of e){let o=r.adoptedStyleSheets.indexOf(t);o!==-1&&r.adoptedStyleSheets.splice(o,1)}}}catch{}qy=class extends nr{constructor(e,t){super(),this.styles=e,this.styleSheetCache=t,this._styleSheets=void 0,this.behaviors=lT(e)}get styleSheets(){if(this._styleSheets===void 0){let e=this.styles,t=this.styleSheetCache;this._styleSheets=jy(e).map(o=>{if(o instanceof CSSStyleSheet)return o;let i=t.get(o);return i===void 0&&(i=new CSSStyleSheet,i.replaceSync(o),t.set(o,i)),i})}return this._styleSheets}addStylesTo(e){dT(e,this.styleSheets),super.addStylesTo(e)}removeStylesFrom(e){uT(e,this.styleSheets),super.removeStylesFrom(e)}},G9=0;Gy=class extends nr{constructor(e){super(),this.styles=e,this.behaviors=null,this.behaviors=lT(e),this.styleSheets=jy(e),this.styleClass=j9()}addStylesTo(e){let t=this.styleSheets,o=this.styleClass;e=this.normalizeTarget(e);for(let i=0;i<t.length;i++){let n=document.createElement("style");n.innerHTML=t[i],n.className=o,e.append(n)}super.addStylesTo(e)}removeStylesFrom(e){e=this.normalizeTarget(e);let t=e.querySelectorAll(`.${this.styleClass}`);for(let o=0,i=t.length;o<i;++o)e.removeChild(t[o]);super.removeStylesFrom(e)}isAttachedTo(e){return super.isAttachedTo(this.normalizeTarget(e))}normalizeTarget(e){return e===document?document.body:e}}});function k(r,e){let t;function o(i,n){arguments.length>1&&(t.property=n),Nu.locate(i.constructor).push(t)}if(arguments.length>1){t={},o(r,e);return}return t=r===void 0?{}:r,o}var Nu,Cs,se,Qf,Ky=y(()=>{l();c();d();Pn();Ci();bs();Nu=Object.freeze({locate:zf()}),Cs={toView(r){return r?"true":"false"},fromView(r){return!(r==null||r==="false"||r===!1||r===0)}},se={toView(r){if(r==null)return null;let e=r*1;return isNaN(e)?null:e.toString()},fromView(r){if(r==null)return null;let e=r*1;return isNaN(e)?null:e}},Qf=class r{constructor(e,t,o=t.toLowerCase(),i="reflect",n){this.guards=new Set,this.Owner=e,this.name=t,this.attribute=o,this.mode=i,this.converter=n,this.fieldName=`_${t}`,this.callbackName=`${t}Changed`,this.hasCallback=this.callbackName in e.prototype,i==="boolean"&&n===void 0&&(this.converter=Cs)}setValue(e,t){let o=e[this.fieldName],i=this.converter;i!==void 0&&(t=i.fromView(t)),o!==t&&(e[this.fieldName]=t,this.tryReflectToAttribute(e),this.hasCallback&&e[this.callbackName](o,t),e.$fastController.notify(this.name))}getValue(e){return pe.track(e,this.name),e[this.fieldName]}onAttributeChangedCallback(e,t){this.guards.has(e)||(this.guards.add(e),this.setValue(e,t),this.guards.delete(e))}tryReflectToAttribute(e){let t=this.mode,o=this.guards;o.has(e)||t==="fromView"||Y.queueUpdate(()=>{o.add(e);let i=e[this.fieldName];switch(t){case"reflect":let n=this.converter;Y.setAttribute(e,this.attribute,n!==void 0?n.toView(i):i);break;case"boolean":Y.setBooleanAttribute(e,this.attribute,i);break}o.delete(e)})}static collect(e,...t){let o=[];t.push(Nu.locate(e));for(let i=0,n=t.length;i<n;++i){let s=t[i];if(s!==void 0)for(let a=0,u=s.length;a<u;++a){let h=s[a];typeof h=="string"?o.push(new r(e,h)):o.push(new r(e,h.property,h.attribute,h.mode,h.converter))}}return o}}});var hT,pT,Wy,$n,Yf=y(()=>{l();c();d();bs();Pn();Wf();Ky();hT={mode:"open"},pT={},Wy=kl.getById(4,()=>{let r=new Map;return Object.freeze({register(e){return r.has(e.type)?!1:(r.set(e.type,e),!0)},getByType(e){return r.get(e)}})}),$n=class{constructor(e,t=e.definition){typeof t=="string"&&(t={name:t}),this.type=e,this.name=t.name,this.template=t.template;let o=Qf.collect(e,t.attributes),i=new Array(o.length),n={},s={};for(let a=0,u=o.length;a<u;++a){let h=o[a];i[a]=h.attribute,n[h.name]=h,s[h.attribute]=h}this.attributes=o,this.observedAttributes=i,this.propertyLookup=n,this.attributeLookup=s,this.shadowOptions=t.shadowOptions===void 0?hT:t.shadowOptions===null?void 0:Object.assign(Object.assign({},hT),t.shadowOptions),this.elementOptions=t.elementOptions===void 0?pT:Object.assign(Object.assign({},pT),t.elementOptions),this.styles=t.styles===void 0?void 0:Array.isArray(t.styles)?nr.create(t.styles):t.styles instanceof nr?t.styles:nr.create([t.styles])}get isDefined(){return!!Wy.getByType(this.type)}define(e=customElements){let t=this.type;if(Wy.register(this)){let o=this.attributes,i=t.prototype;for(let n=0,s=o.length;n<s;++n)pe.defineProperty(i,o[n]);Reflect.defineProperty(t,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return e.get(this.name)||e.define(this.name,t,this.elementOptions),this}};$n.forType=Wy.getByType});function Qy(r){return r.shadowRoot||fT.get(r)||null}var fT,K9,Zf,Yy=y(()=>{l();c();d();Ci();Lu();Pn();Yf();fT=new WeakMap,K9={bubbles:!0,composed:!0,cancelable:!0};Zf=class r extends Fc{constructor(e,t){super(e),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=e,this.definition=t;let o=t.shadowOptions;if(o!==void 0){let n=e.attachShadow(o);o.mode==="closed"&&fT.set(e,n)}let i=pe.getAccessors(e);if(i.length>0){let n=this.boundObservables=Object.create(null);for(let s=0,a=i.length;s<a;++s){let u=i[s].name,h=e[u];h!==void 0&&(delete e[u],n[u]=h)}}}get isConnected(){return pe.track(this,"isConnected"),this._isConnected}setIsConnected(e){this._isConnected=e,pe.notify(this,"isConnected")}get template(){return this._template}set template(e){this._template!==e&&(this._template=e,this.needsInitialization||this.renderTemplate(e))}get styles(){return this._styles}set styles(e){this._styles!==e&&(this._styles!==null&&this.removeStyles(this._styles),this._styles=e,!this.needsInitialization&&e!==null&&this.addStyles(e))}addStyles(e){let t=Qy(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.append(e);else if(!e.isAttachedTo(t)){let o=e.behaviors;e.addStylesTo(t),o!==null&&this.addBehaviors(o)}}removeStyles(e){let t=Qy(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.removeChild(e);else if(e.isAttachedTo(t)){let o=e.behaviors;e.removeStylesFrom(t),o!==null&&this.removeBehaviors(o)}}addBehaviors(e){let t=this.behaviors||(this.behaviors=new Map),o=e.length,i=[];for(let n=0;n<o;++n){let s=e[n];t.has(s)?t.set(s,t.get(s)+1):(t.set(s,1),i.push(s))}if(this._isConnected){let n=this.element;for(let s=0;s<i.length;++s)i[s].bind(n,la)}}removeBehaviors(e,t=!1){let o=this.behaviors;if(o===null)return;let i=e.length,n=[];for(let s=0;s<i;++s){let a=e[s];if(o.has(a)){let u=o.get(a)-1;u===0||t?o.delete(a)&&n.push(a):o.set(a,u)}}if(this._isConnected){let s=this.element;for(let a=0;a<n.length;++a)n[a].unbind(s)}}onConnectedCallback(){if(this._isConnected)return;let e=this.element;this.needsInitialization?this.finishInitialization():this.view!==null&&this.view.bind(e,la);let t=this.behaviors;if(t!==null)for(let[o]of t)o.bind(e,la);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);let e=this.view;e!==null&&e.unbind();let t=this.behaviors;if(t!==null){let o=this.element;for(let[i]of t)i.unbind(o)}}onAttributeChangedCallback(e,t,o){let i=this.definition.attributeLookup[e];i!==void 0&&i.onAttributeChangedCallback(this.element,o)}emit(e,t,o){return this._isConnected?this.element.dispatchEvent(new CustomEvent(e,Object.assign(Object.assign({detail:t},K9),o))):!1}finishInitialization(){let e=this.element,t=this.boundObservables;if(t!==null){let i=Object.keys(t);for(let n=0,s=i.length;n<s;++n){let a=i[n];e[a]=t[a]}this.boundObservables=null}let o=this.definition;this._template===null&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():o.template&&(this._template=o.template||null)),this._template!==null&&this.renderTemplate(this._template),this._styles===null&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():o.styles&&(this._styles=o.styles||null)),this._styles!==null&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(e){let t=this.element,o=Qy(t)||t;this.view!==null?(this.view.dispose(),this.view=null):this.needsInitialization||Y.removeChildNodes(o),e&&(this.view=e.render(t,o,t))}static forCustomElement(e){let t=e.$fastController;if(t!==void 0)return t;let o=$n.forType(e.constructor);if(o===void 0)throw new Error("Missing FASTElement definition.");return e.$fastController=new r(e,o)}}});function mT(r){return class extends r{constructor(){super(),Zf.forCustomElement(this)}$emit(e,t,o){return this.$fastController.emit(e,t,o)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(e,t,o){this.$fastController.onAttributeChangedCallback(e,t,o)}}}var ua,gT=y(()=>{l();c();d();Yy();Yf();ua=Object.assign(mT(HTMLElement),{from(r){return mT(r)},define(r,e){return new $n(r,e).define().type}})});var ha,Zy=y(()=>{l();c();d();ha=class{createCSS(){return""}createBehavior(){}}});function vT(r,e){let t=[],o="",i=[];for(let n=0,s=r.length-1;n<s;++n){o+=r[n];let a=e[n];if(a instanceof ha){let u=a.createBehavior();a=a.createCSS(),u&&i.push(u)}a instanceof nr||a instanceof CSSStyleSheet?(o.trim()!==""&&(t.push(o),o=""),t.push(a)):o+=a}return o+=r[r.length-1],o.trim()!==""&&t.push(o),{styles:t,behaviors:i}}function M(r,...e){let{styles:t,behaviors:o}=vT(r,e),i=nr.create(t);return o.length&&i.withBehaviors(...o),i}function Br(r,...e){let{styles:t,behaviors:o}=vT(r,e);return new Jy(t,o)}var Jy,yT=y(()=>{l();c();d();Zy();Wf();Jy=class extends ha{constructor(e,t){super(),this.behaviors=t,this.css="";let o=e.reduce((i,n)=>(typeof n=="string"?this.css+=n:i.push(n),i),[]);o.length&&(this.styles=nr.create(o))}createBehavior(){return this}createCSS(){return this.css}bind(e){this.styles&&e.$fastController.addStyles(this.styles),this.behaviors.length&&e.$fastController.addBehaviors(this.behaviors)}unbind(e){this.styles&&e.$fastController.removeStyles(this.styles),this.behaviors.length&&e.$fastController.removeBehaviors(this.behaviors)}}});function xi(r,e,t){return{index:r,removed:e,addedCount:t}}function W9(r,e,t,o,i,n){let s=n-i+1,a=t-e+1,u=new Array(s),h,p;for(let f=0;f<s;++f)u[f]=new Array(a),u[f][0]=f;for(let f=0;f<a;++f)u[0][f]=f;for(let f=1;f<s;++f)for(let b=1;b<a;++b)r[e+b-1]===o[i+f-1]?u[f][b]=u[f-1][b-1]:(h=u[f-1][b]+1,p=u[f][b-1]+1,u[f][b]=h<p?h:p);return u}function Q9(r){let e=r.length-1,t=r[0].length-1,o=r[e][t],i=[];for(;e>0||t>0;){if(e===0){i.push(Xy),t--;continue}if(t===0){i.push(eb),e--;continue}let n=r[e-1][t-1],s=r[e-1][t],a=r[e][t-1],u;s<a?u=s<n?s:n:u=a<n?a:n,u===n?(n===o?i.push(wT):(i.push(CT),o=n),e--,t--):u===s?(i.push(eb),e--,o=s):(i.push(Xy),t--,o=a)}return i.reverse(),i}function Y9(r,e,t){for(let o=0;o<t;++o)if(r[o]!==e[o])return o;return t}function Z9(r,e,t){let o=r.length,i=e.length,n=0;for(;n<t&&r[--o]===e[--i];)n++;return n}function J9(r,e,t,o){return e<t||o<r?-1:e===t||o===r?0:r<t?e<o?e-t:o-t:o<e?o-r:e-r}function tb(r,e,t,o,i,n){let s=0,a=0,u=Math.min(t-e,n-i);if(e===0&&i===0&&(s=Y9(r,o,u)),t===r.length&&n===o.length&&(a=Z9(r,o,u-s)),e+=s,i+=s,t-=a,n-=a,t-e===0&&n-i===0)return wi;if(e===t){let S=xi(e,[],0);for(;i<n;)S.removed.push(o[i++]);return[S]}else if(i===n)return[xi(e,[],t-e)];let h=Q9(W9(r,e,t,o,i,n)),p=[],f,b=e,C=i;for(let S=0;S<h.length;++S)switch(h[S]){case wT:f!==void 0&&(p.push(f),f=void 0),b++,C++;break;case CT:f===void 0&&(f=xi(b,[],0)),f.addedCount++,b++,f.removed.push(o[C]),C++;break;case Xy:f===void 0&&(f=xi(b,[],0)),f.addedCount++,b++;break;case eb:f===void 0&&(f=xi(b,[],0)),f.removed.push(o[C]),C++;break}return f!==void 0&&p.push(f),p}function X9(r,e,t,o){let i=xi(e,t,o),n=!1,s=0;for(let a=0;a<r.length;a++){let u=r[a];if(u.index+=s,n)continue;let h=J9(i.index,i.index+i.removed.length,u.index,u.index+u.addedCount);if(h>=0){r.splice(a,1),a--,s-=u.addedCount-u.removed.length,i.addedCount+=u.addedCount-h;let p=i.removed.length+u.removed.length-h;if(!i.addedCount&&!p)n=!0;else{let f=u.removed;if(i.index<u.index){let b=i.removed.slice(0,u.index-i.index);bT.apply(b,f),f=b}if(i.index+i.removed.length>u.index+u.addedCount){let b=i.removed.slice(u.index+u.addedCount-i.index);bT.apply(f,b)}i.removed=f,u.index<i.index&&(i.index=u.index)}}else if(i.index<u.index){n=!0,r.splice(a,0,i),a++;let p=i.addedCount-i.removed.length;u.index+=p,s+=p}}n||r.push(i)}function eM(r){let e=[];for(let t=0,o=r.length;t<o;t++){let i=r[t];X9(e,i.index,i.removed,i.addedCount)}return e}function xT(r,e){let t=[],o=eM(e);for(let i=0,n=o.length;i<n;++i){let s=o[i];if(s.addedCount===1&&s.removed.length===1){s.removed[0]!==r[s.index]&&t.push(s);continue}t=t.concat(tb(r,s.index,s.index+s.addedCount,s.removed,0,s.removed.length))}return t}var wT,CT,Xy,eb,bT,rb=y(()=>{l();c();d();bs();wT=0,CT=1,Xy=2,eb=3;bT=Array.prototype.push});function ob(r,e){let t=r.index,o=e.length;return t>o?t=o-r.addedCount:t<0&&(t=o+r.removed.length+t-r.addedCount),t<0&&(t=0),r.index=t,r}function nb(){if(kT)return;kT=!0,pe.setArrayObserverFactory(u=>new ib(u));let r=Array.prototype;if(r.$fastPatch)return;Reflect.defineProperty(r,"$fastPatch",{value:1,enumerable:!1});let e=r.pop,t=r.push,o=r.reverse,i=r.shift,n=r.sort,s=r.splice,a=r.unshift;r.pop=function(){let u=this.length>0,h=e.apply(this,arguments),p=this.$fastController;return p!==void 0&&u&&p.addSplice(xi(this.length,[h],0)),h},r.push=function(){let u=t.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(ob(xi(this.length-arguments.length,[],arguments.length),this)),u},r.reverse=function(){let u,h=this.$fastController;h!==void 0&&(h.flush(),u=this.slice());let p=o.apply(this,arguments);return h!==void 0&&h.reset(u),p},r.shift=function(){let u=this.length>0,h=i.apply(this,arguments),p=this.$fastController;return p!==void 0&&u&&p.addSplice(xi(0,[h],0)),h},r.sort=function(){let u,h=this.$fastController;h!==void 0&&(h.flush(),u=this.slice());let p=n.apply(this,arguments);return h!==void 0&&h.reset(u),p},r.splice=function(){let u=s.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(ob(xi(+arguments[0],u,arguments.length>2?arguments.length-2:0),this)),u},r.unshift=function(){let u=a.apply(this,arguments),h=this.$fastController;return h!==void 0&&h.addSplice(ob(xi(0,[],arguments.length),this)),u}}var kT,ib,sb=y(()=>{l();c();d();Ci();rb();Lu();Pn();kT=!1;ib=class extends Rn{constructor(e){super(e),this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this.call=this.flush,Reflect.defineProperty(e,"$fastController",{value:this,enumerable:!1})}subscribe(e){this.flush(),super.subscribe(e)}addSplice(e){this.splices===void 0?this.splices=[e]:this.splices.push(e),this.needsQueue&&(this.needsQueue=!1,Y.queueUpdate(this))}reset(e){this.oldCollection=e,this.needsQueue&&(this.needsQueue=!1,Y.queueUpdate(this))}flush(){let e=this.splices,t=this.oldCollection;if(e===void 0&&t===void 0)return;this.needsQueue=!0,this.splices=void 0,this.oldCollection=void 0;let o=t===void 0?xT(this.source,e):tb(this.source,0,this.source.length,t,0,t.length);this.notify(o)}}});function Ee(r){return new ws("fast-ref",ab,r)}var ab,ST=y(()=>{l();c();d();da();ab=class{constructor(e,t){this.target=e,this.propertyName=t}bind(e){e[this.propertyName]=this.target}unbind(){}}});var lb,_T=y(()=>{l();c();d();lb=r=>typeof r=="function"});function TT(r){return r===void 0?tM:lb(r)?r:()=>r}function Ze(r,e,t){let o=lb(r)?r:()=>r,i=TT(e),n=TT(t);return(s,a)=>o(s,a)?i(s,a):n(s,a)}var tM,ET=y(()=>{l();c();d();_T();tM=()=>null});function rM(r,e,t,o){r.bind(e[t],o)}function oM(r,e,t,o){let i=Object.create(o);i.index=t,i.length=e.length,r.bind(e[t],i)}function _l(r,e,t=IT){let o=typeof e=="function"?e:()=>e;return new On(r,o,Object.assign(Object.assign({},IT),t))}var IT,cb,On,AT=y(()=>{l();c();d();Ci();Pn();sb();bs();da();Gf();IT=Object.freeze({positioning:!1,recycle:!0});cb=class{constructor(e,t,o,i,n,s){this.location=e,this.itemsBinding=t,this.templateBinding=i,this.options=s,this.source=null,this.views=[],this.items=null,this.itemsObserver=null,this.originalContext=void 0,this.childContext=void 0,this.bindView=rM,this.itemsBindingObserver=pe.binding(t,this,o),this.templateBindingObserver=pe.binding(i,this,n),s.positioning&&(this.bindView=oM)}bind(e,t){this.source=e,this.originalContext=t,this.childContext=Object.create(t),this.childContext.parent=e,this.childContext.parentContext=this.originalContext,this.items=this.itemsBindingObserver.observe(e,this.originalContext),this.template=this.templateBindingObserver.observe(e,this.originalContext),this.observeItems(!0),this.refreshAllViews()}unbind(){this.source=null,this.items=null,this.itemsObserver!==null&&this.itemsObserver.unsubscribe(this),this.unbindAllViews(),this.itemsBindingObserver.disconnect(),this.templateBindingObserver.disconnect()}handleChange(e,t){e===this.itemsBinding?(this.items=this.itemsBindingObserver.observe(this.source,this.originalContext),this.observeItems(),this.refreshAllViews()):e===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.originalContext),this.refreshAllViews(!0)):this.updateViews(t)}observeItems(e=!1){if(!this.items){this.items=wi;return}let t=this.itemsObserver,o=this.itemsObserver=pe.getNotifier(this.items),i=t!==o;i&&t!==null&&t.unsubscribe(this),(i||e)&&o.subscribe(this)}updateViews(e){let t=this.childContext,o=this.views,i=this.bindView,n=this.items,s=this.template,a=this.options.recycle,u=[],h=0,p=0;for(let f=0,b=e.length;f<b;++f){let C=e[f],S=C.removed,R=0,N=C.index,ye=N+C.addedCount,ie=o.splice(C.index,S.length),me=p=u.length+ie.length;for(;N<ye;++N){let yt=o[N],Ge=yt?yt.firstChild:this.location,tt;a&&p>0?(R<=me&&ie.length>0?(tt=ie[R],R++):(tt=u[h],h++),p--):tt=s.create(),o.splice(N,0,tt),i(tt,n,N,t),tt.insertBefore(Ge)}ie[R]&&u.push(...ie.slice(R))}for(let f=h,b=u.length;f<b;++f)u[f].dispose();if(this.options.positioning)for(let f=0,b=o.length;f<b;++f){let C=o[f].context;C.length=b,C.index=f}}refreshAllViews(e=!1){let t=this.items,o=this.childContext,i=this.template,n=this.location,s=this.bindView,a=t.length,u=this.views,h=u.length;if((a===0||e||!this.options.recycle)&&(Lc.disposeContiguousBatch(u),h=0),h===0){this.views=u=new Array(a);for(let p=0;p<a;++p){let f=i.create();s(f,t,p,o),u[p]=f,f.insertBefore(n)}}else{let p=0;for(;p<a;++p)if(p<h){let b=u[p];s(b,t,p,o)}else{let b=i.create();s(b,t,p,o),u.push(b),b.insertBefore(n)}let f=u.splice(p,h-p);for(p=0,a=f.length;p<a;++p)f[p].dispose()}}unbindAllViews(){let e=this.views;for(let t=0,o=e.length;t<o;++t)e[t].unbind()}},On=class extends ca{constructor(e,t,o){super(),this.itemsBinding=e,this.templateBinding=t,this.options=o,this.createPlaceholder=Y.createBlockPlaceholder,nb(),this.isItemsBindingVolatile=pe.isVolatileBinding(e),this.isTemplateBindingVolatile=pe.isVolatileBinding(t)}createBehavior(e){return new cb(e,this.itemsBinding,this.isItemsBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile,this.options)}}});function zr(r){return r?function(e,t,o){return e.nodeType===1&&e.matches(r)}:function(e,t,o){return e.nodeType===1}}var Nc,Jf=y(()=>{l();c();d();Pn();bs();Nc=class{constructor(e,t){this.target=e,this.options=t,this.source=null}bind(e){let t=this.options.property;this.shouldUpdate=pe.getAccessors(e).some(o=>o.name===t),this.source=e,this.updateTarget(this.computeNodes()),this.shouldUpdate&&this.observe()}unbind(){this.updateTarget(wi),this.source=null,this.shouldUpdate&&this.disconnect()}handleEvent(){this.updateTarget(this.computeNodes())}computeNodes(){let e=this.getNodes();return this.options.filter!==void 0&&(e=e.filter(this.options.filter)),e}updateTarget(e){this.source[this.options.property]=e}}});function De(r){return typeof r=="string"&&(r={property:r}),new ws("fast-slotted",db,r)}var db,RT=y(()=>{l();c();d();da();Jf();db=class extends Nc{constructor(e,t){super(e,t)}observe(){this.target.addEventListener("slotchange",this)}disconnect(){this.target.removeEventListener("slotchange",this)}getNodes(){return this.target.assignedNodes(this.options)}}});function pa(r){return typeof r=="string"&&(r={property:r}),new ws("fast-children",ub,r)}var ub,PT=y(()=>{l();c();d();da();Jf();ub=class extends Nc{constructor(e,t){super(e,t),this.observer=null,t.childList=!0}observe(){this.observer===null&&(this.observer=new MutationObserver(this.handleEvent.bind(this))),this.observer.observe(this.target,this.options)}disconnect(){this.observer.disconnect()}getNodes(){return"subtree"in this.options?Array.from(this.target.querySelectorAll(this.options.selector)):Array.from(this.target.childNodes)}}});var A=y(()=>{l();c();d();bs();aT();gT();Yf();Ky();Yy();zy();Wf();yT();Zy();Gf();Pn();Lu();rb();sb();Ci();qf();da();ST();ET();AT();RT();PT();Jf()});var _t,wt,Ct,$T,OT,$t=y(()=>{l();c();d();A();_t=class{handleStartContentChange(){this.startContainer.classList.toggle("start",this.start.assignedNodes().length>0)}handleEndContentChange(){this.endContainer.classList.toggle("end",this.end.assignedNodes().length>0)}},wt=(r,e)=>O`
    <span
        part="end"
        ${Ee("endContainer")}
        class=${t=>e.end?"end":void 0}
    >
        <slot name="end" ${Ee("end")} @slotchange="${t=>t.handleEndContentChange()}">
            ${e.end||""}
        </slot>
    </span>
`,Ct=(r,e)=>O`
    <span
        part="start"
        ${Ee("startContainer")}
        class="${t=>e.start?"start":void 0}"
    >
        <slot
            name="start"
            ${Ee("start")}
            @slotchange="${t=>t.handleStartContentChange()}"
        >
            ${e.start||""}
        </slot>
    </span>
`,$T=O`
    <span part="end" ${Ee("endContainer")}>
        <slot
            name="end"
            ${Ee("end")}
            @slotchange="${r=>r.handleEndContentChange()}"
        ></slot>
    </span>
`,OT=O`
    <span part="start" ${Ee("startContainer")}>
        <slot
            name="start"
            ${Ee("start")}
            @slotchange="${r=>r.handleStartContentChange()}"
        ></slot>
    </span>
`});var MT,FT=y(()=>{l();c();d();A();$t();MT=(r,e)=>O`
    <template class="${t=>t.expanded?"expanded":""}">
        <div
            class="heading"
            part="heading"
            role="heading"
            aria-level="${t=>t.headinglevel}"
        >
            <button
                class="button"
                part="button"
                ${Ee("expandbutton")}
                aria-expanded="${t=>t.expanded}"
                aria-controls="${t=>t.id}-panel"
                id="${t=>t.id}"
                @click="${(t,o)=>t.clickHandler(o.event)}"
            >
                <span class="heading-content" part="heading-content">
                    <slot name="heading"></slot>
                </span>
            </button>
            ${Ct(r,e)}
            ${wt(r,e)}
            <span class="icon" part="icon" aria-hidden="true">
                <slot name="expanded-icon" part="expanded-icon">
                    ${e.expandedIcon||""}
                </slot>
                <slot name="collapsed-icon" part="collapsed-icon">
                    ${e.collapsedIcon||""}
                </slot>
            <span>
        </div>
        <div
            class="region"
            part="region"
            id="${t=>t.id}-panel"
            role="region"
            aria-labelledby="${t=>t.id}"
        >
            <slot></slot>
        </div>
    </template>
`});function w(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n}var Pe=y(()=>{l();c();d();});function Hu(r){let e=r.slice(),t=Object.keys(r),o=t.length,i;for(let n=0;n<o;++n)i=t[n],KT(i)||(e[i]=r[i]);return e}function LT(r){return e=>Reflect.getOwnMetadata(r,e)}function rm(r){return function(e){let t=function(o,i,n){At.inject(t)(o,i,n)};return t.$isResolver=!0,t.resolve=function(o,i){return r(e,o,i)},t}}function aM(r){return function(e,t){t=!!t;let o=function(i,n,s){At.inject(o)(i,n,s)};return o.$isResolver=!0,o.resolve=function(i,n){return r(e,i,n,t)},o}}function yb(r,e,t){At.inject(yb)(r,e,t)}function qT(r,e){return e.getFactory(r).construct(e)}function HT(r){return this.get(r)}function lM(r,e){return e(r)}function tm(r){return typeof r.register=="function"}function dM(r){return tm(r)&&typeof r.registerInRequestor=="boolean"}function UT(r){return dM(r)&&r.registerInRequestor}function uM(r){return r.prototype!==void 0}function jT(r){return function(e,t,o){if(mb.has(o))return mb.get(o);let i=r(e,t,o);return mb.set(o,i),i}}function Xf(r){if(r==null)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}function BT(r,e,t){if(r instanceof Io&&r.strategy===4){let o=r.state,i=o.length,n=new Array(i);for(;i--;)n[i]=o[i].resolve(e,t);return n}return[r.resolve(e,t)]}function VT(r){return typeof r=="object"&&r!==null||typeof r=="function"}function KT(r){switch(typeof r){case"number":return r>=0&&(r|0)===r;case"string":{let e=em[r];if(e!==void 0)return e;let t=r.length;if(t===0)return em[r]=!1;let o=0;for(let i=0;i<t;++i)if(o=r.charCodeAt(i),i===0&&o===48&&t>1||o<48||o>57)return em[r]=!1;return em[r]=!0}default:return!1}}var hb,gb,iM,pb,DT,NT,At,nM,h1e,sM,p1e,f1e,m1e,g1e,v1e,Io,vb,cM,hM,GT,fb,Uu,mb,Tl,zT,pM,em,om=y(()=>{l();c();d();A();hb=new Map;"metadata"in Reflect||(Reflect.metadata=function(r,e){return function(t){Reflect.defineMetadata(r,e,t)}},Reflect.defineMetadata=function(r,e,t){let o=hb.get(t);o===void 0&&hb.set(t,o=new Map),o.set(r,e)},Reflect.getOwnMetadata=function(r,e){let t=hb.get(e);if(t!==void 0)return t.get(r)});gb=class{constructor(e,t){this.container=e,this.key=t}instance(e){return this.registerResolver(0,e)}singleton(e){return this.registerResolver(1,e)}transient(e){return this.registerResolver(2,e)}callback(e){return this.registerResolver(3,e)}cachedCallback(e){return this.registerResolver(3,jT(e))}aliasTo(e){return this.registerResolver(5,e)}registerResolver(e,t){let{container:o,key:i}=this;return this.container=this.key=void 0,o.registerResolver(i,new Io(i,e,t))}};iM=Object.freeze({none(r){throw Error(`${r.toString()} not registered, did you forget to add @singleton()?`)},singleton(r){return new Io(r,1,r)},transient(r){return new Io(r,2,r)}}),pb=Object.freeze({default:Object.freeze({parentLocator:()=>null,responsibleForOwnerRequests:!1,defaultResolver:iM.singleton})}),DT=new Map;NT=null,At=Object.freeze({createContainer(r){return new Uu(null,Object.assign({},pb.default,r))},findResponsibleContainer(r){let e=r.$$container$$;return e&&e.responsibleForOwnerRequests?e:At.findParentContainer(r)},findParentContainer(r){let e=new CustomEvent(GT,{bubbles:!0,composed:!0,cancelable:!0,detail:{container:void 0}});return r.dispatchEvent(e),e.detail.container||At.getOrCreateDOMContainer()},getOrCreateDOMContainer(r,e){return r?r.$$container$$||new Uu(r,Object.assign({},pb.default,e,{parentLocator:At.findParentContainer})):NT||(NT=new Uu(null,Object.assign({},pb.default,e,{parentLocator:()=>null})))},getDesignParamtypes:LT("design:paramtypes"),getAnnotationParamtypes:LT("di:paramtypes"),getOrCreateAnnotationParamTypes(r){let e=this.getAnnotationParamtypes(r);return e===void 0&&Reflect.defineMetadata("di:paramtypes",e=[],r),e},getDependencies(r){let e=DT.get(r);if(e===void 0){let t=r.inject;if(t===void 0){let o=At.getDesignParamtypes(r),i=At.getAnnotationParamtypes(r);if(o===void 0)if(i===void 0){let n=Object.getPrototypeOf(r);typeof n=="function"&&n!==Function.prototype?e=Hu(At.getDependencies(n)):e=[]}else e=Hu(i);else if(i===void 0)e=Hu(o);else{e=Hu(o);let n=i.length,s;for(let h=0;h<n;++h)s=i[h],s!==void 0&&(e[h]=s);let a=Object.keys(i);n=a.length;let u;for(let h=0;h<n;++h)u=a[h],KT(u)||(e[u]=i[u])}}else e=Hu(t);DT.set(r,e)}return e},defineProperty(r,e,t,o=!1){let i=`$di_${e}`;Reflect.defineProperty(r,e,{get:function(){let n=this[i];if(n===void 0&&(n=(this instanceof HTMLElement?At.findResponsibleContainer(this):At.getOrCreateDOMContainer()).get(t),this[i]=n,o&&this instanceof ua)){let a=this.$fastController,u=()=>{let p=At.findResponsibleContainer(this).get(t),f=this[i];p!==f&&(this[i]=n,a.notify(e))};a.subscribe({handleChange:u},"isConnected")}return n}})},createInterface(r,e){let t=typeof r=="function"?r:e,o=typeof r=="string"?r:r&&"friendlyName"in r&&r.friendlyName||zT,i=typeof r=="string"?!1:r&&"respectConnection"in r&&r.respectConnection||!1,n=function(s,a,u){if(s==null||new.target!==void 0)throw new Error(`No registration for interface: '${n.friendlyName}'`);if(a)At.defineProperty(s,a,n,i);else{let h=At.getOrCreateAnnotationParamTypes(s);h[u]=n}};return n.$isInterface=!0,n.friendlyName=o??"(anonymous)",t!=null&&(n.register=function(s,a){return t(new gb(s,a??n))}),n.toString=function(){return`InterfaceSymbol<${n.friendlyName}>`},n},inject(...r){return function(e,t,o){if(typeof o=="number"){let i=At.getOrCreateAnnotationParamTypes(e),n=r[0];n!==void 0&&(i[o]=n)}else if(t)At.defineProperty(e,t,r[0]);else{let i=o?At.getOrCreateAnnotationParamTypes(o.value):At.getOrCreateAnnotationParamTypes(e),n;for(let s=0;s<r.length;++s)n=r[s],n!==void 0&&(i[s]=n)}}},transient(r){return r.register=function(t){return Tl.transient(r,r).register(t)},r.registerInRequestor=!1,r},singleton(r,e=sM){return r.register=function(o){return Tl.singleton(r,r).register(o)},r.registerInRequestor=e.scoped,r}}),nM=At.createInterface("Container");h1e=At.inject,sM={scoped:!1};p1e=aM((r,e,t,o)=>t.getAll(r,o)),f1e=rm((r,e,t)=>()=>t.get(r)),m1e=rm((r,e,t)=>{if(t.has(r,!0))return t.get(r)});yb.$isResolver=!0;yb.resolve=()=>{};g1e=rm((r,e,t)=>{let o=qT(r,e),i=new Io(r,0,o);return t.registerResolver(r,i),o}),v1e=rm((r,e,t)=>qT(r,e));Io=class{constructor(e,t,o){this.key=e,this.strategy=t,this.state=o,this.resolving=!1}get $isResolver(){return!0}register(e){return e.registerResolver(this.key,this)}resolve(e,t){switch(this.strategy){case 0:return this.state;case 1:{if(this.resolving)throw new Error(`Cyclic dependency found: ${this.state.name}`);return this.resolving=!0,this.state=e.getFactory(this.state).construct(t),this.strategy=0,this.resolving=!1,this.state}case 2:{let o=e.getFactory(this.state);if(o===null)throw new Error(`Resolver for ${String(this.key)} returned a null factory`);return o.construct(t)}case 3:return this.state(e,t,this);case 4:return this.state[0].resolve(e,t);case 5:return t.get(this.state);default:throw new Error(`Invalid resolver strategy specified: ${this.strategy}.`)}}getFactory(e){var t,o,i;switch(this.strategy){case 1:case 2:return e.getFactory(this.state);case 5:return(i=(o=(t=e.getResolver(this.state))===null||t===void 0?void 0:t.getFactory)===null||o===void 0?void 0:o.call(t,e))!==null&&i!==void 0?i:null;default:return null}}};vb=class{constructor(e,t){this.Type=e,this.dependencies=t,this.transformers=null}construct(e,t){let o;return t===void 0?o=new this.Type(...this.dependencies.map(HT,e)):o=new this.Type(...this.dependencies.map(HT,e),...t),this.transformers==null?o:this.transformers.reduce(lM,o)}registerTransformer(e){(this.transformers||(this.transformers=[])).push(e)}},cM={$isResolver:!0,resolve(r,e){return e}};hM=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]),GT="__DI_LOCATE_PARENT__",fb=new Map,Uu=class r{constructor(e,t){this.owner=e,this.config=t,this._parent=void 0,this.registerDepth=0,this.context=null,e!==null&&(e.$$container$$=this),this.resolvers=new Map,this.resolvers.set(nM,cM),e instanceof Node&&e.addEventListener(GT,o=>{o.composedPath()[0]!==this.owner&&(o.detail.container=this,o.stopImmediatePropagation())})}get parent(){return this._parent===void 0&&(this._parent=this.config.parentLocator(this.owner)),this._parent}get depth(){return this.parent===null?0:this.parent.depth+1}get responsibleForOwnerRequests(){return this.config.responsibleForOwnerRequests}registerWithContext(e,...t){return this.context=e,this.register(...t),this.context=null,this}register(...e){if(++this.registerDepth===100)throw new Error("Unable to autoregister dependency");let t,o,i,n,s,a=this.context;for(let u=0,h=e.length;u<h;++u)if(t=e[u],!!VT(t))if(tm(t))t.register(this,a);else if(uM(t))Tl.singleton(t,t).register(this);else for(o=Object.keys(t),n=0,s=o.length;n<s;++n)i=t[o[n]],VT(i)&&(tm(i)?i.register(this,a):this.register(i));return--this.registerDepth,this}registerResolver(e,t){Xf(e);let o=this.resolvers,i=o.get(e);return i==null?o.set(e,t):i instanceof Io&&i.strategy===4?i.state.push(t):o.set(e,new Io(e,4,[i,t])),t}registerTransformer(e,t){let o=this.getResolver(e);if(o==null)return!1;if(o.getFactory){let i=o.getFactory(this);return i==null?!1:(i.registerTransformer(t),!0)}return!1}getResolver(e,t=!0){if(Xf(e),e.resolve!==void 0)return e;let o=this,i;for(;o!=null;)if(i=o.resolvers.get(e),i==null){if(o.parent==null){let n=UT(e)?this:o;return t?this.jitRegister(e,n):null}o=o.parent}else return i;return null}has(e,t=!1){return this.resolvers.has(e)?!0:t&&this.parent!=null?this.parent.has(e,!0):!1}get(e){if(Xf(e),e.$isResolver)return e.resolve(this,this);let t=this,o;for(;t!=null;)if(o=t.resolvers.get(e),o==null){if(t.parent==null){let i=UT(e)?this:t;return o=this.jitRegister(e,i),o.resolve(t,this)}t=t.parent}else return o.resolve(t,this);throw new Error(`Unable to resolve key: ${String(e)}`)}getAll(e,t=!1){Xf(e);let o=this,i=o,n;if(t){let s=wi;for(;i!=null;)n=i.resolvers.get(e),n!=null&&(s=s.concat(BT(n,i,o))),i=i.parent;return s}else for(;i!=null;)if(n=i.resolvers.get(e),n==null){if(i=i.parent,i==null)return wi}else return BT(n,i,o);return wi}getFactory(e){let t=fb.get(e);if(t===void 0){if(pM(e))throw new Error(`${e.name} is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.`);fb.set(e,t=new vb(e,At.getDependencies(e)))}return t}registerFactory(e,t){fb.set(e,t)}createChild(e){return new r(null,Object.assign({},this.config,e,{parentLocator:()=>this}))}jitRegister(e,t){if(typeof e!="function")throw new Error(`Attempted to jitRegister something that is not a constructor: '${e}'. Did you forget to register this dependency?`);if(hM.has(e.name))throw new Error(`Attempted to jitRegister an intrinsic type: ${e.name}. Did you forget to add @inject(Key)`);if(tm(e)){let o=e.register(t);if(!(o instanceof Object)||o.resolve==null){let i=t.resolvers.get(e);if(i!=null)return i;throw new Error("A valid resolver was not returned from the static register method")}return o}else{if(e.$isInterface)throw new Error(`Attempted to jitRegister an interface: ${e.friendlyName}`);{let o=this.config.defaultResolver(e,t);return t.resolvers.set(e,o),o}}}},mb=new WeakMap;Tl=Object.freeze({instance(r,e){return new Io(r,0,e)},singleton(r,e){return new Io(r,1,e)},transient(r,e){return new Io(r,2,e)},callback(r,e){return new Io(r,3,e)},cachedCallback(r,e){return new Io(r,3,jT(e))},aliasTo(r,e){return new Io(e,5,r)}});zT="(anonymous)";pM=function(){let r=new WeakMap,e=!1,t="",o=0;return function(i){return e=r.get(i),e===void 0&&(t=i.toString(),o=t.length,e=o>=29&&o<=100&&t.charCodeAt(o-1)===125&&t.charCodeAt(o-2)<=32&&t.charCodeAt(o-3)===93&&t.charCodeAt(o-4)===101&&t.charCodeAt(o-5)===100&&t.charCodeAt(o-6)===111&&t.charCodeAt(o-7)===99&&t.charCodeAt(o-8)===32&&t.charCodeAt(o-9)===101&&t.charCodeAt(o-10)===118&&t.charCodeAt(o-11)===105&&t.charCodeAt(o-12)===116&&t.charCodeAt(o-13)===97&&t.charCodeAt(o-14)===110&&t.charCodeAt(o-15)===88,r.set(i,e)),e}}(),em={}});function WT(r){return`${r.toLowerCase()}:presentation`}var im,sm,nm,am=y(()=>{l();c();d();A();om();im=new Map,sm=Object.freeze({define(r,e,t){let o=WT(r);im.get(o)===void 0?im.set(o,e):im.set(o,!1),t.register(Tl.instance(o,e))},forTag(r,e){let t=WT(r),o=im.get(t);return o===!1?At.findResponsibleContainer(e).get(t):o||null}}),nm=class{constructor(e,t){this.template=e||null,this.styles=t===void 0?null:Array.isArray(t)?nr.create(t):t instanceof nr?t:nr.create([t])}applyTo(e){let t=e.$fastController;t.template===null&&(t.template=this.template),t.styles===null&&(t.styles=this.styles)}}});function Bu(r,e,t){return typeof r=="function"?r(e,t):r}var G,bb,He=y(()=>{l();c();d();Pe();A();am();G=class r extends ua{constructor(){super(...arguments),this._presentation=void 0}get $presentation(){return this._presentation===void 0&&(this._presentation=sm.forTag(this.tagName,this)),this._presentation}templateChanged(){this.template!==void 0&&(this.$fastController.template=this.template)}stylesChanged(){this.styles!==void 0&&(this.$fastController.styles=this.styles)}connectedCallback(){this.$presentation!==null&&this.$presentation.applyTo(this),super.connectedCallback()}static compose(e){return(t={})=>new bb(this===r?class extends r{}:this,e,t)}};w([I],G.prototype,"template",void 0);w([I],G.prototype,"styles",void 0);bb=class{constructor(e,t,o){this.type=e,this.elementDefinition=t,this.overrideDefinition=o,this.definition=Object.assign(Object.assign({},this.elementDefinition),this.overrideDefinition)}register(e,t){let o=this.definition,i=this.overrideDefinition,s=`${o.prefix||t.elementPrefix}-${o.baseName}`;t.tryDefineElement({name:s,type:this.type,baseClass:this.elementDefinition.baseClass,callback:a=>{let u=new nm(Bu(o.template,a,o),Bu(o.styles,a,o));a.definePresentation(u);let h=Bu(o.shadowOptions,a,o);a.shadowRootMode&&(h?i.shadowOptions||(h.mode=a.shadowRootMode):h!==null&&(h={mode:a.shadowRootMode})),a.defineElement({elementOptions:Bu(o.elementOptions,a,o),shadowOptions:h,attributes:Bu(o.attributes,a,o)})}})}}});function We(r,...e){let t=Nu.locate(r);e.forEach(o=>{Object.getOwnPropertyNames(o.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(o.prototype,n))}),Nu.locate(o).forEach(n=>t.push(n))})}var Vr=y(()=>{l();c();d();A()});var rn,wb=y(()=>{l();c();d();Pe();A();He();$t();Vr();rn=class extends G{constructor(){super(...arguments),this.headinglevel=2,this.expanded=!1,this.clickHandler=e=>{this.expanded=!this.expanded,this.change()},this.change=()=>{this.$emit("change")}}};w([k({attribute:"heading-level",mode:"fromView",converter:se})],rn.prototype,"headinglevel",void 0);w([k({mode:"boolean"})],rn.prototype,"expanded",void 0);w([k],rn.prototype,"id",void 0);We(rn,_t)});var QT=y(()=>{l();c();d();FT();wb()});var YT,ZT=y(()=>{l();c();d();A();YT=(r,e)=>O`
    <template>
        <slot ${De({property:"accordionItems",filter:zr()})}></slot>
        <slot name="item" part="item" ${De("accordionItems")}></slot>
    </template>
`});var Tt,JT=y(()=>{l();c();d();Tt={horizontal:"horizontal",vertical:"vertical"}});function XT(r,e){let t=r.length;for(;t--;)if(e(r[t],t,r))return t;return-1}var eE=y(()=>{l();c();d()});var tE=y(()=>{l();c();d()});function Hc(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var lm=y(()=>{l();c();d()});var rE=y(()=>{l();c();d();lm()});var oE=y(()=>{l();c();d();lm()});var iE=y(()=>{l();c();d()});var Cb=y(()=>{l();c();d();lm();rE();oE();iE()});function Mn(...r){return r.every(e=>e instanceof HTMLElement)}function nE(r,e){return!r||!e||!Mn(r)?void 0:Array.from(r.querySelectorAll(e)).filter(o=>o.offsetParent!==null)}function fM(){let r=document.querySelector('meta[property="csp-nonce"]');return r?r.getAttribute("content"):null}function sE(){if(typeof El=="boolean")return El;if(!Hc())return El=!1,El;let r=document.createElement("style"),e=fM();e!==null&&r.setAttribute("nonce",e),document.head.appendChild(r);try{r.sheet.insertRule("foo:focus-visible {color:inherit}",0),El=!0}catch{El=!1}finally{document.head.removeChild(r)}return El}var El,aE=y(()=>{l();c();d();Cb()});var xb,kb,xs,ks,Sb,_b,lE=y(()=>{l();c();d();xb="focus",kb="focusin",xs="focusout",ks="keydown",Sb="resize",_b="scroll"});var cE=y(()=>{l();c();d()});var dE,Vt,yo,bo,qt,sr,Vo,kr,Sr,uE,hE,pE,qo,fa,fE,mE,ma,gE=y(()=>{l();c();d();(function(r){r[r.alt=18]="alt",r[r.arrowDown=40]="arrowDown",r[r.arrowLeft=37]="arrowLeft",r[r.arrowRight=39]="arrowRight",r[r.arrowUp=38]="arrowUp",r[r.back=8]="back",r[r.backSlash=220]="backSlash",r[r.break=19]="break",r[r.capsLock=20]="capsLock",r[r.closeBracket=221]="closeBracket",r[r.colon=186]="colon",r[r.colon2=59]="colon2",r[r.comma=188]="comma",r[r.ctrl=17]="ctrl",r[r.delete=46]="delete",r[r.end=35]="end",r[r.enter=13]="enter",r[r.equals=187]="equals",r[r.equals2=61]="equals2",r[r.equals3=107]="equals3",r[r.escape=27]="escape",r[r.forwardSlash=191]="forwardSlash",r[r.function1=112]="function1",r[r.function10=121]="function10",r[r.function11=122]="function11",r[r.function12=123]="function12",r[r.function2=113]="function2",r[r.function3=114]="function3",r[r.function4=115]="function4",r[r.function5=116]="function5",r[r.function6=117]="function6",r[r.function7=118]="function7",r[r.function8=119]="function8",r[r.function9=120]="function9",r[r.home=36]="home",r[r.insert=45]="insert",r[r.menu=93]="menu",r[r.minus=189]="minus",r[r.minus2=109]="minus2",r[r.numLock=144]="numLock",r[r.numPad0=96]="numPad0",r[r.numPad1=97]="numPad1",r[r.numPad2=98]="numPad2",r[r.numPad3=99]="numPad3",r[r.numPad4=100]="numPad4",r[r.numPad5=101]="numPad5",r[r.numPad6=102]="numPad6",r[r.numPad7=103]="numPad7",r[r.numPad8=104]="numPad8",r[r.numPad9=105]="numPad9",r[r.numPadDivide=111]="numPadDivide",r[r.numPadDot=110]="numPadDot",r[r.numPadMinus=109]="numPadMinus",r[r.numPadMultiply=106]="numPadMultiply",r[r.numPadPlus=107]="numPadPlus",r[r.openBracket=219]="openBracket",r[r.pageDown=34]="pageDown",r[r.pageUp=33]="pageUp",r[r.period=190]="period",r[r.print=44]="print",r[r.quote=222]="quote",r[r.scrollLock=145]="scrollLock",r[r.shift=16]="shift",r[r.space=32]="space",r[r.tab=9]="tab",r[r.tilde=192]="tilde",r[r.windowsLeft=91]="windowsLeft",r[r.windowsOpera=219]="windowsOpera",r[r.windowsRight=92]="windowsRight"})(dE||(dE={}));Vt="ArrowDown",yo="ArrowLeft",bo="ArrowRight",qt="ArrowUp",sr="Enter",Vo="Escape",kr="Home",Sr="End",uE="F2",hE="PageDown",pE="PageUp",qo=" ",fa="Tab",fE="Backspace",mE="Delete",ma={ArrowDown:Vt,ArrowLeft:yo,ArrowRight:bo,ArrowUp:qt}});var et,Tb=y(()=>{l();c();d();(function(r){r.ltr="ltr",r.rtl="rtl"})(et||(et={}))});function vE(r,e,t){return t<r?e:t>e?r:t}function ga(r,e,t){return Math.min(Math.max(t,r),e)}function zu(r,e,t=0){return[e,t]=[e,t].sort((o,i)=>o-i),e<=r&&r<t}var yE=y(()=>{l();c();d()});function di(r=""){return`${r}${mM++}`}var mM,bE=y(()=>{l();c();d();mM=0});var wE=y(()=>{l();c();d()});var Uc,CE=y(()=>{l();c();d();Cb();Tb();Uc=class r{static getScrollLeft(e,t){return t===et.rtl?r.getRtlScrollLeftConverter(e):e.scrollLeft}static setScrollLeft(e,t,o){if(o===et.rtl){r.setRtlScrollLeftConverter(e,t);return}e.scrollLeft=t}static initialGetRtlScrollConverter(e){return r.initializeRtlScrollConverters(),r.getRtlScrollLeftConverter(e)}static directGetRtlScrollConverter(e){return e.scrollLeft}static invertedGetRtlScrollConverter(e){return-Math.abs(e.scrollLeft)}static reverseGetRtlScrollConverter(e){return e.scrollLeft-(e.scrollWidth-e.clientWidth)}static initialSetRtlScrollConverter(e,t){r.initializeRtlScrollConverters(),r.setRtlScrollLeftConverter(e,t)}static directSetRtlScrollConverter(e,t){e.scrollLeft=t}static invertedSetRtlScrollConverter(e,t){e.scrollLeft=Math.abs(t)}static reverseSetRtlScrollConverter(e,t){let o=e.scrollWidth-e.clientWidth;e.scrollLeft=o+t}static initializeRtlScrollConverters(){if(!Hc()){r.applyDirectScrollConverters();return}let e=r.getTestElement();document.body.appendChild(e),r.checkForScrollType(e),document.body.removeChild(e)}static checkForScrollType(e){r.isReverse(e)?r.applyReverseScrollConverters():r.isDirect(e)?r.applyDirectScrollConverters():r.applyInvertedScrollConverters()}static isReverse(e){return e.scrollLeft>0}static isDirect(e){return e.scrollLeft=-1,e.scrollLeft<0}static applyDirectScrollConverters(){r.setRtlScrollLeftConverter=r.directSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.directGetRtlScrollConverter}static applyInvertedScrollConverters(){r.setRtlScrollLeftConverter=r.invertedSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.invertedGetRtlScrollConverter}static applyReverseScrollConverters(){r.setRtlScrollLeftConverter=r.reverseSetRtlScrollConverter,r.getRtlScrollLeftConverter=r.reverseGetRtlScrollConverter}static getTestElement(){let e=document.createElement("div");return e.appendChild(document.createTextNode("ABCD")),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",e}};Uc.getRtlScrollLeftConverter=Uc.initialGetRtlScrollConverter;Uc.setRtlScrollLeftConverter=Uc.initialSetRtlScrollConverter});var T,xE=y(()=>{l();c();d();(function(r){r.Canvas="Canvas",r.CanvasText="CanvasText",r.LinkText="LinkText",r.VisitedText="VisitedText",r.ActiveText="ActiveText",r.ButtonFace="ButtonFace",r.ButtonText="ButtonText",r.Field="Field",r.FieldText="FieldText",r.Highlight="Highlight",r.HighlightText="HighlightText",r.GrayText="GrayText"})(T||(T={}))});var we=y(()=>{l();c();d();JT();eE();tE();aE();lE();cE();gE();Tb();yE();bE();wE();CE();xE()});var kE,Bc,SE=y(()=>{l();c();d();Pe();A();we();He();wb();kE={single:"single",multi:"multi"},Bc=class extends G{constructor(){super(...arguments),this.expandmode=kE.multi,this.activeItemIndex=0,this.change=()=>{this.$emit("change",this.activeid)},this.setItems=()=>{var e;this.accordionItems.length!==0&&(this.accordionIds=this.getItemIds(),this.accordionItems.forEach((t,o)=>{t instanceof rn&&(t.addEventListener("change",this.activeItemChange),this.isSingleExpandMode()&&(this.activeItemIndex!==o?t.expanded=!1:t.expanded=!0));let i=this.accordionIds[o];t.setAttribute("id",typeof i!="string"?`accordion-${o+1}`:i),this.activeid=this.accordionIds[this.activeItemIndex],t.addEventListener("keydown",this.handleItemKeyDown),t.addEventListener("focus",this.handleItemFocus)}),this.isSingleExpandMode()&&((e=this.findExpandedItem())!==null&&e!==void 0?e:this.accordionItems[0]).setAttribute("aria-disabled","true"))},this.removeItemListeners=e=>{e.forEach((t,o)=>{t.removeEventListener("change",this.activeItemChange),t.removeEventListener("keydown",this.handleItemKeyDown),t.removeEventListener("focus",this.handleItemFocus)})},this.activeItemChange=e=>{if(e.defaultPrevented||e.target!==e.currentTarget)return;e.preventDefault();let t=e.target;this.activeid=t.getAttribute("id"),this.isSingleExpandMode()&&(this.resetItems(),t.expanded=!0,t.setAttribute("aria-disabled","true"),this.accordionItems.forEach(o=>{!o.hasAttribute("disabled")&&o.id!==this.activeid&&o.removeAttribute("aria-disabled")})),this.activeItemIndex=Array.from(this.accordionItems).indexOf(t),this.change()},this.handleItemKeyDown=e=>{if(e.target===e.currentTarget)switch(this.accordionIds=this.getItemIds(),e.key){case qt:e.preventDefault(),this.adjust(-1);break;case Vt:e.preventDefault(),this.adjust(1);break;case kr:this.activeItemIndex=0,this.focusItem();break;case Sr:this.activeItemIndex=this.accordionItems.length-1,this.focusItem();break}},this.handleItemFocus=e=>{if(e.target===e.currentTarget){let t=e.target,o=this.activeItemIndex=Array.from(this.accordionItems).indexOf(t);this.activeItemIndex!==o&&o!==-1&&(this.activeItemIndex=o,this.activeid=this.accordionIds[this.activeItemIndex])}}}accordionItemsChanged(e,t){this.$fastController.isConnected&&(this.removeItemListeners(e),this.setItems())}findExpandedItem(){for(let e=0;e<this.accordionItems.length;e++)if(this.accordionItems[e].getAttribute("expanded")==="true")return this.accordionItems[e];return null}resetItems(){this.accordionItems.forEach((e,t)=>{e.expanded=!1})}getItemIds(){return this.accordionItems.map(e=>e.getAttribute("id"))}isSingleExpandMode(){return this.expandmode===kE.single}adjust(e){this.activeItemIndex=vE(0,this.accordionItems.length-1,this.activeItemIndex+e),this.focusItem()}focusItem(){let e=this.accordionItems[this.activeItemIndex];e instanceof rn&&e.expandbutton.focus()}};w([k({attribute:"expand-mode"})],Bc.prototype,"expandmode",void 0);w([I],Bc.prototype,"accordionItems",void 0)});var _E=y(()=>{l();c();d();ZT();SE()});var cm,Eb=y(()=>{l();c();d();A();$t();cm=(r,e)=>O`
    <a
        class="control"
        part="control"
        download="${t=>t.download}"
        href="${t=>t.href}"
        hreflang="${t=>t.hreflang}"
        ping="${t=>t.ping}"
        referrerpolicy="${t=>t.referrerpolicy}"
        rel="${t=>t.rel}"
        target="${t=>t.target}"
        type="${t=>t.type}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${Ee("control")}
    >
        ${Ct(r,e)}
        <span class="content" part="content">
            <slot ${De("defaultSlottedContent")}></slot>
        </span>
        ${wt(r,e)}
    </a>
`});var dt,Vu=y(()=>{l();c();d();Pe();A();dt=class{};w([k({attribute:"aria-atomic"})],dt.prototype,"ariaAtomic",void 0);w([k({attribute:"aria-busy"})],dt.prototype,"ariaBusy",void 0);w([k({attribute:"aria-controls"})],dt.prototype,"ariaControls",void 0);w([k({attribute:"aria-current"})],dt.prototype,"ariaCurrent",void 0);w([k({attribute:"aria-describedby"})],dt.prototype,"ariaDescribedby",void 0);w([k({attribute:"aria-details"})],dt.prototype,"ariaDetails",void 0);w([k({attribute:"aria-disabled"})],dt.prototype,"ariaDisabled",void 0);w([k({attribute:"aria-errormessage"})],dt.prototype,"ariaErrormessage",void 0);w([k({attribute:"aria-flowto"})],dt.prototype,"ariaFlowto",void 0);w([k({attribute:"aria-haspopup"})],dt.prototype,"ariaHaspopup",void 0);w([k({attribute:"aria-hidden"})],dt.prototype,"ariaHidden",void 0);w([k({attribute:"aria-invalid"})],dt.prototype,"ariaInvalid",void 0);w([k({attribute:"aria-keyshortcuts"})],dt.prototype,"ariaKeyshortcuts",void 0);w([k({attribute:"aria-label"})],dt.prototype,"ariaLabel",void 0);w([k({attribute:"aria-labelledby"})],dt.prototype,"ariaLabelledby",void 0);w([k({attribute:"aria-live"})],dt.prototype,"ariaLive",void 0);w([k({attribute:"aria-owns"})],dt.prototype,"ariaOwns",void 0);w([k({attribute:"aria-relevant"})],dt.prototype,"ariaRelevant",void 0);w([k({attribute:"aria-roledescription"})],dt.prototype,"ariaRoledescription",void 0)});var Il=y(()=>{l();c();d();Vu();$t()});var no,Al,Ib=y(()=>{l();c();d();Pe();A();He();Il();Vr();no=class extends G{constructor(){super(...arguments),this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(!((e=this.$fastController.definition.shadowOptions)===null||e===void 0)&&e.delegatesFocus)&&(this.focus=()=>{var t;(t=this.control)===null||t===void 0||t.focus()})}}connectedCallback(){super.connectedCallback(),this.handleUnsupportedDelegatesFocus()}};w([k],no.prototype,"download",void 0);w([k],no.prototype,"href",void 0);w([k],no.prototype,"hreflang",void 0);w([k],no.prototype,"ping",void 0);w([k],no.prototype,"referrerpolicy",void 0);w([k],no.prototype,"rel",void 0);w([k],no.prototype,"target",void 0);w([k],no.prototype,"type",void 0);w([I],no.prototype,"defaultSlottedContent",void 0);Al=class{};w([k({attribute:"aria-expanded"})],Al.prototype,"ariaExpanded",void 0);We(Al,dt);We(no,_t,Al)});var TE=y(()=>{l();c();d();Eb();Ib()});var EE,IE=y(()=>{l();c();d();A();EE=(r,e)=>O`
    <template class="${t=>t.initialLayoutComplete?"loaded":""}">
        ${Ze(t=>t.initialLayoutComplete,O`
                <slot></slot>
            `)}
    </template>
`});var ui,va=y(()=>{l();c();d();we();ui=r=>{let e=r.closest("[dir]");return e!==null&&e.dir==="rtl"?et.rtl:et.ltr}});var dm,AE=y(()=>{l();c();d();A();dm=class{constructor(){this.intersectionDetector=null,this.observedElements=new Map,this.requestPosition=(e,t)=>{var o;if(this.intersectionDetector!==null){if(this.observedElements.has(e)){(o=this.observedElements.get(e))===null||o===void 0||o.push(t);return}this.observedElements.set(e,[t]),this.intersectionDetector.observe(e)}},this.cancelRequestPosition=(e,t)=>{let o=this.observedElements.get(e);if(o!==void 0){let i=o.indexOf(t);i!==-1&&o.splice(i,1)}},this.initializeIntersectionDetector=()=>{tn.IntersectionObserver&&(this.intersectionDetector=new IntersectionObserver(this.handleIntersection,{root:null,rootMargin:"0px",threshold:[0,1]}))},this.handleIntersection=e=>{if(this.intersectionDetector===null)return;let t=[],o=[];e.forEach(i=>{var n;(n=this.intersectionDetector)===null||n===void 0||n.unobserve(i.target);let s=this.observedElements.get(i.target);s!==void 0&&(s.forEach(a=>{let u=t.indexOf(a);u===-1&&(u=t.length,t.push(a),o.push([])),o[u].push(i)}),this.observedElements.delete(i.target))}),t.forEach((i,n)=>{i(o[n])})},this.initializeIntersectionDetector()}}});var Me,qu=y(()=>{l();c();d();Pe();A();we();He();va();AE();Me=class r extends G{constructor(){super(...arguments),this.anchor="",this.viewport="",this.horizontalPositioningMode="uncontrolled",this.horizontalDefaultPosition="unset",this.horizontalViewportLock=!1,this.horizontalInset=!1,this.horizontalScaling="content",this.verticalPositioningMode="uncontrolled",this.verticalDefaultPosition="unset",this.verticalViewportLock=!1,this.verticalInset=!1,this.verticalScaling="content",this.fixedPlacement=!1,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.initialLayoutComplete=!1,this.resizeDetector=null,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.pendingPositioningUpdate=!1,this.pendingReset=!1,this.currentDirection=et.ltr,this.regionVisible=!1,this.forceUpdate=!1,this.updateThreshold=.5,this.update=()=>{this.pendingPositioningUpdate||this.requestPositionUpdates()},this.startObservers=()=>{this.stopObservers(),this.anchorElement!==null&&(this.requestPositionUpdates(),this.resizeDetector!==null&&(this.resizeDetector.observe(this.anchorElement),this.resizeDetector.observe(this)))},this.requestPositionUpdates=()=>{this.anchorElement===null||this.pendingPositioningUpdate||(r.intersectionService.requestPosition(this,this.handleIntersection),r.intersectionService.requestPosition(this.anchorElement,this.handleIntersection),this.viewportElement!==null&&r.intersectionService.requestPosition(this.viewportElement,this.handleIntersection),this.pendingPositioningUpdate=!0)},this.stopObservers=()=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,r.intersectionService.cancelRequestPosition(this,this.handleIntersection),this.anchorElement!==null&&r.intersectionService.cancelRequestPosition(this.anchorElement,this.handleIntersection),this.viewportElement!==null&&r.intersectionService.cancelRequestPosition(this.viewportElement,this.handleIntersection)),this.resizeDetector!==null&&this.resizeDetector.disconnect()},this.getViewport=()=>typeof this.viewport!="string"||this.viewport===""?document.documentElement:document.getElementById(this.viewport),this.getAnchor=()=>document.getElementById(this.anchor),this.handleIntersection=e=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,this.applyIntersectionEntries(e)&&this.updateLayout())},this.applyIntersectionEntries=e=>{let t=e.find(n=>n.target===this),o=e.find(n=>n.target===this.anchorElement),i=e.find(n=>n.target===this.viewportElement);return t===void 0||i===void 0||o===void 0?!1:!this.regionVisible||this.forceUpdate||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0||this.isRectDifferent(this.anchorRect,o.boundingClientRect)||this.isRectDifferent(this.viewportRect,i.boundingClientRect)||this.isRectDifferent(this.regionRect,t.boundingClientRect)?(this.regionRect=t.boundingClientRect,this.anchorRect=o.boundingClientRect,this.viewportElement===document.documentElement?this.viewportRect=new DOMRectReadOnly(i.boundingClientRect.x+document.documentElement.scrollLeft,i.boundingClientRect.y+document.documentElement.scrollTop,i.boundingClientRect.width,i.boundingClientRect.height):this.viewportRect=i.boundingClientRect,this.updateRegionOffset(),this.forceUpdate=!1,!0):!1},this.updateRegionOffset=()=>{this.anchorRect&&this.regionRect&&(this.baseHorizontalOffset=this.baseHorizontalOffset+(this.anchorRect.left-this.regionRect.left)+(this.translateX-this.baseHorizontalOffset),this.baseVerticalOffset=this.baseVerticalOffset+(this.anchorRect.top-this.regionRect.top)+(this.translateY-this.baseVerticalOffset))},this.isRectDifferent=(e,t)=>Math.abs(e.top-t.top)>this.updateThreshold||Math.abs(e.right-t.right)>this.updateThreshold||Math.abs(e.bottom-t.bottom)>this.updateThreshold||Math.abs(e.left-t.left)>this.updateThreshold,this.handleResize=e=>{this.update()},this.reset=()=>{this.pendingReset&&(this.pendingReset=!1,this.anchorElement===null&&(this.anchorElement=this.getAnchor()),this.viewportElement===null&&(this.viewportElement=this.getViewport()),this.currentDirection=ui(this),this.startObservers())},this.updateLayout=()=>{let e,t;if(this.horizontalPositioningMode!=="uncontrolled"){let n=this.getPositioningOptions(this.horizontalInset);if(this.horizontalDefaultPosition==="center")t="center";else if(this.horizontalDefaultPosition!=="unset"){let b=this.horizontalDefaultPosition;if(b==="start"||b==="end"){let C=ui(this);if(C!==this.currentDirection){this.currentDirection=C,this.initialize();return}this.currentDirection===et.ltr?b=b==="start"?"left":"right":b=b==="start"?"right":"left"}switch(b){case"left":t=this.horizontalInset?"insetStart":"start";break;case"right":t=this.horizontalInset?"insetEnd":"end";break}}let s=this.horizontalThreshold!==void 0?this.horizontalThreshold:this.regionRect!==void 0?this.regionRect.width:0,a=this.anchorRect!==void 0?this.anchorRect.left:0,u=this.anchorRect!==void 0?this.anchorRect.right:0,h=this.anchorRect!==void 0?this.anchorRect.width:0,p=this.viewportRect!==void 0?this.viewportRect.left:0,f=this.viewportRect!==void 0?this.viewportRect.right:0;(t===void 0||this.horizontalPositioningMode!=="locktodefault"&&this.getAvailableSpace(t,a,u,h,p,f)<s)&&(t=this.getAvailableSpace(n[0],a,u,h,p,f)>this.getAvailableSpace(n[1],a,u,h,p,f)?n[0]:n[1])}if(this.verticalPositioningMode!=="uncontrolled"){let n=this.getPositioningOptions(this.verticalInset);if(this.verticalDefaultPosition==="center")e="center";else if(this.verticalDefaultPosition!=="unset")switch(this.verticalDefaultPosition){case"top":e=this.verticalInset?"insetStart":"start";break;case"bottom":e=this.verticalInset?"insetEnd":"end";break}let s=this.verticalThreshold!==void 0?this.verticalThreshold:this.regionRect!==void 0?this.regionRect.height:0,a=this.anchorRect!==void 0?this.anchorRect.top:0,u=this.anchorRect!==void 0?this.anchorRect.bottom:0,h=this.anchorRect!==void 0?this.anchorRect.height:0,p=this.viewportRect!==void 0?this.viewportRect.top:0,f=this.viewportRect!==void 0?this.viewportRect.bottom:0;(e===void 0||this.verticalPositioningMode!=="locktodefault"&&this.getAvailableSpace(e,a,u,h,p,f)<s)&&(e=this.getAvailableSpace(n[0],a,u,h,p,f)>this.getAvailableSpace(n[1],a,u,h,p,f)?n[0]:n[1])}let o=this.getNextRegionDimension(t,e),i=this.horizontalPosition!==t||this.verticalPosition!==e;if(this.setHorizontalPosition(t,o),this.setVerticalPosition(e,o),this.updateRegionStyle(),!this.initialLayoutComplete){this.initialLayoutComplete=!0,this.requestPositionUpdates();return}this.regionVisible||(this.regionVisible=!0,this.style.removeProperty("pointer-events"),this.style.removeProperty("opacity"),this.classList.toggle("loaded",!0),this.$emit("loaded",this,{bubbles:!1})),this.updatePositionClasses(),i&&this.$emit("positionchange",this,{bubbles:!1})},this.updateRegionStyle=()=>{this.style.width=this.regionWidth,this.style.height=this.regionHeight,this.style.transform=`translate(${this.translateX}px, ${this.translateY}px)`},this.updatePositionClasses=()=>{this.classList.toggle("top",this.verticalPosition==="start"),this.classList.toggle("bottom",this.verticalPosition==="end"),this.classList.toggle("inset-top",this.verticalPosition==="insetStart"),this.classList.toggle("inset-bottom",this.verticalPosition==="insetEnd"),this.classList.toggle("vertical-center",this.verticalPosition==="center"),this.classList.toggle("left",this.horizontalPosition==="start"),this.classList.toggle("right",this.horizontalPosition==="end"),this.classList.toggle("inset-left",this.horizontalPosition==="insetStart"),this.classList.toggle("inset-right",this.horizontalPosition==="insetEnd"),this.classList.toggle("horizontal-center",this.horizontalPosition==="center")},this.setHorizontalPosition=(e,t)=>{if(e===void 0||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0)return;let o=0;switch(this.horizontalScaling){case"anchor":case"fill":o=this.horizontalViewportLock?this.viewportRect.width:t.width,this.regionWidth=`${o}px`;break;case"content":o=this.regionRect.width,this.regionWidth="unset";break}let i=0;switch(e){case"start":this.translateX=this.baseHorizontalOffset-o,this.horizontalViewportLock&&this.anchorRect.left>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.right));break;case"insetStart":this.translateX=this.baseHorizontalOffset-o+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.right));break;case"insetEnd":this.translateX=this.baseHorizontalOffset,this.horizontalViewportLock&&this.anchorRect.left<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.left));break;case"end":this.translateX=this.baseHorizontalOffset+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.left));break;case"center":if(i=(this.anchorRect.width-o)/2,this.translateX=this.baseHorizontalOffset+i,this.horizontalViewportLock){let n=this.anchorRect.left+i,s=this.anchorRect.right-i;n<this.viewportRect.left&&!(s>this.viewportRect.right)?this.translateX=this.translateX-(n-this.viewportRect.left):s>this.viewportRect.right&&!(n<this.viewportRect.left)&&(this.translateX=this.translateX-(s-this.viewportRect.right))}break}this.horizontalPosition=e},this.setVerticalPosition=(e,t)=>{if(e===void 0||this.regionRect===void 0||this.anchorRect===void 0||this.viewportRect===void 0)return;let o=0;switch(this.verticalScaling){case"anchor":case"fill":o=this.verticalViewportLock?this.viewportRect.height:t.height,this.regionHeight=`${o}px`;break;case"content":o=this.regionRect.height,this.regionHeight="unset";break}let i=0;switch(e){case"start":this.translateY=this.baseVerticalOffset-o,this.verticalViewportLock&&this.anchorRect.top>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.bottom));break;case"insetStart":this.translateY=this.baseVerticalOffset-o+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.bottom));break;case"insetEnd":this.translateY=this.baseVerticalOffset,this.verticalViewportLock&&this.anchorRect.top<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.top));break;case"end":this.translateY=this.baseVerticalOffset+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.top));break;case"center":if(i=(this.anchorRect.height-o)/2,this.translateY=this.baseVerticalOffset+i,this.verticalViewportLock){let n=this.anchorRect.top+i,s=this.anchorRect.bottom-i;n<this.viewportRect.top&&!(s>this.viewportRect.bottom)?this.translateY=this.translateY-(n-this.viewportRect.top):s>this.viewportRect.bottom&&!(n<this.viewportRect.top)&&(this.translateY=this.translateY-(s-this.viewportRect.bottom))}}this.verticalPosition=e},this.getPositioningOptions=e=>e?["insetStart","insetEnd"]:["start","end"],this.getAvailableSpace=(e,t,o,i,n,s)=>{let a=t-n,u=s-(t+i);switch(e){case"start":return a;case"insetStart":return a+i;case"insetEnd":return u+i;case"end":return u;case"center":return Math.min(a,u)*2+i}},this.getNextRegionDimension=(e,t)=>{let o={height:this.regionRect!==void 0?this.regionRect.height:0,width:this.regionRect!==void 0?this.regionRect.width:0};return e!==void 0&&this.horizontalScaling==="fill"?o.width=this.getAvailableSpace(e,this.anchorRect!==void 0?this.anchorRect.left:0,this.anchorRect!==void 0?this.anchorRect.right:0,this.anchorRect!==void 0?this.anchorRect.width:0,this.viewportRect!==void 0?this.viewportRect.left:0,this.viewportRect!==void 0?this.viewportRect.right:0):this.horizontalScaling==="anchor"&&(o.width=this.anchorRect!==void 0?this.anchorRect.width:0),t!==void 0&&this.verticalScaling==="fill"?o.height=this.getAvailableSpace(t,this.anchorRect!==void 0?this.anchorRect.top:0,this.anchorRect!==void 0?this.anchorRect.bottom:0,this.anchorRect!==void 0?this.anchorRect.height:0,this.viewportRect!==void 0?this.viewportRect.top:0,this.viewportRect!==void 0?this.viewportRect.bottom:0):this.verticalScaling==="anchor"&&(o.height=this.anchorRect!==void 0?this.anchorRect.height:0),o},this.startAutoUpdateEventListeners=()=>{window.addEventListener(Sb,this.update,{passive:!0}),window.addEventListener(_b,this.update,{passive:!0,capture:!0}),this.resizeDetector!==null&&this.viewportElement!==null&&this.resizeDetector.observe(this.viewportElement)},this.stopAutoUpdateEventListeners=()=>{window.removeEventListener(Sb,this.update),window.removeEventListener(_b,this.update),this.resizeDetector!==null&&this.viewportElement!==null&&this.resizeDetector.unobserve(this.viewportElement)}}anchorChanged(){this.initialLayoutComplete&&(this.anchorElement=this.getAnchor())}viewportChanged(){this.initialLayoutComplete&&(this.viewportElement=this.getViewport())}horizontalPositioningModeChanged(){this.requestReset()}horizontalDefaultPositionChanged(){this.updateForAttributeChange()}horizontalViewportLockChanged(){this.updateForAttributeChange()}horizontalInsetChanged(){this.updateForAttributeChange()}horizontalThresholdChanged(){this.updateForAttributeChange()}horizontalScalingChanged(){this.updateForAttributeChange()}verticalPositioningModeChanged(){this.requestReset()}verticalDefaultPositionChanged(){this.updateForAttributeChange()}verticalViewportLockChanged(){this.updateForAttributeChange()}verticalInsetChanged(){this.updateForAttributeChange()}verticalThresholdChanged(){this.updateForAttributeChange()}verticalScalingChanged(){this.updateForAttributeChange()}fixedPlacementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}autoUpdateModeChanged(e,t){this.$fastController.isConnected&&this.initialLayoutComplete&&(e==="auto"&&this.stopAutoUpdateEventListeners(),t==="auto"&&this.startAutoUpdateEventListeners())}anchorElementChanged(){this.requestReset()}viewportElementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}connectedCallback(){super.connectedCallback(),this.autoUpdateMode==="auto"&&this.startAutoUpdateEventListeners(),this.initialize()}disconnectedCallback(){super.disconnectedCallback(),this.autoUpdateMode==="auto"&&this.stopAutoUpdateEventListeners(),this.stopObservers(),this.disconnectResizeDetector()}adoptedCallback(){this.initialize()}disconnectResizeDetector(){this.resizeDetector!==null&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.handleResize)}updateForAttributeChange(){this.$fastController.isConnected&&this.initialLayoutComplete&&(this.forceUpdate=!0,this.update())}initialize(){this.initializeResizeDetector(),this.anchorElement===null&&(this.anchorElement=this.getAnchor()),this.requestReset()}requestReset(){this.$fastController.isConnected&&this.pendingReset===!1&&(this.setInitialState(),Y.queueUpdate(()=>this.reset()),this.pendingReset=!0)}setInitialState(){this.initialLayoutComplete=!1,this.regionVisible=!1,this.translateX=0,this.translateY=0,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.viewportRect=void 0,this.regionRect=void 0,this.anchorRect=void 0,this.verticalPosition=void 0,this.horizontalPosition=void 0,this.style.opacity="0",this.style.pointerEvents="none",this.forceUpdate=!1,this.style.position=this.fixedPlacement?"fixed":"absolute",this.updatePositionClasses(),this.updateRegionStyle()}};Me.intersectionService=new dm;w([k],Me.prototype,"anchor",void 0);w([k],Me.prototype,"viewport",void 0);w([k({attribute:"horizontal-positioning-mode"})],Me.prototype,"horizontalPositioningMode",void 0);w([k({attribute:"horizontal-default-position"})],Me.prototype,"horizontalDefaultPosition",void 0);w([k({attribute:"horizontal-viewport-lock",mode:"boolean"})],Me.prototype,"horizontalViewportLock",void 0);w([k({attribute:"horizontal-inset",mode:"boolean"})],Me.prototype,"horizontalInset",void 0);w([k({attribute:"horizontal-threshold"})],Me.prototype,"horizontalThreshold",void 0);w([k({attribute:"horizontal-scaling"})],Me.prototype,"horizontalScaling",void 0);w([k({attribute:"vertical-positioning-mode"})],Me.prototype,"verticalPositioningMode",void 0);w([k({attribute:"vertical-default-position"})],Me.prototype,"verticalDefaultPosition",void 0);w([k({attribute:"vertical-viewport-lock",mode:"boolean"})],Me.prototype,"verticalViewportLock",void 0);w([k({attribute:"vertical-inset",mode:"boolean"})],Me.prototype,"verticalInset",void 0);w([k({attribute:"vertical-threshold"})],Me.prototype,"verticalThreshold",void 0);w([k({attribute:"vertical-scaling"})],Me.prototype,"verticalScaling",void 0);w([k({attribute:"fixed-placement",mode:"boolean"})],Me.prototype,"fixedPlacement",void 0);w([k({attribute:"auto-update-mode"})],Me.prototype,"autoUpdateMode",void 0);w([I],Me.prototype,"anchorElement",void 0);w([I],Me.prototype,"viewportElement",void 0);w([I],Me.prototype,"initialLayoutComplete",void 0)});var Ab,Rb,Pb,$b,RE,Ob,PE,$E=y(()=>{l();c();d();Ab={horizontalDefaultPosition:"center",horizontalPositioningMode:"locktodefault",horizontalInset:!1,horizontalScaling:"anchor"},Rb=Object.assign(Object.assign({},Ab),{verticalDefaultPosition:"top",verticalPositioningMode:"locktodefault",verticalInset:!1,verticalScaling:"content"}),Pb=Object.assign(Object.assign({},Ab),{verticalDefaultPosition:"bottom",verticalPositioningMode:"locktodefault",verticalInset:!1,verticalScaling:"content"}),$b=Object.assign(Object.assign({},Ab),{verticalPositioningMode:"dynamic",verticalInset:!1,verticalScaling:"content"}),RE=Object.assign(Object.assign({},Rb),{verticalScaling:"fill"}),Ob=Object.assign(Object.assign({},Pb),{verticalScaling:"fill"}),PE=Object.assign(Object.assign({},$b),{verticalScaling:"fill"})});var Mb=y(()=>{l();c();d();IE();qu();$E()});var OE=y(()=>{l();c();d();A()});var zc,ME=y(()=>{l();c();d();Pe();A();He();zc=class extends G{connectedCallback(){super.connectedCallback(),this.shape||(this.shape="circle")}};w([k],zc.prototype,"fill",void 0);w([k],zc.prototype,"color",void 0);w([k],zc.prototype,"link",void 0);w([k],zc.prototype,"shape",void 0)});var FE=y(()=>{l();c();d();OE();ME()});var DE,LE=y(()=>{l();c();d();A();DE=(r,e)=>O`
    <template class="${t=>t.circular?"circular":""}">
        <div class="control" part="control" style="${t=>t.generateBadgeStyle()}">
            <slot></slot>
        </div>
    </template>
`});var ya,NE=y(()=>{l();c();d();Pe();A();He();ya=class extends G{constructor(){super(...arguments),this.generateBadgeStyle=()=>{if(!this.fill&&!this.color)return;let e=`background-color: var(--badge-fill-${this.fill});`,t=`color: var(--badge-color-${this.color});`;return this.fill&&!this.color?e:this.color&&!this.fill?t:`${t} ${e}`}}};w([k({attribute:"fill"})],ya.prototype,"fill",void 0);w([k({attribute:"color"})],ya.prototype,"color",void 0);w([k({mode:"boolean"})],ya.prototype,"circular",void 0)});var HE=y(()=>{l();c();d();LE();NE()});var UE,BE=y(()=>{l();c();d();A();Eb();$t();UE=(r,e)=>O`
    <div role="listitem" class="listitem" part="listitem">
        ${Ze(t=>t.href&&t.href.length>0,O`
                ${cm(r,e)}
            `)}
        ${Ze(t=>!t.href,O`
                ${Ct(r,e)}
                <slot></slot>
                ${wt(r,e)}
            `)}
        ${Ze(t=>t.separator,O`
                <span class="separator" part="separator" aria-hidden="true">
                    <slot name="separator">${e.separator||""}</slot>
                </span>
            `)}
    </div>
`});var Ss,Fb=y(()=>{l();c();d();Pe();A();Ib();Il();Vr();Ss=class extends no{constructor(){super(...arguments),this.separator=!0}};w([I],Ss.prototype,"separator",void 0);We(Ss,_t,Al)});var zE=y(()=>{l();c();d();BE();Fb()});var VE,qE=y(()=>{l();c();d();A();VE=(r,e)=>O`
    <template role="navigation">
        <div role="list" class="list" part="list">
            <slot
                ${De({property:"slottedBreadcrumbItems",filter:zr()})}
            ></slot>
        </div>
    </template>
`});var Gu,GE=y(()=>{l();c();d();Pe();A();Fb();He();Gu=class extends G{slottedBreadcrumbItemsChanged(){if(this.$fastController.isConnected){if(this.slottedBreadcrumbItems===void 0||this.slottedBreadcrumbItems.length===0)return;let e=this.slottedBreadcrumbItems[this.slottedBreadcrumbItems.length-1];this.slottedBreadcrumbItems.forEach(t=>{let o=t===e;this.setItemSeparator(t,o),this.setAriaCurrent(t,o)})}}setItemSeparator(e,t){e instanceof Ss&&(e.separator=!t)}findChildWithHref(e){var t,o;return e.childElementCount>0?e.querySelector("a[href]"):!((t=e.shadowRoot)===null||t===void 0)&&t.childElementCount?(o=e.shadowRoot)===null||o===void 0?void 0:o.querySelector("a[href]"):null}setAriaCurrent(e,t){let o=this.findChildWithHref(e);o===null&&e.hasAttribute("href")&&e instanceof Ss?t?e.setAttribute("aria-current","page"):e.removeAttribute("aria-current"):o!==null&&(t?o.setAttribute("aria-current","page"):o.removeAttribute("aria-current"))}};w([I],Gu.prototype,"slottedBreadcrumbItems",void 0)});var jE=y(()=>{l();c();d();qE();GE()});var KE,WE=y(()=>{l();c();d();A();$t();KE=(r,e)=>O`
    <button
        class="control"
        part="control"
        ?autofocus="${t=>t.autofocus}"
        ?disabled="${t=>t.disabled}"
        form="${t=>t.formId}"
        formaction="${t=>t.formaction}"
        formenctype="${t=>t.formenctype}"
        formmethod="${t=>t.formmethod}"
        formnovalidate="${t=>t.formnovalidate}"
        formtarget="${t=>t.formtarget}"
        name="${t=>t.name}"
        type="${t=>t.type}"
        value="${t=>t.value}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-pressed="${t=>t.ariaPressed}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${Ee("control")}
    >
        ${Ct(r,e)}
        <span class="content" part="content">
            <slot ${De("defaultSlottedContent")}></slot>
        </span>
        ${wt(r,e)}
    </button>
`});function Rr(r){let e=class extends r{constructor(...t){super(...t),this.dirtyValue=!1,this.disabled=!1,this.proxyEventsToBlock=["change","click"],this.proxyInitialized=!1,this.required=!1,this.initialValue=this.initialValue||"",this.elementInternals||(this.formResetCallback=this.formResetCallback.bind(this))}static get formAssociated(){return ZE}get validity(){return this.elementInternals?this.elementInternals.validity:this.proxy.validity}get form(){return this.elementInternals?this.elementInternals.form:this.proxy.form}get validationMessage(){return this.elementInternals?this.elementInternals.validationMessage:this.proxy.validationMessage}get willValidate(){return this.elementInternals?this.elementInternals.willValidate:this.proxy.willValidate}get labels(){if(this.elementInternals)return Object.freeze(Array.from(this.elementInternals.labels));if(this.proxy instanceof HTMLElement&&this.proxy.ownerDocument&&this.id){let t=this.proxy.labels,o=Array.from(this.proxy.getRootNode().querySelectorAll(`[for='${this.id}']`)),i=t?o.concat(Array.from(t)):o;return Object.freeze(i)}else return wi}valueChanged(t,o){this.dirtyValue=!0,this.proxy instanceof HTMLElement&&(this.proxy.value=this.value),this.currentValue=this.value,this.setFormValue(this.value),this.validate()}currentValueChanged(){this.value=this.currentValue}initialValueChanged(t,o){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}disabledChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.disabled=this.disabled),Y.queueUpdate(()=>this.classList.toggle("disabled",this.disabled))}nameChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.name=this.name)}requiredChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.required=this.required),Y.queueUpdate(()=>this.classList.toggle("required",this.required)),this.validate()}get elementInternals(){if(!ZE)return null;let t=JE.get(this);return t||(t=this.attachInternals(),JE.set(this,t)),t}connectedCallback(){super.connectedCallback(),this.addEventListener("keypress",this._keypressHandler),this.value||(this.value=this.initialValue,this.dirtyValue=!1),this.elementInternals||(this.attachProxy(),this.form&&this.form.addEventListener("reset",this.formResetCallback))}disconnectedCallback(){super.disconnectedCallback(),this.proxyEventsToBlock.forEach(t=>this.proxy.removeEventListener(t,this.stopPropagation)),!this.elementInternals&&this.form&&this.form.removeEventListener("reset",this.formResetCallback)}checkValidity(){return this.elementInternals?this.elementInternals.checkValidity():this.proxy.checkValidity()}reportValidity(){return this.elementInternals?this.elementInternals.reportValidity():this.proxy.reportValidity()}setValidity(t,o,i){this.elementInternals?this.elementInternals.setValidity(t,o,i):typeof o=="string"&&this.proxy.setCustomValidity(o)}formDisabledCallback(t){this.disabled=t}formResetCallback(){this.value=this.initialValue,this.dirtyValue=!1}attachProxy(){var t;this.proxyInitialized||(this.proxyInitialized=!0,this.proxy.style.display="none",this.proxyEventsToBlock.forEach(o=>this.proxy.addEventListener(o,this.stopPropagation)),this.proxy.disabled=this.disabled,this.proxy.required=this.required,typeof this.name=="string"&&(this.proxy.name=this.name),typeof this.value=="string"&&(this.proxy.value=this.value),this.proxy.setAttribute("slot",QE),this.proxySlot=document.createElement("slot"),this.proxySlot.setAttribute("name",QE)),(t=this.shadowRoot)===null||t===void 0||t.appendChild(this.proxySlot),this.appendChild(this.proxy)}detachProxy(){var t;this.removeChild(this.proxy),(t=this.shadowRoot)===null||t===void 0||t.removeChild(this.proxySlot)}validate(t){this.proxy instanceof HTMLElement&&this.setValidity(this.proxy.validity,this.proxy.validationMessage,t)}setFormValue(t,o){this.elementInternals&&this.elementInternals.setFormValue(t,o||t)}_keypressHandler(t){switch(t.key){case sr:if(this.form instanceof HTMLFormElement){let o=this.form.querySelector("[type=submit]");o?.click()}break}}stopPropagation(t){t.stopPropagation()}};return k({mode:"boolean"})(e.prototype,"disabled"),k({mode:"fromView",attribute:"value"})(e.prototype,"initialValue"),k({attribute:"current-value"})(e.prototype,"currentValue"),k(e.prototype,"name"),k({mode:"boolean"})(e.prototype,"required"),I(e.prototype,"value"),e}function Vc(r){class e extends Rr(r){}class t extends e{constructor(...i){super(i),this.dirtyChecked=!1,this.checkedAttribute=!1,this.checked=!1,this.dirtyChecked=!1}checkedAttributeChanged(){this.defaultChecked=this.checkedAttribute}defaultCheckedChanged(){this.dirtyChecked||(this.checked=this.defaultChecked,this.dirtyChecked=!1)}checkedChanged(i,n){this.dirtyChecked||(this.dirtyChecked=!0),this.currentChecked=this.checked,this.updateForm(),this.proxy instanceof HTMLInputElement&&(this.proxy.checked=this.checked),i!==void 0&&this.$emit("change"),this.validate()}currentCheckedChanged(i,n){this.checked=this.currentChecked}updateForm(){let i=this.checked?this.value:null;this.setFormValue(i,i)}connectedCallback(){super.connectedCallback(),this.updateForm()}formResetCallback(){super.formResetCallback(),this.checked=!!this.checkedAttribute,this.dirtyChecked=!1}}return k({attribute:"checked",mode:"boolean"})(t.prototype,"checkedAttribute"),k({attribute:"current-checked",converter:Cs})(t.prototype,"currentChecked"),I(t.prototype,"defaultChecked"),I(t.prototype,"checked"),t}var QE,YE,ZE,JE,Go=y(()=>{l();c();d();A();we();QE="form-associated-proxy",YE="ElementInternals",ZE=YE in window&&"setFormValue"in window[YE].prototype,JE=new WeakMap});var Db,um,XE=y(()=>{l();c();d();Go();He();Db=class extends G{},um=class extends Rr(Db){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var so,qc,e2=y(()=>{l();c();d();Pe();A();Il();Vr();XE();so=class extends um{constructor(){super(...arguments),this.handleClick=e=>{var t;this.disabled&&((t=this.defaultSlottedContent)===null||t===void 0?void 0:t.length)<=1&&e.stopPropagation()},this.handleSubmission=()=>{if(!this.form)return;let e=this.proxy.isConnected;e||this.attachProxy(),typeof this.form.requestSubmit=="function"?this.form.requestSubmit(this.proxy):this.proxy.click(),e||this.detachProxy()},this.handleFormReset=()=>{var e;(e=this.form)===null||e===void 0||e.reset()},this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(!((e=this.$fastController.definition.shadowOptions)===null||e===void 0)&&e.delegatesFocus)&&(this.focus=()=>{this.control.focus()})}}formactionChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formAction=this.formaction)}formenctypeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formEnctype=this.formenctype)}formmethodChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formMethod=this.formmethod)}formnovalidateChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formNoValidate=this.formnovalidate)}formtargetChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formTarget=this.formtarget)}typeChanged(e,t){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type),t==="submit"&&this.addEventListener("click",this.handleSubmission),e==="submit"&&this.removeEventListener("click",this.handleSubmission),t==="reset"&&this.addEventListener("click",this.handleFormReset),e==="reset"&&this.removeEventListener("click",this.handleFormReset)}validate(){super.validate(this.control)}connectedCallback(){var e;super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.handleUnsupportedDelegatesFocus();let t=Array.from((e=this.control)===null||e===void 0?void 0:e.children);t&&t.forEach(o=>{o.addEventListener("click",this.handleClick)})}disconnectedCallback(){var e;super.disconnectedCallback();let t=Array.from((e=this.control)===null||e===void 0?void 0:e.children);t&&t.forEach(o=>{o.removeEventListener("click",this.handleClick)})}};w([k({mode:"boolean"})],so.prototype,"autofocus",void 0);w([k({attribute:"form"})],so.prototype,"formId",void 0);w([k],so.prototype,"formaction",void 0);w([k],so.prototype,"formenctype",void 0);w([k],so.prototype,"formmethod",void 0);w([k({mode:"boolean"})],so.prototype,"formnovalidate",void 0);w([k],so.prototype,"formtarget",void 0);w([k],so.prototype,"type",void 0);w([I],so.prototype,"defaultSlottedContent",void 0);qc=class{};w([k({attribute:"aria-expanded"})],qc.prototype,"ariaExpanded",void 0);w([k({attribute:"aria-pressed"})],qc.prototype,"ariaPressed",void 0);We(qc,dt);We(so,_t,qc)});var t2=y(()=>{l();c();d();WE();e2()});var hm,Lb=y(()=>{l();c();d();hm=class{constructor(e){if(this.dayFormat="numeric",this.weekdayFormat="long",this.monthFormat="long",this.yearFormat="numeric",this.date=new Date,e)for(let t in e){let o=e[t];t==="date"?this.date=this.getDateObject(o):this[t]=o}}getDateObject(e){if(typeof e=="string"){let t=e.split(/[/-]/);return t.length<3?new Date:new Date(parseInt(t[2],10),parseInt(t[0],10)-1,parseInt(t[1],10))}else if("day"in e&&"month"in e&&"year"in e){let{day:t,month:o,year:i}=e;return new Date(i,o-1,t)}return e}getDate(e=this.date,t={weekday:this.weekdayFormat,month:this.monthFormat,day:this.dayFormat,year:this.yearFormat},o=this.locale){let i=this.getDateObject(e);if(!i.getTime())return"";let n=Object.assign({timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},t);return new Intl.DateTimeFormat(o,n).format(i)}getDay(e=this.date.getDate(),t=this.dayFormat,o=this.locale){return this.getDate({month:1,day:e,year:2020},{day:t},o)}getMonth(e=this.date.getMonth()+1,t=this.monthFormat,o=this.locale){return this.getDate({month:e,day:2,year:2020},{month:t},o)}getYear(e=this.date.getFullYear(),t=this.yearFormat,o=this.locale){return this.getDate({month:2,day:2,year:e},{year:t},o)}getWeekday(e=0,t=this.weekdayFormat,o=this.locale){let i=`1-${e+1}-2017`;return this.getDate(i,{weekday:t},o)}getWeekdays(e=this.weekdayFormat,t=this.locale){return Array(7).fill(null).map((o,i)=>this.getWeekday(i,e,t))}}});var Ao,r2=y(()=>{l();c();d();Pe();A();we();He();Lb();Ao=class extends G{constructor(){super(...arguments),this.dateFormatter=new hm,this.readonly=!1,this.locale="en-US",this.month=new Date().getMonth()+1,this.year=new Date().getFullYear(),this.dayFormat="numeric",this.weekdayFormat="short",this.monthFormat="long",this.yearFormat="numeric",this.minWeeks=0,this.disabledDates="",this.selectedDates="",this.oneDayInMs=864e5}localeChanged(){this.dateFormatter.locale=this.locale}dayFormatChanged(){this.dateFormatter.dayFormat=this.dayFormat}weekdayFormatChanged(){this.dateFormatter.weekdayFormat=this.weekdayFormat}monthFormatChanged(){this.dateFormatter.monthFormat=this.monthFormat}yearFormatChanged(){this.dateFormatter.yearFormat=this.yearFormat}getMonthInfo(e=this.month,t=this.year){let o=u=>new Date(u.getFullYear(),u.getMonth(),1).getDay(),i=u=>{let h=new Date(u.getFullYear(),u.getMonth()+1,1);return new Date(h.getTime()-this.oneDayInMs).getDate()},n=new Date(t,e-1),s=new Date(t,e),a=new Date(t,e-2);return{length:i(n),month:e,start:o(n),year:t,previous:{length:i(a),month:a.getMonth()+1,start:o(a),year:a.getFullYear()},next:{length:i(s),month:s.getMonth()+1,start:o(s),year:s.getFullYear()}}}getDays(e=this.getMonthInfo(),t=this.minWeeks){t=t>10?10:t;let{start:o,length:i,previous:n,next:s}=e,a=[],u=1-o;for(;u<i+1||a.length<t||a[a.length-1].length%7!==0;){let{month:h,year:p}=u<1?n:u>i?s:e,f=u<1?n.length+u:u>i?u-i:u,b=`${h}-${f}-${p}`,C=this.dateInString(b,this.disabledDates),S=this.dateInString(b,this.selectedDates),R={day:f,month:h,year:p,disabled:C,selected:S},N=a[a.length-1];a.length===0||N.length%7===0?a.push([R]):N.push(R),u++}return a}dateInString(e,t){let o=t.split(",").map(i=>i.trim());return e=typeof e=="string"?e:`${e.getMonth()+1}-${e.getDate()}-${e.getFullYear()}`,o.some(i=>i===e)}getDayClassNames(e,t){let{day:o,month:i,year:n,disabled:s,selected:a}=e,u=t===`${i}-${o}-${n}`,h=this.month!==i;return["day",u&&"today",h&&"inactive",s&&"disabled",a&&"selected"].filter(Boolean).join(" ")}getWeekdayText(){let e=this.dateFormatter.getWeekdays().map(t=>({text:t}));if(this.weekdayFormat!=="long"){let t=this.dateFormatter.getWeekdays("long");e.forEach((o,i)=>{o.abbr=t[i]})}return e}handleDateSelect(e,t){e.preventDefault,this.$emit("dateselected",t)}handleKeydown(e,t){return e.key===sr&&this.handleDateSelect(e,t),!0}};w([k({mode:"boolean"})],Ao.prototype,"readonly",void 0);w([k],Ao.prototype,"locale",void 0);w([k({converter:se})],Ao.prototype,"month",void 0);w([k({converter:se})],Ao.prototype,"year",void 0);w([k({attribute:"day-format",mode:"fromView"})],Ao.prototype,"dayFormat",void 0);w([k({attribute:"weekday-format",mode:"fromView"})],Ao.prototype,"weekdayFormat",void 0);w([k({attribute:"month-format",mode:"fromView"})],Ao.prototype,"monthFormat",void 0);w([k({attribute:"year-format",mode:"fromView"})],Ao.prototype,"yearFormat",void 0);w([k({attribute:"min-weeks",converter:se})],Ao.prototype,"minWeeks",void 0);w([k({attribute:"disabled-dates"})],Ao.prototype,"disabledDates",void 0);w([k({attribute:"selected-dates"})],Ao.prototype,"selectedDates",void 0)});var ju,_s,Rl,pm=y(()=>{l();c();d();ju={none:"none",default:"default",sticky:"sticky"},_s={default:"default",columnHeader:"columnheader",rowHeader:"rowheader"},Rl={default:"default",header:"header",stickyHeader:"sticky-header"}});var ar,Nb=y(()=>{l();c();d();Pe();A();we();He();pm();ar=class extends G{constructor(){super(...arguments),this.rowType=Rl.default,this.rowData=null,this.columnDefinitions=null,this.isActiveRow=!1,this.cellsRepeatBehavior=null,this.cellsPlaceholder=null,this.focusColumnIndex=0,this.refocusOnLoad=!1,this.updateRowStyle=()=>{this.style.gridTemplateColumns=this.gridTemplateColumns}}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowStyle()}rowTypeChanged(){this.$fastController.isConnected&&this.updateItemTemplate()}rowDataChanged(){if(this.rowData!==null&&this.isActiveRow){this.refocusOnLoad=!0;return}}cellItemTemplateChanged(){this.updateItemTemplate()}headerCellItemTemplateChanged(){this.updateItemTemplate()}connectedCallback(){super.connectedCallback(),this.cellsRepeatBehavior===null&&(this.cellsPlaceholder=document.createComment(""),this.appendChild(this.cellsPlaceholder),this.updateItemTemplate(),this.cellsRepeatBehavior=new On(e=>e.columnDefinitions,e=>e.activeCellItemTemplate,{positioning:!0}).createBehavior(this.cellsPlaceholder),this.$fastController.addBehaviors([this.cellsRepeatBehavior])),this.addEventListener("cell-focused",this.handleCellFocus),this.addEventListener(xs,this.handleFocusout),this.addEventListener(ks,this.handleKeydown),this.updateRowStyle(),this.refocusOnLoad&&(this.refocusOnLoad=!1,this.cellElements.length>this.focusColumnIndex&&this.cellElements[this.focusColumnIndex].focus())}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("cell-focused",this.handleCellFocus),this.removeEventListener(xs,this.handleFocusout),this.removeEventListener(ks,this.handleKeydown)}handleFocusout(e){this.contains(e.target)||(this.isActiveRow=!1,this.focusColumnIndex=0)}handleCellFocus(e){this.isActiveRow=!0,this.focusColumnIndex=this.cellElements.indexOf(e.target),this.$emit("row-focused",this)}handleKeydown(e){if(e.defaultPrevented)return;let t=0;switch(e.key){case yo:t=Math.max(0,this.focusColumnIndex-1),this.cellElements[t].focus(),e.preventDefault();break;case bo:t=Math.min(this.cellElements.length-1,this.focusColumnIndex+1),this.cellElements[t].focus(),e.preventDefault();break;case kr:e.ctrlKey||(this.cellElements[0].focus(),e.preventDefault());break;case Sr:e.ctrlKey||(this.cellElements[this.cellElements.length-1].focus(),e.preventDefault());break}}updateItemTemplate(){this.activeCellItemTemplate=this.rowType===Rl.default&&this.cellItemTemplate!==void 0?this.cellItemTemplate:this.rowType===Rl.default&&this.cellItemTemplate===void 0?this.defaultCellItemTemplate:this.headerCellItemTemplate!==void 0?this.headerCellItemTemplate:this.defaultHeaderCellItemTemplate}};w([k({attribute:"grid-template-columns"})],ar.prototype,"gridTemplateColumns",void 0);w([k({attribute:"row-type"})],ar.prototype,"rowType",void 0);w([I],ar.prototype,"rowData",void 0);w([I],ar.prototype,"columnDefinitions",void 0);w([I],ar.prototype,"cellItemTemplate",void 0);w([I],ar.prototype,"headerCellItemTemplate",void 0);w([I],ar.prototype,"rowIndex",void 0);w([I],ar.prototype,"isActiveRow",void 0);w([I],ar.prototype,"activeCellItemTemplate",void 0);w([I],ar.prototype,"defaultCellItemTemplate",void 0);w([I],ar.prototype,"defaultHeaderCellItemTemplate",void 0);w([I],ar.prototype,"cellElements",void 0)});function gM(r){let e=r.tagFor(ar);return O`
    <${e}
        :rowData="${t=>t}"
        :cellItemTemplate="${(t,o)=>o.parent.cellItemTemplate}"
        :headerCellItemTemplate="${(t,o)=>o.parent.headerCellItemTemplate}"
    ></${e}>
`}var o2,i2=y(()=>{l();c();d();A();Nb();o2=(r,e)=>{let t=gM(r),o=r.tagFor(ar);return O`
        <template
            role="grid"
            tabindex="0"
            :rowElementTag="${()=>o}"
            :defaultRowItemTemplate="${t}"
            ${pa({property:"rowElements",filter:zr("[role=row]")})}
        >
            <slot></slot>
        </template>
    `}});var _r,n2=y(()=>{l();c();d();Pe();A();we();He();pm();_r=class r extends G{constructor(){super(),this.noTabbing=!1,this.generateHeader=ju.default,this.rowsData=[],this.columnDefinitions=null,this.focusRowIndex=0,this.focusColumnIndex=0,this.rowsPlaceholder=null,this.generatedHeader=null,this.isUpdatingFocus=!1,this.pendingFocusUpdate=!1,this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!0,this.generatedGridTemplateColumns="",this.focusOnCell=(e,t,o)=>{if(this.rowElements.length===0){this.focusRowIndex=0,this.focusColumnIndex=0;return}let i=Math.max(0,Math.min(this.rowElements.length-1,e)),s=this.rowElements[i].querySelectorAll('[role="cell"], [role="gridcell"], [role="columnheader"], [role="rowheader"]'),a=Math.max(0,Math.min(s.length-1,t)),u=s[a];o&&this.scrollHeight!==this.clientHeight&&(i<this.focusRowIndex&&this.scrollTop>0||i>this.focusRowIndex&&this.scrollTop<this.scrollHeight-this.clientHeight)&&u.scrollIntoView({block:"center",inline:"center"}),u.focus()},this.onChildListChange=(e,t)=>{e&&e.length&&(e.forEach(o=>{o.addedNodes.forEach(i=>{i.nodeType===1&&i.getAttribute("role")==="row"&&(i.columnDefinitions=this.columnDefinitions)})}),this.queueRowIndexUpdate())},this.queueRowIndexUpdate=()=>{this.rowindexUpdateQueued||(this.rowindexUpdateQueued=!0,Y.queueUpdate(this.updateRowIndexes))},this.updateRowIndexes=()=>{let e=this.gridTemplateColumns;if(e===void 0){if(this.generatedGridTemplateColumns===""&&this.rowElements.length>0){let t=this.rowElements[0];this.generatedGridTemplateColumns=new Array(t.cellElements.length).fill("1fr").join(" ")}e=this.generatedGridTemplateColumns}this.rowElements.forEach((t,o)=>{let i=t;i.rowIndex=o,i.gridTemplateColumns=e,this.columnDefinitionsStale&&(i.columnDefinitions=this.columnDefinitions)}),this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!1}}static generateTemplateColumns(e){let t="";return e.forEach(o=>{t=`${t}${t===""?"":" "}1fr`}),t}noTabbingChanged(){this.$fastController.isConnected&&(this.noTabbing?this.setAttribute("tabIndex","-1"):this.setAttribute("tabIndex",this.contains(document.activeElement)||this===document.activeElement?"-1":"0"))}generateHeaderChanged(){this.$fastController.isConnected&&this.toggleGeneratedHeader()}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowIndexes()}rowsDataChanged(){this.columnDefinitions===null&&this.rowsData.length>0&&(this.columnDefinitions=r.generateColumns(this.rowsData[0])),this.$fastController.isConnected&&this.toggleGeneratedHeader()}columnDefinitionsChanged(){if(this.columnDefinitions===null){this.generatedGridTemplateColumns="";return}this.generatedGridTemplateColumns=r.generateTemplateColumns(this.columnDefinitions),this.$fastController.isConnected&&(this.columnDefinitionsStale=!0,this.queueRowIndexUpdate())}headerCellItemTemplateChanged(){this.$fastController.isConnected&&this.generatedHeader!==null&&(this.generatedHeader.headerCellItemTemplate=this.headerCellItemTemplate)}focusRowIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}focusColumnIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}connectedCallback(){super.connectedCallback(),this.rowItemTemplate===void 0&&(this.rowItemTemplate=this.defaultRowItemTemplate),this.rowsPlaceholder=document.createComment(""),this.appendChild(this.rowsPlaceholder),this.toggleGeneratedHeader(),this.rowsRepeatBehavior=new On(e=>e.rowsData,e=>e.rowItemTemplate,{positioning:!0}).createBehavior(this.rowsPlaceholder),this.$fastController.addBehaviors([this.rowsRepeatBehavior]),this.addEventListener("row-focused",this.handleRowFocus),this.addEventListener(xb,this.handleFocus),this.addEventListener(ks,this.handleKeydown),this.addEventListener(xs,this.handleFocusOut),this.observer=new MutationObserver(this.onChildListChange),this.observer.observe(this,{childList:!0}),this.noTabbing&&this.setAttribute("tabindex","-1"),Y.queueUpdate(this.queueRowIndexUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("row-focused",this.handleRowFocus),this.removeEventListener(xb,this.handleFocus),this.removeEventListener(ks,this.handleKeydown),this.removeEventListener(xs,this.handleFocusOut),this.observer.disconnect(),this.rowsPlaceholder=null,this.generatedHeader=null}handleRowFocus(e){this.isUpdatingFocus=!0;let t=e.target;this.focusRowIndex=this.rowElements.indexOf(t),this.focusColumnIndex=t.focusColumnIndex,this.setAttribute("tabIndex","-1"),this.isUpdatingFocus=!1}handleFocus(e){this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}handleFocusOut(e){(e.relatedTarget===null||!this.contains(e.relatedTarget))&&this.setAttribute("tabIndex",this.noTabbing?"-1":"0")}handleKeydown(e){if(e.defaultPrevented)return;let t,o=this.rowElements.length-1,i=this.offsetHeight+this.scrollTop,n=this.rowElements[o];switch(e.key){case qt:e.preventDefault(),this.focusOnCell(this.focusRowIndex-1,this.focusColumnIndex,!0);break;case Vt:e.preventDefault(),this.focusOnCell(this.focusRowIndex+1,this.focusColumnIndex,!0);break;case pE:if(e.preventDefault(),this.rowElements.length===0){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex===0){this.focusOnCell(0,this.focusColumnIndex,!1);return}for(t=this.focusRowIndex-1,t;t>=0;t--){let s=this.rowElements[t];if(s.offsetTop<this.scrollTop){this.scrollTop=s.offsetTop+s.clientHeight-this.clientHeight;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case hE:if(e.preventDefault(),this.rowElements.length===0){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex>=o||n.offsetTop+n.offsetHeight<=i){this.focusOnCell(o,this.focusColumnIndex,!1);return}for(t=this.focusRowIndex+1,t;t<=o;t++){let s=this.rowElements[t];if(s.offsetTop+s.offsetHeight>i){let a=0;this.generateHeader===ju.sticky&&this.generatedHeader!==null&&(a=this.generatedHeader.clientHeight),this.scrollTop=s.offsetTop-a;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case kr:e.ctrlKey&&(e.preventDefault(),this.focusOnCell(0,0,!0));break;case Sr:e.ctrlKey&&this.columnDefinitions!==null&&(e.preventDefault(),this.focusOnCell(this.rowElements.length-1,this.columnDefinitions.length-1,!0));break}}queueFocusUpdate(){this.isUpdatingFocus&&(this.contains(document.activeElement)||this===document.activeElement)||this.pendingFocusUpdate===!1&&(this.pendingFocusUpdate=!0,Y.queueUpdate(()=>this.updateFocus()))}updateFocus(){this.pendingFocusUpdate=!1,this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}toggleGeneratedHeader(){if(this.generatedHeader!==null&&(this.removeChild(this.generatedHeader),this.generatedHeader=null),this.generateHeader!==ju.none&&this.rowsData.length>0){let e=document.createElement(this.rowElementTag);this.generatedHeader=e,this.generatedHeader.columnDefinitions=this.columnDefinitions,this.generatedHeader.gridTemplateColumns=this.gridTemplateColumns,this.generatedHeader.rowType=this.generateHeader===ju.sticky?Rl.stickyHeader:Rl.header,(this.firstChild!==null||this.rowsPlaceholder!==null)&&this.insertBefore(e,this.firstChild!==null?this.firstChild:this.rowsPlaceholder);return}}};_r.generateColumns=r=>Object.getOwnPropertyNames(r).map((e,t)=>({columnDataKey:e,gridColumn:`${t}`}));w([k({attribute:"no-tabbing",mode:"boolean"})],_r.prototype,"noTabbing",void 0);w([k({attribute:"generate-header"})],_r.prototype,"generateHeader",void 0);w([k({attribute:"grid-template-columns"})],_r.prototype,"gridTemplateColumns",void 0);w([I],_r.prototype,"rowsData",void 0);w([I],_r.prototype,"columnDefinitions",void 0);w([I],_r.prototype,"rowItemTemplate",void 0);w([I],_r.prototype,"cellItemTemplate",void 0);w([I],_r.prototype,"headerCellItemTemplate",void 0);w([I],_r.prototype,"focusRowIndex",void 0);w([I],_r.prototype,"focusColumnIndex",void 0);w([I],_r.prototype,"defaultRowItemTemplate",void 0);w([I],_r.prototype,"rowElementTag",void 0);w([I],_r.prototype,"rowElements",void 0)});var vM,yM,jo,Hb=y(()=>{l();c();d();Pe();A();we();He();pm();vM=O`
    <template>
        ${r=>r.rowData===null||r.columnDefinition===null||r.columnDefinition.columnDataKey===null?null:r.rowData[r.columnDefinition.columnDataKey]}
    </template>
`,yM=O`
    <template>
        ${r=>r.columnDefinition===null?null:r.columnDefinition.title===void 0?r.columnDefinition.columnDataKey:r.columnDefinition.title}
    </template>
`,jo=class extends G{constructor(){super(...arguments),this.cellType=_s.default,this.rowData=null,this.columnDefinition=null,this.isActiveCell=!1,this.customCellView=null,this.updateCellStyle=()=>{this.style.gridColumn=this.gridColumn}}cellTypeChanged(){this.$fastController.isConnected&&this.updateCellView()}gridColumnChanged(){this.$fastController.isConnected&&this.updateCellStyle()}columnDefinitionChanged(e,t){this.$fastController.isConnected&&this.updateCellView()}connectedCallback(){var e;super.connectedCallback(),this.addEventListener(kb,this.handleFocusin),this.addEventListener(xs,this.handleFocusout),this.addEventListener(ks,this.handleKeydown),this.style.gridColumn=`${((e=this.columnDefinition)===null||e===void 0?void 0:e.gridColumn)===void 0?0:this.columnDefinition.gridColumn}`,this.updateCellView(),this.updateCellStyle()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(kb,this.handleFocusin),this.removeEventListener(xs,this.handleFocusout),this.removeEventListener(ks,this.handleKeydown),this.disconnectCellView()}handleFocusin(e){if(!this.isActiveCell){switch(this.isActiveCell=!0,this.cellType){case _s.columnHeader:if(this.columnDefinition!==null&&this.columnDefinition.headerCellInternalFocusQueue!==!0&&typeof this.columnDefinition.headerCellFocusTargetCallback=="function"){let t=this.columnDefinition.headerCellFocusTargetCallback(this);t!==null&&t.focus()}break;default:if(this.columnDefinition!==null&&this.columnDefinition.cellInternalFocusQueue!==!0&&typeof this.columnDefinition.cellFocusTargetCallback=="function"){let t=this.columnDefinition.cellFocusTargetCallback(this);t!==null&&t.focus()}break}this.$emit("cell-focused",this)}}handleFocusout(e){this!==document.activeElement&&!this.contains(document.activeElement)&&(this.isActiveCell=!1)}handleKeydown(e){if(!(e.defaultPrevented||this.columnDefinition===null||this.cellType===_s.default&&this.columnDefinition.cellInternalFocusQueue!==!0||this.cellType===_s.columnHeader&&this.columnDefinition.headerCellInternalFocusQueue!==!0))switch(e.key){case sr:case uE:if(this.contains(document.activeElement)&&document.activeElement!==this)return;switch(this.cellType){case _s.columnHeader:if(this.columnDefinition.headerCellFocusTargetCallback!==void 0){let t=this.columnDefinition.headerCellFocusTargetCallback(this);t!==null&&t.focus(),e.preventDefault()}break;default:if(this.columnDefinition.cellFocusTargetCallback!==void 0){let t=this.columnDefinition.cellFocusTargetCallback(this);t!==null&&t.focus(),e.preventDefault()}break}break;case Vo:this.contains(document.activeElement)&&document.activeElement!==this&&(this.focus(),e.preventDefault());break}}updateCellView(){if(this.disconnectCellView(),this.columnDefinition!==null)switch(this.cellType){case _s.columnHeader:this.columnDefinition.headerCellTemplate!==void 0?this.customCellView=this.columnDefinition.headerCellTemplate.render(this,this):this.customCellView=yM.render(this,this);break;case void 0:case _s.rowHeader:case _s.default:this.columnDefinition.cellTemplate!==void 0?this.customCellView=this.columnDefinition.cellTemplate.render(this,this):this.customCellView=vM.render(this,this);break}}disconnectCellView(){this.customCellView!==null&&(this.customCellView.dispose(),this.customCellView=null)}};w([k({attribute:"cell-type"})],jo.prototype,"cellType",void 0);w([k({attribute:"grid-column"})],jo.prototype,"gridColumn",void 0);w([I],jo.prototype,"rowData",void 0);w([I],jo.prototype,"columnDefinition",void 0)});function bM(r){let e=r.tagFor(jo);return O`
    <${e}
        cell-type="${t=>t.isRowHeader?"rowheader":void 0}"
        grid-column="${(t,o)=>o.index+1}"
        :rowData="${(t,o)=>o.parent.rowData}"
        :columnDefinition="${t=>t}"
    ></${e}>
`}function wM(r){let e=r.tagFor(jo);return O`
    <${e}
        cell-type="columnheader"
        grid-column="${(t,o)=>o.index+1}"
        :columnDefinition="${t=>t}"
    ></${e}>
`}var s2,a2=y(()=>{l();c();d();A();Hb();s2=(r,e)=>{let t=bM(r),o=wM(r);return O`
        <template
            role="row"
            class="${i=>i.rowType!=="default"?i.rowType:""}"
            :defaultCellItemTemplate="${t}"
            :defaultHeaderCellItemTemplate="${o}"
            ${pa({property:"cellElements",filter:zr('[role="cell"],[role="gridcell"],[role="columnheader"],[role="rowheader"]')})}
        >
            <slot ${De("slottedCellElements")}></slot>
        </template>
    `}});var l2,c2=y(()=>{l();c();d();A();l2=(r,e)=>O`
        <template
            tabindex="-1"
            role="${t=>!t.cellType||t.cellType==="default"?"gridcell":t.cellType}"
            class="
            ${t=>t.cellType==="columnheader"?"column-header":t.cellType==="rowheader"?"row-header":""}
            "
        >
            <slot></slot>
        </template>
    `});var Ub=y(()=>{l();c();d();i2();n2();a2();Nb();c2();Hb()});var d2,CM,xM,kM,SM,_M,u2,h2=y(()=>{l();c();d();A();$t();Ub();d2=O`
    <div
        class="title"
        part="title"
        aria-label="${r=>r.dateFormatter.getDate(`${r.month}-2-${r.year}`,{month:"long",year:"numeric"})}"
    >
        <span part="month">
            ${r=>r.dateFormatter.getMonth(r.month)}
        </span>
        <span part="year">${r=>r.dateFormatter.getYear(r.year)}</span>
    </div>
`,CM=r=>{let e=r.tagFor(jo);return O`
        <${e}
            class="week-day"
            part="week-day"
            tabindex="-1"
            grid-column="${(t,o)=>o.index+1}"
            abbr="${t=>t.abbr}"
        >
            ${t=>t.text}
        </${e}>
    `},xM=(r,e)=>{let t=r.tagFor(jo);return O`
        <${t}
            class="${(o,i)=>i.parentContext.parent.getDayClassNames(o,e)}"
            part="day"
            tabindex="-1"
            role="gridcell"
            grid-column="${(o,i)=>i.index+1}"
            @click="${(o,i)=>i.parentContext.parent.handleDateSelect(i.event,o)}"
            @keydown="${(o,i)=>i.parentContext.parent.handleKeydown(i.event,o)}"
            aria-label="${(o,i)=>i.parentContext.parent.dateFormatter.getDate(`${o.month}-${o.day}-${o.year}`,{month:"long",day:"numeric"})}"
        >
            <div
                class="date"
                part="${o=>e===`${o.month}-${o.day}-${o.year}`?"today":"date"}"
            >
                ${(o,i)=>i.parentContext.parent.dateFormatter.getDay(o.day)}
            </div>
            <slot name="${o=>o.month}-${o=>o.day}-${o=>o.year}"></slot>
        </${t}>
    `},kM=(r,e)=>{let t=r.tagFor(ar);return O`
        <${t}
            class="week"
            part="week"
            role="row"
            role-type="default"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
        ${_l(o=>o,xM(r,e),{positioning:!0})}
        </${t}>
    `},SM=(r,e)=>{let t=r.tagFor(_r),o=r.tagFor(ar);return O`
    <${t} class="days interact" part="days" generate-header="none">
        <${o}
            class="week-days"
            part="week-days"
            role="row"
            row-type="header"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
            ${_l(i=>i.getWeekdayText(),CM(r),{positioning:!0})}
        </${o}>
        ${_l(i=>i.getDays(),kM(r,e))}
    </${t}>
`},_M=r=>O`
        <div class="days" part="days">
            <div class="week-days" part="week-days">
                ${_l(e=>e.getWeekdayText(),O`
                        <div class="week-day" part="week-day" abbr="${e=>e.abbr}">
                            ${e=>e.text}
                        </div>
                    `)}
            </div>
            ${_l(e=>e.getDays(),O`
                    <div class="week">
                        ${_l(e=>e,O`
                                <div
                                    class="${(e,t)=>t.parentContext.parent.getDayClassNames(e,r)}"
                                    part="day"
                                    aria-label="${(e,t)=>t.parentContext.parent.dateFormatter.getDate(`${e.month}-${e.day}-${e.year}`,{month:"long",day:"numeric"})}"
                                >
                                    <div
                                        class="date"
                                        part="${e=>r===`${e.month}-${e.day}-${e.year}`?"today":"date"}"
                                    >
                                        ${(e,t)=>t.parentContext.parent.dateFormatter.getDay(e.day)}
                                    </div>
                                    <slot
                                        name="${e=>e.month}-${e=>e.day}-${e=>e.year}"
                                    ></slot>
                                </div>
                            `)}
                    </div>
                `)}
        </div>
    `,u2=(r,e)=>{var t;let o=new Date,i=`${o.getMonth()+1}-${o.getDate()}-${o.getFullYear()}`;return O`
        <template>
            ${OT}
            ${e.title instanceof Function?e.title(r,e):(t=e.title)!==null&&t!==void 0?t:""}
            <slot></slot>
            ${Ze(n=>n.readonly,_M(i),SM(r,i))}
            ${$T}
        </template>
    `}});var p2=y(()=>{l();c();d();r2();h2();Lb()});var f2,m2=y(()=>{l();c();d();A();f2=(r,e)=>O`
    <slot></slot>
`});var Ku,g2=y(()=>{l();c();d();He();Ku=class extends G{}});var v2=y(()=>{l();c();d();m2();g2()});var y2,b2=y(()=>{l();c();d();A();y2=(r,e)=>O`
    <template
        role="checkbox"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.readOnly?"readonly":""} ${t=>t.checked?"checked":""} ${t=>t.indeterminate?"indeterminate":""}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${e.checkedIndicator||""}
            </slot>
            <slot name="indeterminate-indicator">
                ${e.indeterminateIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${De("defaultSlottedNodes")}></slot>
        </label>
    </template>
`});var Bb,fm,w2=y(()=>{l();c();d();Go();He();Bb=class extends G{},fm=class extends Vc(Bb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Pl,C2=y(()=>{l();c();d();Pe();A();we();w2();Pl=class extends fm{constructor(){super(),this.initialValue="on",this.indeterminate=!1,this.keypressHandler=e=>{if(!this.readOnly)switch(e.key){case qo:this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked;break}},this.clickHandler=e=>{!this.disabled&&!this.readOnly&&(this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}};w([k({attribute:"readonly",mode:"boolean"})],Pl.prototype,"readOnly",void 0);w([I],Pl.prototype,"defaultSlottedNodes",void 0);w([I],Pl.prototype,"indeterminate",void 0)});var x2=y(()=>{l();c();d();b2();C2()});function zb(r){return Mn(r)&&(r.getAttribute("role")==="option"||r instanceof HTMLOptionElement)}var Ko,ba,Vb=y(()=>{l();c();d();Pe();A();we();He();Vu();$t();Vr();Ko=class extends G{constructor(e,t,o,i){super(),this.defaultSelected=!1,this.dirtySelected=!1,this.selected=this.defaultSelected,this.dirtyValue=!1,e&&(this.textContent=e),t&&(this.initialValue=t),o&&(this.defaultSelected=o),i&&(this.selected=i),this.proxy=new Option(`${this.textContent}`,this.initialValue,this.defaultSelected,this.selected),this.proxy.disabled=this.disabled}checkedChanged(e,t){if(typeof t=="boolean"){this.ariaChecked=t?"true":"false";return}this.ariaChecked=null}contentChanged(e,t){this.proxy instanceof HTMLOptionElement&&(this.proxy.textContent=this.textContent),this.$emit("contentchange",null,{bubbles:!0})}defaultSelectedChanged(){this.dirtySelected||(this.selected=this.defaultSelected,this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.defaultSelected))}disabledChanged(e,t){this.ariaDisabled=this.disabled?"true":"false",this.proxy instanceof HTMLOptionElement&&(this.proxy.disabled=this.disabled)}selectedAttributeChanged(){this.defaultSelected=this.selectedAttribute,this.proxy instanceof HTMLOptionElement&&(this.proxy.defaultSelected=this.defaultSelected)}selectedChanged(){this.ariaSelected=this.selected?"true":"false",this.dirtySelected||(this.dirtySelected=!0),this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.selected)}initialValueChanged(e,t){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}get label(){var e;return(e=this.value)!==null&&e!==void 0?e:this.text}get text(){var e,t;return(t=(e=this.textContent)===null||e===void 0?void 0:e.replace(/\s+/g," ").trim())!==null&&t!==void 0?t:""}set value(e){let t=`${e??""}`;this._value=t,this.dirtyValue=!0,this.proxy instanceof HTMLOptionElement&&(this.proxy.value=t),pe.notify(this,"value")}get value(){var e;return pe.track(this,"value"),(e=this._value)!==null&&e!==void 0?e:this.text}get form(){return this.proxy?this.proxy.form:null}};w([I],Ko.prototype,"checked",void 0);w([I],Ko.prototype,"content",void 0);w([I],Ko.prototype,"defaultSelected",void 0);w([k({mode:"boolean"})],Ko.prototype,"disabled",void 0);w([k({attribute:"selected",mode:"boolean"})],Ko.prototype,"selectedAttribute",void 0);w([I],Ko.prototype,"selected",void 0);w([k({attribute:"value",mode:"fromView"})],Ko.prototype,"initialValue",void 0);ba=class{};w([I],ba.prototype,"ariaChecked",void 0);w([I],ba.prototype,"ariaPosInSet",void 0);w([I],ba.prototype,"ariaSelected",void 0);w([I],ba.prototype,"ariaSetSize",void 0);We(ba,dt);We(Ko,_t,ba)});var lr,ki,wa=y(()=>{l();c();d();Pe();A();we();He();Vb();Vu();Vr();lr=class r extends G{constructor(){super(...arguments),this._options=[],this.selectedIndex=-1,this.selectedOptions=[],this.shouldSkipFocus=!1,this.typeaheadBuffer="",this.typeaheadExpired=!0,this.typeaheadTimeout=-1}get firstSelectedOption(){var e;return(e=this.selectedOptions[0])!==null&&e!==void 0?e:null}get hasSelectableOptions(){return this.options.length>0&&!this.options.every(e=>e.disabled)}get length(){var e,t;return(t=(e=this.options)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0}get options(){return pe.track(this,"options"),this._options}set options(e){this._options=e,pe.notify(this,"options")}get typeAheadExpired(){return this.typeaheadExpired}set typeAheadExpired(e){this.typeaheadExpired=e}clickHandler(e){let t=e.target.closest("option,[role=option]");if(t&&!t.disabled)return this.selectedIndex=this.options.indexOf(t),!0}focusAndScrollOptionIntoView(e=this.firstSelectedOption){this.contains(document.activeElement)&&e!==null&&(e.focus(),requestAnimationFrame(()=>{e.scrollIntoView({block:"nearest"})}))}focusinHandler(e){!this.shouldSkipFocus&&e.target===e.currentTarget&&(this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}getTypeaheadMatches(){let e=this.typeaheadBuffer.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),t=new RegExp(`^${e}`,"gi");return this.options.filter(o=>o.text.trim().match(t))}getSelectableIndex(e=this.selectedIndex,t){let o=e>t?-1:e<t?1:0,i=e+o,n=null;switch(o){case-1:{n=this.options.reduceRight((s,a,u)=>!s&&!a.disabled&&u<i?a:s,n);break}case 1:{n=this.options.reduce((s,a,u)=>!s&&!a.disabled&&u>i?a:s,n);break}}return this.options.indexOf(n)}handleChange(e,t){switch(t){case"selected":{r.slottedOptionFilter(e)&&(this.selectedIndex=this.options.indexOf(e)),this.setSelectedOptions();break}}}handleTypeAhead(e){this.typeaheadTimeout&&window.clearTimeout(this.typeaheadTimeout),this.typeaheadTimeout=window.setTimeout(()=>this.typeaheadExpired=!0,r.TYPE_AHEAD_TIMEOUT_MS),!(e.length>1)&&(this.typeaheadBuffer=`${this.typeaheadExpired?"":this.typeaheadBuffer}${e}`)}keydownHandler(e){if(this.disabled)return!0;this.shouldSkipFocus=!1;let t=e.key;switch(t){case kr:{e.shiftKey||(e.preventDefault(),this.selectFirstOption());break}case Vt:{e.shiftKey||(e.preventDefault(),this.selectNextOption());break}case qt:{e.shiftKey||(e.preventDefault(),this.selectPreviousOption());break}case Sr:{e.preventDefault(),this.selectLastOption();break}case fa:return this.focusAndScrollOptionIntoView(),!0;case sr:case Vo:return!0;case qo:if(this.typeaheadExpired)return!0;default:return t.length===1&&this.handleTypeAhead(`${t}`),!0}}mousedownHandler(e){return this.shouldSkipFocus=!this.contains(document.activeElement),!0}multipleChanged(e,t){this.ariaMultiSelectable=t?"true":null}selectedIndexChanged(e,t){var o;if(!this.hasSelectableOptions){this.selectedIndex=-1;return}if(!((o=this.options[this.selectedIndex])===null||o===void 0)&&o.disabled&&typeof e=="number"){let i=this.getSelectableIndex(e,t),n=i>-1?i:e;this.selectedIndex=n,t===n&&this.selectedIndexChanged(t,n);return}this.setSelectedOptions()}selectedOptionsChanged(e,t){var o;let i=t.filter(r.slottedOptionFilter);(o=this.options)===null||o===void 0||o.forEach(n=>{let s=pe.getNotifier(n);s.unsubscribe(this,"selected"),n.selected=i.includes(n),s.subscribe(this,"selected")})}selectFirstOption(){var e,t;this.disabled||(this.selectedIndex=(t=(e=this.options)===null||e===void 0?void 0:e.findIndex(o=>!o.disabled))!==null&&t!==void 0?t:-1)}selectLastOption(){this.disabled||(this.selectedIndex=XT(this.options,e=>!e.disabled))}selectNextOption(){!this.disabled&&this.selectedIndex<this.options.length-1&&(this.selectedIndex+=1)}selectPreviousOption(){!this.disabled&&this.selectedIndex>0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){var e,t;this.selectedIndex=(t=(e=this.options)===null||e===void 0?void 0:e.findIndex(o=>o.defaultSelected))!==null&&t!==void 0?t:-1}setSelectedOptions(){var e,t,o;!((e=this.options)===null||e===void 0)&&e.length&&(this.selectedOptions=[this.options[this.selectedIndex]],this.ariaActiveDescendant=(o=(t=this.firstSelectedOption)===null||t===void 0?void 0:t.id)!==null&&o!==void 0?o:"",this.focusAndScrollOptionIntoView())}slottedOptionsChanged(e,t){this.options=t.reduce((i,n)=>(zb(n)&&i.push(n),i),[]);let o=`${this.options.length}`;this.options.forEach((i,n)=>{i.id||(i.id=di("option-")),i.ariaPosInSet=`${n+1}`,i.ariaSetSize=o}),this.$fastController.isConnected&&(this.setSelectedOptions(),this.setDefaultSelectedOption())}typeaheadBufferChanged(e,t){if(this.$fastController.isConnected){let o=this.getTypeaheadMatches();if(o.length){let i=this.options.indexOf(o[0]);i>-1&&(this.selectedIndex=i)}this.typeaheadExpired=!1}}};lr.slottedOptionFilter=r=>zb(r)&&!r.hidden;lr.TYPE_AHEAD_TIMEOUT_MS=1e3;w([k({mode:"boolean"})],lr.prototype,"disabled",void 0);w([I],lr.prototype,"selectedIndex",void 0);w([I],lr.prototype,"selectedOptions",void 0);w([I],lr.prototype,"slottedOptions",void 0);w([I],lr.prototype,"typeaheadBuffer",void 0);ki=class{};w([I],ki.prototype,"ariaActiveDescendant",void 0);w([I],ki.prototype,"ariaDisabled",void 0);w([I],ki.prototype,"ariaExpanded",void 0);w([I],ki.prototype,"ariaMultiSelectable",void 0);We(ki,dt);We(lr,ki)});var Ca,mm=y(()=>{l();c();d();Ca={above:"above",below:"below"}});var qb,gm,k2=y(()=>{l();c();d();Go();wa();qb=class extends lr{},gm=class extends Rr(qb){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Wu,Gb=y(()=>{l();c();d();Wu={inline:"inline",list:"list",both:"both",none:"none"}});var Si,Gc,S2=y(()=>{l();c();d();Pe();A();we();wa();$t();mm();Vr();k2();Gb();Si=class extends gm{constructor(){super(...arguments),this._value="",this.filteredOptions=[],this.filter="",this.forcedPosition=!1,this.listboxId=di("listbox-"),this.maxHeight=0,this.open=!1}formResetCallback(){super.formResetCallback(),this.setDefaultSelectedOption(),this.updateValue()}validate(){super.validate(this.control)}get isAutocompleteInline(){return this.autocomplete===Wu.inline||this.isAutocompleteBoth}get isAutocompleteList(){return this.autocomplete===Wu.list||this.isAutocompleteBoth}get isAutocompleteBoth(){return this.autocomplete===Wu.both}openChanged(){if(this.open){this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),Y.queueUpdate(()=>this.focus());return}this.ariaControls="",this.ariaExpanded="false"}get options(){return pe.track(this,"options"),this.filteredOptions.length?this.filteredOptions:this._options}set options(e){this._options=e,pe.notify(this,"options")}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}positionChanged(e,t){this.positionAttribute=t,this.setPositioning()}get value(){return pe.track(this,"value"),this._value}set value(e){var t,o,i;let n=`${this._value}`;if(this.$fastController.isConnected&&this.options){let s=this.options.findIndex(h=>h.text.toLowerCase()===e.toLowerCase()),a=(t=this.options[this.selectedIndex])===null||t===void 0?void 0:t.text,u=(o=this.options[s])===null||o===void 0?void 0:o.text;this.selectedIndex=a!==u?s:this.selectedIndex,e=((i=this.firstSelectedOption)===null||i===void 0?void 0:i.text)||e}n!==e&&(this._value=e,super.valueChanged(n,e),pe.notify(this,"value"))}clickHandler(e){if(!this.disabled){if(this.open){let t=e.target.closest("option,[role=option]");if(!t||t.disabled)return;this.selectedOptions=[t],this.control.value=t.text,this.clearSelectionRange(),this.updateValue(!0)}return this.open=!this.open,this.open&&this.control.focus(),!0}}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.value&&(this.initialValue=this.value)}disabledChanged(e,t){super.disabledChanged&&super.disabledChanged(e,t),this.ariaDisabled=this.disabled?"true":"false"}filterOptions(){(!this.autocomplete||this.autocomplete===Wu.none)&&(this.filter="");let e=this.filter.toLowerCase();this.filteredOptions=this._options.filter(t=>t.text.toLowerCase().startsWith(this.filter.toLowerCase())),this.isAutocompleteList&&(!this.filteredOptions.length&&!e&&(this.filteredOptions=this._options),this._options.forEach(t=>{t.hidden=!this.filteredOptions.includes(t)}))}focusAndScrollOptionIntoView(){this.contains(document.activeElement)&&(this.control.focus(),this.firstSelectedOption&&requestAnimationFrame(()=>{var e;(e=this.firstSelectedOption)===null||e===void 0||e.scrollIntoView({block:"nearest"})}))}focusoutHandler(e){if(this.syncValue(),!this.open)return!0;let t=e.relatedTarget;if(this.isSameNode(t)){this.focus();return}(!this.options||!this.options.includes(t))&&(this.open=!1)}inputHandler(e){if(this.filter=this.control.value,this.filterOptions(),this.isAutocompleteInline||(this.selectedIndex=this.options.map(t=>t.text).indexOf(this.control.value)),e.inputType.includes("deleteContent")||!this.filter.length)return!0;this.isAutocompleteList&&!this.open&&(this.open=!0),this.isAutocompleteInline&&(this.filteredOptions.length?(this.selectedOptions=[this.filteredOptions[0]],this.selectedIndex=this.options.indexOf(this.firstSelectedOption),this.setInlineSelection()):this.selectedIndex=-1)}keydownHandler(e){let t=e.key;if(e.ctrlKey||e.shiftKey)return!0;switch(t){case"Enter":{this.syncValue(),this.isAutocompleteInline&&(this.filter=this.value),this.open=!1,this.clearSelectionRange();break}case"Escape":{if(this.isAutocompleteInline||(this.selectedIndex=-1),this.open){this.open=!1;break}this.value="",this.control.value="",this.filter="",this.filterOptions();break}case"Tab":{if(this.setInputToSelection(),!this.open)return!0;e.preventDefault(),this.open=!1;break}case"ArrowUp":case"ArrowDown":{if(this.filterOptions(),!this.open){this.open=!0;break}this.filteredOptions.length>0&&super.keydownHandler(e),this.isAutocompleteInline&&this.setInlineSelection();break}default:return!0}}keyupHandler(e){switch(e.key){case"ArrowLeft":case"ArrowRight":case"Backspace":case"Delete":case"Home":case"End":{this.filter=this.control.value,this.selectedIndex=-1,this.filterOptions();break}}}selectedIndexChanged(e,t){if(this.$fastController.isConnected){if(t=ga(-1,this.options.length-1,t),t!==this.selectedIndex){this.selectedIndex=t;return}super.selectedIndexChanged(e,t)}}selectPreviousOption(){!this.disabled&&this.selectedIndex>=0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){if(this.$fastController.isConnected&&this.options){let e=this.options.findIndex(t=>t.getAttribute("selected")!==null||t.selected);this.selectedIndex=e,!this.dirtyValue&&this.firstSelectedOption&&(this.value=this.firstSelectedOption.text),this.setSelectedOptions()}}setInputToSelection(){this.firstSelectedOption&&(this.control.value=this.firstSelectedOption.text,this.control.focus())}setInlineSelection(){this.firstSelectedOption&&(this.setInputToSelection(),this.control.setSelectionRange(this.filter.length,this.control.value.length,"backward"))}syncValue(){var e;let t=this.selectedIndex>-1?(e=this.firstSelectedOption)===null||e===void 0?void 0:e.text:this.control.value;this.updateValue(this.value!==t)}setPositioning(){let e=this.getBoundingClientRect(),o=window.innerHeight-e.bottom;this.position=this.forcedPosition?this.positionAttribute:e.top>o?Ca.above:Ca.below,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===Ca.above?~~e.top:~~o}selectedOptionsChanged(e,t){this.$fastController.isConnected&&this._options.forEach(o=>{o.selected=t.includes(o)})}slottedOptionsChanged(e,t){super.slottedOptionsChanged(e,t),this.updateValue()}updateValue(e){var t;this.$fastController.isConnected&&(this.value=((t=this.firstSelectedOption)===null||t===void 0?void 0:t.text)||this.control.value,this.control.value=this.value),e&&this.$emit("change")}clearSelectionRange(){let e=this.control.value.length;this.control.setSelectionRange(e,e)}};w([k({attribute:"autocomplete",mode:"fromView"})],Si.prototype,"autocomplete",void 0);w([I],Si.prototype,"maxHeight",void 0);w([k({attribute:"open",mode:"boolean"})],Si.prototype,"open",void 0);w([k],Si.prototype,"placeholder",void 0);w([k({attribute:"position"})],Si.prototype,"positionAttribute",void 0);w([I],Si.prototype,"position",void 0);Gc=class{};w([I],Gc.prototype,"ariaAutoComplete",void 0);w([I],Gc.prototype,"ariaControls",void 0);We(Gc,ki);We(Si,_t,Gc)});var _2,T2=y(()=>{l();c();d();A();wa();$t();_2=(r,e)=>O`
    <template
        aria-disabled="${t=>t.ariaDisabled}"
        autocomplete="${t=>t.autocomplete}"
        class="${t=>t.open?"open":""} ${t=>t.disabled?"disabled":""} ${t=>t.position}"
        ?open="${t=>t.open}"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
    >
        <div class="control" part="control">
            ${Ct(r,e)}
            <slot name="control">
                <input
                    aria-activedescendant="${t=>t.open?t.ariaActiveDescendant:null}"
                    aria-autocomplete="${t=>t.ariaAutoComplete}"
                    aria-controls="${t=>t.ariaControls}"
                    aria-disabled="${t=>t.ariaDisabled}"
                    aria-expanded="${t=>t.ariaExpanded}"
                    aria-haspopup="listbox"
                    class="selected-value"
                    part="selected-value"
                    placeholder="${t=>t.placeholder}"
                    role="combobox"
                    type="text"
                    ?disabled="${t=>t.disabled}"
                    :value="${t=>t.value}"
                    @input="${(t,o)=>t.inputHandler(o.event)}"
                    @keyup="${(t,o)=>t.keyupHandler(o.event)}"
                    ${Ee("control")}
                />
                <div class="indicator" part="indicator" aria-hidden="true">
                    <slot name="indicator">
                        ${e.indicator||""}
                    </slot>
                </div>
            </slot>
            ${wt(r,e)}
        </div>
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>!t.open}"
            ${Ee("listbox")}
        >
            <slot
                ${De({filter:lr.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`});var E2=y(()=>{l();c();d();S2();Gb();T2()});function $l(r){let e=r.parentElement;if(e)return e;{let t=r.getRootNode();if(t.host instanceof HTMLElement)return t.host}return null}var vm=y(()=>{l();c();d()});function jb(r,e){let t=e;for(;t!==null;){if(t===r)return!0;t=$l(t)}return!1}var Kb=y(()=>{l();c();d();vm()});function TM(r){return r instanceof ua}var Fn,Qu,Qb,Yb,Zb,ym,Jb,xa,Wb,EM,Ol,Xb=y(()=>{l();c();d();Pe();A();Fn=document.createElement("div");Qu=class{setProperty(e,t){Y.queueUpdate(()=>this.target.setProperty(e,t))}removeProperty(e){Y.queueUpdate(()=>this.target.removeProperty(e))}},Qb=class extends Qu{constructor(e){super();let t=new CSSStyleSheet;t[Kf]=!0,this.target=t.cssRules[t.insertRule(":host{}")].style,e.$fastController.addStyles(nr.create([t]))}},Yb=class extends Qu{constructor(){super();let e=new CSSStyleSheet;this.target=e.cssRules[e.insertRule(":root{}")].style,document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}},Zb=class extends Qu{constructor(){super(),this.style=document.createElement("style"),document.head.appendChild(this.style);let{sheet:e}=this.style;if(e){let t=e.insertRule(":root{}",e.cssRules.length);this.target=e.cssRules[t].style}}},ym=class{constructor(e){this.store=new Map,this.target=null;let t=e.$fastController;this.style=document.createElement("style"),t.addStyles(this.style),pe.getNotifier(t).subscribe(this,"isConnected"),this.handleChange(t,"isConnected")}targetChanged(){if(this.target!==null)for(let[e,t]of this.store.entries())this.target.setProperty(e,t)}setProperty(e,t){this.store.set(e,t),Y.queueUpdate(()=>{this.target!==null&&this.target.setProperty(e,t)})}removeProperty(e){this.store.delete(e),Y.queueUpdate(()=>{this.target!==null&&this.target.removeProperty(e)})}handleChange(e,t){let{sheet:o}=this.style;if(o){let i=o.insertRule(":host{}",o.cssRules.length);this.target=o.cssRules[i].style}else this.target=null}};w([I],ym.prototype,"target",void 0);Jb=class{constructor(e){this.target=e.style}setProperty(e,t){Y.queueUpdate(()=>this.target.setProperty(e,t))}removeProperty(e){Y.queueUpdate(()=>this.target.removeProperty(e))}},xa=class r{setProperty(e,t){r.properties[e]=t;for(let o of r.roots.values())Ol.getOrCreate(r.normalizeRoot(o)).setProperty(e,t)}removeProperty(e){delete r.properties[e];for(let t of r.roots.values())Ol.getOrCreate(r.normalizeRoot(t)).removeProperty(e)}static registerRoot(e){let{roots:t}=r;if(!t.has(e)){t.add(e);let o=Ol.getOrCreate(this.normalizeRoot(e));for(let i in r.properties)o.setProperty(i,r.properties[i])}}static unregisterRoot(e){let{roots:t}=r;if(t.has(e)){t.delete(e);let o=Ol.getOrCreate(r.normalizeRoot(e));for(let i in r.properties)o.removeProperty(i)}}static normalizeRoot(e){return e===Fn?document:e}};xa.roots=new Set;xa.properties={};Wb=new WeakMap,EM=Y.supportsAdoptedStyleSheets?Qb:ym,Ol=Object.freeze({getOrCreate(r){if(Wb.has(r))return Wb.get(r);let e;return r===Fn?e=new xa:r instanceof Document?e=Y.supportsAdoptedStyleSheets?new Yb:new Zb:TM(r)?e=new EM(r):e=new Jb(r),Wb.set(r,e),e}})});function IM(r){return on.from(r)}var on,e1,t1,r1,Yu,Zu,Ro,Je,o1=y(()=>{l();c();d();Pe();A();vm();Kb();Xb();Xb();on=class r extends ha{constructor(e){super(),this.subscribers=new WeakMap,this._appliedTo=new Set,this.name=e.name,e.cssCustomPropertyName!==null&&(this.cssCustomProperty=`--${e.cssCustomPropertyName}`,this.cssVar=`var(${this.cssCustomProperty})`),this.id=r.uniqueId(),r.tokensById.set(this.id,this)}get appliedTo(){return[...this._appliedTo]}static from(e){return new r({name:typeof e=="string"?e:e.name,cssCustomPropertyName:typeof e=="string"?e:e.cssCustomPropertyName===void 0?e.name:e.cssCustomPropertyName})}static isCSSDesignToken(e){return typeof e.cssCustomProperty=="string"}static isDerivedDesignTokenValue(e){return typeof e=="function"}static getTokenById(e){return r.tokensById.get(e)}getOrCreateSubscriberSet(e=this){return this.subscribers.get(e)||this.subscribers.set(e,new Set)&&this.subscribers.get(e)}createCSS(){return this.cssVar||""}getValueFor(e){let t=Ro.getOrCreate(e).get(this);if(t!==void 0)return t;throw new Error(`Value could not be retrieved for token named "${this.name}". Ensure the value is set for ${e} or an ancestor of ${e}.`)}setValueFor(e,t){return this._appliedTo.add(e),t instanceof r&&(t=this.alias(t)),Ro.getOrCreate(e).set(this,t),this}deleteValueFor(e){return this._appliedTo.delete(e),Ro.existsFor(e)&&Ro.getOrCreate(e).delete(this),this}withDefault(e){return this.setValueFor(Fn,e),this}subscribe(e,t){let o=this.getOrCreateSubscriberSet(t);t&&!Ro.existsFor(t)&&Ro.getOrCreate(t),o.has(e)||o.add(e)}unsubscribe(e,t){let o=this.subscribers.get(t||this);o&&o.has(e)&&o.delete(e)}notify(e){let t=Object.freeze({token:this,target:e});this.subscribers.has(this)&&this.subscribers.get(this).forEach(o=>o.handleChange(t)),this.subscribers.has(e)&&this.subscribers.get(e).forEach(o=>o.handleChange(t))}alias(e){return t=>e.getValueFor(t)}};on.uniqueId=(()=>{let r=0;return()=>(r++,r.toString(16))})();on.tokensById=new Map;e1=class{startReflection(e,t){e.subscribe(this,t),this.handleChange({token:e,target:t})}stopReflection(e,t){e.unsubscribe(this,t),this.remove(e,t)}handleChange(e){let{token:t,target:o}=e;this.add(t,o)}add(e,t){Ol.getOrCreate(t).setProperty(e.cssCustomProperty,this.resolveCSSValue(Ro.getOrCreate(t).get(e)))}remove(e,t){Ol.getOrCreate(t).removeProperty(e.cssCustomProperty)}resolveCSSValue(e){return e&&typeof e.createCSS=="function"?e.createCSS():e}},t1=class{constructor(e,t,o){this.source=e,this.token=t,this.node=o,this.dependencies=new Set,this.observer=pe.binding(e,this,!1),this.observer.handleChange=this.observer.call,this.handleChange()}disconnect(){this.observer.disconnect()}handleChange(){this.node.store.set(this.token,this.observer.observe(this.node.target,la))}},r1=class{constructor(){this.values=new Map}set(e,t){this.values.get(e)!==t&&(this.values.set(e,t),pe.getNotifier(this).notify(e.id))}get(e){return pe.track(this,e.id),this.values.get(e)}delete(e){this.values.delete(e)}all(){return this.values.entries()}},Yu=new WeakMap,Zu=new WeakMap,Ro=class r{constructor(e){this.target=e,this.store=new r1,this.children=[],this.assignedValues=new Map,this.reflecting=new Set,this.bindingObservers=new Map,this.tokenValueChangeHandler={handleChange:(t,o)=>{let i=on.getTokenById(o);i&&(i.notify(this.target),this.updateCSSTokenReflection(t,i))}},Yu.set(e,this),pe.getNotifier(this.store).subscribe(this.tokenValueChangeHandler),e instanceof ua?e.$fastController.addBehaviors([this]):e.isConnected&&this.bind()}static getOrCreate(e){return Yu.get(e)||new r(e)}static existsFor(e){return Yu.has(e)}static findParent(e){if(Fn!==e.target){let t=$l(e.target);for(;t!==null;){if(Yu.has(t))return Yu.get(t);t=$l(t)}return r.getOrCreate(Fn)}return null}static findClosestAssignedNode(e,t){let o=t;do{if(o.has(e))return o;o=o.parent?o.parent:o.target!==Fn?r.getOrCreate(Fn):null}while(o!==null);return null}get parent(){return Zu.get(this)||null}updateCSSTokenReflection(e,t){if(on.isCSSDesignToken(t)){let o=this.parent,i=this.isReflecting(t);if(o){let n=o.get(t),s=e.get(t);n!==s&&!i?this.reflectToCSS(t):n===s&&i&&this.stopReflectToCSS(t)}else i||this.reflectToCSS(t)}}has(e){return this.assignedValues.has(e)}get(e){let t=this.store.get(e);if(t!==void 0)return t;let o=this.getRaw(e);if(o!==void 0)return this.hydrate(e,o),this.get(e)}getRaw(e){var t;return this.assignedValues.has(e)?this.assignedValues.get(e):(t=r.findClosestAssignedNode(e,this))===null||t===void 0?void 0:t.getRaw(e)}set(e,t){on.isDerivedDesignTokenValue(this.assignedValues.get(e))&&this.tearDownBindingObserver(e),this.assignedValues.set(e,t),on.isDerivedDesignTokenValue(t)?this.setupBindingObserver(e,t):this.store.set(e,t)}delete(e){this.assignedValues.delete(e),this.tearDownBindingObserver(e);let t=this.getRaw(e);t?this.hydrate(e,t):this.store.delete(e)}bind(){let e=r.findParent(this);e&&e.appendChild(this);for(let t of this.assignedValues.keys())t.notify(this.target)}unbind(){this.parent&&Zu.get(this).removeChild(this)}appendChild(e){e.parent&&Zu.get(e).removeChild(e);let t=this.children.filter(o=>e.contains(o));Zu.set(e,this),this.children.push(e),t.forEach(o=>e.appendChild(o)),pe.getNotifier(this.store).subscribe(e);for(let[o,i]of this.store.all())e.hydrate(o,this.bindingObservers.has(o)?this.getRaw(o):i)}removeChild(e){let t=this.children.indexOf(e);return t!==-1&&this.children.splice(t,1),pe.getNotifier(this.store).unsubscribe(e),e.parent===this?Zu.delete(e):!1}contains(e){return jb(this.target,e.target)}reflectToCSS(e){this.isReflecting(e)||(this.reflecting.add(e),r.cssCustomPropertyReflector.startReflection(e,this.target))}stopReflectToCSS(e){this.isReflecting(e)&&(this.reflecting.delete(e),r.cssCustomPropertyReflector.stopReflection(e,this.target))}isReflecting(e){return this.reflecting.has(e)}handleChange(e,t){let o=on.getTokenById(t);o&&(this.hydrate(o,this.getRaw(o)),this.updateCSSTokenReflection(this.store,o))}hydrate(e,t){if(!this.has(e)){let o=this.bindingObservers.get(e);on.isDerivedDesignTokenValue(t)?o?o.source!==t&&(this.tearDownBindingObserver(e),this.setupBindingObserver(e,t)):this.setupBindingObserver(e,t):(o&&this.tearDownBindingObserver(e),this.store.set(e,t))}}setupBindingObserver(e,t){let o=new t1(t,e,this);return this.bindingObservers.set(e,o),o}tearDownBindingObserver(e){return this.bindingObservers.has(e)?(this.bindingObservers.get(e).disconnect(),this.bindingObservers.delete(e),!0):!1}};Ro.cssCustomPropertyReflector=new e1;w([I],Ro.prototype,"children",void 0);Je=Object.freeze({create:IM,notifyConnection(r){return!r.isConnected||!Ro.existsFor(r)?!1:(Ro.getOrCreate(r).bind(),!0)},notifyDisconnection(r){return r.isConnected||!Ro.existsFor(r)?!1:(Ro.getOrCreate(r).unbind(),!0)},registerRoot(r=Fn){xa.registerRoot(r)},unregisterRoot(r=Fn){xa.unregisterRoot(r)}})});function AM(r,e,t){return typeof r=="string"?{name:r,type:e,callback:t}:r}var i1,n1,bm,jc,Ju,a1,wm,s1,I2=y(()=>{l();c();d();A();He();om();o1();am();i1=Object.freeze({definitionCallbackOnly:null,ignoreDuplicate:Symbol()}),n1=new Map,bm=new Map,jc=null,Ju=At.createInterface(r=>r.cachedCallback(e=>(jc===null&&(jc=new wm(null,e)),jc))),a1=Object.freeze({tagFor(r){return bm.get(r)},responsibleFor(r){let e=r.$$designSystem$$;return e||At.findResponsibleContainer(r).get(Ju)},getOrCreate(r){if(!r)return jc===null&&(jc=At.getOrCreateDOMContainer().get(Ju)),jc;let e=r.$$designSystem$$;if(e)return e;let t=At.getOrCreateDOMContainer(r);if(t.has(Ju,!1))return t.get(Ju);{let o=new wm(r,t);return t.register(Tl.instance(Ju,o)),o}}});wm=class{constructor(e,t){this.owner=e,this.container=t,this.designTokensInitialized=!1,this.prefix="fast",this.shadowRootMode=void 0,this.disambiguate=()=>i1.definitionCallbackOnly,e!==null&&(e.$$designSystem$$=this)}withPrefix(e){return this.prefix=e,this}withShadowRootMode(e){return this.shadowRootMode=e,this}withElementDisambiguation(e){return this.disambiguate=e,this}withDesignTokenRoot(e){return this.designTokenRoot=e,this}register(...e){let t=this.container,o=[],i=this.disambiguate,n=this.shadowRootMode,s={elementPrefix:this.prefix,tryDefineElement(a,u,h){let p=AM(a,u,h),{name:f,callback:b,baseClass:C}=p,{type:S}=p,R=f,N=n1.get(R),ye=!0;for(;N;){let ie=i(R,S,N);switch(ie){case i1.ignoreDuplicate:return;case i1.definitionCallbackOnly:ye=!1,N=void 0;break;default:R=ie,N=n1.get(R);break}}ye&&((bm.has(S)||S===G)&&(S=class extends S{}),n1.set(R,S),bm.set(S,R),C&&bm.set(C,R)),o.push(new s1(t,R,S,n,b,ye))}};this.designTokensInitialized||(this.designTokensInitialized=!0,this.designTokenRoot!==null&&Je.registerRoot(this.designTokenRoot)),t.registerWithContext(s,...e);for(let a of o)a.callback(a),a.willDefine&&a.definition!==null&&a.definition.define();return this}},s1=class{constructor(e,t,o,i,n,s){this.container=e,this.name=t,this.type=o,this.shadowRootMode=i,this.callback=n,this.willDefine=s,this.definition=null}definePresentation(e){sm.define(this.name,e,this.container)}defineElement(e){this.definition=new $n(this.type,Object.assign(Object.assign({},e),{name:this.name}))}tagFor(e){return a1.tagFor(e)}}});var A2=y(()=>{l();c();d()});var R2=y(()=>{l();c();d();I2();am();A2()});var P2=y(()=>{l();c();d()});var $2=y(()=>{l();c();d();om()});var O2,M2=y(()=>{l();c();d();A();O2=(r,e)=>O`
    <div class="positioning-region" part="positioning-region">
        ${Ze(t=>t.modal,O`
                <div
                    class="overlay"
                    part="overlay"
                    role="presentation"
                    @click="${t=>t.dismiss()}"
                ></div>
            `)}
        <div
            role="dialog"
            tabindex="-1"
            class="control"
            part="control"
            aria-modal="${t=>t.modal}"
            aria-describedby="${t=>t.ariaDescribedby}"
            aria-labelledby="${t=>t.ariaLabelledby}"
            aria-label="${t=>t.ariaLabel}"
            ${Ee("dialog")}
        >
            <slot></slot>
        </div>
    </div>
`});var D2,RM,L2,Xu,l1,PM,N2,$M,OM,MM,FM,DM,LM,F2,NM,HM,H2,UM,c1,BM,d1,u1=y(()=>{l();c();d();D2=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],RM=D2.join(","),L2=typeof Element>"u",Xu=L2?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,l1=!L2&&Element.prototype.getRootNode?function(r){return r.getRootNode()}:function(r){return r.ownerDocument},PM=function(e,t){return e.tabIndex<0&&(t||/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||e.isContentEditable)&&isNaN(parseInt(e.getAttribute("tabindex"),10))?0:e.tabIndex},N2=function(e){return e.tagName==="INPUT"},$M=function(e){return N2(e)&&e.type==="hidden"},OM=function(e){var t=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(o){return o.tagName==="SUMMARY"});return t},MM=function(e,t){for(var o=0;o<e.length;o++)if(e[o].checked&&e[o].form===t)return e[o]},FM=function(e){if(!e.name)return!0;var t=e.form||l1(e),o=function(a){return t.querySelectorAll('input[type="radio"][name="'+a+'"]')},i;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")i=o(window.CSS.escape(e.name));else try{i=o(e.name)}catch(s){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",s.message),!1}var n=MM(i,e.form);return!n||n===e},DM=function(e){return N2(e)&&e.type==="radio"},LM=function(e){return DM(e)&&!FM(e)},F2=function(e){var t=e.getBoundingClientRect(),o=t.width,i=t.height;return o===0&&i===0},NM=function(e,t){var o=t.displayCheck,i=t.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var n=Xu.call(e,"details>summary:first-of-type"),s=n?e.parentElement:e;if(Xu.call(s,"details:not([open]) *"))return!0;var a=l1(e).host,u=a?.ownerDocument.contains(a)||e.ownerDocument.contains(e);if(!o||o==="full"){if(typeof i=="function"){for(var h=e;e;){var p=e.parentElement,f=l1(e);if(p&&!p.shadowRoot&&i(p)===!0)return F2(e);e.assignedSlot?e=e.assignedSlot:!p&&f!==e.ownerDocument?e=f.host:e=p}e=h}if(u)return!e.getClientRects().length}else if(o==="non-zero-area")return F2(e);return!1},HM=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if(t.tagName==="FIELDSET"&&t.disabled){for(var o=0;o<t.children.length;o++){var i=t.children.item(o);if(i.tagName==="LEGEND")return Xu.call(t,"fieldset[disabled] *")?!0:!i.contains(e)}return!0}t=t.parentElement}return!1},H2=function(e,t){return!(t.disabled||$M(t)||NM(t,e)||OM(t)||HM(t))},UM=function(e,t){return!(LM(t)||PM(t)<0||!H2(e,t))},c1=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Xu.call(e,RM)===!1?!1:UM(t,e)},BM=D2.concat("iframe").join(","),d1=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return Xu.call(e,BM)===!1?!1:H2(t,e)}});var Dn,U2=y(()=>{l();c();d();Pe();A();we();u1();He();Dn=class r extends G{constructor(){super(...arguments),this.modal=!0,this.hidden=!1,this.trapFocus=!0,this.trapFocusChanged=()=>{this.$fastController.isConnected&&this.updateTrapFocus()},this.isTrappingFocus=!1,this.handleDocumentKeydown=e=>{if(!e.defaultPrevented&&!this.hidden)switch(e.key){case Vo:this.dismiss(),e.preventDefault();break;case fa:this.handleTabKeyDown(e);break}},this.handleDocumentFocus=e=>{!e.defaultPrevented&&this.shouldForceFocus(e.target)&&(this.focusFirstElement(),e.preventDefault())},this.handleTabKeyDown=e=>{if(!this.trapFocus||this.hidden)return;let t=this.getTabQueueBounds();if(t.length!==0){if(t.length===1){t[0].focus(),e.preventDefault();return}e.shiftKey&&e.target===t[0]?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&e.target===t[t.length-1]&&(t[0].focus(),e.preventDefault())}},this.getTabQueueBounds=()=>{let e=[];return r.reduceTabbableItems(e,this)},this.focusFirstElement=()=>{let e=this.getTabQueueBounds();e.length>0?e[0].focus():this.dialog instanceof HTMLElement&&this.dialog.focus()},this.shouldForceFocus=e=>this.isTrappingFocus&&!this.contains(e),this.shouldTrapFocus=()=>this.trapFocus&&!this.hidden,this.updateTrapFocus=e=>{let t=e===void 0?this.shouldTrapFocus():e;t&&!this.isTrappingFocus?(this.isTrappingFocus=!0,document.addEventListener("focusin",this.handleDocumentFocus),Y.queueUpdate(()=>{this.shouldForceFocus(document.activeElement)&&this.focusFirstElement()})):!t&&this.isTrappingFocus&&(this.isTrappingFocus=!1,document.removeEventListener("focusin",this.handleDocumentFocus))}}dismiss(){this.$emit("dismiss"),this.$emit("cancel")}show(){this.hidden=!1}hide(){this.hidden=!0,this.$emit("close")}connectedCallback(){super.connectedCallback(),document.addEventListener("keydown",this.handleDocumentKeydown),this.notifier=pe.getNotifier(this),this.notifier.subscribe(this,"hidden"),this.updateTrapFocus()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleDocumentKeydown),this.updateTrapFocus(!1),this.notifier.unsubscribe(this,"hidden")}handleChange(e,t){switch(t){case"hidden":this.updateTrapFocus();break;default:break}}static reduceTabbableItems(e,t){return t.getAttribute("tabindex")==="-1"?e:c1(t)||r.isFocusableFastElement(t)&&r.hasTabbableShadow(t)?(e.push(t),e):t.childElementCount?e.concat(Array.from(t.children).reduce(r.reduceTabbableItems,[])):e}static isFocusableFastElement(e){var t,o;return!!(!((o=(t=e.$fastController)===null||t===void 0?void 0:t.definition.shadowOptions)===null||o===void 0)&&o.delegatesFocus)}static hasTabbableShadow(e){var t,o;return Array.from((o=(t=e.shadowRoot)===null||t===void 0?void 0:t.querySelectorAll("*"))!==null&&o!==void 0?o:[]).some(i=>c1(i))}};w([k({mode:"boolean"})],Dn.prototype,"modal",void 0);w([k({mode:"boolean"})],Dn.prototype,"hidden",void 0);w([k({attribute:"trap-focus",mode:"boolean"})],Dn.prototype,"trapFocus",void 0);w([k({attribute:"aria-describedby"})],Dn.prototype,"ariaDescribedby",void 0);w([k({attribute:"aria-labelledby"})],Dn.prototype,"ariaLabelledby",void 0);w([k({attribute:"aria-label"})],Dn.prototype,"ariaLabel",void 0)});var B2=y(()=>{l();c();d();M2();U2()});var zM,Cm,z2=y(()=>{l();c();d();A();zM=new MutationObserver(r=>{for(let e of r)Cm.getOrCreateFor(e.target).notify(e.attributeName)}),Cm=class r extends Rn{constructor(e){super(e),this.watchedAttributes=new Set,r.subscriberCache.set(e,this)}subscribe(e){super.subscribe(e),this.watchedAttributes.has(e.attributes)||(this.watchedAttributes.add(e.attributes),this.observe())}unsubscribe(e){super.unsubscribe(e),this.watchedAttributes.has(e.attributes)&&(this.watchedAttributes.delete(e.attributes),this.observe())}static getOrCreateFor(e){return this.subscriberCache.get(e)||new r(e)}observe(){let e=[];for(let t of this.watchedAttributes.values())for(let o=0;o<t.length;o++)e.push(t[o]);zM.observe(this.source,{attributeFilter:e})}};Cm.subscriberCache=new WeakMap});var V2=y(()=>{l();c();d();A()});var xm,q2=y(()=>{l();c();d();Pe();A();He();xm=class extends G{connectedCallback(){super.connectedCallback(),this.setup()}disconnectedCallback(){super.disconnectedCallback(),this.details.removeEventListener("toggle",this.onToggle)}show(){this.details.open=!0}hide(){this.details.open=!1}toggle(){this.details.open=!this.details.open}setup(){this.onToggle=this.onToggle.bind(this),this.details.addEventListener("toggle",this.onToggle),this.expanded&&this.show()}onToggle(){this.expanded=this.details.open,this.$emit("toggle")}};w([k({mode:"boolean"})],xm.prototype,"expanded",void 0);w([k],xm.prototype,"title",void 0)});var G2=y(()=>{l();c();d();V2();q2()});var j2,K2=y(()=>{l();c();d();A();j2=(r,e)=>O`
    <template role="${t=>t.role}" aria-orientation="${t=>t.orientation}"></template>
`});var W2,Q2=y(()=>{l();c();d();W2={separator:"separator",presentation:"presentation"}});var ka,Y2=y(()=>{l();c();d();Pe();A();we();He();Q2();ka=class extends G{constructor(){super(...arguments),this.role=W2.separator,this.orientation=Tt.horizontal}};w([k],ka.prototype,"role",void 0);w([k],ka.prototype,"orientation",void 0)});var Z2=y(()=>{l();c();d();K2();Y2()});var eh,h1=y(()=>{l();c();d();eh={next:"next",previous:"previous"}});var J2,X2=y(()=>{l();c();d();A();h1();J2=(r,e)=>O`
    <template
        role="button"
        aria-disabled="${t=>t.disabled?!0:void 0}"
        tabindex="${t=>t.hiddenFromAT?-1:0}"
        class="${t=>t.direction} ${t=>t.disabled?"disabled":""}"
        @keyup="${(t,o)=>t.keyupHandler(o.event)}"
    >
        ${Ze(t=>t.direction===eh.next,O`
                <span part="next" class="next">
                    <slot name="next">
                        ${e.next||""}
                    </slot>
                </span>
            `)}
        ${Ze(t=>t.direction===eh.previous,O`
                <span part="previous" class="previous">
                    <slot name="previous">
                        ${e.previous||""}
                    </slot>
                </span>
            `)}
    </template>
`});var Ml,e5=y(()=>{l();c();d();Pe();A();He();h1();Ml=class extends G{constructor(){super(...arguments),this.hiddenFromAT=!0,this.direction=eh.next}keyupHandler(e){if(!this.hiddenFromAT){let t=e.key;(t==="Enter"||t==="Space")&&this.$emit("click",e),t==="Escape"&&this.blur()}}};w([k({mode:"boolean"})],Ml.prototype,"disabled",void 0);w([k({attribute:"aria-hidden",converter:Cs})],Ml.prototype,"hiddenFromAT",void 0);w([k],Ml.prototype,"direction",void 0)});var t5=y(()=>{l();c();d();X2();e5()});var r5=y(()=>{l();c();d();Go()});var o5=y(()=>{l();c();d();He()});var i5,n5=y(()=>{l();c();d();A();$t();i5=(r,e)=>O`
    <template
        aria-checked="${t=>t.ariaChecked}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-posinset="${t=>t.ariaPosInSet}"
        aria-selected="${t=>t.ariaSelected}"
        aria-setsize="${t=>t.ariaSetSize}"
        class="${t=>[t.checked&&"checked",t.selected&&"selected",t.disabled&&"disabled"].filter(Boolean).join(" ")}"
        role="option"
    >
        ${Ct(r,e)}
        <span class="content" part="content">
            <slot ${De("content")}></slot>
        </span>
        ${wt(r,e)}
    </template>
`});var s5=y(()=>{l();c();d();Vb();n5()});var Ts,km=y(()=>{l();c();d();Pe();A();we();wa();Ts=class extends lr{constructor(){super(...arguments),this.activeIndex=-1,this.rangeStartIndex=-1}get activeOption(){return this.options[this.activeIndex]}get checkedOptions(){var e;return(e=this.options)===null||e===void 0?void 0:e.filter(t=>t.checked)}get firstSelectedOptionIndex(){return this.options.indexOf(this.firstSelectedOption)}activeIndexChanged(e,t){var o,i;this.ariaActiveDescendant=(i=(o=this.options[t])===null||o===void 0?void 0:o.id)!==null&&i!==void 0?i:"",this.focusAndScrollOptionIntoView()}checkActiveIndex(){if(!this.multiple)return;let e=this.activeOption;e&&(e.checked=!0)}checkFirstOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex+1),this.options.forEach((t,o)=>{t.checked=zu(o,this.rangeStartIndex)})):this.uncheckAllOptions(),this.activeIndex=0,this.checkActiveIndex()}checkLastOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.options.forEach((t,o)=>{t.checked=zu(o,this.rangeStartIndex,this.options.length)})):this.uncheckAllOptions(),this.activeIndex=this.options.length-1,this.checkActiveIndex()}connectedCallback(){super.connectedCallback(),this.addEventListener("focusout",this.focusoutHandler)}disconnectedCallback(){this.removeEventListener("focusout",this.focusoutHandler),super.disconnectedCallback()}checkNextOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.options.forEach((t,o)=>{t.checked=zu(o,this.rangeStartIndex,this.activeIndex+1)})):this.uncheckAllOptions(),this.activeIndex+=this.activeIndex<this.options.length-1?1:0,this.checkActiveIndex()}checkPreviousOption(e=!1){e?(this.rangeStartIndex===-1&&(this.rangeStartIndex=this.activeIndex),this.checkedOptions.length===1&&(this.rangeStartIndex+=1),this.options.forEach((t,o)=>{t.checked=zu(o,this.activeIndex,this.rangeStartIndex)})):this.uncheckAllOptions(),this.activeIndex-=this.activeIndex>0?1:0,this.checkActiveIndex()}clickHandler(e){var t;if(!this.multiple)return super.clickHandler(e);let o=(t=e.target)===null||t===void 0?void 0:t.closest("[role=option]");if(!(!o||o.disabled))return this.uncheckAllOptions(),this.activeIndex=this.options.indexOf(o),this.checkActiveIndex(),this.toggleSelectedForAllCheckedOptions(),!0}focusAndScrollOptionIntoView(){super.focusAndScrollOptionIntoView(this.activeOption)}focusinHandler(e){if(!this.multiple)return super.focusinHandler(e);!this.shouldSkipFocus&&e.target===e.currentTarget&&(this.uncheckAllOptions(),this.activeIndex===-1&&(this.activeIndex=this.firstSelectedOptionIndex!==-1?this.firstSelectedOptionIndex:0),this.checkActiveIndex(),this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}focusoutHandler(e){this.multiple&&this.uncheckAllOptions()}keydownHandler(e){if(!this.multiple)return super.keydownHandler(e);if(this.disabled)return!0;let{key:t,shiftKey:o}=e;switch(this.shouldSkipFocus=!1,t){case kr:{this.checkFirstOption(o);return}case Vt:{this.checkNextOption(o);return}case qt:{this.checkPreviousOption(o);return}case Sr:{this.checkLastOption(o);return}case fa:return this.focusAndScrollOptionIntoView(),!0;case Vo:return this.uncheckAllOptions(),this.checkActiveIndex(),!0;case qo:if(e.preventDefault(),this.typeAheadExpired){this.toggleSelectedForAllCheckedOptions();return}default:return t.length===1&&this.handleTypeAhead(`${t}`),!0}}mousedownHandler(e){if(e.offsetX>=0&&e.offsetX<=this.scrollWidth)return super.mousedownHandler(e)}multipleChanged(e,t){var o;this.ariaMultiSelectable=t?"true":null,(o=this.options)===null||o===void 0||o.forEach(i=>{i.checked=t?!1:void 0}),this.setSelectedOptions()}setSelectedOptions(){if(!this.multiple){super.setSelectedOptions();return}this.$fastController.isConnected&&this.options&&(this.selectedOptions=this.options.filter(e=>e.selected),this.focusAndScrollOptionIntoView())}sizeChanged(e,t){var o;let i=Math.max(0,parseInt((o=t?.toFixed())!==null&&o!==void 0?o:"",10));i!==t&&Y.queueUpdate(()=>{this.size=i})}toggleSelectedForAllCheckedOptions(){let e=this.checkedOptions.filter(o=>!o.disabled),t=!e.every(o=>o.selected);e.forEach(o=>o.selected=t),this.selectedIndex=this.options.indexOf(e[e.length-1]),this.setSelectedOptions()}typeaheadBufferChanged(e,t){if(!this.multiple){super.typeaheadBufferChanged(e,t);return}if(this.$fastController.isConnected){let o=this.getTypeaheadMatches(),i=this.options.indexOf(o[0]);i>-1&&(this.activeIndex=i,this.uncheckAllOptions(),this.checkActiveIndex()),this.typeAheadExpired=!1}}uncheckAllOptions(e=!1){this.options.forEach(t=>t.checked=this.multiple?!1:void 0),e||(this.rangeStartIndex=-1)}};w([I],Ts.prototype,"activeIndex",void 0);w([k({mode:"boolean"})],Ts.prototype,"multiple",void 0);w([k({converter:se})],Ts.prototype,"size",void 0)});var a5,l5=y(()=>{l();c();d();A();km();a5=(r,e)=>O`
    <template
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        class="listbox"
        role="listbox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        <slot
            ${De({filter:Ts.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
        ></slot>
    </template>
`});var c5=y(()=>{l();c();d();wa();km();l5()});var Fl,p1=y(()=>{l();c();d();Pe();we();A();He();Fl=class extends G{constructor(){super(...arguments),this.optionElements=[]}menuElementsChanged(){this.updateOptions()}headerElementsChanged(){this.updateOptions()}footerElementsChanged(){this.updateOptions()}updateOptions(){this.optionElements.splice(0,this.optionElements.length),this.addSlottedListItems(this.headerElements),this.addSlottedListItems(this.menuElements),this.addSlottedListItems(this.footerElements),this.$emit("optionsupdated",{bubbles:!1})}addSlottedListItems(e){e!==void 0&&e.forEach(t=>{t.nodeType===1&&t.getAttribute("role")==="listitem"&&(t.id=t.id||di("option-"),this.optionElements.push(t))})}};w([I],Fl.prototype,"menuElements",void 0);w([I],Fl.prototype,"headerElements",void 0);w([I],Fl.prototype,"footerElements",void 0);w([I],Fl.prototype,"suggestionsAvailableText",void 0)});var VM,Dl,Sm=y(()=>{l();c();d();Pe();A();He();VM=O`
    <template>
        ${r=>r.value}
    </template>
`,Dl=class extends G{contentsTemplateChanged(){this.$fastController.isConnected&&this.updateView()}connectedCallback(){super.connectedCallback(),this.updateView()}disconnectedCallback(){super.disconnectedCallback(),this.disconnectView()}handleClick(e){return e.defaultPrevented||this.handleInvoked(),!1}handleInvoked(){this.$emit("pickeroptioninvoked")}updateView(){var e,t;this.disconnectView(),this.customView=(t=(e=this.contentsTemplate)===null||e===void 0?void 0:e.render(this,this))!==null&&t!==void 0?t:VM.render(this,this)}disconnectView(){var e;(e=this.customView)===null||e===void 0||e.dispose(),this.customView=void 0}};w([k({attribute:"value"})],Dl.prototype,"value",void 0);w([I],Dl.prototype,"contentsTemplate",void 0)});var f1=y(()=>{l();c();d();He()});var qM,Ll,_m=y(()=>{l();c();d();Pe();A();we();He();qM=O`
    <template>
        ${r=>r.value}
    </template>
`,Ll=class extends G{contentsTemplateChanged(){this.$fastController.isConnected&&this.updateView()}connectedCallback(){super.connectedCallback(),this.updateView()}disconnectedCallback(){this.disconnectView(),super.disconnectedCallback()}handleKeyDown(e){return e.defaultPrevented?!1:e.key===sr?(this.handleInvoke(),!1):!0}handleClick(e){return e.defaultPrevented||this.handleInvoke(),!1}handleInvoke(){this.$emit("pickeriteminvoked")}updateView(){var e,t;this.disconnectView(),this.customView=(t=(e=this.contentsTemplate)===null||e===void 0?void 0:e.render(this,this))!==null&&t!==void 0?t:qM.render(this,this)}disconnectView(){var e;(e=this.customView)===null||e===void 0||e.dispose(),this.customView=void 0}};w([k({attribute:"value"})],Ll.prototype,"value",void 0);w([I],Ll.prototype,"contentsTemplate",void 0)});var d5=y(()=>{l();c();d();A();qu();p1();Sm();f1();_m()});var m1,Tm,u5=y(()=>{l();c();d();Go();He();m1=class extends G{},Tm=class extends Rr(m1){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var GM,ut,h5=y(()=>{l();c();d();Pe();A();we();Mb();Sm();_m();u5();GM=O`
    <input
        slot="input-region"
        role="combobox"
        type="text"
        autocapitalize="off"
        autocomplete="off"
        haspopup="list"
        aria-label="${r=>r.label}"
        aria-labelledby="${r=>r.labelledBy}"
        placeholder="${r=>r.placeholder}"
        ${Ee("inputElement")}
    ></input>
`,ut=class extends Tm{constructor(){super(...arguments),this.selection="",this.filterSelected=!0,this.filterQuery=!0,this.noSuggestionsText="No suggestions available",this.suggestionsAvailableText="Suggestions available",this.loadingText="Loading suggestions",this.menuPlacement="bottom-fill",this.showLoading=!1,this.optionsList=[],this.filteredOptionsList=[],this.flyoutOpen=!1,this.menuFocusIndex=-1,this.showNoOptions=!1,this.selectedItems=[],this.inputElementView=null,this.handleTextInput=e=>{this.query=this.inputElement.value},this.handleInputClick=e=>{e.preventDefault(),this.toggleFlyout(!0)},this.setRegionProps=()=>{if(this.flyoutOpen){if(this.region===null||this.region===void 0){Y.queueUpdate(this.setRegionProps);return}this.region.anchorElement=this.inputElement}},this.configLookup={top:Rb,bottom:Pb,tallest:$b,"top-fill":RE,"bottom-fill":Ob,"tallest-fill":PE}}selectionChanged(){this.$fastController.isConnected&&(this.handleSelectionChange(),this.proxy instanceof HTMLInputElement&&(this.proxy.value=this.selection,this.validate()))}optionsChanged(){this.optionsList=this.options.split(",").map(e=>e.trim()).filter(e=>e!=="")}menuPlacementChanged(){this.$fastController.isConnected&&this.updateMenuConfig()}showLoadingChanged(){this.$fastController.isConnected&&Y.queueUpdate(()=>{this.setFocusedOption(0)})}listItemTemplateChanged(){this.updateListItemTemplate()}defaultListItemTemplateChanged(){this.updateListItemTemplate()}menuOptionTemplateChanged(){this.updateOptionTemplate()}defaultMenuOptionTemplateChanged(){this.updateOptionTemplate()}optionsListChanged(){this.updateFilteredOptions()}queryChanged(){this.$fastController.isConnected&&(this.inputElement.value!==this.query&&(this.inputElement.value=this.query),this.updateFilteredOptions(),this.$emit("querychange",{bubbles:!1}))}filteredOptionsListChanged(){this.$fastController.isConnected&&(this.showNoOptions=this.filteredOptionsList.length===0&&this.menuElement.querySelectorAll('[role="listitem"]').length===0,this.setFocusedOption(this.showNoOptions?-1:0))}flyoutOpenChanged(){this.flyoutOpen?(Y.queueUpdate(this.setRegionProps),this.$emit("menuopening",{bubbles:!1})):this.$emit("menuclosing",{bubbles:!1})}showNoOptionsChanged(){this.$fastController.isConnected&&Y.queueUpdate(()=>{this.setFocusedOption(0)})}connectedCallback(){super.connectedCallback(),this.listElement=document.createElement(this.selectedListTag),this.appendChild(this.listElement),this.itemsPlaceholderElement=document.createComment(""),this.listElement.append(this.itemsPlaceholderElement),this.inputElementView=GM.render(this,this.listElement);let e=this.menuTag.toUpperCase();this.menuElement=Array.from(this.children).find(t=>t.tagName===e),this.menuElement===void 0&&(this.menuElement=document.createElement(this.menuTag),this.appendChild(this.menuElement)),this.menuElement.id===""&&(this.menuElement.id=di("listbox-")),this.menuId=this.menuElement.id,this.optionsPlaceholder=document.createComment(""),this.menuElement.append(this.optionsPlaceholder),this.updateMenuConfig(),Y.queueUpdate(()=>this.initialize())}disconnectedCallback(){super.disconnectedCallback(),this.toggleFlyout(!1),this.inputElement.removeEventListener("input",this.handleTextInput),this.inputElement.removeEventListener("click",this.handleInputClick),this.inputElementView!==null&&(this.inputElementView.dispose(),this.inputElementView=null)}focus(){this.inputElement.focus()}initialize(){this.updateListItemTemplate(),this.updateOptionTemplate(),this.itemsRepeatBehavior=new On(e=>e.selectedItems,e=>e.activeListItemTemplate,{positioning:!0}).createBehavior(this.itemsPlaceholderElement),this.inputElement.addEventListener("input",this.handleTextInput),this.inputElement.addEventListener("click",this.handleInputClick),this.$fastController.addBehaviors([this.itemsRepeatBehavior]),this.menuElement.suggestionsAvailableText=this.suggestionsAvailableText,this.menuElement.addEventListener("optionsupdated",this.handleMenuOptionsUpdated),this.optionsRepeatBehavior=new On(e=>e.filteredOptionsList,e=>e.activeMenuOptionTemplate,{positioning:!0}).createBehavior(this.optionsPlaceholder),this.$fastController.addBehaviors([this.optionsRepeatBehavior]),this.handleSelectionChange()}toggleFlyout(e){if(this.flyoutOpen!==e){if(e&&document.activeElement===this.inputElement){this.flyoutOpen=e,Y.queueUpdate(()=>{this.menuElement!==void 0?this.setFocusedOption(0):this.disableMenu()});return}this.flyoutOpen=!1,this.disableMenu()}}handleMenuOptionsUpdated(e){e.preventDefault(),this.flyoutOpen&&this.setFocusedOption(0)}handleKeyDown(e){if(e.defaultPrevented)return!1;switch(e.key){case Vt:{if(!this.flyoutOpen)this.toggleFlyout(!0);else{let t=this.flyoutOpen?Math.min(this.menuFocusIndex+1,this.menuElement.optionElements.length-1):0;this.setFocusedOption(t)}return!1}case qt:{if(!this.flyoutOpen)this.toggleFlyout(!0);else{let t=this.flyoutOpen?Math.max(this.menuFocusIndex-1,0):0;this.setFocusedOption(t)}return!1}case Vo:return this.toggleFlyout(!1),!1;case sr:return this.menuFocusIndex!==-1&&this.menuElement.optionElements.length>this.menuFocusIndex&&this.menuElement.optionElements[this.menuFocusIndex].click(),!1;case bo:return document.activeElement!==this.inputElement?(this.incrementFocusedItem(1),!1):!0;case yo:return this.inputElement.selectionStart===0?(this.incrementFocusedItem(-1),!1):!0;case mE:case fE:{if(document.activeElement===null)return!0;if(document.activeElement===this.inputElement)return this.inputElement.selectionStart===0?(this.selection=this.selectedItems.slice(0,this.selectedItems.length-1).toString(),this.toggleFlyout(!1),!1):!0;let t=Array.from(this.listElement.children),o=t.indexOf(document.activeElement);return o>-1?(this.selection=this.selectedItems.splice(o,1).toString(),Y.queueUpdate(()=>{t[Math.min(t.length,o)].focus()}),!1):!0}}return this.toggleFlyout(!0),!0}handleFocusIn(e){return!1}handleFocusOut(e){return(this.menuElement===void 0||!this.menuElement.contains(e.relatedTarget))&&this.toggleFlyout(!1),!1}handleSelectionChange(){this.selectedItems.toString()!==this.selection&&(this.selectedItems=this.selection===""?[]:this.selection.split(","),this.updateFilteredOptions(),Y.queueUpdate(()=>{this.checkMaxItems()}),this.$emit("selectionchange",{bubbles:!1}))}handleRegionLoaded(e){Y.queueUpdate(()=>{this.setFocusedOption(0),this.$emit("menuloaded",{bubbles:!1})})}checkMaxItems(){if(this.inputElement!==void 0)if(this.maxSelected!==void 0&&this.selectedItems.length>=this.maxSelected){if(document.activeElement===this.inputElement){let e=Array.from(this.listElement.querySelectorAll("[role='listitem']"));e[e.length-1].focus()}this.inputElement.hidden=!0}else this.inputElement.hidden=!1}handleItemInvoke(e){if(e.defaultPrevented)return!1;if(e.target instanceof Ll){let o=Array.from(this.listElement.querySelectorAll("[role='listitem']")).indexOf(e.target);if(o!==-1){let i=this.selectedItems.slice();i.splice(o,1),this.selection=i.toString(),Y.queueUpdate(()=>this.incrementFocusedItem(0))}return!1}return!0}handleOptionInvoke(e){return e.defaultPrevented?!1:e.target instanceof Dl?(e.target.value!==void 0&&(this.selection=`${this.selection}${this.selection===""?"":","}${e.target.value}`),this.inputElement.value="",this.query="",this.inputElement.focus(),this.toggleFlyout(!1),!1):!0}incrementFocusedItem(e){if(this.selectedItems.length===0){this.inputElement.focus();return}let t=Array.from(this.listElement.querySelectorAll("[role='listitem']"));if(document.activeElement!==null){let o=t.indexOf(document.activeElement);o===-1&&(o=t.length);let i=Math.min(t.length,Math.max(0,o+e));i===t.length?this.maxSelected!==void 0&&this.selectedItems.length>=this.maxSelected?t[i-1].focus():this.inputElement.focus():t[i].focus()}}disableMenu(){var e,t,o;this.menuFocusIndex=-1,this.menuFocusOptionId=void 0,(e=this.inputElement)===null||e===void 0||e.removeAttribute("aria-activedescendant"),(t=this.inputElement)===null||t===void 0||t.removeAttribute("aria-owns"),(o=this.inputElement)===null||o===void 0||o.removeAttribute("aria-expanded")}setFocusedOption(e){if(!this.flyoutOpen||e===-1||this.showNoOptions||this.showLoading){this.disableMenu();return}if(this.menuElement.optionElements.length===0)return;this.menuElement.optionElements.forEach(o=>{o.setAttribute("aria-selected","false")}),this.menuFocusIndex=e,this.menuFocusIndex>this.menuElement.optionElements.length-1&&(this.menuFocusIndex=this.menuElement.optionElements.length-1),this.menuFocusOptionId=this.menuElement.optionElements[this.menuFocusIndex].id,this.inputElement.setAttribute("aria-owns",this.menuId),this.inputElement.setAttribute("aria-expanded","true"),this.inputElement.setAttribute("aria-activedescendant",this.menuFocusOptionId);let t=this.menuElement.optionElements[this.menuFocusIndex];t.setAttribute("aria-selected","true"),this.menuElement.scrollTo(0,t.offsetTop)}updateListItemTemplate(){var e;this.activeListItemTemplate=(e=this.listItemTemplate)!==null&&e!==void 0?e:this.defaultListItemTemplate}updateOptionTemplate(){var e;this.activeMenuOptionTemplate=(e=this.menuOptionTemplate)!==null&&e!==void 0?e:this.defaultMenuOptionTemplate}updateFilteredOptions(){this.filteredOptionsList=this.optionsList.slice(0),this.filterSelected&&(this.filteredOptionsList=this.filteredOptionsList.filter(e=>this.selectedItems.indexOf(e)===-1)),this.filterQuery&&this.query!==""&&this.query!==void 0&&(this.filteredOptionsList=this.filteredOptionsList.filter(e=>e.indexOf(this.query)!==-1))}updateMenuConfig(){let e=this.configLookup[this.menuPlacement];e===null&&(e=Ob),this.menuConfig=Object.assign(Object.assign({},e),{autoUpdateMode:"auto",fixedPlacement:!0,horizontalViewportLock:!1,verticalViewportLock:!1})}};w([k({attribute:"selection"})],ut.prototype,"selection",void 0);w([k({attribute:"options"})],ut.prototype,"options",void 0);w([k({attribute:"filter-selected",mode:"boolean"})],ut.prototype,"filterSelected",void 0);w([k({attribute:"filter-query",mode:"boolean"})],ut.prototype,"filterQuery",void 0);w([k({attribute:"max-selected"})],ut.prototype,"maxSelected",void 0);w([k({attribute:"no-suggestions-text"})],ut.prototype,"noSuggestionsText",void 0);w([k({attribute:"suggestions-available-text"})],ut.prototype,"suggestionsAvailableText",void 0);w([k({attribute:"loading-text"})],ut.prototype,"loadingText",void 0);w([k({attribute:"label"})],ut.prototype,"label",void 0);w([k({attribute:"labelledby"})],ut.prototype,"labelledBy",void 0);w([k({attribute:"placeholder"})],ut.prototype,"placeholder",void 0);w([k({attribute:"menu-placement"})],ut.prototype,"menuPlacement",void 0);w([I],ut.prototype,"showLoading",void 0);w([I],ut.prototype,"listItemTemplate",void 0);w([I],ut.prototype,"defaultListItemTemplate",void 0);w([I],ut.prototype,"activeListItemTemplate",void 0);w([I],ut.prototype,"menuOptionTemplate",void 0);w([I],ut.prototype,"defaultMenuOptionTemplate",void 0);w([I],ut.prototype,"activeMenuOptionTemplate",void 0);w([I],ut.prototype,"listItemContentsTemplate",void 0);w([I],ut.prototype,"menuOptionContentsTemplate",void 0);w([I],ut.prototype,"optionsList",void 0);w([I],ut.prototype,"query",void 0);w([I],ut.prototype,"filteredOptionsList",void 0);w([I],ut.prototype,"flyoutOpen",void 0);w([I],ut.prototype,"menuId",void 0);w([I],ut.prototype,"selectedListTag",void 0);w([I],ut.prototype,"menuTag",void 0);w([I],ut.prototype,"menuFocusIndex",void 0);w([I],ut.prototype,"menuFocusOptionId",void 0);w([I],ut.prototype,"showNoOptions",void 0);w([I],ut.prototype,"menuConfig",void 0);w([I],ut.prototype,"selectedItems",void 0)});var p5=y(()=>{l();c();d();A()});var f5=y(()=>{l();c();d();A()});var m5=y(()=>{l();c();d();A()});var g5=y(()=>{l();c();d();A()});var v5=y(()=>{l();c();d();d5();h5();p5();p1();f5();Sm();m5();f1();g5();_m()});var qr,g1,y5=y(()=>{l();c();d();qr={menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio"},g1={[qr.menuitem]:"menuitem",[qr.menuitemcheckbox]:"menuitemcheckbox",[qr.menuitemradio]:"menuitemradio"}});var Gr,v1=y(()=>{l();c();d();Pe();A();we();He();$t();va();Vr();y5();Gr=class extends G{constructor(){super(...arguments),this.role=qr.menuitem,this.hasSubmenu=!1,this.currentDirection=et.ltr,this.focusSubmenuOnLoad=!1,this.handleMenuItemKeyDown=e=>{if(e.defaultPrevented)return!1;switch(e.key){case sr:case qo:return this.invoke(),!1;case bo:return this.expandAndFocus(),!1;case yo:if(this.expanded)return this.expanded=!1,this.focus(),!1}return!0},this.handleMenuItemClick=e=>(e.defaultPrevented||this.disabled||this.invoke(),!1),this.submenuLoaded=()=>{this.focusSubmenuOnLoad&&(this.focusSubmenuOnLoad=!1,this.hasSubmenu&&(this.submenu.focus(),this.setAttribute("tabindex","-1")))},this.handleMouseOver=e=>(this.disabled||!this.hasSubmenu||this.expanded||(this.expanded=!0),!1),this.handleMouseOut=e=>(!this.expanded||this.contains(document.activeElement)||(this.expanded=!1),!1),this.expandAndFocus=()=>{this.hasSubmenu&&(this.focusSubmenuOnLoad=!0,this.expanded=!0)},this.invoke=()=>{if(!this.disabled)switch(this.role){case qr.menuitemcheckbox:this.checked=!this.checked;break;case qr.menuitem:this.updateSubmenu(),this.hasSubmenu?this.expandAndFocus():this.$emit("change");break;case qr.menuitemradio:this.checked||(this.checked=!0);break}},this.updateSubmenu=()=>{this.submenu=this.domChildren().find(e=>e.getAttribute("role")==="menu"),this.hasSubmenu=this.submenu!==void 0}}expandedChanged(e){if(this.$fastController.isConnected){if(this.submenu===void 0)return;this.expanded===!1?this.submenu.collapseExpandedItem():this.currentDirection=ui(this),this.$emit("expanded-change",this,{bubbles:!1})}}checkedChanged(e,t){this.$fastController.isConnected&&this.$emit("change")}connectedCallback(){super.connectedCallback(),Y.queueUpdate(()=>{this.updateSubmenu()}),this.startColumnCount||(this.startColumnCount=1),this.observer=new MutationObserver(this.updateSubmenu)}disconnectedCallback(){super.disconnectedCallback(),this.submenu=void 0,this.observer!==void 0&&(this.observer.disconnect(),this.observer=void 0)}domChildren(){return Array.from(this.children).filter(e=>!e.hasAttribute("hidden"))}};w([k({mode:"boolean"})],Gr.prototype,"disabled",void 0);w([k({mode:"boolean"})],Gr.prototype,"expanded",void 0);w([I],Gr.prototype,"startColumnCount",void 0);w([k],Gr.prototype,"role",void 0);w([k({mode:"boolean"})],Gr.prototype,"checked",void 0);w([I],Gr.prototype,"submenuRegion",void 0);w([I],Gr.prototype,"hasSubmenu",void 0);w([I],Gr.prototype,"currentDirection",void 0);w([I],Gr.prototype,"submenu",void 0);We(Gr,_t)});var b5,w5=y(()=>{l();c();d();A();qu();$t();v1();b5=(r,e)=>O`
    <template
        role="${t=>t.role}"
        aria-haspopup="${t=>t.hasSubmenu?"menu":void 0}"
        aria-checked="${t=>t.role!==qr.menuitem?t.checked:void 0}"
        aria-disabled="${t=>t.disabled}"
        aria-expanded="${t=>t.expanded}"
        @keydown="${(t,o)=>t.handleMenuItemKeyDown(o.event)}"
        @click="${(t,o)=>t.handleMenuItemClick(o.event)}"
        @mouseover="${(t,o)=>t.handleMouseOver(o.event)}"
        @mouseout="${(t,o)=>t.handleMouseOut(o.event)}"
        class="${t=>t.disabled?"disabled":""} ${t=>t.expanded?"expanded":""} ${t=>`indent-${t.startColumnCount}`}"
    >
            ${Ze(t=>t.role===qr.menuitemcheckbox,O`
                    <div part="input-container" class="input-container">
                        <span part="checkbox" class="checkbox">
                            <slot name="checkbox-indicator">
                                ${e.checkboxIndicator||""}
                            </slot>
                        </span>
                    </div>
                `)}
            ${Ze(t=>t.role===qr.menuitemradio,O`
                    <div part="input-container" class="input-container">
                        <span part="radio" class="radio">
                            <slot name="radio-indicator">
                                ${e.radioIndicator||""}
                            </slot>
                        </span>
                    </div>
                `)}
        </div>
        ${Ct(r,e)}
        <span class="content" part="content">
            <slot></slot>
        </span>
        ${wt(r,e)}
        ${Ze(t=>t.hasSubmenu,O`
                <div
                    part="expand-collapse-glyph-container"
                    class="expand-collapse-glyph-container"
                >
                    <span part="expand-collapse" class="expand-collapse">
                        <slot name="expand-collapse-indicator">
                            ${e.expandCollapseGlyph||""}
                        </slot>
                    </span>
                </div>
            `)}
        ${Ze(t=>t.expanded,O`
                <${r.tagFor(Me)}
                    :anchorElement="${t=>t}"
                    vertical-positioning-mode="dynamic"
                    vertical-default-position="bottom"
                    vertical-inset="true"
                    horizontal-positioning-mode="dynamic"
                    horizontal-default-position="end"
                    class="submenu-region"
                    dir="${t=>t.currentDirection}"
                    @loaded="${t=>t.submenuLoaded()}"
                    ${Ee("submenuRegion")}
                    part="submenu-region"
                >
                    <slot name="submenu"></slot>
                </${r.tagFor(Me)}>
            `)}
    </template>
`});var y1=y(()=>{l();c();d();w5();v1()});var C5,x5=y(()=>{l();c();d();A();C5=(r,e)=>O`
    <template
        slot="${t=>t.slot?t.slot:t.isNestedMenu()?"submenu":void 0}"
        role="menu"
        @keydown="${(t,o)=>t.handleMenuKeyDown(o.event)}"
        @focusout="${(t,o)=>t.handleFocusOut(o.event)}"
    >
        <slot ${De("items")}></slot>
    </template>
`});var Nl,k5=y(()=>{l();c();d();Pe();A();we();y1();He();Nl=class r extends G{constructor(){super(...arguments),this.expandedItem=null,this.focusIndex=-1,this.isNestedMenu=()=>this.parentElement!==null&&Mn(this.parentElement)&&this.parentElement.getAttribute("role")==="menuitem",this.handleFocusOut=e=>{if(!this.contains(e.relatedTarget)&&this.menuItems!==void 0){this.collapseExpandedItem();let t=this.menuItems.findIndex(this.isFocusableElement);this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.menuItems[t].setAttribute("tabindex","0"),this.focusIndex=t}},this.handleItemFocus=e=>{let t=e.target;this.menuItems!==void 0&&t!==this.menuItems[this.focusIndex]&&(this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=this.menuItems.indexOf(t),t.setAttribute("tabindex","0"))},this.handleExpandedChanged=e=>{if(e.defaultPrevented||e.target===null||this.menuItems===void 0||this.menuItems.indexOf(e.target)<0)return;e.preventDefault();let t=e.target;if(this.expandedItem!==null&&t===this.expandedItem&&t.expanded===!1){this.expandedItem=null;return}t.expanded&&(this.expandedItem!==null&&this.expandedItem!==t&&(this.expandedItem.expanded=!1),this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.expandedItem=t,this.focusIndex=this.menuItems.indexOf(t),t.setAttribute("tabindex","0"))},this.removeItemListeners=()=>{this.menuItems!==void 0&&this.menuItems.forEach(e=>{e.removeEventListener("expanded-change",this.handleExpandedChanged),e.removeEventListener("focus",this.handleItemFocus)})},this.setItems=()=>{let e=this.domChildren();this.removeItemListeners(),this.menuItems=e;let t=this.menuItems.filter(this.isMenuItemElement);t.length&&(this.focusIndex=0);function o(n){let s=n.getAttribute("role"),a=n.querySelector("[slot=start]");return s!==qr.menuitem&&a===null||s===qr.menuitem&&a!==null?1:s!==qr.menuitem&&a!==null?2:0}let i=t.reduce((n,s)=>{let a=o(s);return n>a?n:a},0);t.forEach((n,s)=>{n.setAttribute("tabindex",s===0?"0":"-1"),n.addEventListener("expanded-change",this.handleExpandedChanged),n.addEventListener("focus",this.handleItemFocus),(n instanceof Gr||"startColumnCount"in n)&&(n.startColumnCount=i)})},this.changeHandler=e=>{if(this.menuItems===void 0)return;let t=e.target,o=this.menuItems.indexOf(t);if(o!==-1&&t.role==="menuitemradio"&&t.checked===!0){for(let n=o-1;n>=0;--n){let s=this.menuItems[n],a=s.getAttribute("role");if(a===qr.menuitemradio&&(s.checked=!1),a==="separator")break}let i=this.menuItems.length-1;for(let n=o+1;n<=i;++n){let s=this.menuItems[n],a=s.getAttribute("role");if(a===qr.menuitemradio&&(s.checked=!1),a==="separator")break}}},this.isMenuItemElement=e=>Mn(e)&&r.focusableElementRoles.hasOwnProperty(e.getAttribute("role")),this.isFocusableElement=e=>this.isMenuItemElement(e)}itemsChanged(e,t){this.$fastController.isConnected&&this.menuItems!==void 0&&this.setItems()}connectedCallback(){super.connectedCallback(),Y.queueUpdate(()=>{this.setItems()}),this.addEventListener("change",this.changeHandler)}disconnectedCallback(){super.disconnectedCallback(),this.removeItemListeners(),this.menuItems=void 0,this.removeEventListener("change",this.changeHandler)}focus(){this.setFocus(0,1)}collapseExpandedItem(){this.expandedItem!==null&&(this.expandedItem.expanded=!1,this.expandedItem=null)}handleMenuKeyDown(e){if(!(e.defaultPrevented||this.menuItems===void 0))switch(e.key){case Vt:this.setFocus(this.focusIndex+1,1);return;case qt:this.setFocus(this.focusIndex-1,-1);return;case Sr:this.setFocus(this.menuItems.length-1,-1);return;case kr:this.setFocus(0,1);return;default:return!0}}domChildren(){return Array.from(this.children).filter(e=>!e.hasAttribute("hidden"))}setFocus(e,t){if(this.menuItems!==void 0)for(;e>=0&&e<this.menuItems.length;){let o=this.menuItems[e];if(this.isFocusableElement(o)){this.focusIndex>-1&&this.menuItems.length>=this.focusIndex-1&&this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=e,o.setAttribute("tabindex","0"),o.focus();break}e+=t}}};Nl.focusableElementRoles=g1;w([I],Nl.prototype,"items",void 0)});var S5=y(()=>{l();c();d();x5();k5()});var _5,T5=y(()=>{l();c();d();A();$t();_5=(r,e)=>O`
    <template class="${t=>t.readOnly?"readonly":""}">
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${De("defaultSlottedNodes")}></slot>
        </label>
        <div class="root" part="root">
            ${Ct(r,e)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${t=>t.handleTextInput()}"
                @change="${t=>t.handleChange()}"
                @keydown="${(t,o)=>t.handleKeyDown(o.event)}"
                @blur="${(t,o)=>t.handleBlur()}"
                ?autofocus="${t=>t.autofocus}"
                ?disabled="${t=>t.disabled}"
                list="${t=>t.list}"
                maxlength="${t=>t.maxlength}"
                minlength="${t=>t.minlength}"
                placeholder="${t=>t.placeholder}"
                ?readonly="${t=>t.readOnly}"
                ?required="${t=>t.required}"
                size="${t=>t.size}"
                type="text"
                inputmode="numeric"
                min="${t=>t.min}"
                max="${t=>t.max}"
                step="${t=>t.step}"
                aria-atomic="${t=>t.ariaAtomic}"
                aria-busy="${t=>t.ariaBusy}"
                aria-controls="${t=>t.ariaControls}"
                aria-current="${t=>t.ariaCurrent}"
                aria-describedby="${t=>t.ariaDescribedby}"
                aria-details="${t=>t.ariaDetails}"
                aria-disabled="${t=>t.ariaDisabled}"
                aria-errormessage="${t=>t.ariaErrormessage}"
                aria-flowto="${t=>t.ariaFlowto}"
                aria-haspopup="${t=>t.ariaHaspopup}"
                aria-hidden="${t=>t.ariaHidden}"
                aria-invalid="${t=>t.ariaInvalid}"
                aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
                aria-label="${t=>t.ariaLabel}"
                aria-labelledby="${t=>t.ariaLabelledby}"
                aria-live="${t=>t.ariaLive}"
                aria-owns="${t=>t.ariaOwns}"
                aria-relevant="${t=>t.ariaRelevant}"
                aria-roledescription="${t=>t.ariaRoledescription}"
                ${Ee("control")}
            />
            ${Ze(t=>!t.hideStep&&!t.readOnly&&!t.disabled,O`
                    <div class="controls" part="controls">
                        <div class="step-up" part="step-up" @click="${t=>t.stepUp()}">
                            <slot name="step-up-glyph">
                                ${e.stepUpGlyph||""}
                            </slot>
                        </div>
                        <div
                            class="step-down"
                            part="step-down"
                            @click="${t=>t.stepDown()}"
                        >
                            <slot name="step-down-glyph">
                                ${e.stepDownGlyph||""}
                            </slot>
                        </div>
                    </div>
                `)}
            ${wt(r,e)}
        </div>
    </template>
`});var b1,Em,E5=y(()=>{l();c();d();Go();He();b1=class extends G{},Em=class extends Rr(b1){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var I5,A5=y(()=>{l();c();d();I5={email:"email",password:"password",tel:"tel",text:"text",url:"url"}});var ao,Sa,Im=y(()=>{l();c();d();Pe();A();Il();Vr();E5();A5();ao=class extends Em{constructor(){super(...arguments),this.type=I5.text}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}typeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type,this.validate())}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.validate(),this.autofocus&&Y.queueUpdate(()=>{this.focus()})}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.value=this.control.value}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}};w([k({attribute:"readonly",mode:"boolean"})],ao.prototype,"readOnly",void 0);w([k({mode:"boolean"})],ao.prototype,"autofocus",void 0);w([k],ao.prototype,"placeholder",void 0);w([k],ao.prototype,"type",void 0);w([k],ao.prototype,"list",void 0);w([k({converter:se})],ao.prototype,"maxlength",void 0);w([k({converter:se})],ao.prototype,"minlength",void 0);w([k],ao.prototype,"pattern",void 0);w([k({converter:se})],ao.prototype,"size",void 0);w([k({mode:"boolean"})],ao.prototype,"spellcheck",void 0);w([I],ao.prototype,"defaultSlottedNodes",void 0);Sa=class{};We(Sa,dt);We(ao,_t,Sa)});var w1,Am,R5=y(()=>{l();c();d();Go();He();w1=class extends G{},Am=class extends Rr(w1){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var jr,P5=y(()=>{l();c();d();Pe();A();we();$t();Vr();Im();R5();jr=class extends Am{constructor(){super(...arguments),this.hideStep=!1,this.step=1,this.isUserInput=!1}maxChanged(e,t){var o;this.max=Math.max(t,(o=this.min)!==null&&o!==void 0?o:t);let i=Math.min(this.min,this.max);this.min!==void 0&&this.min!==i&&(this.min=i),this.value=this.getValidValue(this.value)}minChanged(e,t){var o;this.min=Math.min(t,(o=this.max)!==null&&o!==void 0?o:t);let i=Math.max(this.min,this.max);this.max!==void 0&&this.max!==i&&(this.max=i),this.value=this.getValidValue(this.value)}get valueAsNumber(){return parseFloat(super.value)}set valueAsNumber(e){this.value=e.toString()}valueChanged(e,t){this.value=this.getValidValue(t),t===this.value&&(this.control&&!this.isUserInput&&(this.control.value=this.value),super.valueChanged(e,this.value),e!==void 0&&!this.isUserInput&&(this.$emit("input"),this.$emit("change")),this.isUserInput=!1)}validate(){super.validate(this.control)}getValidValue(e){var t,o;let i=parseFloat(parseFloat(e).toPrecision(12));return isNaN(i)?i="":(i=Math.min(i,(t=this.max)!==null&&t!==void 0?t:i),i=Math.max(i,(o=this.min)!==null&&o!==void 0?o:i).toString()),i}stepUp(){let e=parseFloat(this.value),t=isNaN(e)?this.min>0?this.min:this.max<0?this.max:this.min?0:this.step:e+this.step;this.value=t.toString()}stepDown(){let e=parseFloat(this.value),t=isNaN(e)?this.min>0?this.min:this.max<0?this.max:this.min?0:0-this.step:e-this.step;this.value=t.toString()}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type","number"),this.validate(),this.control.value=this.value,this.autofocus&&Y.queueUpdate(()=>{this.focus()})}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.control.value=this.control.value.replace(/[^0-9\-+e.]/g,""),this.isUserInput=!0,this.value=this.control.value}handleChange(){this.$emit("change")}handleKeyDown(e){switch(e.key){case qt:return this.stepUp(),!1;case Vt:return this.stepDown(),!1}return!0}handleBlur(){this.control.value=this.value}};w([k({attribute:"readonly",mode:"boolean"})],jr.prototype,"readOnly",void 0);w([k({mode:"boolean"})],jr.prototype,"autofocus",void 0);w([k({attribute:"hide-step",mode:"boolean"})],jr.prototype,"hideStep",void 0);w([k],jr.prototype,"placeholder",void 0);w([k],jr.prototype,"list",void 0);w([k({converter:se})],jr.prototype,"maxlength",void 0);w([k({converter:se})],jr.prototype,"minlength",void 0);w([k({converter:se})],jr.prototype,"size",void 0);w([k({converter:se})],jr.prototype,"step",void 0);w([k({converter:se})],jr.prototype,"max",void 0);w([k({converter:se})],jr.prototype,"min",void 0);w([I],jr.prototype,"defaultSlottedNodes",void 0);We(jr,_t,Sa)});var $5=y(()=>{l();c();d();T5();P5()});var O5,M5,F5=y(()=>{l();c();d();A();O5=44,M5=(r,e)=>O`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${Ze(t=>typeof t.value=="number",O`
                <svg
                    class="progress"
                    part="progress"
                    viewBox="0 0 16 16"
                    slot="determinate"
                >
                    <circle
                        class="background"
                        part="background"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                    <circle
                        class="determinate"
                        part="determinate"
                        style="stroke-dasharray: ${t=>O5*t.percentComplete/100}px ${O5}px"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                </svg>
            `,O`
                <slot name="indeterminate" slot="indeterminate">
                    ${e.indeterminateIndicator||""}
                </slot>
            `)}
    </template>
`});var D5=y(()=>{l();c();d();F5()});var nn,L5=y(()=>{l();c();d();Pe();A();He();nn=class extends G{constructor(){super(...arguments),this.percentComplete=0}valueChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}minChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}maxChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}connectedCallback(){super.connectedCallback(),this.updatePercentComplete()}updatePercentComplete(){let e=typeof this.min=="number"?this.min:0,t=typeof this.max=="number"?this.max:100,o=typeof this.value=="number"?this.value:0,i=t-e;this.percentComplete=i===0?0:Math.fround((o-e)/i*100)}};w([k({converter:se})],nn.prototype,"value",void 0);w([k({converter:se})],nn.prototype,"min",void 0);w([k({converter:se})],nn.prototype,"max",void 0);w([k({mode:"boolean"})],nn.prototype,"paused",void 0);w([I],nn.prototype,"percentComplete",void 0)});var N5,H5=y(()=>{l();c();d();A();N5=(r,e)=>O`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${Ze(t=>typeof t.value=="number",O`
                <div class="progress" part="progress" slot="determinate">
                    <div
                        class="determinate"
                        part="determinate"
                        style="width: ${t=>t.percentComplete}%"
                    ></div>
                </div>
            `,O`
                <div class="progress" part="progress" slot="indeterminate">
                    <slot class="indeterminate" name="indeterminate">
                        ${e.indeterminateIndicator1||""}
                        ${e.indeterminateIndicator2||""}
                    </slot>
                </div>
            `)}
    </template>
`});var U5=y(()=>{l();c();d();L5();H5()});var B5,z5=y(()=>{l();c();d();A();we();B5=(r,e)=>O`
    <template
        role="radiogroup"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @focusout="${(t,o)=>t.focusOutHandler(o.event)}"
    >
        <slot name="label"></slot>
        <div
            class="positioning-region ${t=>t.orientation===Tt.horizontal?"horizontal":"vertical"}"
            part="positioning-region"
        >
            <slot
                ${De({property:"slottedRadioButtons",filter:zr("[role=radio]")})}
            ></slot>
        </div>
    </template>
`});var sn,V5=y(()=>{l();c();d();Pe();A();we();va();He();sn=class extends G{constructor(){super(...arguments),this.orientation=Tt.horizontal,this.radioChangeHandler=e=>{let t=e.target;t.checked&&(this.slottedRadioButtons.forEach(o=>{o!==t&&(o.checked=!1,this.isInsideFoundationToolbar||o.setAttribute("tabindex","-1"))}),this.selectedRadio=t,this.value=t.value,t.setAttribute("tabindex","0"),this.focusedRadio=t),e.stopPropagation()},this.moveToRadioByIndex=(e,t)=>{let o=e[t];this.isInsideToolbar||(o.setAttribute("tabindex","0"),o.readOnly?this.slottedRadioButtons.forEach(i=>{i!==o&&i.setAttribute("tabindex","-1")}):(o.checked=!0,this.selectedRadio=o)),this.focusedRadio=o,o.focus()},this.moveRightOffGroup=()=>{var e;(e=this.nextElementSibling)===null||e===void 0||e.focus()},this.moveLeftOffGroup=()=>{var e;(e=this.previousElementSibling)===null||e===void 0||e.focus()},this.focusOutHandler=e=>{let t=this.slottedRadioButtons,o=e.target,i=o!==null?t.indexOf(o):0,n=this.focusedRadio?t.indexOf(this.focusedRadio):-1;return(n===0&&i===n||n===t.length-1&&n===i)&&(this.selectedRadio?(this.focusedRadio=this.selectedRadio,this.isInsideFoundationToolbar||(this.selectedRadio.setAttribute("tabindex","0"),t.forEach(s=>{s!==this.selectedRadio&&s.setAttribute("tabindex","-1")}))):(this.focusedRadio=t[0],this.focusedRadio.setAttribute("tabindex","0"),t.forEach(s=>{s!==this.focusedRadio&&s.setAttribute("tabindex","-1")}))),!0},this.clickHandler=e=>{let t=e.target;if(t){let o=this.slottedRadioButtons;t.checked||o.indexOf(t)===0?(t.setAttribute("tabindex","0"),this.selectedRadio=t):(t.setAttribute("tabindex","-1"),this.selectedRadio=null),this.focusedRadio=t}e.preventDefault()},this.shouldMoveOffGroupToTheRight=(e,t,o)=>e===t.length&&this.isInsideToolbar&&o===bo,this.shouldMoveOffGroupToTheLeft=(e,t)=>(this.focusedRadio?e.indexOf(this.focusedRadio)-1:0)<0&&this.isInsideToolbar&&t===yo,this.checkFocusedRadio=()=>{this.focusedRadio!==null&&!this.focusedRadio.readOnly&&!this.focusedRadio.checked&&(this.focusedRadio.checked=!0,this.focusedRadio.setAttribute("tabindex","0"),this.focusedRadio.focus(),this.selectedRadio=this.focusedRadio)},this.moveRight=e=>{let t=this.slottedRadioButtons,o=0;if(o=this.focusedRadio?t.indexOf(this.focusedRadio)+1:1,this.shouldMoveOffGroupToTheRight(o,t,e.key)){this.moveRightOffGroup();return}else o===t.length&&(o=0);for(;o<t.length&&t.length>1;)if(t[o].disabled){if(this.focusedRadio&&o===t.indexOf(this.focusedRadio))break;if(o+1>=t.length){if(this.isInsideToolbar)break;o=0}else o+=1}else{this.moveToRadioByIndex(t,o);break}},this.moveLeft=e=>{let t=this.slottedRadioButtons,o=0;if(o=this.focusedRadio?t.indexOf(this.focusedRadio)-1:0,o=o<0?t.length-1:o,this.shouldMoveOffGroupToTheLeft(t,e.key)){this.moveLeftOffGroup();return}for(;o>=0&&t.length>1;)if(t[o].disabled){if(this.focusedRadio&&o===t.indexOf(this.focusedRadio))break;o-1<0?o=t.length-1:o-=1}else{this.moveToRadioByIndex(t,o);break}},this.keydownHandler=e=>{let t=e.key;if(t in ma&&this.isInsideFoundationToolbar)return!0;switch(t){case sr:{this.checkFocusedRadio();break}case bo:case Vt:{this.direction===et.ltr?this.moveRight(e):this.moveLeft(e);break}case yo:case qt:{this.direction===et.ltr?this.moveLeft(e):this.moveRight(e);break}default:return!0}}}readOnlyChanged(){this.slottedRadioButtons!==void 0&&this.slottedRadioButtons.forEach(e=>{this.readOnly?e.readOnly=!0:e.readOnly=!1})}disabledChanged(){this.slottedRadioButtons!==void 0&&this.slottedRadioButtons.forEach(e=>{this.disabled?e.disabled=!0:e.disabled=!1})}nameChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach(e=>{e.setAttribute("name",this.name)})}valueChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach(e=>{e.value===this.value&&(e.checked=!0,this.selectedRadio=e)}),this.$emit("change")}slottedRadioButtonsChanged(e,t){this.slottedRadioButtons&&this.slottedRadioButtons.length>0&&this.setupRadioButtons()}get parentToolbar(){return this.closest('[role="toolbar"]')}get isInsideToolbar(){var e;return(e=this.parentToolbar)!==null&&e!==void 0?e:!1}get isInsideFoundationToolbar(){var e;return!!(!((e=this.parentToolbar)===null||e===void 0)&&e.$fastController)}connectedCallback(){super.connectedCallback(),this.direction=ui(this),this.setupRadioButtons()}disconnectedCallback(){this.slottedRadioButtons.forEach(e=>{e.removeEventListener("change",this.radioChangeHandler)})}setupRadioButtons(){let e=this.slottedRadioButtons.filter(i=>i.hasAttribute("checked")),t=e?e.length:0;if(t>1){let i=e[t-1];i.checked=!0}let o=!1;if(this.slottedRadioButtons.forEach(i=>{this.name!==void 0&&i.setAttribute("name",this.name),this.disabled&&(i.disabled=!0),this.readOnly&&(i.readOnly=!0),this.value&&this.value===i.value?(this.selectedRadio=i,this.focusedRadio=i,i.checked=!0,i.setAttribute("tabindex","0"),o=!0):(this.isInsideFoundationToolbar||i.setAttribute("tabindex","-1"),i.checked=!1),i.addEventListener("change",this.radioChangeHandler)}),this.value===void 0&&this.slottedRadioButtons.length>0){let i=this.slottedRadioButtons.filter(s=>s.hasAttribute("checked")),n=i!==null?i.length:0;if(n>0&&!o){let s=i[n-1];s.checked=!0,this.focusedRadio=s,s.setAttribute("tabindex","0")}else this.slottedRadioButtons[0].setAttribute("tabindex","0"),this.focusedRadio=this.slottedRadioButtons[0]}}};w([k({attribute:"readonly",mode:"boolean"})],sn.prototype,"readOnly",void 0);w([k({attribute:"disabled",mode:"boolean"})],sn.prototype,"disabled",void 0);w([k],sn.prototype,"name",void 0);w([k],sn.prototype,"value",void 0);w([k],sn.prototype,"orientation",void 0);w([I],sn.prototype,"childItems",void 0);w([I],sn.prototype,"slottedRadioButtons",void 0)});var q5=y(()=>{l();c();d();z5();V5()});var G5,j5=y(()=>{l();c();d();A();G5=(r,e)=>O`
    <template
        role="radio"
        class="${t=>t.checked?"checked":""} ${t=>t.readOnly?"readonly":""}"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${e.checkedIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${De("defaultSlottedNodes")}></slot>
        </label>
    </template>
`});var C1,Rm,K5=y(()=>{l();c();d();Go();He();C1=class extends G{},Rm=class extends Vc(C1){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Hl,W5=y(()=>{l();c();d();Pe();A();we();K5();Hl=class extends Rm{constructor(){super(),this.initialValue="on",this.keypressHandler=e=>{switch(e.key){case qo:!this.checked&&!this.readOnly&&(this.checked=!0);return}return!0},this.proxy.setAttribute("type","radio")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}defaultCheckedChanged(){var e;this.$fastController.isConnected&&!this.dirtyChecked&&(this.isInsideRadioGroup()||(this.checked=(e=this.defaultChecked)!==null&&e!==void 0?e:!1,this.dirtyChecked=!1))}connectedCallback(){var e,t;super.connectedCallback(),this.validate(),((e=this.parentElement)===null||e===void 0?void 0:e.getAttribute("role"))!=="radiogroup"&&this.getAttribute("tabindex")===null&&(this.disabled||this.setAttribute("tabindex","0")),this.checkedAttribute&&(this.dirtyChecked||this.isInsideRadioGroup()||(this.checked=(t=this.defaultChecked)!==null&&t!==void 0?t:!1,this.dirtyChecked=!1))}isInsideRadioGroup(){return this.closest("[role=radiogroup]")!==null}clickHandler(e){!this.disabled&&!this.readOnly&&!this.checked&&(this.checked=!0)}};w([k({attribute:"readonly",mode:"boolean"})],Hl.prototype,"readOnly",void 0);w([I],Hl.prototype,"name",void 0);w([I],Hl.prototype,"defaultSlottedNodes",void 0)});var Q5=y(()=>{l();c();d();j5();W5()});var _i,Y5=y(()=>{l();c();d();Pe();A();He();_i=class extends G{constructor(){super(...arguments),this.framesPerSecond=60,this.updatingItems=!1,this.speed=600,this.easing="ease-in-out",this.flippersHiddenFromAT=!1,this.scrolling=!1,this.resizeDetector=null}get frameTime(){return 1e3/this.framesPerSecond}scrollingChanged(e,t){if(this.scrollContainer){let o=this.scrolling==!0?"scrollstart":"scrollend";this.$emit(o,this.scrollContainer.scrollLeft)}}get isRtl(){return this.scrollItems.length>1&&this.scrollItems[0].offsetLeft>this.scrollItems[1].offsetLeft}connectedCallback(){super.connectedCallback(),this.initializeResizeDetector()}disconnectedCallback(){this.disconnectResizeDetector(),super.disconnectedCallback()}scrollItemsChanged(e,t){t&&!this.updatingItems&&Y.queueUpdate(()=>this.setStops())}disconnectResizeDetector(){this.resizeDetector&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.resized.bind(this)),this.resizeDetector.observe(this)}updateScrollStops(){this.updatingItems=!0;let e=this.scrollItems.reduce((t,o)=>o instanceof HTMLSlotElement?t.concat(o.assignedElements()):(t.push(o),t),[]);this.scrollItems=e,this.updatingItems=!1}setStops(){this.updateScrollStops();let{scrollContainer:e}=this,{scrollLeft:t}=e,{width:o,left:i}=e.getBoundingClientRect();this.width=o;let n=0,s=this.scrollItems.map((a,u)=>{let{left:h,width:p}=a.getBoundingClientRect(),f=Math.round(h+t-i),b=Math.round(f+p);return this.isRtl?-b:(n=b,u===0?0:f)}).concat(n);s=this.fixScrollMisalign(s),s.sort((a,u)=>Math.abs(a)-Math.abs(u)),this.scrollStops=s,this.setFlippers()}validateStops(e=!0){let t=()=>!!this.scrollStops.find(o=>o>0);return!t()&&e&&this.setStops(),t()}fixScrollMisalign(e){if(this.isRtl&&e.some(t=>t>0)){e.sort((o,i)=>i-o);let t=e[0];e=e.map(o=>o-t)}return e}setFlippers(){var e,t;let o=this.scrollContainer.scrollLeft;if((e=this.previousFlipperContainer)===null||e===void 0||e.classList.toggle("disabled",o===0),this.scrollStops){let i=Math.abs(this.scrollStops[this.scrollStops.length-1]);(t=this.nextFlipperContainer)===null||t===void 0||t.classList.toggle("disabled",this.validateStops(!1)&&Math.abs(o)+this.width>=i)}}scrollInView(e,t=0,o){var i;if(typeof e!="number"&&e&&(e=this.scrollItems.findIndex(n=>n===e||n.contains(e))),e!==void 0){o=o??t;let{scrollContainer:n,scrollStops:s,scrollItems:a}=this,{scrollLeft:u}=this.scrollContainer,{width:h}=n.getBoundingClientRect(),p=s[e],{width:f}=a[e].getBoundingClientRect(),b=p+f,C=u+t>p;if(C||u+h-o<b){let R=(i=[...s].sort((N,ye)=>C?ye-N:N-ye).find(N=>C?N+t<p:N+h-(o??0)>b))!==null&&i!==void 0?i:0;this.scrollToPosition(R)}}}keyupHandler(e){switch(e.key){case"ArrowLeft":this.scrollToPrevious();break;case"ArrowRight":this.scrollToNext();break}}scrollToPrevious(){this.validateStops();let e=this.scrollContainer.scrollLeft,t=this.scrollStops.findIndex((n,s)=>n>=e&&(this.isRtl||s===this.scrollStops.length-1||this.scrollStops[s+1]>e)),o=Math.abs(this.scrollStops[t+1]),i=this.scrollStops.findIndex(n=>Math.abs(n)+this.width>o);(i>=t||i===-1)&&(i=t>0?t-1:0),this.scrollToPosition(this.scrollStops[i],e)}scrollToNext(){this.validateStops();let e=this.scrollContainer.scrollLeft,t=this.scrollStops.findIndex(n=>Math.abs(n)>=Math.abs(e)),o=this.scrollStops.findIndex(n=>Math.abs(e)+this.width<=Math.abs(n)),i=t;o>t+2?i=o-2:t<this.scrollStops.length-2&&(i=t+1),this.scrollToPosition(this.scrollStops[i],e)}scrollToPosition(e,t=this.scrollContainer.scrollLeft){var o;if(this.scrolling)return;this.scrolling=!0;let i=(o=this.duration)!==null&&o!==void 0?o:`${Math.abs(e-t)/this.speed}s`;this.content.style.setProperty("transition-duration",i);let n=parseFloat(getComputedStyle(this.content).getPropertyValue("transition-duration")),s=h=>{h&&h.target!==h.currentTarget||(this.content.style.setProperty("transition-duration","0s"),this.content.style.removeProperty("transform"),this.scrollContainer.style.setProperty("scroll-behavior","auto"),this.scrollContainer.scrollLeft=e,this.setFlippers(),this.content.removeEventListener("transitionend",s),this.scrolling=!1)};if(n===0){s();return}this.content.addEventListener("transitionend",s);let a=this.scrollContainer.scrollWidth-this.scrollContainer.clientWidth,u=this.scrollContainer.scrollLeft-Math.min(e,a);this.isRtl&&(u=this.scrollContainer.scrollLeft+Math.min(Math.abs(e),a)),this.content.style.setProperty("transition-property","transform"),this.content.style.setProperty("transition-timing-function",this.easing),this.content.style.setProperty("transform",`translateX(${u}px)`)}resized(){this.resizeTimeout&&(this.resizeTimeout=clearTimeout(this.resizeTimeout)),this.resizeTimeout=setTimeout(()=>{this.width=this.scrollContainer.offsetWidth,this.setFlippers()},this.frameTime)}scrolled(){this.scrollTimeout&&(this.scrollTimeout=clearTimeout(this.scrollTimeout)),this.scrollTimeout=setTimeout(()=>{this.setFlippers()},this.frameTime)}};w([k({converter:se})],_i.prototype,"speed",void 0);w([k],_i.prototype,"duration",void 0);w([k],_i.prototype,"easing",void 0);w([k({attribute:"flippers-hidden-from-at",converter:Cs})],_i.prototype,"flippersHiddenFromAT",void 0);w([I],_i.prototype,"scrolling",void 0);w([I],_i.prototype,"scrollItems",void 0);w([k({attribute:"view"})],_i.prototype,"view",void 0)});var Z5,J5=y(()=>{l();c();d();A();$t();Z5=(r,e)=>{var t,o;return O`
    <template
        class="horizontal-scroll"
        @keyup="${(i,n)=>i.keyupHandler(n.event)}"
    >
        ${Ct(r,e)}
        <div class="scroll-area" part="scroll-area">
            <div
                class="scroll-view"
                part="scroll-view"
                @scroll="${i=>i.scrolled()}"
                ${Ee("scrollContainer")}
            >
                <div class="content-container" part="content-container" ${Ee("content")}>
                    <slot
                        ${De({property:"scrollItems",filter:zr()})}
                    ></slot>
                </div>
            </div>
            ${Ze(i=>i.view!=="mobile",O`
                    <div
                        class="scroll scroll-prev"
                        part="scroll-prev"
                        ${Ee("previousFlipperContainer")}
                    >
                        <div class="scroll-action" part="scroll-action-previous">
                            <slot name="previous-flipper">
                                ${e.previousFlipper instanceof Function?e.previousFlipper(r,e):(t=e.previousFlipper)!==null&&t!==void 0?t:""}
                            </slot>
                        </div>
                    </div>
                    <div
                        class="scroll scroll-next"
                        part="scroll-next"
                        ${Ee("nextFlipperContainer")}
                    >
                        <div class="scroll-action" part="scroll-action-next">
                            <slot name="next-flipper">
                                ${e.nextFlipper instanceof Function?e.nextFlipper(r,e):(o=e.nextFlipper)!==null&&o!==void 0?o:""}
                            </slot>
                        </div>
                    </div>
                `)}
        </div>
        ${wt(r,e)}
    </template>
`}});var X5=y(()=>{l();c();d();Y5();J5()});function th(r,e,t){return r.nodeType!==Node.TEXT_NODE?!0:typeof r.nodeValue=="string"&&!!r.nodeValue.trim().length}var Pm=y(()=>{l();c();d()});var eI=y(()=>{l();c();d();A();$t();Pm()});var x1,$m,tI=y(()=>{l();c();d();Go();He();x1=class extends G{},$m=class extends Rr(x1){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var wo,Om,rI=y(()=>{l();c();d();Pe();A();Il();Vr();tI();wo=class extends $m{readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.validate(),this.autofocus&&Y.queueUpdate(()=>{this.focus()})}validate(){super.validate(this.control)}handleTextInput(){this.value=this.control.value}handleClearInput(){this.value="",this.control.focus(),this.handleChange()}handleChange(){this.$emit("change")}};w([k({attribute:"readonly",mode:"boolean"})],wo.prototype,"readOnly",void 0);w([k({mode:"boolean"})],wo.prototype,"autofocus",void 0);w([k],wo.prototype,"placeholder",void 0);w([k],wo.prototype,"list",void 0);w([k({converter:se})],wo.prototype,"maxlength",void 0);w([k({converter:se})],wo.prototype,"minlength",void 0);w([k],wo.prototype,"pattern",void 0);w([k({converter:se})],wo.prototype,"size",void 0);w([k({mode:"boolean"})],wo.prototype,"spellcheck",void 0);w([I],wo.prototype,"defaultSlottedNodes",void 0);Om=class{};We(Om,dt);We(wo,_t,Om)});var oI=y(()=>{l();c();d();eI();rI()});var k1,Mm,iI=y(()=>{l();c();d();km();Go();k1=class extends Ts{},Mm=class extends Rr(k1){constructor(){super(...arguments),this.proxy=document.createElement("select")}}});var Ti,rh,nI=y(()=>{l();c();d();Pe();A();we();wa();$t();Vr();iI();mm();Ti=class extends Mm{constructor(){super(...arguments),this.open=!1,this.forcedPosition=!1,this.listboxId=di("listbox-"),this.maxHeight=0}openChanged(e,t){if(this.collapsible){if(this.open){this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),this.indexWhenOpened=this.selectedIndex,Y.queueUpdate(()=>this.focus());return}this.ariaControls="",this.ariaExpanded="false"}}get collapsible(){return!(this.multiple||typeof this.size=="number")}get value(){return pe.track(this,"value"),this._value}set value(e){var t,o,i,n,s,a,u;let h=`${this._value}`;if(!((t=this._options)===null||t===void 0)&&t.length){let p=this._options.findIndex(C=>C.value===e),f=(i=(o=this._options[this.selectedIndex])===null||o===void 0?void 0:o.value)!==null&&i!==void 0?i:null,b=(s=(n=this._options[p])===null||n===void 0?void 0:n.value)!==null&&s!==void 0?s:null;(p===-1||f!==b)&&(e="",this.selectedIndex=p),e=(u=(a=this.firstSelectedOption)===null||a===void 0?void 0:a.value)!==null&&u!==void 0?u:e}h!==e&&(this._value=e,super.valueChanged(h,e),pe.notify(this,"value"),this.updateDisplayValue())}updateValue(e){var t,o;this.$fastController.isConnected&&(this.value=(o=(t=this.firstSelectedOption)===null||t===void 0?void 0:t.value)!==null&&o!==void 0?o:""),e&&(this.$emit("input"),this.$emit("change",this,{bubbles:!0,composed:void 0}))}selectedIndexChanged(e,t){super.selectedIndexChanged(e,t),this.updateValue()}positionChanged(e,t){this.positionAttribute=t,this.setPositioning()}setPositioning(){let e=this.getBoundingClientRect(),o=window.innerHeight-e.bottom;this.position=this.forcedPosition?this.positionAttribute:e.top>o?Ca.above:Ca.below,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===Ca.above?~~e.top:~~o}get displayValue(){var e,t;return pe.track(this,"displayValue"),(t=(e=this.firstSelectedOption)===null||e===void 0?void 0:e.text)!==null&&t!==void 0?t:""}disabledChanged(e,t){super.disabledChanged&&super.disabledChanged(e,t),this.ariaDisabled=this.disabled?"true":"false"}formResetCallback(){this.setProxyOptions(),super.setDefaultSelectedOption(),this.selectedIndex===-1&&(this.selectedIndex=0)}clickHandler(e){if(!this.disabled){if(this.open){let t=e.target.closest("option,[role=option]");if(t&&t.disabled)return}return super.clickHandler(e),this.open=this.collapsible&&!this.open,!this.open&&this.indexWhenOpened!==this.selectedIndex&&this.updateValue(!0),!0}}focusoutHandler(e){var t;if(super.focusoutHandler(e),!this.open)return!0;let o=e.relatedTarget;if(this.isSameNode(o)){this.focus();return}!((t=this.options)===null||t===void 0)&&t.includes(o)||(this.open=!1,this.indexWhenOpened!==this.selectedIndex&&this.updateValue(!0))}handleChange(e,t){super.handleChange(e,t),t==="value"&&this.updateValue()}slottedOptionsChanged(e,t){this.options.forEach(o=>{pe.getNotifier(o).unsubscribe(this,"value")}),super.slottedOptionsChanged(e,t),this.options.forEach(o=>{pe.getNotifier(o).subscribe(this,"value")}),this.setProxyOptions(),this.updateValue()}mousedownHandler(e){var t;return e.offsetX>=0&&e.offsetX<=((t=this.listbox)===null||t===void 0?void 0:t.scrollWidth)?super.mousedownHandler(e):this.collapsible}multipleChanged(e,t){super.multipleChanged(e,t),this.proxy&&(this.proxy.multiple=t)}selectedOptionsChanged(e,t){var o;super.selectedOptionsChanged(e,t),(o=this.options)===null||o===void 0||o.forEach((i,n)=>{var s;let a=(s=this.proxy)===null||s===void 0?void 0:s.options.item(n);a&&(a.selected=i.selected)})}setDefaultSelectedOption(){var e;let t=(e=this.options)!==null&&e!==void 0?e:Array.from(this.children).filter(lr.slottedOptionFilter),o=t?.findIndex(i=>i.hasAttribute("selected")||i.selected||i.value===this.value);if(o!==-1){this.selectedIndex=o;return}this.selectedIndex=0}setProxyOptions(){this.proxy instanceof HTMLSelectElement&&this.options&&(this.proxy.options.length=0,this.options.forEach(e=>{let t=e.proxy||(e instanceof HTMLOptionElement?e.cloneNode():null);t&&this.proxy.options.add(t)}))}keydownHandler(e){super.keydownHandler(e);let t=e.key||e.key.charCodeAt(0);switch(t){case qo:{e.preventDefault(),this.collapsible&&this.typeAheadExpired&&(this.open=!this.open);break}case kr:case Sr:{e.preventDefault();break}case sr:{e.preventDefault(),this.open=!this.open;break}case Vo:{this.collapsible&&this.open&&(e.preventDefault(),this.open=!1);break}case fa:return this.collapsible&&this.open&&(e.preventDefault(),this.open=!1),!0}return!this.open&&this.indexWhenOpened!==this.selectedIndex&&(this.updateValue(!0),this.indexWhenOpened=this.selectedIndex),!(t===Vt||t===qt)}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.addEventListener("contentchange",this.updateDisplayValue)}disconnectedCallback(){this.removeEventListener("contentchange",this.updateDisplayValue),super.disconnectedCallback()}sizeChanged(e,t){super.sizeChanged(e,t),this.proxy&&(this.proxy.size=t)}updateDisplayValue(){this.collapsible&&pe.notify(this,"displayValue")}};w([k({attribute:"open",mode:"boolean"})],Ti.prototype,"open",void 0);w([oT],Ti.prototype,"collapsible",null);w([I],Ti.prototype,"control",void 0);w([k({attribute:"position"})],Ti.prototype,"positionAttribute",void 0);w([I],Ti.prototype,"position",void 0);w([I],Ti.prototype,"maxHeight",void 0);rh=class{};w([I],rh.prototype,"ariaControls",void 0);We(rh,ki);We(Ti,_t,rh)});var sI,aI=y(()=>{l();c();d();A();wa();$t();sI=(r,e)=>O`
    <template
        class="${t=>[t.collapsible&&"collapsible",t.collapsible&&t.open&&"open",t.disabled&&"disabled",t.collapsible&&t.position].filter(Boolean).join(" ")}"
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-controls="${t=>t.ariaControls}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-haspopup="${t=>t.collapsible?"listbox":null}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        ?open="${t=>t.open}"
        role="combobox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        ${Ze(t=>t.collapsible,O`
                <div
                    class="control"
                    part="control"
                    ?disabled="${t=>t.disabled}"
                    ${Ee("control")}
                >
                    ${Ct(r,e)}
                    <slot name="button-container">
                        <div class="selected-value" part="selected-value">
                            <slot name="selected-value">${t=>t.displayValue}</slot>
                        </div>
                        <div aria-hidden="true" class="indicator" part="indicator">
                            <slot name="indicator">
                                ${e.indicator||""}
                            </slot>
                        </div>
                    </slot>
                    ${wt(r,e)}
                </div>
            `)}
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>t.collapsible?!t.open:!1}"
            ${Ee("listbox")}
        >
            <slot
                ${De({filter:lr.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`});var lI=y(()=>{l();c();d();nI();mm();aI()});var cI,dI=y(()=>{l();c();d();A();cI=(r,e)=>O`
    <template
        class="${t=>t.shape==="circle"?"circle":"rect"}"
        pattern="${t=>t.pattern}"
        ?shimmer="${t=>t.shimmer}"
    >
        ${Ze(t=>t.shimmer===!0,O`
                <span class="shimmer"></span>
            `)}
        <object type="image/svg+xml" data="${t=>t.pattern}" role="presentation">
            <img class="pattern" src="${t=>t.pattern}" />
        </object>
        <slot></slot>
    </template>
`});var _a,uI=y(()=>{l();c();d();Pe();A();He();_a=class extends G{constructor(){super(...arguments),this.shape="rect"}};w([k],_a.prototype,"fill",void 0);w([k],_a.prototype,"shape",void 0);w([k],_a.prototype,"pattern",void 0);w([k({mode:"boolean"})],_a.prototype,"shimmer",void 0)});var hI=y(()=>{l();c();d();dI();uI()});var pI,fI=y(()=>{l();c();d();A();we();pI=(r,e)=>O`
    <template
        aria-disabled="${t=>t.disabled}"
        class="${t=>t.sliderOrientation||Tt.horizontal}
            ${t=>t.disabled?"disabled":""}"
    >
        <div ${Ee("root")} part="root" class="root" style="${t=>t.positionStyle}">
            <div class="container">
                ${Ze(t=>!t.hideMark,O`
                        <div class="mark"></div>
                    `)}
                <div class="label">
                    <slot></slot>
                </div>
            </div>
        </div>
    </template>
`});function oh(r,e,t,o){let i=ga(0,1,(r-e)/(t-e));return o===et.rtl&&(i=1-i),i}var S1=y(()=>{l();c();d();we()});var Fm,Ei,mI=y(()=>{l();c();d();Pe();A();we();S1();He();Fm={min:0,max:0,direction:et.ltr,orientation:Tt.horizontal,disabled:!1},Ei=class extends G{constructor(){super(...arguments),this.hideMark=!1,this.sliderDirection=et.ltr,this.getSliderConfiguration=()=>{if(!this.isSliderConfig(this.parentNode))this.sliderDirection=Fm.direction||et.ltr,this.sliderOrientation=Fm.orientation||Tt.horizontal,this.sliderMaxPosition=Fm.max,this.sliderMinPosition=Fm.min;else{let e=this.parentNode,{min:t,max:o,direction:i,orientation:n,disabled:s}=e;s!==void 0&&(this.disabled=s),this.sliderDirection=i||et.ltr,this.sliderOrientation=n||Tt.horizontal,this.sliderMaxPosition=o,this.sliderMinPosition=t}},this.positionAsStyle=()=>{let e=this.sliderDirection?this.sliderDirection:et.ltr,t=oh(Number(this.position),Number(this.sliderMinPosition),Number(this.sliderMaxPosition)),o=Math.round((1-t)*100),i=Math.round(t*100);return Number.isNaN(i)&&Number.isNaN(o)&&(o=50,i=50),this.sliderOrientation===Tt.horizontal?e===et.rtl?`right: ${i}%; left: ${o}%;`:`left: ${i}%; right: ${o}%;`:`top: ${i}%; bottom: ${o}%;`}}positionChanged(){this.positionStyle=this.positionAsStyle()}sliderOrientationChanged(){}connectedCallback(){super.connectedCallback(),this.getSliderConfiguration(),this.positionStyle=this.positionAsStyle(),this.notifier=pe.getNotifier(this.parentNode),this.notifier.subscribe(this,"orientation"),this.notifier.subscribe(this,"direction"),this.notifier.subscribe(this,"max"),this.notifier.subscribe(this,"min")}disconnectedCallback(){super.disconnectedCallback(),this.notifier.unsubscribe(this,"orientation"),this.notifier.unsubscribe(this,"direction"),this.notifier.unsubscribe(this,"max"),this.notifier.unsubscribe(this,"min")}handleChange(e,t){switch(t){case"direction":this.sliderDirection=e.direction;break;case"orientation":this.sliderOrientation=e.orientation;break;case"max":this.sliderMaxPosition=e.max;break;case"min":this.sliderMinPosition=e.min;break;default:break}this.positionStyle=this.positionAsStyle()}isSliderConfig(e){return e.max!==void 0&&e.min!==void 0}};w([I],Ei.prototype,"positionStyle",void 0);w([k],Ei.prototype,"position",void 0);w([k({attribute:"hide-mark",mode:"boolean"})],Ei.prototype,"hideMark",void 0);w([k({attribute:"disabled",mode:"boolean"})],Ei.prototype,"disabled",void 0);w([I],Ei.prototype,"sliderOrientation",void 0);w([I],Ei.prototype,"sliderMinPosition",void 0);w([I],Ei.prototype,"sliderMaxPosition",void 0);w([I],Ei.prototype,"sliderDirection",void 0)});var gI=y(()=>{l();c();d();fI();mI()});var vI,yI=y(()=>{l();c();d();A();we();vI=(r,e)=>O`
    <template
        role="slider"
        class="${t=>t.readOnly?"readonly":""}
        ${t=>t.orientation||Tt.horizontal}"
        tabindex="${t=>t.disabled?null:0}"
        aria-valuetext="${t=>t.valueTextFormatter(t.value)}"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        aria-disabled="${t=>t.disabled?!0:void 0}"
        aria-readonly="${t=>t.readOnly?!0:void 0}"
        aria-orientation="${t=>t.orientation}"
        class="${t=>t.orientation}"
    >
        <div part="positioning-region" class="positioning-region">
            <div ${Ee("track")} part="track-container" class="track">
                <slot name="track"></slot>
                <div part="track-start" class="track-start" style="${t=>t.position}">
                    <slot name="track-start"></slot>
                </div>
            </div>
            <slot></slot>
            <div
                ${Ee("thumb")}
                part="thumb-container"
                class="thumb-container"
                style="${t=>t.position}"
            >
                <slot name="thumb">${e.thumb||""}</slot>
            </div>
        </div>
    </template>
`});var _1,Dm,bI=y(()=>{l();c();d();Go();He();_1=class extends G{},Dm=class extends Rr(_1){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var jM,Pr,wI=y(()=>{l();c();d();Pe();A();we();va();S1();bI();jM={singleValue:"single-value"},Pr=class extends Dm{constructor(){super(...arguments),this.direction=et.ltr,this.isDragging=!1,this.trackWidth=0,this.trackMinWidth=0,this.trackHeight=0,this.trackLeft=0,this.trackMinHeight=0,this.valueTextFormatter=()=>null,this.min=0,this.max=10,this.step=1,this.orientation=Tt.horizontal,this.mode=jM.singleValue,this.keypressHandler=e=>{if(!this.readOnly){if(e.key===kr)e.preventDefault(),this.value=`${this.min}`;else if(e.key===Sr)e.preventDefault(),this.value=`${this.max}`;else if(!e.shiftKey)switch(e.key){case bo:case qt:e.preventDefault(),this.increment();break;case yo:case Vt:e.preventDefault(),this.decrement();break}}},this.setupTrackConstraints=()=>{let e=this.track.getBoundingClientRect();this.trackWidth=this.track.clientWidth,this.trackMinWidth=this.track.clientLeft,this.trackHeight=e.bottom,this.trackMinHeight=e.top,this.trackLeft=this.getBoundingClientRect().left,this.trackWidth===0&&(this.trackWidth=1)},this.setupListeners=(e=!1)=>{let t=`${e?"remove":"add"}EventListener`;this[t]("keydown",this.keypressHandler),this[t]("mousedown",this.handleMouseDown),this.thumb[t]("mousedown",this.handleThumbMouseDown,{passive:!0}),this.thumb[t]("touchstart",this.handleThumbMouseDown,{passive:!0}),e&&(this.handleMouseDown(null),this.handleThumbMouseDown(null))},this.initialValue="",this.handleThumbMouseDown=e=>{if(e){if(this.readOnly||this.disabled||e.defaultPrevented)return;e.target.focus()}let t=`${e!==null?"add":"remove"}EventListener`;window[t]("mouseup",this.handleWindowMouseUp),window[t]("mousemove",this.handleMouseMove,{passive:!0}),window[t]("touchmove",this.handleMouseMove,{passive:!0}),window[t]("touchend",this.handleWindowMouseUp),this.isDragging=e!==null},this.handleMouseMove=e=>{if(this.readOnly||this.disabled||e.defaultPrevented)return;let t=window.TouchEvent&&e instanceof TouchEvent?e.touches[0]:e,o=this.orientation===Tt.horizontal?t.pageX-document.documentElement.scrollLeft-this.trackLeft:t.pageY-document.documentElement.scrollTop;this.value=`${this.calculateNewValue(o)}`},this.calculateNewValue=e=>{let t=oh(e,this.orientation===Tt.horizontal?this.trackMinWidth:this.trackMinHeight,this.orientation===Tt.horizontal?this.trackWidth:this.trackHeight,this.direction),o=(this.max-this.min)*t+this.min;return this.convertToConstrainedValue(o)},this.handleWindowMouseUp=e=>{this.stopDragging()},this.stopDragging=()=>{this.isDragging=!1,this.handleMouseDown(null),this.handleThumbMouseDown(null)},this.handleMouseDown=e=>{let t=`${e!==null?"add":"remove"}EventListener`;if((e===null||!this.disabled&&!this.readOnly)&&(window[t]("mouseup",this.handleWindowMouseUp),window.document[t]("mouseleave",this.handleWindowMouseUp),window[t]("mousemove",this.handleMouseMove),e)){e.preventDefault(),this.setupTrackConstraints(),e.target.focus();let o=this.orientation===Tt.horizontal?e.pageX-document.documentElement.scrollLeft-this.trackLeft:e.pageY-document.documentElement.scrollTop;this.value=`${this.calculateNewValue(o)}`}},this.convertToConstrainedValue=e=>{isNaN(e)&&(e=this.min);let t=e-this.min,o=Math.round(t/this.step),i=t-o*(this.stepMultiplier*this.step)/this.stepMultiplier;return t=i>=Number(this.step)/2?t-i+Number(this.step):t-i,t+this.min}}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}get valueAsNumber(){return parseFloat(super.value)}set valueAsNumber(e){this.value=e.toString()}valueChanged(e,t){super.valueChanged(e,t),this.$fastController.isConnected&&this.setThumbPositionForOrientation(this.direction),this.$emit("change")}minChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.min=`${this.min}`),this.validate()}maxChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.max=`${this.max}`),this.validate()}stepChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.step=`${this.step}`),this.updateStepMultiplier(),this.validate()}orientationChanged(){this.$fastController.isConnected&&this.setThumbPositionForOrientation(this.direction)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type","range"),this.direction=ui(this),this.updateStepMultiplier(),this.setupTrackConstraints(),this.setupListeners(),this.setupDefaultValue(),this.setThumbPositionForOrientation(this.direction)}disconnectedCallback(){this.setupListeners(!0)}increment(){let e=this.direction!==et.rtl&&this.orientation!==Tt.vertical?Number(this.value)+Number(this.step):Number(this.value)-Number(this.step),t=this.convertToConstrainedValue(e),o=t<Number(this.max)?`${t}`:`${this.max}`;this.value=o}decrement(){let e=this.direction!==et.rtl&&this.orientation!==Tt.vertical?Number(this.value)-Number(this.step):Number(this.value)+Number(this.step),t=this.convertToConstrainedValue(e),o=t>Number(this.min)?`${t}`:`${this.min}`;this.value=o}setThumbPositionForOrientation(e){let o=(1-oh(Number(this.value),Number(this.min),Number(this.max),e))*100;this.orientation===Tt.horizontal?this.position=this.isDragging?`right: ${o}%; transition: none;`:`right: ${o}%; transition: all 0.2s ease;`:this.position=this.isDragging?`bottom: ${o}%; transition: none;`:`bottom: ${o}%; transition: all 0.2s ease;`}updateStepMultiplier(){let e=this.step+"",t=this.step%1?e.length-e.indexOf(".")-1:0;this.stepMultiplier=Math.pow(10,t)}get midpoint(){return`${this.convertToConstrainedValue((this.max+this.min)/2)}`}setupDefaultValue(){if(typeof this.value=="string")if(this.value.length===0)this.initialValue=this.midpoint;else{let e=parseFloat(this.value);!Number.isNaN(e)&&(e<this.min||e>this.max)&&(this.value=this.midpoint)}}};w([k({attribute:"readonly",mode:"boolean"})],Pr.prototype,"readOnly",void 0);w([I],Pr.prototype,"direction",void 0);w([I],Pr.prototype,"isDragging",void 0);w([I],Pr.prototype,"position",void 0);w([I],Pr.prototype,"trackWidth",void 0);w([I],Pr.prototype,"trackMinWidth",void 0);w([I],Pr.prototype,"trackHeight",void 0);w([I],Pr.prototype,"trackLeft",void 0);w([I],Pr.prototype,"trackMinHeight",void 0);w([I],Pr.prototype,"valueTextFormatter",void 0);w([k({converter:se})],Pr.prototype,"min",void 0);w([k({converter:se})],Pr.prototype,"max",void 0);w([k({converter:se})],Pr.prototype,"step",void 0);w([k],Pr.prototype,"orientation",void 0);w([k],Pr.prototype,"mode",void 0)});var CI=y(()=>{l();c();d();yI();wI()});var xI,kI=y(()=>{l();c();d();A();xI=(r,e)=>O`
    <template
        role="switch"
        aria-checked="${t=>t.checked}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.checked?"checked":""}"
    >
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${De("defaultSlottedNodes")}></slot>
        </label>
        <div part="switch" class="switch">
            <slot name="switch">${e.switch||""}</slot>
        </div>
        <span class="status-message" part="status-message">
            <span class="checked-message" part="checked-message">
                <slot name="checked-message"></slot>
            </span>
            <span class="unchecked-message" part="unchecked-message">
                <slot name="unchecked-message"></slot>
            </span>
        </span>
    </template>
`});var T1,Lm,SI=y(()=>{l();c();d();Go();He();T1=class extends G{},Lm=class extends Vc(T1){constructor(){super(...arguments),this.proxy=document.createElement("input")}}});var Kc,_I=y(()=>{l();c();d();Pe();A();we();SI();Kc=class extends Lm{constructor(){super(),this.initialValue="on",this.keypressHandler=e=>{if(!this.readOnly)switch(e.key){case sr:case qo:this.checked=!this.checked;break}},this.clickHandler=e=>{!this.disabled&&!this.readOnly&&(this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly),this.readOnly?this.classList.add("readonly"):this.classList.remove("readonly")}checkedChanged(e,t){super.checkedChanged(e,t),this.checked?this.classList.add("checked"):this.classList.remove("checked")}};w([k({attribute:"readonly",mode:"boolean"})],Kc.prototype,"readOnly",void 0);w([I],Kc.prototype,"defaultSlottedNodes",void 0)});var TI=y(()=>{l();c();d();kI();_I()});var EI,II=y(()=>{l();c();d();A();EI=(r,e)=>O`
    <template slot="tabpanel" role="tabpanel">
        <slot></slot>
    </template>
`});var Nm,AI=y(()=>{l();c();d();He();Nm=class extends G{}});var RI=y(()=>{l();c();d();II();AI()});var PI,$I=y(()=>{l();c();d();A();PI=(r,e)=>O`
    <template slot="tab" role="tab" aria-disabled="${t=>t.disabled}">
        <slot></slot>
    </template>
`});var ih,OI=y(()=>{l();c();d();Pe();A();He();ih=class extends G{};w([k({mode:"boolean"})],ih.prototype,"disabled",void 0)});var MI=y(()=>{l();c();d();$I();OI()});var FI,DI=y(()=>{l();c();d();A();$t();FI=(r,e)=>O`
    <template class="${t=>t.orientation}">
        ${Ct(r,e)}
        <div class="tablist" part="tablist" role="tablist">
            <slot class="tab" name="tab" part="tab" ${De("tabs")}></slot>

            ${Ze(t=>t.showActiveIndicator,O`
                    <div
                        ${Ee("activeIndicatorRef")}
                        class="activeIndicator"
                        part="activeIndicator"
                    ></div>
                `)}
        </div>
        ${wt(r,e)}
        <div class="tabpanel" part="tabpanel">
            <slot name="tabpanel" ${De("tabpanels")}></slot>
        </div>
    </template>
`});var LI,Ii,NI=y(()=>{l();c();d();Pe();A();we();$t();Vr();He();LI={vertical:"vertical",horizontal:"horizontal"},Ii=class extends G{constructor(){super(...arguments),this.orientation=LI.horizontal,this.activeindicator=!0,this.showActiveIndicator=!0,this.prevActiveTabIndex=0,this.activeTabIndex=0,this.ticking=!1,this.change=()=>{this.$emit("change",this.activetab)},this.isDisabledElement=e=>e.getAttribute("aria-disabled")==="true",this.isHiddenElement=e=>e.hasAttribute("hidden"),this.isFocusableElement=e=>!this.isDisabledElement(e)&&!this.isHiddenElement(e),this.setTabs=()=>{let e="gridColumn",t="gridRow",o=this.isHorizontal()?e:t;this.activeTabIndex=this.getActiveIndex(),this.showActiveIndicator=!1,this.tabs.forEach((i,n)=>{if(i.slot==="tab"){let s=this.activeTabIndex===n&&this.isFocusableElement(i);this.activeindicator&&this.isFocusableElement(i)&&(this.showActiveIndicator=!0);let a=this.tabIds[n],u=this.tabpanelIds[n];i.setAttribute("id",a),i.setAttribute("aria-selected",s?"true":"false"),i.setAttribute("aria-controls",u),i.addEventListener("click",this.handleTabClick),i.addEventListener("keydown",this.handleTabKeyDown),i.setAttribute("tabindex",s?"0":"-1"),s&&(this.activetab=i,this.activeid=a)}i.style[e]="",i.style[t]="",i.style[o]=`${n+1}`,this.isHorizontal()?i.classList.remove("vertical"):i.classList.add("vertical")})},this.setTabPanels=()=>{this.tabpanels.forEach((e,t)=>{let o=this.tabIds[t],i=this.tabpanelIds[t];e.setAttribute("id",i),e.setAttribute("aria-labelledby",o),this.activeTabIndex!==t?e.setAttribute("hidden",""):e.removeAttribute("hidden")})},this.handleTabClick=e=>{let t=e.currentTarget;t.nodeType===1&&this.isFocusableElement(t)&&(this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=this.tabs.indexOf(t),this.setComponent())},this.handleTabKeyDown=e=>{if(this.isHorizontal())switch(e.key){case yo:e.preventDefault(),this.adjustBackward(e);break;case bo:e.preventDefault(),this.adjustForward(e);break}else switch(e.key){case qt:e.preventDefault(),this.adjustBackward(e);break;case Vt:e.preventDefault(),this.adjustForward(e);break}switch(e.key){case kr:e.preventDefault(),this.adjust(-this.activeTabIndex);break;case Sr:e.preventDefault(),this.adjust(this.tabs.length-this.activeTabIndex-1);break}},this.adjustForward=e=>{let t=this.tabs,o=0;for(o=this.activetab?t.indexOf(this.activetab)+1:1,o===t.length&&(o=0);o<t.length&&t.length>1;)if(this.isFocusableElement(t[o])){this.moveToTabByIndex(t,o);break}else{if(this.activetab&&o===t.indexOf(this.activetab))break;o+1>=t.length?o=0:o+=1}},this.adjustBackward=e=>{let t=this.tabs,o=0;for(o=this.activetab?t.indexOf(this.activetab)-1:0,o=o<0?t.length-1:o;o>=0&&t.length>1;)if(this.isFocusableElement(t[o])){this.moveToTabByIndex(t,o);break}else o-1<0?o=t.length-1:o-=1},this.moveToTabByIndex=(e,t)=>{let o=e[t];this.activetab=o,this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=t,o.focus(),this.setComponent()}}orientationChanged(){this.$fastController.isConnected&&(this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}activeidChanged(e,t){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.prevActiveTabIndex=this.tabs.findIndex(o=>o.id===e),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabsChanged(){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabpanelsChanged(){this.$fastController.isConnected&&this.tabpanels.length<=this.tabs.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}getActiveIndex(){return this.activeid!==void 0?this.tabIds.indexOf(this.activeid)===-1?0:this.tabIds.indexOf(this.activeid):0}getTabIds(){return this.tabs.map(e=>{var t;return(t=e.getAttribute("id"))!==null&&t!==void 0?t:`tab-${di()}`})}getTabPanelIds(){return this.tabpanels.map(e=>{var t;return(t=e.getAttribute("id"))!==null&&t!==void 0?t:`panel-${di()}`})}setComponent(){this.activeTabIndex!==this.prevActiveTabIndex&&(this.activeid=this.tabIds[this.activeTabIndex],this.focusTab(),this.change())}isHorizontal(){return this.orientation===LI.horizontal}handleActiveIndicatorPosition(){this.showActiveIndicator&&this.activeindicator&&this.activeTabIndex!==this.prevActiveTabIndex&&(this.ticking?this.ticking=!1:(this.ticking=!0,this.animateActiveIndicator()))}animateActiveIndicator(){this.ticking=!0;let e=this.isHorizontal()?"gridColumn":"gridRow",t=this.isHorizontal()?"translateX":"translateY",o=this.isHorizontal()?"offsetLeft":"offsetTop",i=this.activeIndicatorRef[o];this.activeIndicatorRef.style[e]=`${this.activeTabIndex+1}`;let n=this.activeIndicatorRef[o];this.activeIndicatorRef.style[e]=`${this.prevActiveTabIndex+1}`;let s=n-i;this.activeIndicatorRef.style.transform=`${t}(${s}px)`,this.activeIndicatorRef.classList.add("activeIndicatorTransition"),this.activeIndicatorRef.addEventListener("transitionend",()=>{this.ticking=!1,this.activeIndicatorRef.style[e]=`${this.activeTabIndex+1}`,this.activeIndicatorRef.style.transform=`${t}(0px)`,this.activeIndicatorRef.classList.remove("activeIndicatorTransition")})}adjust(e){let t=this.tabs.filter(s=>this.isFocusableElement(s)),o=t.indexOf(this.activetab),i=ga(0,t.length-1,o+e),n=this.tabs.indexOf(t[i]);n>-1&&this.moveToTabByIndex(this.tabs,n)}focusTab(){this.tabs[this.activeTabIndex].focus()}connectedCallback(){super.connectedCallback(),this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.activeTabIndex=this.getActiveIndex()}};w([k],Ii.prototype,"orientation",void 0);w([k],Ii.prototype,"activeid",void 0);w([I],Ii.prototype,"tabs",void 0);w([I],Ii.prototype,"tabpanels",void 0);w([k({mode:"boolean"})],Ii.prototype,"activeindicator",void 0);w([I],Ii.prototype,"activeIndicatorRef",void 0);w([I],Ii.prototype,"showActiveIndicator",void 0);We(Ii,_t)});var HI=y(()=>{l();c();d();DI();NI()});var E1,Hm,UI=y(()=>{l();c();d();Go();He();E1=class extends G{},Hm=class extends Rr(E1){constructor(){super(...arguments),this.proxy=document.createElement("textarea")}}});var Um,BI=y(()=>{l();c();d();Um={none:"none",both:"both",horizontal:"horizontal",vertical:"vertical"}});var $r,I1=y(()=>{l();c();d();Pe();A();Im();Vr();UI();BI();$r=class extends Hm{constructor(){super(...arguments),this.resize=Um.none,this.cols=20,this.handleTextInput=()=>{this.value=this.control.value}}readOnlyChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.readOnly=this.readOnly)}autofocusChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.autofocus=this.autofocus)}listChanged(){this.proxy instanceof HTMLTextAreaElement&&this.proxy.setAttribute("list",this.list)}maxlengthChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.maxLength=this.maxlength)}minlengthChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.minLength=this.minlength)}spellcheckChanged(){this.proxy instanceof HTMLTextAreaElement&&(this.proxy.spellcheck=this.spellcheck)}select(){this.control.select(),this.$emit("select")}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}};w([k({mode:"boolean"})],$r.prototype,"readOnly",void 0);w([k],$r.prototype,"resize",void 0);w([k({mode:"boolean"})],$r.prototype,"autofocus",void 0);w([k({attribute:"form"})],$r.prototype,"formId",void 0);w([k],$r.prototype,"list",void 0);w([k({converter:se})],$r.prototype,"maxlength",void 0);w([k({converter:se})],$r.prototype,"minlength",void 0);w([k],$r.prototype,"name",void 0);w([k],$r.prototype,"placeholder",void 0);w([k({converter:se,mode:"fromView"})],$r.prototype,"cols",void 0);w([k({converter:se,mode:"fromView"})],$r.prototype,"rows",void 0);w([k({mode:"boolean"})],$r.prototype,"spellcheck",void 0);w([I],$r.prototype,"defaultSlottedNodes",void 0);We($r,Sa)});var zI,VI=y(()=>{l();c();d();A();I1();zI=(r,e)=>O`
    <template
        class="
            ${t=>t.readOnly?"readonly":""}
            ${t=>t.resize!==Um.none?`resize-${t.resize}`:""}"
    >
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${De("defaultSlottedNodes")}></slot>
        </label>
        <textarea
            part="control"
            class="control"
            id="control"
            ?autofocus="${t=>t.autofocus}"
            cols="${t=>t.cols}"
            ?disabled="${t=>t.disabled}"
            form="${t=>t.form}"
            list="${t=>t.list}"
            maxlength="${t=>t.maxlength}"
            minlength="${t=>t.minlength}"
            name="${t=>t.name}"
            placeholder="${t=>t.placeholder}"
            ?readonly="${t=>t.readOnly}"
            ?required="${t=>t.required}"
            rows="${t=>t.rows}"
            ?spellcheck="${t=>t.spellcheck}"
            :value="${t=>t.value}"
            aria-atomic="${t=>t.ariaAtomic}"
            aria-busy="${t=>t.ariaBusy}"
            aria-controls="${t=>t.ariaControls}"
            aria-current="${t=>t.ariaCurrent}"
            aria-describedby="${t=>t.ariaDescribedby}"
            aria-details="${t=>t.ariaDetails}"
            aria-disabled="${t=>t.ariaDisabled}"
            aria-errormessage="${t=>t.ariaErrormessage}"
            aria-flowto="${t=>t.ariaFlowto}"
            aria-haspopup="${t=>t.ariaHaspopup}"
            aria-hidden="${t=>t.ariaHidden}"
            aria-invalid="${t=>t.ariaInvalid}"
            aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
            aria-label="${t=>t.ariaLabel}"
            aria-labelledby="${t=>t.ariaLabelledby}"
            aria-live="${t=>t.ariaLive}"
            aria-owns="${t=>t.ariaOwns}"
            aria-relevant="${t=>t.ariaRelevant}"
            aria-roledescription="${t=>t.ariaRoledescription}"
            @input="${(t,o)=>t.handleTextInput()}"
            @change="${t=>t.handleChange()}"
            ${Ee("control")}
        ></textarea>
    </template>
`});var qI=y(()=>{l();c();d();VI();I1()});var GI,jI=y(()=>{l();c();d();A();$t();Pm();GI=(r,e)=>O`
    <template
        class="
            ${t=>t.readOnly?"readonly":""}
        "
    >
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot
                ${De({property:"defaultSlottedNodes",filter:th})}
            ></slot>
        </label>
        <div class="root" part="root">
            ${Ct(r,e)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${t=>t.handleTextInput()}"
                @change="${t=>t.handleChange()}"
                ?autofocus="${t=>t.autofocus}"
                ?disabled="${t=>t.disabled}"
                list="${t=>t.list}"
                maxlength="${t=>t.maxlength}"
                minlength="${t=>t.minlength}"
                pattern="${t=>t.pattern}"
                placeholder="${t=>t.placeholder}"
                ?readonly="${t=>t.readOnly}"
                ?required="${t=>t.required}"
                size="${t=>t.size}"
                ?spellcheck="${t=>t.spellcheck}"
                :value="${t=>t.value}"
                type="${t=>t.type}"
                aria-atomic="${t=>t.ariaAtomic}"
                aria-busy="${t=>t.ariaBusy}"
                aria-controls="${t=>t.ariaControls}"
                aria-current="${t=>t.ariaCurrent}"
                aria-describedby="${t=>t.ariaDescribedby}"
                aria-details="${t=>t.ariaDetails}"
                aria-disabled="${t=>t.ariaDisabled}"
                aria-errormessage="${t=>t.ariaErrormessage}"
                aria-flowto="${t=>t.ariaFlowto}"
                aria-haspopup="${t=>t.ariaHaspopup}"
                aria-hidden="${t=>t.ariaHidden}"
                aria-invalid="${t=>t.ariaInvalid}"
                aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
                aria-label="${t=>t.ariaLabel}"
                aria-labelledby="${t=>t.ariaLabelledby}"
                aria-live="${t=>t.ariaLive}"
                aria-owns="${t=>t.ariaOwns}"
                aria-relevant="${t=>t.ariaRelevant}"
                aria-roledescription="${t=>t.ariaRoledescription}"
                ${Ee("control")}
            />
            ${wt(r,e)}
        </div>
    </template>
`});var KI=y(()=>{l();c();d();jI();Im()});var WI,QI=y(()=>{l();c();d();A();$t();WI=(r,e)=>O`
    <template
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-orientation="${t=>t.orientation}"
        orientation="${t=>t.orientation}"
        role="toolbar"
        @mousedown="${(t,o)=>t.mouseDownHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        ${pa({property:"childItems",attributeFilter:["disabled","hidden"],filter:zr(),subtree:!0})}
    >
        <slot name="label"></slot>
        <div class="positioning-region" part="positioning-region">
            ${Ct(r,e)}
            <slot
                ${De({filter:zr(),property:"slottedItems"})}
            ></slot>
            ${wt(r,e)}
        </div>
    </template>
`});function YI(r){let e=r.getRootNode();return e instanceof ShadowRoot?e.activeElement:document.activeElement}var ZI=y(()=>{l();c();d()});var JI,an,Wc,XI=y(()=>{l();c();d();Pe();A();we();u1();He();Vu();$t();Vr();va();ZI();JI=Object.freeze({[ma.ArrowUp]:{[Tt.vertical]:-1},[ma.ArrowDown]:{[Tt.vertical]:1},[ma.ArrowLeft]:{[Tt.horizontal]:{[et.ltr]:-1,[et.rtl]:1}},[ma.ArrowRight]:{[Tt.horizontal]:{[et.ltr]:1,[et.rtl]:-1}}}),an=class r extends G{constructor(){super(...arguments),this._activeIndex=0,this.direction=et.ltr,this.orientation=Tt.horizontal}get activeIndex(){return pe.track(this,"activeIndex"),this._activeIndex}set activeIndex(e){this.$fastController.isConnected&&(this._activeIndex=ga(0,this.focusableElements.length-1,e),pe.notify(this,"activeIndex"))}slottedItemsChanged(){this.$fastController.isConnected&&this.reduceFocusableElements()}mouseDownHandler(e){var t;let o=(t=this.focusableElements)===null||t===void 0?void 0:t.findIndex(i=>i.contains(e.target));return o>-1&&this.activeIndex!==o&&this.setFocusedElement(o),!0}childItemsChanged(e,t){this.$fastController.isConnected&&this.reduceFocusableElements()}connectedCallback(){super.connectedCallback(),this.direction=ui(this)}focusinHandler(e){let t=e.relatedTarget;!t||this.contains(t)||this.setFocusedElement()}getDirectionalIncrementer(e){var t,o,i,n,s;return(s=(i=(o=(t=JI[e])===null||t===void 0?void 0:t[this.orientation])===null||o===void 0?void 0:o[this.direction])!==null&&i!==void 0?i:(n=JI[e])===null||n===void 0?void 0:n[this.orientation])!==null&&s!==void 0?s:0}keydownHandler(e){let t=e.key;if(!(t in ma)||e.defaultPrevented||e.shiftKey)return!0;let o=this.getDirectionalIncrementer(t);if(!o)return!e.target.closest("[role=radiogroup]");let i=this.activeIndex+o;return this.focusableElements[i]&&e.preventDefault(),this.setFocusedElement(i),!0}get allSlottedItems(){return[...this.start.assignedElements(),...this.slottedItems,...this.end.assignedElements()]}reduceFocusableElements(){var e;let t=(e=this.focusableElements)===null||e===void 0?void 0:e[this.activeIndex];this.focusableElements=this.allSlottedItems.reduce(r.reduceFocusableItems,[]);let o=this.focusableElements.indexOf(t);this.activeIndex=Math.max(0,o),this.setFocusableElements()}setFocusedElement(e=this.activeIndex){this.activeIndex=e,this.setFocusableElements(),this.focusableElements[this.activeIndex]&&this.contains(YI(this))&&this.focusableElements[this.activeIndex].focus()}static reduceFocusableItems(e,t){var o,i,n,s;let a=t.getAttribute("role")==="radio",u=(i=(o=t.$fastController)===null||o===void 0?void 0:o.definition.shadowOptions)===null||i===void 0?void 0:i.delegatesFocus,h=Array.from((s=(n=t.shadowRoot)===null||n===void 0?void 0:n.querySelectorAll("*"))!==null&&s!==void 0?s:[]).some(p=>d1(p));return!t.hasAttribute("disabled")&&!t.hasAttribute("hidden")&&(d1(t)||a||u||h)?(e.push(t),e):t.childElementCount?e.concat(Array.from(t.children).reduce(r.reduceFocusableItems,[])):e}setFocusableElements(){this.$fastController.isConnected&&this.focusableElements.length>0&&this.focusableElements.forEach((e,t)=>{e.tabIndex=this.activeIndex===t?0:-1})}};w([I],an.prototype,"direction",void 0);w([k],an.prototype,"orientation",void 0);w([I],an.prototype,"slottedItems",void 0);w([I],an.prototype,"slottedLabel",void 0);w([I],an.prototype,"childItems",void 0);Wc=class{};w([k({attribute:"aria-labelledby"})],Wc.prototype,"ariaLabelledby",void 0);w([k({attribute:"aria-label"})],Wc.prototype,"ariaLabel",void 0);We(Wc,dt);We(an,_t,Wc)});var eA=y(()=>{l();c();d();QI();XI()});var tA,rA=y(()=>{l();c();d();A();qu();tA=(r,e)=>O`
        ${Ze(t=>t.tooltipVisible,O`
            <${r.tagFor(Me)}
                fixed-placement="true"
                auto-update-mode="${t=>t.autoUpdateMode}"
                vertical-positioning-mode="${t=>t.verticalPositioningMode}"
                vertical-default-position="${t=>t.verticalDefaultPosition}"
                vertical-inset="${t=>t.verticalInset}"
                vertical-scaling="${t=>t.verticalScaling}"
                horizontal-positioning-mode="${t=>t.horizontalPositioningMode}"
                horizontal-default-position="${t=>t.horizontalDefaultPosition}"
                horizontal-scaling="${t=>t.horizontalScaling}"
                horizontal-inset="${t=>t.horizontalInset}"
                vertical-viewport-lock="${t=>t.horizontalViewportLock}"
                horizontal-viewport-lock="${t=>t.verticalViewportLock}"
                dir="${t=>t.currentDirection}"
                ${Ee("region")}
            >
                <div class="tooltip" part="tooltip" role="tooltip">
                    <slot></slot>
                </div>
            </${r.tagFor(Me)}>
        `)}
    `});var Po,oA=y(()=>{l();c();d();Po={top:"top",right:"right",bottom:"bottom",left:"left",start:"start",end:"end",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",topStart:"top-start",topEnd:"top-end",bottomStart:"bottom-start",bottomEnd:"bottom-end"}});var Yt,iA=y(()=>{l();c();d();Pe();A();we();va();He();oA();Yt=class extends G{constructor(){super(...arguments),this.anchor="",this.delay=300,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.horizontalInset="false",this.verticalInset="false",this.horizontalScaling="content",this.verticalScaling="content",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition=void 0,this.tooltipVisible=!1,this.currentDirection=et.ltr,this.showDelayTimer=null,this.hideDelayTimer=null,this.isAnchorHoveredFocused=!1,this.isRegionHovered=!1,this.handlePositionChange=e=>{this.classList.toggle("top",this.region.verticalPosition==="start"),this.classList.toggle("bottom",this.region.verticalPosition==="end"),this.classList.toggle("inset-top",this.region.verticalPosition==="insetStart"),this.classList.toggle("inset-bottom",this.region.verticalPosition==="insetEnd"),this.classList.toggle("center-vertical",this.region.verticalPosition==="center"),this.classList.toggle("left",this.region.horizontalPosition==="start"),this.classList.toggle("right",this.region.horizontalPosition==="end"),this.classList.toggle("inset-left",this.region.horizontalPosition==="insetStart"),this.classList.toggle("inset-right",this.region.horizontalPosition==="insetEnd"),this.classList.toggle("center-horizontal",this.region.horizontalPosition==="center")},this.handleRegionMouseOver=e=>{this.isRegionHovered=!0},this.handleRegionMouseOut=e=>{this.isRegionHovered=!1,this.startHideDelayTimer()},this.handleAnchorMouseOver=e=>{if(this.tooltipVisible){this.isAnchorHoveredFocused=!0;return}this.startShowDelayTimer()},this.handleAnchorMouseOut=e=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.handleAnchorFocusIn=e=>{this.startShowDelayTimer()},this.handleAnchorFocusOut=e=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.startHideDelayTimer=()=>{this.clearHideDelayTimer(),this.tooltipVisible&&(this.hideDelayTimer=window.setTimeout(()=>{this.updateTooltipVisibility()},60))},this.clearHideDelayTimer=()=>{this.hideDelayTimer!==null&&(clearTimeout(this.hideDelayTimer),this.hideDelayTimer=null)},this.startShowDelayTimer=()=>{if(!this.isAnchorHoveredFocused){if(this.delay>1){this.showDelayTimer===null&&(this.showDelayTimer=window.setTimeout(()=>{this.startHover()},this.delay));return}this.startHover()}},this.startHover=()=>{this.isAnchorHoveredFocused=!0,this.updateTooltipVisibility()},this.clearShowDelayTimer=()=>{this.showDelayTimer!==null&&(clearTimeout(this.showDelayTimer),this.showDelayTimer=null)},this.getAnchor=()=>{let e=this.getRootNode();return e instanceof ShadowRoot?e.getElementById(this.anchor):document.getElementById(this.anchor)},this.handleDocumentKeydown=e=>{if(!e.defaultPrevented&&this.tooltipVisible)switch(e.key){case Vo:this.isAnchorHoveredFocused=!1,this.updateTooltipVisibility(),this.$emit("dismiss");break}},this.updateTooltipVisibility=()=>{if(this.visible===!1)this.hideTooltip();else if(this.visible===!0){this.showTooltip();return}else{if(this.isAnchorHoveredFocused||this.isRegionHovered){this.showTooltip();return}this.hideTooltip()}},this.showTooltip=()=>{this.tooltipVisible||(this.currentDirection=ui(this),this.tooltipVisible=!0,document.addEventListener("keydown",this.handleDocumentKeydown),Y.queueUpdate(this.setRegionProps))},this.hideTooltip=()=>{this.tooltipVisible&&(this.clearHideDelayTimer(),this.region!==null&&this.region!==void 0&&(this.region.removeEventListener("positionchange",this.handlePositionChange),this.region.viewportElement=null,this.region.anchorElement=null,this.region.removeEventListener("mouseover",this.handleRegionMouseOver),this.region.removeEventListener("mouseout",this.handleRegionMouseOut)),document.removeEventListener("keydown",this.handleDocumentKeydown),this.tooltipVisible=!1)},this.setRegionProps=()=>{this.tooltipVisible&&(this.region.viewportElement=this.viewportElement,this.region.anchorElement=this.anchorElement,this.region.addEventListener("positionchange",this.handlePositionChange),this.region.addEventListener("mouseover",this.handleRegionMouseOver,{passive:!0}),this.region.addEventListener("mouseout",this.handleRegionMouseOut,{passive:!0}))}}visibleChanged(){this.$fastController.isConnected&&(this.updateTooltipVisibility(),this.updateLayout())}anchorChanged(){this.$fastController.isConnected&&(this.anchorElement=this.getAnchor())}positionChanged(){this.$fastController.isConnected&&this.updateLayout()}anchorElementChanged(e){if(this.$fastController.isConnected){if(e!=null&&(e.removeEventListener("mouseover",this.handleAnchorMouseOver),e.removeEventListener("mouseout",this.handleAnchorMouseOut),e.removeEventListener("focusin",this.handleAnchorFocusIn),e.removeEventListener("focusout",this.handleAnchorFocusOut)),this.anchorElement!==null&&this.anchorElement!==void 0){this.anchorElement.addEventListener("mouseover",this.handleAnchorMouseOver,{passive:!0}),this.anchorElement.addEventListener("mouseout",this.handleAnchorMouseOut,{passive:!0}),this.anchorElement.addEventListener("focusin",this.handleAnchorFocusIn,{passive:!0}),this.anchorElement.addEventListener("focusout",this.handleAnchorFocusOut,{passive:!0});let t=this.anchorElement.id;this.anchorElement.parentElement!==null&&this.anchorElement.parentElement.querySelectorAll(":hover").forEach(o=>{o.id===t&&this.startShowDelayTimer()})}this.region!==null&&this.region!==void 0&&this.tooltipVisible&&(this.region.anchorElement=this.anchorElement),this.updateLayout()}}viewportElementChanged(){this.region!==null&&this.region!==void 0&&(this.region.viewportElement=this.viewportElement),this.updateLayout()}connectedCallback(){super.connectedCallback(),this.anchorElement=this.getAnchor(),this.updateTooltipVisibility()}disconnectedCallback(){this.hideTooltip(),this.clearShowDelayTimer(),this.clearHideDelayTimer(),super.disconnectedCallback()}updateLayout(){switch(this.verticalPositioningMode="locktodefault",this.horizontalPositioningMode="locktodefault",this.position){case Po.top:case Po.bottom:this.verticalDefaultPosition=this.position,this.horizontalDefaultPosition="center";break;case Po.right:case Po.left:case Po.start:case Po.end:this.verticalDefaultPosition="center",this.horizontalDefaultPosition=this.position;break;case Po.topLeft:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="left";break;case Po.topRight:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="right";break;case Po.bottomLeft:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="left";break;case Po.bottomRight:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="right";break;case Po.topStart:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="start";break;case Po.topEnd:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="end";break;case Po.bottomStart:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="start";break;case Po.bottomEnd:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="end";break;default:this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition="center";break}}};w([k({mode:"boolean"})],Yt.prototype,"visible",void 0);w([k],Yt.prototype,"anchor",void 0);w([k],Yt.prototype,"delay",void 0);w([k],Yt.prototype,"position",void 0);w([k({attribute:"auto-update-mode"})],Yt.prototype,"autoUpdateMode",void 0);w([k({attribute:"horizontal-viewport-lock"})],Yt.prototype,"horizontalViewportLock",void 0);w([k({attribute:"vertical-viewport-lock"})],Yt.prototype,"verticalViewportLock",void 0);w([I],Yt.prototype,"anchorElement",void 0);w([I],Yt.prototype,"viewportElement",void 0);w([I],Yt.prototype,"verticalPositioningMode",void 0);w([I],Yt.prototype,"horizontalPositioningMode",void 0);w([I],Yt.prototype,"horizontalInset",void 0);w([I],Yt.prototype,"verticalInset",void 0);w([I],Yt.prototype,"horizontalScaling",void 0);w([I],Yt.prototype,"verticalScaling",void 0);w([I],Yt.prototype,"verticalDefaultPosition",void 0);w([I],Yt.prototype,"horizontalDefaultPosition",void 0);w([I],Yt.prototype,"tooltipVisible",void 0);w([I],Yt.prototype,"currentDirection",void 0)});var nA=y(()=>{l();c();d();rA();iA()});var sA,aA=y(()=>{l();c();d();A();$t();sA=(r,e)=>O`
    <template
        role="treeitem"
        slot="${t=>t.isNestedItem()?"item":void 0}"
        tabindex="-1"
        class="${t=>t.expanded?"expanded":""} ${t=>t.selected?"selected":""} ${t=>t.nested?"nested":""}
            ${t=>t.disabled?"disabled":""}"
        aria-expanded="${t=>t.childItems&&t.childItemLength()>0?t.expanded:void 0}"
        aria-selected="${t=>t.selected}"
        aria-disabled="${t=>t.disabled}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        ${pa({property:"childItems",filter:zr()})}
    >
        <div class="positioning-region" part="positioning-region">
            <div class="content-region" part="content-region">
                ${Ze(t=>t.childItems&&t.childItemLength()>0,O`
                        <div
                            aria-hidden="true"
                            class="expand-collapse-button"
                            part="expand-collapse-button"
                            @click="${(t,o)=>t.handleExpandCollapseButtonClick(o.event)}"
                            ${Ee("expandCollapseButton")}
                        >
                            <slot name="expand-collapse-glyph">
                                ${e.expandCollapseGlyph||""}
                            </slot>
                        </div>
                    `)}
                ${Ct(r,e)}
                <slot></slot>
                ${wt(r,e)}
            </div>
        </div>
        ${Ze(t=>t.childItems&&t.childItemLength()>0&&(t.expanded||t.renderCollapsedChildren),O`
                <div role="group" class="items" part="items">
                    <slot name="item" ${De("items")}></slot>
                </div>
            `)}
    </template>
`});function Es(r){return Mn(r)&&r.getAttribute("role")==="treeitem"}var Zt,A1=y(()=>{l();c();d();Pe();A();we();$t();Vr();He();Zt=class extends G{constructor(){super(...arguments),this.expanded=!1,this.focusable=!1,this.isNestedItem=()=>Es(this.parentElement),this.handleExpandCollapseButtonClick=e=>{!this.disabled&&!e.defaultPrevented&&(this.expanded=!this.expanded)},this.handleFocus=e=>{this.setAttribute("tabindex","0")},this.handleBlur=e=>{this.setAttribute("tabindex","-1")}}expandedChanged(){this.$fastController.isConnected&&this.$emit("expanded-change",this)}selectedChanged(){this.$fastController.isConnected&&this.$emit("selected-change",this)}itemsChanged(e,t){this.$fastController.isConnected&&this.items.forEach(o=>{Es(o)&&(o.nested=!0)})}static focusItem(e){e.focusable=!0,e.focus()}childItemLength(){let e=this.childItems.filter(t=>Es(t));return e?e.length:0}};w([k({mode:"boolean"})],Zt.prototype,"expanded",void 0);w([k({mode:"boolean"})],Zt.prototype,"selected",void 0);w([k({mode:"boolean"})],Zt.prototype,"disabled",void 0);w([I],Zt.prototype,"focusable",void 0);w([I],Zt.prototype,"childItems",void 0);w([I],Zt.prototype,"items",void 0);w([I],Zt.prototype,"nested",void 0);w([I],Zt.prototype,"renderCollapsedChildren",void 0);We(Zt,_t)});var lA=y(()=>{l();c();d();aA();A1()});var cA,dA=y(()=>{l();c();d();A();cA=(r,e)=>O`
    <template
        role="tree"
        ${Ee("treeView")}
        @keydown="${(t,o)=>t.handleKeyDown(o.event)}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        @click="${(t,o)=>t.handleClick(o.event)}"
        @selected-change="${(t,o)=>t.handleSelectedChange(o.event)}"
    >
        <slot ${De("slottedTreeItems")}></slot>
    </template>
`});var Ul,uA=y(()=>{l();c();d();Pe();A();we();A1();He();Ul=class extends G{constructor(){super(...arguments),this.currentFocused=null,this.handleFocus=e=>{if(!(this.slottedTreeItems.length<1)){if(e.target===this){this.currentFocused===null&&(this.currentFocused=this.getValidFocusableItem()),this.currentFocused!==null&&Zt.focusItem(this.currentFocused);return}this.contains(e.target)&&(this.setAttribute("tabindex","-1"),this.currentFocused=e.target)}},this.handleBlur=e=>{e.target instanceof HTMLElement&&(e.relatedTarget===null||!this.contains(e.relatedTarget))&&this.setAttribute("tabindex","0")},this.handleKeyDown=e=>{if(e.defaultPrevented)return;if(this.slottedTreeItems.length<1)return!0;let t=this.getVisibleNodes();switch(e.key){case kr:t.length&&Zt.focusItem(t[0]);return;case Sr:t.length&&Zt.focusItem(t[t.length-1]);return;case yo:if(e.target&&this.isFocusableElement(e.target)){let o=e.target;o instanceof Zt&&o.childItemLength()>0&&o.expanded?o.expanded=!1:o instanceof Zt&&o.parentElement instanceof Zt&&Zt.focusItem(o.parentElement)}return!1;case bo:if(e.target&&this.isFocusableElement(e.target)){let o=e.target;o instanceof Zt&&o.childItemLength()>0&&!o.expanded?o.expanded=!0:o instanceof Zt&&o.childItemLength()>0&&this.focusNextNode(1,e.target)}return;case Vt:e.target&&this.isFocusableElement(e.target)&&this.focusNextNode(1,e.target);return;case qt:e.target&&this.isFocusableElement(e.target)&&this.focusNextNode(-1,e.target);return;case sr:this.handleClick(e);return}return!0},this.handleSelectedChange=e=>{if(e.defaultPrevented)return;if(!(e.target instanceof Element)||!Es(e.target))return!0;let t=e.target;t.selected?(this.currentSelected&&this.currentSelected!==t&&(this.currentSelected.selected=!1),this.currentSelected=t):!t.selected&&this.currentSelected===t&&(this.currentSelected=null)},this.setItems=()=>{let e=this.treeView.querySelector("[aria-selected='true']");this.currentSelected=e,(this.currentFocused===null||!this.contains(this.currentFocused))&&(this.currentFocused=this.getValidFocusableItem()),this.nested=this.checkForNestedItems(),this.getVisibleNodes().forEach(o=>{Es(o)&&(o.nested=this.nested)})},this.isFocusableElement=e=>Es(e),this.isSelectedElement=e=>e.selected}slottedTreeItemsChanged(){this.$fastController.isConnected&&this.setItems()}connectedCallback(){super.connectedCallback(),this.setAttribute("tabindex","0"),Y.queueUpdate(()=>{this.setItems()})}handleClick(e){if(e.defaultPrevented)return;if(!(e.target instanceof Element)||!Es(e.target))return!0;let t=e.target;t.disabled||(t.selected=!t.selected)}focusNextNode(e,t){let o=this.getVisibleNodes();if(!o)return;let i=o[o.indexOf(t)+e];Mn(i)&&Zt.focusItem(i)}getValidFocusableItem(){let e=this.getVisibleNodes(),t=e.findIndex(this.isSelectedElement);return t===-1&&(t=e.findIndex(this.isFocusableElement)),t!==-1?e[t]:null}checkForNestedItems(){return this.slottedTreeItems.some(e=>Es(e)&&e.querySelector("[role='treeitem']"))}getVisibleNodes(){return nE(this,"[role='treeitem']")||[]}};w([k({attribute:"render-collapsed-nodes"})],Ul.prototype,"renderCollapsedNodes",void 0);w([I],Ul.prototype,"currentSelected",void 0);w([I],Ul.prototype,"slottedTreeItems",void 0)});var hA=y(()=>{l();c();d();dA();uA()});var R1,nh,fe,TDe,EDe,pA=y(()=>{l();c();d();R1=class{constructor(e){this.listenerCache=new WeakMap,this.query=e}bind(e){let{query:t}=this,o=this.constructListener(e);o.bind(t)(),t.addListener(o),this.listenerCache.set(e,o)}unbind(e){let t=this.listenerCache.get(e);t&&(this.query.removeListener(t),this.listenerCache.delete(e))}},nh=class r extends R1{constructor(e,t){super(e),this.styles=t}static with(e){return t=>new r(e,t)}constructListener(e){let t=!1,o=this.styles;return function(){let{matches:n}=this;n&&!t?(e.$fastController.addStyles(o),t=n):!n&&t&&(e.$fastController.removeStyles(o),t=n)}}unbind(e){super.unbind(e),e.$fastController.removeStyles(this.styles)}},fe=nh.with(window.matchMedia("(forced-colors)")),TDe=nh.with(window.matchMedia("(prefers-color-scheme: dark)")),EDe=nh.with(window.matchMedia("(prefers-color-scheme: light)"))});var Bm,fA=y(()=>{l();c();d();A();Bm=class{constructor(e,t,o){this.propertyName=e,this.value=t,this.styles=o}bind(e){pe.getNotifier(e).subscribe(this,this.propertyName),this.handleChange(e,this.propertyName)}unbind(e){pe.getNotifier(e).unsubscribe(this,this.propertyName),e.$fastController.removeStyles(this.styles)}handleChange(e,t){e[t]===this.value?e.$fastController.addStyles(this.styles):e.$fastController.removeStyles(this.styles)}}});var Jt,mA=y(()=>{l();c();d();Jt="not-allowed"});function de(r){return`${KM}:host{display:${r}}`}var KM,gA=y(()=>{l();c();d();KM=":host([hidden]){display:none}"});var ke,vA=y(()=>{l();c();d();we();ke=sE()?"focus-visible":"focus"});var yA=y(()=>{l();c();d();mA();gA();vA()});var bA=y(()=>{l();c();d();Vr();vm();Kb();pA();fA();yA();va();Pm()});var Q=y(()=>{l();c();d();QT();_E();TE();Mb();FE();HE();zE();jE();t2();p2();v2();x2();E2();Ub();R2();o1();P2();$2();B2();z2();G2();Z2();t5();r5();o5();s5();c5();v5();y1();S5();$5();Il();D5();U5();q5();Q5();X5();oI();lI();hI();gI();CI();TI();RI();MI();HI();qI();KI();eA();nA();lA();hA();bA()});function Ai(r,e,t){return isNaN(r)||r<=e?e:r>=t?t:r}function zm(r,e,t){return isNaN(r)||r<=e?0:r>=t?1:r/(t-e)}function Ta(r,e,t){return isNaN(r)?e:e+r*(t-e)}function P1(r){return r*(Math.PI/180)}function wA(r){return r*(180/Math.PI)}function CA(r){let e=Math.round(Ai(r,0,255)).toString(16);return e.length===1?"0"+e:e}function lo(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:e+r*(t-e)}function Vm(r,e,t){if(r<=0)return e%360;if(r>=1)return t%360;let o=(e-t+360)%360,i=(t-e+360)%360;return o<=i?(e-o*r+360)%360:(e+o*r+360)%360}function Rt(r,e){let t=Math.pow(10,e);return Math.round(r*t)/t}var bNe,Ri=y(()=>{l();c();d();bNe=Math.PI*2});var Pi,Qc=y(()=>{l();c();d();Ri();Pi=class r{constructor(e,t,o){this.h=e,this.s=t,this.l=o}static fromObject(e){return e&&!isNaN(e.h)&&!isNaN(e.s)&&!isNaN(e.l)?new r(e.h,e.s,e.l):null}equalValue(e){return this.h===e.h&&this.s===e.s&&this.l===e.l}roundToPrecision(e){return new r(Rt(this.h,e),Rt(this.s,e),Rt(this.l,e))}toObject(){return{h:this.h,s:this.s,l:this.l}}}});var Yc,qm=y(()=>{l();c();d();Ri();Yc=class r{constructor(e,t,o){this.h=e,this.s=t,this.v=o}static fromObject(e){return e&&!isNaN(e.h)&&!isNaN(e.s)&&!isNaN(e.v)?new r(e.h,e.s,e.v):null}equalValue(e){return this.h===e.h&&this.s===e.s&&this.v===e.v}roundToPrecision(e){return new r(Rt(this.h,e),Rt(this.s,e),Rt(this.v,e))}toObject(){return{h:this.h,s:this.s,v:this.v}}}});var tr,sh=y(()=>{l();c();d();Ri();tr=class r{constructor(e,t,o){this.l=e,this.a=t,this.b=o}static fromObject(e){return e&&!isNaN(e.l)&&!isNaN(e.a)&&!isNaN(e.b)?new r(e.l,e.a,e.b):null}equalValue(e){return this.l===e.l&&this.a===e.a&&this.b===e.b}roundToPrecision(e){return new r(Rt(this.l,e),Rt(this.a,e),Rt(this.b,e))}toObject(){return{l:this.l,a:this.a,b:this.b}}};tr.epsilon=216/24389;tr.kappa=24389/27});var Ea,ah=y(()=>{l();c();d();Ri();Ea=class r{constructor(e,t,o){this.l=e,this.c=t,this.h=o}static fromObject(e){return e&&!isNaN(e.l)&&!isNaN(e.c)&&!isNaN(e.h)?new r(e.l,e.c,e.h):null}equalValue(e){return this.l===e.l&&this.c===e.c&&this.h===e.h}roundToPrecision(e){return new r(Rt(this.l,e),Rt(this.c,e),Rt(this.h,e))}toObject(){return{l:this.l,c:this.c,h:this.h}}}});var Qe,Ln=y(()=>{l();c();d();Ri();Qe=class r{constructor(e,t,o,i){this.r=e,this.g=t,this.b=o,this.a=typeof i=="number"&&!isNaN(i)?i:1}static fromObject(e){return e&&!isNaN(e.r)&&!isNaN(e.g)&&!isNaN(e.b)?new r(e.r,e.g,e.b,e.a):null}equalValue(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}toStringHexRGB(){return"#"+[this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringHexRGBA(){return this.toStringHexRGB()+this.formatHexValue(this.a)}toStringHexARGB(){return"#"+[this.a,this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringWebRGB(){return`rgb(${Math.round(Ta(this.r,0,255))},${Math.round(Ta(this.g,0,255))},${Math.round(Ta(this.b,0,255))})`}toStringWebRGBA(){return`rgba(${Math.round(Ta(this.r,0,255))},${Math.round(Ta(this.g,0,255))},${Math.round(Ta(this.b,0,255))},${Ai(this.a,0,1)})`}roundToPrecision(e){return new r(Rt(this.r,e),Rt(this.g,e),Rt(this.b,e),Rt(this.a,e))}clamp(){return new r(Ai(this.r,0,1),Ai(this.g,0,1),Ai(this.b,0,1),Ai(this.a,0,1))}toObject(){return{r:this.r,g:this.g,b:this.b,a:this.a}}formatHexValue(e){return CA(Ta(e,0,255))}}});var $o,Gm=y(()=>{l();c();d();Ri();$o=class r{constructor(e,t,o){this.x=e,this.y=t,this.z=o}static fromObject(e){return e&&!isNaN(e.x)&&!isNaN(e.y)&&!isNaN(e.z)?new r(e.x,e.y,e.z):null}equalValue(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}roundToPrecision(e){return new r(Rt(this.x,e),Rt(this.y,e),Rt(this.z,e))}toObject(){return{x:this.x,y:this.y,z:this.z}}};$o.whitePoint=new $o(.95047,1,1.08883)});function jm(r){return r.r*.2126+r.g*.7152+r.b*.0722}function Zc(r){function e(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}return jm(new Qe(e(r.r),e(r.g),e(r.b),1))}function M1(r,e){let t=Zc(r),o=Zc(e);return t>o?xA(t,o):xA(o,t)}function $1(r,e,t){return t-e===0?0:(r-e)/(t-e)}function O1(r,e,t){let o=$1(r.r,e.r,t.r),i=$1(r.g,e.g,t.g),n=$1(r.b,e.b,t.b);return(o+i+n)/3}function kA(r,e,t=null){let o=0,i=t;return i!==null?o=O1(r,e,i):(i=new Qe(0,0,0,1),o=O1(r,e,i),o<=0&&(i=new Qe(1,1,1,1),o=O1(r,e,i))),o=Math.round(o*1e3)/1e3,new Qe(i.r,i.g,i.b,o)}function hi(r){let e=Math.max(r.r,r.g,r.b),t=Math.min(r.r,r.g,r.b),o=e-t,i=0;o!==0&&(e===r.r?i=60*((r.g-r.b)/o%6):e===r.g?i=60*((r.b-r.r)/o+2):i=60*((r.r-r.g)/o+4)),i<0&&(i+=360);let n=(e+t)/2,s=0;return o!==0&&(s=o/(1-Math.abs(2*n-1))),new Pi(i,s,n)}function Ia(r,e=1){let t=(1-Math.abs(2*r.l-1))*r.s,o=t*(1-Math.abs(r.h/60%2-1)),i=r.l-t/2,n=0,s=0,a=0;return r.h<60?(n=t,s=o,a=0):r.h<120?(n=o,s=t,a=0):r.h<180?(n=0,s=t,a=o):r.h<240?(n=0,s=o,a=t):r.h<300?(n=o,s=0,a=t):r.h<360&&(n=t,s=0,a=o),new Qe(n+i,s+i,a+i,e)}function F1(r){let e=Math.max(r.r,r.g,r.b),t=Math.min(r.r,r.g,r.b),o=e-t,i=0;o!==0&&(e===r.r?i=60*((r.g-r.b)/o%6):e===r.g?i=60*((r.b-r.r)/o+2):i=60*((r.r-r.g)/o+4)),i<0&&(i+=360);let n=0;return e!==0&&(n=o/e),new Yc(i,n,e)}function SA(r,e=1){let t=r.s*r.v,o=t*(1-Math.abs(r.h/60%2-1)),i=r.v-t,n=0,s=0,a=0;return r.h<60?(n=t,s=o,a=0):r.h<120?(n=o,s=t,a=0):r.h<180?(n=0,s=t,a=o):r.h<240?(n=0,s=o,a=t):r.h<300?(n=o,s=0,a=t):r.h<360&&(n=t,s=0,a=o),new Qe(n+i,s+i,a+i,e)}function WM(r){let e=0,t=0;return r.h!==0&&(e=Math.cos(P1(r.h))*r.c,t=Math.sin(P1(r.h))*r.c),new tr(r.l,e,t)}function QM(r){let e=0;(Math.abs(r.b)>.001||Math.abs(r.a)>.001)&&(e=wA(Math.atan2(r.b,r.a))),e<0&&(e+=360);let t=Math.sqrt(r.a*r.a+r.b*r.b);return new Ea(r.l,t,e)}function YM(r){let e=(r.l+16)/116,t=e+r.a/500,o=e-r.b/200,i=Math.pow(t,3),n=Math.pow(e,3),s=Math.pow(o,3),a=0;i>tr.epsilon?a=i:a=(116*t-16)/tr.kappa;let u=0;r.l>tr.epsilon*tr.kappa?u=n:u=r.l/tr.kappa;let h=0;return s>tr.epsilon?h=s:h=(116*o-16)/tr.kappa,a=$o.whitePoint.x*a,u=$o.whitePoint.y*u,h=$o.whitePoint.z*h,new $o(a,u,h)}function ZM(r){function e(u){return u>tr.epsilon?Math.pow(u,1/3):(tr.kappa*u+16)/116}let t=e(r.x/$o.whitePoint.x),o=e(r.y/$o.whitePoint.y),i=e(r.z/$o.whitePoint.z),n=116*o-16,s=500*(t-o),a=200*(o-i);return new tr(n,s,a)}function Km(r){function e(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}let t=e(r.r),o=e(r.g),i=e(r.b),n=t*.4124564+o*.3575761+i*.1804375,s=t*.2126729+o*.7151522+i*.072175,a=t*.0193339+o*.119192+i*.9503041;return new $o(n,s,a)}function D1(r,e=1){function t(s){return s<=.0031308?s*12.92:1.055*Math.pow(s,1/2.4)-.055}let o=t(r.x*3.2404542-r.y*1.5371385-r.z*.4985314),i=t(r.x*-.969266+r.y*1.8760108+r.z*.041556),n=t(r.x*.0556434-r.y*.2040259+r.z*1.0572252);return new Qe(o,i,n,e)}function Bl(r){return ZM(Km(r))}function Aa(r,e=1){return D1(YM(r),e)}function lh(r){return QM(Bl(r))}function Wm(r,e=1){return Aa(WM(r),e)}var xA,Ra=y(()=>{l();c();d();Qc();qm();sh();ah();Ln();Gm();Ri();xA=(r,e)=>(r+.05)/(e+.05)});function H1(r,e,t=18){let o=lh(r),i=o.c+e*t;return i<0&&(i=0),Wm(new Ea(o.l,i,o.h))}function L1(r,e){return r*e}function U1(r,e){return new Qe(L1(r.r,e.r),L1(r.g,e.g),L1(r.b,e.b),1)}function N1(r,e){return r<.5?Ai(2*e*r,0,1):Ai(1-2*(1-e)*(1-r),0,1)}function B1(r,e){return new Qe(N1(r.r,e.r),N1(r.g,e.g),N1(r.b,e.b),1)}function TA(r,e){if(e.a>=1)return e;if(e.a<=0)return new Qe(r.r,r.g,r.b,1);let t=e.a*e.r+(1-e.a)*r.r,o=e.a*e.g+(1-e.a)*r.g,i=e.a*e.b+(1-e.a)*r.b;return new Qe(t,o,i,1)}var _A,z1=y(()=>{l();c();d();Ra();Qc();sh();ah();Ln();Ri();(function(r){r[r.Burn=0]="Burn",r[r.Color=1]="Color",r[r.Darken=2]="Darken",r[r.Dodge=3]="Dodge",r[r.Lighten=4]="Lighten",r[r.Multiply=5]="Multiply",r[r.Overlay=6]="Overlay",r[r.Screen=7]="Screen"})(_A||(_A={}))});function Jc(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Qe(lo(r,e.r,t.r),lo(r,e.g,t.g),lo(r,e.b,t.b),lo(r,e.a,t.a))}function JM(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Pi(Vm(r,e.h,t.h),lo(r,e.s,t.s),lo(r,e.l,t.l))}function XM(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Yc(Vm(r,e.h,t.h),lo(r,e.s,t.s),lo(r,e.v,t.v))}function e8(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new $o(lo(r,e.x,t.x),lo(r,e.y,t.y),lo(r,e.z,t.z))}function t8(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new tr(lo(r,e.l,t.l),lo(r,e.a,t.a),lo(r,e.b,t.b))}function r8(r,e,t){return isNaN(r)||r<=0?e:r>=1?t:new Ea(lo(r,e.l,t.l),lo(r,e.c,t.c),Vm(r,e.h,t.h))}function zl(r,e,t,o){if(isNaN(r)||r<=0)return t;if(r>=1)return o;switch(e){case Co.HSL:return Ia(JM(r,hi(t),hi(o)));case Co.HSV:return SA(XM(r,F1(t),F1(o)));case Co.XYZ:return D1(e8(r,Km(t),Km(o)));case Co.LAB:return Aa(t8(r,Bl(t),Bl(o)));case Co.LCH:return Wm(r8(r,lh(t),lh(o)));default:return Jc(r,t,o)}}var Co,ch=y(()=>{l();c();d();Ra();Qc();qm();sh();ah();Ln();Gm();Ri();(function(r){r[r.RGB=0]="RGB",r[r.HSL=1]="HSL",r[r.HSV=2]="HSV",r[r.XYZ=3]="XYZ",r[r.LAB=4]="LAB",r[r.LCH=5]="LCH"})(Co||(Co={}))});var Nn,Qm=y(()=>{l();c();d();Ra();ch();Nn=class r{constructor(e){if(e==null||e.length===0)throw new Error("The stops argument must be non-empty");this.stops=this.sortColorScaleStops(e)}static createBalancedColorScale(e){if(e==null||e.length===0)throw new Error("The colors argument must be non-empty");let t=new Array(e.length);for(let o=0;o<e.length;o++)o===0?t[o]={color:e[o],position:0}:o===e.length-1?t[o]={color:e[o],position:1}:t[o]={color:e[o],position:o*(1/(e.length-1))};return new r(t)}getColor(e,t=Co.RGB){if(this.stops.length===1)return this.stops[0].color;if(e<=0)return this.stops[0].color;if(e>=1)return this.stops[this.stops.length-1].color;let o=0;for(let s=0;s<this.stops.length;s++)this.stops[s].position<=e&&(o=s);let i=o+1;i>=this.stops.length&&(i=this.stops.length-1);let n=(e-this.stops[o].position)*(1/(this.stops[i].position-this.stops[o].position));return zl(n,t,this.stops[o].color,this.stops[i].color)}trim(e,t,o=Co.RGB){if(e<0||t>1||t<e)throw new Error("Invalid bounds");if(e===t)return new r([{color:this.getColor(e,o),position:0}]);let i=[];for(let a=0;a<this.stops.length;a++)this.stops[a].position>=e&&this.stops[a].position<=t&&i.push(this.stops[a]);if(i.length===0)return new r([{color:this.getColor(e),position:e},{color:this.getColor(t),position:t}]);i[0].position!==e&&i.unshift({color:this.getColor(e),position:e}),i[i.length-1].position!==t&&i.push({color:this.getColor(t),position:t});let n=t-e,s=new Array(i.length);for(let a=0;a<i.length;a++)s[a]={color:i[a].color,position:(i[a].position-e)/n};return new r(s)}findNextColor(e,t,o=!1,i=Co.RGB,n=.005,s=32){isNaN(e)||e<=0?e=0:e>=1&&(e=1);let a=this.getColor(e,i),u=o?0:1,h=this.getColor(u,i);if(M1(a,h)<=t)return u;let f=o?0:e,b=o?e:0,C=u,S=0;for(;S<=s;){C=Math.abs(b-f)/2+f;let R=this.getColor(C,i),N=M1(a,R);if(Math.abs(N-t)<=n)return C;N>t?o?f=C:b=C:o?b=C:f=C,S++}return C}clone(){let e=new Array(this.stops.length);for(let t=0;t<e.length;t++)e[t]={color:this.stops[t].color,position:this.stops[t].position};return new r(e)}sortColorScaleStops(e){return e.sort((t,o)=>{let i=t.position,n=o.position;return i<n?-1:i>n?1:0})}}});var EA=y(()=>{l();c();d()});function ht(r){let e=o8.exec(r);if(e===null)return null;let t=e[1];if(t.length===3){let i=t.charAt(0),n=t.charAt(1),s=t.charAt(2);t=i.concat(i,n,n,s,s)}let o=parseInt(t,16);return isNaN(o)?null:new Qe(zm((o&16711680)>>>16,0,255),zm((o&65280)>>>8,0,255),zm(o&255,0,255),1)}var o8,Ym=y(()=>{l();c();d();Ln();Ri();EA();o8=/^#((?:[0-9a-f]{6}|[0-9a-f]{3}))$/i});var Is,oUe,V1=y(()=>{l();c();d();z1();Ra();ch();Ln();Qm();Ym();Is=class r{constructor(e){this.config=Object.assign({},r.defaultPaletteConfig,e),this.palette=[],this.updatePaletteColors()}updatePaletteGenerationValues(e){let t=!1;for(let o in e)this.config[o]&&(this.config[o].equalValue?this.config[o].equalValue(e[o])||(this.config[o]=e[o],t=!0):e[o]!==this.config[o]&&(this.config[o]=e[o],t=!0));return t&&this.updatePaletteColors(),t}updatePaletteColors(){let e=this.generatePaletteColorScale();for(let t=0;t<this.config.steps;t++)this.palette[t]=e.getColor(t/(this.config.steps-1),this.config.interpolationMode)}generatePaletteColorScale(){let e=hi(this.config.baseColor),o=new Nn([{position:0,color:this.config.scaleColorLight},{position:.5,color:this.config.baseColor},{position:1,color:this.config.scaleColorDark}]).trim(this.config.clipLight,1-this.config.clipDark),i=o.getColor(0),n=o.getColor(1),s=i,a=n;if(e.s>=this.config.saturationAdjustmentCutoff&&(s=H1(s,this.config.saturationLight),a=H1(a,this.config.saturationDark)),this.config.multiplyLight!==0){let u=U1(this.config.baseColor,s);s=zl(this.config.multiplyLight,this.config.interpolationMode,s,u)}if(this.config.multiplyDark!==0){let u=U1(this.config.baseColor,a);a=zl(this.config.multiplyDark,this.config.interpolationMode,a,u)}if(this.config.overlayLight!==0){let u=B1(this.config.baseColor,s);s=zl(this.config.overlayLight,this.config.interpolationMode,s,u)}if(this.config.overlayDark!==0){let u=B1(this.config.baseColor,a);a=zl(this.config.overlayDark,this.config.interpolationMode,a,u)}return this.config.baseScalePosition?this.config.baseScalePosition<=0?new Nn([{position:0,color:this.config.baseColor},{position:1,color:a.clamp()}]):this.config.baseScalePosition>=1?new Nn([{position:0,color:s.clamp()},{position:1,color:this.config.baseColor}]):new Nn([{position:0,color:s.clamp()},{position:this.config.baseScalePosition,color:this.config.baseColor},{position:1,color:a.clamp()}]):new Nn([{position:0,color:s.clamp()},{position:.5,color:this.config.baseColor},{position:1,color:a.clamp()}])}};Is.defaultPaletteConfig={baseColor:ht("#808080"),steps:11,interpolationMode:Co.RGB,scaleColorLight:new Qe(1,1,1,1),scaleColorDark:new Qe(0,0,0,1),clipLight:.185,clipDark:.16,saturationAdjustmentCutoff:.05,saturationLight:.35,saturationDark:1.25,overlayLight:0,overlayDark:.25,multiplyLight:0,multiplyDark:0,baseScalePosition:.5};Is.greyscalePaletteConfig={baseColor:ht("#808080"),steps:11,interpolationMode:Co.RGB,scaleColorLight:new Qe(1,1,1,1),scaleColorDark:new Qe(0,0,0,1),clipLight:0,clipDark:0,saturationAdjustmentCutoff:0,saturationLight:0,saturationDark:0,overlayLight:0,overlayDark:0,multiplyLight:0,multiplyDark:0,baseScalePosition:.5};oUe={targetSize:63,spacing:4,scaleColorLight:Is.defaultPaletteConfig.scaleColorLight,scaleColorDark:Is.defaultPaletteConfig.scaleColorDark}});var q1=y(()=>{l();c();d()});var G1=y(()=>{l();c();d();Ln()});var IA=y(()=>{l();c();d();q1();G1()});var j1,AA=y(()=>{l();c();d();Ln();V1();Ra();Qm();Qc();ch();Ym();j1=class r{constructor(e){this.palette=[],this.config=Object.assign({},r.defaultPaletteConfig,e),this.regenPalettes()}regenPalettes(){let e=this.config.steps;(isNaN(e)||e<3)&&(e=3);let t=.14,o=.06,i=new Qe(t,t,t,1),n=94,a=new Is(Object.assign(Object.assign({},Is.greyscalePaletteConfig),{baseColor:i,baseScalePosition:(1-t)*100/n,steps:e})).palette,u=jm(this.config.baseColor),h=hi(this.config.baseColor).l,p=(u+h)/2,b=this.matchRelativeLuminanceIndex(p,a)/(e-1),S=this.matchRelativeLuminanceIndex(t,a)/(e-1),R=hi(this.config.baseColor),N=Ia(Pi.fromObject({h:R.h,s:R.s,l:t})),ye=Ia(Pi.fromObject({h:R.h,s:R.s,l:o})),ie=new Array(5);ie[0]={position:0,color:new Qe(1,1,1,1)},ie[1]={position:b,color:this.config.baseColor},ie[2]={position:S,color:N},ie[3]={position:.99,color:ye},ie[4]={position:1,color:new Qe(0,0,0,1)};let me=new Nn(ie);this.palette=new Array(e);for(let yt=0;yt<e;yt++){let Ge=me.getColor(yt/(e-1),Co.RGB);this.palette[yt]=Ge}}matchRelativeLuminanceIndex(e,t){let o=Number.MAX_VALUE,i=0,n=0,s=t.length;for(;n<s;n++){let a=Math.abs(jm(t[n])-e);a<o&&(o=a,i=n)}return i}};j1.defaultPaletteConfig={baseColor:ht("#808080"),steps:94}});var RA=y(()=>{l();c();d();Ra()});var PA=y(()=>{l();c();d();Ln()});var As=y(()=>{l();c();d();z1();Ra();Qc();qm();ch();sh();ah();V1();IA();Ln();Qm();Gm();AA();q1();Ri();RA();Ym();PA();G1()});function Vl(r,e){let t=r.relativeLuminance>e.relativeLuminance?r:e,o=r.relativeLuminance>e.relativeLuminance?e:r;return(t.relativeLuminance+.05)/(o.relativeLuminance+.05)}var Zm=y(()=>{l();c();d()});function $A(r){let e={r:0,g:0,b:0,toColorString:()=>"",contrast:()=>0,relativeLuminance:0};for(let t in e)if(typeof e[t]!=typeof r[t])return!1;return!0}var Xe,Jm,Pa=y(()=>{l();c();d();As();Zm();Xe=Object.freeze({create(r,e,t){return new Jm(r,e,t)},from(r){return new Jm(r.r,r.g,r.b)}});Jm=class r extends Qe{constructor(e,t,o){super(e,t,o,1),this.toColorString=this.toStringHexRGB,this.contrast=Vl.bind(null,this),this.createCSS=this.toColorString,this.relativeLuminance=Zc(this)}static fromObject(e){return new r(e.r,e.g,e.b)}}});function Xm(r,e,t=0,o=r.length-1){if(o===t)return r[t];let i=Math.floor((o-t)/2)+t;return e(r[i])?Xm(r,e,t,i):Xm(r,e,i+1,o)}var OA=y(()=>{l();c();d()});function $i(r){return r.relativeLuminance<=i8}var i8,Xc=y(()=>{l();c();d();i8=(-.1+Math.sqrt(.21))/2});function Wo(r){return $i(r)?-1:1}var $a=y(()=>{l();c();d();Xc()});function n8(r,e,t){return typeof r=="number"?Oa.from(Xe.create(r,e,t)):Oa.from(r)}function s8(r,e){return $A(r)?eg.from(r,e):eg.from(Xe.create(r.r,r.g,r.b),e)}var MA,Oa,eg,tg=y(()=>{l();c();d();As();Pa();OA();$a();Zm();MA={stepContrast:1.03,stepContrastRamp:.03,preserveSource:!1};Oa=Object.freeze({create:n8,from:s8}),eg=class r{constructor(e,t){this.closestIndexCache=new Map,this.source=e,this.swatches=t,this.reversedSwatches=Object.freeze([...this.swatches].reverse()),this.lastIndex=this.swatches.length-1}colorContrast(e,t,o,i){o===void 0&&(o=this.closestIndexOf(e));let n=this.swatches,s=this.lastIndex,a=o;i===void 0&&(i=Wo(e));let u=h=>Vl(e,h)>=t;return i===-1&&(n=this.reversedSwatches,a=s-a),Xm(n,u,a,s)}get(e){return this.swatches[e]||this.swatches[Ai(e,0,this.lastIndex)]}closestIndexOf(e){if(this.closestIndexCache.has(e.relativeLuminance))return this.closestIndexCache.get(e.relativeLuminance);let t=this.swatches.indexOf(e);if(t!==-1)return this.closestIndexCache.set(e.relativeLuminance,t),t;let o=this.swatches.reduce((i,n)=>Math.abs(n.relativeLuminance-e.relativeLuminance)<Math.abs(i.relativeLuminance-e.relativeLuminance)?n:i);return t=this.swatches.indexOf(o),this.closestIndexCache.set(e.relativeLuminance,t),t}static saturationBump(e,t){let i=hi(e).s,n=hi(t);if(n.s<i){let s=new Pi(n.h,i,n.l);return Ia(s)}return t}static ramp(e){let t=e/100;return t>.5?(t-.5)/.5:2*t}static createHighResolutionPalette(e){let t=[],o=Bl(Qe.fromObject(e).roundToPrecision(4)),i=Aa(new tr(0,o.a,o.b)).clamp().roundToPrecision(4),n=Aa(new tr(50,o.a,o.b)).clamp().roundToPrecision(4),s=Aa(new tr(100,o.a,o.b)).clamp().roundToPrecision(4),a=new Qe(0,0,0),u=new Qe(1,1,1),h=s.equalValue(u)?0:14,p=i.equalValue(a)?0:14;for(let f=100+h;f>=0-p;f-=.5){let b;if(f<0){let C=f/p+1;b=Jc(C,a,i)}else if(f<=50)b=Jc(r.ramp(f),i,n);else if(f<=100)b=Jc(r.ramp(f),n,s);else{let C=(f-100)/h;b=Jc(C,s,u)}b=r.saturationBump(n,b).roundToPrecision(4),t.push(Xe.from(b))}return new r(e,t)}static adjustEnd(e,t,o,i){let n=i===-1?t.swatches:t.reversedSwatches,s=h=>{let p=t.closestIndexOf(h);return i===1?t.lastIndex-p:p};i===1&&o.reverse();let a=e(o[o.length-2]);if(Rt(Vl(o[o.length-1],o[o.length-2]),2)<a){o.pop();let h=t.colorContrast(n[t.lastIndex],a,void 0,i),p=s(h),f=s(o[o.length-2]),b=p-f,C=1;for(let S=o.length-b-1;S<o.length;S++){let R=s(o[S]),N=S===o.length-1?t.lastIndex:R+C;o[S]=n[N],C++}}i===1&&o.reverse()}static createColorPaletteByContrast(e,t){let o=r.createHighResolutionPalette(e),i=a=>{let u=t.stepContrast+t.stepContrast*(1-a.relativeLuminance)*t.stepContrastRamp;return Rt(u,2)},n=[],s=t.preserveSource?e:o.swatches[0];n.push(s);do{let a=i(s);s=o.colorContrast(s,a,void 0,1),n.push(s)}while(s.relativeLuminance>0);if(t.preserveSource){s=e;do{let a=i(s);s=o.colorContrast(s,a,void 0,-1),n.unshift(s)}while(s.relativeLuminance<1)}return this.adjustEnd(i,o,n,-1),t.preserveSource&&this.adjustEnd(i,o,n,1),n}static from(e,t){let o=t===void 0?MA:Object.assign(Object.assign({},MA),t);return new r(e,Object.freeze(r.createColorPaletteByContrast(e,o)))}}});var ed,dh,FA,K1,DA,rg=y(()=>{l();c();d();As();Pa();ed=Xe.create(1,1,1),dh=Xe.create(0,0,0),FA=Xe.create(.5,.5,.5),K1=ht("#0078D4"),DA=Xe.create(K1.r,K1.g,K1.b)});function W1(r,e,t,o,i){let n=p=>p.contrast(ed)>=i?ed:dh,s=n(r),a=n(e),u=s.relativeLuminance===a.relativeLuminance?s:n(t),h=n(o);return{rest:s,hover:a,active:u,focus:h}}var LA=y(()=>{l();c();d();rg()});var td,Q1=y(()=>{l();c();d();As();Zm();td=class r{constructor(e,t,o,i){this.toColorString=()=>this.cssGradient,this.contrast=Vl.bind(null,this),this.createCSS=this.toColorString,this.color=new Qe(e,t,o),this.cssGradient=i,this.relativeLuminance=Zc(this.color),this.r=e,this.g=t,this.b=o}static fromObject(e,t){return new r(e.r,e.g,e.b,t)}}});function Y1(r,e,t,o,i,n,s,a,u=10,h=!1){let p=r.closestIndexOf(e);a===void 0&&(a=Wo(e));function f(me){if(h){let yt=r.closestIndexOf(e),Ge=r.get(yt),tt=me.relativeLuminance<e.relativeLuminance?a8:l8,_o=kA(ht(me.toColorString()),ht(Ge.toColorString()),tt).roundToPrecision(2),Tr=TA(ht(e.toColorString()),_o);return Xe.from(Tr)}else return me}let b=p+a*t,C=b+a*(o-t),S=b+a*(i-t),R=b+a*(n-t),N=a===-1?0:100-u,ye=a===-1?u:100;function ie(me,yt){let Ge=r.get(me);if(yt){let tt=r.get(me+a*s),_o=a===-1?tt:Ge,Tr=a===-1?Ge:tt,f7=`linear-gradient(${f(_o).toColorString()} ${N}%, ${f(Tr).toColorString()} ${ye}%)`;return td.fromObject(_o,f7)}else return f(Ge)}return{rest:ie(b,!0),hover:ie(C,!0),active:ie(S,!1),focus:ie(R,!0)}}var a8,l8,NA=y(()=>{l();c();d();As();Pa();$a();Q1();a8=new Qe(0,0,0),l8=new Qe(1,1,1)});function HA(r,e,t,o,i,n,s,a){let u=r.closestIndexOf(e),h=Wo(e),p=u+h*t,f=p+h*(o-t),b=p+h*(i-t),C=p+h*(n-t),S=`calc(100% - ${a})`;function R(N,ye){let ie=r.get(N);if(ye){let me=r.get(N+h*s),yt=`linear-gradient(${ie.toColorString()} ${S}, ${me.toColorString()} ${S}, ${me.toColorString()})`;return td.fromObject(ie,yt)}else return ie}return{rest:R(p,!0),hover:R(f,!0),active:R(b,!1),focus:R(C,!0)}}var UA=y(()=>{l();c();d();$a();Q1()});function BA(r,e,t){return r.colorContrast(e,t)}var zA=y(()=>{l();c();d()});function ql(r,e,t,o,i,n,s,a){a==null&&(a=Wo(e));let u=r.closestIndexOf(r.colorContrast(e,t));return{rest:r.get(u+a*o),hover:r.get(u+a*i),active:r.get(u+a*n),focus:r.get(u+a*s)}}function VA(r,e,t,o,i,n,s,a=void 0,u,h,p,f,b,C=void 0){return $i(e)?ql(r,e,u,h,p,f,b,C):ql(r,e,t,o,i,n,s,a)}var qA=y(()=>{l();c();d();$a();Xc()});function GA(r,e,t){return r.get(r.closestIndexOf(e)+Wo(e)*t)}var jA=y(()=>{l();c();d();$a()});function Rs(r,e,t,o,i,n,s){let a=r.closestIndexOf(e);return s==null&&(s=Wo(e)),{rest:r.get(a+s*t),hover:r.get(a+s*o),active:r.get(a+s*i),focus:r.get(a+s*n)}}function og(r,e,t,o,i,n,s=void 0,a,u,h,p,f=void 0){return $i(e)?Rs(r,e,a,u,h,p,f):Rs(r,e,t,o,i,n,s)}var KA=y(()=>{l();c();d();$a();Xc()});function WA(r,e){return $i(e)?ed:dh}function QA(r,e,t){return $i(e)?dh:ed}var YA=y(()=>{l();c();d();rg();Xc()});function ZA(r){return Xe.create(r,r,r)}var Hn,ig=y(()=>{l();c();d();Pa();(function(r){r[r.LightMode=.98]="LightMode",r[r.DarkMode=.15]="DarkMode"})(Hn||(Hn={}))});function Ps(r,e){return r.closestIndexOf(ZA(e))}function JA(r,e){return r.get(Ps(r,e))}var rd=y(()=>{l();c();d();ig()});function XA(r,e,t){return r.get(Ps(r,e)+t)}var eR=y(()=>{l();c();d();rd()});function Z1(r,e,t){return r.get(Ps(r,e)+t*-1)}var tR=y(()=>{l();c();d();rd()});function rR(r,e,t){return r.get(Ps(r,e)+t*-1*2)}var oR=y(()=>{l();c();d();rd()});function iR(r,e,t){return r.get(Ps(r,e)+t*-1*3)}var nR=y(()=>{l();c();d();rd()});var sR,aR=y(()=>{l();c();d();sR={Thin:100,ExtraLight:200,Light:300,Normal:400,Medium:500,SemiBold:600,Bold:700,ExtraBold:800,Black:900}});function re(r){return Je.create({name:r,cssCustomPropertyName:null})}function Os(r){return e=>{let t=r.getValueFor(e),o=c8.getValueFor(e);if(t.endsWith("px")){let i=Number.parseFloat(t.replace("px",""));if(i<=12)return`"wght" ${o}, "opsz" 8`;if(i>24)return`"wght" ${o}, "opsz" 36`}return`"wght" ${o}, "opsz" 10.5`}}function L8(r,e,t,o,i,n){let s=Wo(e),a=r.closestIndexOf(r.colorContrast(e,14)),u=a+s*Math.abs(t-o),h=s===1?t<o:s*t>s*o,p,f;return h?(p=a,f=u):(p=u,f=a),{rest:r.get(p),hover:r.get(f),active:r.get(p+s*i),focus:r.get(p+s*n)}}var L,od,Ht,Ma,hR,xo,j,$e,Oo,te,Xt,ko,c8,uh,hg,pR,hh,id,fR,ph,pg,mR,fh,fg,gR,mh,mg,vR,gh,gg,yR,vh,vg,bR,yh,yg,wR,bh,bg,CR,Oi,ag,lg,cg,dg,J1,X1,ew,tw,rw,ow,iw,nw,sw,aw,lw,cw,ng,lR,cR,dR,$s,d8,u8,sg,h8,p8,f8,m8,dw,uw,hw,pw,g8,fw,mw,gw,vw,yw,bw,ww,xR,kR,SR,_R,Cw,uR,v8,y8,b8,w8,C8,wh,Ot,Ch,xw,x8,JVe,k8,Un,S8,_8,T8,XVe,E8,eqe,I8,tqe,Ae,ug,wg,Ke,Kr,Wr,nd,Cg,Mo,sd,ad,TR,xg,xh,kh,Sh,ER,kg,Sg,_g,Tg,IR,Eg,Fo,kw,Sw,rqe,Bn,_h,_w,oqe,Tw,Ig,ld,cd,dd,ud,Ms,AR,iqe,nqe,A8,RR,Fs,Mi,hd,PR,$R,Qo,Ds,zn,Vn,OR,Ag,Rg,MR,FR,sqe,Pg,Fe,DR,LR,aqe,pd,qn,$g,Fa,NR,HR,lqe,Og,fd,Mg,Fg,cqe,R8,Gl,Dg,Ew,UR,dqe,uqe,Iw,Ls,hqe,pqe,Lg,Fi,md,gd,fqe,P8,vd,$8,BR,Ng,mqe,gqe,vqe,yqe,O8,M8,F8,D8,Hg,bqe,wqe,Cqe,xqe,Le=y(()=>{l();c();d();Q();we();tg();LA();NA();UA();zA();qA();jA();KA();YA();eR();rd();tR();oR();nR();rg();ig();$a();aR();({create:L}=Je);od=L("direction").withDefault(et.ltr),Ht=L("disabled-opacity").withDefault(.3),Ma=L("base-height-multiplier").withDefault(8),hR=L("base-horizontal-spacing-multiplier").withDefault(3),xo=L("density").withDefault(0),j=L("design-unit").withDefault(4),$e=L("control-corner-radius").withDefault(4),Oo=L("layer-corner-radius").withDefault(8),te=L("stroke-width").withDefault(1),Xt=L("focus-stroke-width").withDefault(2),ko=L("body-font").withDefault('"Segoe UI Variable", "Segoe UI", sans-serif'),c8=L("font-weight").withDefault(sR.Normal);uh=L("type-ramp-base-font-size").withDefault("14px"),hg=L("type-ramp-base-line-height").withDefault("20px"),pR=L("type-ramp-base-font-variations").withDefault(Os(uh)),hh=L("type-ramp-minus-1-font-size").withDefault("12px"),id=L("type-ramp-minus-1-line-height").withDefault("16px"),fR=L("type-ramp-minus-1-font-variations").withDefault(Os(hh)),ph=L("type-ramp-minus-2-font-size").withDefault("10px"),pg=L("type-ramp-minus-2-line-height").withDefault("14px"),mR=L("type-ramp-minus-2-font-variations").withDefault(Os(ph)),fh=L("type-ramp-plus-1-font-size").withDefault("16px"),fg=L("type-ramp-plus-1-line-height").withDefault("22px"),gR=L("type-ramp-plus-1-font-variations").withDefault(Os(fh)),mh=L("type-ramp-plus-2-font-size").withDefault("20px"),mg=L("type-ramp-plus-2-line-height").withDefault("26px"),vR=L("type-ramp-plus-2-font-variations").withDefault(Os(mh)),gh=L("type-ramp-plus-3-font-size").withDefault("24px"),gg=L("type-ramp-plus-3-line-height").withDefault("32px"),yR=L("type-ramp-plus-3-font-variations").withDefault(Os(gh)),vh=L("type-ramp-plus-4-font-size").withDefault("28px"),vg=L("type-ramp-plus-4-line-height").withDefault("36px"),bR=L("type-ramp-plus-4-font-variations").withDefault(Os(vh)),yh=L("type-ramp-plus-5-font-size").withDefault("32px"),yg=L("type-ramp-plus-5-line-height").withDefault("40px"),wR=L("type-ramp-plus-5-font-variations").withDefault(Os(yh)),bh=L("type-ramp-plus-6-font-size").withDefault("40px"),bg=L("type-ramp-plus-6-line-height").withDefault("52px"),CR=L("type-ramp-plus-6-font-variations").withDefault(Os(bh)),Oi=L("base-layer-luminance").withDefault(Hn.LightMode),ag=re("accent-fill-rest-delta").withDefault(0),lg=re("accent-fill-hover-delta").withDefault(-2),cg=re("accent-fill-active-delta").withDefault(-5),dg=re("accent-fill-focus-delta").withDefault(0),J1=re("accent-foreground-rest-delta").withDefault(0),X1=re("accent-foreground-hover-delta").withDefault(3),ew=re("accent-foreground-active-delta").withDefault(-8),tw=re("accent-foreground-focus-delta").withDefault(0),rw=re("neutral-fill-rest-delta").withDefault(-1),ow=re("neutral-fill-hover-delta").withDefault(1),iw=re("neutral-fill-active-delta").withDefault(0),nw=re("neutral-fill-focus-delta").withDefault(0),sw=re("neutral-fill-input-rest-delta").withDefault(-1),aw=re("neutral-fill-input-hover-delta").withDefault(1),lw=re("neutral-fill-input-active-delta").withDefault(0),cw=re("neutral-fill-input-focus-delta").withDefault(-2),ng=re("neutral-fill-input-alt-rest-delta").withDefault(2),lR=re("neutral-fill-input-alt-hover-delta").withDefault(4),cR=re("neutral-fill-input-alt-active-delta").withDefault(6),dR=re("neutral-fill-input-alt-focus-delta").withDefault(2),$s=re("neutral-fill-layer-rest-delta").withDefault(-2),d8=re("neutral-fill-layer-hover-delta").withDefault(-3),u8=re("neutral-fill-layer-active-delta").withDefault(-3),sg=re("neutral-fill-layer-alt-rest-delta").withDefault(-1),h8=re("neutral-fill-secondary-rest-delta").withDefault(3),p8=re("neutral-fill-secondary-hover-delta").withDefault(2),f8=re("neutral-fill-secondary-active-delta").withDefault(1),m8=re("neutral-fill-secondary-focus-delta").withDefault(3),dw=re("neutral-fill-stealth-rest-delta").withDefault(0),uw=re("neutral-fill-stealth-hover-delta").withDefault(3),hw=re("neutral-fill-stealth-active-delta").withDefault(2),pw=re("neutral-fill-stealth-focus-delta").withDefault(0),g8=re("neutral-fill-strong-rest-delta").withDefault(0),fw=re("neutral-fill-strong-hover-delta").withDefault(8),mw=re("neutral-fill-strong-active-delta").withDefault(-5),gw=re("neutral-fill-strong-focus-delta").withDefault(0),vw=re("neutral-stroke-rest-delta").withDefault(8),yw=re("neutral-stroke-hover-delta").withDefault(12),bw=re("neutral-stroke-active-delta").withDefault(6),ww=re("neutral-stroke-focus-delta").withDefault(8),xR=re("neutral-stroke-control-rest-delta").withDefault(3),kR=re("neutral-stroke-control-hover-delta").withDefault(5),SR=re("neutral-stroke-control-active-delta").withDefault(5),_R=re("neutral-stroke-control-focus-delta").withDefault(5),Cw=re("neutral-stroke-divider-rest-delta").withDefault(4),uR=re("neutral-stroke-layer-rest-delta").withDefault(3),v8=re("neutral-stroke-layer-hover-delta").withDefault(3),y8=re("neutral-stroke-layer-active-delta").withDefault(3),b8=re("neutral-stroke-strong-hover-delta").withDefault(0),w8=re("neutral-stroke-strong-active-delta").withDefault(0),C8=re("neutral-stroke-strong-focus-delta").withDefault(0),wh=L("neutral-base-color").withDefault(FA),Ot=re("neutral-palette").withDefault(r=>Oa.from(wh.getValueFor(r))),Ch=L("accent-base-color").withDefault(DA),xw=re("accent-palette").withDefault(r=>Oa.from(Ch.getValueFor(r))),x8=re("neutral-layer-card-container-recipe").withDefault({evaluate:r=>Z1(Ot.getValueFor(r),Oi.getValueFor(r),$s.getValueFor(r))}),JVe=L("neutral-layer-card-container").withDefault(r=>x8.getValueFor(r).evaluate(r)),k8=re("neutral-layer-floating-recipe").withDefault({evaluate:r=>XA(Ot.getValueFor(r),Oi.getValueFor(r),$s.getValueFor(r))}),Un=L("neutral-layer-floating").withDefault(r=>k8.getValueFor(r).evaluate(r)),S8=re("neutral-layer-1-recipe").withDefault({evaluate:r=>JA(Ot.getValueFor(r),Oi.getValueFor(r))}),_8=L("neutral-layer-1").withDefault(r=>S8.getValueFor(r).evaluate(r)),T8=re("neutral-layer-2-recipe").withDefault({evaluate:r=>Z1(Ot.getValueFor(r),Oi.getValueFor(r),$s.getValueFor(r))}),XVe=L("neutral-layer-2").withDefault(r=>T8.getValueFor(r).evaluate(r)),E8=re("neutral-layer-3-recipe").withDefault({evaluate:r=>rR(Ot.getValueFor(r),Oi.getValueFor(r),$s.getValueFor(r))}),eqe=L("neutral-layer-3").withDefault(r=>E8.getValueFor(r).evaluate(r)),I8=re("neutral-layer-4-recipe").withDefault({evaluate:r=>iR(Ot.getValueFor(r),Oi.getValueFor(r),$s.getValueFor(r))}),tqe=L("neutral-layer-4").withDefault(r=>I8.getValueFor(r).evaluate(r)),Ae=L("fill-color").withDefault(r=>_8.getValueFor(r));(function(r){r[r.normal=4.5]="normal",r[r.large=3]="large"})(ug||(ug={}));wg=re("accent-fill-recipe").withDefault({evaluate:(r,e)=>VA(xw.getValueFor(r),e||Ae.getValueFor(r),5,ag.getValueFor(r),lg.getValueFor(r),cg.getValueFor(r),dg.getValueFor(r),void 0,8,ag.getValueFor(r),lg.getValueFor(r),cg.getValueFor(r),dg.getValueFor(r),void 0)}),Ke=L("accent-fill-rest").withDefault(r=>wg.getValueFor(r).evaluate(r).rest),Kr=L("accent-fill-hover").withDefault(r=>wg.getValueFor(r).evaluate(r).hover),Wr=L("accent-fill-active").withDefault(r=>wg.getValueFor(r).evaluate(r).active),nd=L("accent-fill-focus").withDefault(r=>wg.getValueFor(r).evaluate(r).focus),Cg=re("foreground-on-accent-recipe").withDefault({evaluate:r=>W1(Ke.getValueFor(r),Kr.getValueFor(r),Wr.getValueFor(r),nd.getValueFor(r),ug.normal)}),Mo=L("foreground-on-accent-rest").withDefault(r=>Cg.getValueFor(r).evaluate(r).rest),sd=L("foreground-on-accent-hover").withDefault(r=>Cg.getValueFor(r).evaluate(r).hover),ad=L("foreground-on-accent-active").withDefault(r=>Cg.getValueFor(r).evaluate(r).active),TR=L("foreground-on-accent-focus").withDefault(r=>Cg.getValueFor(r).evaluate(r).focus),xg=re("accent-foreground-recipe").withDefault({evaluate:(r,e)=>ql(xw.getValueFor(r),e||Ae.getValueFor(r),9.5,J1.getValueFor(r),X1.getValueFor(r),ew.getValueFor(r),tw.getValueFor(r))}),xh=L("accent-foreground-rest").withDefault(r=>xg.getValueFor(r).evaluate(r).rest),kh=L("accent-foreground-hover").withDefault(r=>xg.getValueFor(r).evaluate(r).hover),Sh=L("accent-foreground-active").withDefault(r=>xg.getValueFor(r).evaluate(r).active),ER=L("accent-foreground-focus").withDefault(r=>xg.getValueFor(r).evaluate(r).focus),kg=re("accent-stroke-control-recipe").withDefault({evaluate:(r,e)=>Y1(Ot.getValueFor(r),e||Ae.getValueFor(r),-3,-3,-3,-3,10,1,void 0,!0)}),Sg=L("accent-stroke-control-rest").withDefault(r=>kg.getValueFor(r).evaluate(r,Ke.getValueFor(r)).rest),_g=L("accent-stroke-control-hover").withDefault(r=>kg.getValueFor(r).evaluate(r,Kr.getValueFor(r)).hover),Tg=L("accent-stroke-control-active").withDefault(r=>kg.getValueFor(r).evaluate(r,Wr.getValueFor(r)).active),IR=L("accent-stroke-control-focus").withDefault(r=>kg.getValueFor(r).evaluate(r,nd.getValueFor(r)).focus),Eg=re("neutral-fill-recipe").withDefault({evaluate:(r,e)=>og(Ot.getValueFor(r),e||Ae.getValueFor(r),rw.getValueFor(r),ow.getValueFor(r),iw.getValueFor(r),nw.getValueFor(r),void 0,2,3,1,2,void 0)}),Fo=L("neutral-fill-rest").withDefault(r=>Eg.getValueFor(r).evaluate(r).rest),kw=L("neutral-fill-hover").withDefault(r=>Eg.getValueFor(r).evaluate(r).hover),Sw=L("neutral-fill-active").withDefault(r=>Eg.getValueFor(r).evaluate(r).active),rqe=L("neutral-fill-focus").withDefault(r=>Eg.getValueFor(r).evaluate(r).focus),Bn=re("neutral-fill-input-recipe").withDefault({evaluate:(r,e)=>og(Ot.getValueFor(r),e||Ae.getValueFor(r),sw.getValueFor(r),aw.getValueFor(r),lw.getValueFor(r),cw.getValueFor(r),void 0,2,3,1,0,void 0)}),_h=L("neutral-fill-input-rest").withDefault(r=>Bn.getValueFor(r).evaluate(r).rest),_w=L("neutral-fill-input-hover").withDefault(r=>Bn.getValueFor(r).evaluate(r).hover),oqe=L("neutral-fill-input-active").withDefault(r=>Bn.getValueFor(r).evaluate(r).active),Tw=L("neutral-fill-input-focus").withDefault(r=>Bn.getValueFor(r).evaluate(r).focus),Ig=re("neutral-fill-input-alt-recipe").withDefault({evaluate:(r,e)=>og(Ot.getValueFor(r),e||Ae.getValueFor(r),ng.getValueFor(r),lR.getValueFor(r),cR.getValueFor(r),dR.getValueFor(r),1,ng.getValueFor(r),ng.getValueFor(r)-lR.getValueFor(r),ng.getValueFor(r)-cR.getValueFor(r),dR.getValueFor(r),1)}),ld=L("neutral-fill-input-alt-rest").withDefault(r=>Ig.getValueFor(r).evaluate(r).rest),cd=L("neutral-fill-input-alt-hover").withDefault(r=>Ig.getValueFor(r).evaluate(r).hover),dd=L("neutral-fill-input-alt-active").withDefault(r=>Ig.getValueFor(r).evaluate(r).active),ud=L("neutral-fill-input-alt-focus").withDefault(r=>Ig.getValueFor(r).evaluate(r).focus),Ms=re("neutral-fill-layer-recipe").withDefault({evaluate:(r,e)=>Rs(Ot.getValueFor(r),e||Ae.getValueFor(r),$s.getValueFor(r),d8.getValueFor(r),u8.getValueFor(r),$s.getValueFor(r),1)}),AR=L("neutral-fill-layer-rest").withDefault(r=>Ms.getValueFor(r).evaluate(r).rest),iqe=L("neutral-fill-layer-hover").withDefault(r=>Ms.getValueFor(r).evaluate(r).hover),nqe=L("neutral-fill-layer-active").withDefault(r=>Ms.getValueFor(r).evaluate(r).active),A8=re("neutral-fill-layer-alt-recipe").withDefault({evaluate:(r,e)=>Rs(Ot.getValueFor(r),e||Ae.getValueFor(r),sg.getValueFor(r),sg.getValueFor(r),sg.getValueFor(r),sg.getValueFor(r))}),RR=L("neutral-fill-layer-alt-rest").withDefault(r=>A8.getValueFor(r).evaluate(r).rest),Fs=re("neutral-fill-secondary-recipe").withDefault({evaluate:(r,e)=>Rs(Ot.getValueFor(r),e||Ae.getValueFor(r),h8.getValueFor(r),p8.getValueFor(r),f8.getValueFor(r),m8.getValueFor(r))}),Mi=L("neutral-fill-secondary-rest").withDefault(r=>Fs.getValueFor(r).evaluate(r).rest),hd=L("neutral-fill-secondary-hover").withDefault(r=>Fs.getValueFor(r).evaluate(r).hover),PR=L("neutral-fill-secondary-active").withDefault(r=>Fs.getValueFor(r).evaluate(r).active),$R=L("neutral-fill-secondary-focus").withDefault(r=>Fs.getValueFor(r).evaluate(r).focus),Qo=re("neutral-fill-stealth-recipe").withDefault({evaluate:(r,e)=>Rs(Ot.getValueFor(r),e||Ae.getValueFor(r),dw.getValueFor(r),uw.getValueFor(r),hw.getValueFor(r),pw.getValueFor(r))}),Ds=L("neutral-fill-stealth-rest").withDefault(r=>Qo.getValueFor(r).evaluate(r).rest),zn=L("neutral-fill-stealth-hover").withDefault(r=>Qo.getValueFor(r).evaluate(r).hover),Vn=L("neutral-fill-stealth-active").withDefault(r=>Qo.getValueFor(r).evaluate(r).active),OR=L("neutral-fill-stealth-focus").withDefault(r=>Qo.getValueFor(r).evaluate(r).focus),Ag=re("neutral-fill-strong-recipe").withDefault({evaluate:(r,e)=>ql(Ot.getValueFor(r),e||Ae.getValueFor(r),4.5,g8.getValueFor(r),fw.getValueFor(r),mw.getValueFor(r),gw.getValueFor(r))}),Rg=L("neutral-fill-strong-rest").withDefault(r=>Ag.getValueFor(r).evaluate(r).rest),MR=L("neutral-fill-strong-hover").withDefault(r=>Ag.getValueFor(r).evaluate(r).hover),FR=L("neutral-fill-strong-active").withDefault(r=>Ag.getValueFor(r).evaluate(r).active),sqe=L("neutral-fill-strong-focus").withDefault(r=>Ag.getValueFor(r).evaluate(r).focus),Pg=re("neutral-foreground-recipe").withDefault({evaluate:(r,e)=>ql(Ot.getValueFor(r),e||Ae.getValueFor(r),16,0,-19,-30,0)}),Fe=L("neutral-foreground-rest").withDefault(r=>Pg.getValueFor(r).evaluate(r).rest),DR=L("neutral-foreground-hover").withDefault(r=>Pg.getValueFor(r).evaluate(r).hover),LR=L("neutral-foreground-active").withDefault(r=>Pg.getValueFor(r).evaluate(r).active),aqe=L("neutral-foreground-focus").withDefault(r=>Pg.getValueFor(r).evaluate(r).focus),pd=re("neutral-foreground-hint-recipe").withDefault({evaluate:(r,e)=>BA(Ot.getValueFor(r),e||Ae.getValueFor(r),4.5)}),qn=L("neutral-foreground-hint").withDefault(r=>pd.getValueFor(r).evaluate(r)),$g=re("neutral-stroke-recipe").withDefault({evaluate:(r,e)=>Rs(Ot.getValueFor(r),e||Ae.getValueFor(r),vw.getValueFor(r),yw.getValueFor(r),bw.getValueFor(r),ww.getValueFor(r))}),Fa=L("neutral-stroke-rest").withDefault(r=>$g.getValueFor(r).evaluate(r).rest),NR=L("neutral-stroke-hover").withDefault(r=>$g.getValueFor(r).evaluate(r).hover),HR=L("neutral-stroke-active").withDefault(r=>$g.getValueFor(r).evaluate(r).active),lqe=L("neutral-stroke-focus").withDefault(r=>$g.getValueFor(r).evaluate(r).focus),Og=re("neutral-stroke-control-recipe").withDefault({evaluate:(r,e)=>Y1(Ot.getValueFor(r),e||Ae.getValueFor(r),xR.getValueFor(r),kR.getValueFor(r),SR.getValueFor(r),_R.getValueFor(r),5)}),fd=L("neutral-stroke-control-rest").withDefault(r=>Og.getValueFor(r).evaluate(r).rest),Mg=L("neutral-stroke-control-hover").withDefault(r=>Og.getValueFor(r).evaluate(r).hover),Fg=L("neutral-stroke-control-active").withDefault(r=>Og.getValueFor(r).evaluate(r).active),cqe=L("neutral-stroke-control-focus").withDefault(r=>Og.getValueFor(r).evaluate(r).focus),R8=re("neutral-stroke-divider-recipe").withDefault({evaluate:(r,e)=>GA(Ot.getValueFor(r),e||Ae.getValueFor(r),Cw.getValueFor(r))}),Gl=L("neutral-stroke-divider-rest").withDefault(r=>R8.getValueFor(r).evaluate(r)),Dg=re("neutral-stroke-input-recipe").withDefault({evaluate:(r,e)=>HA(Ot.getValueFor(r),e||Ae.getValueFor(r),xR.getValueFor(r),kR.getValueFor(r),SR.getValueFor(r),_R.getValueFor(r),20,te.getValueFor(r)+"px")}),Ew=L("neutral-stroke-input-rest").withDefault(r=>Dg.getValueFor(r).evaluate(r).rest),UR=L("neutral-stroke-input-hover").withDefault(r=>Dg.getValueFor(r).evaluate(r).hover),dqe=L("neutral-stroke-input-active").withDefault(r=>Dg.getValueFor(r).evaluate(r).active),uqe=L("neutral-stroke-input-focus").withDefault(r=>Dg.getValueFor(r).evaluate(r).focus),Iw=re("neutral-stroke-layer-recipe").withDefault({evaluate:(r,e)=>Rs(Ot.getValueFor(r),e||Ae.getValueFor(r),uR.getValueFor(r),v8.getValueFor(r),y8.getValueFor(r),uR.getValueFor(r))}),Ls=L("neutral-stroke-layer-rest").withDefault(r=>Iw.getValueFor(r).evaluate(r).rest),hqe=L("neutral-stroke-layer-hover").withDefault(r=>Iw.getValueFor(r).evaluate(r).hover),pqe=L("neutral-stroke-layer-active").withDefault(r=>Iw.getValueFor(r).evaluate(r).active),Lg=re("neutral-stroke-strong-recipe").withDefault({evaluate:(r,e)=>ql(Ot.getValueFor(r),e||Ae.getValueFor(r),5.5,0,b8.getValueFor(r),w8.getValueFor(r),C8.getValueFor(r))}),Fi=L("neutral-stroke-strong-rest").withDefault(r=>Lg.getValueFor(r).evaluate(r).rest),md=L("neutral-stroke-strong-hover").withDefault(r=>Lg.getValueFor(r).evaluate(r).hover),gd=L("neutral-stroke-strong-active").withDefault(r=>Lg.getValueFor(r).evaluate(r).active),fqe=L("neutral-stroke-strong-focus").withDefault(r=>Lg.getValueFor(r).evaluate(r).focus),P8=re("focus-stroke-outer-recipe").withDefault({evaluate:r=>WA(Ot.getValueFor(r),Ae.getValueFor(r))}),vd=L("focus-stroke-outer").withDefault(r=>P8.getValueFor(r).evaluate(r)),$8=re("focus-stroke-inner-recipe").withDefault({evaluate:r=>QA(xw.getValueFor(r),Ae.getValueFor(r),vd.getValueFor(r))}),BR=L("focus-stroke-inner").withDefault(r=>$8.getValueFor(r).evaluate(r)),Ng=re("foreground-on-accent-large-recipe").withDefault({evaluate:r=>W1(Ke.getValueFor(r),Kr.getValueFor(r),Wr.getValueFor(r),nd.getValueFor(r),ug.large)}),mqe=L("foreground-on-accent-rest-large").withDefault(r=>Ng.getValueFor(r).evaluate(r).rest),gqe=L("foreground-on-accent-hover-large").withDefault(r=>Ng.getValueFor(r).evaluate(r,Kr.getValueFor(r)).hover),vqe=L("foreground-on-accent-active-large").withDefault(r=>Ng.getValueFor(r).evaluate(r,Wr.getValueFor(r)).active),yqe=L("foreground-on-accent-focus-large").withDefault(r=>Ng.getValueFor(r).evaluate(r,nd.getValueFor(r)).focus),O8=L("neutral-fill-inverse-rest-delta").withDefault(0),M8=L("neutral-fill-inverse-hover-delta").withDefault(-3),F8=L("neutral-fill-inverse-active-delta").withDefault(7),D8=L("neutral-fill-inverse-focus-delta").withDefault(0);Hg=re("neutral-fill-inverse-recipe").withDefault({evaluate:(r,e)=>L8(Ot.getValueFor(r),e||Ae.getValueFor(r),O8.getValueFor(r),M8.getValueFor(r),F8.getValueFor(r),D8.getValueFor(r))}),bqe=L("neutral-fill-inverse-rest").withDefault(r=>Hg.getValueFor(r).evaluate(r).rest),wqe=L("neutral-fill-inverse-hover").withDefault(r=>Hg.getValueFor(r).evaluate(r).hover),Cqe=L("neutral-fill-inverse-active").withDefault(r=>Hg.getValueFor(r).evaluate(r).active),xqe=L("neutral-fill-inverse-focus").withDefault(r=>Hg.getValueFor(r).evaluate(r).focus)});var Ve,Ug,Aqe,Rqe,Pqe,$qe,Oqe,Mqe,Fqe,Gt=y(()=>{l();c();d();A();Le();Ve=Br`
  font-family: ${ko};
  font-size: ${uh};
  line-height: ${hg};
  font-weight: initial;
  font-variation-settings: ${pR};
`,Ug=Br`
  font-family: ${ko};
  font-size: ${hh};
  line-height: ${id};
  font-weight: initial;
  font-variation-settings: ${fR};
`,Aqe=Br`
  font-family: ${ko};
  font-size: ${ph};
  line-height: ${pg};
  font-weight: initial;
  font-variation-settings: ${mR};
`,Rqe=Br`
  font-family: ${ko};
  font-size: ${fh};
  line-height: ${fg};
  font-weight: initial;
  font-variation-settings: ${gR};
`,Pqe=Br`
  font-family: ${ko};
  font-size: ${mh};
  line-height: ${mg};
  font-weight: initial;
  font-variation-settings: ${vR};
`,$qe=Br`
  font-family: ${ko};
  font-size: ${gh};
  line-height: ${gg};
  font-weight: initial;
  font-variation-settings: ${yR};
`,Oqe=Br`
  font-family: ${ko};
  font-size: ${vh};
  line-height: ${vg};
  font-weight: initial;
  font-variation-settings: ${bR};
`,Mqe=Br`
  font-family: ${ko};
  font-size: ${yh};
  line-height: ${yg};
  font-weight: initial;
  font-variation-settings: ${wR};
`,Fqe=Br`
  font-family: ${ko};
  font-size: ${bh};
  line-height: ${bg};
  font-weight: initial;
  font-variation-settings: ${CR};
`});var zR,VR=y(()=>{l();c();d();A();Q();Le();Gt();zR=(r,e)=>M`
    ${de("flex")} :host {
      box-sizing: border-box;
      flex-direction: column;
      ${Ve}
      color: ${Fe};
      gap: calc(${j} * 1px);
    }
  `});var er,Gn,Qr=y(()=>{l();c();d();A();Le();er=Br`
  outline: calc(${Xt} * 1px) solid ${vd};
  outline-offset: calc(${Xt} * -1px);
`,Gn=Br`
  outline: calc(${Xt} * 1px) solid ${vd};
  outline-offset: calc(${te} * 1px);
`});var Ie,jl=y(()=>{l();c();d();A();Le();Ie=Br`(${Ma} + ${xo}) * ${j}`});var N8,H8,U8,qR,GR=y(()=>{l();c();d();A();Q();we();Le();Qr();Gt();jl();N8=Je.create("neutral-fill-stealth-rest-on-neutral-fill-layer-rest").withDefault(r=>{let e=Ms.getValueFor(r);return Qo.getValueFor(r).evaluate(r,e.evaluate(r).rest).rest}),H8=Je.create("neutral-fill-stealth-hover-on-neutral-fill-layer-rest").withDefault(r=>{let e=Ms.getValueFor(r);return Qo.getValueFor(r).evaluate(r,e.evaluate(r).rest).hover}),U8=Je.create("neutral-fill-stealth-active-on-neutral-fill-layer-rest").withDefault(r=>{let e=Ms.getValueFor(r);return Qo.getValueFor(r).evaluate(r,e.evaluate(r).rest).active}),qR=(r,e)=>M`
    ${de("flex")} :host {
      box-sizing: border-box;
      ${Ve};
      flex-direction: column;
      background: ${AR};
      color: ${Fe};
      border: calc(${te} * 1px) solid ${Ls};
      border-radius: calc(${Oo} * 1px);
    }

    .region {
      display: none;
      padding: calc(${j} * 2 * 1px);
      background: ${RR};
    }

    .heading {
      display: grid;
      position: relative;
      grid-template-columns: auto 1fr auto auto;
      align-items: center;
    }

    .button {
      appearance: none;
      border: none;
      background: none;
      grid-column: 2;
      grid-row: 1;
      outline: none;
      margin: calc(${j} * 3 * 1px) 0;
      padding: 0 calc(${j} * 2 * 1px);
      text-align: left;
      color: inherit;
      cursor: pointer;
      font: inherit;
    }

    .button::before {
      content: '';
      position: absolute;
      top: calc(${te} * -1px);
      left: calc(${te} * -1px);
      right: calc(${te} * -1px);
      bottom: calc(${te} * -1px);
      cursor: pointer;
    }

    .button:${ke}::before {
      ${er}
      border-radius: calc(${Oo} * 1px);
    }

    :host(.expanded) .button:${ke}::before {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    :host(.expanded) .region {
      display: block;
      border-top: calc(${te} * 1px) solid ${Ls};
      border-bottom-left-radius: calc((${Oo} - ${te}) * 1px);
      border-bottom-right-radius: calc((${Oo} - ${te}) * 1px);
    }

    .icon {
      display: flex;
      align-items: center;
      justify-content: center;
      grid-column: 4;
      pointer-events: none;
      background: ${N8};
      border-radius: calc(${$e} * 1px);
      fill: currentcolor;
      width: calc(${Ie} * 1px);
      height: calc(${Ie} * 1px);
      margin: calc(${j} * 2 * 1px);
    }

    .heading:hover .icon {
      background: ${H8};
    }

    .heading:active .icon {
      background: ${U8};
    }

    slot[name='collapsed-icon'] {
      display: flex;
    }

    :host(.expanded) slot[name='collapsed-icon'] {
      display: none;
    }

    slot[name='expanded-icon'] {
      display: none;
    }

    :host(.expanded) slot[name='expanded-icon'] {
      display: flex;
    }

    .start {
      display: flex;
      align-items: center;
      padding-inline-start: calc(${j} * 2 * 1px);
      justify-content: center;
      grid-column: 1;
    }

    .end {
      display: flex;
      align-items: center;
      justify-content: center;
      grid-column: 3;
    }

    .icon,
    .start,
    .end {
      position: relative;
    }
  `.withBehaviors(fe(M`
        .button:${ke}::before {
          outline-color: ${T.Highlight};
        }
        .icon {
          fill: ${T.ButtonText};
        }
      `))});var B8,jR=y(()=>{l();c();d();Q();GR();B8=rn.compose({baseName:"accordion-item",template:MT,styles:qR,collapsedIcon:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `,expandedIcon:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 7.35c.2.2.5.2.7 0L6 4.21l3.15 3.14a.5.5 0 10.7-.7l-3.5-3.5a.5.5 0 00-.7 0l-3.5 3.5a.5.5 0 000 .7z"/>
    </svg>
  `})});var z8,Aw=y(()=>{l();c();d();Q();VR();jR();z8=Bc.compose({baseName:"accordion",template:YT,styles:zR})});var Yo,Rw,Pw=y(()=>{l();c();d();Le();Yo=class{constructor(e,t){this.cache=new WeakMap,this.ltr=e,this.rtl=t}bind(e){this.attach(e)}unbind(e){let t=this.cache.get(e);t&&od.unsubscribe(t)}attach(e){let t=this.cache.get(e)||new Rw(this.ltr,this.rtl,e),o=od.getValueFor(e);od.subscribe(t),t.attach(o),this.cache.set(e,t)}},Rw=class{constructor(e,t,o){this.ltr=e,this.rtl=t,this.source=o,this.attached=null}handleChange({target:e,token:t}){this.attach(t.getValueFor(this.source))}attach(e){this.attached!==this[e]&&(this.attached!==null&&this.source.$fastController.removeStyles(this.attached),this.attached=this[e],this.attached!==null&&this.source.$fastController.addStyles(this.attached))}}});var V8,q8,DGe,Kl,G8,j8,K8,W8,KR,LGe,NGe,HGe,Q8,WR,Y8,Bg,Z8,QR,$w=y(()=>{l();c();d();Q();V8="0 0 2px rgba(0, 0, 0, 0.14)",q8="0 calc(var(--elevation) * 0.5px) calc((var(--elevation) * 1px)) rgba(0, 0, 0, 0.2)",DGe=`box-shadow: ${V8}, ${q8};`,Kl=Je.create({name:"elevation-shadow",cssCustomPropertyName:null}).withDefault({evaluate:(r,e,t)=>{let o=.12,i=.14;e>16&&(o=.2,i=.24);let n=`0 0 2px rgba(0, 0, 0, ${o})`,s=`0 calc(${e} * 0.5px) calc((${e} * 1px)) rgba(0, 0, 0, ${i})`;return`${n}, ${s}`}}),G8=Je.create("elevation-shadow-card-rest-size").withDefault(4),j8=Je.create("elevation-shadow-card-hover-size").withDefault(8),K8=Je.create("elevation-shadow-card-active-size").withDefault(0),W8=Je.create("elevation-shadow-card-focus-size").withDefault(8),KR=Je.create("elevation-shadow-card-rest").withDefault(r=>Kl.getValueFor(r).evaluate(r,G8.getValueFor(r))),LGe=Je.create("elevation-shadow-card-hover").withDefault(r=>Kl.getValueFor(r).evaluate(r,j8.getValueFor(r))),NGe=Je.create("elevation-shadow-card-active").withDefault(r=>Kl.getValueFor(r).evaluate(r,K8.getValueFor(r))),HGe=Je.create("elevation-shadow-card-focus").withDefault(r=>Kl.getValueFor(r).evaluate(r,W8.getValueFor(r))),Q8=Je.create("elevation-shadow-tooltip-size").withDefault(16),WR=Je.create("elevation-shadow-tooltip").withDefault(r=>Kl.getValueFor(r).evaluate(r,Q8.getValueFor(r))),Y8=Je.create("elevation-shadow-flyout-size").withDefault(32),Bg=Je.create("elevation-shadow-flyout").withDefault(r=>Kl.getValueFor(r).evaluate(r,Y8.getValueFor(r))),Z8=Je.create("elevation-shadow-dialog-size").withDefault(128),QR=Je.create("elevation-shadow-dialog").withDefault(r=>Kl.getValueFor(r).evaluate(r,Z8.getValueFor(r)))});var zg,yd,Vg,YR,qg,Gg,bd,ZR=y(()=>{l();c();d();A();we();Q();jl();Le();Gt();Qr();zg=(r,e,t,o="[disabled]")=>M`
    ${de("inline-flex")}
    
    :host {
      position: relative;
      box-sizing: border-box;
      ${Ve}
      height: calc(${Ie} * 1px);
      min-width: calc(${Ie} * 1px);
      color: ${Fe};
      border-radius: calc(${$e} * 1px);
      fill: currentcolor;
    }

    .control {
      border: calc(${te} * 1px) solid transparent;
      flex-grow: 1;
      box-sizing: border-box;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 0 calc((10 + (${j} * 2 * ${xo})) * 1px);
      white-space: nowrap;
      outline: none;
      text-decoration: none;
      color: inherit;
      border-radius: inherit;
      fill: inherit;
      font-family: inherit;
    }

    .control,
    .end,
    .start {
      font: inherit;
    }

    .control.icon-only {
      padding: 0;
      line-height: 0;
    }

    .control:${ke} {
      ${er}
    }

    .control::-moz-focus-inner {
      border: 0;
    }

    .content {
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
      pointer-events: none;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }
  `,yd=(r,e,t,o="[disabled]")=>M`
    .control {
      background: padding-box linear-gradient(${Fo}, ${Fo}),
        border-box ${fd};
    }

    :host(${t}:hover) .control {
      background: padding-box linear-gradient(${kw}, ${kw}),
        border-box ${Mg};
    }

    :host(${t}:active) .control {
      background: padding-box linear-gradient(${Sw}, ${Sw}),
        border-box ${Fg};
    }

    :host(${o}) .control {
      background: padding-box linear-gradient(${Fo}, ${Fo}),
        border-box ${Fa};
    }
  `.withBehaviors(fe(M`
        .control {
          background: ${T.ButtonFace};
          border-color: ${T.ButtonText};
          color: ${T.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          forced-color-adjust: none;
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
          color: ${T.Highlight};
        }

        :host(${o}) .control {
          background: transparent;
          border-color: ${T.GrayText};
          color: ${T.GrayText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
        }

        :host([href]) .control {
          background: transparent;
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${T.CanvasText};
          color: ${T.CanvasText};
        }
    `)),Vg=(r,e,t,o="[disabled]")=>M`
    .control {
      background: padding-box linear-gradient(${Ke}, ${Ke}),
        border-box ${Sg};
      color: ${Mo};
    }

    :host(${t}:hover) .control {
      background: padding-box linear-gradient(${Kr}, ${Kr}),
        border-box ${_g};
      color: ${sd};
    }

    :host(${t}:active) .control {
      background: padding-box linear-gradient(${Wr}, ${Wr}),
        border-box ${Tg};
      color: ${ad};
    }

    :host(${o}) .control {
      background: ${Ke};
    }

    .control:${ke} {
      box-shadow: 0 0 0 calc(${Xt} * 1px) ${BR} inset !important;
    }
  `.withBehaviors(fe(M`
        .control {
          forced-color-adjust: none;
          background: ${T.Highlight};
          color: ${T.HighlightText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
          color: ${T.Highlight};
        }

        :host(${o}) .control {
          background: transparent;
          border-color: ${T.GrayText};
          color: ${T.GrayText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
          box-shadow: 0 0 0 calc(${Xt} * 1px) ${T.HighlightText} inset !important;
        }

        :host([href]) .control {
          background: ${T.LinkText};
          color: ${T.HighlightText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: ${T.ButtonFace};
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }
      `)),YR=(r,e,t,o="[disabled]")=>M`
    :host {
      height: auto;
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      min-width: 0;
    }

    .control {
      display: inline;
      padding: 0;
      border: none;
      box-shadow: none;
      line-height: 1;
    }

    :host(${t}) .control {
      color: ${xh};
      text-decoration: underline 1px;
    }

    :host(${t}:hover) .control {
      color: ${kh};
      text-decoration: none;
    }

    :host(${t}:active) .control {
      color: ${Sh};
      text-decoration: none;
    }

    .control:${ke} {
      ${Gn}
    }
  `.withBehaviors(fe(M`
        :host(${t}) .control {
          color: ${T.LinkText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          color: ${T.CanvasText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
        }
      `)),qg=(r,e,t,o="[disabled]")=>M`
    :host {
      color: ${xh};
    }

    .control {
      background: ${Ds};
    }

    :host(${t}:hover) .control {
      background: ${zn};
      color: ${kh};
    }

    :host(${t}:active) .control {
      background: ${Vn};
      color: ${Sh};
    }

    :host(${o}) .control {
      background: ${Ds};
    }
  `.withBehaviors(fe(M`
        :host {
          color: ${T.ButtonText};
        }

        .control {
          forced-color-adjust: none;
          background: transparent;
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: transparent;
          border-color: ${T.ButtonText};
          color: ${T.ButtonText};
        }

        :host(${o}) .control {
          background: transparent;
          color: ${T.GrayText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
        }

        :host([href]) .control {
          color: ${T.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }
      `)),Gg=(r,e,t,o="[disabled]")=>M`
    .control {
      background: transparent !important;
      border-color: ${Fa};
    }

    :host(${t}:hover) .control {
      border-color: ${NR};
    }

    :host(${t}:active) .control {
      border-color: ${HR};
    }

    :host(${o}) .control {
      background: transparent !important;
      border-color: ${Fa};
    }
  `.withBehaviors(fe(M`
        .control {
          border-color: ${T.ButtonText};
          color: ${T.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
          color: ${T.Highlight};
        }

        :host(${o}) .control {
          border-color: ${T.GrayText};
          color: ${T.GrayText};
        }

        .control:${ke} {
          outline-color: ${T.CanvasText};
        }

        :host([href]) .control {
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${T.CanvasText};
          color: ${T.CanvasText};
        }
      `)),bd=(r,e,t,o="[disabled]")=>M`
    .control {
      background: ${Ds};
    }

    :host(${t}:hover) .control {
      background: ${zn};
    }

    :host(${t}:active) .control {
      background: ${Vn};
    }

    :host(${o}) .control {
      background: ${Ds};
    }
  `.withBehaviors(fe(M`
        .control {
          forced-color-adjust: none;
          background: transparent;
          color: ${T.ButtonText};
        }

        :host(${t}:hover) .control,
        :host(${t}:active) .control {
          background: transparent;
          border-color: ${T.ButtonText};
          color: ${T.ButtonText};
        }

        :host(${o}) .control {
          background: transparent;
          color: ${T.GrayText};
        }
        
        .control:${ke} {
          outline-color: ${T.CanvasText};
        }

        :host([href]) .control {
          color: ${T.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${T.LinkText};
          color: ${T.LinkText};
        }
      `))});var J8,X8,eF,tF,Da,jn,Kn,Di,Li,JR=y(()=>{l();c();d();A();Q();we();Le();Gt();jl();Qr();J8=Je.create("input-placeholder-rest").withDefault(r=>{let e=Bn.getValueFor(r);return pd.getValueFor(r).evaluate(r,e.evaluate(r).rest)}),X8=Je.create("input-placeholder-hover").withDefault(r=>{let e=Bn.getValueFor(r);return pd.getValueFor(r).evaluate(r,e.evaluate(r).hover)}),eF=Je.create("input-filled-placeholder-rest").withDefault(r=>{let e=Fs.getValueFor(r);return pd.getValueFor(r).evaluate(r,e.evaluate(r).rest)}),tF=Je.create("input-filled-placeholder-hover").withDefault(r=>{let e=Fs.getValueFor(r);return pd.getValueFor(r).evaluate(r,e.evaluate(r).hover)}),Da=(r,e,t)=>M`
  :host {
    ${Ve}
    color: ${Fe};
    fill: currentcolor;
    user-select: none;
    position: relative;
  }

  ${t} {
    box-sizing: border-box;
    position: relative;
    color: inherit;
    border: calc(${te} * 1px) solid transparent;
    border-radius: calc(${$e} * 1px);
    height: calc(${Ie} * 1px);
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
  }

  .control {
    width: 100%;
    outline: none;
  }

  .label {
    display: block;
    color: ${Fe};
    cursor: pointer;
    ${Ve}
    margin-bottom: 4px;
  }

  .label__hidden {
    display: none;
    visibility: hidden;
  }

  :host([disabled]) ${t},
  :host([readonly]) ${t},
  :host([disabled]) .label,
  :host([readonly]) .label,
  :host([disabled]) .control,
  :host([readonly]) .control {
    cursor: ${Jt};
  }

  :host([disabled]) {
    opacity: ${Ht};
  }
`,jn=(r,e,t)=>M`
  @media (forced-colors: none) {
    :host(:not([disabled]):active)::after {
      left: 50%;
      width: 40%;
      transform: translateX(-50%);
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    :host(:not([disabled]):focus-within)::after {
      left: 0;
      width: 100%;
      transform: none;
    }

    :host(:not([disabled]):active)::after,
    :host(:not([disabled]):focus-within:not(:active))::after {
      content: '';
      position: absolute;
      height: calc(${Xt} * 1px);
      bottom: 0;
      border-bottom: calc(${Xt} * 1px) solid ${Ke};
      border-bottom-left-radius: calc(${$e} * 1px);
      border-bottom-right-radius: calc(${$e} * 1px);
      z-index: 2;
      transition: all 300ms cubic-bezier(0.1, 0.9, 0.2, 1);
    }
  }
`,Kn=(r,e,t,o=":not([disabled]):not(:focus-within)")=>M`
  ${t} {
    background: padding-box linear-gradient(${_h}, ${_h}),
      border-box ${Ew};
  }

  :host(${o}:hover) ${t} {
    background: padding-box linear-gradient(${_w}, ${_w}),
      border-box ${UR};
  }

  :host(:not([disabled]):focus-within) ${t} {
    background: padding-box linear-gradient(${Tw}, ${Tw}),
      border-box ${Ew};
  }
  
  :host([disabled]) ${t} {
    background: padding-box linear-gradient(${_h}, ${_h}),
      border-box ${Fa};
  }

  .control::placeholder {
    color: ${J8};
  }

  :host(${o}:hover) .control::placeholder {
    color: ${X8};
  }
`,Di=(r,e,t,o=":not([disabled]):not(:focus-within)")=>M`
  ${t} {
    background: ${Mi};
  }

  :host(${o}:hover) ${t} {
    background: ${hd};
  }

  :host(:not([disabled]):focus-within) ${t} {
    background: ${$R};
  }

  :host([disabled]) ${t} {
    background: ${Mi};
  }

  .control::placeholder {
    color: ${eF};
  }

  :host(${o}:hover) .control::placeholder {
    color: ${tF};
  }
`,Li=(r,e,t,o=":not([disabled]):not(:focus-within)")=>M`
  :host {
    color: ${T.ButtonText};
  }

  ${t} {
    background: ${T.ButtonFace};
    border-color: ${T.ButtonText};
  }

  :host(${o}:hover) ${t},
  :host(:not([disabled]):focus-within) ${t} {
    border-color: ${T.Highlight};
  }

  :host([disabled]) ${t} {
    opacity: 1;
    background: ${T.ButtonFace};
    border-color: ${T.GrayText};
  }

  .control::placeholder,
  :host(${o}:hover) .control::placeholder {
    color: ${T.CanvasText};
  }

  :host(:not([disabled]):focus) ${t} {
    ${er}
    outline-color: ${T.Highlight};
  }

  :host([disabled]) {
    opacity: 1;
    color: ${T.GrayText};
  }

  :host([disabled]) ::placeholder,
  :host([disabled]) ::-webkit-input-placeholder {
    color: ${T.GrayText};
  }
`});var XR=y(()=>{l();c();d();ZR();JR();Gt()});var Mt=y(()=>{l();c();d();Pw();$w();Qr();XR();jl()});function bt(r,e){return new Bm("appearance",r,e)}var Ns=y(()=>{l();c();d();Q()});var Wl,e4,t4=y(()=>{l();c();d();Mt();Ns();Wl="[href]",e4=(r,e)=>zg(r,e,Wl).withBehaviors(bt("neutral",yd(r,e,Wl)),bt("accent",Vg(r,e,Wl)),bt("hypertext",YR(r,e,Wl)),bt("lightweight",qg(r,e,Wl)),bt("outline",Gg(r,e,Wl)),bt("stealth",bd(r,e,Wl)))});var jg,rF,Ow=y(()=>{l();c();d();kt();A();Q();t4();jg=class extends no{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){var e,t;let o=this.defaultSlottedContent.filter(i=>i.nodeType===Node.ELEMENT_NODE);o.length===1&&o[0]instanceof SVGElement?(e=this.control)===null||e===void 0||e.classList.add("icon-only"):(t=this.control)===null||t===void 0||t.classList.remove("icon-only")}};J([k],jg.prototype,"appearance",void 0);rF=jg.compose({baseName:"anchor",baseClass:no,template:cm,styles:e4,shadowOptions:{delegatesFocus:!0}})});var r4,o4=y(()=>{l();c();d();A();r4=(r,e)=>M`
  :host {
    contain: layout;
    display: block;
  }
`});var oF,Mw=y(()=>{l();c();d();Q();o4();oF=Me.compose({baseName:"anchored-region",template:EE,styles:r4})});var i4,n4=y(()=>{l();c();d();A();Q();Le();Gt();i4=(r,e)=>M`
    ${de("inline-block")} :host {
      box-sizing: border-box;
      ${Ug};
    }

    .control {
      border-radius: calc(${$e} * 1px);
      padding: calc(((${j} * 0.5) - ${te}) * 1px) calc((${j} - ${te}) * 1px);
      border: calc(${te} * 1px) solid transparent;
    }

    :host(.lightweight) .control {
      background: transparent;
      color: ${Fe};
      font-weight: 600;
    }

    :host(.accent) .control {
      background: ${Ke};
      color: ${Mo};
    }

    :host(.neutral) .control {
      background: ${Mi};
      color: ${Fe};
    }

    :host([circular]) .control {
      border-radius: 100px;
      min-width: calc(${id} - calc(${j} * 1px));
      display: flex;
      align-items: center;
      justify-content: center;
    }
  `});var Kg,iF,Fw=y(()=>{l();c();d();kt();A();Q();n4();Kg=class extends ya{constructor(){super(...arguments),this.appearance="lightweight"}appearanceChanged(e,t){e!==t&&Y.queueUpdate(()=>{this.classList.add(t),this.classList.remove(e)})}};J([k({mode:"fromView"})],Kg.prototype,"appearance",void 0);iF=Kg.compose({baseName:"badge",baseClass:ya,template:DE,styles:i4})});var s4,a4=y(()=>{l();c();d();A();Q();Gt();s4=(r,e)=>M`
  ${de("inline-block")} :host {
    box-sizing: border-box;
    ${Ve};
  }

  .list {
    display: flex;
  }
`});var Dw,Lw=y(()=>{l();c();d();Q();a4();Dw=Gu.compose({baseName:"breadcrumb",template:VE,styles:s4})});var l4,c4=y(()=>{l();c();d();A();Q();we();Le();Gt();Mt();Qr();l4=(r,e)=>M`
    ${de("inline-flex")} :host {
      background: transparent;
      color: ${Fe};
      fill: currentcolor;
      box-sizing: border-box;
      ${Ve};
      min-width: calc(${Ie} * 1px);
      border-radius: calc(${$e} * 1px);
    }

    .listitem {
      display: flex;
      align-items: center;
      border-radius: inherit;
    }

    .control {
      position: relative;
      align-items: center;
      box-sizing: border-box;
      color: inherit;
      fill: inherit;
      cursor: pointer;
      display: flex;
      outline: none;
      text-decoration: none;
      white-space: nowrap;
      border-radius: inherit;
    }

    .control:hover {
      color: ${DR};
    }

    .control:active {
      color: ${LR};
    }

    .control:${ke} {
      ${Gn}
    }

    :host(:not([href])),
    :host([aria-current]) .control {
      color: ${Fe};
      fill: currentcolor;
      cursor: default;
    }

    .start {
      display: flex;
      margin-inline-end: 6px;
    }

    .end {
      display: flex;
      margin-inline-start: 6px;
    }

    .separator {
      display: flex;
    }
  `.withBehaviors(fe(M`
        :host(:not([href])),
        .start,
        .end,
        .separator {
          background: ${T.ButtonFace};
          color: ${T.ButtonText};
          fill: currentcolor;
        }
        .separator {
          fill: ${T.ButtonText};
        }
        :host([href]) {
          forced-color-adjust: none;
          background: ${T.ButtonFace};
          color: ${T.LinkText};
        }
        :host([href]) .control:hover {
          background: ${T.LinkText};
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        .control:${ke} {
          outline-color: ${T.LinkText};
        }
      `))});var Nw,Hw=y(()=>{l();c();d();Q();c4();Nw=Ss.compose({baseName:"breadcrumb-item",template:UE,styles:l4,shadowOptions:{delegatesFocus:!0},separator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>
    </svg>
  `})});var Ql,La,d4,u4=y(()=>{l();c();d();A();Q();Mt();Ns();Le();Ql=":not([disabled])",La="[disabled]",d4=(r,e)=>M`
    :host(${Ql}) .control {
      cursor: pointer;
    }

    :host(${La}) .control {
      cursor: ${Jt};
    }

    @media (forced-colors: none) {
      :host(${La}) .control {
        opacity: ${Ht};
      }
    }

    ${zg(r,e,Ql,La)}
  `.withBehaviors(bt("neutral",yd(r,e,Ql,La)),bt("accent",Vg(r,e,Ql,La)),bt("lightweight",qg(r,e,Ql,La)),bt("outline",Gg(r,e,Ql,La)),bt("stealth",bd(r,e,Ql,La)))});var Wg,Or,Uw=y(()=>{l();c();d();kt();A();Q();u4();Wg=class extends so{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){let e=this.defaultSlottedContent.filter(t=>t.nodeType===Node.ELEMENT_NODE);e.length===1&&e[0]instanceof SVGElement?this.control.classList.add("icon-only"):this.control.classList.remove("icon-only")}};J([k],Wg.prototype,"appearance",void 0);Or=Wg.compose({baseName:"button",baseClass:so,template:KE,styles:d4,shadowOptions:{delegatesFocus:!0}})});var nF,sF,h4,p4=y(()=>{l();c();d();A();Q();we();Le();Mt();Gt();nF=M`
.day.disabled::before {
  transform: translate(-50%, 0) rotate(45deg);
}
`,sF=M`
.day.disabled::before {
  transform: translate(50%, 0) rotate(-45deg);
}
`,h4=(r,e)=>M`
${de("inline-block")} :host {
  --calendar-cell-size: calc((${Ma} + 2 + ${xo}) * ${j} * 1px);
  --calendar-gap: 2px;
  ${Ve}
  color: ${Fe};
}

.title {
  padding: calc(${j} * 2px);
  font-weight: 600;
}

.days {
  text-align: center;
}

.week-days,
.week {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  grid-gap: var(--calendar-gap);
  border: 0;
  padding: 0;
}

.day,
.week-day {
  border: 0;
  width: var(--calendar-cell-size);
  height: var(--calendar-cell-size);
  line-height: var(--calendar-cell-size);
  padding: 0;
  box-sizing: initial;
}

.week-day {
  font-weight: 600;
}

.day {
  border: calc(${te} * 1px) solid transparent;
  border-radius: calc(${$e} * 1px);
}

.interact .day {
  cursor: pointer;
}

.date {
  height: 100%;
}

.inactive .date,
.inactive.disabled::before {
  color: ${qn};
}

.disabled::before {
  content: '';
  display: inline-block;
  width: calc(var(--calendar-cell-size) * .8);
  height: calc(${te} * 1px);
  background: currentColor;
  position: absolute;
  margin-top: calc(var(--calendar-cell-size) / 2);
  transform-origin: center;
  z-index: 1;
}

.selected {
  color: ${Ke};
  border: 1px solid ${Ke};
  background: ${Ae};
}

.selected + .selected {
  border-start-start-radius: 0;
  border-end-start-radius: 0;
  border-inline-start-width: 0;
  padding-inline-start: calc(var(--calendar-gap) + (${te} + ${$e}) * 1px);
  margin-inline-start: calc((${$e} * -1px) - var(--calendar-gap));
}

.today.disabled::before {
  color: ${Mo};
}

.today .date {
  color: ${Mo};
  background: ${Ke};
  border-radius: 50%;
  position: relative;
}
`.withBehaviors(fe(M`
          .day.selected {
              color: ${T.Highlight};
          }

          .today .date {
              background: ${T.Highlight};
              color: ${T.HighlightText};
          }
      `),new Yo(nF,sF))});var Qg,Bw,f4=y(()=>{l();c();d();kt();A();Q();p4();Qg=class extends Ao{constructor(){super(...arguments),this.readonly=!0}};J([k({converter:Cs})],Qg.prototype,"readonly",void 0);Bw=Qg.compose({baseName:"calendar",template:u2,styles:h4,title:d2})});var m4,g4=y(()=>{l();c();d();A();Q();we();Le();Mt();m4=(r,e)=>M`
    ${de("block")} :host {
      display: block;
      contain: content;
      height: var(--card-height, 100%);
      width: var(--card-width, 100%);
      box-sizing: border-box;
      background: ${Ae};
      color: ${Fe};
      border: calc(${te} * 1px) solid ${Ls};
      border-radius: calc(${Oo} * 1px);
      box-shadow: ${KR};
    }

    :host {
      content-visibility: auto;
    }
  `.withBehaviors(fe(M`
        :host {
          background: ${T.Canvas};
          color: ${T.CanvasText};
        }
      `))});var Th,ln,zw=y(()=>{l();c();d();kt();Q();A();As();Le();Pa();tg();g4();Th=class extends Ku{cardFillColorChanged(e,t){if(t){let o=ht(t);o!==null&&(this.neutralPaletteSource=t,Ae.setValueFor(this,Xe.create(o.r,o.g,o.b)))}}neutralPaletteSourceChanged(e,t){if(t){let o=ht(t),i=Xe.create(o.r,o.g,o.b);Ot.setValueFor(this,Oa.create(i))}}handleChange(e,t){this.cardFillColor||Ae.setValueFor(this,o=>Ms.getValueFor(o).evaluate(o,Ae.getValueFor(e)).rest)}connectedCallback(){super.connectedCallback();let e=$l(this);if(e){let t=pe.getNotifier(e);t.subscribe(this,"fillColor"),t.subscribe(this,"neutralPalette"),this.handleChange(e,"fillColor")}}};J([k({attribute:"card-fill-color",mode:"fromView"})],Th.prototype,"cardFillColor",void 0);J([k({attribute:"neutral-palette-source",mode:"fromView"})],Th.prototype,"neutralPaletteSource",void 0);ln=Th.compose({baseName:"card",baseClass:Ku,template:f2,styles:m4})});var v4,y4=y(()=>{l();c();d();A();Q();we();Mt();Le();Gt();Qr();v4=(r,e)=>M`
    ${de("inline-flex")} :host {
      align-items: center;
      outline: none;
      ${""} user-select: none;
    }

    .control {
      position: relative;
      width: calc((${Ie} / 2 + ${j}) * 1px);
      height: calc((${Ie} / 2 + ${j}) * 1px);
      box-sizing: border-box;
      border-radius: calc(${$e} * 1px);
      border: calc(${te} * 1px) solid ${Fi};
      background: ${ld};
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      ${Ve}
      color: ${Fe};
      ${""} padding-inline-start: calc(${j} * 2px + 2px);
      margin-inline-end: calc(${j} * 2px + 2px);
      cursor: pointer;
    }

    slot[name='checked-indicator'],
    slot[name='indeterminate-indicator'] {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      fill: ${Fe};
      opacity: 0;
      pointer-events: none;
    }

    slot[name='indeterminate-indicator'] {
      position: absolute;
      top: 0;
    }

    :host(.checked) slot[name='checked-indicator'],
    :host(.checked) slot[name='indeterminate-indicator'] {
      fill: ${Mo};
    }

    :host(:not(.disabled):hover) .control {
      background: ${cd};
      border-color: ${md};
    }

    :host(:not(.disabled):active) .control {
      background: ${dd};
      border-color: ${gd};
    }

    :host(:${ke}) .control {
      background: ${ud};
      ${Gn}
    }

    :host(.checked) .control {
      background: ${Ke};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .control {
      background: ${Kr};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .control {
      background: ${Wr};
      border-color: transparent;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${Jt};
    }

    :host(.checked:not(.indeterminate)) slot[name='checked-indicator'],
    :host(.indeterminate) slot[name='indeterminate-indicator'] {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${Ht};
    }
  `.withBehaviors(fe(M`
        .control {
          border-color: ${T.FieldText};
          background: ${T.Field};
        }
        :host(:not(.disabled):hover) .control,
        :host(:not(.disabled):active) .control {
          border-color: ${T.Highlight};
          background: ${T.Field};
        }
        slot[name='checked-indicator'],
        slot[name='indeterminate-indicator'] {
          fill: ${T.FieldText};
        }
        :host(:${ke}) .control {
          forced-color-adjust: none;
          outline-color: ${T.FieldText};
          background: ${T.Field};
          border-color: ${T.Highlight};
        }
        :host(.checked) .control {
          background: ${T.Highlight};
          border-color: ${T.Highlight};
        }
        :host(.checked:not(.disabled):hover) .control,
        :host(.checked:not(.disabled):active) .control {
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
        }
        :host(.checked) slot[name='checked-indicator'],
        :host(.checked) slot[name='indeterminate-indicator'] {
          fill: ${T.HighlightText};
        }
        :host(.checked:hover ) .control slot[name='checked-indicator'],
        :host(.checked:hover ) .control slot[name='indeterminate-indicator'] {
          fill: ${T.Highlight};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .control {
          border-color: ${T.GrayText};
          background: ${T.Field};
        }
        :host(.disabled) slot[name='checked-indicator'],
        :host(.checked.disabled:hover) .control slot[name='checked-indicator'],
        :host(.disabled) slot[name='indeterminate-indicator'],
        :host(.checked.disabled:hover) .control slot[name='indeterminate-indicator'] {
          fill: ${T.GrayText};
        }
      `))});var Yl,Vw=y(()=>{l();c();d();Q();y4();Yl=Pl.compose({baseName:"checkbox",template:y2,styles:v4,checkedIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>
    </svg>
  `,indeterminateIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M3 8c0-.28.22-.5.5-.5h9a.5.5 0 010 1h-9A.5.5 0 013 8z"/>
    </svg>
  `})});var b4,Yg,w4,qw,aF,C4,Gw=y(()=>{l();c();d();A();Q();we();$w();jl();Ns();Le();Gt();Qr();Mt();b4=".control",Yg=":not([disabled]):not([open])",w4="[disabled]",qw=(r,e)=>M`
    ${de("inline-flex")}
    
    :host {
      border-radius: calc(${$e} * 1px);
      box-sizing: border-box;
      color: ${Fe};
      fill: currentcolor;
      font-family: ${ko};
      position: relative;
      user-select: none;
      min-width: 250px;
      vertical-align: top;
    }

    .listbox {
      box-shadow: ${Bg};
      background: ${Ae};
      border-radius: calc(${Oo} * 1px);
      box-sizing: border-box;
      display: inline-flex;
      flex-direction: column;
      left: 0;
      max-height: calc(var(--max-height) - (${Ie} * 1px));
      padding: calc((${j} - ${te} ) * 1px);
      overflow-y: auto;
      position: absolute;
      width: 100%;
      z-index: 1;
      margin: 1px 0;
      border: calc(${te} * 1px) solid transparent;
    }

    .listbox[hidden] {
      display: none;
    }

    .control {
      border: calc(${te} * 1px) solid transparent;
      border-radius: calc(${$e} * 1px);
      height: calc(${Ie} * 1px);
      align-items: center;
      box-sizing: border-box;
      cursor: pointer;
      display: flex;
      ${Ve}
      min-height: 100%;
      padding: 0 calc(${j} * 2.25px);
      width: 100%;
    }

    :host(:${ke}) {
      ${er}
    }

    :host([disabled]) .control {
      cursor: ${Jt};
      opacity: ${Ht};
      user-select: none;
    }

    :host([open][position='above']) .listbox {
      bottom: calc((${Ie} + ${j} * 2) * 1px);
    }

    :host([open][position='below']) .listbox {
      top: calc((${Ie} + ${j} * 2) * 1px);
    }

    .selected-value {
      font-family: inherit;
      flex: 1 1 auto;
      text-align: start;
    }

    .indicator {
      flex: 0 0 auto;
      margin-inline-start: 1em;
    }

    slot[name='listbox'] {
      display: none;
      width: 100%;
    }

    :host([open]) slot[name='listbox'] {
      display: flex;
      position: absolute;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }

    .start,
    .end,
    .indicator,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([role='option']) {
      flex: 0 0 auto;
    }
  `,aF=(r,e)=>M`
    :host([open]) .listbox {
      background: ${T.ButtonFace};
      border-color: ${T.CanvasText};
    }
  `,C4=(r,e)=>qw(r,e).withBehaviors(bt("outline",yd(r,e,Yg,w4)),bt("filled",Di(r,e,b4,Yg).withBehaviors(fe(Li(r,e,b4,Yg)))),bt("stealth",bd(r,e,Yg,w4)),fe(aF(r,e)))});var Zg,jw,x4,k4=y(()=>{l();c();d();A();Q();Gw();Ns();Le();Gt();Mt();Zg=".control",jw=":not([disabled]):not([open])",x4=(r,e)=>M`
    ${qw(r,e)}

    ${jn(r,e,Zg)}

    :host(:empty) .listbox {
      display: none;
    }

    :host([disabled]) *,
    :host([disabled]) {
      cursor: ${Jt};
      user-select: none;
    }

    :host(:active) .selected-value {
      user-select: none;
    }

    .selected-value {
      -webkit-appearance: none;
      background: transparent;
      border: none;
      color: inherit;
      ${Ve}
      height: calc(100% - ${te} * 1px));
      margin: auto 0;
      width: 100%;
      outline: none;
    }
  `.withBehaviors(bt("outline",Kn(r,e,Zg,jw)),bt("filled",Di(r,e,Zg,jw)),fe(Li(r,e,Zg,jw)))});var Jg,Eh,Kw=y(()=>{l();c();d();kt();A();Q();Le();k4();Jg=class extends Si{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&Ae.setValueFor(this.listbox,Un)}};J([k({mode:"fromView"})],Jg.prototype,"appearance",void 0);Eh=Jg.compose({baseName:"combobox",baseClass:Si,shadowOptions:{delegatesFocus:!0},template:_2,styles:x4,indicator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `})});var S4,_4=y(()=>{l();c();d();A();S4=(r,e)=>M`
  :host {
    display: flex;
    position: relative;
    flex-direction: column;
  }
`});var T4,E4=y(()=>{l();c();d();A();Q();Le();T4=(r,e)=>M`
    :host {
      display: grid;
      padding: 1px 0;
      box-sizing: border-box;
      width: 100%;
      border-bottom: calc(${te} * 1px) solid ${Gl};
    }

    :host(.header) {
    }

    :host(.sticky-header) {
      background: ${Ae};
      position: sticky;
      top: 0;
    }
  `.withBehaviors(fe(M`
        :host {
        }
      `))});var I4,A4=y(()=>{l();c();d();A();we();Q();Le();Gt();Qr();I4=(r,e)=>M`
    :host {
      padding: calc((${j} + ${Xt} - ${te}) * 1px) calc(((${j} * 3) + ${Xt} - ${te}) * 1px);
      color: ${Fe};
      box-sizing: border-box;
      ${Ve}
      border: transparent calc(${te} * 1px) solid;
      overflow: hidden;
      white-space: nowrap;
      border-radius: calc(${$e} * 1px);
    }

    :host(.column-header) {
      font-weight: 600;
    }

    :host(:${ke}) {
      ${er}
    }
  `.withBehaviors(fe(M`
        :host {
          forced-color-adjust: none;
          background: ${T.Field};
          color: ${T.FieldText};
        }

        :host(:${ke}) {
          outline-color: ${T.FieldText};
        }
      `))});var lF,cF,dF,Ww=y(()=>{l();c();d();Q();_4();E4();A4();lF=jo.compose({baseName:"data-grid-cell",template:l2,styles:I4}),cF=ar.compose({baseName:"data-grid-row",template:s2,styles:T4}),dF=_r.compose({baseName:"data-grid",template:o2,styles:S4})});function Ce(r){return(e,t)=>{e[t+"Changed"]=function(o,i){i!=null?r.setValueFor(this,i):r.deleteValueFor(this)}}}var Qw,R4,ve,uF,Yw=y(()=>{l();c();d();kt();As();A();Q();we();Pa();Le();Qw={toView(r){return r==null?null:r?.toColorString()},fromView(r){if(r==null)return null;let e=ht(r);return e?Xe.create(e.r,e.g,e.b):null}},R4=M`
  :host {
    background-color: ${Ae};
    color: ${Fe};
  }
`.withBehaviors(fe(M`
      :host {
        background-color: ${T.Canvas};
        box-shadow: 0 0 0 1px ${T.CanvasText};
        color: ${T.CanvasText};
      }
    `));ve=class extends G{constructor(){super(),this.noPaint=!1;let e={handleChange:this.noPaintChanged.bind(this)};pe.getNotifier(this).subscribe(e,"fillColor"),pe.getNotifier(this).subscribe(e,"baseLayerLuminance")}connectedCallback(){super.connectedCallback(),this.noPaintChanged()}noPaintChanged(){!this.noPaint&&(this.fillColor!==void 0||this.baseLayerLuminance)?this.$fastController.addStyles(R4):this.$fastController.removeStyles(R4)}};J([k({attribute:"no-paint",mode:"boolean"})],ve.prototype,"noPaint",void 0);J([k({attribute:"fill-color",converter:Qw,mode:"fromView"}),Ce(Ae)],ve.prototype,"fillColor",void 0);J([k({attribute:"accent-base-color",converter:Qw,mode:"fromView"}),Ce(Ch)],ve.prototype,"accentBaseColor",void 0);J([k({attribute:"neutral-base-color",converter:Qw,mode:"fromView"}),Ce(wh)],ve.prototype,"neutralBaseColor",void 0);J([k({converter:se}),Ce(xo)],ve.prototype,"density",void 0);J([k({attribute:"design-unit",converter:se}),Ce(j)],ve.prototype,"designUnit",void 0);J([k({attribute:"direction"}),Ce(od)],ve.prototype,"direction",void 0);J([k({attribute:"base-height-multiplier",converter:se}),Ce(Ma)],ve.prototype,"baseHeightMultiplier",void 0);J([k({attribute:"base-horizontal-spacing-multiplier",converter:se}),Ce(hR)],ve.prototype,"baseHorizontalSpacingMultiplier",void 0);J([k({attribute:"control-corner-radius",converter:se}),Ce($e)],ve.prototype,"controlCornerRadius",void 0);J([k({attribute:"layer-corner-radius",converter:se}),Ce(Oo)],ve.prototype,"layerCornerRadius",void 0);J([k({attribute:"stroke-width",converter:se}),Ce(te)],ve.prototype,"strokeWidth",void 0);J([k({attribute:"focus-stroke-width",converter:se}),Ce(Xt)],ve.prototype,"focusStrokeWidth",void 0);J([k({attribute:"disabled-opacity",converter:se}),Ce(Ht)],ve.prototype,"disabledOpacity",void 0);J([k({attribute:"type-ramp-minus-2-font-size"}),Ce(ph)],ve.prototype,"typeRampMinus2FontSize",void 0);J([k({attribute:"type-ramp-minus-2-line-height"}),Ce(pg)],ve.prototype,"typeRampMinus2LineHeight",void 0);J([k({attribute:"type-ramp-minus-1-font-size"}),Ce(hh)],ve.prototype,"typeRampMinus1FontSize",void 0);J([k({attribute:"type-ramp-minus-1-line-height"}),Ce(id)],ve.prototype,"typeRampMinus1LineHeight",void 0);J([k({attribute:"type-ramp-base-font-size"}),Ce(uh)],ve.prototype,"typeRampBaseFontSize",void 0);J([k({attribute:"type-ramp-base-line-height"}),Ce(hg)],ve.prototype,"typeRampBaseLineHeight",void 0);J([k({attribute:"type-ramp-plus-1-font-size"}),Ce(fh)],ve.prototype,"typeRampPlus1FontSize",void 0);J([k({attribute:"type-ramp-plus-1-line-height"}),Ce(fg)],ve.prototype,"typeRampPlus1LineHeight",void 0);J([k({attribute:"type-ramp-plus-2-font-size"}),Ce(mh)],ve.prototype,"typeRampPlus2FontSize",void 0);J([k({attribute:"type-ramp-plus-2-line-height"}),Ce(mg)],ve.prototype,"typeRampPlus2LineHeight",void 0);J([k({attribute:"type-ramp-plus-3-font-size"}),Ce(gh)],ve.prototype,"typeRampPlus3FontSize",void 0);J([k({attribute:"type-ramp-plus-3-line-height"}),Ce(gg)],ve.prototype,"typeRampPlus3LineHeight",void 0);J([k({attribute:"type-ramp-plus-4-font-size"}),Ce(vh)],ve.prototype,"typeRampPlus4FontSize",void 0);J([k({attribute:"type-ramp-plus-4-line-height"}),Ce(vg)],ve.prototype,"typeRampPlus4LineHeight",void 0);J([k({attribute:"type-ramp-plus-5-font-size"}),Ce(yh)],ve.prototype,"typeRampPlus5FontSize",void 0);J([k({attribute:"type-ramp-plus-5-line-height"}),Ce(yg)],ve.prototype,"typeRampPlus5LineHeight",void 0);J([k({attribute:"type-ramp-plus-6-font-size"}),Ce(bh)],ve.prototype,"typeRampPlus6FontSize",void 0);J([k({attribute:"type-ramp-plus-6-line-height"}),Ce(bg)],ve.prototype,"typeRampPlus6LineHeight",void 0);J([k({attribute:"accent-fill-rest-delta",converter:se}),Ce(ag)],ve.prototype,"accentFillRestDelta",void 0);J([k({attribute:"accent-fill-hover-delta",converter:se}),Ce(lg)],ve.prototype,"accentFillHoverDelta",void 0);J([k({attribute:"accent-fill-active-delta",converter:se}),Ce(cg)],ve.prototype,"accentFillActiveDelta",void 0);J([k({attribute:"accent-fill-focus-delta",converter:se}),Ce(dg)],ve.prototype,"accentFillFocusDelta",void 0);J([k({attribute:"accent-foreground-rest-delta",converter:se}),Ce(J1)],ve.prototype,"accentForegroundRestDelta",void 0);J([k({attribute:"accent-foreground-hover-delta",converter:se}),Ce(X1)],ve.prototype,"accentForegroundHoverDelta",void 0);J([k({attribute:"accent-foreground-active-delta",converter:se}),Ce(ew)],ve.prototype,"accentForegroundActiveDelta",void 0);J([k({attribute:"accent-foreground-focus-delta",converter:se}),Ce(tw)],ve.prototype,"accentForegroundFocusDelta",void 0);J([k({attribute:"neutral-fill-rest-delta",converter:se}),Ce(rw)],ve.prototype,"neutralFillRestDelta",void 0);J([k({attribute:"neutral-fill-hover-delta",converter:se}),Ce(ow)],ve.prototype,"neutralFillHoverDelta",void 0);J([k({attribute:"neutral-fill-active-delta",converter:se}),Ce(iw)],ve.prototype,"neutralFillActiveDelta",void 0);J([k({attribute:"neutral-fill-focus-delta",converter:se}),Ce(nw)],ve.prototype,"neutralFillFocusDelta",void 0);J([k({attribute:"neutral-fill-input-rest-delta",converter:se}),Ce(sw)],ve.prototype,"neutralFillInputRestDelta",void 0);J([k({attribute:"neutral-fill-input-hover-delta",converter:se}),Ce(aw)],ve.prototype,"neutralFillInputHoverDelta",void 0);J([k({attribute:"neutral-fill-input-active-delta",converter:se}),Ce(lw)],ve.prototype,"neutralFillInputActiveDelta",void 0);J([k({attribute:"neutral-fill-input-focus-delta",converter:se}),Ce(cw)],ve.prototype,"neutralFillInputFocusDelta",void 0);J([k({attribute:"neutral-fill-layer-rest-delta",converter:se}),Ce($s)],ve.prototype,"neutralFillLayerRestDelta",void 0);J([k({attribute:"neutral-fill-stealth-rest-delta",converter:se}),Ce(dw)],ve.prototype,"neutralFillStealthRestDelta",void 0);J([k({attribute:"neutral-fill-stealth-hover-delta",converter:se}),Ce(uw)],ve.prototype,"neutralFillStealthHoverDelta",void 0);J([k({attribute:"neutral-fill-stealth-active-delta",converter:se}),Ce(hw)],ve.prototype,"neutralFillStealthActiveDelta",void 0);J([k({attribute:"neutral-fill-stealth-focus-delta",converter:se}),Ce(pw)],ve.prototype,"neutralFillStealthFocusDelta",void 0);J([k({attribute:"neutral-fill-strong-hover-delta",converter:se}),Ce(fw)],ve.prototype,"neutralFillStrongHoverDelta",void 0);J([k({attribute:"neutral-fill-strong-active-delta",converter:se}),Ce(mw)],ve.prototype,"neutralFillStrongActiveDelta",void 0);J([k({attribute:"neutral-fill-strong-focus-delta",converter:se}),Ce(gw)],ve.prototype,"neutralFillStrongFocusDelta",void 0);J([k({attribute:"base-layer-luminance",converter:se}),Ce(Oi)],ve.prototype,"baseLayerLuminance",void 0);J([k({attribute:"neutral-stroke-divider-rest-delta",converter:se}),Ce(Cw)],ve.prototype,"neutralStrokeDividerRestDelta",void 0);J([k({attribute:"neutral-stroke-rest-delta",converter:se}),Ce(vw)],ve.prototype,"neutralStrokeRestDelta",void 0);J([k({attribute:"neutral-stroke-hover-delta",converter:se}),Ce(yw)],ve.prototype,"neutralStrokeHoverDelta",void 0);J([k({attribute:"neutral-stroke-active-delta",converter:se}),Ce(bw)],ve.prototype,"neutralStrokeActiveDelta",void 0);J([k({attribute:"neutral-stroke-focus-delta",converter:se}),Ce(ww)],ve.prototype,"neutralStrokeFocusDelta",void 0);uF=ve.compose({baseName:"design-system-provider",template:O` <slot></slot> `,styles:M`
    ${de("block")}
  `})});var P4,$4=y(()=>{l();c();d();A();Mt();Le();P4=(r,e)=>M`
  :host([hidden]) {
    display: none;
  }

  :host {
    --dialog-height: 480px;
    --dialog-width: 640px;
    display: block;
  }

  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    touch-action: none;
  }

  .positioning-region {
    display: flex;
    justify-content: center;
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    overflow: auto;
  }

  .control {
    box-shadow: ${QR};
    margin-top: auto;
    margin-bottom: auto;
    border-radius: calc(${Oo} * 1px);
    width: var(--dialog-width);
    height: var(--dialog-height);
    background: ${Ae};
    z-index: 1;
    border: calc(${te} * 1px) solid transparent;
  }
`});var Zw,Jw=y(()=>{l();c();d();Q();$4();Zw=Dn.compose({baseName:"dialog",template:O2,styles:P4})});var O4,M4=y(()=>{l();c();d();A();Q();Le();O4=(r,e)=>M`
    ${de("block")} :host {
      box-sizing: content-box;
      height: 0;
      border: none;
      border-top: calc(${te} * 1px) solid ${Gl};
    }

    :host([orientation="vertical"]) {
      border: none;
      height: 100%;
      margin: 0 calc(${j} * 1px);
      border-left: calc(${te} * 1px) solid ${Gl};
  }
  `});var Xw,eC=y(()=>{l();c();d();Q();M4();Xw=ka.compose({baseName:"divider",template:j2,styles:O4})});var F4,D4=y(()=>{l();c();d();A();Q();we();Mt();Le();Qr();F4=(r,e)=>M`
    ${de("inline-flex")} :host {
      height: calc((${Ie} + ${j}) * 1px);
      justify-content: center;
      align-items: center;
      fill: currentcolor;
      color: ${Rg};
      background: padding-box linear-gradient(${Fo}, ${Fo}),
        border-box ${fd};
      box-sizing: border-box;
      border: calc(${te} * 1px) solid transparent;
      border-radius: calc(${$e} * 1px);
      padding: 0;
    }

    :host(.disabled) {
      opacity: ${Ht};
      cursor: ${Jt};
      pointer-events: none;
    }

    .next,
    .previous {
      display: flex;
    }

    :host(:not(.disabled):hover) {
      cursor: pointer;
    }

    :host(:not(.disabled):hover) {
      color: ${MR};
    }

    :host(:not(.disabled):active) {
      color: ${FR};
    }

    :host(:${ke}) {
      ${er}
    }

    :host::-moz-focus-inner {
      border: 0;
    }
  `.withBehaviors(fe(M`
        :host {
          background: ${T.ButtonFace};
          border-color: ${T.ButtonText};
        }
        :host .next,
        :host .previous {
          color: ${T.ButtonText};
          fill: currentcolor;
        }
        :host(:not(.disabled):hover) {
          background: ${T.Highlight};
        }
        :host(:not(.disabled):hover) .next,
        :host(:not(.disabled):hover) .previous {
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled),
        :host(.disabled) .next,
        :host(.disabled) .previous {
          border-color: ${T.GrayText};
          color: ${T.GrayText};
          fill: currentcolor;
        }
        :host(:${ke}) {
          forced-color-adjust: none;
          outline-color: ${T.Highlight};
        }
      `))});var hF,tC=y(()=>{l();c();d();Q();D4();hF=Ml.compose({baseName:"flipper",template:J2,styles:F4,next:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M7.57 11.84A1 1 0 016 11.02V4.98a1 1 0 011.57-.82l3.79 2.62c.85.59.85 1.85 0 2.44l-3.79 2.62z"/>
    </svg>
  `,previous:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M9.43 11.84a1 1 0 001.57-.82V4.98a1 1 0 00-1.57-.82L5.64 6.78c-.85.59-.85 1.85 0 2.44l3.79 2.62z"/>
    </svg>
  `})});var pF,fF,L4,N4,H4=y(()=>{l();c();d();A();Q();Mt();pF=M`
  .scroll-prev {
    right: auto;
    left: 0;
  }

  .scroll.scroll-next::before,
  .scroll-next .scroll-action {
    left: auto;
    right: 0;
  }

  .scroll.scroll-next::before {
    background: linear-gradient(to right, transparent, var(--scroll-fade-next));
  }

  .scroll-next .scroll-action {
    transform: translate(50%, -50%);
  }
`,fF=M`
  .scroll.scroll-next {
    right: auto;
    left: 0;
  }

  .scroll.scroll-next::before {
    background: linear-gradient(to right, var(--scroll-fade-next), transparent);
    left: auto;
    right: 0;
  }

  .scroll.scroll-prev::before {
    background: linear-gradient(to right, transparent, var(--scroll-fade-previous));
  }

  .scroll-prev .scroll-action {
    left: auto;
    right: 0;
    transform: translate(50%, -50%);
  }
`,L4=M`
  .scroll-area {
    position: relative;
  }

  div.scroll-view {
    overflow-x: hidden;
  }

  .scroll {
    bottom: 0;
    pointer-events: none;
    position: absolute;
    right: 0;
    top: 0;
    user-select: none;
    width: 100px;
  }

  .scroll.disabled {
    display: none;
  }

  .scroll::before,
  .scroll-action {
    left: 0;
    position: absolute;
  }

  .scroll::before {
    background: linear-gradient(to right, var(--scroll-fade-previous), transparent);
    content: '';
    display: block;
    height: 100%;
    width: 100%;
  }

  .scroll-action {
    pointer-events: auto;
    right: auto;
    top: 50%;
    transform: translate(-50%, -50%);
  }

  ::slotted(fluent-flipper) {
    opacity: 0;
    transition: opacity 0.2s ease-in-out;
  }

  .scroll-area:hover ::slotted(fluent-flipper) {
    opacity: 1;
  }
`.withBehaviors(new Yo(pF,fF)),N4=(r,e)=>M`
  ${de("block")} :host {
    --scroll-align: center;
    --scroll-item-spacing: 4px;
    contain: layout;
    position: relative;
  }

  .scroll-view {
    overflow-x: auto;
    scrollbar-width: none;
  }

  ::-webkit-scrollbar {
    display: none;
  }

  .content-container {
    align-items: var(--scroll-align);
    display: inline-flex;
    flex-wrap: nowrap;
    position: relative;
  }

  .content-container ::slotted(*) {
    margin-right: var(--scroll-item-spacing);
  }

  .content-container ::slotted(*:last-child) {
    margin-right: 0;
  }
`});var rC,mF,oC=y(()=>{l();c();d();A();Q();H4();rC=class extends _i{connectedCallback(){super.connectedCallback(),this.view!=="mobile"&&this.$fastController.addStyles(L4)}},mF=rC.compose({baseName:"horizontal-scroll",baseClass:_i,template:Z5,styles:N4,nextFlipper:O`
    <fluent-flipper @click="${r=>r.scrollToNext()}" aria-hidden="${r=>r.flippersHiddenFromAT}"></fluent-flipper>
  `,previousFlipper:O`
    <fluent-flipper
      @click="${r=>r.scrollToPrevious()}"
      direction="previous"
      aria-hidden="${r=>r.flippersHiddenFromAT}"
    ></fluent-flipper>
  `})});var U4,B4=y(()=>{l();c();d();A();Q();Le();Qr();U4=(r,e)=>M`
    ${de("inline-flex")} :host {
      border: calc(${te} * 1px) solid ${Fa};
      border-radius: calc(${$e} * 1px);
      box-sizing: border-box;
      flex-direction: column;
      padding: calc(${j} * 1px) 0;
    }

    ::slotted(${r.tagFor(Ko)}) {
      margin: 0 calc(${j} * 1px);
    }

    :host(:focus-within:not([disabled])) {
      ${er}
    }
  `});var iC,nC,sC=y(()=>{l();c();d();Q();B4();iC=class extends lr{},nC=iC.compose({baseName:"listbox",template:a5,styles:U4})});var z4,V4=y(()=>{l();c();d();A();Q();we();jl();Le();Gt();Qr();Pw();z4=(r,e)=>M`
    ${de("inline-flex")} :host {
      position: relative;
      ${Ve}
      background: ${Ds};
      border-radius: calc(${$e} * 1px);
      border: calc(${te} * 1px) solid transparent;
      box-sizing: border-box;
      color: ${Fe};
      cursor: pointer;
      fill: currentcolor;
      height: calc(${Ie} * 1px);
      overflow: hidden;
      align-items: center;
      padding: 0 calc(((${j} * 3) - ${te} - 1) * 1px);
      user-select: none;
      white-space: nowrap;
    }

    :host::before {
      content: '';
      display: block;
      position: absolute;
      left: calc((${Xt} - ${te}) * 1px);
      top: calc((${Ie} / 4) - ${Xt} * 1px);
      width: 3px;
      height: calc((${Ie} / 2) * 1px);
      background: transparent;
      border-radius: calc(${$e} * 1px);
    }

    :host(:not([disabled]):hover) {
      background: ${zn};
    }

    :host(:not([disabled]):active) {
      background: ${Vn};
    }

    :host(:not([disabled]):active)::before {
      background: ${Ke};
      height: calc(((${Ie} / 2) - 6) * 1px);
    }

    :host([aria-selected='true'])::before {
      background: ${Ke};
    }

    :host(:${ke}) {
      ${er}
      background: ${OR};
    }

    :host([aria-selected='true']) {
      background: ${Mi};
    }

    :host(:not([disabled])[aria-selected='true']:hover) {
      background: ${hd};
    }

    :host(:not([disabled])[aria-selected='true']:active) {
      background: ${PR};
    }

    :host(:not([disabled]):not([aria-selected='true']):hover) {
      background: ${zn};
    }

    :host(:not([disabled]):not([aria-selected='true']):active) {
      background: ${Vn};
    }

    :host([disabled]) {
      cursor: ${Jt};
      opacity: ${Ht};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([slot='end']) {
      margin-inline-start: 1ch;
    }

    ::slotted([slot='start']) {
      margin-inline-end: 1ch;
    }
  `.withBehaviors(new Yo(null,M`
      :host::before {
        right: calc((${Xt} - ${te}) * 1px);
      }
    `),fe(M`
        :host {
          background: ${T.ButtonFace};
          border-color: ${T.ButtonFace};
          color: ${T.ButtonText};
        }
        :host(:not([disabled]):not([aria-selected="true"]):hover),
        :host(:not([disabled])[aria-selected="true"]:hover),
        :host([aria-selected="true"]) {
          forced-color-adjust: none;
          background: ${T.Highlight};
          color: ${T.HighlightText};
        }
        :host(:not([disabled]):active)::before,
        :host([aria-selected='true'])::before {
          background: ${T.HighlightText};
        }
        :host([disabled]),
        :host([disabled]:not([aria-selected='true']):hover) {
          background: ${T.Canvas};
          color: ${T.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host(:${ke}) {
          outline-color: ${T.CanvasText};
        }
      `))});var Zl,aC=y(()=>{l();c();d();Q();V4();Zl=Ko.compose({baseName:"option",template:i5,styles:z4})});var q4,G4=y(()=>{l();c();d();A();Q();we();Mt();Le();q4=(r,e)=>M`
    ${de("block")} :host {
      background: ${Un};
      border: calc(${te} * 1px) solid transparent;
      border-radius: calc(${Oo} * 1px);
      box-shadow: ${Bg};
      padding: calc((${j} - ${te}) * 1px) 0;
      max-width: 368px;
      min-width: 64px;
    }

    :host([slot='submenu']) {
      width: max-content;
      margin: 0 calc(${j} * 2px);
    }

    ::slotted(${r.tagFor(Gr)}) {
      margin: 0 calc(${j} * 1px);
    }

    ::slotted(${r.tagFor(ka)}) {
      margin: calc(${j} * 1px) 0;
    }

    ::slotted(hr) {
      box-sizing: content-box;
      height: 0;
      margin: calc(${j} * 1px) 0;
      border: none;
      border-top: calc(${te} * 1px) solid ${Gl};
    }
  `.withBehaviors(fe(M`
        :host([slot='submenu']) {
          background: ${T.Canvas};
          border-color: ${T.CanvasText};
        }
      `))});var lC,Ih,cC=y(()=>{l();c();d();Q();Le();G4();lC=class extends Nl{connectedCallback(){super.connectedCallback(),Ae.setValueFor(this,Un)}},Ih=lC.compose({baseName:"menu",baseClass:Nl,template:C5,styles:q4})});var j4,K4=y(()=>{l();c();d();A();Q();we();Mt();Le();Gt();Qr();j4=(r,e)=>M`
    ${de("grid")} :host {
      contain: layout;
      overflow: visible;
      ${Ve}
      box-sizing: border-box;
      height: calc(${Ie} * 1px);
      grid-template-columns: minmax(32px, auto) 1fr minmax(32px, auto);
      grid-template-rows: auto;
      justify-items: center;
      align-items: center;
      padding: 0;
      white-space: nowrap;
      color: ${Fe};
      fill: currentcolor;
      cursor: pointer;
      border-radius: calc(${$e} * 1px);
      border: calc(${te} * 1px) solid transparent;
      position: relative;
    }

    :host(.indent-0) {
      grid-template-columns: auto 1fr minmax(32px, auto);
    }

    :host(.indent-0) .content {
      grid-column: 1;
      grid-row: 1;
      margin-inline-start: 10px;
    }

    :host(.indent-0) .expand-collapse-glyph-container {
      grid-column: 5;
      grid-row: 1;
    }

    :host(.indent-2) {
      grid-template-columns: minmax(32px, auto) minmax(32px, auto) 1fr minmax(32px, auto) minmax(32px, auto);
    }

    :host(.indent-2) .content {
      grid-column: 3;
      grid-row: 1;
      margin-inline-start: 10px;
    }

    :host(.indent-2) .expand-collapse-glyph-container {
      grid-column: 5;
      grid-row: 1;
    }

    :host(.indent-2) .start {
      grid-column: 2;
    }

    :host(.indent-2) .end {
      grid-column: 4;
    }

    :host(:${ke}) {
      ${er}
    }

    :host(:not([disabled]):hover) {
      background: ${zn};
    }

    :host(:not([disabled]):active),
    :host(.expanded) {
      background: ${Vn};
      color: ${Fe};
      z-index: 2;
    }

    :host([disabled]) {
      cursor: ${Jt};
      opacity: ${Ht};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end {
      display: flex;
      justify-content: center;
    }

    :host(.indent-0[aria-haspopup='menu']) {
      display: grid;
      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);
      align-items: center;
      min-height: 32px;
    }

    :host(.indent-1[aria-haspopup='menu']),
    :host(.indent-1[role='menuitemcheckbox']),
    :host(.indent-1[role='menuitemradio']) {
      display: grid;
      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);
      align-items: center;
      min-height: 32px;
    }

    :host(.indent-2:not([aria-haspopup='menu'])) .end {
      grid-column: 5;
    }

    :host .input-container,
    :host .expand-collapse-glyph-container {
      display: none;
    }

    :host([aria-haspopup='menu']) .expand-collapse-glyph-container,
    :host([role='menuitemcheckbox']) .input-container,
    :host([role='menuitemradio']) .input-container {
      display: grid;
    }

    :host([aria-haspopup='menu']) .content,
    :host([role='menuitemcheckbox']) .content,
    :host([role='menuitemradio']) .content {
      grid-column-start: 3;
    }

    :host([aria-haspopup='menu'].indent-0) .content {
      grid-column-start: 1;
    }

    :host([aria-haspopup='menu']) .end,
    :host([role='menuitemcheckbox']) .end,
    :host([role='menuitemradio']) .end {
      grid-column-start: 4;
    }

    :host .expand-collapse,
    :host .checkbox,
    :host .radio {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      box-sizing: border-box;
    }

    :host .checkbox-indicator,
    :host .radio-indicator,
    slot[name='checkbox-indicator'],
    slot[name='radio-indicator'] {
      display: none;
    }

    ::slotted([slot='end']:not(svg)) {
      margin-inline-end: 10px;
      color: ${qn};
    }

    :host([aria-checked='true']) .checkbox-indicator,
    :host([aria-checked='true']) slot[name='checkbox-indicator'],
    :host([aria-checked='true']) .radio-indicator,
    :host([aria-checked='true']) slot[name='radio-indicator'] {
      display: flex;
    }
  `.withBehaviors(fe(M`
        :host,
        ::slotted([slot='end']:not(svg)) {
          forced-color-adjust: none;
          color: ${T.ButtonText};
          fill: currentcolor;
        }
        :host(:not([disabled]):hover) {
          background: ${T.Highlight};
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        :host(:hover) .start,
        :host(:hover) .end,
        :host(:hover)::slotted(svg),
        :host(:active) .start,
        :host(:active) .end,
        :host(:active)::slotted(svg),
        :host(:hover) ::slotted([slot='end']:not(svg)),
        :host(:${ke}) ::slotted([slot='end']:not(svg)) {
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        :host(.expanded) {
          background: ${T.Highlight};
          color: ${T.HighlightText};
        }
        :host(:${ke}) {
          background: ${T.Highlight};
          outline-color: ${T.ButtonText};
          color: ${T.HighlightText};
          fill: currentcolor;
        }
        :host([disabled]),
        :host([disabled]:hover),
        :host([disabled]:hover) .start,
        :host([disabled]:hover) .end,
        :host([disabled]:hover)::slotted(svg),
        :host([disabled]:${ke}) {
          background: ${T.ButtonFace};
          color: ${T.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host([disabled]:${ke}) {
          outline-color: ${T.GrayText};
        }
        :host .expanded-toggle,
        :host .checkbox,
        :host .radio {
          border-color: ${T.ButtonText};
          background: ${T.HighlightText};
        }
        :host([checked]) .checkbox,
        :host([checked]) .radio {
          background: ${T.HighlightText};
          border-color: ${T.HighlightText};
        }
        :host(:hover) .expanded-toggle,
            :host(:hover) .checkbox,
            :host(:hover) .radio,
            :host(:${ke}) .expanded-toggle,
            :host(:${ke}) .checkbox,
            :host(:${ke}) .radio,
            :host([checked]:hover) .checkbox,
            :host([checked]:hover) .radio,
            :host([checked]:${ke}) .checkbox,
            :host([checked]:${ke}) .radio {
          border-color: ${T.HighlightText};
        }
        :host([aria-checked='true']) {
          background: ${T.Highlight};
          color: ${T.HighlightText};
        }
        :host([aria-checked='true']) .checkbox-indicator,
        :host([aria-checked='true']) ::slotted([slot='checkbox-indicator']),
        :host([aria-checked='true']) ::slotted([slot='radio-indicator']) {
          fill: ${T.Highlight};
        }
        :host([aria-checked='true']) .radio-indicator {
          background: ${T.Highlight};
        }
      `),new Yo(M`
        .expand-collapse-glyph-container {
          transform: rotate(0deg);
        }
      `,M`
        .expand-collapse-glyph-container {
          transform: rotate(180deg);
        }
      `))});var Ah,dC=y(()=>{l();c();d();Q();K4();Ah=Gr.compose({baseName:"menu-item",template:b5,styles:j4,checkboxIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>
    </svg>
  `,expandCollapseGlyph:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <path d="M5.65 3.15a.5.5 0 000 .7L9.79 8l-4.14 4.15a.5.5 0 00.7.7l4.5-4.5a.5.5 0 000-.7l-4.5-4.5a.5.5 0 00-.7 0z"/>
    </svg>
  `,radioIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <circle cx="8" cy="8" r="2"/>
    </svg>
  `})});var Rh,W4,Q4=y(()=>{l();c();d();A();Q();Mt();Ns();Le();Rh=".root",W4=(r,e)=>M`
    ${de("inline-block")}

    ${Da(r,e,Rh)}

    ${jn(r,e,Rh)}

    .root {
      display: flex;
      flex-direction: row;
    }

    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${j} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    .start,
    .end {
      margin: auto;
      fill: currentcolor;
    }

    .start {
      display: flex;
      margin-inline-start: 11px;
    }

    .end {
      display: flex;
      margin-inline-end: 11px;
    }

    .controls {
      opacity: 0;
      position: relative;
      top: -1px;
      z-index: 3;
    }

    :host(:hover:not([disabled])) .controls,
    :host(:focus-within:not([disabled])) .controls {
      opacity: 1;
    }

    .step-up,
    .step-down {
      display: flex;
      padding: 0 8px;
      cursor: pointer;
    }

    .step-up {
      padding-top: 3px;
    }
  `.withBehaviors(bt("outline",Kn(r,e,Rh)),bt("filled",Di(r,e,Rh)),fe(Li(r,e,Rh)))});var Xg,gF,uC=y(()=>{l();c();d();kt();A();Q();Q4();Xg=class extends jr{connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};J([k],Xg.prototype,"appearance",void 0);gF=Xg.compose({baseName:"number-field",baseClass:jr,styles:W4,template:_5,shadowOptions:{delegatesFocus:!0},stepDownGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `,stepUpGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 7.35c.2.2.5.2.7 0L6 4.21l3.15 3.14a.5.5 0 10.7-.7l-3.5-3.5a.5.5 0 00-.7 0l-3.5 3.5a.5.5 0 000 .7z"/>
    </svg>
`})});var Y4,Z4=y(()=>{l();c();d();A();we();Q();Le();Y4=(r,e)=>M`
    ${de("flex")} :host {
      align-items: center;
      height: calc((${te} * 3) * 1px);
    }

    .progress {
      background-color: ${Fi};
      border-radius: calc(${j} * 1px);
      width: 100%;
      height: calc(${te} * 1px);
      display: flex;
      align-items: center;
      position: relative;
    }

    .determinate {
      background-color: ${Ke};
      border-radius: calc(${j} * 1px);
      height: calc((${te} * 3) * 1px);
      transition: all 0.2s ease-in-out;
      display: flex;
    }

    .indeterminate {
      height: calc((${te} * 3) * 1px);
      border-radius: calc(${j} * 1px);
      display: flex;
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .indeterminate-indicator-1 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${Ke};
      border-radius: calc(${j} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 40%;
      animation: indeterminate-1 2s infinite;
    }

    .indeterminate-indicator-2 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${Ke};
      border-radius: calc(${j} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 60%;
      animation: indeterminate-2 2s infinite;
    }

    :host(.paused) .indeterminate-indicator-1,
    :host(.paused) .indeterminate-indicator-2 {
      animation: none;
      background-color: ${qn};
      width: 100%;
      opacity: 1;
    }

    :host(.paused) .determinate {
      background-color: ${qn};
    }

    @keyframes indeterminate-1 {
      0% {
        opacity: 1;
        transform: translateX(-100%);
      }
      70% {
        opacity: 1;
        transform: translateX(300%);
      }
      70.01% {
        opacity: 0;
      }
      100% {
        opacity: 0;
        transform: translateX(300%);
      }
    }

    @keyframes indeterminate-2 {
      0% {
        opacity: 0;
        transform: translateX(-150%);
      }
      29.99% {
        opacity: 0;
      }
      30% {
        opacity: 1;
        transform: translateX(-150%);
      }
      100% {
        transform: translateX(166.66%);
        opacity: 1;
      }
    }
  `.withBehaviors(fe(M`
        .indeterminate-indicator-1,
        .indeterminate-indicator-2,
        .determinate,
        .progress {
          background-color: ${T.ButtonText};
        }
        :host(.paused) .indeterminate-indicator-1,
        :host(.paused) .indeterminate-indicator-2,
        :host(.paused) .determinate {
          background-color: ${T.GrayText};
        }
      `))});var hC,pC,J4=y(()=>{l();c();d();Q();Z4();hC=class extends nn{},pC=hC.compose({baseName:"progress",template:N5,styles:Y4,indeterminateIndicator1:`
    <span class="indeterminate-indicator-1" part="indeterminate-indicator-1"></span>
  `,indeterminateIndicator2:`
    <span class="indeterminate-indicator-2" part="indeterminate-indicator-2"></span>
  `})});var X4,e3=y(()=>{l();c();d();A();we();Q();Mt();Le();X4=(r,e)=>M`
    ${de("flex")} :host {
      align-items: center;
      height: calc(${Ie} * 1px);
      width: calc(${Ie} * 1px);
    }

    .progress {
      height: 100%;
      width: 100%;
    }

    .background {
      fill: none;
      stroke-width: 2px;
    }

    .determinate {
      stroke: ${Ke};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
    }

    .indeterminate-indicator-1 {
      stroke: ${Ke};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
      animation: spin-infinite 2s linear infinite;
    }

    :host(.paused) .indeterminate-indicator-1 {
      animation: none;
      stroke: ${qn};
    }

    :host(.paused) .determinate {
      stroke: ${qn};
    }

    @keyframes spin-infinite {
      0% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(0deg);
      }
      50% {
        stroke-dasharray: 21.99px 21.99px;
        transform: rotate(450deg);
      }
      100% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(1080deg);
      }
    }
  `.withBehaviors(fe(M`
        .background {
          stroke: ${T.Field};
        }
        .determinate,
        .indeterminate-indicator-1 {
          stroke: ${T.ButtonText};
        }
        :host(.paused) .determinate,
        :host(.paused) .indeterminate-indicator-1 {
          stroke: ${T.GrayText};
        }
      `))});var fC,Ph,t3=y(()=>{l();c();d();Q();e3();fC=class extends nn{},Ph=fC.compose({baseName:"progress-ring",template:M5,styles:X4,indeterminateIndicator:`
    <svg class="progress" part="progress" viewBox="0 0 16 16">
        <circle
            class="background"
            part="background"
            cx="8px"
            cy="8px"
            r="7px"
        ></circle>
        <circle
            class="indeterminate-indicator-1"
            part="indeterminate-indicator-1"
            cx="8px"
            cy="8px"
            r="7px"
        ></circle>
    </svg>
  `})});var mC=y(()=>{l();c();d();J4();t3()});var r3,o3=y(()=>{l();c();d();A();we();Q();Mt();Le();Gt();Qr();r3=(r,e)=>M`
    ${de("inline-flex")} :host {
      --input-size: calc((${Ie} / 2) + ${j});
      align-items: center;
      outline: none;
      ${""} user-select: none;
      position: relative;
      flex-direction: row;
      transition: all 0.2s ease-in-out;
    }

    .control {
      position: relative;
      width: calc(var(--input-size) * 1px);
      height: calc(var(--input-size) * 1px);
      box-sizing: border-box;
      border-radius: 50%;
      border: calc(${te} * 1px) solid ${Fi};
      background: ${ld};
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      ${Ve}
      color: ${Fe};
      ${""} padding-inline-start: calc(${j} * 2px + 2px);
      margin-inline-end: calc(${j} * 2px + 2px);
      cursor: pointer;
    }

    .control,
    slot[name='checked-indicator'] {
      flex-shrink: 0;
    }

    slot[name='checked-indicator'] {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      fill: ${Mo};
      opacity: 0;
      pointer-events: none;
    }

    :host(:not(.disabled):hover) .control {
      background: ${cd};
      border-color: ${md};
    }

    :host(:not(.disabled):active) .control {
      background: ${dd};
      border-color: ${gd};
    }

    :host(:not(.disabled):active) slot[name='checked-indicator'] {
      opacity: 1;
    }

    :host(:${ke}) .control {
      ${Gn}
      background: ${ud};
    }

    :host(.checked) .control {
      background: ${Ke};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .control {
      background: ${Kr};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .control {
      background: ${Wr};
      border-color: transparent;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${Jt};
    }

    :host(.checked) slot[name='checked-indicator'] {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${Ht};
    }
  `.withBehaviors(fe(M`
        .control {
          background: ${T.Field};
          border-color: ${T.FieldText};
        }
        :host(:not(.disabled):hover) .control,
        :host(:not(.disabled):active) .control {
          border-color: ${T.Highlight};
        }
        :host(:${ke}) .control {
          forced-color-adjust: none;
          background: ${T.Field};
          outline-color: ${T.FieldText};
        }
        :host(.checked:not(.disabled):hover) .control,
        :host(.checked:not(.disabled):active) .control {
          border-color: ${T.Highlight};
          background: ${T.Highlight};
        }
        :host(.checked) slot[name='checked-indicator'] {
          fill: ${T.Highlight};
        }
        :host(.checked:hover) .control slot[name='checked-indicator'] {
          fill: ${T.HighlightText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .label {
          color: ${T.GrayText};
        }
        :host(.disabled) .control,
        :host(.checked.disabled) .control {
          background: ${T.Field};
          border-color: ${T.GrayText};
        }
        :host(.disabled) slot[name='checked-indicator'],
        :host(.checked.disabled) slot[name='checked-indicator'] {
          fill: ${T.GrayText};
        }
      `))});var vF,gC=y(()=>{l();c();d();Q();o3();vF=Hl.compose({baseName:"radio",template:G5,styles:r3,checkedIndicator:`
    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
      <circle cx="8" cy="8" r="4"/>
    </svg>
  `})});var i3,n3=y(()=>{l();c();d();A();Q();i3=(r,e)=>M`
  ${de("flex")} :host {
    align-items: flex-start;
    flex-direction: column;
  }

  .positioning-region {
    display: flex;
    flex-wrap: wrap;
  }

  :host([orientation='vertical']) .positioning-region {
    flex-direction: column;
  }

  :host([orientation='horizontal']) .positioning-region {
    flex-direction: row;
  }
`});var vC,yC=y(()=>{l();c();d();Q();n3();vC=sn.compose({baseName:"radio-group",template:B5,styles:i3})});var s3,bC=y(()=>{l();c();d();A();Q();s3=(r,e)=>O`
  <template
    class="
            ${t=>t.readOnly?"readonly":""}
        "
  >
    <label
      part="label"
      for="control"
      class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
    >
      <slot ${De({property:"defaultSlottedNodes",filter:th})}></slot>
    </label>
    <div class="root" part="root" ${Ee("root")}>
      ${Ct(r,e)}
      <div class="input-wrapper" part="input-wrapper">
        <input
          class="control"
          part="control"
          id="control"
          @input="${t=>t.handleTextInput()}"
          @change="${t=>t.handleChange()}"
          ?autofocus="${t=>t.autofocus}"
          ?disabled="${t=>t.disabled}"
          list="${t=>t.list}"
          maxlength="${t=>t.maxlength}"
          minlength="${t=>t.minlength}"
          pattern="${t=>t.pattern}"
          placeholder="${t=>t.placeholder}"
          ?readonly="${t=>t.readOnly}"
          ?required="${t=>t.required}"
          size="${t=>t.size}"
          ?spellcheck="${t=>t.spellcheck}"
          :value="${t=>t.value}"
          type="search"
          aria-atomic="${t=>t.ariaAtomic}"
          aria-busy="${t=>t.ariaBusy}"
          aria-controls="${t=>t.ariaControls}"
          aria-current="${t=>t.ariaCurrent}"
          aria-describedby="${t=>t.ariaDescribedby}"
          aria-details="${t=>t.ariaDetails}"
          aria-disabled="${t=>t.ariaDisabled}"
          aria-errormessage="${t=>t.ariaErrormessage}"
          aria-flowto="${t=>t.ariaFlowto}"
          aria-haspopup="${t=>t.ariaHaspopup}"
          aria-hidden="${t=>t.ariaHidden}"
          aria-invalid="${t=>t.ariaInvalid}"
          aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
          aria-label="${t=>t.ariaLabel}"
          aria-labelledby="${t=>t.ariaLabelledby}"
          aria-live="${t=>t.ariaLive}"
          aria-owns="${t=>t.ariaOwns}"
          aria-relevant="${t=>t.ariaRelevant}"
          aria-roledescription="${t=>t.ariaRoledescription}"
          ${Ee("control")}
        />
        <slot name="clear-button">
          <button
            class="clear-button ${t=>t.value?"":"clear-button__hidden"}"
            part="clear-button"
            tabindex="-1"
            @click=${t=>t.handleClearInput()}
          >
            <slot name="clear-glyph">
              <svg width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="m2.09 2.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L6 5.29l3.15-3.14a.5.5 0 1 1 .7.7L6.71 6l3.14 3.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L6 6.71 2.85 9.85a.5.5 0 0 1-.7-.7L5.29 6 2.15 2.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"
                />
              </svg>
            </slot>
          </button>
        </slot>
      </div>
      ${wt(r,e)}
    </div>
  </template>
`});var $h,yF,bF,a3,l3=y(()=>{l();c();d();A();Q();Mt();Ns();Le();Gt();$h=".root",yF=Je.create("clear-button-hover").withDefault(r=>{let e=Qo.getValueFor(r),t=Bn.getValueFor(r);return e.evaluate(r,t.evaluate(r).focus).hover}),bF=Je.create("clear-button-active").withDefault(r=>{let e=Qo.getValueFor(r),t=Bn.getValueFor(r);return e.evaluate(r,t.evaluate(r).focus).active}),a3=(r,e)=>M`
    ${de("inline-block")}

    ${Da(r,e,$h)}

    ${jn(r,e,$h)}

    .root {
      display: flex;
      flex-direction: row;
    }
    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${j} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }
    .clear-button {
      display: inline-flex;
      align-items: center;
      margin: 1px;
      height: calc(100% - 2px);
      opacity: 0;
      background: transparent;
      color: ${Fe};
      fill: currentcolor;
      border: none;
      border-radius: calc(${$e} * 1px);
      min-width: calc(${Ie} * 1px);
      ${Ve}
      outline: none;
      padding: 0 calc((10 + (${j} * 2 * ${xo})) * 1px);
    }
    .clear-button:hover {
      background: ${yF};
    }
    .clear-button:active {
      background: ${bF};
    }
    :host(:hover:not([disabled], [readOnly])) .clear-button,
    :host(:active:not([disabled], [readOnly])) .clear-button,
    :host(:focus-within:not([disabled], [readOnly])) .clear-button {
        opacity: 1;
    }
    :host(:hover:not([disabled], [readOnly])) .clear-button__hidden,
    :host(:active:not([disabled], [readOnly])) .clear-button__hidden,
    :host(:focus-within:not([disabled], [readOnly])) .clear-button__hidden {
        opacity: 0;
    }
    .control::-webkit-search-cancel-button {
      -webkit-appearance: none;
    }
    .input-wrapper {
      display: flex;
      position: relative;
      width: 100%;
    }
    .start,
    .end {
      display: flex;
      margin: 1px;
      align-items: center;
    }
    .start {
      display: flex;
      margin-inline-start: 11px;
    }
    ::slotted([slot="end"]) {
      height: 100%
    }
    .clear-button__hidden {
      opacity: 0;
    }
    .end {
        margin-inline-end: 11px;
    }
    ::slotted(${r.tagFor(so)}) {
      margin-inline-end: 1px;
    }
  `.withBehaviors(bt("outline",Kn(r,e,$h)),bt("filled",Di(r,e,$h)),fe(Li(r,e,$h)))});var ev,wC,CC=y(()=>{l();c();d();kt();A();Q();bC();l3();bC();ev=class extends wo{constructor(){super(...arguments),this.appearance="outline"}};J([k],ev.prototype,"appearance",void 0);wC=ev.compose({baseName:"search",baseClass:wo,template:s3,styles:a3,start:'<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg%22%3E"><path d="M8.5 3a5.5 5.5 0 0 1 4.23 9.02l4.12 4.13a.5.5 0 0 1-.63.76l-.07-.06-4.13-4.12A5.5 5.5 0 1 1 8.5 3Zm0 1a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9Z"/></svg>',shadowOptions:{delegatesFocus:!0}})});var tv,xC,kC=y(()=>{l();c();d();kt();A();Q();Le();Gw();tv=class extends Ti{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&Ae.setValueFor(this.listbox,Un)}};J([k({mode:"fromView"})],tv.prototype,"appearance",void 0);xC=tv.compose({baseName:"select",baseClass:Ti,template:sI,styles:C4,indicator:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>
    </svg>
  `})});var c3,d3=y(()=>{l();c();d();A();Q();we();Le();c3=(r,e)=>M`
    ${de("block")} :host {
      --skeleton-fill-default: ${Mi};
      overflow: hidden;
      width: 100%;
      position: relative;
      background-color: var(--skeleton-fill, var(--skeleton-fill-default));
      --skeleton-animation-gradient-default: linear-gradient(
        270deg,
        var(--skeleton-fill, var(--skeleton-fill-default)) 0%,
        ${hd} 51%,
        var(--skeleton-fill, var(--skeleton-fill-default)) 100%
      );
      --skeleton-animation-timing-default: ease-in-out;
    }

    :host(.rect) {
      border-radius: calc(${$e} * 1px);
    }

    :host(.circle) {
      border-radius: 100%;
      overflow: hidden;
    }

    object {
      position: absolute;
      width: 100%;
      height: auto;
      z-index: 2;
    }

    object img {
      width: 100%;
      height: auto;
    }

    ${de("block")} span.shimmer {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: var(--skeleton-animation-gradient, var(--skeleton-animation-gradient-default));
      background-size: 0px 0px / 90% 100%;
      background-repeat: no-repeat;
      background-color: var(--skeleton-animation-fill, ${Mi});
      animation: shimmer 2s infinite;
      animation-timing-function: var(--skeleton-animation-timing, var(--skeleton-timing-default));
      animation-direction: normal;
      z-index: 1;
    }

    ::slotted(svg) {
      z-index: 2;
    }

    ::slotted(.pattern) {
      width: 100%;
      height: 100%;
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%);
      }
      100% {
        transform: translateX(100%);
      }
    }
  `.withBehaviors(fe(M`
        :host{
          background-color: ${T.CanvasText};
        }
      `))});var Jl,SC=y(()=>{l();c();d();Q();d3();Jl=_a.compose({baseName:"skeleton",template:cI,styles:c3})});var u3,h3=y(()=>{l();c();d();A();we();Q();Mt();Le();u3=(r,e)=>M`
    ${de("inline-grid")} :host {
      --thumb-size: calc((${Ie} / 2) + ${j} + (${te} * 2));
      --thumb-translate: calc(var(--thumb-size) * -0.5 + var(--track-width) / 2);
      --track-overhang: calc((${j} / 2) * -1);
      --track-width: ${j};
      align-items: center;
      width: 100%;
      user-select: none;
      box-sizing: border-box;
      border-radius: calc(${$e} * 1px);
      outline: none;
      cursor: pointer;
    }
    :host(.horizontal) .positioning-region {
      position: relative;
      margin: 0 8px;
      display: grid;
      grid-template-rows: calc(var(--thumb-size) * 1px) 1fr;
    }
    :host(.vertical) .positioning-region {
      position: relative;
      margin: 0 8px;
      display: grid;
      height: 100%;
      grid-template-columns: calc(var(--thumb-size) * 1px) 1fr;
    }
    :host(:${ke}) .thumb-cursor {
      box-shadow: 0 0 0 2px ${Ae}, 0 0 0 4px ${vd};
    }
    .thumb-container {
      position: absolute;
      height: calc(var(--thumb-size) * 1px);
      width: calc(var(--thumb-size) * 1px);
      transition: all 0.2s ease;
    }
    .thumb-cursor {
      display: flex;
      position: relative;
      border: none;
      width: calc(var(--thumb-size) * 1px);
      height: calc(var(--thumb-size) * 1px);
      background: padding-box linear-gradient(${Fo}, ${Fo}),
        border-box ${fd};
      border: calc(${te} * 1px) solid transparent;
      border-radius: 50%;
      box-sizing: border-box;
    }
    .thumb-cursor::after {
      content: '';
      display: block;
      border-radius: 50%;
      width: 100%;
      margin: 4px;
      background: ${Ke};
    }
    :host(:not(.disabled)) .thumb-cursor:hover::after {
      background: ${Kr};
      margin: 3px;
    }
    :host(:not(.disabled)) .thumb-cursor:active::after {
      background: ${Wr};
      margin: 5px;
    }
    :host(:not(.disabled)) .thumb-cursor:hover {
      background: padding-box linear-gradient(${Fo}, ${Fo}),
        border-box ${Mg};
    }
    :host(:not(.disabled)) .thumb-cursor:active {
      background: padding-box linear-gradient(${Fo}, ${Fo}),
        border-box ${Fg};
    }
    .track-start {
      background: ${Ke};
      position: absolute;
      height: 100%;
      left: 0;
      border-radius: calc(${$e} * 1px);
    }
    :host(.horizontal) .thumb-container {
      transform: translateX(calc(var(--thumb-size) * 0.5px)) translateY(calc(var(--thumb-translate) * 1px));
    }
    :host(.vertical) .thumb-container {
      transform: translateX(calc(var(--thumb-translate) * 1px)) translateY(calc(var(--thumb-size) * 0.5px));
    }
    :host(.horizontal) {
      min-width: calc(var(--thumb-size) * 1px);
    }
    :host(.horizontal) .track {
      right: calc(var(--track-overhang) * 1px);
      left: calc(var(--track-overhang) * 1px);
      align-self: start;
      height: calc(var(--track-width) * 1px);
    }
    :host(.vertical) .track {
      top: calc(var(--track-overhang) * 1px);
      bottom: calc(var(--track-overhang) * 1px);
      width: calc(var(--track-width) * 1px);
      height: 100%;
    }
    .track {
      background: ${Rg};
      border: 1px solid ${Fi};
      border-radius: 2px;
      box-sizing: border-box;
      position: absolute;
    }
    :host(.vertical) {
      height: 100%;
      min-height: calc(${j} * 60px);
      min-width: calc(${j} * 20px);
    }
    :host(.vertical) .track-start {
      height: auto;
      width: 100%;
      top: 0;
    }
    :host(.disabled),
    :host(.readonly) {
      cursor: ${Jt};
    }
    :host(.disabled) {
      opacity: ${Ht};
    }
  `.withBehaviors(fe(M`
        .thumb-cursor {
          forced-color-adjust: none;
          border-color: ${T.FieldText};
          background: ${T.FieldText};
        }
        :host(:not(.disabled)) .thumb-cursor:hover,
        :host(:not(.disabled)) .thumb-cursor:active {
          background: ${T.Highlight};
        }
        .track {
          forced-color-adjust: none;
          background: ${T.FieldText};
        }
        .thumb-cursor::after,
        :host(:not(.disabled)) .thumb-cursor:hover::after,
        :host(:not(.disabled)) .thumb-cursor:active::after {
          background: ${T.Field};
        }
        :host(:${ke}) .thumb-cursor {
          background: ${T.Highlight};
          border-color: ${T.Highlight};
          box-shadow: 0 0 0 1px ${T.Field}, 0 0 0 3px ${T.FieldText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .track,
        :host(.disabled) .thumb-cursor {
          forced-color-adjust: none;
          background: ${T.GrayText};
        }
      `))});var wF,_C=y(()=>{l();c();d();Q();h3();wF=Pr.compose({baseName:"slider",template:vI,styles:u3,thumb:`
    <div class="thumb-cursor"></div>
  `})});var p3,f3=y(()=>{l();c();d();A();we();Q();Le();Gt();p3=(r,e)=>M`
    ${de("block")} :host {
      ${Ug}
    }
    .root {
      position: absolute;
      display: grid;
    }
    :host(.horizontal) {
      align-self: start;
      grid-row: 2;
      margin-top: -4px;
    }
    :host(.vertical) {
      justify-self: start;
      grid-column: 2;
      margin-left: 2px;
    }
    .container {
      display: grid;
      justify-self: center;
    }
    :host(.horizontal) .container {
      grid-template-rows: auto auto;
      grid-template-columns: 0;
    }
    :host(.vertical) .container {
      grid-template-columns: auto auto;
      grid-template-rows: 0;
      min-width: calc(var(--thumb-size) * 1px);
      height: calc(var(--thumb-size) * 1px);
    }
    .label {
      justify-self: center;
      align-self: center;
      white-space: nowrap;
      max-width: 30px;
      margin: 2px 0;
    }
    .mark {
      width: calc(${te} * 1px);
      height: calc(${j} * 1px);
      background: ${Fi};
      justify-self: center;
    }
    :host(.vertical) .mark {
      transform: rotate(90deg);
      align-self: center;
    }
    :host(.vertical) .label {
      margin-left: calc((${j} / 2) * 2px);
      align-self: center;
    }
    :host(.disabled) {
      opacity: ${Ht};
    }
  `.withBehaviors(fe(M`
        .mark {
          forced-color-adjust: none;
          background: ${T.FieldText};
        }
        :host(.disabled) {
          forced-color-adjust: none;
          opacity: 1;
        }
        :host(.disabled) .label {
          color: ${T.GrayText};
        }
        :host(.disabled) .mark {
          background: ${T.GrayText};
        }
      `))});var CF,TC=y(()=>{l();c();d();Q();f3();CF=Ei.compose({baseName:"slider-label",template:pI,styles:p3})});var m3,g3=y(()=>{l();c();d();A();we();Q();Mt();Le();Gt();Qr();m3=(r,e)=>M`
    :host([hidden]) {
      display: none;
    }

    ${de("inline-flex")} :host {
      align-items: center;
      outline: none;
      font-family: ${ko};
      ${""} user-select: none;
    }

    :host(.disabled) {
      opacity: ${Ht};
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.disabled) .switch,
    :host(.readonly) .switch,
    :host(.disabled) .status-message,
    :host(.readonly) .status-message {
      cursor: ${Jt};
    }

    .switch {
      position: relative;
      box-sizing: border-box;
      width: calc(((${Ie} / 2) + ${j}) * 2px);
      height: calc(((${Ie} / 2) + ${j}) * 1px);
      background: ${ld};
      border-radius: calc(${Ie} * 1px);
      border: calc(${te} * 1px) solid ${Fi};
      cursor: pointer;
    }

    :host(:not(.disabled):hover) .switch {
      background: ${cd};
      border-color: ${md};
    }

    :host(:not(.disabled):active) .switch {
      background: ${dd};
      border-color: ${gd};
    }

    :host(:${ke}) .switch {
      ${Gn}
      background: ${ud};
    }

    :host(.checked) .switch {
      background: ${Ke};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .switch {
      background: ${Kr};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .switch {
      background: ${Wr};
      border-color: transparent;
    }

    slot[name='switch'] {
      position: absolute;
      display: flex;
      border: 1px solid transparent; /* Spacing included in the transform reference box */
      fill: ${Fe};
      transition: all 0.2s ease-in-out;
    }

    .status-message {
      color: ${Fe};
      cursor: pointer;
      ${Ve}
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      color: ${Fe};
      ${Ve}
      margin-inline-end: calc(${j} * 2px + 2px);
      cursor: pointer;
    }

    ::slotted([slot="checked-message"]),
    ::slotted([slot="unchecked-message"]) {
        margin-inline-start: calc(${j} * 2px + 2px);
    }

    :host(.checked) .switch {
      background: ${Ke};
    }

    :host(.checked) .switch slot[name='switch'] {
      fill: ${Mo};
      filter: drop-shadow(0px 1px 1px rgba(0, 0, 0, 0.15));
    }

    :host(.checked:not(.disabled)) .switch:hover {
      background: ${Kr};
    }

    :host(.checked:not(.disabled)) .switch:hover slot[name='switch'] {
      fill: ${sd};
    }

    :host(.checked:not(.disabled)) .switch:active {
      background: ${Wr};
    }

    :host(.checked:not(.disabled)) .switch:active slot[name='switch'] {
      fill: ${ad};
    }

    .unchecked-message {
      display: block;
    }

    .checked-message {
      display: none;
    }

    :host(.checked) .unchecked-message {
      display: none;
    }

    :host(.checked) .checked-message {
      display: block;
    }
  `.withBehaviors(new Yo(M`
        slot[name='switch'] {
          left: 0;
        }

        :host(.checked) slot[name='switch'] {
          left: 100%;
          transform: translateX(-100%);
        }
      `,M`
        slot[name='switch'] {
          right: 0;
        }

        :host(.checked) slot[name='switch'] {
          right: 100%;
          transform: translateX(100%);
        }
      `),fe(M`
        :host(:not(.disabled)) .switch slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${T.FieldText};
        }
        .switch {
          background: ${T.Field};
          border-color: ${T.FieldText};
        }
        :host(.checked) .switch {
          background: ${T.Highlight};
          border-color: ${T.Highlight};
        }
        :host(:not(.disabled):hover) .switch ,
        :host(:not(.disabled):active) .switch,
        :host(.checked:not(.disabled):hover) .switch {
          background: ${T.HighlightText};
          border-color: ${T.Highlight};
        }
        :host(.checked:not(.disabled)) .switch slot[name="switch"] {
          fill: ${T.HighlightText};
        }
        :host(.checked:not(.disabled):hover) .switch slot[name='switch'] {
          fill: ${T.Highlight};
        }
        :host(:${ke}) .switch {
          forced-color-adjust: none;
          background: ${T.Field}; 
          border-color: ${T.Highlight};
          outline-color: ${T.FieldText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${T.GrayText};
        }
        :host(.disabled) .switch {
          background: ${T.Field};
          border-color: ${T.GrayText};
        }
        .status-message,
        .label {
          color: ${T.FieldText};
        }
      `))});var EC,IC=y(()=>{l();c();d();Q();g3();EC=Kc.compose({baseName:"switch",template:xI,styles:m3,switch:`
    <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
      <rect x="2" y="2" width="12" height="12" rx="6"/>
    </svg>
  `})});var v3,y3=y(()=>{l();c();d();A();we();Q();Le();Mt();Gt();v3=(r,e)=>M`
      ${de("grid")} :host {
        box-sizing: border-box;
        ${Ve}
        color: ${Fe};
        grid-template-columns: auto 1fr auto;
        grid-template-rows: auto 1fr;
      }

      .tablist {
        display: grid;
        grid-template-rows: calc(${Ie} * 1px); auto;
        grid-template-columns: auto;
        position: relative;
        width: max-content;
        align-self: end;
      }

      .start,
      .end {
        align-self: center;
      }

      .activeIndicator {
        grid-row: 2;
        grid-column: 1;
        width: 20px;
        height: 3px;
        border-radius: calc(${$e} * 1px);
        justify-self: center;
        background: ${Ke};
      }

      .activeIndicatorTransition {
        transition: transform 0.2s ease-in-out;
      }

      .tabpanel {
        grid-row: 2;
        grid-column-start: 1;
        grid-column-end: 4;
        position: relative;
      }

      :host(.vertical) {
        grid-template-rows: auto 1fr auto;
        grid-template-columns: auto 1fr;
      }

      :host(.vertical) .tablist {
        grid-row-start: 2;
        grid-row-end: 2;
        display: grid;
        grid-template-rows: auto;
        grid-template-columns: auto 1fr;
        position: relative;
        width: max-content;
        justify-self: end;
        align-self: flex-start;
        width: 100%;
      }

      :host(.vertical) .tabpanel {
        grid-column: 2;
        grid-row-start: 1;
        grid-row-end: 4;
      }

      :host(.vertical) .end {
        grid-row: 3;
      }

      :host(.vertical) .activeIndicator {
        grid-column: 1;
        grid-row: 1;
        width: 3px;
        height: 20px;
        margin-inline-start: calc(${Xt} * 1px);
        border-radius: calc(${$e} * 1px);
        align-self: center;
        background: ${Ke};
      }

      :host(.vertical) .activeIndicatorTransition {
        transition: transform 0.2s linear;
      }
    `.withBehaviors(fe(M`
        .activeIndicator,
        :host(.vertical) .activeIndicator {
          background: ${T.Highlight};
        }
      `))});var b3,w3=y(()=>{l();c();d();A();we();Q();Mt();Le();Gt();Qr();b3=(r,e)=>M`
      ${de("inline-flex")} :host {
        box-sizing: border-box;
        ${Ve}
        height: calc((${Ie} + (${j} * 2)) * 1px);
        padding: 0 calc((6 + (${j} * 2 * ${xo})) * 1px);
        color: ${Fe};
        border-radius: calc(${$e} * 1px);
        border: calc(${te} * 1px) solid transparent;
        align-items: center;
        justify-content: center;
        grid-row: 1 / 3;
        cursor: pointer;
      }

      :host([aria-selected='true']) {
        z-index: 2;
      }

      :host(:hover),
      :host(:active) {
        color: ${Fe};
      }

      :host(:${ke}) {
        ${er}
      }

      :host(.vertical) {
        justify-content: start;
        grid-column: 1 / 3;
      }

      :host(.vertical[aria-selected='true']) {
        z-index: 2;
      }

      :host(.vertical:hover),
      :host(.vertical:active) {
        color: ${Fe};
      }

      :host(.vertical:hover[aria-selected='true']) {
      }
    `.withBehaviors(fe(M`
          :host {
            forced-color-adjust: none;
            border-color: transparent;
            color: ${T.ButtonText};
            fill: currentcolor;
          }
          :host(:hover),
          :host(.vertical:hover),
          :host([aria-selected='true']:hover) {
            background: transparent;
            color: ${T.Highlight};
            fill: currentcolor;
          }
          :host([aria-selected='true']) {
            background: transparent;
            color: ${T.Highlight};
            fill: currentcolor;
          }
          :host(:${ke}) {
            background: transparent;
            outline-color: ${T.ButtonText};
          }
        `))});var AC,C3=y(()=>{l();c();d();Q();w3();AC=ih.compose({baseName:"tab",template:PI,styles:b3})});var x3,k3=y(()=>{l();c();d();A();Q();Le();Gt();x3=(r,e)=>M`
  ${de("block")} :host {
    box-sizing: border-box;
    ${Ve}
    padding: 0 calc((6 + (${j} * 2 * ${xo})) * 1px);
  }
`});var RC,S3=y(()=>{l();c();d();Q();k3();RC=Nm.compose({baseName:"tab-panel",template:EI,styles:x3})});var PC,$C=y(()=>{l();c();d();Q();y3();C3();S3();PC=Ii.compose({baseName:"tabs",template:FI,styles:v3})});var Oh,_3,T3=y(()=>{l();c();d();A();Q();Mt();Ns();Le();Oh=".control",_3=(r,e)=>M`
    ${de("inline-flex")}

    ${Da(r,e,Oh)}

    ${jn(r,e,Oh)}

    :host {
      flex-direction: column;
      vertical-align: bottom;
    }

    .control {
      height: calc((${Ie} * 2) * 1px);
      padding: calc(${j} * 1.5px) calc(${j} * 2px + 1px);
    }

    :host .control {
      resize: none;
    }

    :host(.resize-both) .control {
      resize: both;
    }

    :host(.resize-horizontal) .control {
      resize: horizontal;
    }

    :host(.resize-vertical) .control {
      resize: vertical;
    }

    :host([cols]) {
      width: initial;
    }

    :host([rows]) .control {
      height: initial;
    }
  `.withBehaviors(bt("outline",Kn(r,e,Oh)),bt("filled",Di(r,e,Oh)),fe(Li(r,e,Oh)))});var rv,xF,OC=y(()=>{l();c();d();kt();A();Q();T3();rv=class extends $r{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};J([k],rv.prototype,"appearance",void 0);xF=rv.compose({baseName:"text-area",baseClass:$r,template:zI,styles:_3,shadowOptions:{delegatesFocus:!0}})});var Mh,E3,I3=y(()=>{l();c();d();A();Q();Mt();Ns();Le();Mh=".root",E3=(r,e)=>M`
    ${de("inline-block")}

    ${Da(r,e,Mh)}

    ${jn(r,e,Mh)}

    .root {
      display: flex;
      flex-direction: row;
    }

    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${j} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    .start,
    .end {
      display: flex;
      margin: auto;
    }

    .start {
      display: flex;
      margin-inline-start: 11px;
    }

    .end {
      display: flex;
      margin-inline-end: 11px;
    }
  `.withBehaviors(bt("outline",Kn(r,e,Mh)),bt("filled",Di(r,e,Mh)),fe(Li(r,e,Mh)))});var ov,cn,MC=y(()=>{l();c();d();kt();A();Q();I3();ov=class extends ao{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}};J([k],ov.prototype,"appearance",void 0);cn=ov.compose({baseName:"text-field",baseClass:ao,template:GI,styles:E3,shadowOptions:{delegatesFocus:!0}})});var A3,R3=y(()=>{l();c();d();A();Q();we();Le();Qr();A3=(r,e)=>M`
    ${de("inline-flex")} :host {
      --toolbar-item-gap: calc(${j} * 1px);
      background: ${Ae};
      fill: currentcolor;
      padding: var(--toolbar-item-gap);
      box-sizing: border-box;
      align-items: center;
    }

    :host(${ke}) {
      ${er}
    }

    .positioning-region {
      align-items: center;
      display: inline-flex;
      flex-flow: row wrap;
      justify-content: flex-start;
      flex-grow: 1;
    }

    :host([orientation='vertical']) .positioning-region {
      flex-direction: column;
      align-items: start;
    }

    ::slotted(:not([slot])) {
      flex: 0 0 auto;
      margin: 0 var(--toolbar-item-gap);
    }

    :host([orientation='vertical']) ::slotted(:not([slot])) {
      margin: var(--toolbar-item-gap) 0;
    }

    :host([orientation='vertical']) {
      display: inline-flex;
      flex-direction: column;
    }

    .start,
    .end {
      display: flex;
      align-items: center;
    }

    .end {
      margin-inline-start: auto;
    }

    .start__hidden,
    .end__hidden {
      display: none;
    }

    ::slotted(svg) {
      ${""}
      width: 16px;
      height: 16px;
    }
  `.withBehaviors(fe(M`
        :host(:${ke}) {
          outline-color: ${T.Highlight};
          color: ${T.ButtonText};
          forced-color-adjust: none;
        }
      `))});var FC,kF,DC=y(()=>{l();c();d();Q();R3();FC=class extends an{},kF=FC.compose({baseName:"toolbar",baseClass:an,template:WI,styles:A3})});var P3,$3=y(()=>{l();c();d();A();Q();Mt();Le();Gt();P3=(r,e)=>M`
    :host {
      position: relative;
      contain: layout;
      overflow: visible;
      height: 0;
      width: 0;
      z-index: 10000;
    }

    .tooltip {
      box-sizing: border-box;
      border-radius: calc(${$e} * 1px);
      border: calc(${te} * 1px) solid ${Ls};
      background: ${Ae};
      color: ${Fe};
      padding: 4px 12px;
      height: fit-content;
      width: fit-content;
      ${Ve}
      white-space: nowrap;
      box-shadow: ${WR};
    }

    ${r.tagFor(Me)} {
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: visible;
      flex-direction: row;
    }

    ${r.tagFor(Me)}.right,
    ${r.tagFor(Me)}.left {
      flex-direction: column;
    }

    ${r.tagFor(Me)}.top .tooltip::after,
    ${r.tagFor(Me)}.bottom .tooltip::after,
    ${r.tagFor(Me)}.left .tooltip::after,
    ${r.tagFor(Me)}.right .tooltip::after {
      content: '';
      width: 12px;
      height: 12px;
      background: ${Ae};
      border-top: calc(${te} * 1px) solid ${Ls};
      border-left: calc(${te} * 1px) solid ${Ls};
      position: absolute;
    }

    ${r.tagFor(Me)}.top .tooltip::after {
      transform: translateX(-50%) rotate(225deg);
      bottom: 5px;
      left: 50%;
    }

    ${r.tagFor(Me)}.top .tooltip {
      margin-bottom: 12px;
    }

    ${r.tagFor(Me)}.bottom .tooltip::after {
      transform: translateX(-50%) rotate(45deg);
      top: 5px;
      left: 50%;
    }

    ${r.tagFor(Me)}.bottom .tooltip {
      margin-top: 12px;
    }

    ${r.tagFor(Me)}.left .tooltip::after {
      transform: translateY(-50%) rotate(135deg);
      top: 50%;
      right: 5px;
    }

    ${r.tagFor(Me)}.left .tooltip {
      margin-right: 12px;
    }

    ${r.tagFor(Me)}.right .tooltip::after {
      transform: translateY(-50%) rotate(-45deg);
      top: 50%;
      left: 5px;
    }

    ${r.tagFor(Me)}.right .tooltip {
      margin-left: 12px;
    }
  `.withBehaviors(fe(M`
        :host([disabled]) {
          opacity: 1;
        }
        ${r.tagFor(Me)}.top .tooltip::after,
        ${r.tagFor(Me)}.bottom .tooltip::after,
        ${r.tagFor(Me)}.left .tooltip::after,
        ${r.tagFor(Me)}.right .tooltip::after {
          content: '';
          width: unset;
          height: unset;
        }
      `))});var LC,NC,HC=y(()=>{l();c();d();Q();Le();$3();LC=class extends Yt{connectedCallback(){super.connectedCallback(),Ae.setValueFor(this,Un)}},NC=LC.compose({baseName:"tooltip",baseClass:Yt,template:tA,styles:P3})});var O3,M3=y(()=>{l();c();d();A();Q();O3=(r,e)=>M`
  :host([hidden]) {
    display: none;
  }

  ${de("flex")} :host {
    flex-direction: column;
    align-items: stretch;
    min-width: fit-content;
    font-size: 0;
  }
`});var UC,BC=y(()=>{l();c();d();Q();M3();UC=Ul.compose({baseName:"tree-view",template:cA,styles:O3})});var SF,_F,F3,TF,EF,D3,L3=y(()=>{l();c();d();A();Q();we();Mt();Le();Gt();Qr();SF=M`
  .expand-collapse-button svg {
    transform: rotate(0deg);
  }
  :host(.nested) .expand-collapse-button {
    left: var(--expand-collapse-button-nested-width, calc(${Ie} * -1px));
  }
  :host([selected])::after {
    left: calc(${Xt} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,_F=M`
  .expand-collapse-button svg {
    transform: rotate(180deg);
  }
  :host(.nested) .expand-collapse-button {
    right: var(--expand-collapse-button-nested-width, calc(${Ie} * -1px));
  }
  :host([selected])::after {
    right: calc(${Xt} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,F3=Br`((${Ma} / 2) * ${j}) + ((${j} * ${xo}) / 2)`,TF=Je.create("tree-item-expand-collapse-hover").withDefault(r=>{let e=Qo.getValueFor(r);return e.evaluate(r,e.evaluate(r).hover).hover}),EF=Je.create("tree-item-expand-collapse-selected-hover").withDefault(r=>{let e=Fs.getValueFor(r);return Qo.getValueFor(r).evaluate(r,e.evaluate(r).rest).hover}),D3=(r,e)=>M`
    ${de("block")} :host {
      contain: content;
      position: relative;
      outline: none;
      color: ${Fe};
      fill: currentcolor;
      cursor: pointer;
      font-family: ${ko};
      --expand-collapse-button-size: calc(${Ie} * 1px);
      --tree-item-nested-width: 0;
    }

    .positioning-region {
      display: flex;
      position: relative;
      box-sizing: border-box;
      background: ${Ds};
      border: calc(${te} * 1px) solid transparent;
      border-radius: calc(${$e} * 1px);
      height: calc((${Ie} + 1) * 1px);
    }

    :host(:${ke}) .positioning-region {
      ${er}
    }

    .positioning-region::before {
      content: '';
      display: block;
      width: var(--tree-item-nested-width);
      flex-shrink: 0;
    }

    :host(:not([disabled])) .positioning-region:hover {
      background: ${zn};
    }

    :host(:not([disabled])) .positioning-region:active {
      background: ${Vn};
    }

    .content-region {
      display: inline-flex;
      align-items: center;
      white-space: nowrap;
      width: 100%;
      height: calc(${Ie} * 1px);
      margin-inline-start: calc(${j} * 2px + 8px);
      ${Ve}
    }

    .items {
      display: none;
      ${""} font-size: calc(1em + (${j} + 16) * 1px);
    }

    .expand-collapse-button {
      background: none;
      border: none;
      border-radius: calc(${$e} * 1px);
      ${""} width: calc((${F3} + (${j} * 2)) * 1px);
      height: calc((${F3} + (${j} * 2)) * 1px);
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      margin: 0 6px;
    }

    .expand-collapse-button svg {
      transition: transform 0.1s linear;
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
    }

    .start {
      ${""} margin-inline-end: calc(${j} * 2px + 2px);
    }

    .end {
      ${""} margin-inline-start: calc(${j} * 2px + 2px);
    }

    :host(.expanded) > .items {
      display: block;
    }

    :host([disabled]) {
      opacity: ${Ht};
      cursor: ${Jt};
    }

    :host(.nested) .content-region {
      position: relative;
      margin-inline-start: var(--expand-collapse-button-size);
    }

    :host(.nested) .expand-collapse-button {
      position: absolute;
    }

    :host(.nested) .expand-collapse-button:hover {
      background: ${TF};
    }

    :host(:not([disabled])[selected]) .positioning-region {
      background: ${Mi};
    }

    :host(:not([disabled])[selected]) .expand-collapse-button:hover {
      background: ${EF};
    }

    :host([selected])::after {
      content: '';
      display: block;
      position: absolute;
      top: calc((${Ie} / 4) * 1px);
      width: 3px;
      height: calc((${Ie} / 2) * 1px);
      ${""} background: ${Ke};
      border-radius: calc(${$e} * 1px);
    }

    ::slotted(fluent-tree-item) {
      --tree-item-nested-width: 1em;
      --expand-collapse-button-nested-width: calc(${Ie} * -1px);
    }
  `.withBehaviors(new Yo(SF,_F),fe(M`
        :host {
          color: ${T.ButtonText};
        }
        .positioning-region {
          border-color: ${T.ButtonFace};
          background: ${T.ButtonFace};
        }
        :host(:not([disabled])) .positioning-region:hover,
        :host(:not([disabled])) .positioning-region:active,
        :host(:not([disabled])[selected]) .positioning-region {
          background: ${T.Highlight};
        }
        :host .positioning-region:hover .content-region,
        :host([selected]) .positioning-region .content-region {
          forced-color-adjust: none;
          color: ${T.HighlightText};
        }
        :host([disabled][selected]) .positioning-region .content-region {
          color: ${T.GrayText};
        }
        :host([selected])::after {
          background: ${T.HighlightText};
        }
        :host(:${ke}) .positioning-region {
          forced-color-adjust: none;
          outline-color: ${T.ButtonFace};
        }
        :host([disabled]),
        :host([disabled]) .content-region,
        :host([disabled]) .positioning-region:hover .content-region {
          opacity: 1;
          color: ${T.GrayText};
        }
        :host(.nested) .expand-collapse-button:hover,
        :host(:not([disabled])[selected]) .expand-collapse-button:hover {
          background: ${T.ButtonFace};
          fill: ${T.ButtonText};
        }
      `))});var zC,VC=y(()=>{l();c();d();Q();L3();zC=Zt.compose({baseName:"tree-item",template:sA,styles:D3,expandCollapseGlyph:`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>
    </svg>
  `})});var N3=y(()=>{l();c();d();Aw();Ow();Mw();Fw();Lw();Hw();Uw();f4();zw();Vw();Kw();Ww();Yw();Jw();eC();tC();oC();sC();aC();cC();dC();uC();mC();gC();yC();CC();kC();SC();_C();TC();IC();$C();OC();MC();DC();HC();BC();VC()});function H3(r){return a1.getOrCreate(r).withPrefix("fluent")}var U3=y(()=>{l();c();d();Q()});var cr=y(()=>{l();c();d();N3();U3();Aw();Ow();Mw();Fw();Lw();Hw();Uw();zw();Vw();Kw();Ww();Yw();Jw();eC();tC();oC();sC();aC();cC();dC();uC();mC();gC();yC();CC();kC();SC();_C();TC();IC();$C();OC();MC();DC();HC();VC();BC();Le();Mt();tg();Pa();Xc();ig()});var iv,nv,wd,qC=y(()=>{l();c();d();iv={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},nv=r=>(...e)=>({_$litDirective$:r,values:e}),wd=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,o){this._$Ct=e,this._$AM=t,this._$Ci=o}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}});var ze,B3=y(()=>{l();c();d();Cc();qC();ze=nv(class extends wd{constructor(r){if(super(r),r.type!==iv.ATTRIBUTE||r.name!=="class"||r.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(r){return" "+Object.keys(r).filter(e=>r[e]).join(" ")+" "}update(r,[e]){if(this.st===void 0){this.st=new Set,r.strings!==void 0&&(this.nt=new Set(r.strings.join(" ").split(/\s/).filter(o=>o!=="")));for(let o in e)e[o]&&!this.nt?.has(o)&&this.st.add(o);return this.render(e)}let t=r.element.classList;for(let o of this.st)o in e||(t.remove(o),this.st.delete(o));for(let o in e){let i=!!e[o];i===this.st.has(o)||this.nt?.has(o)||(i?(t.add(o),this.st.add(o)):(t.remove(o),this.st.delete(o)))}return is}})});var pi=y(()=>{l();c();d();B3()});var Zo,z3=y(()=>{l();c();d();Cc();Zo=r=>r??br});var Cd=y(()=>{l();c();d();z3()});var sv,V3,av=y(()=>{l();c();d();sv=r=>"personType"in r||"userType"in r,V3=r=>"initials"in r});var Hs,q3,IF,Na,lv,cv,dv,Fh,xd,kd,uv,G3,hv,Jo=y(()=>{l();c();d();ge();Hs=r=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate());if(r>=t)return r.toLocaleString("default",{hour:"numeric",minute:"numeric"});let o=new Date(t);if(o.setDate(e.getDate()-e.getDay()),r>=o)return r.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});let i=new Date(o);return i.setDate(o.getDate()-7),r>=i?r.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):r.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},q3=r=>{let e=r.getMonth(),t=r.getDate();return`${IF(e)} ${t}`},IF=r=>{switch(r){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}},Na=(r,e)=>{let t;return function(){let o=()=>r.apply(this,arguments);window.clearTimeout(t),t=window.setTimeout(o,e)}},lv=r=>new Promise((e,t)=>{let o=new FileReader;o.onerror=t,o.onload=()=>{e(o.result)},o.readAsDataURL(r)}),cv=r=>r.startsWith("[")?r.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():r,dv=r=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(r),Fh=(r,e=2)=>{if(r===0)return"0 Bytes";let t=1024,o=e<0?0:e,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(r)/Math.log(t));return`${parseFloat((r/Math.pow(t,n)).toFixed(o))} ${i[n]}`},xd=r=>(r&&(r=r?.replace(/<ddd\/>/gi,"..."),r=r?.replace(/<c0>/gi,"<b>"),r=r?.replace(/<\/c0>/gi,"</b>")),r),kd=r=>r?.replace(/\.[^/.]+$/,""),uv=r=>new URL(r).pathname.split("/").pop().replace(/-/g," "),G3=r=>r||W.config.response.invalidationPeriod||W.config.defaultInvalidationPeriod,hv=()=>W.config.response.isEnabled&&W.config.isEnabled});var H,Ni=y(()=>{l();c();d();H={presence:{name:"presence",stores:{presence:"presence"},version:2},users:{name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters",cardState:"cardState"},version:5},photos:{name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups",teams:"teams"},version:2},people:{name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:4},groups:{name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:6},get:{name:"responses",stores:{responses:"responses"},version:2},search:{name:"search",stores:{responses:"responses"},version:3},files:{name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:2},fileLists:{name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:2}}});var pv,AF,RF,j3,PF,$F,K3,fv,Us,W3,OF,Ha,mv,Do,GC,Q3,Bs=y(()=>{l();c();d();ge();Jo();Ni();pv=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},AF=["any","person","group"],RF=r=>typeof r=="string"&&AF.includes(r),j3=(r,e="any")=>RF(r)?r:e,PF=["any","user","contact"],$F=r=>typeof r=="string"&&PF.includes(r),K3=(r,e="any")=>$F(r)?r:e,fv=()=>W.config.people.invalidationPeriod||W.config.defaultInvalidationPeriod,Us=()=>W.config.people.isEnabled&&W.config.isEnabled,W3=["People.Read","People.Read.All"],OF=["Contacts.Read","Contacts.ReadWrite"],Ha=(r,e,t=10,o="any",i="")=>pv(void 0,void 0,void 0,function*(){let n=`${e}:${t}:${o}`,s;if(Us()){let h=H.people,p=H.people.stores.peopleQuery;s=W.getCache(h,p);let f=Us()?yield s.getValue(n):null;if(f&&fv()>Date.now()-f.timeCached)return f.results.map(b=>JSON.parse(b))}let a="personType/class eq 'Person'";o!=="any"&&(o==="user"?a+="and personType/subclass eq 'OrganizationUser'":a+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),i!==""&&(a+=` and  ${i}`);let u;try{let h=r.api("/me/people").search('"'+e+'"').top(t).filter(a).middlewareOptions(be(W3));if(o!=="contact"&&(h=h.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),u=yield h.get(),Us()&&u){let p={maxResults:t,results:null};p.results=u.value.map(f=>JSON.stringify(f)),yield s.putValue(n,p)}}catch{}return u?.value}),mv=(r,e="any",t="",o=10)=>pv(void 0,void 0,void 0,function*(){let i,n=`${t||`*:${e}`}:${o}`;if(Us()){i=W.getCache(H.people,H.people.stores.peopleQuery);let h=yield i.getValue(n);if(h&&fv()>Date.now()-h.timeCached)return h.results.map(p=>JSON.parse(p))}let s="/me/people",a="personType/class eq 'Person'";e!=="any"&&(e==="user"?a+="and personType/subclass eq 'OrganizationUser'":a+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),t&&(a+=` and ${t}`);let u;try{let h=r.api(s).middlewareOptions(be(W3)).top(o).filter(a);e!=="contact"&&(h=h.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),u=yield h.get(),Us()&&u&&(yield i.putValue(n,{maxResults:10,results:u.value.map(p=>JSON.stringify(p))}))}catch{}return u?u.value:null}),Do=r=>{var e,t;let o=r,i=r,n=r;return i?.mail?cv(i.mail):!((e=o?.scoredEmailAddresses)===null||e===void 0)&&e.length?cv(o.scoredEmailAddresses[0].address):!((t=n?.emailAddresses)===null||t===void 0)&&t.length?cv(n.emailAddresses[0].address):null},GC=(r,e)=>pv(void 0,void 0,void 0,function*(){let t;if(Us()){t=W.getCache(H.people,H.people.stores.contacts);let n=yield t.getValue(e);if(n&&fv()>Date.now()-n.timeCached)return JSON.parse(n.person)}let o=encodeURIComponent(e),i=yield r.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${o}')`).middlewareOptions(be(OF)).get();return Us()&&i&&(yield t.putValue(e,{person:JSON.stringify(i.value)})),i?i.value:null}),Q3=(r,e,t,o)=>pv(void 0,void 0,void 0,function*(){var i;let n,s=`${e}${t}`;if(Us()){n=W.getCache(H.people,H.people.stores.peopleQuery);let h=yield n.getValue(s);if(h&&fv()>Date.now()-h.timeCached)return h.results.map(p=>JSON.parse(p))}let a=r.api(t).version(e);o?.length&&(a=a.middlewareOptions(be(o)));let u=yield a.get();if(u&&Array.isArray(u.value)&&u["@odata.nextLink"]){let h=u;for(;h?.["@odata.nextLink"];){let f=h["@odata.nextLink"].split(e)[1];h=yield r.api(f).version(e).get(),!((i=h?.value)===null||i===void 0)&&i.length&&(h.value=u.value.concat(h.value),u=h)}}if(Us()&&u){let h={results:null};Array.isArray(u.value)?h.results=u.value.map(p=>JSON.stringify(p)):h.results=[JSON.stringify(u)],yield n.putValue(s,h)}return u?.value})});var Wn,zs,rr,Y3,MF,Dh,Sd,Lh,Xl,Z3,ec,tc,jC,Ua=y(()=>{l();c();d();ge();Ni();Bs();Wn=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},zs=()=>W.config.users.invalidationPeriod||W.config.defaultInvalidationPeriod,rr=()=>W.config.users.isEnabled&&W.config.isEnabled,Y3=(r,e="",t=10)=>Wn(void 0,void 0,void 0,function*(){let o=["User.ReadBasic.All","User.Read.All","Directory.Read.All","User.ReadWrite.All","Directory.ReadWrite.All"],i="/users",n,s=`${e===""?"*":e}:${t}`,a={maxResults:t,results:null};if(rr()){n=W.getCache(H.users,H.users.stores.userFilters);let h=yield n.getValue(s);if(h&&zs()>Date.now()-h.timeCached)return h.results.map(p=>JSON.parse(p))}let u=r.api(i).top(t);e&&u.filter(e).header("ConsistencyLevel","eventual").count(!0);try{let h=yield u.middlewareOptions(be(o)).get();return rr()&&h&&(a.results=h.value.map(p=>JSON.stringify(p)),yield n.putValue(e,a)),h.value}catch{}}),MF=["User.Read","User.ReadWrite"],Dh=(r,e)=>Wn(void 0,void 0,void 0,function*(){let t;if(rr()){t=W.getCache(H.users,H.users.stores.users);let n=yield t.getValue("me");if(n&&zs()>Date.now()-n.timeCached){let s=JSON.parse(n.user),a=e?e.filter(u=>!Object.keys(s).includes(u)):null;if(!a||a.length<=1)return s}}let o="me";e&&(o=o+"?$select="+e.toString());let i=yield r.api(o).middlewareOptions(be(MF)).get();return rr()&&(yield t.putValue("me",{user:JSON.stringify(i)})),i}),Sd=["User.ReadBasic.All","User.Read.All","Directory.Read.All","User.ReadWrite.All","Directory.ReadWrite.All"],Lh=(r,e,t)=>Wn(void 0,void 0,void 0,function*(){let o;if(rr()){o=W.getCache(H.users,H.users.stores.users);let s=yield o.getValue(e);if(s&&zs()>Date.now()-s.timeCached){let a=s.user?JSON.parse(s.user):null,u=t&&a?t.filter(h=>!Object.keys(a).includes(h)):null;if(!u||u.length<=1)return a}}let i=`/users/${e}`;t&&(i=i+"?$select="+t.toString());let n;try{n=yield r.api(i).middlewareOptions(be(Sd)).get()}catch{}return rr()&&(yield o.putValue(e,{user:JSON.stringify(n)})),n}),Xl=(r,e,t="",o="",i)=>Wn(void 0,void 0,void 0,function*(){if(!e||e.length===0)return[];let n=r.createBatch(),s={},a={},u=[];t=t.toLowerCase();let h;rr()&&(h=W.getCache(H.users,H.users.stores.users));for(let p of e){s[p]=null;let f=`/users/${p}`,b,C;if(rr()&&(C=yield h.getValue(p)),C?.user&&zs()>Date.now()-C.timeCached)if(b=JSON.parse(C?.user),t){if(b){let S=b.displayName;S?.toLowerCase().includes(t)&&(a[p]=b)}}else b?s[p]=b:(n.get(p,f,Sd),u.push(p));else p!==""&&(p==="me"?s[p]=yield Dh(r):(f=`/users/${p}`,o&&(f+=`${f}?$filter=${o}&$count=true`),n.get(p,f,Sd,o?{ConsistencyLevel:"eventual"}:{}),u.push(p)))}try{if(n.hasRequests){let p=yield n.executeAll();for(let f of e){let b=p.get(f);if(b?.content){let C=b.content;t?(C?.displayName.toLowerCase()||"").includes(t)&&(a[f]=C):s[f]=C,rr()&&(yield h.putValue(f,{user:JSON.stringify(C)}))}else{let C=i.find(S=>Object.values(S).includes(f));C&&(s[f]=C)}}}return t&&Object.keys(a).length?Promise.all(Object.values(a)):Promise.all(Object.values(s))}catch{try{return e.filter(f=>u.includes(f)).forEach(f=>{s[f]=Lh(r,f)}),rr()&&(yield Promise.all(e.filter(f=>u.includes(f)).map(f=>Wn(void 0,void 0,void 0,function*(){return yield h.putValue(f,{user:JSON.stringify(yield s[f])})})))),Promise.all(Object.values(s))}catch{return[]}}}),Z3=(r,e,t)=>Wn(void 0,void 0,void 0,function*(){var o;let i=["People.Read","People.Read.All"];if(!e||e.length===0)return[];let n=r.createBatch(),s=[],a,u;rr()&&(u=W.getCache(H.users,H.users.stores.usersQuery));for(let h of e)if(rr()&&(a=yield u.getValue(h)),rr()&&a?.results[0]&&zs()>Date.now()-a.timeCached){let p=JSON.parse(a.results[0]);s.push(p)}else n.get(h,`/me/people?$search="${h}"`,i,{"X-PeopleQuery-QuerySources":"Mailbox,Directory"});if(n.hasRequests)try{let h=yield n.executeAll();for(let p of e){let f=h.get(p);if(!((o=f?.content)===null||o===void 0)&&o.value&&f.content.value.length>0)s.push(f.content.value[0]),rr()&&(yield u.putValue(p,{maxResults:1,results:[JSON.stringify(f.content.value[0])]}));else{let b=t.find(C=>Object.values(C).includes(p));b&&s.push(b)}}return s}catch{try{return Promise.all(e.filter(p=>p&&p!=="").map(p=>Wn(void 0,void 0,void 0,function*(){let f=yield Ha(r,p,1);if(f?.length)return rr()&&(yield u.putValue(p,{maxResults:1,results:[JSON.stringify(f[0])]})),f[0]})))}catch{return[]}}return s}),ec=(r,e,t=10,o="")=>Wn(void 0,void 0,void 0,function*(){let i=Sd,n={maxResults:t,results:null},s=`${e}:${t}:${o}`,a;if(rr()){a=W.getCache(H.users,H.users.stores.usersQuery);let f=yield a.getValue(s);if(f&&zs()>Date.now()-f.timeCached)return f.results.map(b=>JSON.parse(b))}let u=encodeURIComponent(e),h=r.api("users").search(`"displayName:${u}" OR "mail:${u}" OR "userPrincipalName:${u}"`).header("ConsistencyLevel","eventual").count(!0),p;o!==""&&h.filter(o);try{p=yield h.top(t).middlewareOptions(be(i)).get()}catch{}return rr()&&p&&(n.results=p.value.map(f=>JSON.stringify(f)),yield a.putValue(e,n)),p?p.value:null}),tc=(r,e,t,o=10,i="person",n=!1,s="",a="")=>Wn(void 0,void 0,void 0,function*(){let u=["GroupMember.Read.All","Group.Read.All","Directory.Read.All","GroupMember.ReadWrite.All","Group.ReadWrite.All"],h={maxResults:o,results:null},p,f=`${t||"*"}:${e||"*"}:${o}:${i}:${n}:${s}`;if(rr()){p=W.getCache(H.users,H.users.stores.usersQuery);let N=yield p.getValue(f);if(N&&zs()>Date.now()-N.timeCached)return N.results.map(ye=>JSON.parse(ye))}let b="";e&&(b=`startswith(displayName,'${e}') or startswith(givenName,'${e}') or startswith(surname,'${e}') or startswith(mail,'${e}') or startswith(userPrincipalName,'${e}')`);let C=`/groups/${t}/${n?"transitiveMembers":"members"}`;i==="person"?C+="/microsoft.graph.user":i==="group"&&(C+="/microsoft.graph.group",e&&(b=`startswith(displayName,'${e}') or startswith(mail,'${e}')`)),s&&(b+=e?` and ${s}`:s),a&&(b+=e?` and ${a}`:a);let S=r.api(C).top(o).filter(b);(s||e)&&S.header("ConsistencyLevel","eventual").count(!0);let R=yield S.middlewareOptions(be(u)).get();return rr()&&R&&(h.results=R.value.map(N=>JSON.stringify(N)),yield p.putValue(f,h)),R?R.value:null}),jC=(r,e,t,o=10,i="person",n=!1,s="")=>Wn(void 0,void 0,void 0,function*(){let a=[];for(let u of t)try{let h=yield tc(r,e,u,o,i,n,s);a.push(...h)}catch{continue}return a})});var rc,oc,fi,gv,X3,Vs,J3,KC,Nh,eP,tP,Hh,_d=y(()=>{l();c();d();ge();Ja();Jo();Ni();Bs();Ua();rc=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},oc=()=>W.config.photos.invalidationPeriod||W.config.defaultInvalidationPeriod,fi=()=>W.config.photos.isEnabled&&W.config.isEnabled,gv=["User.ReadBasic.All","User.Read.All","User.ReadWrite.All"],X3=["User.Read","User.ReadWrite",...gv],Vs=(r,e,t)=>rc(void 0,void 0,void 0,function*(){try{let o=yield r.api(`${e}/photo/$value`).responseType(vr.RAW).middlewareOptions(be(t)).get();if(o.status===404)return{eTag:null,photo:null};if(!o.ok)return null;let i=o["@odata.mediaEtag"],n=yield lv(yield o.blob());return{eTag:i,photo:n}}catch{return null}}),J3=(r,e)=>rc(void 0,void 0,void 0,function*(){let t,o;if(fi()&&(t=W.getCache(H.photos,H.photos.stores.contacts),o=yield t.getValue(e),o&&oc()>Date.now()-o.timeCached))return o.photo;let i=["Contacts.Read","Contacts.ReadWrite"];return o=yield Vs(r,`me/contacts/${e}`,i),fi()&&o&&(yield t.putValue(e,o)),o?o.photo:null}),KC=(r,e)=>rc(void 0,void 0,void 0,function*(){let t,o,i=encodeURIComponent(e);if(fi()){if(t=W.getCache(H.photos,H.photos.stores.users),o=yield t.getValue(e),o&&oc()>Date.now()-o.timeCached)return o.photo;if(o)try{let n=yield r.api(`users/${e}/photo`).get();n&&(n["@odata.mediaEtag"]!==o.eTag||n["@odata.mediaEtag"]===null&&o.eTag===null)&&(o=null)}catch{return null}}return o=o||(yield Vs(r,`users/${i}`,gv)),fi()&&o&&(yield t.putValue(e,o)),o?o.photo:null}),Nh=(r,e,t=!0)=>rc(void 0,void 0,void 0,function*(){if("personType"in e&&e.personType.subclass!=="OrganizationUser"){if(e.personType.subclass==="PersonalContact"&&t){let i=Do(e),n=yield GC(r,i);if(n?.length&&n[0].id)return yield J3(r,n[0].id)}return null}if(e.userPrincipalName||e.id){let i=e.userPrincipalName||e.id;return yield KC(r,i)}if(e.id){let i=yield KC(r,e.id);if(i)return i}let o=Do(e);if(o){let i=yield ec(r,o,1);if(i?.length)return yield KC(r,i[0].id);if(t){let n=yield GC(r,o);if(n?.length)return yield J3(r,n[0].id)}}return null}),eP=(r,e)=>rc(void 0,void 0,void 0,function*(){let t,o,i=e.id;if(fi()){if(o=W.getCache(H.photos,H.photos.stores.groups),t=yield o.getValue(i),t&&oc()>Date.now()-t.timeCached)return t.photo;if(t)try{let s=yield r.api(`groups/${i}/photo`).get();s&&(s["@odata.mediaEtag"]!==t.eTag||s["@odata.mediaEtag"]===null&&t.eTag===null)&&(t=null)}catch{return null}}let n=["Group.Read.All","Group.ReadWrite.All"];return t=t||(yield Vs(r,`groups/${i}`,n)),fi()&&t&&(yield o.putValue(i,t)),t?t.photo:null}),tP=(r,e)=>rc(void 0,void 0,void 0,function*(){return yield W.getCache(H.photos,e).getValue(r)}),Hh=(r,e,t)=>rc(void 0,void 0,void 0,function*(){yield W.getCache(H.photos,e).putValue(r,t)})});var rP,oP,Td,Uh,iP,vv=y(()=>{l();c();d();ge();Ni();rP=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},oP=()=>W.config.presence.invalidationPeriod||W.config.defaultInvalidationPeriod,Td=()=>W.config.presence.isEnabled&&W.config.isEnabled,Uh=(r,e)=>rP(void 0,void 0,void 0,function*(){let t;if(Td()){t=W.getCache(H.presence,H.presence.stores.presence);let s=yield t.getValue(e||"me");if(s&&oP()>Date.now()-s.timeCached)return JSON.parse(s.presence)}let o=e?["presence.read.all"]:["presence.read","presence.read.all"],i=e?`/users/${e}/presence`:"/me/presence",n=yield r.api(i).middlewareOptions(be(o)).get();return Td()&&(yield t.putValue(e||"me",{presence:JSON.stringify(n)})),n}),iP=(r,e)=>rP(void 0,void 0,void 0,function*(){if(!e||e.length===0)return{};let t={},o=[],i=["presence.read.all"],n;Td()&&(n=W.getCache(H.presence,H.presence.stores.presence));for(let s of e)if(s?.id){let a=s.id;t[a]=null;let u;Td()&&(u=yield n.getValue(a)),Td()&&u&&oP()>Date.now()-u.timeCached?t[a]=JSON.parse(u.presence):o.push(a)}try{if(o.length>0){let s=yield r.api("/communications/getPresencesByUserId").middlewareOptions(be(i)).post({ids:o});for(let a of s.value)t[a.id]=a,Td()&&(yield n.putValue(a.id,{presence:JSON.stringify(a)}))}return t}catch{try{let a=yield Promise.all(e.filter(u=>u?.id&&!t[u.id]&&"personType"in u&&u.personType.subclass==="OrganizationUser").map(u=>Uh(r,u.id)));for(let u of a)t[u.id]=u;return t}catch{return null}}})});var yv,WC=y(()=>{l();c();d();yv=r=>{let e=r;return e.statusCode&&"code"in e&&"body"in e&&e.date&&"message"in e&&"name"in e&&"requestId"in e}});var FF,ic,bv=y(()=>{l();c();d();ge();_d();Ua();Ni();WC();FF=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},ic=(r,e,t)=>FF(void 0,void 0,void 0,function*(){let o=["User.ReadBasic.All","User.Read.All","Directory.Read.All","User.ReadWrite.All","Directory.ReadWrite.All"],i=["User.Read","User.ReadWrite",...o],n=e?o:i,s=e?gv:X3,a,u=null,h,p,f=e?`users/${e}`:"me",b=f+(t?`?$select=${t.toString()}`:"");if(rr()&&(p=yield W.getCache(H.users,H.users.stores.users).getValue(e||"me"),p&&zs()>Date.now()-p.timeCached?(u=p.user?JSON.parse(p.user):null,u!==null&&t&&t.filter(R=>!Object.keys(u).includes(R)).length>=1&&(u=null,p=null)):p=null),fi()){if(h=yield tP(e||"me",H.photos.stores.users),h&&oc()>Date.now()-h.timeCached)a=h.photo;else if(h)try{let C=yield r.api(`${f}/photo`).get();C?.["@odata.mediaEtag"]&&C["@odata.mediaEtag"]===h.eTag?(yield Hh(e||"me",H.photos.stores.users,h),a=h.photo):h=null}catch(C){yv(C)&&(C.code==="ErrorItemNotFound"||C.code==="ImageNotFound")&&(yield Hh(e||"me",H.photos.stores.users,{eTag:null,photo:null}))}}if(!h&&!p){let C,S=r.createBatch();e?(S.get("user",`/users/${e}${t?"?$select="+t.toString():""}`,n),S.get("photo",`users/${e}/photo/$value`,s)):(S.get("user","me",n),S.get("photo","me/photo/$value",s));let R=yield S.executeAll(),N=R.get("photo");N&&(C=N.headers.ETag,a=N.content);let ye=R.get("user");ye&&(u=ye.content),rr()&&(yield W.getCache(H.users,H.users.stores.users).putValue(e||"me",{user:JSON.stringify(u)})),fi()&&(yield Hh(e||"me",H.photos.stores.users,{eTag:C,photo:a}))}else if(h){if(!p)try{let C=yield r.api(b).middlewareOptions(be(n)).get();C&&(rr()&&(yield W.getCache(H.users,H.users.stores.users).putValue(e||"me",{user:JSON.stringify(C)})),u=C)}catch{}}else try{let C=yield Vs(r,f,s);C&&(fi()&&(yield Hh(e||"me",H.photos.stores.users,{eTag:C.eTag,photo:C.photo})),a=C.photo)}catch{}return u&&(u.personImage=a),u})});var DF,LF,Ed,Bh=y(()=>{l();c();d();DF=["image","oneline","twolines","threelines","fourlines"],LF=r=>typeof r=="string"&&DF.includes(r),Ed=(r,e="twolines")=>LF(r)?r:e});var NF,at,Mr=y(()=>{l();c();d();cr();NF=H3(),at=(...r)=>{if(r?.length)for(let e of r)NF.register(e())}});var P,Z,Yr=y(()=>{l();c();d();xe();(function(r){r[r.ArrowDown=0]="ArrowDown",r[r.TeamSeparator=1]="TeamSeparator",r[r.Search=2]="Search",r[r.SkypeArrow=3]="SkypeArrow",r[r.SmallEmail=4]="SmallEmail",r[r.SmallEmailHovered=5]="SmallEmailHovered",r[r.SmallChat=6]="SmallChat",r[r.SmallChatHovered=7]="SmallChatHovered",r[r.Video=8]="Video",r[r.VideoHovered=9]="VideoHovered",r[r.ExpandDown=10]="ExpandDown",r[r.Overview=11]="Overview",r[r.Send=12]="Send",r[r.Contact=13]="Contact",r[r.Copy=14]="Copy",r[r.Phone=15]="Phone",r[r.CellPhone=16]="CellPhone",r[r.Chat=17]="Chat",r[r.Call=18]="Call",r[r.CallHovered=19]="CallHovered",r[r.Confirmation=20]="Confirmation",r[r.Department=21]="Department",r[r.Dot=22]="Dot",r[r.Email=23]="Email",r[r.OfficeLocation=24]="OfficeLocation",r[r.Person=25]="Person",r[r.Messages=26]="Messages",r[r.Organization=27]="Organization",r[r.ExpandRight=28]="ExpandRight",r[r.Profile=29]="Profile",r[r.Birthday=30]="Birthday",r[r.File=31]="File",r[r.Files=32]="Files",r[r.Back=33]="Back",r[r.Close=34]="Close",r[r.Upload=35]="Upload",r[r.FileCloud=36]="FileCloud",r[r.DragFile=37]="DragFile",r[r.Cancel=38]="Cancel",r[r.CheckMark=39]="CheckMark",r[r.Radio=40]="Radio",r[r.Success=41]="Success",r[r.Fail=42]="Fail",r[r.SelectAccount=43]="SelectAccount",r[r.News=44]="News",r[r.DoubleBookmark=45]="DoubleBookmark",r[r.ChevronLeft=46]="ChevronLeft",r[r.ChevronRight=47]="ChevronRight",r[r.Event=48]="Event",r[r.BookOpen=49]="BookOpen",r[r.FileOuter=50]="FileOuter",r[r.BookQuestion=51]="BookQuestion",r[r.Globe=52]="Globe",r[r.Delete=53]="Delete",r[r.Add=54]="Add",r[r.Calendar=55]="Calendar",r[r.Planner=56]="Planner",r[r.Milestone=57]="Milestone",r[r.PersonAdd=58]="PersonAdd",r[r.PresenceAvailable=59]="PresenceAvailable",r[r.PresenceOofAvailable=60]="PresenceOofAvailable",r[r.PresenceBusy=61]="PresenceBusy",r[r.PresenceOofBusy=62]="PresenceOofBusy",r[r.PresenceDnd=63]="PresenceDnd",r[r.PresenceOofDnd=64]="PresenceOofDnd",r[r.PresenceAway=65]="PresenceAway",r[r.PresenceOofAway=66]="PresenceOofAway",r[r.PresenceOffline=67]="PresenceOffline",r[r.PresenceStatusUnknown=68]="PresenceStatusUnknown"})(P||(P={}));Z=(r,e)=>{switch(r){case P.ArrowDown:return x`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case P.TeamSeparator:return x`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${e}
          />
        </svg>
      `;case P.Search:return x`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.30887 8.01596C6.53903 8.63179 5.56252 9.00004 4.5 9.00004C2.01472 9.00004 0 6.98531 0 4.50002C0 2.01473 2.01472 0 4.5 0C6.98528 0 9 2.01473 9 4.50002C9 5.56252 8.63177 6.53901 8.01597 7.30885L11.8536 11.1464C12.0488 11.3417 12.0488 11.6583 11.8536 11.8536C11.6583 12.0488 11.3417 12.0488 11.1464 11.8536L7.30887 8.01596ZM8 4.50002C8 2.56701 6.433 1 4.5 1C2.567 1 1 2.56701 1 4.50002C1 6.43302 2.567 8.00003 4.5 8.00003C6.433 8.00003 8 6.43302 8 4.50002Z" fill="currentColor"/>
        </svg>`;case P.SkypeArrow:return x`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case P.SmallEmail:return x`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M16 3.373V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 -7.62939e-05 11.8807 -7.62939e-05 10.5V3.373L7.74649 7.93097C7.90297 8.02301 8.09704 8.02301 8.25351 7.93097L16 3.373ZM13.5 0C14.7871 0 15.847 0.972604 15.9848 2.22293L8 6.91991L0.0151832 2.22293C0.15304 0.972604 1.21294 0 2.5 0H13.5Z" fill="currentColor"/>
          <path class="regular" d="M13.608 0.833496C14.9887 0.833496 16.108 1.95278 16.108 3.3335V11.3335C16.108 12.7142 14.9887 13.8335 13.608 13.8335H2.60803C1.22732 13.8335 0.108032 12.7142 0.108032 11.3335V3.3335C0.108032 1.95278 1.22732 0.833496 2.60803 0.833496H13.608ZM15.108 4.7945L8.36154 8.76446C8.23115 8.84117 8.07464 8.85395 7.93554 8.80281L7.85452 8.76446L1.10803 4.7965V11.3335C1.10803 12.1619 1.77961 12.8335 2.60803 12.8335H13.608C14.4365 12.8335 15.108 12.1619 15.108 11.3335V4.7945ZM13.608 1.8335H2.60803C1.77961 1.8335 1.10803 2.50507 1.10803 3.3335V3.6355L8.10803 7.75341L15.108 3.6345V3.3335C15.108 2.50507 14.4365 1.8335 13.608 1.8335Z" fill="currentColor"/>
        </svg>
      `;case P.SmallChat:return x`
        <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8.5 9H5.5L5.41012 9.00806C5.17688 9.05039 5 9.25454 5 9.5C5 9.74546 5.17688 9.94961 5.41012 9.99194L5.5 10H8.5L8.58988 9.99194C8.82312 9.94961 9 9.74546 9 9.5C9 9.25454 8.82312 9.05039 8.58988 9.00806L8.5 9ZM10.5 6H5.5L5.41012 6.00806C5.17688 6.05039 5 6.25454 5 6.5C5 6.74546 5.17688 6.94961 5.41012 6.99194L5.5 7H10.5L10.5899 6.99194C10.8231 6.94961 11 6.74546 11 6.5C11 6.25454 10.8231 6.05039 10.5899 6.00806L10.5 6Z" fill="currentColor"/>
          <path class="regular" d="M8.38599 0.833496C12.8043 0.833496 16.386 4.41522 16.386 8.8335C16.386 13.2518 12.8043 16.8335 8.38599 16.8335C7.11277 16.8335 5.8819 16.5353 4.77267 15.9728L4.65199 15.9085L1.00708 16.8186C0.697255 16.8959 0.41221 16.6704 0.387296 16.3773L0.387128 16.2959L0.400919 16.2122L1.31099 12.5685L1.24768 12.4488C0.792589 11.5521 0.510317 10.5757 0.418733 9.56176L0.393362 9.17984L0.385986 8.8335C0.385986 4.41522 3.96771 0.833496 8.38599 0.833496ZM8.38599 1.8335C4.51999 1.8335 1.38599 4.9675 1.38599 8.8335C1.38599 10.0505 1.69653 11.2213 2.27951 12.2584C2.32645 12.3419 2.34809 12.4365 2.34291 12.5308L2.32873 12.6247L1.57299 15.6455L4.59703 14.8918C4.65892 14.8764 4.72261 14.8731 4.78472 14.8814L4.87629 14.9026L4.963 14.941C5.9996 15.5233 7.16969 15.8335 8.38599 15.8335C12.252 15.8335 15.386 12.6995 15.386 8.8335C15.386 4.9675 12.252 1.8335 8.38599 1.8335ZM8.88599 9.8335C9.16213 9.8335 9.38599 10.0574 9.38599 10.3335C9.38599 10.579 9.20911 10.7831 8.97586 10.8254L8.88599 10.8335H5.88599C5.60984 10.8335 5.38599 10.6096 5.38599 10.3335C5.38599 10.088 5.56286 9.88389 5.79611 9.84155L5.88599 9.8335H8.88599ZM10.886 6.8335C11.1621 6.8335 11.386 7.05735 11.386 7.3335C11.386 7.57896 11.2091 7.7831 10.9759 7.82544L10.886 7.8335L5.88599 7.8335C5.60984 7.8335 5.38599 7.60964 5.38599 7.3335C5.38599 7.08804 5.56286 6.88389 5.79611 6.84155L5.88599 6.8335L10.886 6.8335Z" fill="currentColor"/>
        </svg>
      `;case P.Video:return x`
        <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="filled" d="M11 2.5C11 1.11929 9.88071 0 8.5 0H2.5C1.11929 0 0 1.11929 0 2.5V9.5C0 10.8807 1.11929 12 2.5 12H8.5C9.88071 12 11 10.8807 11 9.5V2.5ZM12 3.93082V8.08149L14.7642 10.4319C15.2512 10.8461 16 10.4999 16 9.86055V2.19315C16 1.55685 15.2575 1.20962 14.7692 1.61756L12 3.93082Z" fill="currentColor"/>
          <path class="regular" d="M2.72095 0.833496C1.34024 0.833496 0.220947 1.95278 0.220947 3.3335V10.3335C0.220947 11.7142 1.34024 12.8335 2.72095 12.8335H9.72095C11.1017 12.8335 12.2209 11.7142 12.2209 10.3335V9.33348L14.6209 11.1335C15.2802 11.6279 16.2209 11.1575 16.2209 10.3335V3.33348C16.2209 2.50944 15.2802 2.03905 14.6209 2.53348L12.2209 4.33348V3.3335C12.2209 1.95278 11.1017 0.833496 9.72095 0.833496H2.72095ZM12.2209 5.58348L15.2209 3.33348V10.3335L12.2209 8.08348V5.58348ZM11.2209 3.3335V10.3335C11.2209 11.1619 10.5494 11.8335 9.72095 11.8335H2.72095C1.89252 11.8335 1.22095 11.1619 1.22095 10.3335V3.3335C1.22095 2.50507 1.89252 1.8335 2.72095 1.8335H9.72095C10.5494 1.8335 11.2209 2.50507 11.2209 3.3335Z" fill="currentColor"/>
        </svg>
      `;case P.ExpandDown:return x`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="currentColor" />
        </svg>
      `;case P.Overview:return x`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.5 10.5C2.67157 10.5 2 9.82843 2 9V4C2 3.17157 2.67157 2.5 3.5 2.5H12.5C13.3284 2.5 14 3.17157 14 4V9C14 9.82843 13.3284 10.5 12.5 10.5H3.5ZM3.5 3.5C3.22386 3.5 3 3.72386 3 4V5.5H13V4C13 3.72386 12.7761 3.5 12.5 3.5H3.5ZM5 6.5H3V9C3 9.27614 3.22386 9.5 3.5 9.5H5V6.5ZM6 9.5H12.5C12.7761 9.5 13 9.27614 13 9V6.5H6V9.5ZM0 3C0 1.61929 1.11929 0.5 2.5 0.5H13.5C14.8807 0.5 16 1.61929 16 3V10C16 11.3807 14.8807 12.5 13.5 12.5H2.5C1.11929 12.5 0 11.3807 0 10V3ZM2.5 1.5C1.67157 1.5 1 2.17157 1 3V10C1 10.8284 1.67157 11.5 2.5 11.5H13.5C14.3284 11.5 15 10.8284 15 10V3C15 2.17157 14.3284 1.5 13.5 1.5H2.5Z" fill="#717171"/>
        </svg>
      `;case P.Send:return x`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case P.Contact:return x`
        <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5ZM2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879ZM9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5ZM0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z" fill="#717171"/>
        </svg>
      `;case P.Call:return x`
        <svg width="13" height="17" viewBox="0 0 13 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M3.98706 1.06589C4.89545 0.792081 5.86254 1.19479 6.31418 2.01224L6.38841 2.16075L7.04987 3.63213C7.46246 4.54992 7.28209 5.61908 6.60754 6.3496L6.47529 6.48248L5.43194 7.45541C5.24417 7.63298 5.38512 8.32181 6.06527 9.49986C6.67716 10.5597 7.17487 11.0552 7.41986 11.0823L7.4628 11.082L7.5158 11.0716L9.56651 10.4446C10.1332 10.2713 10.7438 10.4487 11.1298 10.8865L11.2215 11.0014L12.5781 12.8815C13.1299 13.6462 13.0689 14.6842 12.4533 15.378L12.3314 15.5039L11.7886 16.018C10.7948 16.9592 9.34348 17.2346 8.07389 16.7231C6.13867 15.9433 4.38077 14.1607 2.78368 11.3945C1.18323 8.62242 0.519004 6.20438 0.815977 4.13565C0.99977 2.85539 1.87301 1.78674 3.07748 1.3462L3.27036 1.28192L3.98706 1.06589Z" fill="currentColor"/>
          <path class="regular" d="M3.9292 0.399388L3.2125 0.615419C1.90898 1.00834 0.951582 2.1215 0.758116 3.46915C0.461142 5.53787 1.12537 7.95591 2.72582 10.728C4.32291 13.4942 6.0808 15.2768 8.01603 16.0565C9.28562 16.5681 10.7369 16.2927 11.7308 15.3515L12.2736 14.8374C13.0011 14.1485 13.1065 13.0275 12.5202 12.215L11.1636 10.3349C10.788 9.81423 10.1226 9.59039 9.50865 9.7781L7.45794 10.4051L7.40494 10.4154C7.17877 10.4485 6.65754 9.95942 6.00741 8.83335C5.32726 7.65531 5.1863 6.96648 5.37408 6.7889L6.41743 5.81598C7.19937 5.08681 7.43039 3.94078 6.99201 2.96562L6.33055 1.49424C5.91866 0.578005 4.89102 0.109471 3.9292 0.399388ZM5.41847 1.90427L6.07993 3.37564C6.34277 3.96031 6.20426 4.64744 5.73543 5.08463L4.68953 6.05994C4.02044 6.69268 4.24206 7.77567 5.14138 9.33335C5.98759 10.799 6.75958 11.5233 7.58908 11.3977L7.71341 11.3711L9.80102 10.7344C10.0057 10.6718 10.2275 10.7464 10.3527 10.92L11.7093 12.8001C12.0024 13.2064 11.9497 13.7669 11.586 14.1113L11.0432 14.6254C10.3333 15.2977 9.29663 15.4944 8.38977 15.129C6.6917 14.4448 5.08689 12.8175 3.59185 10.228C2.09375 7.63319 1.48745 5.42604 1.74797 3.61125C1.88616 2.64864 2.57001 1.85352 3.5011 1.57287L4.2178 1.35684C4.69871 1.21188 5.21253 1.44615 5.41847 1.90427Z" fill="currentColor"/>
        </svg>
      `;case P.Confirmation:return x`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.03212 13.9072L3.56056 10.0017C3.28538 9.69214 2.81132 9.66425 2.50174 9.93944C2.19215 10.2146 2.16426 10.6887 2.43945 10.9983L6.43945 15.4983C6.72614 15.8208 7.2252 15.8355 7.53034 15.5303L18.0303 5.03033C18.3232 4.73744 18.3232 4.26256 18.0303 3.96967C17.7374 3.67678 17.2626 3.67678 16.9697 3.96967L7.03212 13.9072Z" fill="#009E00"/>
      </svg>
      `;case P.Copy:return x`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case P.Phone:return x`
        <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" fill="none">
            <path d="M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z" fill="${e}"></path>
        </svg>
      `;case P.CellPhone:return x`
        <svg width="10" height="16" viewBox="0 0 10 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 12C3.72386 12 3.5 12.2239 3.5 12.5C3.5 12.7761 3.72386 13 4 13H6C6.27614 13 6.5 12.7761 6.5 12.5C6.5 12.2239 6.27614 12 6 12H4ZM2 0C0.89543 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H8C9.10457 16 10 15.1046 10 14V2C10 0.89543 9.10457 0 8 0H2ZM1 2C1 1.44772 1.44772 1 2 1H8C8.55228 1 9 1.44772 9 2V14C9 14.5523 8.55228 15 8 15H2C1.44772 15 1 14.5523 1 14V2Z" fill="#717171"/>
        </svg>
      `;case P.Chat:return x`
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7L5.5 7C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6L10.5 6Z" fill="#717171"/>
        </svg>
      `;case P.Department:return x`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 1.5V3H2C0.895431 3 0 3.89543 0 5V12C0 13.1046 0.895432 14 2 14H14.0026C15.1071 14 16.0026 13.1046 16.0026 12V5C16.0026 3.89543 15.1071 3 14.0026 3H12V1.5C12 0.671573 11.3284 0 10.5 0H5.5C4.67157 0 4 0.671573 4 1.5ZM5.5 1H10.5C10.7761 1 11 1.22386 11 1.5V3H5V1.5C5 1.22386 5.22386 1 5.5 1ZM2 4H14.0026C14.5549 4 15.0026 4.44772 15.0026 5V7H12L12 6.50073C12 6.22459 11.7761 6.00073 11.5 6.00073C11.2239 6.00073 11 6.22459 11 6.50074L11 7H5V6.50073C5 6.22459 4.77614 6.00073 4.5 6.00073C4.22386 6.00073 4 6.22459 4 6.50073V7H1V5C1 4.44772 1.44772 4 2 4ZM11 8L11 8.5C11 8.77615 11.2239 9 11.5 9C11.7762 9 12 8.77614 12 8.5L12 8H15.0026V12C15.0026 12.5523 14.5549 13 14.0026 13H2C1.44772 13 1 12.5523 1 12V8H4V8.5C4 8.77614 4.22386 9 4.5 9C4.77614 9 5 8.77614 5 8.5V8H11Z" fill="#717171"/>
        </svg>
      `;case P.Dot:return x`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.25 10C6.25 10.6904 5.69036 11.25 5 11.25C4.30964 11.25 3.75 10.6904 3.75 10C3.75 9.30964 4.30964 8.75 5 8.75C5.69036 8.75 6.25 9.30964 6.25 10ZM11.25 10C11.25 10.6904 10.6904 11.25 10 11.25C9.30964 11.25 8.75 10.6904 8.75 10C8.75 9.30964 9.30964 8.75 10 8.75C10.6904 8.75 11.25 9.30964 11.25 10ZM15 11.25C15.6904 11.25 16.25 10.6904 16.25 10C16.25 9.30964 15.6904 8.75 15 8.75C14.3096 8.75 13.75 9.30964 13.75 10C13.75 10.6904 14.3096 11.25 15 11.25Z" fill="currentColor"/>
        </svg>
        `;case P.Email:return x`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case P.OfficeLocation:return x`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <title>Location icon</title>
          <path d="M10 7C10 8.65685 8.65685 10 7 10C5.34315 10 4 8.65685 4 7C4 5.34315 5.34315 4 7 4C8.65685 4 10 5.34315 10 7ZM9 7C9 5.89543 8.10457 5 7 5C5.89543 5 5 5.89543 5 7C5 8.10457 5.89543 9 7 9C8.10457 9 9 8.10457 9 7ZM11.9497 11.955C14.6834 9.2201 14.6834 4.78601 11.9497 2.05115C9.21608 -0.683716 4.78392 -0.683716 2.05025 2.05115C-0.683418 4.78601 -0.683418 9.2201 2.05025 11.955L3.57128 13.4538L5.61408 15.4389L5.74691 15.5567C6.52168 16.1847 7.65623 16.1455 8.38611 15.4391L10.8223 13.0691L11.9497 11.955ZM2.75499 2.75619C5.09944 0.410715 8.90055 0.410715 11.245 2.75619C13.5294 5.04153 13.5879 8.71039 11.4207 11.0667L11.245 11.2499L9.92371 12.5539L7.69315 14.7225L7.60016 14.8021C7.24594 15.0699 6.7543 15.0698 6.40012 14.802L6.30713 14.7224L3.3263 11.817L2.75499 11.2499L2.57927 11.0667C0.412077 8.71039 0.47065 5.04153 2.75499 2.75619Z" fill="#717171"/>
        </svg>
      `;case P.Birthday:return x`
        <svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.81357 0.667333C6.07581 0.320242 6.48151 0 7 0C7.51849 0 7.92419 0.320242 8.18643 0.667333C8.45471 1.0224 8.63508 1.47991 8.69561 1.93392C8.75552 2.3832 8.70532 2.89341 8.42852 3.3086C8.134 3.75039 7.63965 4 7 4C6.36035 4 5.866 3.75039 5.57148 3.3086C5.29468 2.89341 5.24448 2.3832 5.30439 1.93392C5.36492 1.47991 5.54529 1.0224 5.81357 0.667333ZM6.40353 2.7539C6.484 2.87461 6.63965 3 7 3C7.36035 3 7.516 2.87461 7.59647 2.7539C7.69468 2.60659 7.74448 2.3668 7.70439 2.06608C7.66492 1.77009 7.54529 1.4776 7.38857 1.27017C7.22581 1.05476 7.08151 1 7 1C6.91849 1 6.77419 1.05476 6.61143 1.27017C6.45471 1.4776 6.33508 1.77009 6.29561 2.06608C6.25552 2.3668 6.30532 2.60659 6.40353 2.7539ZM1 7C1 5.89543 1.89543 5 3 5H11C12.1046 5 13 5.89543 13 7V12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H0.5C0.223858 13 0 12.7761 0 12.5C0 12.2239 0.223858 12 0.5 12H1V7ZM2 12H12V9.01931C11.9109 9.10285 11.8174 9.18842 11.7208 9.27412C11.4006 9.55804 11.0346 9.85319 10.6715 10.0802C10.3274 10.2953 9.90815 10.5 9.5 10.5C8.77182 10.5 8.30806 9.98986 8.00471 9.65617C7.9834 9.63273 7.96289 9.61016 7.94312 9.58869C7.5876 9.20261 7.35769 9 7 9C6.64231 9 6.4124 9.20261 6.05688 9.58869C6.03711 9.61016 6.0166 9.63273 5.99529 9.65617C5.69194 9.98986 5.22818 10.5 4.5 10.5C4.10587 10.5 3.69263 10.2897 3.35907 10.0789C3.00198 9.85313 2.63516 9.55951 2.31117 9.27666C2.20329 9.18247 2.09896 9.08844 2 8.9971V12ZM2 7.59993C2.05039 7.65198 2.11363 7.71652 2.1873 7.7902C2.38843 7.99132 2.6649 8.25801 2.96883 8.52334C3.27484 8.79049 3.59802 9.04687 3.89343 9.23362C4.21237 9.43525 4.41413 9.5 4.5 9.5C4.75817 9.5 4.93171 9.33433 5.32125 8.91131L5.32447 8.90781C5.65956 8.5439 6.16039 8 7 8C7.83961 8 8.34044 8.5439 8.67553 8.90781L8.67875 8.91131C9.06828 9.33433 9.24183 9.5 9.5 9.5C9.6106 9.5 9.82569 9.42967 10.1414 9.23229C10.4381 9.04681 10.7573 8.79196 11.0573 8.52588C11.3554 8.26163 11.6238 7.99594 11.8184 7.7955C11.89 7.72165 11.9513 7.65703 12 7.60506V7C12 6.44772 11.5523 6 11 6H3C2.44772 6 2 6.44772 2 7V7.59993Z" fill="#717171"/>
        </svg>
      `;case P.Person:return x`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case P.Messages:return x`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case P.Organization:return x`
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.99992 0C6.34271 0 4.99927 1.34344 4.99927 3.00066C4.99927 4.48754 6.08073 5.72183 7.49999 5.95985V7.5H4.5C3.67157 7.5 3 8.17157 3 9V10.0416C1.5811 10.2799 0.5 11.514 0.5 13.0007C0.5 14.6579 1.84344 16.0013 3.50066 16.0013C5.15787 16.0013 6.50131 14.6579 6.50131 13.0007C6.50131 11.5136 5.41954 10.2791 4 10.0414V9C4 8.72386 4.22386 8.5 4.5 8.5H11.5C11.7761 8.5 12 8.72386 12 9V10.0416C10.5811 10.2799 9.5 11.514 9.5 13.0007C9.5 14.6579 10.8434 16.0013 12.5007 16.0013C14.1579 16.0013 15.5013 14.6579 15.5013 13.0007C15.5013 11.5136 14.4195 10.2791 13 10.0414V9C13 8.17157 12.3284 7.5 11.5 7.5H8.49999V5.95983C9.91918 5.72176 11.0006 4.48749 11.0006 3.00066C11.0006 1.34344 9.65714 0 7.99992 0ZM5.99927 3.00066C5.99927 1.89572 6.89499 1 7.99992 1C9.10485 1 10.0006 1.89572 10.0006 3.00066C10.0006 4.10559 9.10485 5.00131 7.99992 5.00131C6.89499 5.00131 5.99927 4.10559 5.99927 3.00066ZM1.5 13.0007C1.5 11.8957 2.39572 11 3.50066 11C4.60559 11 5.50131 11.8957 5.50131 13.0007C5.50131 14.1056 4.60559 15.0013 3.50066 15.0013C2.39572 15.0013 1.5 14.1056 1.5 13.0007ZM12.5007 11C13.6056 11 14.5013 11.8957 14.5013 13.0007C14.5013 14.1056 13.6056 15.0013 12.5007 15.0013C11.3957 15.0013 10.5 14.1056 10.5 13.0007C10.5 11.8957 11.3957 11 12.5007 11Z" fill="#717171"/>
        </svg>
      `;case P.ExpandRight:return x`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case P.Profile:return x`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case P.File:return x`
        <svg width="28" height="28" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case P.Files:return x`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.9956 4.07309V4C14.9956 2.61929 13.8763 1.5 12.4956 1.5H7.66418L6.06391 0.299946C5.80428 0.105247 5.48851 0 5.16399 0H2.5C1.11916 0 -0.000181445 1.11949 2.20615e-08 2.50033L0.0011832 11.4978C0.00135142 12.7772 0.962583 13.8321 2.2023 13.9798C2.2867 13.9945 2.37375 14.0021 2.46289 14.0021H13.1798C13.8981 14.0021 14.5156 13.4929 14.6524 12.7877L16.0097 5.78769C16.1587 5.01967 15.696 4.29703 14.9956 4.07309ZM2.5 1H5.16399C5.27216 1 5.37742 1.03508 5.46396 1.09998L7.19756 2.40002C7.2841 2.46492 7.38936 2.5 7.49753 2.5H12.4956C13.324 2.5 13.9956 3.17157 13.9956 4V4.00214H3.824C3.10596 4.00214 2.48863 4.511 2.35158 5.21583L1.05351 11.8916C1.01941 11.7661 1.0012 11.634 1.00118 11.4976L1 2.5002C0.999891 1.67169 1.6715 1 2.5 1ZM3.33319 5.4067C3.37888 5.17176 3.58465 5.00214 3.824 5.00214H14.5372C14.8515 5.00214 15.0879 5.28874 15.028 5.59732L13.6706 12.5973C13.6251 12.8324 13.4192 13.0021 13.1798 13.0021H2.46289C2.14845 13.0021 1.91206 12.7154 1.97208 12.4067L3.33319 5.4067Z" fill="#717171"/>
        </svg>
      `;case P.Back:return x`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `;case P.Close:return x`
        <svg width="10" height="10" viewBox="0 0 10 10" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.73838 5.032L9.70337 1.067L8.99638 0.360001L5.03137 4.325L1.06637 0.360001L0.359375 1.067L4.32438 5.032L0.359375 8.997L1.06637 9.704L5.03137 5.739L8.99638 9.704L9.70337 8.997L5.73838 5.032Z" fill="currentColor"/>
        </svg>
     `;case P.Upload:return x`
        <svg class="upload-icon" width="21" height="12" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4.5 2C4.08579 2 3.75 2.33579 3.75 2.75C3.75 3.16421 4.08579 3.5 4.5 3.5H15C15.4142 3.5 15.75 3.16421 15.75 2.75C15.75 2.33579 15.4142 2 15 2H4.5ZM10.4963 17.3493C10.4466 17.7154 10.1328 17.9976 9.75311 17.9976C9.3389 17.9976 9.00311 17.6618 9.00311 17.2476L9.00249 7.05856L6.02995 10.026L5.94578 10.0986C5.65202 10.3162 5.23537 10.2917 4.96929 10.0253C4.67661 9.73215 4.67695 9.25728 4.97005 8.96459L9.25962 4.67989C9.33377 4.61512 9.42089 4.56485 9.5169 4.53385L9.59777 4.51072C9.64749 4.50019 9.69837 4.4947 9.74849 4.4947L9.80855 4.49661L9.87781 4.50451L9.99828 4.53462L10.0895 4.57254L10.1259 4.59371L10.2169 4.6523L10.2875 4.71481L14.5303 8.96546L14.6029 9.04964C14.8205 9.34345 14.7959 9.7601 14.5294 10.0261L14.4452 10.0987C14.1514 10.3162 13.7347 10.2917 13.4687 10.0251L10.5025 7.05456L10.5031 17.2476L10.4963 17.3493Z" fill="#ffffff"/>
        </svg>
      `;case P.FileCloud:return x`
        <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">
          <path
            d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"
          />
        </svg>
      `;case P.DragFile:return x`
        <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z"
          />
        </svg>
      `;case P.Cancel:return x`
        <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.588591 0.715694L0.646447 0.646447C0.820013 0.47288 1.08944 0.453595 1.28431 0.588591L1.35355 0.646447L6 5.293L10.6464 0.646447C10.8417 0.451185 11.1583 0.451185 11.3536 0.646447C11.5488 0.841709 11.5488 1.15829 11.3536 1.35355L6.707 6L11.3536 10.6464C11.5271 10.82 11.5464 11.0894 11.4114 11.2843L11.3536 11.3536C11.18 11.5271 10.9106 11.5464 10.7157 11.4114L10.6464 11.3536L6 6.707L1.35355 11.3536C1.15829 11.5488 0.841709 11.5488 0.646447 11.3536C0.451185 11.1583 0.451185 10.8417 0.646447 10.6464L5.293 6L0.646447 1.35355C0.47288 1.17999 0.453595 0.910563 0.588591 0.715694L0.646447 0.646447L0.588591 0.715694Z" fill="currentColor"/>
        </svg>
     `;case P.Success:return x`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>
          <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>
        </svg>
      `;case P.CheckMark:return x`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="filled" d="M10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0ZM13.2197 6.96967L8.75 11.4393L6.78033 9.46967C6.48744 9.17678 6.01256 9.17678 5.71967 9.46967C5.42678 9.76256 5.42678 10.2374 5.71967 10.5303L8.21967 13.0303C8.51256 13.3232 8.98744 13.3232 9.28033 13.0303L14.2803 8.03033C14.5732 7.73744 14.5732 7.26256 14.2803 6.96967C13.9874 6.67678 13.5126 6.67678 13.2197 6.96967Z" fill="currentColor"/>
        <path class="regular" d="M10 1.5C5.30558 1.5 1.5 5.30558 1.5 10C1.5 14.6944 5.30558 18.5 10 18.5C14.6944 18.5 18.5 14.6944 18.5 10C18.5 5.30558 14.6944 1.5 10 1.5ZM0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10Z" fill="currentColor"/>
      </svg>
      `;case P.Radio:return x`
      <svg width="66" height="20" viewBox="0 0 66 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="0.5" y="0.5" width="19" height="19" rx="9.5" fill="#F3F3F3"/>
        <rect x="0.5" y="0.5" width="19" height="19" rx="9.5" stroke="#636363"/>
        <path d="M36.5596 16H35.1924L33.5107 13.2178C33.1963 12.6982 32.9274 12.3656 32.7041 12.2197C32.4808 12.0693 32.2096 11.9941 31.8906 11.9941H30.7627V16H29.6143V6.19727H32.54C33.3923 6.19727 34.1009 6.42285 34.666 6.87402C35.2357 7.3252 35.5205 7.99056 35.5205 8.87012C35.5205 9.56283 35.3405 10.1439 34.9805 10.6133C34.6204 11.0827 34.126 11.4222 33.4971 11.6318V11.6592C33.7021 11.7822 33.8822 11.9167 34.0371 12.0625C34.1921 12.2083 34.3561 12.4225 34.5293 12.7051L36.5596 16ZM30.7627 7.23633V10.9551H32.3213C32.891 10.9551 33.3649 10.7705 33.7432 10.4014C34.126 10.0322 34.3174 9.55371 34.3174 8.96582C34.3174 8.44173 34.1465 8.02246 33.8047 7.70801C33.4674 7.39355 32.9775 7.23633 32.335 7.23633H30.7627ZM42.8008 16H41.6797V14.9062H41.6523C41.4108 15.3255 41.1123 15.64 40.7568 15.8496C40.4059 16.0592 39.9958 16.1641 39.5264 16.1641C38.8701 16.1641 38.3392 15.9727 37.9336 15.5898C37.528 15.207 37.3252 14.6989 37.3252 14.0654C37.3252 13.4684 37.5303 12.974 37.9404 12.582C38.3506 12.1901 38.9316 11.9395 39.6836 11.8301L41.6797 11.5635V11.4062C41.6797 10.8184 41.543 10.4014 41.2695 10.1553C40.9961 9.90462 40.6315 9.7793 40.1758 9.7793C39.8112 9.7793 39.4603 9.84766 39.123 9.98438C38.7858 10.1211 38.4691 10.3307 38.1729 10.6133L37.5166 9.93652C37.9085 9.55827 38.3255 9.28027 38.7676 9.10254C39.2096 8.9248 39.7018 8.83594 40.2441 8.83594C41.0918 8.83594 41.7298 9.05469 42.1582 9.49219C42.5866 9.92513 42.8008 10.5768 42.8008 11.4473V16ZM41.6797 13.1562V12.459L39.9912 12.6914C39.4762 12.7643 39.0889 12.8942 38.8291 13.0811C38.5693 13.2679 38.4395 13.5618 38.4395 13.9629C38.4395 14.3822 38.5602 14.7035 38.8018 14.9268C39.0479 15.1455 39.3464 15.2549 39.6973 15.2549C40.3034 15.2549 40.7842 15.0566 41.1396 14.6602C41.4997 14.2637 41.6797 13.7624 41.6797 13.1562ZM49.7939 14.8105C49.5342 15.2617 49.2038 15.6012 48.8027 15.8291C48.4062 16.0524 47.9346 16.1641 47.3877 16.1641C46.5081 16.1641 45.804 15.8519 45.2754 15.2275C44.7513 14.5986 44.4893 13.7441 44.4893 12.6641C44.4893 11.5065 44.7809 10.5791 45.3643 9.88184C45.9476 9.18457 46.7246 8.83594 47.6953 8.83594C48.1784 8.83594 48.5931 8.93164 48.9395 9.12305C49.2904 9.3099 49.5752 9.59245 49.7939 9.9707H49.8213V5.63672H50.9424V16H49.8213V14.8105H49.7939ZM45.6377 12.6094C45.6377 13.416 45.8245 14.054 46.1982 14.5234C46.5765 14.9883 47.0824 15.2207 47.7158 15.2207C48.3447 15.2207 48.8529 14.9951 49.2402 14.5439C49.6276 14.0928 49.8213 13.5231 49.8213 12.835V11.8027C49.8213 11.2376 49.6322 10.7591 49.2539 10.3672C48.8802 9.97526 48.4085 9.7793 47.8389 9.7793C47.1553 9.7793 46.6175 10.0299 46.2256 10.5312C45.8337 11.0326 45.6377 11.7253 45.6377 12.6094ZM53.7861 7.3252C53.5583 7.3252 53.3669 7.25 53.2119 7.09961C53.057 6.94466 52.9795 6.75553 52.9795 6.53223C52.9795 6.30892 53.057 6.12207 53.2119 5.97168C53.3669 5.81673 53.5583 5.73926 53.7861 5.73926C54.014 5.73926 54.2054 5.81673 54.3604 5.97168C54.5153 6.12207 54.5928 6.30892 54.5928 6.53223C54.5928 6.75553 54.5153 6.94466 54.3604 7.09961C54.2054 7.25 54.014 7.3252 53.7861 7.3252ZM54.333 16H53.2119V9H54.333V16ZM59.5283 16.1641C58.4938 16.1641 57.6667 15.8382 57.0469 15.1865C56.4316 14.5303 56.124 13.6621 56.124 12.582C56.124 11.4108 56.443 10.4948 57.0811 9.83398C57.7191 9.17318 58.5895 8.84049 59.6924 8.83594C60.736 8.83138 61.5495 9.15267 62.1328 9.7998C62.7207 10.4469 63.0146 11.3379 63.0146 12.4727C63.0146 13.5938 62.6979 14.4893 62.0645 15.1592C61.4355 15.8291 60.5902 16.1641 59.5283 16.1641ZM59.6104 15.2207C60.335 15.2207 60.891 14.986 61.2783 14.5166C61.6702 14.0426 61.8662 13.375 61.8662 12.5137C61.8662 11.6341 61.6702 10.9596 61.2783 10.4902C60.8864 10.0163 60.3304 9.7793 59.6104 9.7793C58.8903 9.7793 58.3206 10.0254 57.9014 10.5176C57.4821 11.0098 57.2725 11.6842 57.2725 12.541C57.2725 13.3704 57.4844 14.0244 57.9082 14.5029C58.332 14.9814 58.8994 15.2207 59.6104 15.2207Z" fill="#1A1A1A"/>
      </svg>
      `;case P.Fail:return x`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>
          <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />
        </svg>
      `;case P.SelectAccount:return x`
    <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
      <path fill=${e} d="M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM10.5 15C12.9853 15 15 12.9853 15 10.5C15 8.01472 12.9853 6 10.5 6C8.01472 6 6 8.01472 6 10.5C6 12.9853 8.01472 15 10.5 15ZM10.5 8C10.7761 8 11 8.22386 11 8.5V10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H11V12.5C11 12.7761 10.7761 13 10.5 13C10.2239 13 10 12.7761 10 12.5V11H8.5C8.22386 11 8 10.7761 8 10.5C8 10.2239 8.22386 10 8.5 10H10V8.5C10 8.22386 10.2239 8 10.5 8Z"/>
    </svg>
  `;case P.News:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.75 20H5.25C3.51697 20 2.10075 18.6435 2.00514 16.9344L2 16.75V6.25C2 5.05914 2.92516 4.08436 4.09595 4.00519L4.25 4H16.75C17.9409 4 18.9156 4.92516 18.9948 6.09595L19 6.25V7H19.75C20.9409 7 21.9156 7.92516 21.9948 9.09595L22 9.25V16.75C22 18.483 20.6435 19.8992 18.9344 19.9949L18.75 20H5.25H18.75ZM5.25 18.5H18.75C19.6682 18.5 20.4212 17.7929 20.4942 16.8935L20.5 16.75V9.25C20.5 8.8703 20.2178 8.55651 19.8518 8.50685L19.75 8.5H19V16.25C19 16.6297 18.7178 16.9435 18.3518 16.9932L18.25 17C17.8703 17 17.5565 16.7178 17.5068 16.3518L17.5 16.25V6.25C17.5 5.8703 17.2178 5.55651 16.8518 5.50685L16.75 5.5H4.25C3.8703 5.5 3.55651 5.78215 3.50685 6.14823L3.5 6.25V16.75C3.5 17.6682 4.20711 18.4212 5.10647 18.4942L5.25 18.5H18.75H5.25ZM12.246 14.5H15.2522C15.6665 14.5 16.0022 14.8358 16.0022 15.25C16.0022 15.6297 15.7201 15.9435 15.354 15.9932L15.2522 16H12.246C11.8318 16 11.496 15.6642 11.496 15.25C11.496 14.8703 11.7782 14.5565 12.1442 14.5068L12.246 14.5H15.2522H12.246ZM9.24328 11.0045C9.6575 11.0045 9.99328 11.3403 9.99328 11.7545V15.25C9.99328 15.6642 9.6575 16 9.24328 16H5.74776C5.33355 16 4.99776 15.6642 4.99776 15.25V11.7545C4.99776 11.3403 5.33355 11.0045 5.74776 11.0045H9.24328ZM8.49328 12.5045H6.49776V14.5H8.49328V12.5045ZM12.246 11.0045H15.2522C15.6665 11.0045 16.0022 11.3403 16.0022 11.7545C16.0022 12.1342 15.7201 12.448 15.354 12.4976L15.2522 12.5045H12.246C11.8318 12.5045 11.496 12.1687 11.496 11.7545C11.496 11.3748 11.7782 11.061 12.1442 11.0113L12.246 11.0045H15.2522H12.246ZM5.74776 7.50247H15.2522C15.6665 7.50247 16.0022 7.83826 16.0022 8.25247C16.0022 8.63217 15.7201 8.94596 15.354 8.99563L15.2522 9.00247H5.74776C5.33355 9.00247 4.99776 8.66669 4.99776 8.25247C4.99776 7.87278 5.27991 7.55898 5.64599 7.50932L5.74776 7.50247H15.2522H5.74776Z" fill="none" />
      </svg>
      `;case P.DoubleBookmark:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 6.74814C4 5.50535 5.00742 4.49786 6.25013 4.49786H15.2506C16.4933 4.49786 17.5008 5.50535 17.5008 6.74814V21.2499C17.5008 21.5185 17.3572 21.7666 17.1243 21.9003C16.8914 22.0341 16.6048 22.0332 16.3728 21.8978L10.7504 18.6179L5.12797 21.8978C4.89599 22.0332 4.60936 22.0341 4.37648 21.9003C4.14359 21.7666 4 21.5185 4 21.2499V6.74814ZM6.25013 5.99805C5.83589 5.99805 5.50008 6.33387 5.50008 6.74814V19.944L10.3725 17.1016C10.606 16.9653 10.8948 16.9653 11.1283 17.1016L16.0007 19.944V6.74814C16.0007 6.33387 15.6649 5.99805 15.2506 5.99805H6.25013ZM15.2497 2C17.8732 2 20 4.12691 20 6.75058V18.6232C20 19.0374 19.6642 19.3733 19.25 19.3733C18.8357 19.3733 18.4999 19.0374 18.4999 18.6232V6.75058C18.4999 4.95543 17.0448 3.50018 15.2497 3.50018H6.63687C6.63687 3.50018 6.75016 2.94339 7.43379 2.41948C8.00023 2 8.60182 2 8.60182 2H15.2497Z" fill="none" />
        </svg>
      `;case P.ChevronLeft:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.5303 4.21967C15.8232 4.51256 15.8232 4.98744 15.5303 5.28033L8.81066 12L15.5303 18.7197C15.8232 19.0126 15.8232 19.4874 15.5303 19.7803C15.2374 20.0732 14.7626 20.0732 14.4697 19.7803L7.21967 12.5303C6.92678 12.2374 6.92678 11.7626 7.21967 11.4697L14.4697 4.21967C14.7626 3.92678 15.2374 3.92678 15.5303 4.21967Z" fill="none" />
        </svg>`;case P.ChevronRight:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z" fill="currentColor" />
        </svg>`;case P.Delete:return x`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.5 4H11.5C11.5 3.17157 10.8284 2.5 10 2.5C9.17157 2.5 8.5 3.17157 8.5 4ZM7.5 4C7.5 2.61929 8.61929 1.5 10 1.5C11.3807 1.5 12.5 2.61929 12.5 4H17.5C17.7761 4 18 4.22386 18 4.5C18 4.77614 17.7761 5 17.5 5H16.4456L15.2521 15.3439C15.0774 16.8576 13.7957 18 12.2719 18H7.72813C6.20431 18 4.92256 16.8576 4.7479 15.3439L3.55437 5H2.5C2.22386 5 2 4.77614 2 4.5C2 4.22386 2.22386 4 2.5 4H7.5ZM5.74131 15.2292C5.85775 16.2384 6.71225 17 7.72813 17H12.2719C13.2878 17 14.1422 16.2384 14.2587 15.2292L15.439 5H4.56101L5.74131 15.2292ZM8.5 7.5C8.77614 7.5 9 7.72386 9 8V14C9 14.2761 8.77614 14.5 8.5 14.5C8.22386 14.5 8 14.2761 8 14V8C8 7.72386 8.22386 7.5 8.5 7.5ZM12 8C12 7.72386 11.7761 7.5 11.5 7.5C11.2239 7.5 11 7.72386 11 8V14C11 14.2761 11.2239 14.5 11.5 14.5C11.7761 14.5 12 14.2761 12 14V8Z" fill="currentColor"/>
        </svg>
    `;case P.Add:return x`
        <svg width="16" height="15" viewBox="0 0 16 15" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.39563 0.5C8.39563 0.223858 8.17177 0 7.89563 0C7.61949 0 7.39563 0.223858 7.39563 0.5V7H0.89563C0.619487 7 0.39563 7.22386 0.39563 7.5C0.39563 7.77614 0.619487 8 0.89563 8H7.39563V14.5C7.39563 14.7761 7.61949 15 7.89563 15C8.17177 15 8.39563 14.7761 8.39563 14.5V8H14.8956C15.1718 8 15.3956 7.77614 15.3956 7.5C15.3956 7.22386 15.1718 7 14.8956 7H8.39563V0.5Z" fill="${e}"/>
        </svg>`;case P.Calendar:return x`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 11C7.55228 11 8 10.5523 8 10C8 9.44771 7.55228 9 7 9C6.44772 9 6 9.44771 6 10C6 10.5523 6.44772 11 7 11ZM8 13C8 13.5523 7.55228 14 7 14C6.44772 14 6 13.5523 6 13C6 12.4477 6.44772 12 7 12C7.55228 12 8 12.4477 8 13ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44771 10.5523 9 10 9C9.44771 9 9 9.44771 9 10C9 10.5523 9.44771 11 10 11ZM11 13C11 13.5523 10.5523 14 10 14C9.44771 14 9 13.5523 9 13C9 12.4477 9.44771 12 10 12C10.5523 12 11 12.4477 11 13ZM13 11C13.5523 11 14 10.5523 14 10C14 9.44771 13.5523 9 13 9C12.4477 9 12 9.44771 12 10C12 10.5523 12.4477 11 13 11ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM4 7H16V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V7ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V6H4V5.5C4 4.67157 4.67157 4 5.5 4Z" fill=${e}/>
        </svg>
    `;case P.Planner:return x`
        <svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm1.75 5.5h-15v9.25c0 .966.784 1.75 1.75 1.75h11.5a1.75 1.75 0 0 0 1.75-1.75V8.5Zm-11.75 6a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm-4.25-4a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm1.5-6H6.25A1.75 1.75 0 0 0 4.5 6.25V7h15v-.75a1.75 1.75 0 0 0-1.75-1.75Z" fill="${e}"/>
        </svg>`;case P.Milestone:return x`
        <svg width="24" height="24" fill="${e}" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.25 13c.966 0 1.75.784 1.75 1.75v4.5A1.75 1.75 0 0 1 15.25 21H3.75A1.75 1.75 0 0 1 2 19.25v-4.5c0-.966.783-1.75 1.75-1.75h11.5ZM21 14.899v5.351a.75.75 0 0 1-1.494.102l-.006-.102v-5.338a3.006 3.006 0 0 0 1.5-.013Zm-5.75-.399H3.75a.25.25 0 0 0-.25.25v4.5c0 .138.111.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25Zm5-4.408a1.908 1.908 0 1 1 0 3.816 1.908 1.908 0 0 1 0-3.816ZM15.244 3c.967 0 1.75.784 1.75 1.75v4.5a1.75 1.75 0 0 1-1.75 1.75h-11.5a1.75 1.75 0 0 1-1.75-1.75v-4.5a1.75 1.75 0 0 1 1.607-1.744L3.745 3h11.5Zm0 1.5h-11.5l-.057.007a.25.25 0 0 0-.193.243v4.5c0 .138.112.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25ZM20.25 3a.75.75 0 0 1 .743.648L21 3.75v5.351a3.004 3.004 0 0 0-1.5-.013V3.75a.75.75 0 0 1 .75-.75Z" fill="${e}"/>
        </svg>`;case P.PersonAdd:return x`
        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">
          <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>
          <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>
          <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>
        </svg>`;case P.Event:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.75 3C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25C3 4.45507 4.45507 3 6.25 3H17.75ZM19.5 8.5H4.5V17.75C4.5 18.7165 5.2835 19.5 6.25 19.5H17.75C18.7165 19.5 19.5 18.7165 19.5 17.75V8.5ZM7.75 14.5C8.44036 14.5 9 15.0596 9 15.75C9 16.4404 8.44036 17 7.75 17C7.05964 17 6.5 16.4404 6.5 15.75C6.5 15.0596 7.05964 14.5 7.75 14.5ZM12 14.5C12.6904 14.5 13.25 15.0596 13.25 15.75C13.25 16.4404 12.6904 17 12 17C11.3096 17 10.75 16.4404 10.75 15.75C10.75 15.0596 11.3096 14.5 12 14.5ZM7.75 10.5C8.44036 10.5 9 11.0596 9 11.75C9 12.4404 8.44036 13 7.75 13C7.05964 13 6.5 12.4404 6.5 11.75C6.5 11.0596 7.05964 10.5 7.75 10.5ZM12 10.5C12.6904 10.5 13.25 11.0596 13.25 11.75C13.25 12.4404 12.6904 13 12 13C11.3096 13 10.75 12.4404 10.75 11.75C10.75 11.0596 11.3096 10.5 12 10.5ZM16.25 10.5C16.9404 10.5 17.5 11.0596 17.5 11.75C17.5 12.4404 16.9404 13 16.25 13C15.5596 13 15 12.4404 15 11.75C15 11.0596 15.5596 10.5 16.25 10.5ZM17.75 4.5H6.25C5.2835 4.5 4.5 5.2835 4.5 6.25V7H19.5V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5Z" fill="none" />
        </svg>
      `;case P.BookOpen:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 19.1375C11.4986 19.6686 10.788 20 10 20H3.75C2.7835 20 2 19.2165 2 18.25V5.75C2 4.7835 2.7835 4 3.75 4H10C10.788 4 11.4986 4.33145 12 4.86253C12.5014 4.33145 13.212 4 14 4H20.25C21.2165 4 22 4.7835 22 5.75V18.25C22 19.2165 21.2165 20 20.25 20H14C13.212 20 12.5014 19.6686 12 19.1375ZM3.5 5.75V18.25C3.5 18.3881 3.61193 18.5 3.75 18.5H10C10.6904 18.5 11.25 17.9404 11.25 17.25V6.75C11.25 6.05964 10.6904 5.5 10 5.5H3.75C3.61193 5.5 3.5 5.61193 3.5 5.75ZM12.75 17.25C12.75 17.9404 13.3096 18.5 14 18.5H20.25C20.3881 18.5 20.5 18.3881 20.5 18.25V5.75C20.5 5.61193 20.3881 5.5 20.25 5.5H14C13.3096 5.5 12.75 6.05964 12.75 6.75V17.25Z" fill="none" />
        </svg>
      `;case P.FileOuter:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 2C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V9.82777C20 9.29733 19.7893 8.78863 19.4142 8.41355L13.5864 2.58579C13.2114 2.21071 12.7027 2 12.1722 2H6ZM5.5 4C5.5 3.72386 5.72386 3.5 6 3.5H12V8C12 9.10457 12.8954 10 14 10H18.5V20C18.5 20.2761 18.2761 20.5 18 20.5H6C5.72386 20.5 5.5 20.2761 5.5 20V4ZM17.3793 8.5H14C13.7239 8.5 13.5 8.27614 13.5 8V4.62066L17.3793 8.5Z" fill="none" />
        </svg>
      `;case P.BookQuestion:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.9998 8.01752C10.9905 8.42363 10.6584 8.74999 10.25 8.74999C9.5 8.74999 9.5 7.9989 9.5 7.9989L9.5 7.99777L9.50001 7.99539L9.50006 7.99017C9.50032 7.9755 9.50072 7.96084 9.50144 7.94618C9.50262 7.92198 9.50473 7.89159 9.50846 7.8559C9.51591 7.78477 9.52996 7.69092 9.55665 7.58186C9.60973 7.36492 9.71565 7.07652 9.92848 6.78906C10.3825 6.17582 11.1982 5.72727 12.513 5.7501C13.4627 5.76659 14.3059 6.16497 14.834 6.82047C15.371 7.48704 15.5517 8.3902 15.1964 9.27853C14.8342 10.1839 14.0149 10.5437 13.5442 10.7503L13.4932 10.7728C13.2147 10.8957 13.0813 10.9599 13.0013 11.024L13 11.0251L13 11.7492C13.0001 12.1634 12.6643 12.4999 12.2501 12.5C11.8359 12.5 11.5001 12.1643 11.5 11.7501L11.5 11C11.5 10.4769 11.752 10.1029 12.0633 9.85345C12.3134 9.65303 12.6276 9.51483 12.8491 9.4174L12.8875 9.40049C13.4292 9.16137 13.6868 9.01346 13.8036 8.72145C13.9483 8.35977 13.8789 8.02596 13.6659 7.76153C13.4439 7.48604 13.0371 7.25943 12.487 7.24988C11.5518 7.23364 11.2425 7.53509 11.134 7.68162C11.0656 7.77404 11.0309 7.86797 11.0137 7.93838C11.0052 7.973 11.0017 7.99908 11.0003 8.01197L10.9998 8.01752ZM12.25 15.5C12.8023 15.5 13.25 15.0523 13.25 14.5C13.25 13.9477 12.8023 13.5 12.25 13.5C11.6977 13.5 11.25 13.9477 11.25 14.5C11.25 15.0523 11.6977 15.5 12.25 15.5ZM4 4.5C4 3.11929 5.11929 2 6.5 2H18C19.3807 2 20.5 3.11929 20.5 4.5V18.75C20.5 19.1642 20.1642 19.5 19.75 19.5H5.5C5.5 20.0523 5.94772 20.5 6.5 20.5H19.75C20.1642 20.5 20.5 20.8358 20.5 21.25C20.5 21.6642 20.1642 22 19.75 22H6.5C5.11929 22 4 20.8807 4 19.5V4.5ZM5.5 4.5V18H19V4.5C19 3.94772 18.5523 3.5 18 3.5H6.5C5.94772 3.5 5.5 3.94772 5.5 4.5Z" fill="none" />
        </svg>
      `;case P.Globe:return x`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M12.0001 1.99805C17.5238 1.99805 22.0016 6.47589 22.0016 11.9996C22.0016 17.5233 17.5238 22.0011 12.0001 22.0011C6.47638 22.0011 1.99854 17.5233 1.99854 11.9996C1.99854 6.47589 6.47638 1.99805 12.0001 1.99805ZM14.939 16.4993H9.06118C9.71322 18.9135 10.8466 20.5011 12.0001 20.5011C13.1536 20.5011 14.2869 18.9135 14.939 16.4993ZM7.5084 16.4999L4.78591 16.4998C5.74425 18.0328 7.1777 19.2384 8.88008 19.9104C8.3578 19.0906 7.92681 18.0643 7.60981 16.8949L7.5084 16.4999ZM19.2143 16.4998L16.4918 16.4999C16.168 17.8337 15.7004 18.9995 15.119 19.9104C16.716 19.2804 18.0757 18.1814 19.0291 16.7833L19.2143 16.4998ZM7.09351 9.99895H3.7359L3.73115 10.0162C3.57906 10.6525 3.49854 11.3166 3.49854 11.9996C3.49854 13.0558 3.69112 14.0669 4.0431 14.9999L7.21626 14.9995C7.07396 14.0504 6.99854 13.0422 6.99854 11.9996C6.99854 11.3156 7.031 10.6464 7.09351 9.99895ZM15.397 9.99901H8.60316C8.53514 10.6393 8.49853 11.309 8.49853 11.9996C8.49853 13.0591 8.58468 14.0694 8.73827 14.9997H15.2619C15.4155 14.0694 15.5016 13.0591 15.5016 11.9996C15.5016 11.309 15.465 10.6393 15.397 9.99901ZM20.2647 9.99811L16.9067 9.99897C16.9692 10.6464 17.0016 11.3156 17.0016 11.9996C17.0016 13.0422 16.9262 14.0504 16.7839 14.9995L19.9571 14.9999C20.309 14.0669 20.5016 13.0558 20.5016 11.9996C20.5016 11.3102 20.4196 10.64 20.2647 9.99811ZM8.88114 4.08875L8.85823 4.09747C6.81092 4.91218 5.1549 6.49949 4.25023 8.49935L7.29835 8.49972C7.61171 6.74693 8.15855 5.221 8.88114 4.08875ZM12.0001 3.49805L11.8844 3.50335C10.619 3.6191 9.39651 5.62107 8.8288 8.4993H15.1714C14.6052 5.62914 13.388 3.63033 12.1264 3.50436L12.0001 3.49805ZM15.1201 4.08881L15.2269 4.2629C15.8961 5.37537 16.4043 6.83525 16.7018 8.49972L19.7499 8.49935C18.8853 6.58795 17.3343 5.05341 15.4113 4.21008L15.1201 4.08881Z" />
        </svg>
      `;case P.PresenceAvailable:return x`
        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm2.1-5.9L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 0 1 .7-.7l.65.64 1.9-1.9a.5.5 0 0 1 .7.71Z" fill="#13a10e"></path>
        </svg>`;case P.PresenceOofAvailable:return x`
        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm6.1-1.6c.2.2.2.5 0 .7L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 1 1 .7-.7l.65.64 1.9-1.9c.2-.19.5-.19.7 0Z" fill="#13a10e"></path>
        </svg>`;case P.PresenceBusy:return x`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M10 5A5 5 0 1 1 0 5a5 5 0 0 1 10 0Z" fill="#d13438"></path>
        </svg>`;case P.PresenceOofBusy:return x`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>
        </svg>
      `;case P.PresenceDnd:return x`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10ZM3.5 4.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z" fill="#d13438"></path>
        </svg>`;case P.PresenceOofDnd:return x`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm2 0c0-.28.22-.5.5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 3 5Z" fill="#d13438"></path>
        </svg>`;case P.PresenceAway:return x`
        <svg fill="#eaa300" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm0-7v1.8l1.35 1.35a.5.5 0 1 1-.7.7l-1.5-1.5A.5.5 0 0 1 4 5V3a.5.5 0 0 1 1 0Z" fill="#eaa300"></path>
        </svg>`;case P.PresenceOofAway:return x`
        <svg fill="#c239b3" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.35 3.85a.5.5 0 1 0-.7-.7l-1.5 1.5a.5.5 0 0 0 0 .7l1.5 1.5a.5.5 0 1 0 .7-.7L4.7 5.5h1.8a.5.5 0 1 0 0-1H4.7l.65-.65ZM5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Z" fill="#c239b3"></path>
        </svg>`;case P.PresenceOffline:return x`
        <svg fill="#929292" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.85 3.15c.2.2.2.5 0 .7L5.71 5l1.14 1.15a.5.5 0 1 1-.7.7L5 5.71 3.85 6.85a.5.5 0 1 1-.7-.7L4.29 5 3.15 3.85a.5.5 0 1 1 .7-.7L5 4.29l1.15-1.14c.2-.2.5-.2.7 0ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Zm5-4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z" fill="#929292"></path>
        </svg>`;case P.PresenceStatusUnknown:return x`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>
        </svg>`}}});var QC,nP,sP=y(()=>{l();c();d();QC=()=>window.getWindowSegments!==void 0,nP=()=>QC()?window:null});var aP,lP=y(()=>{l();c();d();xe();aP=[Oe`
.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--mgt-flyout-box-shadow,var(--elevation-shadow-card-rest));border-radius:8px}.root .flyout.small{overflow:hidden auto}.root.visible .flyout{display:inline-block;animation-name:fade-in;animation-duration:.3s;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}.root.visible .flyout.small{overflow:hidden auto}@keyframes fade-in{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`]});var YC,wv,Ba,Id,Ad=y(()=>{l();c();d();xe();gt();pi();sP();lP();ge();YC=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},wv=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Ba=()=>Re("flyout",Id),Id=class extends Lr{static get styles(){return aP}get isOpen(){return this._isOpen}set isOpen(e){let t=this._isOpen;t!==e&&(this._isOpen=e,window.requestAnimationFrame(()=>{this.setupWindowEvents(this.isOpen);let o=this._flyout;!this.isOpen&&o&&(o.style.width=null,o.style.setProperty("--mgt-flyout-set-width",null),o.style.setProperty("--mgt-flyout-set-height",null),o.style.maxHeight=null,o.style.top=null,o.style.left=null,o.style.bottom=null)}),this.requestUpdate("isOpen",t),this.dispatchEvent(new Event(e?"opened":"closed")))}get _edgePadding(){return 24}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}constructor(){super(),this._renderedOnce=!1,this._isOpen=!1,this._smallView=!1,this.handleWindowEvent=e=>{let t=this._flyout;if(t)if(e.composedPath){let o=e.composedPath();if(o.includes(t)||e.type==="pointerdown"&&o.includes(this))return}else{let o=e.target;for(;o;)if(o=o.parentElement,o===t||e.type==="pointerdown"&&o===this)return}this.close()},this.handleResize=()=>{this.close()},this.handleKeyUp=e=>{e.key==="Escape"&&this.close()},this.handleFlyoutWheel=e=>{e.preventDefault()},this.avoidHidingAnchor=!0,this.addEventListener("expanded",()=>{window.requestAnimationFrame(()=>{this.updateFlyout()})}),this.addEventListener("smallView",()=>{window.requestAnimationFrame(()=>{this.updateFlyout()})})}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(e){super.updated(e),window.requestAnimationFrame(()=>{this.updateFlyout()})}render(){let e={root:!0,visible:this.isOpen},t=this.renderAnchor(),o=null;if(this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0),this.isOpen||this._renderedOnce){this._renderedOnce=!0;let i=ze({flyout:!0,small:this._smallView});o=x`
        <div class=${i} @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `}return x`
      <div class=${ze(e)}>
        <div class="anchor">
          ${t}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${o}
      </div>
    `}renderAnchor(){return x`
      <slot name="anchor"></slot>
    `}renderFlyout(){return x`
      <slot name="flyout"></slot>
    `}updateFlyout(e=!0){if(!this.isOpen)return;let t=this._anchor,o=this._flyout;if(o&&t){let i=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth;this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let n=0,s,a=0,u,h,p=o.getBoundingClientRect(),f=t.getBoundingClientRect(),b=this._topScout.getBoundingClientRect(),C=this._bottomScout.getBoundingClientRect(),S={height:this._windowHeight,left:0,top:0,width:i};if(QC()){let ie=nP().getWindowSegments(),me,yt=f.left+f.width/2,Ge=f.top+f.height/2;for(let tt of ie)if(yt>=tt.left&&Ge>=tt.top){me=tt;break}me&&(S.left=me.left,S.top=me.top,S.width=me.width,S.height=me.height)}p.width+2*this._edgePadding>S.width?p.width>S.width?(h=S.width,n=0):n=(S.width-p.width)/2:f.left+p.width+this._edgePadding>S.width?n=f.left-(f.left+p.width+this._edgePadding-S.width):f.left<this._edgePadding?n=this._edgePadding:n=f.left;let R=S.height-(f.top+f.height),N=f.top;this.avoidHidingAnchor?R<=p.height?N<p.height?N>R?(s=S.height-f.top,u=N):(a=f.bottom,u=R):(s=S.height-f.top,u=N):N>=p.height?(s=S.height-f.top,u=N):(a=f.bottom,u=R):p.height+2*this._edgePadding>S.height?p.height>=S.height?(u=S.height,a=0):a=(S.height-p.height)/2:f.top+f.height+p.height+this._edgePadding>S.height?a=S.height-p.height-this._edgePadding:a=Math.max(f.top+f.height,this._edgePadding),(b.top!==0||b.left!==0)&&(n-=b.left,typeof s<"u"?s+=C.top-this._windowHeight:a-=b.top),this.direction==="rtl"?n>100&&this.offsetLeft>100&&(o.style.left=`${S.width-n+p.left-p.width-30}px`):o.style.left=`${n+S.left}px`,typeof s<"u"?(o.style.top="unset",o.style.bottom=`${s}px`):(o.style.bottom="unset",o.style.top=`${a+S.top}px`),h&&(o.style.width=`${h}px`,o.style.setProperty("--mgt-flyout-set-width",`${h}px`),window.requestAnimationFrame(()=>this.updateFlyout())),u&&!e?(o.style.maxHeight=`${u}px`,o.style.setProperty("--mgt-flyout-set-height",`${u}px`)):(o.style.maxHeight=null,o.style.setProperty("--mgt-flyout-set-height","unset")),e&&window.requestAnimationFrame(()=>this.updateFlyout(!1))}}setupWindowEvents(e){e&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}};YC([E({attribute:"light-dismiss",type:Boolean}),wv("design:type",Boolean)],Id.prototype,"isLightDismiss",void 0);YC([E({attribute:null,type:Boolean}),wv("design:type",Boolean)],Id.prototype,"avoidHidingAnchor",void 0);YC([E({attribute:"isOpen",type:Boolean}),wv("design:type",Boolean),wv("design:paramtypes",[Boolean])],Id.prototype,"isOpen",null)});var HF,UF,Rd,Cv=y(()=>{l();c();d();HF=["none","hover","click"],UF=r=>typeof r=="string"&&HF.includes(r),Rd=(r,e="none")=>UF(r)?r:e});var cP,dP=y(()=>{l();c();d();xe();cP=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size)}:host .flyout [slot=anchor]{display:flex;cursor:pointer}:host .flyout [slot=anchor].vertical{flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root{display:flex;flex-direction:row;align-items:center;background-color:var(--person-background-color,transparent);border-radius:var(--person-border-radius,4px)}:host .person-root.small .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.small .contact-icon,:host .person-root.small .initials{font-size:calc(var(--person-avatar-size, 24px) * .4)}:host .person-root.small .presence-wrapper svg{width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root.noline .avatar-wrapper,:host .person-root.oneline .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.noline .avatar-wrapper .contact-icon,:host .person-root.noline .avatar-wrapper .initials,:host .person-root.oneline .avatar-wrapper .contact-icon,:host .person-root.oneline .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size, 24px) * .4)}:host .person-root.noline .avatar-wrapper .presence-wrapper svg,:host .person-root.oneline .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root.noline .presence-basic,:host .person-root.oneline .presence-basic{border-width:1px;position:relative;bottom:calc(var(--person-avatar-size,24px) * .12 - 4px)}:host .person-root.twolines .avatar-wrapper{min-width:var(--person-avatar-size,40px);width:var(--person-avatar-size,40px);height:var(--person-avatar-size,40px)}:host .person-root.twolines .avatar-wrapper .contact-icon,:host .person-root.twolines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size, 40px) * .4)}:host .person-root.twolines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,40px) * .28);height:calc(var(--person-avatar-size,40px) * .28)}:host .person-root.large .avatar-wrapper,:host .person-root.threelines .avatar-wrapper{min-width:var(--person-avatar-size,56px);width:var(--person-avatar-size,56px);height:var(--person-avatar-size,56px)}:host .person-root.large .avatar-wrapper .contact-icon,:host .person-root.large .avatar-wrapper .initials,:host .person-root.threelines .avatar-wrapper .contact-icon,:host .person-root.threelines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size, 56px) * .4)}:host .person-root.large .avatar-wrapper .presence-wrapper svg,:host .person-root.threelines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,56px) * .28);height:calc(var(--person-avatar-size,56px) * .28)}:host .person-root.fourlines .avatar-wrapper,:host .person-root.vertical .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.fourlines .avatar-wrapper .contact-icon,:host .person-root.fourlines .avatar-wrapper .initials,:host .person-root.vertical .avatar-wrapper .contact-icon,:host .person-root.vertical .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size, 72px) * .4)}:host .person-root.fourlines .avatar-wrapper .presence-wrapper svg,:host .person-root.vertical .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root.vertical{flex-direction:column;justify-content:center;align-items:center}:host .person-root .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px);position:relative;box-sizing:border-box}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials,:host .person-root .avatar-wrapper .shimmer,:host .person-root .avatar-wrapper img{height:100%;width:100%;border:var(--person-avatar-border,none);border-radius:var(--person-avatar-border-radius,50%);margin-block-start:var(--person-avatar-top-spacing,0);object-fit:cover;object-position:center top}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials,:host .person-root .avatar-wrapper .shimmer{display:flex;justify-content:center;align-items:center;font-size:calc(var(--person-avatar-size, 24px) * .4);font-weight:400;background:var(--person-initials-background-color,var(--neutral-fill-secondary-rest));color:var(--person-initials-text-color,var(--neutral-fill-strong-hover))}:host .person-root .avatar-wrapper .presence-wrapper{bottom:var(--person-presence-wrapper-bottom,0);right:0;position:absolute;border-radius:50%;background-color:var(--neutral-layer-1);border:1px solid var(--neutral-layer-1)}:host .person-root .avatar-wrapper .presence-wrapper svg{display:flex;width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root .details-wrapper{display:flex;flex-direction:column;align-items:flex-start;justify-content:center;min-width:var(--person-details-wrapper-width,168px);margin-inline-start:var(--person-details-left-spacing,12px);margin-block-end:var(--person-details-bottom-spacing,0)}:host .person-root .details-wrapper .shimmer.text{width:200px;height:16px;margin:2px 0}:host .person-root .details-wrapper.vertical{display:inline-flex;flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root .details-wrapper .line1{font-size:var(--person-line1-font-size, ms-font-size-14);font-weight:var(--person-line1-font-weight,600);color:var(--person-line1-text-color,var(--neutral-foreground-rest));text-transform:var(--person-line1-text-transform,inherit);line-height:var(--person-line1-text-line-height, 20px)}:host .person-root .details-wrapper .line2{font-size:var(--person-line2-font-size, var(--email-font-size, ms-font-size-12));font-weight:var(--person-line2-font-weight,400);color:var(--person-line2-text-color,var(--secondary-text-color));text-transform:var(--person-line2-text-transform,inherit);line-height:var(--person-line2-text-line-height, 16px)}:host .person-root .details-wrapper .line3{font-size:var(--person-line3-font-size, var(--email-font-size, ms-font-size-12));font-weight:var(--person-line3-font-weight,400);color:var(--person-line3-text-color,var(--secondary-text-color));text-transform:var(--person-line3-text-transform,inherit);line-height:var(--person-line3-text-line-height, 16px)}:host .person-root .details-wrapper .line4{font-size:var(--person-line4-font-size, var(--email-font-size, ms-font-size-12));font-weight:var(--person-line4-font-weight,400);color:var(--person-line4-text-color,var(--secondary-text-color));text-transform:var(--person-line4-text-transform,inherit);line-height:var(--person-line4-text-line-height, 16px)}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:rgb(255,255,255);fill-rule:nonzero;clip-rule:nonzero}}[dir=rtl] .presence-wrapper{right:unset!important;left:0}
`]});var BF,zF,uP,xv=y(()=>{l();c();d();BF=["photo","initials"],zF=r=>typeof r=="string"&&BF.includes(r),uP=(r,e="photo")=>zF(r)?r:e});var VF,hP,pP=y(()=>{l();c();d();VF={Available:"Available",Away:"Away",BeRightBack:"Be right back",Busy:"Busy",DoNotDisturb:"Do not disturb",InACall:"In a call",InAConferenceCall:"In a conference call",Inactive:"Inactive",InAMeeting:"In a meeting",Offline:"Offline",OffWork:"Off work",OutOfOffice:"Out of office",PresenceUnknown:"Presence unknown",Presenting:"Presenting",UrgentInterruptionsOnly:"Urgent interruptions only"},hP=Object.assign(Object.assign({},VF),{photoFor:"Photo for",emailAddress:"Email address"})});var Ut,zh=y(()=>{l();c();d();Ut=class{};Ut.sections={files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0};Ut.useContactApis=!0;Ut.isSendMessageVisible=!0});var qe,fP,kv,mP,nc,qF,Vh,Sv,za,_v,So,gP,vP,yP,bP,wP,CP,xP,kP,SP,_P,TP,EP,IP,Hi,ZC,JC,AP,RP,PP,$P,OP,MP,FP,DP,LP,NP,HP,UP,BP,zP,GF,jF,KF,XC,ex,VP,qP,GP,jP,KP,WP,Pd=y(()=>{l();c();d();ge();Ni();Ja();Jo();qe=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},fP=r=>Array.isArray(r.nextExpectedRanges),kv=()=>qe(void 0,void 0,void 0,function*(){yield W.getCache(H.fileLists,H.fileLists.stores.fileLists).clearStore()}),mP=()=>W.config.files.invalidationPeriod||W.config.defaultInvalidationPeriod,nc=()=>W.config.files.isEnabled&&W.config.isEnabled,qF=()=>W.config.fileLists.invalidationPeriod||W.config.defaultInvalidationPeriod,Vh=()=>W.config.fileLists.isEnabled&&W.config.isEnabled,Sv=["Files.Read","Files.ReadWrite","Files.Read.All","Files.ReadWrite.All","Group.Read.All","Group.ReadWrite.All","Sites.Read.All","Sites.ReadWrite.All"],za=["Sites.Read.All","Sites.ReadWrite.All"],_v=["Files.ReadWrite","Files.ReadWrite.All","Sites.ReadWrite.All"],So=(r,e,t=H.files.stores.fileQueries,o=Sv)=>qe(void 0,void 0,void 0,function*(){let i=W.getCache(H.files,t),n=yield KF(i,e);if(n)return n;let s;try{s=yield r.api(e).middlewareOptions(be(o)).get(),nc()&&(yield i.putValue(e,{file:JSON.stringify(s)}))}catch{}return s||null}),gP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/drives/${e}/items/${t}`;return So(r,o,H.files.stores.driveFiles)}),vP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/drives/${e}/root:/${t}`;return So(r,o,H.files.stores.driveFiles)}),yP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/groups/${e}/drive/items/${t}`;return So(r,o,H.files.stores.groupFiles)}),bP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/groups/${e}/drive/root:/${t}`;return So(r,o,H.files.stores.groupFiles)}),wP=(r,e)=>qe(void 0,void 0,void 0,function*(){let t=`/me/drive/items/${e}`;return So(r,t,H.files.stores.userFiles)}),CP=(r,e)=>qe(void 0,void 0,void 0,function*(){let t=`/me/drive/root:/${e}`;return So(r,t,H.files.stores.userFiles)}),xP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/sites/${e}/drive/items/${t}`;return So(r,o,H.files.stores.siteFiles)}),kP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/sites/${e}/drive/root:/${t}`;return So(r,o,H.files.stores.siteFiles)}),SP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/sites/${e}/lists/${t}/items/${o}/driveItem`;return So(r,i,H.files.stores.siteFiles)}),_P=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/users/${e}/drive/items/${t}`;return So(r,o,H.files.stores.userFiles)}),TP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/users/${e}/drive/root:/${t}`;return So(r,o,H.files.stores.userFiles)}),EP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/me/insights/${e}/${t}/resource`;return So(r,o,H.files.stores.insightFiles,za)}),IP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/users/${e}/insights/${t}/${o}/resource`;return So(r,i,H.files.stores.insightFiles,za)}),Hi=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i,n=W.getCache(H.fileLists,t),s=`${e}:${o}`,a=yield XC(n,t,s);if(a)return i=jF(r,a.files,a.nextLink),i;let u;try{if(u=r.api(e).middlewareOptions(be(Sv)),o&&u.top(o),i=yield GF(r,u),Vh()){let h=i.nextLink;yield n.putValue(s,{files:i.value.map(p=>JSON.stringify(p)),nextLink:h})}}catch{}return i||null}),ZC=(r,e)=>qe(void 0,void 0,void 0,function*(){let t="/me/drive/root/children",o=H.fileLists.stores.fileLists;return Hi(r,t,o,e)}),JC=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/drives/${e}/items/${t}/children`,n=H.fileLists.stores.fileLists;return Hi(r,i,n,o)}),AP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/drives/${e}/root:/${t}:/children`,n=H.fileLists.stores.fileLists;return Hi(r,i,n,o)}),RP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/groups/${e}/drive/items/${t}/children`,n=H.fileLists.stores.fileLists;return Hi(r,i,n,o)}),PP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/groups/${e}/drive/root:/${t}:/children`,n=H.fileLists.stores.fileLists;return Hi(r,i,n,o)}),$P=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/me/drive/items/${e}/children`,i=H.fileLists.stores.fileLists;return Hi(r,o,i,t)}),OP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=`/me/drive/root:/${e}:/children`,i=H.fileLists.stores.fileLists;return Hi(r,o,i,t)}),MP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/sites/${e}/drive/items/${t}/children`,n=H.fileLists.stores.fileLists;return Hi(r,i,n,o)}),FP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/sites/${e}/drive/root:/${t}:/children`,n=H.fileLists.stores.fileLists;return Hi(r,i,n,o)}),DP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/users/${e}/drive/items/${t}/children`,n=H.fileLists.stores.fileLists;return Hi(r,i,n,o)}),LP=(r,e,t,o)=>qe(void 0,void 0,void 0,function*(){let i=`/users/${e}/drive/root:/${t}:/children`,n=H.fileLists.stores.fileLists;return Hi(r,i,n,o)}),NP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o=H.fileLists.stores.fileLists;return Hi(r,e,o,t)}),HP=(r,e)=>qe(void 0,void 0,void 0,function*(){let t=`/me/insights/${e}`,o=H.fileLists.stores.insightfileLists,i=W.getCache(H.fileLists,o),n=yield XC(i,o,t);if(n)return n.files.map(u=>JSON.parse(u));let s;try{s=yield r.api(t).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(be(za)).get()}catch{}let a=yield zP(r,s,za);return Vh()&&(yield i.putValue(t,{files:a.map(u=>JSON.stringify(u))})),a||null}),UP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){let o,i;t==="shared"?(o="/me/insights/shared",i=`((lastshared/sharedby/id eq '${e}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(o=`/users/${e}/insights/${t}`,i="resourceReference/type eq 'microsoft.graph.driveItem'");let n=`${o}?$filter=${i}`,s=H.fileLists.stores.insightfileLists,a=W.getCache(H.fileLists,s),u=yield XC(a,s,n);if(u)return u.files.map(f=>JSON.parse(f));let h;try{h=yield r.api(o).filter(i).middlewareOptions(be(za)).get()}catch{}let p=yield zP(r,h,za);return Vh()&&(yield a.putValue(o,{files:p.map(f=>JSON.stringify(f))})),p||null}),BP=(r,e)=>qe(void 0,void 0,void 0,function*(){if(!e||e.length===0)return[];let t=r.createBatch(),o=[],i,n;nc()&&(i=W.getCache(H.files,H.files.stores.fileQueries));for(let s of e)nc()&&(n=yield i.getValue(s)),nc()&&n&&mP()>Date.now()-n.timeCached?o.push(JSON.parse(n.file)):s!==""&&t.get(s,s,Sv);try{let s=yield t.executeAll();for(let a of e){let u=s.get(a);u?.content&&(o.push(u.content),nc()&&(yield i.putValue(a,{file:JSON.stringify(u.content)})))}return o}catch{try{return Promise.all(e.filter(a=>a&&a!=="").map(a=>qe(void 0,void 0,void 0,function*(){let u=yield So(r,a);if(u)return nc()&&(yield i.putValue(a,{file:JSON.stringify(u)})),u})))}catch{return[]}}}),zP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){if(!e)return[];let o=e.value,i=r.createBatch(),n=[];for(let s of o){let a=s.resourceReference.id;a!==""&&i.get(a,a,t)}try{let s=yield i.executeAll();for(let a of o){let u=s.get(a.resourceReference.id);u?.content&&n.push(u.content)}return n}catch{try{return Promise.all(o.filter(a=>!!a.resourceReference.id).map(a=>qe(void 0,void 0,void 0,function*(){return yield r.api(a.resourceReference.id).middlewareOptions(be(t)).get()})))}catch{return[]}}}),GF=(r,e)=>qe(void 0,void 0,void 0,function*(){return ls.create(r,e)}),jF=(r,e,t)=>ls.createFromValue(r,e.map(o=>JSON.parse(o)),t),KF=(r,e)=>qe(void 0,void 0,void 0,function*(){if(nc()){let t=yield r.getValue(e);if(t&&mP()>Date.now()-t.timeCached)return JSON.parse(t.file)}return null}),XC=(r,e,t)=>qe(void 0,void 0,void 0,function*(){if(r||(r=W.getCache(H.fileLists,e)),Vh()){let o=yield r.getValue(t);if(o&&qF()>Date.now()-o.timeCached)return o}return null}),ex=r=>qe(void 0,void 0,void 0,function*(){let e=r.nextLink;if(r.hasNext&&(yield r.next()),Vh()){let t=W.getCache(H.fileLists,H.fileLists.stores.fileLists),n=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(e)[3];yield t.putValue(n,{files:r.value.map(s=>JSON.stringify(s)),nextLink:e})}}),VP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){try{let o=yield r.api(e).responseType(vr.RAW).middlewareOptions(be(t)).get();if(o.status===404)return{eTag:null,thumbnail:null};if(!o.ok)return null;let i=o.headers.get("eTag"),n=yield lv(yield o.blob());return{eTag:i,thumbnail:n}}catch{return null}}),qP=(r,e)=>qe(void 0,void 0,void 0,function*(){try{return(yield r.api(e).middlewareOptions(be(Sv)).get())||null}catch{}return null}),GP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){try{let o={item:{"@microsoft.graph.conflictBehavior":t||"rename"}},i;try{i=yield r.api(e).middlewareOptions(be(_v)).post(JSON.stringify(o))}catch{}return i||null}catch{return null}}),jP=(r,e,t,o,i)=>qe(void 0,void 0,void 0,function*(){try{let n={"Content-Length":t,"Content-Range":o},s;try{s=yield r.client.api(e).middlewareOptions(be(_v)).headers(n).put(i)}catch{}return s||null}catch{return null}}),KP=(r,e,t)=>qe(void 0,void 0,void 0,function*(){try{let o;try{o=yield r.client.api(e).middlewareOptions(be(_v)).put(t)}catch{}return o||null}catch{return null}}),WP=(r,e)=>qe(void 0,void 0,void 0,function*(){try{yield r.client.api(e).middlewareOptions(be(_v)).delete()}catch{return null}})});var Tv,tx,qh,WF,Ev,QF,YF,ZF,JF,XF,eD,tD,rD,oD,QP,iD,YP,rx=y(()=>{l();c();d();ge();Bs();zh();Ua();Pd();Ni();Tv=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},tx="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id,accountEnabled",qh={directReports:"directReports",files:"files",messages:"messages",people:"people",person:"person"},WF=()=>W.config.users.invalidationPeriod||W.config.defaultInvalidationPeriod,Ev=(r,e,t)=>Tv(void 0,void 0,void 0,function*(){var o;let i=e?.id||e?.userPrincipalName,n=Do(e),s=W.getCache(H.users,H.users.stores.cardState),a=yield s.getValue(i);if(a&&WF()>Date.now()-a.timeCached)return a;let u="classification"in e||"personType"in e&&(e.personType.subclass==="PersonalContact"||e.personType.class==="Group"),h=r.createBatch();u||Ut.sections.organization&&(QF(h,i),Ut.sections.organization.showWorksWith&&ZF(h,i)),Ut.sections.mailMessages&&n&&XF(h,n),Ut.sections.files&&eD(h,t?null:n);let p,f={};try{p=yield h.executeAll()}catch{}if(p)for(let[b,C]of p)f[b]=((o=C.content)===null||o===void 0?void 0:o.value)||C.content;if(!u&&Ut.sections.profile)try{let b=yield rD(r,i);b&&(f.profile=b)}catch{}return f.directReports&&f.directReports.length>0&&(f.directReports=f.directReports.filter(b=>b.accountEnabled)),yield s.putValue(i,f),f}),QF=(r,e)=>{let t=`manager($levels=max;$select=${tx})`;r.get(qh.person,`users/${e}?$expand=${t}&$select=${tx}&$count=true`,Sd,{ConsistencyLevel:"eventual"}),r.get(qh.directReports,`users/${e}/directReports?$select=${tx}`)},YF=["People.Read.All"],ZF=(r,e)=>{r.get(qh.people,`users/${e}/people?$filter=personType/class eq 'Person'`,YF)},JF=["Mail.ReadBasic","Mail.Read","Mail.ReadWrite"],XF=(r,e)=>{r.get(qh.messages,`me/messages?$search="from:${e}"`,JF)},eD=(r,e)=>{let t;e?t=`me/insights/shared?$filter=lastshared/sharedby/address eq '${e}'`:t="me/insights/used",r.get(qh.files,t,za)},tD=["User.Read.All","User.ReadWrite.All"],rD=(r,e)=>Tv(void 0,void 0,void 0,function*(){return yield r.api(`/users/${e}/profile`).version("beta").middlewareOptions(be(tD)).get()}),oD=["Chat.Create","Chat.ReadWrite"],QP=(r,e,t)=>Tv(void 0,void 0,void 0,function*(){let o={chatType:"oneOnOne",members:[{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${t}')`},{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${e}')`}]};return yield r.api("/chats").header("Cache-Control","no-store").middlewareOptions(be(oD)).post(o)}),iD=["ChatMessage.Send","Chat.ReadWrite"],YP=(r,e,t)=>Tv(void 0,void 0,void 0,function*(){return yield r.api(`/chats/${e}/messages`).header("Cache-Control","no-store").middlewareOptions(be(iD)).post(t)})});var ZP,JP=y(()=>{l();c();d();xe();ZP=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{box-shadow:var(--person-card-box-shadow,var(--elevation-shadow-card-rest));width:var(--mgt-flyout-set-width,375px);overflow:hidden;user-select:none;border-radius:8px;background-color:var(--person-card-background-color,var(--neutral-layer-floating));--file-list-background-color:transparent;--file-list-box-shadow:none;--file-item-background-color:transparent}:host .small{max-height:100vh;overflow:hidden auto}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding-top:18px;padding-inline-start:12px;height:32px;width:32px}:host .nav__back svg{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,var(--neutral-foreground-rest))}:host .close-card-container{position:relative;z-index:100}:host .close-card-container .close-button{position:absolute;right:10px;margin-top:9px;z-index:1;border:1px solid transparent}:host .close-card-container .close-button svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .close-card-container .close-button:hover svg path{fill:var(--person-card-close-button-hover-color,var(--neutral-foreground-rest))}:host .person-details-container{display:flex;flex-direction:column;padding-inline-start:22px;padding-block:36px;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .person-details-container .person-image{--person-avatar-top-spacing:var(--person-card-avatar-top-spacing, 15px);--person-details-left-spacing:var(--person-card-details-left-spacing, 15px);--person-details-bottom-spacing:var(--person-card-details-bottom-spacing, 0);--person-background-color:var(--person-card-background-color, var(--neutral-layer-floating));--person-line1-font-size:var(--person-card-line1-font-size, 20px);--person-line1-font-weight:var(--person-card-line1-font-weight, 600);--person-line1-text-line-height:var(--person-card-line1-line-height, 28px);--person-line1-text-color:var(--person-card-line1-text-color, var(--neutral-foreground-rest));--person-line2-font-size:var(--person-card-line2-font-size, 14px);--person-line2-font-weight:var(--person-card-line2-font-weight, 400);--person-line2-text-line-height:var(--person-card-line2-line-height, 20px);--person-line2-text-color:var(--person-card-line2-text-color, var(--neutral-foreground-hint));--person-line3-font-size:var(--person-card-line3-font-size, 14px);--person-line3-font-weight:var(--person-card-line3-font-weight, 400);--person-line3-text-line-height:var(--person-card-line3-line-height, 19px);--person-line3-text-color:var(--person-card-line3-text-color, var(--neutral-foreground-hint));--person-avatar-size:var(--person-card-avatar-size, 75px);--person-presence-wrapper-bottom:-15px}:host .person-details-container .base-icons{display:flex;align-items:center;margin-inline-start:var(--person-card-base-icons-left-spacing,calc(var(--person-card-avatar-size,75px) + var(--person-card-details-left-spacing,15px) - 8px));z-index:1}:host .person-details-container .base-icons .icon{display:flex;align-items:center;font-size:13px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-inline-end:28px}:host .person-details-container .base-icons .icon svg .filled{display:none}:host .person-details-container .base-icons .icon svg .regular{display:block}:host .person-details-container .base-icons .icon svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .person-details-container .base-icons .icon:active svg .filled,:host .person-details-container .base-icons .icon:hover svg .filled{display:block}:host .person-details-container .base-icons .icon:active svg .regular,:host .person-details-container .base-icons .icon:hover svg .regular{display:none}:host .person-details-container .base-icons .icon:active svg path,:host .person-details-container .base-icons .icon:hover svg path{fill:var(--person-card-icon-hover-color,var(--accent-foreground-hover))}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;height:32px}:host .expanded-details-container .expanded-details-button svg path{stroke:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .expanded-details-container .expanded-details-button:hover{cursor:pointer;background-color:var(--person-card-expanded-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section{padding:20px 0;display:flex;flex-direction:column;position:relative}:host .expanded-details-container .sections .section:not(:last-child)::after{position:absolute;content:"";width:90%;transform:translateX(-50%);border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest));left:50%;bottom:0}:host .expanded-details-container .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .expanded-details-container .sections .section__title{flex-grow:1;color:var(--person-card-line1-text-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;line-height:19px}:host .expanded-details-container .sections .section__show-more{font-size:12px;font-weight:600;align-self:center;vertical-align:top;--base-height-multiplier:6}:host .expanded-details-container .sections .section__show-more:hover{background-color:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section__content{margin-top:14px}:host .expanded-details-container .sections .section .additional-details{padding:0 20px}:host .expanded-details-container .divider{z-index:100;position:relative;width:375px;margin:0;border-style:none;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .expanded-details-container .section-nav{height:35px}:host .expanded-details-container .section-nav fluent-tabs{grid-template-columns:minmax(1px,0.1fr)}:host .expanded-details-container .section-nav fluent-tabs.horizontal::part(activeIndicator){width:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel{max-height:360px;min-height:360px;overflow:hidden auto;padding:0;scrollbar-width:thin}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted{padding:20px 0;max-width:var(--mgt-flyout-set-width,375px);min-width:var(--mgt-flyout-set-width,360px);--file-list-box-shadow:none;--file-list-padding:0}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 20px;line-height:19px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .overview-panel{max-width:var(--mgt-flyout-set-width,375px)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-button{height:1px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track{border-radius:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab{padding-bottom:1px!important;border:1px solid transparent!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab:focus-visible{border:1px solid #2b2b2b!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon{cursor:pointer;box-sizing:border-box;width:53px;height:36px;display:flex;align-items:center;justify-content:center}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon svg{fill:var(--person-card-fluent-background-color,transparent)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon:hover{background:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover));border-radius:4px;z-index:0;position:relative}:host .expanded-details-container .section-host{min-height:360px;overflow:hidden auto}:host .expanded-details-container .section-host::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-host::-webkit-scrollbar-button{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .expanded-details-container .section-host::-webkit-scrollbar-track-piece{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-host.small{overflow-y:hidden}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .message-section{border-bottom:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint));display:flex}:host .message-section fluent-text-field{margin:10px 10px 10px 16px;--neutral-fill-input-rest:$person-card-background-color;--neutral-fill-input-hover:$person-card-chat-input-hover-color;--neutral-fill-input-focus:$person-card-chat-input-focus-color;width:300px;margin-inline-start:16px;border-radius:4px;border:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section .send-message-icon{max-width:15px;margin-top:10px}:host .message-section svg{height:17px;width:16px;fill:var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section svg:hover{filter:brightness(.5)}:host .message-section svg:disabled{filter:none}:host .person-root.large,:host .person-root.threelines{--person-avatar-size-3-lines:75px}:host fluent-button.close-button.lightweight::part(control),:host fluent-button.expanded-details-button::part(control),:host fluent-button.section__show-more.lightweight::part(control){background:var(--person-card-fluent-background-color,transparent)}:host fluent-button.icon::part(control),:host fluent-button.nav__back::part(control){border:none;padding:0;background:0 0}:host fluent-button.icon::part(control) :hover,:host fluent-button.nav__back::part(control) :hover{background:0 0}[dir=rtl] .base-icons{right:91px}[dir=rtl] .nav__back{width:20px!important;transform:scaleX(-1);filter:fliph;filter:"FlipH"}[dir=rtl] .close-card-container .close-button{right:auto;left:10px}[dir=rtl] .message-section svg{transform:scale(-1,1)}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var XP,e$=y(()=>{l();c();d();xe();XP=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}
`]});var dn,ox,qs=y(()=>{l();c();d();xe();ge();e$();ge();dn=()=>Re("spinner",ox),ox=class extends Lr{static get styles(){return XP}render(){return x`<fluent-progress-ring title="spinner"></fluent-progress-ring>`}}});var t$,r$,Ui,Gh=y(()=>{l();c();d();ge();xe();gt();qs();t$=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},r$=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Ui=class extends it{get isCompact(){return this._isCompact}constructor(){super(),this.personDetails=null,this.renderLoading=()=>Te`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `,this._isCompact=!1}asCompactView(){return this._isCompact=!0,this}asFullView(){return this._isCompact=!1,this}clearState(){this._isCompact=!1,this.personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderNoData(){return x`
      <div class="no-data">No data</div>
    `}navigateCard(e){var t;let o=this.parentNode;for(;o;){o=o.parentNode;let n=o;if(((t=n?.host)===null||t===void 0?void 0:t.tagName)===`${yr.prefix}-PERSON-CARD`.toUpperCase()){o=n.host;break}}o.navigate(e)}};t$([E({attribute:"person-details",type:Object}),r$("design:type",Object)],Ui.prototype,"personDetails",void 0);t$([X(),r$("design:type",Boolean)],Ui.prototype,"_isCompact",void 0)});var o$,i$=y(()=>{l();c();d();xe();o$=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__icon svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint))}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--contact-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .part .part__details .part__value{grid-column:2;color:var(--contact-value-color,var(--neutral-foreground-rest));font-size:14px;font-weight:400;line-height:19px}:host .root .part .part__details .part__value .part__link{color:var(--contact-link-color,var(--accent-foreground-rest));font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--contact-link-hover-color,var(--accent-foreground-hover))}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--contact-background-color,transparent);visibility:hidden;display:flex;align-items:center;justify-content:flex-start}:host .root .part .part__copy svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint));cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px;margin-bottom:2px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var n$,s$=y(()=>{l();c();d();n$={contactSectionTitle:"Contact",emailTitle:"Email",chatTitle:"Teams",businessPhoneTitle:"Business Phone",cellPhoneTitle:"Mobile Phone",departmentTitle:"Department",personTitle:"Title",officeLocationTitle:"Office Location",copyToClipboardButton:"Copy to clipboard"}});var a$,jh,Kh=y(()=>{l();c();d();xe();ge();pi();Bs();Gh();i$();Yr();s$();ge();a$=()=>{Re("contact",jh)},jh=class extends Ui{static get styles(){return o$}get strings(){return n$}get hasData(){return this._contactParts?!!Object.values(this._contactParts).filter(t=>!!t.value).length:!1}constructor(e){var t;super(),this._contactParts={email:{icon:Z(P.Email),onClick:()=>this.sendEmail(Do(this._person)),showCompact:!0,title:this.strings.emailTitle},chat:{icon:Z(P.Chat),onClick:()=>{var o;return this.sendChat((o=this._person)===null||o===void 0?void 0:o.userPrincipalName)},showCompact:!1,title:this.strings.chatTitle},businessPhone:{icon:Z(P.Phone),onClick:()=>{var o,i;return this.sendCall(((i=(o=this._person)===null||o===void 0?void 0:o.businessPhones)===null||i===void 0?void 0:i.length)>0?this._person.businessPhones[0]:null)},showCompact:!0,title:this.strings.businessPhoneTitle},cellPhone:{icon:Z(P.CellPhone),onClick:()=>{var o;return this.sendCall((o=this._person)===null||o===void 0?void 0:o.mobilePhone)},showCompact:!0,title:this.strings.cellPhoneTitle},department:{icon:Z(P.Department),showCompact:!1,title:this.strings.departmentTitle},title:{icon:Z(P.Person),showCompact:!1,title:this.strings.personTitle},officeLocation:{icon:Z(P.OfficeLocation),showCompact:!0,title:this.strings.officeLocationTitle}},this.sendCall=o=>{this.sendLink("tel:",o)},this._person=e,this._contactParts.email.value=Do(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,!((t=this._person.businessPhones)===null||t===void 0)&&t.length&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}get displayName(){return this.strings.contactSectionTitle}get cardTitle(){return this.strings.contactSectionTitle}renderIcon(){return Z(P.Contact)}clearState(){super.clearState();for(let e of Object.keys(this._contactParts))this._contactParts[e].value=null}renderCompactView(){if(!this.hasData)return null;let e=Object.values(this._contactParts).filter(i=>!!i.value),t=Object.values(e).filter(i=>!!i.value&&i.showCompact);t?.length||(t=Object.values(e).slice(0,2));let o=x`
      ${t.map(i=>this.renderContactPart(i))}
    `;return x`
      <div class="root compact" dir=${this.direction}>
        ${o}
      </div>
    `}renderFullView(){let e;if(this.hasData){let t=Object.values(this._contactParts).filter(o=>!!o.value);e=x`
        ${t.map(o=>this.renderContactPart(o))}
      `}return x`
      <div class="root" dir=${this.direction}>
        ${e}
      </div>
    `}renderContactPart(e){let t=!1;(e.title==="Mobile Phone"||e.title==="Business Phone")&&(t=!0);let o={part__link:!0,phone:t},i=e.onClick?x`
          <span class=${ze(o)} @click=${n=>e.onClick(n)}>${e.value}</span>
        `:x`
          ${e.value}
        `;return x`
      <div class="part" role="button" @click=${n=>this.handlePartClick(n,e.value)} tabindex="0">
        <div class="part__icon" aria-label=${e.title} title=${e.title}>${e.icon}</div>
        <div class="part__details">
          <div class="part__title">${e.title}</div>
          <div class="part__value" title=${e.title}>${i}</div>
        </div>
        <div
          class="part__copy"
          aria-label=${this.strings.copyToClipboardButton}
          title=${this.strings.copyToClipboardButton}
        >
          ${Z(P.Copy)}
        </div>
      </div>
    `}handlePartClick(e,t){t&&navigator.clipboard.writeText(t)}sendLink(e,t){t?window.open(`${e}${t}`,"_blank","noreferrer"):console.error(`\u{1F992}: Target resource for ${e} link was not provided: resource: ${t}`)}sendChat(e){if(!e){console.error("\u{1F992}: Can't send chat when upn is not provided");return}let t=`https://teams.microsoft.com/l/chat/0/0?users=${e}`,o=()=>window.open(t,"_blank","noreferrer");Sn.isAvailable?Sn.executeDeepLink(t,i=>{i||o()}):o()}sendEmail(e){this.sendLink("mailto:",e)}}});var nD,l$,$d,Va,sD,c$,d$,Iv,u$=y(()=>{l();c();d();Cc();({I:nD}=Kk),l$=()=>document.createComment(""),$d=(r,e,t)=>{let o=r._$AA.parentNode,i=e===void 0?r._$AB:e._$AA;if(t===void 0){let n=o.insertBefore(l$(),i),s=o.insertBefore(l$(),i);t=new nD(n,s,r,r.options)}else{let n=t._$AB.nextSibling,s=t._$AM,a=s!==r;if(a){let u;t._$AQ?.(r),t._$AM=r,t._$AP!==void 0&&(u=r._$AU)!==s._$AU&&t._$AP(u)}if(n!==i||a){let u=t._$AA;for(;u!==n;){let h=u.nextSibling;o.insertBefore(u,i),u=h}}}return t},Va=(r,e,t=r)=>(r._$AI(e,t),r),sD={},c$=(r,e=sD)=>r._$AH=e,d$=r=>r._$AH,Iv=r=>{r._$AP?.(!1,!0);let e=r._$AA,t=r._$AB.nextSibling;for(;e!==t;){let o=e.nextSibling;e.remove(),e=o}}});var h$,co,p$=y(()=>{l();c();d();Cc();qC();u$();h$=(r,e,t)=>{let o=new Map;for(let i=e;i<=t;i++)o.set(r[i],i);return o},co=nv(class extends wd{constructor(r){if(super(r),r.type!==iv.CHILD)throw Error("repeat() can only be used in text expressions")}dt(r,e,t){let o;t===void 0?t=e:e!==void 0&&(o=e);let i=[],n=[],s=0;for(let a of r)i[s]=o?o(a,s):s,n[s]=t(a,s),s++;return{values:n,keys:i}}render(r,e,t){return this.dt(r,e,t).values}update(r,[e,t,o]){let i=d$(r),{values:n,keys:s}=this.dt(e,t,o);if(!Array.isArray(i))return this.ut=s,n;let a=this.ut??=[],u=[],h,p,f=0,b=i.length-1,C=0,S=n.length-1;for(;f<=b&&C<=S;)if(i[f]===null)f++;else if(i[b]===null)b--;else if(a[f]===s[C])u[C]=Va(i[f],n[C]),f++,C++;else if(a[b]===s[S])u[S]=Va(i[b],n[S]),b--,S--;else if(a[f]===s[S])u[S]=Va(i[f],n[S]),$d(r,u[S+1],i[f]),f++,S--;else if(a[b]===s[C])u[C]=Va(i[b],n[C]),$d(r,i[f],i[b]),b--,C++;else if(h===void 0&&(h=h$(s,C,S),p=h$(a,f,b)),h.has(a[f]))if(h.has(a[b])){let R=p.get(s[C]),N=R!==void 0?i[R]:null;if(N===null){let ye=$d(r,i[f]);Va(ye,n[C]),u[C]=ye}else u[C]=Va(N,n[C]),$d(r,i[f],N),i[R]=null;C++}else Iv(i[b]),b--;else Iv(i[f]),f++;for(;C<=S;){let R=$d(r,u[S+1]);Va(R,n[C]),u[C++]=R}for(;f<=b;){let R=i[f++];R!==null&&Iv(R)}return this.ut=s,c$(r,u),is}})});var sc=y(()=>{l();c();d();p$()});var f$,m$=y(()=>{l();c();d();xe();f$=[Oe`
:host .file-upload-area-button{width:auto;display:flex;align-items:end;justify-content:end;margin-inline-end:36px;margin-top:30px}:host .focus,:host :focus{outline:0}:host fluent-button .upload-icon path{fill:var(--file-upload-button-text-color,var(--foreground-on-accent-rest))}:host fluent-button.file-upload-button::part(control){border:var(--file-upload-button-border,none);background:var(--file-upload-button-background-color,var(--accent-fill-rest))}:host fluent-button.file-upload-button::part(control):hover{background:var(--file-upload-button-background-color-hover,var(--accent-fill-hover))}:host fluent-button.file-upload-button .upload-text{color:var(--file-upload-button-text-color,var(--foreground-on-accent-rest));font-weight:400;line-height:20px}:host input{display:none}:host fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host fluent-dialog::part(overlay){opacity:.5}:host fluent-dialog::part(control){--dialog-width:$file-upload-dialog-width;--dialog-height:$file-upload-dialog-height;padding:var(--file-upload-dialog-padding,24px);border:var(--file-upload-dialog-border,1px solid var(--neutral-fill-rest))}:host fluent-dialog .file-upload-dialog-ok{background:var(--file-upload-dialog-keep-both-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-keep-both-button-border,none);color:var(--file-upload-dialog-keep-both-button-text-color,var(--foreground-on-accent-rest))}:host fluent-dialog .file-upload-dialog-ok:hover{background:var(--file-upload-dialog-keep-both-button-background-color-hover,var(--accent-fill-hover))}:host fluent-dialog .file-upload-dialog-cancel{background:var(--file-upload-dialog-replace-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-replace-button-border,1px solid var(--neutral-foreground-rest));color:var(--file-upload-dialog-replace-button-text-color,var(--neutral-foreground-rest))}:host fluent-dialog .file-upload-dialog-cancel:hover{background:var(--file-upload-dialog-replace-button-background-color-hover,var(--accent-fill-hover))}:host fluent-checkbox{margin-top:12px}:host fluent-checkbox .file-upload-dialog-check{color:var(--file-upload-dialog-text-color,--foreground-on-accent-rest)}:host .file-upload-table{display:flex}:host .file-upload-table.upload{display:flex}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell.percent-indicator{padding-inline-start:10px}:host .file-upload-table .file-upload-cell .description{opacity:.5;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:28px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-inline-start:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .mgt-file-item{--file-background-color:transparent;--file-padding:0 12px;--file-padding-inline-start:24px}:host .file-upload-template{clear:both}:host .file-upload-template .file-upload-folder-tab{padding-inline-start:20px}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-background-color,var(--accent-fill-rest));color:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));z-index:1;position:relative}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{display:flex;align-items:end;justify-content:end;gap:5px}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));padding-right:5px}:host .file-upload-dialog.visible{display:block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{cursor:pointer;opacity:.5}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border-drag,1px dashed #0078d4);background-color:var(--file-upload-background-color-drag,rgba(0,120,212,.1));position:absolute;inset:0;z-index:1;display:inline-block}[dir=rtl] :host .file-upload-status{left:0;right:28px}@media (forced-colors:active){:host fluent-button .upload-icon path{fill:highlighttext}:host fluent-button.file-upload-button::part(control){border-width:1px;border-style:solid;border-color:buttontext;background:highlight}:host fluent-button.file-upload-button::part(control):hover{background:highlighttext;border-color:highlight}:host fluent-button.file-upload-button .upload-text{color:highlighttext}:host fluent-button:hover .upload-icon path{fill:highlight}:host fluent-button:hover.file-upload-button::part(control){border-color:highlight;background:highlighttext}:host fluent-button:hover.file-upload-button .upload-text{color:highlight}}
`]});var Bt,g$=y(()=>{l();c();d();Bt={failUploadFile:"File upload failed",successUploadFile:"File upload succeeded",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep both",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep both files?',uploadButtonLabel:"File upload button"}});var v$,y$=y(()=>{l();c();d();xe();v$=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size);font-weight:var(--default-font-weight,400);border:var(--file-border,1px solid transparent);border-radius:var(--file-border-radius,4px);background-color:var(--file-background-color)}:host .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color);padding:var(--file-padding,0);margin:var(--file-margin,0)}:host .item:hover{background-color:var(--file-background-color-hover,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px);cursor:pointer;--secondary-text-color:var(--secondary-text-hover-color)}:host .item:focus,:host .item:focus-visible{background-color:var(--file-background-color-focus,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px)}:host .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1{font-size:var(--default-font-size);font-weight:var(--file-line1-font-weight,var(--default-font-weight,400));text-transform:var(--file-line1-text-transform,initial);line-height:20px;color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .item__details .line2{color:var(--file-line2-color,var(--secondary-text-color));font-size:var(--file-line2-font-size, var(--last-modified-font-size, 12px));font-weight:var(--file-line2-font-weight,var(--default-font-weight,400));text-transform:var(--file-line2-text-transform,initial);line-height:16px}:host .item__details .line3{color:var(--file-line3-color,var(--secondary-text-color));font-size:var(--file-line3-font-size, var(--size-font-size, 12px));font-weight:var(--file-line3-font-weight,var(--default-font-weight,400));text-transform:var(--file-line3-text-transform,initial);line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}
`]});var ix,nx,b$,w$,sx=y(()=>{l();c();d();ix={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},nx="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types",b$=(r,e,t)=>{let o=ix[r]||"genericfile";return`${nx}/${e.toString()}/${o}.${t}`},w$=(r,e,t)=>Object.keys(ix).find(i=>ix[i]===r)?`${nx}/${e.toString()}/${r}.${t}`:r==="jpg"||r==="png"?(r="photo",`${nx}/${e.toString()}/${r}.${t}`):null});var C$,x$=y(()=>{l();c();d();C$={modifiedSubtitle:"Modified",sizeSubtitle:"Size"}});var uo,ho,aD,Gs,dr,Od=y(()=>{l();c();d();xe();gt();y$();ge();Pd();Jo();Bh();sx();Yr();x$();ge();uo=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},ho=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},aD=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Gs=()=>Re("file",dr),dr=class extends it{static get styles(){return v$}get strings(){return C$}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}args(){return[this.providerState,this.fileQuery,this.siteId,this.itemId,this.driveId,this.itemPath,this.listId,this.groupId,this.userId,this.insightType,this.insightId,this.fileDetails,this.fileIcon]}constructor(){super(),this.renderContent=()=>{if(!this.driveItem)return this.renderNoData();let e=this.driveItem,t;if(t=this.renderTemplate("default",{file:e}),!t){let o=this.renderDetails(e),i=this.renderFileTypeIcon();t=x`
        <div class="item">
          ${i} ${o}
        </div>`}return t},this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view="threelines"}renderNoData(){return this.renderTemplate("no-data",null)||x``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return x``;let e,t="";if(this.fileIcon)e=this.fileIcon;else{let o=/(?:\.([^.]+))?$/;t=this.driveItem.package===void 0&&this.driveItem.folder===void 0?o.exec(this.driveItem.name)[1]?o.exec(this.driveItem.name)[1].toLowerCase():this.driveItem.size?"null":"folder":this.driveItem.package!==void 0&&this.driveItem.package.type==="oneNote"?"onetoc":"folder",e=w$(t,48,"svg")}return x`
      <div class="item__file-type-icon">
        ${e?x`
              <img src=${e} alt="${t.toUpperCase()} File icon" />
            `:x`
              ${Z(P.File)}
            `}
      </div>
    `}renderDetails(e){if(!e||this.view==="image")return x``;let t=[];if(this.view>"image"){let o=this.getTextFromProperty(e,this.line1Property);o&&t.push(x`
          <div class="line1" aria-label="${o}">${o}</div>
        `)}if(this.view>"oneline"){let o=this.getTextFromProperty(e,this.line2Property);o&&t.push(x`
          <div class="line2" aria-label="${o}">${o}</div>
        `)}if(this.view>"twolines"){let o=this.getTextFromProperty(e,this.line3Property);o&&t.push(x`
          <div class="line3" aria-label="${o}">${o}</div>
        `)}return x`
      <div class="item__details">
        ${t}
      </div>
    `}loadState(){return aD(this,void 0,void 0,function*(){if(this.fileDetails){this.driveItem=this.fileDetails;return}let e=V.globalProvider;if(!e||e.state===oe.Loading)return;if(e.state===oe.SignedOut){this.driveItem=null;return}let t=e.graph.forComponent(this),o,i=!this.driveId&&!this.siteId&&!this.groupId&&!this.listId&&!this.userId;this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?o=null:this.fileQuery?o=yield So(t,this.fileQuery):this.itemId&&i?o=yield wP(t,this.itemId):this.itemPath&&i?o=yield CP(t,this.itemPath):this.userId?this.itemId?o=yield _P(t,this.userId,this.itemId):this.itemPath?o=yield TP(t,this.userId,this.itemPath):this.insightType&&this.insightId&&(o=yield IP(t,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?o=yield gP(t,this.driveId,this.itemId):this.itemPath&&(o=yield vP(t,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?o=yield xP(t,this.siteId,this.itemId):this.itemPath&&(o=yield kP(t,this.siteId,this.itemPath)):this.listId?o=yield SP(t,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?o=yield yP(t,this.groupId,this.itemId):this.itemPath&&(o=yield bP(t,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(o=yield EP(t,this.insightType,this.insightId)),this.driveItem=o})}getTextFromProperty(e,t){if(!t||t.length===0)return null;let o=t.trim().split(","),i,n=0;for(;!i&&n<o.length;){let s=o[n].trim();switch(s){case"size":{let a="0";e.size&&(a=Fh(e.size)),i=`${this.strings.sizeSubtitle}: ${a}`;break}case"lastModifiedDateTime":{let a,u;if(e.lastModifiedDateTime){let h=new Date(e.lastModifiedDateTime);a=Hs(h),u=`${this.strings.modifiedSubtitle} ${a}`}else u="";i=u;break}default:i=e[s]}n++}return i}};uo([E({attribute:"file-query"}),ho("design:type",String)],dr.prototype,"fileQuery",void 0);uo([E({attribute:"site-id"}),ho("design:type",String)],dr.prototype,"siteId",void 0);uo([E({attribute:"drive-id"}),ho("design:type",String)],dr.prototype,"driveId",void 0);uo([E({attribute:"group-id"}),ho("design:type",String)],dr.prototype,"groupId",void 0);uo([E({attribute:"list-id"}),ho("design:type",String)],dr.prototype,"listId",void 0);uo([E({attribute:"user-id"}),ho("design:type",String)],dr.prototype,"userId",void 0);uo([E({attribute:"item-id"}),ho("design:type",String)],dr.prototype,"itemId",void 0);uo([E({attribute:"item-path"}),ho("design:type",String)],dr.prototype,"itemPath",void 0);uo([E({attribute:"insight-type"}),ho("design:type",String)],dr.prototype,"insightType",void 0);uo([E({attribute:"insight-id"}),ho("design:type",String)],dr.prototype,"insightId",void 0);uo([E({type:Object}),ho("design:type",Object)],dr.prototype,"fileDetails",void 0);uo([E({attribute:"file-icon"}),ho("design:type",String)],dr.prototype,"fileIcon",void 0);uo([E({type:Object}),ho("design:type",Object)],dr.prototype,"driveItem",void 0);uo([E({attribute:"line1-property"}),ho("design:type",String)],dr.prototype,"line1Property",void 0);uo([E({attribute:"line2-property"}),ho("design:type",String)],dr.prototype,"line2Property",void 0);uo([E({attribute:"line3-property"}),ho("design:type",String)],dr.prototype,"line3Property",void 0);uo([E({attribute:"view",converter:r=>Ed(r,"threelines")}),ho("design:type",String)],dr.prototype,"view",void 0)});var k$,S$,ac,ax,lD,cD,dD,_$,uD,Wh,lx=y(()=>{l();c();d();cr();ge();xe();gt();pi();Pd();Mr();Yr();Jo();m$();g$();ge();Od();k$=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},S$=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},ac=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},ax=r=>r.isDirectory,lD=r=>r.isFile,cD=r=>"getAsEntry"in r&&typeof r.getAsEntry=="function",dD=r=>"getAsFile"in r&&typeof r.getAsFile=="function"||"webkitGetAsEntry"in r&&typeof r.webkitGetAsEntry=="function",_$=()=>{at(pC,Or,Yl,Zw),Gs(),Re("file-upload",Wh)},uD=r=>r?.length>1?r[1]==="replace"?"replace":"rename":null,Wh=class extends kn{static get styles(){return f$}get strings(){return Bt}static get requiredScopes(){return[...new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"])]}get _dropEffect(){return"copy"}constructor(){super(),this._dragCounter=0,this._maxChunkSize=4*1024*1024,this._dialogTitle="",this._dialogContent="",this._dialogPrimaryButton="",this._dialogSecondaryButton="",this._dialogCheckBox="",this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.onFileUploadChange=e=>{let t=e.target;!e||t.files.length<1||this.readUploadedFiles(t.files,()=>t.value=null)},this.onFileUploadClick=()=>{this.renderRoot.querySelector("#file-upload-input").click()},this.handleonDragOver=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.dropEffect=e.dataTransfer.dropEffect=this._dropEffect)},this.handleonDragEnter=e=>{e.preventDefault(),e.stopPropagation(),this._dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.dropEffect=this._dropEffect,this.renderRoot.querySelector("#file-upload-border").classList.add("visible"))},this.handleonDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this._dragCounter--,this._dragCounter===0&&this.renderRoot.querySelector("#file-upload-border").classList.remove("visible")},this.handleonDrop=e=>{var t;e.preventDefault(),e.stopPropagation();let o=()=>{e.dataTransfer.clearData()};this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),!((t=e.dataTransfer)===null||t===void 0)&&t.items&&this.readUploadedFiles(e.dataTransfer.items,o),this._dragCounter=0},this.filesToUpload=[],this.addEventListener("__uploadfailed",this.focusOnUpload),this.addEventListener("__uploadsuccess",this.focusOnUpload)}focusOnUpload(){let e=this.renderRoot.querySelector('mgt-file[part="upload"]');e&&(e.setAttribute("tabindex","0"),e.classList.add("upload"),e.focus())}render(){if(this.parentElement!==null){let e=this.parentElement;e.addEventListener("dragenter",this.handleonDragEnter),e.addEventListener("dragleave",this.handleonDragLeave),e.addEventListener("dragover",this.handleonDragOver),e.addEventListener("drop",this.handleonDrop)}return x`
        <div id="file-upload-dialog" class="file-upload-dialog">
          <!-- Modal content -->
          <fluent-dialog modal="true" class="file-upload-dialog-content">
            <span
              class="file-upload-dialog-close"
              id="file-upload-dialog-close">
                ${Z(P.Cancel)}
            </span>
            <div class="file-upload-dialog-content-text">
              <h2 class="file-upload-dialog-title">${this._dialogTitle}</h2>
              <div>${this._dialogContent}</div>
                <fluent-checkbox
                  id="file-upload-dialog-check"
                  class="file-upload-dialog-check">
                    ${this._dialogCheckBox}
                </fluent-checkbox>
            </div>
            <div class="file-upload-dialog-editor">
              <fluent-button
                appearance="accent"
                class="file-upload-dialog-ok">
                ${this._dialogPrimaryButton}
              </fluent-button>
              <fluent-button
                appearance="outline"
                class="file-upload-dialog-cancel">
                ${this._dialogSecondaryButton}
              </fluent-button>
            </div>
          </fluent-dialog>
        </div>
        <div id="file-upload-border"></div>
        <div class="file-upload-area-button">
          <input
            id="file-upload-input"
            title="${this.strings.uploadButtonLabel}"
            tabindex="-1"
            aria-label="file upload input"
            type="file"
            multiple
            @change="${this.onFileUploadChange}"
          />
          <fluent-button
            appearance="accent"
            class="file-upload-button"
            @click=${this.onFileUploadClick}
            label=${this.strings.uploadButtonLabel}>
              <span slot="start">${Z(P.Upload)}</span>
              <span class="upload-text">${this.strings.buttonUploadFile}</span>
          </fluent-button>
        </div>
        <div class="file-upload-template">
          ${this.renderFolderTemplate(this.filesToUpload)}
        </div>
       `}renderFolderTemplate(e){let t=[];if(e.length>0){let o=e.map(i=>t.indexOf(i.fullPath.substring(0,i.fullPath.lastIndexOf("/")))===-1?i.fullPath.endsWith("/")?x`${this.renderFileTemplate(i,"")}`:(t.push(i.fullPath.substring(0,i.fullPath.lastIndexOf("/"))),Te`
            <div class='file-upload-table'>
              <div class='file-upload-cell'>
                <mgt-file
                  .fileDetails=${{name:i.fullPath.substring(1,i.fullPath.lastIndexOf("/")),folder:"Folder"}}
                  view="oneline"
                  class="mgt-file-item">
                </mgt-file>
              </div>
            </div>
            ${this.renderFileTemplate(i,"file-upload-folder-tab")}`):x`${this.renderFileTemplate(i,"file-upload-folder-tab")}`);return x`${o}`}return x``}renderFileTemplate(e,t){let o=ze({"file-upload-table":!0,upload:e.completed}),i=t+(e.fieldUploadResponse==="lastModifiedDateTime"?" file-upload-dialog-success":""),n=e.fieldUploadResponse==="description",s=ze({description:n}),a=e.completed?x``:this.renderFileUploadTemplate(e),u=n?Bt.failUploadFile:Bt.successUploadFile;return Te`
        <div class="${o}">
          <div class="${i}">
            <div class='file-upload-cell'>
              <div class="${s}">
                <div class="file-upload-status">
                  ${e.iconStatus}
                </div>
                <mgt-file
                  .fileDetails=${e.driveItem}
                  .view=${e.view}
                  .line2Property=${e.fieldUploadResponse}
                  aria-label="${e.driveItem.name} ${u}"
                  part="upload"
                  class="mgt-file-item">
                </mgt-file>
              </div>
            </div>
              ${a}
            </div>
          </div>
        </div>`}renderFileUploadTemplate(e){let t=ze({"file-upload-table":!0,upload:e.completed});return x`
    <div class='file-upload-cell'>
      <div class='file-upload-table file-upload-name'>
        <div class='file-upload-cell'>
          <div
            title="${e.file.name}"
            class='file-upload-filename'>
            ${e.file.name}
          </div>
        </div>
      </div>
      <div class='file-upload-table'>
        <div class='file-upload-cell'>
          <div class="${t}">
            <fluent-progress class="file-upload-bar" value="${e.percent}"></fluent-progress>
            <div class='file-upload-cell percent-indicator'>
              <span>${e.percent}%</span>
              <span
                class="file-upload-cancel"
                @click=${()=>this.deleteFileUploadSession(e)}>
                ${Z(P.Cancel)}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
    `}deleteFileUploadSession(e){return ac(this,void 0,void 0,function*(){try{e.uploadUrl!==void 0?(yield WP(this.fileUploadList.graph,e.uploadUrl),e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,Bt.cancelUploadFile)):(e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,Bt.cancelUploadFile))}catch{e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,Bt.cancelUploadFile)}})}readUploadedFiles(e,t){return ac(this,void 0,void 0,function*(){let o=yield this.getFilesFromUploadArea(e);yield this.getSelectedFiles(o),t()})}getSelectedFiles(e){return ac(this,void 0,void 0,function*(){let t=[],o=[];this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach(n=>{n.completed?o.push(n):t.push(n)});for(let n of e){let s=n.fullPath===""?"/"+n.name:n.fullPath;if(t.filter(a=>a.fullPath===s).length===0){let a=!0;if(this.fileUploadList.maxFileSize!==void 0&&a&&n.size>this.fileUploadList.maxFileSize*1024&&(a=!1,this._maximumFileSize===!1)){let u=yield this.getFileUploadStatus(n,s,"MaxFileSize",this.fileUploadList);u!==null&&u[0]===1&&(this._maximumFileSize=!0)}if(this.fileUploadList.excludedFileExtensions!==void 0&&this.fileUploadList.excludedFileExtensions.length>0&&a&&this.fileUploadList.excludedFileExtensions.filter(u=>n.name.toLowerCase().indexOf(u.toLowerCase())>-1).length>0&&(a=!1,this._excludedFileType===!1)){let u=yield this.getFileUploadStatus(n,s,"ExcludedFileType",this.fileUploadList);u!==null&&u[0]===1&&(this._excludedFileType=!0)}if(a){let u=yield this.getFileUploadStatus(n,s,"Upload",this.fileUploadList),h=!1;u!==null&&(u[0]===-1?h=!0:(this._applyAll=!!u[0],this._applyAllConflictBehavior=u[1]?1:0)),t.push({file:n,driveItem:{name:n.name},fullPath:s,conflictBehavior:uD(u),iconStatus:null,percent:1,view:"image",completed:h,maxSize:this._maxChunkSize,minSize:0})}}}t=t.sort((n,s)=>n.fullPath.substring(0,n.fullPath.lastIndexOf("/")).localeCompare(s.fullPath.substring(0,s.fullPath.lastIndexOf("/")))),t.forEach(n=>{if(o.filter(s=>s.fullPath===n.fullPath).length!==0){let s=o.findIndex(a=>a.fullPath===n.fullPath);o.splice(s,1)}}),t.push(...o),this.filesToUpload=t;let i=this.filesToUpload.map(n=>this.sendFileItemGraph(n));yield Promise.all(i)})}getFileUploadStatus(e,t,o,i){let n=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return ac(this,void 0,void 0,function*(){let s=this.renderRoot.querySelector("#file-upload-dialog");switch(o){case"Upload":return(yield qP(this.fileUploadList.graph,`${this.getGrapQuery(t)}?$select=id`))!==null?this._applyAll===!0?[this._applyAll,this._applyAllConflictBehavior]:(s.classList.add("visible"),this._dialogTitle=Bt.fileReplaceTitle,this._dialogContent=Bt.fileReplace.replace("{FileName}",e.name),this._dialogCheckBox=Bt.checkApplyAll,this._dialogPrimaryButton=Bt.buttonReplace,this._dialogSecondaryButton=Bt.buttonKeep,yield n.requestStateUpdate.call(this,!0),new Promise(u=>{let h=this.renderRoot.querySelector(".file-upload-dialog-close"),p=this.renderRoot.querySelector(".file-upload-dialog-ok"),f=this.renderRoot.querySelector(".file-upload-dialog-cancel"),b=this.renderRoot.querySelector("#file-upload-dialog-check");b.checked=!1,b.classList.remove("hide");let C=()=>{s.classList.remove("visible"),u([b.checked?1:0,"replace"])},S=()=>{s.classList.remove("visible"),u([b.checked?1:0,"rename"])},R=()=>{s.classList.remove("visible"),u([-1])};p.removeEventListener("click",C),f.removeEventListener("click",S),h.removeEventListener("click",R),p.addEventListener("click",C),f.addEventListener("click",S),h.addEventListener("click",R)})):null;case"ExcludedFileType":return s.classList.add("visible"),this._dialogTitle=Bt.fileTypeTitle,this._dialogContent=Bt.fileType.replace("{FileName}",e.name)+" ("+i.excludedFileExtensions.join(",")+")",this._dialogCheckBox=Bt.checkAgain,this._dialogPrimaryButton=Bt.buttonOk,this._dialogSecondaryButton=Bt.buttonCancel,yield n.requestStateUpdate.call(this,!0),new Promise(a=>{let u=this.renderRoot.querySelector(".file-upload-dialog-ok"),h=this.renderRoot.querySelector(".file-upload-dialog-cancel"),p=this.renderRoot.querySelector(".file-upload-dialog-close"),f=this.renderRoot.querySelector("#file-upload-dialog-check");f.checked=!1,f.classList.remove("hide");let b=()=>{s.classList.remove("visible"),a([f.checked?1:0])},C=()=>{s.classList.remove("visible"),a([0])};u.removeEventListener("click",b),h.removeEventListener("click",C),p.removeEventListener("click",C),u.addEventListener("click",b),h.addEventListener("click",C),p.addEventListener("click",C)});case"MaxFileSize":return s.classList.add("visible"),this._dialogTitle=Bt.maximumFileSizeTitle,this._dialogContent=Bt.maximumFileSize.replace("{FileSize}",Fh(i.maxFileSize*1024)).replace("{FileName}",e.name)+Fh(e.size)+".",this._dialogCheckBox=Bt.checkAgain,this._dialogPrimaryButton=Bt.buttonOk,this._dialogSecondaryButton=Bt.buttonCancel,yield n.requestStateUpdate.call(this,!0),new Promise(a=>{let u=this.renderRoot.querySelector(".file-upload-dialog-ok"),h=this.renderRoot.querySelector(".file-upload-dialog-cancel"),p=this.renderRoot.querySelector(".file-upload-dialog-close"),f=this.renderRoot.querySelector("#file-upload-dialog-check");f.checked=!1,f.classList.remove("hide");let b=()=>{s.classList.remove("visible"),a([f.checked?1:0])},C=()=>{s.classList.remove("visible"),a([0])};u.removeEventListener("click",b),h.removeEventListener("click",C),p.removeEventListener("click",C),u.addEventListener("click",b),h.addEventListener("click",C),p.addEventListener("click",C)});default:break}})}getGrapQuery(e){let t="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(t=this.fileUploadList.itemPath.startsWith("/")?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?`/users/${this.fileUploadList.userId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.userId&&this.fileUploadList.itemPath?`/users/${this.fileUploadList.userId}/drive/root:${t}${e}`:this.fileUploadList.groupId&&this.fileUploadList.itemId?`/groups/${this.fileUploadList.groupId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.groupId&&this.fileUploadList.itemPath?`/groups/${this.fileUploadList.groupId}/drive/root:${t}${e}`:this.fileUploadList.driveId&&this.fileUploadList.itemId?`/drives/${this.fileUploadList.driveId}/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.driveId&&this.fileUploadList.itemPath?`/drives/${this.fileUploadList.driveId}/root:${t}${e}`:this.fileUploadList.siteId&&this.fileUploadList.itemId?`/sites/${this.fileUploadList.siteId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.siteId&&this.fileUploadList.itemPath?`/sites/${this.fileUploadList.siteId}/drive/root:${t}${e}`:this.fileUploadList.itemId?`/me/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.itemPath?`/me/drive/root:${t}${e}`:`/me/drive/root:${e}`}sendFileItemGraph(e){return ac(this,void 0,void 0,function*(){let t=this.fileUploadList.graph,o="";if(e.file.size<this._maxChunkSize)try{e.completed||((e.conflictBehavior===null||e.conflictBehavior==="replace")&&(o=`${this.getGrapQuery(e.fullPath)}:/content`),e.conflictBehavior==="rename"&&(o=`${this.getGrapQuery(e.fullPath)}:/content?@microsoft.graph.conflictBehavior=rename`),e.driveItem=yield KP(t,o,e.file),e.driveItem!==null?this.setUploadSuccess(e):(e.driveItem={name:e.file.name},this.setUploadFail(e,Bt.failUploadFile)))}catch{this.setUploadFail(e,Bt.failUploadFile)}else if(!e.completed&&e.uploadUrl===void 0){let i=yield GP(t,`${this.getGrapQuery(e.fullPath)}:/createUploadSession`,e.conflictBehavior);try{if(i!==null){e.uploadUrl=i.uploadUrl;let n=yield this.sendSessionUrlGraph(t,e);n!==null?(e.driveItem=n,this.setUploadSuccess(e)):this.setUploadFail(e,Bt.failUploadFile)}else this.setUploadFail(e,Bt.failUploadFile)}catch{}}})}sendSessionUrlGraph(e,t){let o=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return ac(this,void 0,void 0,function*(){for(;t.file.size>t.minSize;){t.mimeStreamString===void 0&&(t.mimeStreamString=yield this.readFileContent(t.file));let i=new Blob([t.mimeStreamString.slice(t.minSize,t.maxSize)]);if(t.percent=Math.round(t.maxSize/t.file.size*100),yield o.requestStateUpdate.call(this,!0),t.uploadUrl!==void 0){let n=yield jP(e,t.uploadUrl,`${t.maxSize-t.minSize}`,`bytes ${t.minSize}-${t.maxSize-1}/${t.file.size}`,i);if(n===null)return null;if(fP(n))t.minSize=parseInt(n.nextExpectedRanges[0].split("-")[0],10),t.maxSize=t.minSize+this._maxChunkSize,t.maxSize>t.file.size&&(t.maxSize=t.file.size);else if(n.id!==void 0)return n}else return null}})}setUploadSuccess(e){e.percent=100,super.requestStateUpdate(!0),setTimeout(()=>{e.iconStatus=Z(P.Success),e.view="twolines",e.fieldUploadResponse="lastModifiedDateTime",e.completed=!0,super.requestStateUpdate(!0),kv(),this.fireCustomEvent("__uploadsuccess")},500)}setUploadFail(e,t){setTimeout(()=>{e.iconStatus=Z(P.Fail),e.view="twolines",e.driveItem.description=t,e.fieldUploadResponse="description",e.completed=!0,super.requestStateUpdate(!0),this.fireCustomEvent("__uploadfailed")},500)}readFileContent(e){return new Promise((t,o)=>{let i=new FileReader;i.onloadend=()=>{t(i.result)},i.onerror=n=>{o(n)},i.readAsArrayBuffer(e)})}getFilesFromUploadArea(e){return ac(this,void 0,void 0,function*(){let t=[],o,i=[];for(let n of e)if(dD(n))if(cD(n))if(o=n.getAsEntry(),ax(o))t.push(o);else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else if(n.webkitGetAsEntry)if(o=n.webkitGetAsEntry(),ax(o))t.push(o);else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else{let s=n.getAsFile();s&&(this.writeFilePath(s,""),i.push(s))}else this.writeFilePath(n,""),i.push(n);if(t.length>0){let n=yield this.getFolderFiles(t);i.push(...n)}return i})}getFolderFiles(e){return new Promise(t=>{let o=0,i=[];e.forEach(a=>{n(a,"")});let n=(a,u)=>{ax(a)?s(a.createReader()):lD(a)&&(o++,a.file(h=>{o--,this.writeFilePath(h,u),i.push(h),o===0&&t(i)}))},s=a=>{o++,a.readEntries(u=>{o--;for(let h of u)n(h,h.fullPath);o===0&&t(i)})}})}writeFilePath(e,t){e.fullPath=t}};k$([E({type:Object}),S$("design:type",Array)],Wh.prototype,"filesToUpload",void 0);k$([E({type:Object}),S$("design:type",Object)],Wh.prototype,"fileUploadList",void 0)});var T$,E$=y(()=>{l();c();d();xe();T$=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-1));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-list-children-show{display:block;margin-inline-start:calc(16px * 2)}:host .file-list-wrapper .file-list .file-list-children-show ul{list-style:none}:host .file-list-wrapper .file-list .file-list-children-show ul li{padding:8px 0}:host .file-list-wrapper .file-list .file-list-children-hide{display:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .file-list .file-item .file-list-children{background-color:beige}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size, 12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size, 12px)}:host .file-list-wrapper .shared_insight_file{display:flex;align-items:center;padding:11px 20px}:host .file-list-wrapper .shared_insight_file:hover{background-color:var(--file-item-background-color,var(--neutral-layer-1));cursor:pointer}:host .file-list-wrapper .shared_insight_file:last-child{margin-bottom:unset}:host .file-list-wrapper .shared_insight_file .shared_insight_file__icon{width:28px;min-width:28px;height:28px;margin-inline-end:12px;display:flex;align-items:center;justify-content:center}:host .file-list-wrapper .shared_insight_file .shared_insight_file__icon img{height:28px;width:28px}:host .file-list-wrapper .shared_insight_file .shared_insight_file__details{min-width:0;margin-inline-end:40px}:host .file-list-wrapper .shared_insight_file .shared_insight_file__details .shared_insight_file__name{font-size:var(--file-line1-font-size, var(--size-font-size, 12px));color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .file-list-wrapper .shared_insight_file .shared_insight_file__details .shared_insight_file__last-modified{font-size:var(--file-line3-font-size, var(--size-font-size, 12px));color:var(--file-line3-color,var(--secondary-text-color))}:host .file-list-wrapper .shared_insight_file .shared_insight_file__details>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
`]});var I$,A$=y(()=>{l();c();d();I$={showMoreSubtitle:"Show more items",filesSectionTitle:"Files",sharedTextSubtitle:"Shared"}});var ur,hr,R$,Qh,hD,Ft,Av=y(()=>{l();c();d();ge();xe();gt();sc();Pd();lx();Yr();Bh();E$();A$();Od();lx();cr();Mr();Jo();sx();ur=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},hr=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},R$=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Qh=()=>{at(Ph),Gs(),_$(),Re("file-list",Ft)},hD=r=>"lastShared"in r,Ft=class extends it{static get styles(){return T$}get strings(){return I$}get displayName(){return this.strings.filesSectionTitle}get cardTitle(){return this.strings.filesSectionTitle}renderIcon(){return Z(P.Files)}static get requiredScopes(){return[...new Set([...dr.requiredScopes])]}constructor(e){super(),this._isCompact=!1,this.fileQueries=null,this.files=null,this.itemView="threelines",this.fileExtensions=[],this.pageSize=10,this.disableOpenOnClick=!1,this.hideMoreFilesButton=!1,this.enableFileUpload=!1,this.maxUploadFile=10,this.excludedFileExtensions=[],this._preloadedFiles=[],this._focusedItemIndex=-1,this.renderLoading=()=>this.files?this.renderContent():this.renderTemplate("loading",null)||x``,this.renderContent=()=>!this.files||this.files.length===0?this.renderNoData():(this._personCardFiles&&(this.files=this._personCardFiles),this._isCompact?this.renderCompactView():this.renderFullView()),this.onFocusFirstItem=()=>this._focusedItemIndex=0,this.onFileListKeyDown=t=>{let o=t.target,i;o.classList?i=this.renderRoot.querySelector(".file-list"):i=this.renderRoot.querySelector(".file-list-children");let n;if(i?.children.length){if((t.code==="ArrowUp"||t.code==="ArrowDown")&&(t.code==="ArrowUp"&&(this._focusedItemIndex===-1&&(this._focusedItemIndex=i.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+i.children.length)%i.children.length),t.code==="ArrowDown"&&(this._focusedItemIndex=(this._focusedItemIndex+1)%i.children.length),n=i.children[this._focusedItemIndex],this.updateItemBackgroundColor(i,n,"focused")),t.code==="Enter"||t.code==="Space"){n=i.children[this._focusedItemIndex];let s=n.children[0];t.preventDefault(),this.fireCustomEvent("itemClick",s.fileDetails),this.handleFileClick(s.fileDetails),this.updateItemBackgroundColor(i,n,"selected")}t.code==="Tab"&&(n=i.children[this._focusedItemIndex])}},this.handleSharedInsightClick=(t,o)=>{var i;!((i=t.resourceReference)===null||i===void 0)&&i.webUrl&&!this.disableOpenOnClick&&(o.preventDefault(),window.open(t.resourceReference.webUrl,"_blank","noreferrer"))},this.handleFileClick=t=>{var o;if(((o=t?.folder)===null||o===void 0?void 0:o.childCount)>0&&t?.children){this.showChildren(t.id);return}t?.webUrl&&!this.disableOpenOnClick&&window.open(t.webUrl,"_blank","noreferrer")},this.showChildren=t=>{let o=this.renderRoot.querySelector(`#file-list-item-${t}`);this.renderChildren(t,o)},this.renderChildren=(t,o)=>{let i=yr.isDisambiguated?`${yr.prefix}-file-list`:"mgt-file-list",n=this.renderRoot.querySelector(`#file-list-children-${t}`);if(n)n.classList.contains("file-list-children-hide")?n.setAttribute("class","file-list-children-show"):n.setAttribute("class","file-list-children-hide");else{let s=document.createElement(i);s.setAttribute("item-id",t),s.setAttribute("id",`file-list-children-${t}`),s.setAttribute("class","file-list-children-show"),o.after(s)}},this._personCardFiles=e}clearState(){super.clearState(),this.files=null,this._personCardFiles=null}asCompactView(){return this._isCompact=!0,this}asFullView(){return this._isCompact=!1,this}args(){return[this.providerState,this.fileListQuery,this.fileQueries,this.siteId,this.driveId,this.groupId,this.itemId,this.itemPath,this.userId,this.insightType,this.fileExtensions,this.pageSize,this.maxFileSize]}renderCompactView(){let e=this.files.slice(0,3);return this.renderFiles(e)}renderFullView(){return this.renderTemplate("default",{files:this.files})||this.renderFiles(this.files)}renderNoData(){return this.renderTemplate("no-data",null)||(this.enableFileUpload===!0&&V.globalProvider!==void 0?x`
            <div class="file-list-wrapper" dir=${this.direction}>
              ${this.renderFileUpload()}
            </div>`:x``)}renderFiles(e){return x`
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        ${this.enableFileUpload?this.renderFileUpload():null}
        <ul
          id="file-list"
          class="file-list"
        >
          <li
            id="file-list-item-${this.files[0].id}"
            tabindex="0"
            class="file-item"
            @keydown="${this.onFileListKeyDown}"
            @focus="${this.onFocusFirstItem}"
            @click=${t=>this.handleItemSelect(e[0],t)}>
            ${this.renderFile(e[0])}
          </li>
          ${co(e.slice(1),t=>t.id,t=>x`
              <li
                id="file-list-item-${t.id}"
                class="file-item"
                @keydown="${this.onFileListKeyDown}"
                @click=${o=>this.handleItemSelect(t,o)}>
                ${this.renderFile(t)}
              </li>
            `)}
        </ul>
        ${!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)&&!this._isCompact?this.renderMoreFileButton():null}
      </div>
    `}renderFile(e){let t=this.itemView;return hD(e)?this.renderSharedInsightFile(e):this.renderTemplate("file",{file:e},e.id)||Te`
        <mgt-file class="mgt-file-item" .fileDetails=${e} .view=${t}></mgt-file>
      `}renderSharedInsightFile(e){let t=e.lastShared?x`
          <div class="shared_insight_file__last-modified">
            ${this.strings.sharedTextSubtitle} ${Hs(new Date(e.lastShared.sharedDateTime))}
          </div>
        `:null;return x`
      <div class="shared_insight_file" @click=${o=>this.handleSharedInsightClick(e,o)} tabindex="0">
        <div class="shared_insight_file__icon">
          <img alt="${e.resourceVisualization.title}" src=${b$(e.resourceVisualization.type,48,"svg")} />
        </div>
        <div class="shared_insight_file__details">
          <div class="shared_insight_file__name">${e.resourceVisualization.title}</div>
          ${t}
        </div>
      </div>
    `}renderMoreFileButton(){return this._isLoadingMore?x`
        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>
      `:x`
        <fluent-button
          appearance="stealth"
          id="show-more"
          class="show-more"
          @click=${()=>this.renderNextPage()}
        >
          <span class="show-more-text">${this.strings.showMoreSubtitle}</span>
        </fluent-button>`}renderFileUpload(){let e={graph:V.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return Te`
        <mgt-file-upload .fileUploadList=${e} ></mgt-file-upload>
      `}loadState(){var e,t,o,i;return R$(this,void 0,void 0,function*(){let n=V.globalProvider;if(!n||n.state===oe.Loading)return;if(n.state===oe.SignedOut){this.files=null;return}let s=n.graph.forComponent(this),a,u,h=!this.driveId&&!this.siteId&&!this.groupId&&!this.userId;if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){this.fileListQuery?u=yield NP(s,this.fileListQuery,this.pageSize):this.fileQueries?a=yield BP(s,this.fileQueries):h?this.itemId?u=yield $P(s,this.itemId,this.pageSize):this.itemPath?u=yield OP(s,this.itemPath,this.pageSize):this.insightType?a=yield HP(s,this.insightType):u=yield ZC(s,this.pageSize):this.driveId?this.itemId?u=yield JC(s,this.driveId,this.itemId,this.pageSize):this.itemPath&&(u=yield AP(s,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?u=yield RP(s,this.groupId,this.itemId,this.pageSize):this.itemPath&&(u=yield PP(s,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?u=yield MP(s,this.siteId,this.itemId,this.pageSize):this.itemPath&&(u=yield FP(s,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?u=yield DP(s,this.userId,this.itemId,this.pageSize):this.itemPath?u=yield LP(s,this.userId,this.itemPath,this.pageSize):this.insightType&&(a=yield UP(s,this.userId,this.insightType))),u&&(this.pageIterator=u,this._preloadedFiles=[...this.pageIterator.value],this._preloadedFiles.length>=this.pageSize?a=this._preloadedFiles.splice(0,this.pageSize):a=this._preloadedFiles.splice(0,this._preloadedFiles.length));let p;if(((e=this.fileExtensions)===null||e===void 0?void 0:e.length)>0){if(!((t=this.pageIterator)===null||t===void 0)&&t.value){let f=yield ZC(s,1e3);for(;f.hasNext;)yield ex(f);this.pageIterator=ls.createFromValue(s,f.value),a=this.pageIterator.value,this._preloadedFiles=[]}p=a.filter(f=>{for(let b of this.fileExtensions)if(b===this.getFileExtension(f.name))return f}),this._preloadedFiles=[...p]}p?.length>=0?(this.files=p,this.pageSize&&(a=this.files.splice(0,this.pageSize),this.files=a)):this.files=a}for(let p of this.files)if(((o=p?.folder)===null||o===void 0?void 0:o.childCount)>0){let f=(i=p?.parentReference)===null||i===void 0?void 0:i.driveId,b=p?.id,C=yield JC(s,f,b,5);if(C){let S=[...C.value];p.children=S}}})}handleItemSelect(e,t){if(this.handleFileClick(e),this.fireCustomEvent("itemClick",e),t){let o=this.renderRoot.querySelector(".file-list"),i=Array.from(o.children),n=t.target.closest("li"),s=i.indexOf(n);this._focusedItemIndex=s;let a=o.children[this._focusedItemIndex];this.updateItemBackgroundColor(o,a,"selected")}}renderNextPage(){return R$(this,void 0,void 0,function*(){if(this._preloadedFiles.length>0)this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))];else if(this.pageIterator.hasNext){this._isLoadingMore=!0;let e=this.renderRoot.querySelector("#file-list-wrapper");e?.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),yield ex(this.pageIterator),this._isLoadingMore=!1,this.files=this.pageIterator.value}this.requestUpdate()})}getFileExtension(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}updateItemBackgroundColor(e,t,o){for(let i of e.children)i.classList.remove(o),i.removeAttribute("tabindex");t&&(t.classList.add(o),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),t.setAttribute("tabindex","0"),t.focus());for(let i of e.children)i.classList.remove("selected")}reload(e=!1){e&&kv(),this._task.run()}};ur([X(),hr("design:type",Object)],Ft.prototype,"_isCompact",void 0);ur([X(),hr("design:type",Array)],Ft.prototype,"_personCardFiles",void 0);ur([E({attribute:"file-list-query"}),hr("design:type",String)],Ft.prototype,"fileListQuery",void 0);ur([E({attribute:"file-queries",converter:(r,e)=>r?r.split(",").map(t=>t.trim()):null}),hr("design:type",Array)],Ft.prototype,"fileQueries",void 0);ur([E({type:Object}),hr("design:type",Array)],Ft.prototype,"files",void 0);ur([E({attribute:"site-id"}),hr("design:type",String)],Ft.prototype,"siteId",void 0);ur([E({attribute:"drive-id"}),hr("design:type",String)],Ft.prototype,"driveId",void 0);ur([E({attribute:"group-id"}),hr("design:type",String)],Ft.prototype,"groupId",void 0);ur([E({attribute:"item-id"}),hr("design:type",String)],Ft.prototype,"itemId",void 0);ur([E({attribute:"item-path"}),hr("design:type",String)],Ft.prototype,"itemPath",void 0);ur([E({attribute:"user-id"}),hr("design:type",String)],Ft.prototype,"userId",void 0);ur([E({attribute:"insight-type"}),hr("design:type",String)],Ft.prototype,"insightType",void 0);ur([E({attribute:"item-view",converter:r=>Ed(r,"threelines")}),hr("design:type",String)],Ft.prototype,"itemView",void 0);ur([E({attribute:"file-extensions",converter:(r,e)=>r.split(",").map(t=>t.trim())}),hr("design:type",Array)],Ft.prototype,"fileExtensions",void 0);ur([E({attribute:"page-size",type:Number}),hr("design:type",Object)],Ft.prototype,"pageSize",void 0);ur([E({attribute:"disable-open-on-click",type:Boolean}),hr("design:type",Object)],Ft.prototype,"disableOpenOnClick",void 0);ur([E({attribute:"hide-more-files-button",type:Boolean}),hr("design:type",Object)],Ft.prototype,"hideMoreFilesButton",void 0);ur([E({attribute:"max-file-size",type:Number}),hr("design:type",Number)],Ft.prototype,"maxFileSize",void 0);ur([E({attribute:"enable-file-upload",type:Boolean}),hr("design:type",Object)],Ft.prototype,"enableFileUpload",void 0);ur([E({attribute:"max-upload-file",type:Number}),hr("design:type",Object)],Ft.prototype,"maxUploadFile",void 0);ur([E({attribute:"excluded-file-extensions",converter:(r,e)=>r.split(",").map(t=>t.trim())}),hr("design:type",Array)],Ft.prototype,"excludedFileExtensions",void 0);ur([X(),hr("design:type",Boolean)],Ft.prototype,"_isLoadingMore",void 0)});var P$,$$=y(()=>{l();c();d();xe();P$=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--message-hover-color,var(--neutral-fill-hover));cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--message-subject-color,var(--neutral-foreground-color));font-size:var(--message-subject-font-size, 14px);font-weight:var(--message-subject-font-weight,600);line-height:var(--message-subject-line-height, 20px)}:host .root .message .message__detail .message__from{font-size:var(--message-from-font-size, 12px);color:var(--message-from-color,var(--neutral-foreground-color));line-height:var(--message-from-line-height, 16px);font-weight:var(--message-from-font-weight,400)}:host .root .message .message__detail .message__message{font-size:var(--message-from-font-size, 12px);color:var(--message-color,var(--neutral-foreground-hint));line-height:var(--message-from-line-height, 16px);font-weight:var(--message-from-font-weight,400)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{margin-top:8px;font-size:12px;color:var(--message-date-color,var(--neutral-foreground-hint));margin-left:10px;white-space:nowrap}
`]});var O$,M$=y(()=>{l();c();d();O$={emailsSectionTitle:"Emails"}});var pD,fD,F$,Md,Rv=y(()=>{l();c();d();xe();Gh();Yr();Jo();$$();M$();ge();gt();pD=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},fD=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},F$=()=>Re("messages",Md),Md=class extends Ui{static get styles(){return P$}get strings(){return O$}constructor(e){super(),this._messages=e}get displayName(){return this.strings.emailsSectionTitle}get cardTitle(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return Z(P.Messages)}renderCompactView(){var e;let t;if(!(!((e=this._messages)===null||e===void 0)&&e.length))t=this.renderNoData();else{let o=this._messages?this._messages.slice(0,3).map(i=>this.renderMessage(i)):[];t=x`
         ${o}
       `}return x`
       <div class="root compact">
         ${t}
       </div>
     `}renderFullView(){var e;let t;return!((e=this._messages)===null||e===void 0)&&e.length?t=x`
         ${this._messages.slice(0,5).map(o=>this.renderMessage(o))}
       `:t=this.renderNoData(),x`
       <div class="root">
         ${t}
       </div>
     `}renderMessage(e){return x`
       <div class="message" @click=${()=>this.handleMessageClick(e)}>
         <div class="message__detail">
           <div class="message__subject">${e.subject}</div>
           <div class="message__from">${e.from.emailAddress.name}</div>
           <div class="message__message">${e.bodyPreview}</div>
         </div>
         <div class="message__date">${Hs(new Date(e.receivedDateTime))}</div>
       </div>
     `}handleMessageClick(e){window.open(e.webLink,"_blank","noreferrer")}};pD([X(),fD("design:type",Array)],Md.prototype,"_messages",void 0)});var D$,L$=y(()=>{l();c();d();xe();D$=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__person-image{height:40px;width:40px;border-radius:40px;--person-avatar-size:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .subtitle{color:var(--organization-sub-title-color,var(--neutral-foreground-hint));font-size:14px;margin:0 20px 8px}:host .root .divider{display:flex;background:var(--organization-coworker-border-color,var(--neutral-stroke-rest));height:1px;margin:26px 20px 18px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-inline:20px}:host .root .org-member.org-member--target{background-color:var(--organization-active-org-member-target-background-color,var(--neutral-fill-active));border:1px solid var(--organization-active-org-member-border-color,var(--accent-foreground-rest))}:host .root .org-member:not(.org-member--target){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest))}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--organization-hover-color,var(--neutral-fill-hover))}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__person .org-member__person-image{--person-avatar-size:var(--organization-member-person-avatar-size, 40px)}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--organization-title-color,var(--neutral-foreground-rest));font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--organization-sub-title-color,var(--neutral-foreground-hint))}:host .root .org-member__separator:not(:last-child){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest));box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--organization-coworker-hover-color,var(--neutral-fill-hover))}:host .root .coworker .coworker__person{height:46px;border-radius:46px;margin-right:8px}:host .root .coworker .coworker__person .coworker__person-image{--person-avatar-size:var(--organization-coworker-person-avatar-size, 40px)}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{margin-right:4px;padding:4px 0;cursor:pointer}:host .root .direct-report-list{border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest));margin-inline:20px}:host .root .direct-report-list .org-member--direct-report{border:none;cursor:pointer;margin-inline:0}:host .root .direct-report-list .org-member--direct-report .direct-report__person-image{--person-avatar-size:var(--organization-direct-report-person-avatar-size, 38px)}[dir=rtl] .org-member .org-member__more{transform:scaleX(-1);filter:fliph;filter:"FlipH"}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`]});var N$,H$=y(()=>{l();c();d();N$={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"}});var U$,B$,z$,lc,Pv=y(()=>{l();c();d();xe();Gh();Yr();L$();H$();ge();ge();un();gt();U$=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},B$=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},z$=()=>{Lo(),Re("organization",lc)},lc=class extends Ui{static get styles(){return D$}get strings(){return N$}constructor(e,t){super(),this._state=e,this._me=t}clearState(){super.clearState(),this._state=void 0,this._me=void 0}get displayName(){let{person:e,directReports:t}=this._state;return!e.manager&&t?.length?`${this.strings.directReportsSectionTitle} (${t.length})`:this.strings.reportsToSectionTitle}get cardTitle(){return this.strings.organizationSectionTitle}renderIcon(){return Z(P.Organization)}renderCompactView(){var e;let t;if(!(!((e=this._state)===null||e===void 0)&&e.person))return null;let{person:o,directReports:i}=this._state;if(o)o.manager?t=this.renderCoworker(o.manager):i?.length&&(t=this.renderCompactDirectReports());else return null;return x`
        <div class="root compact">
          ${t}
        </div>
      `}renderFullView(){var e;let t;if(!(!((e=this._state)===null||e===void 0)&&e.person))return null;let{person:o,directReports:i,people:n}=this._state;if(!o&&!i&&!n)return null;{let s=this.renderManagers(),a=this.renderCurrentUser(),u=this.renderDirectReports(),h=this.renderCoworkers();t=x`
          ${s} ${a} ${u} ${h}
        `}return x`
       <div class="root" dir=${this.direction}>
         ${t}
       </div>
     `}renderManager(e){return Te`
      <div
        class="org-member"
        @keydown=${t=>{(t.code==="Enter"||t.code===" ")&&this.navigateCard(e)}}
        @click=${()=>this.navigateCard(e)}
      >
        <div class="org-member__person">
          <mgt-person
            class="org-member__person-image"
            .personDetails=${e}
            .fetchImage=${!0}
            view="twolines"
            .showPresence=${!0}
          ></mgt-person>
        </div>
        <div tabindex="0" class="org-member__more">
          ${Z(P.ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
     `}renderManagers(){let{person:e}=this._state;if(!e?.manager)return null;let t=[],o=e;for(;o.manager;)t.push(o.manager),o=o.manager;return t.length?t.reverse().map(i=>this.renderManager(i)):null}renderDirectReports(){let{directReports:e}=this._state;return e?.length?x`
      <div class="org-member__separator"></div>
      <div class="direct-report-list">
        ${e.map(t=>Te`
            <div
              class="org-member org-member--direct-report"
              @keydown=${o=>{(o.code==="Enter"||o.code===" ")&&this.navigateCard(t)}}
              @click=${()=>this.navigateCard(t)}
            >
              <div class="org-member__person">
                <mgt-person
                  class="org-member__person-image"
                  .personDetails=${t}
                  .fetchImage=${!0}
                  .showPresence=${!0}
                  view="twolines"
                ></mgt-person>
              </div>
              <div tabindex="0" class="org-member__more">
                ${Z(P.ExpandRight)}
              </div>
            </div>
          `)}
      </div>
     `:null}renderCompactDirectReports(){let{directReports:e}=this._state;return x`
      <div class="direct-report__compact">
        ${e.slice(0,6).map(t=>Te`
            <div
              class="direct-report"
              @keydown=${o=>{(o.code==="Enter"||o.code===" ")&&this.navigateCard(t)}}
              @click=${()=>this.navigateCard(t)}
            >
              <mgt-person
                class="direct-report__person-image"
                .personDetails=${t}
                .fetchImage=${!0}
                .showPresence=${!0}
                view="twolines"
              ></mgt-person>
            </div>
          `)}
      </div>
    `}renderCurrentUser(){let{person:e}=this._state;return Te`
       <div class="org-member org-member--target">
         <div class="org-member__person">
           <mgt-person
              class="org-member__person-image"
             .personDetails=${e}
             .fetchImage=${!0}
             .showPresence=${!0}
             view="twolines"
           ></mgt-person>
         </div>
       </div>
     `}renderCoworker(e){return Te`
      <div
        class="coworker"
        @keydown=${t=>{(t.code==="Enter"||t.code===" ")&&this.navigateCard(e)}}
        @click=${()=>this.navigateCard(e)}
      >
        <div class="coworker__person">
          <mgt-person
            class="coworker__person-image"
            .personDetails=${e}
            .fetchImage=${!0}
            .showPresence=${!0}
            view="twolines"
          ></mgt-person>
        </div>
      </div>
    `}renderCoworkers(){let{people:e}=this._state;if(!e?.length)return null;let t=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return x`
       <div class="divider"></div>
       <div class="subtitle" tabindex="0">${t}</div>
       <div>
         ${e.slice(0,6).map(o=>this.renderCoworker(o))}
       </div>
     `}};U$([X(),B$("design:type",Object)],lc.prototype,"_state",void 0);U$([X(),B$("design:type",Object)],lc.prototype,"_me",void 0)});var V$,q$=y(()=>{l();c();d();xe();V$=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none;background-color:var(--profile-background-color,--neutral-layer-1)}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--profile-title-color,var(--neutral-foreground-rest));margin:0 20px 12px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-flow:row wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--profile-token-item-background-color,var(--neutral-fill-secondary-rest));border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--profile-token-item-color,var(--neutral-foreground-rest))}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset;background:0 0;color:var(--profile-token-overflow-color,var(--accent-foreground-rest))}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--profile-title-color,var(--neutral-foreground-rest))}:host .root .data-list__item .data-list__item__date-range{color:var(--profile-section-title-color,var(--neutral-foreground-hint));font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#023b8f}:host .root .work-position .work-position__location{font-size:10px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--profile-title-color,var(--neutral-foreground-rest))}[dir=rtl] .token-list__item{margin-right:0!important}
`]});var G$,j$=y(()=>{l();c();d();G$={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current",socialMediaSubSectionTitle:"Social Media"}});var mD,K$,W$,Fd,$v=y(()=>{l();c();d();xe();Gh();Yr();q$();j$();ge();gt();mD=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},K$=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},W$=()=>Re("profile",Fd),Fd=class extends Ui{static get styles(){return V$}get strings(){return G$}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get cardTitle(){return this.strings.AboutCompactSectionTitle}get hasData(){var e,t;if(!this.profile)return!1;let{languages:o,skills:i,positions:n,educationalActivities:s}=this.profile;return[this._birthdayAnniversary,(e=this._personalInterests)===null||e===void 0?void 0:e.length,(t=this._professionalInterests)===null||t===void 0?void 0:t.length,o?.length,i?.length,n?.length,s?.length].filter(a=>!!a).length>0}get profile(){return this._profile}set profile(e){e!==this._profile&&(this._profile=e,this._birthdayAnniversary=e?.anniversaries?e.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=e?.interests?e.interests.filter(this.isPersonalInterest):null,this._professionalInterests=e?.interests?e.interests.filter(this.isProfessionalInterest):null)}constructor(e){super(),this.isPersonalInterest=t=>{var o;return(o=t.categories)===null||o===void 0?void 0:o.includes("personal")},this.isProfessionalInterest=t=>{var o;return(o=t.categories)===null||o===void 0?void 0:o.includes("professional")},this.isBirthdayAnniversary=t=>t.type==="birthday",this.profile=e}renderIcon(){return Z(P.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return x`
       <div class="root compact" dir=${this.direction}>
         ${this.renderSubSections().slice(0,2)}
       </div>
     `}renderFullView(){return this.initPostRenderOperations(),x`
       <div class="root" dir=${this.direction}>
         ${this.renderSubSections()}
       </div>
     `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter(t=>!!t)}renderLanguages(){var e;let{languages:t}=this._profile;if(!t?.length)return null;let o=[];for(let n of t){let s=null;!((e=n.proficiency)===null||e===void 0)&&e.length&&(s=x`
           <span class="language__proficiency" tabindex="0">
             &nbsp;(${n.proficiency})
           </span>
         `),o.push(x`
         <div class="token-list__item language">
           <span class="language__title" tabindex="0">${n.displayName}</span>
           ${s}
         </div>
       `)}let i=o.length?this.strings.LanguagesSubSectionTitle:"";return x`
       <section>
         <div class="section__title" tabindex="0">${i}</div>
         <div class="section__content">
           <div class="token-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderSkills(){let{skills:e}=this._profile;if(!e?.length)return null;let t=[];for(let i of e)t.push(x`
         <div class="token-list__item skill" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.SkillsSubSectionTitle:"";return x`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderWorkExperience(){var e,t,o,i,n;let{positions:s}=this._profile;if(!s?.length)return null;let a=[];for(let h of this._profile.positions)(h.detail.description||h.detail.jobTitle!=="")&&a.push(x`
           <div class="data-list__item work-position">
             <div class="data-list__item__header">
               <div class="data-list__item__title" tabindex="0">${(e=h.detail)===null||e===void 0?void 0:e.jobTitle}</div>
               <div class="data-list__item__date-range" tabindex="0">
                 ${this.getDisplayDateRange(h.detail)}
               </div>
             </div>
             <div class="data-list__item__content">
               <div class="work-position__company" tabindex="0">
                 ${(o=(t=h?.detail)===null||t===void 0?void 0:t.company)===null||o===void 0?void 0:o.displayName}
               </div>
               <div class="work-position__location" tabindex="0">
                 ${this.displayLocation((n=(i=h?.detail)===null||i===void 0?void 0:i.company)===null||n===void 0?void 0:n.address)}
               </div>
             </div>
           </div>
         `);let u=a.length?this.strings.WorkExperienceSubSectionTitle:"";return x`
       <section>
         <div class="section__title" tabindex="0">${u}</div>
         <div class="section__content">
           <div class="data-list">
             ${a}
           </div>
         </div>
       </section>
     `}renderEducation(){let{educationalActivities:e}=this._profile;if(!e?.length)return null;let t=[];for(let i of e)t.push(x`
         <div class="data-list__item educational-activity">
           <div class="data-list__item__header">
             <div class="data-list__item__title" tabindex="0">${i.institution.displayName}</div>
             <div class="data-list__item__date-range" tabindex="0">
               ${this.getDisplayDateRange(i)}
             </div>
           </div>
           ${i.program.displayName?x`<div class="data-list__item__content">
                  <div class="educational-activity__degree" tabindex="0">
                  ${i.program.displayName}
                </div>`:ot}
         </div>
       `);let o=t.length?this.strings.EducationSubSectionTitle:"";return x`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="data-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderProfessionalInterests(){var e;if(!(!((e=this._professionalInterests)===null||e===void 0)&&e.length))return null;let t=[];for(let i of this._professionalInterests)t.push(x`
         <div class="token-list__item interest interest--professional" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.professionalInterestsSubSectionTitle:"";return x`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderPersonalInterests(){var e;if(!(!((e=this._personalInterests)===null||e===void 0)&&e.length))return null;let t=[];for(let i of this._personalInterests)t.push(x`
         <div class="token-list__item interest interest--personal" tabindex="0">
           ${i.displayName}
         </div>
       `);let o=t.length?this.strings.personalInterestsSubSectionTitle:"";return x`
       <section>
         <div class="section__title" tabindex="0">${o}</div>
         <div class="section__content">
           <div class="token-list">
             ${t}
           </div>
         </div>
       </section>
     `}renderBirthday(){var e;return!((e=this._birthdayAnniversary)===null||e===void 0)&&e.date?x`
       <section>
         <div class="section__title" tabindex="0">Birthday</div>
         <div class="section__content">
           <div class="birthday">
             <div class="birthday__icon">
               ${Z(P.Birthday)}
             </div>
             <div class="birthday__date" tabindex="0">
               ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
             </div>
           </div>
         </div>
       </section>
     `:null}getDisplayDate(e){return e.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(e){if(!e.startMonthYear)return ot;let t=new Date(e.startMonthYear).getFullYear();if(t===0||t===1)return ot;let o=e.endMonthYear?new Date(e.endMonthYear).getFullYear():this.strings.currentYearSubtitle;return`${t} \u2014 ${o}`}displayLocation(e){return e?.city?e.state?`${e.city}, ${e.state}`:e.city:ot}initPostRenderOperations(){setTimeout(()=>{try{this.shadowRoot.querySelectorAll("section").forEach(t=>{this.handleTokenOverflow(t)})}catch{}},0)}handleTokenOverflow(e){let t=e.querySelectorAll(".token-list");if(t?.length)for(let o of Array.from(t)){let i=o.querySelectorAll(".token-list__item");if(!i?.length)continue;let n=null,s=i[0].getBoundingClientRect(),a=o.getBoundingClientRect(),u=s.height*2+a.top;for(let h=0;h<i.length-1;h++)if(s=i[h].getBoundingClientRect(),s.top>u){n=Array.from(i).slice(h,i.length);break}if(n){n.forEach(f=>f.classList.add("overflow"));let h=document.createElement("div");h.classList.add("token-list__item"),h.classList.add("token-list__item--show-overflow"),h.tabIndex=0,h.innerText=`+ ${n.length} more`;let p=()=>{h.remove(),n.forEach(f=>f.classList.remove("overflow"))};h.addEventListener("click",()=>{p()}),h.addEventListener("keydown",f=>{f.code==="Enter"&&p()}),o.appendChild(h)}}}};mD([E({attribute:!1}),K$("design:type",Object),K$("design:paramtypes",[Object])],Fd.prototype,"profile",null)});var Q$,cx=y(()=>{l();c();d();zh();Q$=()=>{let r=[];return Ut.sections.files&&r.push("Sites.Read.All"),Ut.sections.mailMessages&&(r.push("Mail.Read"),r.push("Mail.ReadBasic")),Ut.sections.organization&&(r.push("User.Read.All"),Ut.sections.organization.showWorksWith&&r.push("People.Read.All")),Ut.sections.profile&&r.push("User.Read.All"),Ut.useContactApis&&r.push("Contacts.Read"),r.indexOf("User.Read.All")<0&&(r.push("User.ReadBasic.All"),r.push("User.Read")),r.indexOf("People.Read.All")<0&&r.push("People.Read"),Ut.isSendMessageVisible&&r.push("Chat.ReadWrite"),[...new Set(r)]}});var Y$,Z$=y(()=>{l();c();d();Y$={showMoreSectionButton:"Show more",endOfCard:"End of the card",quickMessage:"Send a quick message",expandDetailsLabel:"Expand details",sendMessageLabel:"Send message",emailButtonLabel:"Email",callButtonLabel:"Call",chatButtonLabel:"Chat",closeCardLabel:"Close card",videoButtonLabel:"Video",goBackLabel:"Go Back"}});var J$=y(()=>{l();c();d()});var e6={};g7(e6,{MgtPersonCard:()=>Zr,registerMgtPersonCardComponent:()=>Ov});var Xo,po,X$,Ov,Zr,Mv=y(()=>{l();c();d();xe();gt();pi();ge();Bs();_d();bv();Yr();vv();rx();un();JP();Kh();Av();Rv();Pv();$v();zh();cx();Z$();av();qs();J$();cr();Mr();ge();qs();Xo=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},po=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},X$=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Ov=()=>{at(ln,PC,AC,RC,Or,cn),Re("person-card",Zr),dn(),a$(),z$(),F$(),Qh(),W$(),customElements.get(ku("person"))||Lo()},Zr=class extends it{static get styles(){return ZP}get strings(){return Y$}static get requiredScopes(){return Q$()}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.personImage=this.getImage())}get personQuery(){return this._personQuery}set personQuery(e){this._personQuery!==e&&(this._personQuery=e,this.personDetails=null,this._cardState=null)}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this._cardState=null)}get internalPersonDetails(){var e;return((e=this._cardState)===null||e===void 0?void 0:e.person)||this.personDetails}constructor(){super(),this.isSendingMessage=!1,this.goBack=()=>{var e;if(!(!((e=this._history)===null||e===void 0)&&e.length))return;let t=this._history.pop();this._currentSection=null;let o=this.renderRoot.querySelector("fluent-tab");o&&o.click(),this._cardState=t.state,this._personDetails=t.state.person,this.personImage=t.personImage,this.loadSections()},this.renderContent=()=>{var e;if(!this.internalPersonDetails)return this.renderNoData();let t=this.internalPersonDetails,o=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:o});let i;i=this.strings.closeCardLabel;let n=this.isExpanded?x`
           <div class="close-card-container">
             <fluent-button 
              appearance="lightweight" 
              class="close-button" 
              aria-label=${i}
              @click=${this.closeCard} >
               ${Z(P.Close)}
             </fluent-button>
           </div>
         `:null;i=this.strings.goBackLabel;let s=!((e=this._history)===null||e===void 0)&&e.length?x`
            <div class="nav">
              <fluent-button 
                appearance="lightweight"
                class="nav__back" 
                aria-label=${i} 
                @keydown=${this.handleGoBack}
                @click=${this.goBack}>${Z(P.Back)}
               </fluent-button>
            </div>
          `:null,a=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:o});if(!a){let p=this.renderPerson(),f=this.renderContactIcons(t);a=x`
         ${p} ${f}
       `}let u=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0,this.fireCustomEvent("smallView",null,!0));let h=this.lockTabNavigation?x`<div @keydown=${this.handleEndOfCard} aria-label=${this.strings.endOfCard} tabindex="0" id="end-of-container"></div>`:x``;return x`
      <div class="root" dir=${this.direction}>
        <div class=${ze({small:this._smallView})}>
          ${s}
          ${n}
          <div class="person-details-container">${a}</div>
          <div class="expanded-details-container">${u}</div>
          ${h}
        </div>
      </div>
     `},this.handleEndOfCard=e=>{if(e&&e.code==="Tab"){let t=this.renderRoot.querySelector("#end-of-container");if(t){t.blur();let o=this.renderRoot.querySelector("mgt-person");o&&o.focus()}}},this.closeCard=()=>{this.updateCurrentSection(null),this.isExpanded=!1},this.sendQuickMessage=()=>X$(this,void 0,void 0,function*(){let e=this._chatInput.trim();if(!e?.length)return;let t=this.personDetails,o=this._me.userPrincipalName;this.isSendingMessage=!0;let i=yield QP(this._graph,t.userPrincipalName,o),n={body:{content:e}};yield YP(this._graph,i.id,n),this.isSendingMessage=!1,this.clearInputData()}),this.emailUser=()=>{let e=this.internalPersonDetails;if(e){let t=Do(e);t&&window.open("mailto:"+t,"_blank","noreferrer")}},this.callUser=()=>{var e,t;let o=this.internalPersonDetails,i=this.internalPersonDetails;if(!((e=o?.businessPhones)===null||e===void 0)&&e.length){let n=o.businessPhones[0];n&&window.open("tel:"+n,"_blank","noreferrer")}else if(!((t=i?.phones)===null||t===void 0)&&t.length){let s=this.getPersonBusinessPhones(i)[0];s&&window.open("tel:"+s,"_blank","noreferrer")}},this.chatUser=(e=null)=>{let t=this.personDetails;if(t?.userPrincipalName){let i=`https://teams.microsoft.com/l/chat/0/0?users=${t.userPrincipalName}`;e?.length&&(i+=`&message=${e}`);let n=()=>window.open(i,"_blank","noreferrer");Sn.isAvailable?Sn.executeDeepLink(i,s=>{s||n()}):n()}},this.videoCallUser=()=>{let e=this.personDetails;if(e?.userPrincipalName||e?.mail){let o=`https://teams.microsoft.com/l/call/0/0?users=${e.userPrincipalName||e.mail}&withVideo=true`,i=()=>window.open(o,"_blank");Sn.isAvailable?Sn.executeDeepLink(o,n=>{n||i()}):i()}},this.showExpandedDetails=()=>{let e=this.renderRoot.querySelector(".root");e?.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)},this.sendQuickMessageOnEnter=e=>{e.code==="Enter"&&this.sendQuickMessage()},this.handleGoBack=e=>{e.code==="Enter"&&this.goBack()},this._chatInput="",this._currentSection=null,this._history=[],this.sections=[],this._graph=null}navigate(e){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this._cardState}),this.personDetails=e,this._cardState=null,this.personImage=null,this._currentSection=null,this.sections=[],this._chatInput=""}clearHistory(){var e;if(this._currentSection=null,!(!((e=this._history)===null||e===void 0)&&e.length))return;let t=this._history[0];this._history=[],this._cardState=t.state,this._personDetails=t.personDetails,this.personImage=t.personImage,this.loadSections()}args(){return[this.providerState,this.personDetails,this.personQuery,this.personImage,this.userId]}renderNoData(){return this.renderTemplate("no-data",null)||x``}renderPerson(){return Te`
      <mgt-person
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        view="threelines"
      ></mgt-person>
    `}renderPersonSubtitle(e){if(e=e||this.internalPersonDetails,!(!sv(e)||!e.department))return x`
       <div class="department">${e.department}</div>
     `}renderContactIcons(e){e=e||this.internalPersonDetails;let t=e,o,i;Do(e)&&(o=`${this.strings.emailButtonLabel} ${e.displayName}`,i=x`
        <fluent-button class="icon"
          aria-label=${o}
          @click=${this.emailUser}>
          ${Z(P.SmallEmail)}
        </fluent-button>
      `);let n;(t?.userPrincipalName||t?.mail)&&(o=`${this.strings.chatButtonLabel} ${e.displayName}`,n=x`
        <fluent-button class="icon"
          aria-label=${o}
          @click=${this.chatUser}>
          ${Z(P.SmallChat)}
        </fluent-button>
       `);let s;(t?.userPrincipalName||t?.mail)&&(o=`${this.strings.videoButtonLabel} ${e.displayName}`,s=x`
        <fluent-button class="icon"
          aria-label=${o}
          @click=${this.videoCallUser}>
          ${Z(P.Video)}
        </fluent-button>
      `);let a;return this.hasPhone&&(o=`${this.strings.callButtonLabel} ${t.displayName}`,a=x`
         <fluent-button class="icon"
          aria-label=${o}
          @click=${this.callUser}>
          ${Z(P.Call)}
        </fluent-button>
       `),x`
       <div class="base-icons">
         ${i} ${n} ${s} ${a}
       </div>
     `}renderExpandedDetailsButton(){return x`
      <fluent-button
        aria-label=${this.strings.expandDetailsLabel}
        class="expanded-details-button"
        @click=${this.showExpandedDetails}
      >
        ${Z(P.ExpandDown)}
      </fluent-button>
     `}renderExpandedDetails(){if(!this._cardState&&this._isStateLoading)return Te`
         <div class="loading">
           <mgt-spinner></mgt-spinner>
         </div>
       `;V.globalProvider.state===oe.SignedOut&&this.loadSections();let t=this.renderSectionNavigation();return x`
      <div class="section-nav">
        ${t}
      </div>
      <hr class="divider"/>
      <div
        class="section-host ${this._smallView?"small":""} ${this._smallView?"small":""}"
        @wheel=${o=>this.handleSectionScroll(o)}
        tabindex=0
      ></div>
    `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;let e=this._currentSection?this.sections.indexOf(this._currentSection):-1,t=this.sections.map((n,s)=>{let a=n.tagName.toLowerCase(),u=ze({active:s===e,"section-nav__icon":!0});return x`
        <fluent-tab
          id="${a}-Tab"
          class=${u}
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(n)}"
          @click=${()=>this.updateCurrentSection(n)}
        >
          ${n.renderIcon()}
        </fluent-tab>
      `}),o=this.sections.map(n=>x`
        <fluent-tab-panel slot="tabpanel">
          <div class="inserted">
            <div class="title">${n.cardTitle}</div>
            ${this._currentSection?n.asFullView():null}
          </div>
        </fluent-tab-panel>
      `),i=ze({active:e===-1,"section-nav__icon":!0,overviewTab:!0});return x`
      <fluent-tabs
        orientation="horizontal"
        activeindicator
        @wheel=${n=>this.handleSectionScroll(n)}
      >
        <fluent-tab
          class="${i}"
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(null)}"
          @click=${()=>this.updateCurrentSection(null)}
        >
          <div>${Z(P.Overview)}</div>
        </fluent-tab>
        ${t}
        <fluent-tab-panel slot="tabpanel" >
          <div class="overview-panel">${this._currentSection?null:this.renderOverviewSection()}</div>
        </fluent-tab-panel>
        ${o}
      </fluent-tabs>
    `}renderOverviewSection(){let e=this.sections.map(o=>x`
        <div class="section">
          <div class="section__header">
            <div class="section__title" tabindex=0>${o.displayName}</div>
              <fluent-button
                appearance="lightweight"
                class="section__show-more"
                @click=${()=>this.updateCurrentSection(o)}
              >
                ${this.strings.showMoreSectionButton}
              </fluent-button>
          </div>
          <div class="section__content">${o.asCompactView()}</div>
        </div>
      `),t=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this._cardState});return t&&e.splice(1,0,x`
           <div class="section">
             <div class="additional-details">${t}</div>
           </div>
         `),x`
       <div class="sections">
          ${this.renderMessagingSection()}
          ${e}
       </div>
     `}renderCurrentSection(){var e;if(!(!(!((e=this.sections)===null||e===void 0)&&e.length)&&!this.hasTemplate("additional-details")))return this.sections.length===1&&!this.hasTemplate("additional-details")?x`
         ${this.sections[0].asFullView()}
       `:this._currentSection?x`
       ${this._currentSection.asFullView()}
     `:this.renderOverviewSection()}renderMessagingSection(){let e=this.personDetails,t=this._me.userPrincipalName,o=this._chatInput;if(e?.userPrincipalName!==t)return Ut.isSendMessageVisible?x`
      <div class="message-section">
        <fluent-text-field
          autocomplete="off"
          appearance="outline"
          placeholder="${this.strings.quickMessage}"
          .value=${o}
          @input=${i=>{this._chatInput=i.target.value,this.requestUpdate()}}
          @keydown="${i=>this.sendQuickMessageOnEnter(i)}">
        </fluent-text-field>
        <fluent-button class="send-message-icon"
          aria-label=${this.strings.sendMessageLabel}
          @click=${this.sendQuickMessage}
          ?disabled=${this.isSendingMessage}>
          ${this.isSendingMessage?Z(P.Confirmation):Z(P.Send)}
        </fluent-button>
      </div>
      `:ot}loadState(){var e,t,o;return X$(this,void 0,void 0,function*(){if(this._cardState)return;if(!this.personDetails&&this.inheritDetails){let u=this.parentElement;for(;u&&u.tagName!==`${yr.prefix}-PERSON`.toUpperCase();)u=u.parentElement;let h=u.personDetails||u.personDetailsInternal;u&&h&&(this.personDetails=h,this.personImage=u.personImage)}let i=V.globalProvider;if(!i||i.state!==oe.SignedIn)return;let n=i.graph.forComponent(this);if(this._graph=n,this._isStateLoading=!0,this._me||(this._me=yield V.me()),this.personDetails){let u=this.personDetails,h=u.userPrincipalName||u.id;if(h&&!Do(u)){let p=yield ic(n,h);this.personDetails=p,this.personImage=this.getImage()}}else if(this.userId||this.personQuery==="me"){let u=yield ic(n,this.userId);this.personDetails=u,this.personImage=this.getImage()}else if(this.personQuery){let u=yield Ha(n,this.personQuery,1);u?.length&&(this.personDetails=u[0],yield Nh(n,this.personDetails,Ut.useContactApis).then(h=>{h&&(this.personDetails.personImage=h,this.personImage=h)}))}let s={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{!((e=this.personDetails)===null||e===void 0)&&e.id?this.personPresence=yield Uh(n,this.personDetails.id):this.personPresence=s}catch{this.personPresence=s}let a=((t=this.personDetails)===null||t===void 0?void 0:t.id)||((o=this.personDetails)===null||o===void 0?void 0:o.userPrincipalName);a&&(this._cardState=yield Ev(n,this.personDetails,this._me===a)),this.loadSections(),this._isStateLoading=!1})}get hasPhone(){var e,t;let o=this.internalPersonDetails,i=this.internalPersonDetails;return!!(!((e=o?.businessPhones)===null||e===void 0)&&e.length)||!!(!((t=i?.phones)===null||t===void 0)&&t.length)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;let e=new jh(this.internalPersonDetails);if(e.hasData&&this.sections.push(e),!this._cardState)return;let{person:t,directReports:o,messages:i,files:n,profile:s}=this._cardState;if(Ut.sections.organization&&(t?.manager||o?.length)&&this.sections.push(new lc(this._cardState,this._me)),Ut.sections.mailMessages&&i?.length&&this.sections.push(new Md(i)),Ut.sections.files&&n?.length&&this.sections.push(new Ft(n)),Ut.sections.profile&&s){let a=new Fd(s);a.hasData&&this.sections.push(a)}}getImage(){if(this.personImage)return this.personImage;let e=this.internalPersonDetails;return e?.personImage?e.personImage:null}clearInputData(){this._chatInput="",this.requestUpdate()}getPersonBusinessPhones(e){let t=e.phones,o=[];for(let i of t)i.type==="business"&&o.push(i.number);return o}updateCurrentSection(e){if(e){let o=e.tagName.toLowerCase();this.renderRoot.querySelector(`#${o}-Tab`).click()}let t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(let o of t)o.scrollTop=0;this._currentSection=e,this.requestUpdate()}handleSectionScroll(e){let t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(let o of t)o&&!(e.deltaY<0&&o.scrollTop===0)&&!(e.deltaY>0&&o.clientHeight+o.scrollTop>=o.scrollHeight-1)&&e.stopPropagation()}};Xo([E({attribute:"person-details",type:Object}),po("design:type",Object),po("design:paramtypes",[Object])],Zr.prototype,"personDetails",null);Xo([E({attribute:"person-query"}),po("design:type",String),po("design:paramtypes",[String])],Zr.prototype,"personQuery",null);Xo([E({attribute:"lock-tab-navigation",type:Boolean}),po("design:type",Boolean)],Zr.prototype,"lockTabNavigation",void 0);Xo([E({attribute:"user-id"}),po("design:type",String),po("design:paramtypes",[String])],Zr.prototype,"userId",null);Xo([E({attribute:"person-image",type:String}),po("design:type",String)],Zr.prototype,"personImage",void 0);Xo([E({attribute:"fetch-image",type:Boolean}),po("design:type",Boolean)],Zr.prototype,"fetchImage",void 0);Xo([E({attribute:"is-expanded",type:Boolean}),po("design:type",Boolean)],Zr.prototype,"isExpanded",void 0);Xo([E({attribute:"inherit-details",type:Boolean}),po("design:type",Boolean)],Zr.prototype,"inheritDetails",void 0);Xo([E({attribute:"show-presence",type:Boolean}),po("design:type",Boolean)],Zr.prototype,"showPresence",void 0);Xo([E({attribute:"person-presence",type:Object}),po("design:type",Object)],Zr.prototype,"personPresence",void 0);Xo([X(),po("design:type",Object)],Zr.prototype,"isSendingMessage",void 0);Xo([X(),po("design:type",Object)],Zr.prototype,"_cardState",void 0);Xo([X(),po("design:type",Boolean)],Zr.prototype,"_isStateLoading",void 0);Xo([X(),po("design:type",Object)],Zr.prototype,"_currentSection",void 0)});var jt,vt,t6,dx,Lo,pt,un=y(()=>{l();c();d();cr();ge();xe();gt();pi();Cd();av();Bs();_d();vv();Ua();bv();Bh();ys();Mr();Yr();Jo();Ad();Ad();Cv();dP();xv();pP();rx();jt=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},vt=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},t6=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},dx=["businessPhones","displayName","givenName","jobTitle","department","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id","userType"],Lo=()=>{at(Jl),Re("person",pt),Ba()},pt=class r extends it{static get styles(){return cP}get strings(){return hP}get personQuery(){return this._personQuery}set personQuery(e){e!==this._personQuery&&(this._personQuery=e,this._personDetails=null,this.personDetailsInternal=null)}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.personDetailsInternal)}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetailsInternal=null,this._personDetails=null)}get usage(){return this._usage}set usage(e){e!==this._usage&&(this._usage=e)}get personDetailsInternal(){return this._personDetailsInternal}set personDetailsInternal(e){this._personDetailsInternal!==e&&(this._personDetailsInternal=e,this._fetchedImage=null,this._fetchedPresence=null)}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this._fetchedImage=null,this._fetchedPresence=null)}get personImage(){return this._personImage||this._fetchedImage}set personImage(e){e!==this._personImage&&(this._isInvalidImageSrc=!e,this._personImage=e)}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(e){e!==this._personPresence&&(this._personPresence=e)}static get requiredScopes(){let e=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return r.config.useContactApis&&e.push("contacts.read"),e}get flyout(){return this.renderRoot.querySelector(".flyout")}constructor(){super(),this.avatarType="photo",this.personCardInteraction="none",this.view="image",this._hasLoadedPersonCard=!1,this._mouseLeaveTimeout=-1,this._mouseEnterTimeout=-1,this.renderContent=()=>{let e=this.personDetails||this.personDetailsInternal||this.fallbackDetails,t=this.getImage(),o=this.personPresence||this._fetchedPresence;if(!e&&!t)return this.renderNoData();!e?.personImage&&t&&(e.personImage=t);let i=this.renderTemplate("default",{person:e,personImage:t,personPresence:o});if(!i){let a=this.renderDetails(e,o),u=this.renderAvatar(e,t,o);i=x`
        ${u}
        ${a}
      `}this.personCardInteraction!=="none"&&(i=this.renderFlyout(i,e,t,o));let s=ze({"person-root":!0,small:!this.isThreeLines()&&!this.isFourLines()&&!this.isLargeAvatar(),large:this.avatarSize!=="auto"&&this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines(),vertical:this.isVertical()});return x`
      <div
        class="${s}"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
        @keydown=${this.handleKeyDown}
        tabindex="${Zo(this.personCardInteraction!=="none"?"0":void 0)}"
      >
        ${i}
      </div>
    `},this.renderLoading=()=>{let e=ze({"person-root":!0,small:!this.isThreeLines()&&!this.isFourLines()&&!this.isLargeAvatar(),large:this.avatarSize!=="auto"&&this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines(),vertical:this.isVertical()}),t=ze({"details-wrapper":!0,vertical:this.isVertical()});return this.renderTemplate("loading",null)||x`
        <div class="${e}">
          <div class="avatar-wrapper">
            <fluent-skeleton shimmer class="shimmer" shape="circle"></fluent-skeleton>
          </div>
          <div class=${t}>
            ${this.renderLoadingLines()}
          </div>
        </div>`},this.renderLoadingLines=()=>{let e=[];return this.isNoLine()||(this.isOneLine()&&e.push(this.renderLoadingLine(1)),this.isTwoLines()&&(e.push(this.renderLoadingLine(1)),e.push(this.renderLoadingLine(2))),this.isThreeLines()&&(e.push(this.renderLoadingLine(1)),e.push(this.renderLoadingLine(2)),e.push(this.renderLoadingLine(3))),this.isFourLines()&&(e.push(this.renderLoadingLine(1)),e.push(this.renderLoadingLine(2)),e.push(this.renderLoadingLine(3)),e.push(this.renderLoadingLine(4)))),e},this.renderLoadingLine=e=>{let t=`line${e}`;return x`
      <div class=${t}>
        <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
      </div>
    `},this.handleMouseClick=e=>{let t=e.target;this.personCardInteraction==="click"&&t.tagName!==`${yr.prefix}-PERSON-CARD`.toUpperCase()&&this.showPersonCard()},this.handleKeyDown=e=>{let t=this.renderRoot.querySelector(".person-root");if(e){if(e.key==="Enter"){this.showPersonCard();let o=this.flyout;o?.isOpen&&(this._keyBoardFocus=Na(()=>{let i=o.querySelector(".mgt-person-card");i.setAttribute("tabindex","0"),i.focus()},500),this._keyBoardFocus()),t.blur()}this.personCardInteraction!=="none"&&e.key==="Escape"&&t&&(this.hidePersonCard(),t.focus())}},this.handleMouseEnter=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction==="hover"&&(this._mouseEnterTimeout=window.setTimeout(this.showPersonCard,500))},this.handleMouseLeave=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=window.setTimeout(this.hidePersonCard,500)},this.hidePersonCard=()=>{let e=this.flyout;e&&e.close();let t=this.querySelector(".mgt-person-card")||this.renderRoot.querySelector(".mgt-person-card");t&&(t.isExpanded=!1,t.clearHistory())},this.loadPersonCardResources=()=>t6(this,void 0,void 0,function*(){if(this.personCardInteraction!=="none"&&!this._hasLoadedPersonCard){let{registerMgtPersonCardComponent:e}=yield Promise.resolve().then(()=>(Mv(),e6));customElements.get(ku("person-card"))||e(),this._hasLoadedPersonCard=!0}}),this.showPersonCard=()=>{this._personCardShouldRender||(this._personCardShouldRender=!0,this.loadPersonCardResources());let e=this.flyout;e&&e.open()},this.personCardInteraction="none",this.line1Property="displayName",this.line2Property="jobTitle",this.line3Property="department",this.line4Property="email",this.view="image",this.avatarSize="auto",this.disableImageFetch=!1,this._isInvalidImageSrc=!1,this.avatarType="photo",this.verticalLayout=!1}clearState(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){let e=this.renderTemplate("no-data",null);if(e)return e;let t={"avatar-icon":!0,vertical:this.isVertical(),small:!this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines()};return x`
       <i class=${ze(t)}></i>
     `}renderPersonIcon(){return Z(P.Person)}renderImage(e,t){var o;let i=`${this.strings.photoFor} ${e.displayName}`,n=t&&!this._isInvalidImageSrc&&this.avatarType==="photo",s=this.avatarType==="photo"&&this.view==="image",a=(o=e?.displayName||`${this.strings.emailAddress} ${Do(e)}`)!==null&&o!==void 0?o:void 0,u=x`<img
      title="${Zo(s?a:void 0)}"
      alt=${i}
      src=${t}
      @error=${()=>this._isInvalidImageSrc=!0} />`,h=e?this.getInitials(e):"",p=h?.length,f=ze({initials:p&&!n,"contact-icon":!p}),b=x`<i>${this.renderPersonIcon()}</i>`,C=x`
      <span 
        title="${Zo(this.view==="image"?a:void 0)}"
        role="${Zo(this.view==="image"?void 0:"presentation")}"
        class="${f}"
      >
        ${p?h:b}
      </span>
`;return n?this.fireCustomEvent("person-image-rendered"):this.fireCustomEvent("person-icon-rendered"),n?u:C}renderPresence(e){var t;if(!this.showPresence||!e)return x``;let o,{activity:i,availability:n}=e;switch(n){case"Available":case"AvailableIdle":switch(i){case"OutOfOffice":o=Z(P.PresenceOofAvailable);break;case"Available":default:o=Z(P.PresenceAvailable);break}break;case"Busy":case"BusyIdle":switch(i){case"OutOfOffice":case"OnACall":o=Z(P.PresenceOofBusy);break;case"Busy":case"InACall":case"InAMeeting":case"InAConferenceCall":default:o=Z(P.PresenceBusy);break}break;case"DoNotDisturb":switch(i){case"OutOfOffice":o=Z(P.PresenceOofDnd);break;case"Presenting":case"Focusing":case"UrgentInterruptionsOnly":default:o=Z(P.PresenceDnd);break}break;case"Away":switch(i){case"OutOfOffice":o=Z(P.PresenceOofAway);break;case"AwayLastSeenTime":default:o=Z(P.PresenceAway);break}break;case"BeRightBack":switch(i){default:o=Z(P.PresenceAway);break}break;case"Offline":switch(i){case"Offline":o=Z(P.PresenceOffline);break;case"OutOfOffice":case"OffWork":o=Z(P.PresenceOofAway);break;default:o=Z(P.PresenceStatusUnknown);break}break;default:o=Z(P.PresenceStatusUnknown);break}let s=ze({"presence-wrapper":!0,noline:this.isNoLine(),oneline:this.isOneLine()}),a=(t=this.strings[i])!==null&&t!==void 0?t:ot;return x`
      <span
        class="${s}"
        title="${a}"
        aria-label="${a}"
        role="img">
          ${o}
      </span>
    `}renderAvatar(e,t,o){let i=this.renderImage(e,t),n=this.renderPresence(o);return x`
      <div class="avatar-wrapper">
        ${i}
        ${n}
      </div>
    `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}handleLine4Clicked(){this.fireCustomEvent("line4clicked",this.personDetailsInternal)}renderDetails(e,t){if(!e||this.view==="image")return x``;let o=e;t&&(o.presenceActivity=t?.activity,o.presenceAvailability=t?.availability);let i=[],n=this.getTextFromProperty(o,this.line1Property);if(this.hasTemplate("line1")){let a=this.renderTemplate("line1",{person:o});i.push(x`
           <div class="line1" part="detail-line" @click=${()=>this.handleLine1Clicked()}
            @keydown=${u=>u.key==="Enter"&&this.handleLine1Clicked()}
            role="presentation" aria-label="${n}">${a}</div>
         `)}else n&&i.push(x`
             <div class="line1" part="detail-line" @click=${()=>this.handleLine1Clicked()}
               @keydown=${a=>a.key==="Enter"&&this.handleLine1Clicked()}
              role="presentation" aria-label="${n}">${n}</div>
           `);if(!this.isOneLine()){let a=this.getTextFromProperty(o,this.line2Property);if(this.hasTemplate("line2")){let u=this.renderTemplate("line2",{person:o});i.push(x`
           <div class="line2" part="detail-line" @click=${()=>this.handleLine2Clicked()}
             @keydown=${h=>h.key==="Enter"&&this.handleLine2Clicked()}
              role="presentation" aria-label="${a}">${u}</div>
         `)}else a&&i.push(x`
             <div class="line2" part="detail-line" @click=${()=>this.handleLine2Clicked()}
               @keydown=${u=>u.key==="Enter"&&this.handleLine2Clicked()}
                role="presentation" aria-label="${a}">${a}</div>
           `)}if(this.isThreeLines()||this.isFourLines()){let a=this.getTextFromProperty(o,this.line3Property);if(this.hasTemplate("line3")){let u=this.renderTemplate("line3",{person:o});i.push(x`
           <div class="line3" part="detail-line" @click=${()=>this.handleLine3Clicked()}
             @keydown=${h=>h.key==="Enter"&&this.handleLine3Clicked()}
              role="presentation" aria-label="${a}">${u}</div>
         `)}else a&&i.push(x`
             <div class="line3" part="detail-line" @click=${()=>this.handleLine3Clicked()}
               @keydown=${u=>u.key==="Enter"&&this.handleLine3Clicked()}
                role="presentation" aria-label="${a}">${a}</div>
           `)}if(this.isFourLines()){let a=this.getTextFromProperty(o,this.line4Property);if(this.hasTemplate("line4")){let u=this.renderTemplate("line4",{person:o});i.push(x`
          <div class="line4" part="detail-line" @click=${()=>this.handleLine4Clicked()}
            @keydown=${h=>h.key==="Enter"&&this.handleLine4Clicked()}
            role="presentation" aria-label="${a}">${u}</div>
        `)}else a&&i.push(x`
            <div class="line4" part="detail-line" @click=${()=>this.handleLine4Clicked()}
              @keydown=${u=>u.key==="Enter"&&this.handleLine4Clicked()}
              role="presentation" aria-label="${a}">${a}</div>
          `)}let s=ze({"details-wrapper":!0,vertical:this.isVertical()});return x`
      <div class="${s}">
        ${i}
      </div>
    `}renderFlyout(e,t,o,i){let n=this._personCardShouldRender&&this._hasLoadedPersonCard?x`
           <div slot="flyout" data-testid="flyout-slot">
             ${this.renderFlyoutContent(t,o,i)}
           </div>`:x``,s=ze({small:!this.isThreeLines()&&!this.isFourLines()&&!this.isLargeAvatar(),large:this.avatarSize!=="auto"&&this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines(),vertical:this.isVertical()});return Te`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        <div slot="anchor" class="${s}">${e}</div>
        ${n}
      </mgt-flyout>`}renderFlyoutContent(e,t,o){return this.fireCustomEvent("flyout-content-rendered"),this.renderTemplate("person-card",{person:e,personImage:t})||Te`
        <mgt-person-card
          class="mgt-person-card"
          lock-tab-navigation
          .personDetails=${e}
          .personImage=${t}
          .personPresence=${o}
          .showPresence=${this.showPresence}>
        </mgt-person-card>`}args(){return[this.providerState,this.verticalLayout,this.view,this.fallbackDetails,this.line1Property,this.line2Property,this.line3Property,this.line4Property,this.fetchImage,this.avatarType,this.userId,this.personQuery,this.disableImageFetch,this.showPresence,this.personPresence,this.personDetails]}loadState(){return t6(this,void 0,void 0,function*(){let e=V.globalProvider;if(!e||e.state===oe.Loading)return;if(e&&e.state===oe.SignedOut){this.personDetailsInternal=null;return}let t=e.graph.forComponent(this);(this.verticalLayout&&this.view!=="fourlines"||this.fallbackDetails)&&(this.line2Property="email");let o=[...dx,this.line1Property,this.line2Property,this.line3Property,this.line4Property];o=o.filter(s=>s!=="email");let i=this.personDetailsInternal||this.personDetails;if(i){if(!i.personImage&&this.fetchImage&&this.avatarType==="photo"&&!this.personImage&&!this._fetchedImage){let s;"groupTypes"in i?s=yield eP(t,i):s=yield Nh(t,i,r.config.useContactApis),s&&(i.personImage=s,this._fetchedImage=s)}}else if(this.userId||this.personQuery==="me"){let s;this.avatarType==="photo"&&!this.disableImageFetch?s=yield ic(t,this.userId,o):this.personQuery==="me"?s=yield Dh(t,o):s=yield Lh(t,this.userId,o),this.personDetailsInternal=s,this.personDetails=s,this._fetchedImage=this.getImage()}else if(this.personQuery){let s=yield Ha(t,this.personQuery,1);if((!s||s.length===0)&&(s=(yield ec(t,this.personQuery,1))||[]),s?.length&&(this.personDetailsInternal=s[0],this.personDetails=s[0],this.avatarType==="photo"&&!this.disableImageFetch)){let a=yield Nh(t,s[0],r.config.useContactApis);a&&(this.personDetailsInternal.personImage=a,this.personDetails.personImage=a,this._fetchedImage=a)}}i=this.personDetailsInternal||this.personDetails||this.fallbackDetails,this.personCardInteraction!=="none"&&Ev(t,i,this.personQuery==="me");let n={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(i){let s=this.personQuery!=="me"?i?.id:null;this._fetchedPresence=yield Uh(t,s)}else this._fetchedPresence=n}catch{this._fetchedPresence=n}})}getInitials(e){var t,o,i,n,s,a;if(e||(e=this.personDetailsInternal),V3(e))return e.initials;let u="";if(sv(e)&&(u+=(i=(o=(t=e.givenName)===null||t===void 0?void 0:t[0])===null||o===void 0?void 0:o.toUpperCase())!==null&&i!==void 0?i:"",u+=(a=(s=(n=e.surname)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.toUpperCase())!==null&&a!==void 0?a:""),!u&&e.displayName){let h=e.displayName.split(/\s+/);for(let p=0;p<2&&p<h.length;p++)h[p][0]&&this.isLetter(h[p][0])&&(u+=h[p][0].toUpperCase())}return u}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;let e=this.personDetailsInternal||this.personDetails;return e?.personImage?e.personImage:null}isLetter(e){try{return e.match(new RegExp("\\p{L}","u"))}catch{return e.toLowerCase()!==e.toUpperCase()}}getTextFromProperty(e,t){if(!t||t.length===0)return null;let o=t.trim().split(","),i,n=0;for(;!i&&n<o.length;){let s=o[n].trim();switch(s){case"mail":case"email":i=Do(e);break;default:i=e[s]}n++}return i}isLargeAvatar(){return this.avatarSize==="large"||this.avatarSize==="auto"&&this.view!=="image"&&this.view!=="oneline"}isNoLine(){return this.view==="image"}isOneLine(){return this.view==="oneline"}isTwoLines(){return this.view==="twolines"}isThreeLines(){return this.view==="threelines"}isFourLines(){return this.view==="fourlines"}isVertical(){return this.verticalLayout}};pt.config={useContactApis:!0};jt([E({attribute:"person-query"}),vt("design:type",String),vt("design:paramtypes",[String])],pt.prototype,"personQuery",null);jt([E({attribute:"fallback-details",type:Object}),vt("design:type",Object),vt("design:paramtypes",[Object])],pt.prototype,"fallbackDetails",null);jt([E({attribute:"user-id"}),vt("design:type",String),vt("design:paramtypes",[String])],pt.prototype,"userId",null);jt([E({attribute:"usage"}),vt("design:type",String),vt("design:paramtypes",[String])],pt.prototype,"usage",null);jt([E({attribute:"show-presence",type:Boolean}),vt("design:type",Boolean)],pt.prototype,"showPresence",void 0);jt([E({attribute:"avatar-size",type:String}),vt("design:type",String)],pt.prototype,"avatarSize",void 0);jt([X(),vt("design:type",Object),vt("design:paramtypes",[Object])],pt.prototype,"personDetailsInternal",null);jt([E({attribute:"person-details",type:Object}),vt("design:type",Object),vt("design:paramtypes",[Object])],pt.prototype,"personDetails",null);jt([E({attribute:"person-image",type:String}),vt("design:type",String),vt("design:paramtypes",[String])],pt.prototype,"personImage",null);jt([E({attribute:"fetch-image",type:Boolean}),vt("design:type",Boolean)],pt.prototype,"fetchImage",void 0);jt([E({attribute:"disable-image-fetch",type:Boolean}),vt("design:type",Boolean)],pt.prototype,"disableImageFetch",void 0);jt([E({attribute:"vertical-layout",type:Boolean}),vt("design:type",Boolean)],pt.prototype,"verticalLayout",void 0);jt([E({attribute:"avatar-type",converter:r=>uP(r,"photo")}),vt("design:type",String)],pt.prototype,"avatarType",void 0);jt([E({attribute:"person-presence",type:Object}),vt("design:type",Object),vt("design:paramtypes",[Object])],pt.prototype,"personPresence",null);jt([E({attribute:"person-card",converter:r=>Rd(r)}),vt("design:type",String)],pt.prototype,"personCardInteraction",void 0);jt([E({attribute:"line1-property"}),vt("design:type",String)],pt.prototype,"line1Property",void 0);jt([E({attribute:"line2-property"}),vt("design:type",String)],pt.prototype,"line2Property",void 0);jt([E({attribute:"line3-property"}),vt("design:type",String)],pt.prototype,"line3Property",void 0);jt([E({attribute:"line4-property"}),vt("design:type",String)],pt.prototype,"line4Property",void 0);jt([E({converter:r=>Ed(r,"image")}),vt("design:type",String)],pt.prototype,"view",void 0);jt([X(),vt("design:type",String)],pt.prototype,"_fetchedImage",void 0);jt([X(),vt("design:type",Object)],pt.prototype,"_fetchedPresence",void 0);jt([X(),vt("design:type",Boolean)],pt.prototype,"_isInvalidImageSrc",void 0);jt([X(),vt("design:type",Boolean)],pt.prototype,"_personCardShouldRender",void 0);jt([X(),vt("design:type",Object)],pt.prototype,"_hasLoadedPersonCard",void 0)});l();c();d();l();c();d();l();c();d();var zD=__STORYBOOK_API__,{ActiveTabs:VD,Consumer:qD,ManagerContext:GD,Provider:jD,addons:lp,combineParameters:KD,controlOrMetaKey:WD,controlOrMetaSymbol:QD,eventMatchesShortcut:YD,eventToShortcut:ZD,isMacLike:JD,isShortcutTaken:XD,keyToSymbol:eL,merge:tL,mockChannel:rL,optionOrAltSymbol:oL,shortcutMatchesShortcut:iL,shortcutToHumanString:nL,types:Ux,useAddonState:sL,useArgTypes:aL,useArgs:lL,useChannel:cL,useGlobalTypes:dL,useGlobals:uL,useParameter:hL,useSharedState:pL,useStoryPrepared:fL,useStorybookApi:mL,useStorybookState:gL}=__STORYBOOK_API__;l();c();d();l();c();d();l();c();d();l();c();d();var Bx=(()=>{let r;return typeof window<"u"?r=window:typeof globalThis<"u"?r=globalThis:typeof window<"u"?r=window:typeof self<"u"?r=self:r={},r})();l();c();d();var _L=__STORYBOOK_CLIENT_LOGGER__,{deprecate:TL,logger:zx,once:EL,pretty:IL}=__STORYBOOK_CLIENT_LOGGER__;function uc(){return uc=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},uc.apply(this,arguments)}function v7(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Bd(r,e){return Bd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},Bd(r,e)}function y7(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Bd(r,e)}function Yv(r){return Yv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Yv(r)}function b7(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}function w7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cp(r,e,t){return w7()?cp=Reflect.construct.bind():cp=function(o,i,n){var s=[null];s.push.apply(s,i);var a=Function.bind.apply(o,s),u=new a;return n&&Bd(u,n.prototype),u},cp.apply(null,arguments)}function Zv(r){var e=typeof Map=="function"?new Map:void 0;return Zv=function(t){if(t===null||!b7(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return cp(t,arguments,Yv(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Bd(o,t)},Zv(r)}var C7={1:`Passed invalid arguments to hsl, please pass multiple numbers e.g. hsl(360, 0.75, 0.4) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75 }).

`,2:`Passed invalid arguments to hsla, please pass multiple numbers e.g. hsla(360, 0.75, 0.4, 0.7) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75, alpha: 0.7 }).

`,3:`Passed an incorrect argument to a color function, please pass a string representation of a color.

`,4:`Couldn't generate valid rgb string from %s, it returned %s.

`,5:`Couldn't parse the color string. Please provide the color as a string in hex, rgb, rgba, hsl or hsla notation.

`,6:`Passed invalid arguments to rgb, please pass multiple numbers e.g. rgb(255, 205, 100) or an object e.g. rgb({ red: 255, green: 205, blue: 100 }).

`,7:`Passed invalid arguments to rgba, please pass multiple numbers e.g. rgb(255, 205, 100, 0.75) or an object e.g. rgb({ red: 255, green: 205, blue: 100, alpha: 0.75 }).

`,8:`Passed invalid argument to toColorString, please pass a RgbColor, RgbaColor, HslColor or HslaColor object.

`,9:`Please provide a number of steps to the modularScale helper.

`,10:`Please pass a number or one of the predefined scales to the modularScale helper as the ratio.

`,11:`Invalid value passed as base to modularScale, expected number or em string but got "%s"

`,12:`Expected a string ending in "px" or a number passed as the first argument to %s(), got "%s" instead.

`,13:`Expected a string ending in "px" or a number passed as the second argument to %s(), got "%s" instead.

`,14:`Passed invalid pixel value ("%s") to %s(), please pass a value like "12px" or 12.

`,15:`Passed invalid base value ("%s") to %s(), please pass a value like "12px" or 12.

`,16:`You must provide a template to this method.

`,17:`You passed an unsupported selector state to this method.

`,18:`minScreen and maxScreen must be provided as stringified numbers with the same units.

`,19:`fromSize and toSize must be provided as stringified numbers with the same units.

`,20:`expects either an array of objects or a single object with the properties prop, fromSize, and toSize.

`,21:"expects the objects in the first argument array to have the properties `prop`, `fromSize`, and `toSize`.\n\n",22:"expects the first argument object to have the properties `prop`, `fromSize`, and `toSize`.\n\n",23:`fontFace expects a name of a font-family.

`,24:`fontFace expects either the path to the font file(s) or a name of a local copy.

`,25:`fontFace expects localFonts to be an array.

`,26:`fontFace expects fileFormats to be an array.

`,27:`radialGradient requries at least 2 color-stops to properly render.

`,28:`Please supply a filename to retinaImage() as the first argument.

`,29:`Passed invalid argument to triangle, please pass correct pointingDirection e.g. 'right'.

`,30:"Passed an invalid value to `height` or `width`. Please provide a pixel based unit.\n\n",31:`The animation shorthand only takes 8 arguments. See the specification for more information: http://mdn.io/animation

`,32:`To pass multiple animations please supply them in arrays, e.g. animation(['rotate', '2s'], ['move', '1s'])
To pass a single animation please supply them in simple values, e.g. animation('rotate', '2s')

`,33:`The animation shorthand arrays can only have 8 elements. See the specification for more information: http://mdn.io/animation

`,34:`borderRadius expects a radius value as a string or number as the second argument.

`,35:`borderRadius expects one of "top", "bottom", "left" or "right" as the first argument.

`,36:`Property must be a string value.

`,37:`Syntax Error at %s.

`,38:`Formula contains a function that needs parentheses at %s.

`,39:`Formula is missing closing parenthesis at %s.

`,40:`Formula has too many closing parentheses at %s.

`,41:`All values in a formula must have the same unit or be unitless.

`,42:`Please provide a number of steps to the modularScale helper.

`,43:`Please pass a number or one of the predefined scales to the modularScale helper as the ratio.

`,44:`Invalid value passed as base to modularScale, expected number or em/rem string but got %s.

`,45:`Passed invalid argument to hslToColorString, please pass a HslColor or HslaColor object.

`,46:`Passed invalid argument to rgbToColorString, please pass a RgbColor or RgbaColor object.

`,47:`minScreen and maxScreen must be provided as stringified numbers with the same units.

`,48:`fromSize and toSize must be provided as stringified numbers with the same units.

`,49:`Expects either an array of objects or a single object with the properties prop, fromSize, and toSize.

`,50:`Expects the objects in the first argument array to have the properties prop, fromSize, and toSize.

`,51:`Expects the first argument object to have the properties prop, fromSize, and toSize.

`,52:`fontFace expects either the path to the font file(s) or a name of a local copy.

`,53:`fontFace expects localFonts to be an array.

`,54:`fontFace expects fileFormats to be an array.

`,55:`fontFace expects a name of a font-family.

`,56:`linearGradient requries at least 2 color-stops to properly render.

`,57:`radialGradient requries at least 2 color-stops to properly render.

`,58:`Please supply a filename to retinaImage() as the first argument.

`,59:`Passed invalid argument to triangle, please pass correct pointingDirection e.g. 'right'.

`,60:"Passed an invalid value to `height` or `width`. Please provide a pixel based unit.\n\n",61:`Property must be a string value.

`,62:`borderRadius expects a radius value as a string or number as the second argument.

`,63:`borderRadius expects one of "top", "bottom", "left" or "right" as the first argument.

`,64:`The animation shorthand only takes 8 arguments. See the specification for more information: http://mdn.io/animation.

`,65:`To pass multiple animations please supply them in arrays, e.g. animation(['rotate', '2s'], ['move', '1s'])\\nTo pass a single animation please supply them in simple values, e.g. animation('rotate', '2s').

`,66:`The animation shorthand arrays can only have 8 elements. See the specification for more information: http://mdn.io/animation.

`,67:`You must provide a template to this method.

`,68:`You passed an unsupported selector state to this method.

`,69:`Expected a string ending in "px" or a number passed as the first argument to %s(), got %s instead.

`,70:`Expected a string ending in "px" or a number passed as the second argument to %s(), got %s instead.

`,71:`Passed invalid pixel value %s to %s(), please pass a value like "12px" or 12.

`,72:`Passed invalid base value %s to %s(), please pass a value like "12px" or 12.

`,73:`Please provide a valid CSS variable.

`,74:`CSS variable not found and no default was provided.

`,75:`important requires a valid style object, got a %s instead.

`,76:`fromSize and toSize must be provided as stringified numbers with the same units as minScreen and maxScreen.

`,77:`remToPx expects a value in "rem" but you provided it in "%s".

`,78:`base must be set in "px" or "%" but you set it in "%s".
`};function x7(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var o=e[0],i=[],n;for(n=1;n<e.length;n+=1)i.push(e[n]);return i.forEach(function(s){o=o.replace(/%[a-z]/,s)}),o}var yn=function(r){y7(e,r);function e(t){for(var o,i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];return o=r.call(this,x7.apply(void 0,[C7[t]].concat(n)))||this,v7(o)}return e}(Zv(Error));function Gv(r){return Math.round(r*255)}function k7(r,e,t){return Gv(r)+","+Gv(e)+","+Gv(t)}function zd(r,e,t,o){if(o===void 0&&(o=k7),e===0)return o(t,t,t);var i=(r%360+360)%360/60,n=(1-Math.abs(2*t-1))*e,s=n*(1-Math.abs(i%2-1)),a=0,u=0,h=0;i>=0&&i<1?(a=n,u=s):i>=1&&i<2?(a=s,u=n):i>=2&&i<3?(u=n,h=s):i>=3&&i<4?(u=s,h=n):i>=4&&i<5?(a=s,h=n):i>=5&&i<6&&(a=n,h=s);var p=t-n/2,f=a+p,b=u+p,C=h+p;return o(f,b,C)}var Vx={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function S7(r){if(typeof r!="string")return r;var e=r.toLowerCase();return Vx[e]?"#"+Vx[e]:r}var _7=/^#[a-fA-F0-9]{6}$/,T7=/^#[a-fA-F0-9]{8}$/,E7=/^#[a-fA-F0-9]{3}$/,I7=/^#[a-fA-F0-9]{4}$/,jv=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,A7=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,R7=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,P7=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function pp(r){if(typeof r!="string")throw new yn(3);var e=S7(r);if(e.match(_7))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(T7)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(E7))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(I7)){var o=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:o}}var i=jv.exec(e);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var n=A7.exec(e.substring(0,50));if(n)return{red:parseInt(""+n[1],10),green:parseInt(""+n[2],10),blue:parseInt(""+n[3],10),alpha:parseFloat(""+n[4])>1?parseFloat(""+n[4])/100:parseFloat(""+n[4])};var s=R7.exec(e);if(s){var a=parseInt(""+s[1],10),u=parseInt(""+s[2],10)/100,h=parseInt(""+s[3],10)/100,p="rgb("+zd(a,u,h)+")",f=jv.exec(p);if(!f)throw new yn(4,e,p);return{red:parseInt(""+f[1],10),green:parseInt(""+f[2],10),blue:parseInt(""+f[3],10)}}var b=P7.exec(e.substring(0,50));if(b){var C=parseInt(""+b[1],10),S=parseInt(""+b[2],10)/100,R=parseInt(""+b[3],10)/100,N="rgb("+zd(C,S,R)+")",ye=jv.exec(N);if(!ye)throw new yn(4,e,N);return{red:parseInt(""+ye[1],10),green:parseInt(""+ye[2],10),blue:parseInt(""+ye[3],10),alpha:parseFloat(""+b[4])>1?parseFloat(""+b[4])/100:parseFloat(""+b[4])}}throw new yn(5)}function $7(r){var e=r.red/255,t=r.green/255,o=r.blue/255,i=Math.max(e,t,o),n=Math.min(e,t,o),s=(i+n)/2;if(i===n)return r.alpha!==void 0?{hue:0,saturation:0,lightness:s,alpha:r.alpha}:{hue:0,saturation:0,lightness:s};var a,u=i-n,h=s>.5?u/(2-i-n):u/(i+n);switch(i){case e:a=(t-o)/u+(t<o?6:0);break;case t:a=(o-e)/u+2;break;default:a=(e-t)/u+4;break}return a*=60,r.alpha!==void 0?{hue:a,saturation:h,lightness:s,alpha:r.alpha}:{hue:a,saturation:h,lightness:s}}function jx(r){return $7(pp(r))}var O7=function(r){return r.length===7&&r[1]===r[2]&&r[3]===r[4]&&r[5]===r[6]?"#"+r[1]+r[3]+r[5]:r},Jv=O7;function ja(r){var e=r.toString(16);return e.length===1?"0"+e:e}function Kv(r){return ja(Math.round(r*255))}function M7(r,e,t){return Jv("#"+Kv(r)+Kv(e)+Kv(t))}function up(r,e,t){return zd(r,e,t,M7)}function F7(r,e,t){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number")return up(r,e,t);if(typeof r=="object"&&e===void 0&&t===void 0)return up(r.hue,r.saturation,r.lightness);throw new yn(1)}function D7(r,e,t,o){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number"&&typeof o=="number")return o>=1?up(r,e,t):"rgba("+zd(r,e,t)+","+o+")";if(typeof r=="object"&&e===void 0&&t===void 0&&o===void 0)return r.alpha>=1?up(r.hue,r.saturation,r.lightness):"rgba("+zd(r.hue,r.saturation,r.lightness)+","+r.alpha+")";throw new yn(2)}function Xv(r,e,t){if(typeof r=="number"&&typeof e=="number"&&typeof t=="number")return Jv("#"+ja(r)+ja(e)+ja(t));if(typeof r=="object"&&e===void 0&&t===void 0)return Jv("#"+ja(r.red)+ja(r.green)+ja(r.blue));throw new yn(6)}function Vd(r,e,t,o){if(typeof r=="string"&&typeof e=="number"){var i=pp(r);return"rgba("+i.red+","+i.green+","+i.blue+","+e+")"}else{if(typeof r=="number"&&typeof e=="number"&&typeof t=="number"&&typeof o=="number")return o>=1?Xv(r,e,t):"rgba("+r+","+e+","+t+","+o+")";if(typeof r=="object"&&e===void 0&&t===void 0&&o===void 0)return r.alpha>=1?Xv(r.red,r.green,r.blue):"rgba("+r.red+","+r.green+","+r.blue+","+r.alpha+")"}throw new yn(7)}var L7=function(r){return typeof r.red=="number"&&typeof r.green=="number"&&typeof r.blue=="number"&&(typeof r.alpha!="number"||typeof r.alpha>"u")},N7=function(r){return typeof r.red=="number"&&typeof r.green=="number"&&typeof r.blue=="number"&&typeof r.alpha=="number"},H7=function(r){return typeof r.hue=="number"&&typeof r.saturation=="number"&&typeof r.lightness=="number"&&(typeof r.alpha!="number"||typeof r.alpha>"u")},U7=function(r){return typeof r.hue=="number"&&typeof r.saturation=="number"&&typeof r.lightness=="number"&&typeof r.alpha=="number"};function Kx(r){if(typeof r!="object")throw new yn(8);if(N7(r))return Vd(r);if(L7(r))return Xv(r);if(U7(r))return D7(r);if(H7(r))return F7(r);throw new yn(8)}function Wx(r,e,t){return function(){var o=t.concat(Array.prototype.slice.call(arguments));return o.length>=e?r.apply(this,o):Wx(r,e,o)}}function fp(r){return Wx(r,r.length,[])}function mp(r,e,t){return Math.max(r,Math.min(e,t))}function B7(r,e){if(e==="transparent")return e;var t=jx(e);return Kx(uc({},t,{lightness:mp(0,1,t.lightness-parseFloat(r))}))}var z7=fp(B7),V7=z7;function q7(r,e){if(e==="transparent")return e;var t=jx(e);return Kx(uc({},t,{lightness:mp(0,1,t.lightness+parseFloat(r))}))}var G7=fp(q7),j7=G7;function K7(r,e){if(e==="transparent")return e;var t=pp(e),o=typeof t.alpha=="number"?t.alpha:1,i=uc({},t,{alpha:mp(0,1,(o*100+parseFloat(r)*100)/100)});return Vd(i)}var FL=fp(K7);function W7(r,e){if(e==="transparent")return e;var t=pp(e),o=typeof t.alpha=="number"?t.alpha:1,i=uc({},t,{alpha:mp(0,1,+(o*100-parseFloat(r)*100).toFixed(2)/100)});return Vd(i)}var Q7=fp(W7),Y7=Q7,Qt={primary:"#FF4785",secondary:"#029CFD",tertiary:"#FAFBFC",ancillary:"#22a699",orange:"#FC521F",gold:"#FFAE00",green:"#66BF3C",seafoam:"#37D5D3",purple:"#6F2CAC",ultraviolet:"#2A0481",lightest:"#FFFFFF",lighter:"#F7FAFC",light:"#EEF3F6",mediumlight:"#ECF4F9",medium:"#D9E8F2",mediumdark:"#73828C",dark:"#5C6870",darker:"#454E54",darkest:"#2E3438",border:"hsla(203, 50%, 30%, 0.15)",positive:"#66BF3C",negative:"#FF4400",warning:"#E69D00",critical:"#FFFFFF",defaultText:"#2E3438",inverseText:"#FFFFFF",positiveText:"#448028",negativeText:"#D43900",warningText:"#A15C20"},qx={app:"#F6F9FC",bar:Qt.lightest,content:Qt.lightest,preview:Qt.lightest,gridCellSize:10,hoverable:Y7(.9,Qt.secondary),positive:"#E1FFD4",negative:"#FEDED2",warning:"#FFF5CF",critical:"#FF4400"},hp={fonts:{base:['"Nunito Sans"',"-apple-system",'".SFNSText-Regular"','"San Francisco"',"BlinkMacSystemFont",'"Segoe UI"','"Helvetica Neue"',"Helvetica","Arial","sans-serif"].join(", "),mono:["ui-monospace","Menlo","Monaco",'"Roboto Mono"','"Oxygen Mono"','"Ubuntu Monospace"','"Source Code Pro"','"Droid Sans Mono"','"Courier New"',"monospace"].join(", ")},weight:{regular:400,bold:700},size:{s1:12,s2:14,s3:16,m1:20,m2:24,m3:28,l1:32,l2:40,l3:48,code:90}},Z7={base:"light",colorPrimary:"#FF4785",colorSecondary:"#029CFD",appBg:qx.app,appContentBg:Qt.lightest,appPreviewBg:Qt.lightest,appBorderColor:Qt.border,appBorderRadius:4,fontBase:hp.fonts.base,fontCode:hp.fonts.mono,textColor:Qt.darkest,textInverseColor:Qt.lightest,textMutedColor:Qt.dark,barTextColor:Qt.mediumdark,barHoverColor:Qt.secondary,barSelectedColor:Qt.secondary,barBg:Qt.lightest,buttonBg:qx.app,buttonBorder:Qt.medium,booleanBg:Qt.mediumlight,booleanSelectedBg:Qt.lightest,inputBg:Qt.lightest,inputBorder:Qt.border,inputTextColor:Qt.darkest,inputBorderRadius:4},Gx=Z7,J7={base:"dark",colorPrimary:"#FF4785",colorSecondary:"#029CFD",appBg:"#222425",appContentBg:"#1B1C1D",appPreviewBg:Qt.lightest,appBorderColor:"rgba(255,255,255,.1)",appBorderRadius:4,fontBase:hp.fonts.base,fontCode:hp.fonts.mono,textColor:"#C9CDCF",textInverseColor:"#222425",textMutedColor:"#798186",barTextColor:"#798186",barHoverColor:Qt.secondary,barSelectedColor:Qt.secondary,barBg:"#292C2E",buttonBg:"#222425",buttonBorder:"rgba(255,255,255,.1)",booleanBg:"#222425",booleanSelectedBg:"#2E3438",inputBg:"#1B1C1D",inputBorder:"rgba(255,255,255,.1)",inputTextColor:Qt.lightest,inputBorderRadius:4},X7=J7,{window:Wv}=Bx;var eO=r=>typeof r!="string"?(zx.warn(`Color passed to theme object should be a string. Instead ${r}(${typeof r}) was passed.`),!1):!0,tO=r=>!/(gradient|var|calc)/.test(r),rO=(r,e)=>r==="darken"?Vd(`${V7(1,e)}`,.95):r==="lighten"?Vd(`${j7(1,e)}`,.95):e,Qx=r=>e=>{if(!eO(e)||!tO(e))return e;try{return rO(r,e)}catch{return e}},DL=Qx("lighten"),LL=Qx("darken"),oO=()=>!Wv||!Wv.matchMedia?"light":Wv.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",dp={light:Gx,dark:X7,normal:Gx},Qv=oO(),e0=(r={base:Qv},e)=>{let t={...dp[Qv],...dp[r.base]||{},...r,base:dp[r.base]?r.base:Qv};return{...e,...t,barSelectedColor:r.barSelectedColor||t.colorSecondary}};var Yx=e0({base:"light",colorSecondary:"#0360B9",textColor:"#1A1A1A",textInverseColor:"rgba(255,255,255,0.9)",barTextColor:"#717171",brandTitle:"Microsoft Graph Toolkit Playground",brandUrl:"https://aka.ms/mgt"});l();c();d();var Er=__REACT__,{Children:JL,Component:Zx,Fragment:XL,Profiler:eN,PureComponent:tN,StrictMode:rN,Suspense:oN,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:iN,cloneElement:nN,createContext:sN,createElement:aN,createFactory:lN,createRef:cN,forwardRef:dN,isValidElement:uN,lazy:hN,memo:pN,useCallback:fN,useContext:mN,useDebugValue:gN,useEffect:vN,useImperativeHandle:yN,useLayoutEffect:bN,useMemo:wN,useReducer:CN,useRef:xN,useState:Jx,version:kN}=__REACT__;l();c();d();var IN=__STORYBOOK_API__,{ActiveTabs:AN,Consumer:RN,ManagerContext:PN,Provider:$N,addons:ON,combineParameters:MN,controlOrMetaKey:FN,controlOrMetaSymbol:DN,eventMatchesShortcut:LN,eventToShortcut:NN,isMacLike:HN,isShortcutTaken:UN,keyToSymbol:BN,merge:zN,mockChannel:VN,optionOrAltSymbol:qN,shortcutMatchesShortcut:GN,shortcutToHumanString:jN,types:KN,useAddonState:WN,useArgTypes:QN,useArgs:YN,useChannel:Xx,useGlobalTypes:ZN,useGlobals:JN,useParameter:XN,useSharedState:eH,useStoryPrepared:tH,useStorybookApi:rH,useStorybookState:oH}=__STORYBOOK_API__;es();bn();l();c();d();ge();l();c();d();l();c();d();l();c();d();l();c();d();var ny=function(r,e){return ny=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])},ny(r,e)};function mt(r,e){ny(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ae=function(){return ae=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},ae.apply(this,arguments)};function sy(r,e){var t={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(r);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(r,o[i])&&(t[o[i]]=r[o[i]]);return t}function F(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})}function D(r,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(p){return u([h,p])}}function u(h){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,i&&(n=h[0]&2?i.return:h[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,h[1])).done)return n;switch(i=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,i=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(r,t)}catch(p){h=[6,p],i=0}finally{o=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function s9(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var o=t.call(r),i,n=[],s;try{for(;(e===void 0||e-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(s)throw s.error}}return n}function Tc(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(s9(arguments[e]));return r}l();c();d();l();c();d();l();c();d();var ay=function(r,e){return ay=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])},ay(r,e)};function nt(r,e){ay(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var rt=function(){return rt=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++){t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},rt.apply(this,arguments)};function le(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})}function ce(r,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(p){return u([h,p])}}function u(h){if(o)throw new TypeError("Generator is already executing.");for(;t;)try{if(o=1,i&&(n=h[0]&2?i.return:h[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,h[1])).done)return n;switch(i=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,i=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){t.label=h[1];break}if(h[0]===6&&t.label<n[1]){t.label=n[1],n=h;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(h);break}n[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(r,t)}catch(p){h=[6,p],i=0}finally{o=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Xs(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var o=Array(r),i=0,e=0;e<t;e++)for(var n=arguments[e],s=0,a=n.length;s<a;s++,i++)o[i]=n[s];return o}l();c();d();l();c();d();l();c();d();l();c();d();l();c();d();var _={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Yi=[_.OPENID_SCOPE,_.PROFILE_SCOPE,_.OFFLINE_ACCESS_SCOPE],ly=Xs(Yi,[_.EMAIL_SCOPE]),Dt;(function(r){r.CONTENT_TYPE="Content-Type",r.RETRY_AFTER="Retry-After",r.CCS_HEADER="X-AnchorMailbox",r.WWWAuthenticate="WWW-Authenticate",r.AuthenticationInfo="Authentication-Info",r.X_MS_REQUEST_ID="x-ms-request-id",r.X_MS_HTTP_VERSION="x-ms-httpver"})(Dt||(Dt={}));var pr;(function(r){r.ID_TOKEN="idtoken",r.CLIENT_INFO="client.info",r.ADAL_ID_TOKEN="adal.idtoken",r.ERROR="error",r.ERROR_DESC="error.description",r.ACTIVE_ACCOUNT="active-account",r.ACTIVE_ACCOUNT_FILTERS="active-account-filters"})(pr||(pr={}));var cs;(function(r){r.COMMON="common",r.ORGANIZATIONS="organizations",r.CONSUMERS="consumers"})(cs||(cs={}));var Ne;(function(r){r.CLIENT_ID="client_id",r.REDIRECT_URI="redirect_uri",r.RESPONSE_TYPE="response_type",r.RESPONSE_MODE="response_mode",r.GRANT_TYPE="grant_type",r.CLAIMS="claims",r.SCOPE="scope",r.ERROR="error",r.ERROR_DESCRIPTION="error_description",r.ACCESS_TOKEN="access_token",r.ID_TOKEN="id_token",r.REFRESH_TOKEN="refresh_token",r.EXPIRES_IN="expires_in",r.STATE="state",r.NONCE="nonce",r.PROMPT="prompt",r.SESSION_STATE="session_state",r.CLIENT_INFO="client_info",r.CODE="code",r.CODE_CHALLENGE="code_challenge",r.CODE_CHALLENGE_METHOD="code_challenge_method",r.CODE_VERIFIER="code_verifier",r.CLIENT_REQUEST_ID="client-request-id",r.X_CLIENT_SKU="x-client-SKU",r.X_CLIENT_VER="x-client-VER",r.X_CLIENT_OS="x-client-OS",r.X_CLIENT_CPU="x-client-CPU",r.X_CLIENT_CURR_TELEM="x-client-current-telemetry",r.X_CLIENT_LAST_TELEM="x-client-last-telemetry",r.X_MS_LIB_CAPABILITY="x-ms-lib-capability",r.X_APP_NAME="x-app-name",r.X_APP_VER="x-app-ver",r.POST_LOGOUT_URI="post_logout_redirect_uri",r.ID_TOKEN_HINT="id_token_hint",r.DEVICE_CODE="device_code",r.CLIENT_SECRET="client_secret",r.CLIENT_ASSERTION="client_assertion",r.CLIENT_ASSERTION_TYPE="client_assertion_type",r.TOKEN_TYPE="token_type",r.REQ_CNF="req_cnf",r.OBO_ASSERTION="assertion",r.REQUESTED_TOKEN_USE="requested_token_use",r.ON_BEHALF_OF="on_behalf_of",r.FOCI="foci",r.CCS_HEADER="X-AnchorMailbox",r.RETURN_SPA_CODE="return_spa_code",r.NATIVE_BROKER="nativebroker",r.LOGOUT_HINT="logout_hint"})(Ne||(Ne={}));var ea;(function(r){r.ACCESS_TOKEN="access_token",r.XMS_CC="xms_cc"})(ea||(ea={}));var or={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},fl;(function(r){r.ACCOUNT="account",r.SID="sid",r.LOGIN_HINT="login_hint",r.ID_TOKEN="id_token",r.DOMAIN_HINT="domain_hint",r.ORGANIZATIONS="organizations",r.CONSUMERS="consumers",r.ACCOUNT_ID="accountIdentifier",r.HOMEACCOUNT_ID="homeAccountIdentifier"})(fl||(fl={}));var _f={PLAIN:"plain",S256:"S256"},ml;(function(r){r.QUERY="query",r.FRAGMENT="fragment",r.FORM_POST="form_post"})(ml||(ml={}));var Uo;(function(r){r.IMPLICIT_GRANT="implicit",r.AUTHORIZATION_CODE_GRANT="authorization_code",r.CLIENT_CREDENTIALS_GRANT="client_credentials",r.RESOURCE_OWNER_PASSWORD_GRANT="password",r.REFRESH_TOKEN_GRANT="refresh_token",r.DEVICE_CODE_GRANT="device_code",r.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"})(Uo||(Uo={}));var Qi;(function(r){r.MSSTS_ACCOUNT_TYPE="MSSTS",r.ADFS_ACCOUNT_TYPE="ADFS",r.MSAV1_ACCOUNT_TYPE="MSA",r.GENERIC_ACCOUNT_TYPE="Generic"})(Qi||(Qi={}));var Lt;(function(r){r.CACHE_KEY_SEPARATOR="-",r.CLIENT_INFO_SEPARATOR="."})(Lt||(Lt={}));var ue;(function(r){r.ID_TOKEN="IdToken",r.ACCESS_TOKEN="AccessToken",r.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",r.REFRESH_TOKEN="RefreshToken"})(ue||(ue={}));var gi;(function(r){r[r.ADFS=1001]="ADFS",r[r.MSA=1002]="MSA",r[r.MSSTS=1003]="MSSTS",r[r.GENERIC=1004]="GENERIC",r[r.ACCESS_TOKEN=2001]="ACCESS_TOKEN",r[r.REFRESH_TOKEN=2002]="REFRESH_TOKEN",r[r.ID_TOKEN=2003]="ID_TOKEN",r[r.APP_METADATA=3001]="APP_METADATA",r[r.UNDEFINED=9999]="UNDEFINED"})(gi||(gi={}));var _u="appmetadata",w_="client_info",ta="1",vl={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},si;(function(r){r.CONFIG="config",r.CACHE="cache",r.NETWORK="network",r.HARDCODED_VALUES="hardcoded_values"})(si||(si={}));var Ar={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Be;(function(r){r.BEARER="Bearer",r.POP="pop",r.SSH="ssh-cert"})(Be||(Be={}));var us={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Tf={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Ec;(function(r){r.username="username",r.password="password"})(Ec||(Ec={}));var gl;(function(r){r[r.httpSuccess=200]="httpSuccess",r[r.httpBadRequest=400]="httpBadRequest"})(gl||(gl={}));var ds;(function(r){r.FAILED_AUTO_DETECTION="1",r.INTERNAL_CACHE="2",r.ENVIRONMENT_VARIABLE="3",r.IMDS="4"})(ds||(ds={}));var Ic;(function(r){r.CONFIGURED_MATCHES_DETECTED="1",r.CONFIGURED_NO_AUTO_DETECTION="2",r.CONFIGURED_NOT_DETECTED="3",r.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",r.AUTO_DETECTION_REQUESTED_FAILED="5"})(Ic||(Ic={}));var vo;(function(r){r.NO_CACHE_HIT="0",r.FORCE_REFRESH="1",r.NO_CACHED_ACCESS_TOKEN="2",r.CACHED_ACCESS_TOKEN_EXPIRED="3",r.REFRESH_CACHED_ACCESS_TOKEN="4",r.CLAIMS_REQUESTED_CACHE_SKIPPED="5"})(vo||(vo={}));var Sf;(function(r){r.Jwt="JWT",r.Jwk="JWK",r.Pop="pop"})(Sf||(Sf={}));var Ac={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}},ee=function(r){nt(e,r);function e(t,o,i){var n=this,s=o?t+": "+o:t;return n=r.call(this,s)||this,Object.setPrototypeOf(n,e.prototype),n.errorCode=t||_.EMPTY_STRING,n.errorMessage=o||_.EMPTY_STRING,n.subError=i||_.EMPTY_STRING,n.name="AuthError",n}return e.prototype.setCorrelationId=function(t){this.correlationId=t},e.createUnexpectedError=function(t){return new e(Ac.unexpectedError.code,Ac.unexpectedError.desc+": "+t)},e.createPostRequestFailed=function(t){return new e(Ac.postRequestFailed.code,Ac.postRequestFailed.desc+": "+t)},e}(Error);var ra={createNewGuid:function(){var r="Crypto interface - createNewGuid() has not been implemented";throw ee.createUnexpectedError(r)},base64Decode:function(){var r="Crypto interface - base64Decode() has not been implemented";throw ee.createUnexpectedError(r)},base64Encode:function(){var r="Crypto interface - base64Encode() has not been implemented";throw ee.createUnexpectedError(r)},generatePkceCodes:function(){return le(this,void 0,void 0,function(){var r;return ce(this,function(e){throw r="Crypto interface - generatePkceCodes() has not been implemented",ee.createUnexpectedError(r)})})},getPublicKeyThumbprint:function(){return le(this,void 0,void 0,function(){var r;return ce(this,function(e){throw r="Crypto interface - getPublicKeyThumbprint() has not been implemented",ee.createUnexpectedError(r)})})},removeTokenBindingKey:function(){return le(this,void 0,void 0,function(){var r;return ce(this,function(e){throw r="Crypto interface - removeTokenBindingKey() has not been implemented",ee.createUnexpectedError(r)})})},clearKeystore:function(){return le(this,void 0,void 0,function(){var r;return ce(this,function(e){throw r="Crypto interface - clearKeystore() has not been implemented",ee.createUnexpectedError(r)})})},signJwt:function(){return le(this,void 0,void 0,function(){var r;return ce(this,function(e){throw r="Crypto interface - signJwt() has not been implemented",ee.createUnexpectedError(r)})})},hashString:function(){return le(this,void 0,void 0,function(){var r;return ce(this,function(e){throw r="Crypto interface - hashString() has not been implemented",ee.createUnexpectedError(r)})})}};l();c();d();l();c();d();l();c();d();var K={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},authTimeNotFoundError:{code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},maxAgeTranspiredError:{code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},userCanceledError:{code:"user_canceled",desc:"User canceled the flow."}},U=function(r){nt(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,e.prototype),i}return e.createClientInfoDecodingError=function(t){return new e(K.clientInfoDecodingError.code,K.clientInfoDecodingError.desc+" Failed with error: "+t)},e.createClientInfoEmptyError=function(){return new e(K.clientInfoEmptyError.code,""+K.clientInfoEmptyError.desc)},e.createTokenParsingError=function(t){return new e(K.tokenParsingError.code,K.tokenParsingError.desc+" Failed with error: "+t)},e.createTokenNullOrEmptyError=function(t){return new e(K.nullOrEmptyToken.code,K.nullOrEmptyToken.desc+" Raw Token Value: "+t)},e.createEndpointDiscoveryIncompleteError=function(t){return new e(K.endpointResolutionError.code,K.endpointResolutionError.desc+" Detail: "+t)},e.createNetworkError=function(t,o){return new e(K.networkError.code,K.networkError.desc+" | Fetch client threw: "+o+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToGetOpenidConfigError=function(t){return new e(K.unableToGetOpenidConfigError.code,K.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+t)},e.createHashNotDeserializedError=function(t){return new e(K.hashNotDeserialized.code,K.hashNotDeserialized.desc+" Given Object: "+t)},e.createInvalidStateError=function(t,o){return new e(K.invalidStateError.code,K.invalidStateError.desc+" Invalid State: "+t+", Root Err: "+o)},e.createStateMismatchError=function(){return new e(K.stateMismatchError.code,K.stateMismatchError.desc)},e.createStateNotFoundError=function(t){return new e(K.stateNotFoundError.code,K.stateNotFoundError.desc+":  "+t)},e.createNonceMismatchError=function(){return new e(K.nonceMismatchError.code,K.nonceMismatchError.desc)},e.createAuthTimeNotFoundError=function(){return new e(K.authTimeNotFoundError.code,K.authTimeNotFoundError.desc)},e.createMaxAgeTranspiredError=function(){return new e(K.maxAgeTranspiredError.code,K.maxAgeTranspiredError.desc)},e.createNonceNotFoundError=function(t){return new e(K.nonceNotFoundError.code,K.nonceNotFoundError.desc+":  "+t)},e.createMultipleMatchingTokensInCacheError=function(){return new e(K.multipleMatchingTokens.code,K.multipleMatchingTokens.desc+".")},e.createMultipleMatchingAccountsInCacheError=function(){return new e(K.multipleMatchingAccounts.code,K.multipleMatchingAccounts.desc)},e.createMultipleMatchingAppMetadataInCacheError=function(){return new e(K.multipleMatchingAppMetadata.code,K.multipleMatchingAppMetadata.desc)},e.createTokenRequestCannotBeMadeError=function(){return new e(K.tokenRequestCannotBeMade.code,K.tokenRequestCannotBeMade.desc)},e.createAppendEmptyScopeToSetError=function(t){return new e(K.appendEmptyScopeError.code,K.appendEmptyScopeError.desc+" Given Scope: "+t)},e.createRemoveEmptyScopeFromSetError=function(t){return new e(K.removeEmptyScopeError.code,K.removeEmptyScopeError.desc+" Given Scope: "+t)},e.createAppendScopeSetError=function(t){return new e(K.appendScopeSetError.code,K.appendScopeSetError.desc+" Detail Error: "+t)},e.createEmptyInputScopeSetError=function(){return new e(K.emptyInputScopeSetError.code,""+K.emptyInputScopeSetError.desc)},e.createDeviceCodeCancelledError=function(){return new e(K.DeviceCodePollingCancelled.code,""+K.DeviceCodePollingCancelled.desc)},e.createDeviceCodeExpiredError=function(){return new e(K.DeviceCodeExpired.code,""+K.DeviceCodeExpired.desc)},e.createDeviceCodeUnknownError=function(){return new e(K.DeviceCodeUnknownError.code,""+K.DeviceCodeUnknownError.desc)},e.createNoAccountInSilentRequestError=function(){return new e(K.NoAccountInSilentRequest.code,""+K.NoAccountInSilentRequest.desc)},e.createNullOrUndefinedCacheRecord=function(){return new e(K.invalidCacheRecord.code,K.invalidCacheRecord.desc)},e.createInvalidCacheEnvironmentError=function(){return new e(K.invalidCacheEnvironment.code,K.invalidCacheEnvironment.desc)},e.createNoAccountFoundError=function(){return new e(K.noAccountFound.code,K.noAccountFound.desc)},e.createCachePluginError=function(){return new e(K.CachePluginError.code,""+K.CachePluginError.desc)},e.createNoCryptoObjectError=function(t){return new e(K.noCryptoObj.code,""+K.noCryptoObj.desc+t)},e.createInvalidCacheTypeError=function(){return new e(K.invalidCacheType.code,""+K.invalidCacheType.desc)},e.createUnexpectedAccountTypeError=function(){return new e(K.unexpectedAccountType.code,""+K.unexpectedAccountType.desc)},e.createUnexpectedCredentialTypeError=function(){return new e(K.unexpectedCredentialType.code,""+K.unexpectedCredentialType.desc)},e.createInvalidAssertionError=function(){return new e(K.invalidAssertion.code,""+K.invalidAssertion.desc)},e.createInvalidCredentialError=function(){return new e(K.invalidClientCredential.code,""+K.invalidClientCredential.desc)},e.createRefreshRequiredError=function(){return new e(K.tokenRefreshRequired.code,K.tokenRefreshRequired.desc)},e.createUserTimeoutReachedError=function(){return new e(K.userTimeoutReached.code,K.userTimeoutReached.desc)},e.createTokenClaimsRequiredError=function(){return new e(K.tokenClaimsRequired.code,K.tokenClaimsRequired.desc)},e.createNoAuthCodeInServerResponseError=function(){return new e(K.noAuthorizationCodeFromServer.code,K.noAuthorizationCodeFromServer.desc)},e.createBindingKeyNotRemovedError=function(){return new e(K.bindingKeyNotRemovedError.code,K.bindingKeyNotRemovedError.desc)},e.createLogoutNotSupportedError=function(){return new e(K.logoutNotSupported.code,K.logoutNotSupported.desc)},e.createKeyIdMissingError=function(){return new e(K.keyIdMissing.code,K.keyIdMissing.desc)},e.createNoNetworkConnectivityError=function(){return new e(K.noNetworkConnectivity.code,K.noNetworkConnectivity.desc)},e.createUserCanceledError=function(){return new e(K.userCanceledError.code,K.userCanceledError.desc)},e}(ee);var z=function(){function r(){}return r.decodeAuthToken=function(e){if(r.isEmpty(e))throw U.createTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,o=t.exec(e);if(!o||o.length<4)throw U.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));var i={header:o[1],JWSPayload:o[2],JWSSig:o[3]};return i},r.isEmpty=function(e){return typeof e>"u"||!e||e.length===0},r.isEmptyObj=function(e){if(e&&!r.isEmpty(e))try{var t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0},r.startsWith=function(e,t){return e.indexOf(t)===0},r.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},r.queryStringToObject=function(e){var t={},o=e.split("&"),i=function(n){return decodeURIComponent(n.replace(/\+/g," "))};return o.forEach(function(n){if(n.trim()){var s=n.split(/=(.+)/g,2),a=s[0],u=s[1];a&&u&&(t[i(a)]=i(u))}}),t},r.trimArrayEntries=function(e){return e.map(function(t){return t.trim()})},r.removeEmptyStringsFromArray=function(e){return e.filter(function(t){return!r.isEmpty(t)})},r.jsonParseHelper=function(e){try{return JSON.parse(e)}catch{return null}},r.matchPattern=function(e,t){var o=new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?"));return o.test(t)},r}();var ir;(function(r){r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace"})(ir||(ir={}));var _n=function(){function r(e,t,o){this.level=ir.Info;var i=function(){},n=e||r.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||i,this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level=typeof n.logLevel=="number"?n.logLevel:ir.Info,this.correlationId=n.correlationId||_.EMPTY_STRING,this.packageName=t||_.EMPTY_STRING,this.packageVersion=o||_.EMPTY_STRING}return r.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:ir.Info}},r.prototype.clone=function(e,t,o){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:o||this.correlationId},e,t)},r.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var o=new Date().toUTCString(),i;z.isEmpty(t.correlationId)?z.isEmpty(this.correlationId)?i="["+o+"]":i="["+o+"] : ["+this.correlationId+"]":i="["+o+"] : ["+t.correlationId+"]";var n=i+" : "+this.packageName+"@"+this.packageVersion+" : "+ir[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},r.prototype.executeCallback=function(e,t,o){this.localCallback&&this.localCallback(e,t,o)},r.prototype.error=function(e,t){this.logMessage(e,{logLevel:ir.Error,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:ir.Error,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.warning=function(e,t){this.logMessage(e,{logLevel:ir.Warning,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:ir.Warning,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.info=function(e,t){this.logMessage(e,{logLevel:ir.Info,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:ir.Info,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:ir.Verbose,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:ir.Verbose,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.trace=function(e,t){this.logMessage(e,{logLevel:ir.Trace,containsPii:!1,correlationId:t||_.EMPTY_STRING})},r.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:ir.Trace,containsPii:!0,correlationId:t||_.EMPTY_STRING})},r.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},r}();l();c();d();var Ef="@azure/msal-common",yl="13.3.1";l();c();d();var Tn;(function(r){r[r.None=0]="None",r.AzurePublic="https://login.microsoftonline.com",r.AzurePpe="https://login.windows-ppe.net",r.AzureChina="https://login.chinacloudapi.cn",r.AzureGermany="https://login.microsoftonline.de",r.AzureUsGovernment="https://login.microsoftonline.us"})(Tn||(Tn={}));l();c();d();l();c();d();l();c();d();var Ue={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"},authorityMismatch:{code:"authority_mismatch",desc:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."}},je=function(r){nt(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,e.prototype),i}return e.createRedirectUriEmptyError=function(){return new e(Ue.redirectUriNotSet.code,Ue.redirectUriNotSet.desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(Ue.postLogoutUriNotSet.code,Ue.postLogoutUriNotSet.desc)},e.createClaimsRequestParsingError=function(t){return new e(Ue.claimsRequestParsingError.code,Ue.claimsRequestParsingError.desc+" Given value: "+t)},e.createInsecureAuthorityUriError=function(t){return new e(Ue.authorityUriInsecure.code,Ue.authorityUriInsecure.desc+" Given URI: "+t)},e.createUrlParseError=function(t){return new e(Ue.urlParseError.code,Ue.urlParseError.desc+" Given Error: "+t)},e.createUrlEmptyError=function(){return new e(Ue.urlEmptyError.code,Ue.urlEmptyError.desc)},e.createEmptyScopesArrayError=function(){return new e(Ue.emptyScopesError.code,""+Ue.emptyScopesError.desc)},e.createClientIdSingleScopeError=function(t){return new e(Ue.clientIdSingleScopeError.code,Ue.clientIdSingleScopeError.desc+" Given Scopes: "+t)},e.createInvalidPromptError=function(t){return new e(Ue.invalidPrompt.code,Ue.invalidPrompt.desc+" Given value: "+t)},e.createInvalidClaimsRequestError=function(){return new e(Ue.invalidClaimsRequest.code,Ue.invalidClaimsRequest.desc)},e.createEmptyLogoutRequestError=function(){return new e(Ue.logoutRequestEmptyError.code,Ue.logoutRequestEmptyError.desc)},e.createEmptyTokenRequestError=function(){return new e(Ue.tokenRequestEmptyError.code,Ue.tokenRequestEmptyError.desc)},e.createInvalidCodeChallengeMethodError=function(){return new e(Ue.invalidCodeChallengeMethod.code,Ue.invalidCodeChallengeMethod.desc)},e.createInvalidCodeChallengeParamsError=function(){return new e(Ue.invalidCodeChallengeParams.code,Ue.invalidCodeChallengeParams.desc)},e.createInvalidCloudDiscoveryMetadataError=function(){return new e(Ue.invalidCloudDiscoveryMetadata.code,Ue.invalidCloudDiscoveryMetadata.desc)},e.createInvalidAuthorityMetadataError=function(){return new e(Ue.invalidAuthorityMetadata.code,Ue.invalidAuthorityMetadata.desc)},e.createUntrustedAuthorityError=function(){return new e(Ue.untrustedAuthority.code,Ue.untrustedAuthority.desc)},e.createInvalidAzureCloudInstanceError=function(){return new e(Ue.invalidAzureCloudInstance.code,Ue.invalidAzureCloudInstance.desc)},e.createMissingSshJwkError=function(){return new e(Ue.missingSshJwk.code,Ue.missingSshJwk.desc)},e.createMissingSshKidError=function(){return new e(Ue.missingSshKid.code,Ue.missingSshKid.desc)},e.createMissingNonceAuthenticationHeadersError=function(){return new e(Ue.missingNonceAuthenticationHeader.code,Ue.missingNonceAuthenticationHeader.desc)},e.createInvalidAuthenticationHeaderError=function(t,o){return new e(Ue.invalidAuthenticationHeader.code,Ue.invalidAuthenticationHeader.desc+". Invalid header: "+t+". Details: "+o)},e.createAuthorityMismatchError=function(){return new e(Ue.authorityMismatch.code,Ue.authorityMismatch.desc)},e}(U);var It=function(){function r(e){var t=this,o=e?z.trimArrayEntries(Xs(e)):[],i=o?z.removeEmptyStringsFromArray(o):[];this.validateInputScopes(i),this.scopes=new Set,i.forEach(function(n){return t.scopes.add(n)})}return r.fromString=function(e){var t=e||_.EMPTY_STRING,o=t.split(" ");return new r(o)},r.createSearchScopes=function(e){var t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(_.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t},r.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw je.createEmptyScopesArrayError()},r.prototype.containsScope=function(e){var t=this.printScopesLowerCase().split(" "),o=new r(t);return z.isEmpty(e)?!1:o.scopes.has(e.toLowerCase())},r.prototype.containsScopeSet=function(e){var t=this;return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(function(o){return t.containsScope(o)})},r.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return ly.forEach(function(o){e.containsScope(o)&&(t+=1)}),this.scopes.size===t},r.prototype.appendScope=function(e){z.isEmpty(e)||this.scopes.add(e.trim())},r.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(o){return t.appendScope(o)})}catch(o){throw U.createAppendScopeSetError(o)}},r.prototype.removeScope=function(e){if(z.isEmpty(e))throw U.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},r.prototype.removeOIDCScopes=function(){var e=this;ly.forEach(function(t){e.scopes.delete(t)})},r.prototype.unionScopeSets=function(e){if(!e)throw U.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach(function(o){return t.add(o.toLowerCase())}),this.scopes.forEach(function(o){return t.add(o.toLowerCase())}),t},r.prototype.intersectingScopeSets=function(e){if(!e)throw U.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),o=e.getScopeCount(),i=this.getScopeCount(),n=t.size;return n<i+o},r.prototype.getScopeCount=function(){return this.scopes.size},r.prototype.asArray=function(){var e=[];return this.scopes.forEach(function(t){return e.push(t)}),e},r.prototype.printScopes=function(){if(this.scopes){var e=this.asArray();return e.join(" ")}return _.EMPTY_STRING},r.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},r}();l();c();d();l();c();d();function oa(r,e){if(z.isEmpty(r))throw U.createClientInfoEmptyError();try{var t=e.base64Decode(r);return JSON.parse(t)}catch(o){throw U.createClientInfoDecodingError(o.message)}}function En(r){if(z.isEmpty(r))throw U.createClientInfoDecodingError("Home account ID was empty.");var e=r.split(Lt.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?_.EMPTY_STRING:e[1]}}l();c();d();var wr;(function(r){r[r.Default=0]="Default",r[r.Adfs=1]="Adfs",r[r.Dsts=2]="Dsts",r[r.Ciam=3]="Ciam"})(wr||(wr={}));var Nt=function(){function r(){}return r.prototype.generateAccountId=function(){var e=[this.homeAccountId,this.environment];return e.join(Lt.CACHE_KEY_SEPARATOR).toLowerCase()},r.prototype.generateAccountKey=function(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},r.prototype.generateType=function(){switch(this.authorityType){case Qi.ADFS_ACCOUNT_TYPE:return gi.ADFS;case Qi.MSAV1_ACCOUNT_TYPE:return gi.MSA;case Qi.MSSTS_ACCOUNT_TYPE:return gi.MSSTS;case Qi.GENERIC_ACCOUNT_TYPE:return gi.GENERIC;default:throw U.createUnexpectedAccountTypeError()}},r.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},r.generateAccountCacheKey=function(e){var t=[e.homeAccountId,e.environment||_.EMPTY_STRING,e.tenantId||_.EMPTY_STRING];return t.join(Lt.CACHE_KEY_SEPARATOR).toLowerCase()},r.createAccount=function(e,t,o,i,n,s,a,u){var h,p,f,b,C,S,R=new r;R.authorityType=Qi.MSSTS_ACCOUNT_TYPE,R.clientInfo=e,R.homeAccountId=t,R.nativeAccountId=u;var N=a||i&&i.getPreferredCache();if(!N)throw U.createInvalidCacheEnvironmentError();if(R.environment=N,R.realm=((h=o?.claims)===null||h===void 0?void 0:h.tid)||_.EMPTY_STRING,o){R.idTokenClaims=o.claims,R.localAccountId=((p=o?.claims)===null||p===void 0?void 0:p.oid)||((f=o?.claims)===null||f===void 0?void 0:f.sub)||_.EMPTY_STRING;var ye=(b=o?.claims)===null||b===void 0?void 0:b.preferred_username,ie=!((C=o?.claims)===null||C===void 0)&&C.emails?o.claims.emails[0]:null;R.username=ye||ie||_.EMPTY_STRING,R.name=(S=o?.claims)===null||S===void 0?void 0:S.name}return R.cloudGraphHostName=n,R.msGraphHost=s,R},r.createGenericAccount=function(e,t,o,i,n,s){var a,u,h,p,f=new r;f.authorityType=o&&o.authorityType===wr.Adfs?Qi.ADFS_ACCOUNT_TYPE:Qi.GENERIC_ACCOUNT_TYPE,f.homeAccountId=e,f.realm=_.EMPTY_STRING;var b=s||o&&o.getPreferredCache();if(!b)throw U.createInvalidCacheEnvironmentError();return t&&(f.localAccountId=((a=t?.claims)===null||a===void 0?void 0:a.oid)||((u=t?.claims)===null||u===void 0?void 0:u.sub)||_.EMPTY_STRING,f.username=((h=t?.claims)===null||h===void 0?void 0:h.upn)||_.EMPTY_STRING,f.name=((p=t?.claims)===null||p===void 0?void 0:p.name)||_.EMPTY_STRING,f.idTokenClaims=t?.claims),f.environment=b,f.cloudGraphHostName=i,f.msGraphHost=n,f},r.generateHomeAccountId=function(e,t,o,i,n){var s,a=!((s=n?.claims)===null||s===void 0)&&s.sub?n.claims.sub:_.EMPTY_STRING;if(t===wr.Adfs||t===wr.Dsts)return a;if(e)try{var u=oa(e,i);if(!z.isEmpty(u.uid)&&!z.isEmpty(u.utid))return""+u.uid+Lt.CLIENT_INFO_SEPARATOR+u.utid}catch{}return o.verbose("No client info in response"),a},r.isAccountEntity=function(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1},r.accountInfoIsEqual=function(e,t,o){if(!e||!t)return!1;var i=!0;if(o){var n=e.idTokenClaims||{},s=t.idTokenClaims||{};i=n.iat===s.iat&&n.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i},r}();l();c();d();var fr=function(){function r(e,t){if(z.isEmpty(e))throw U.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=r.extractTokenClaims(e,t)}return r.extractTokenClaims=function(e,t){var o=z.decodeAuthToken(e);try{var i=o.JWSPayload,n=t.base64Decode(i);return JSON.parse(n)}catch(s){throw U.createTokenParsingError(s)}},r.checkMaxAge=function(e,t){var o=3e5;if(t===0||Date.now()-o>e+t)throw U.createMaxAgeTranspiredError()},r}();var Xr=function(){function r(e,t,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=o.clone(Ef,yl)}return r.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var o=t.reduce(function(n,s){var a=e.getAccount(s);return a&&n.push(a),n},[]);if(o.length<1)return[];var i=o.map(function(n){return e.getAccountInfoFromEntity(n)});return i},r.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},r.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),o=this.getIdToken(t);return o&&(t.idToken=o.secret,t.idTokenClaims=new fr(o.secret,this.cryptoImpl).claims),t},r.prototype.saveCacheRecord=function(e){return le(this,void 0,void 0,function(){return ce(this,function(t){switch(t.label){case 0:if(!e)throw U.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}})})},r.prototype.saveAccessToken=function(e){return le(this,void 0,void 0,function(){var t,o,i,n,s=this;return ce(this,function(a){switch(a.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},o=this.getTokenKeys(),i=It.fromString(e.target),n=[],o.accessToken.forEach(function(u){if(s.accessTokenKeyMatchesFilter(u,t,!1)){var h=s.getAccessTokenCredential(u);if(h&&s.credentialMatchesFilter(h,t)){var p=It.fromString(h.target);p.intersectingScopeSets(i)&&n.push(s.removeAccessToken(u))}}}),[4,Promise.all(n)];case 1:return a.sent(),this.setAccessTokenCredential(e),[2]}})})},r.prototype.getAccountsFilteredBy=function(e){var t=this,o=this.getAccountKeys(),i=[];return o.forEach(function(n){if(t.isAccountKey(n,e.homeAccountId,e.realm)){var s=t.getAccount(n);s&&(e.homeAccountId&&!t.matchHomeAccountId(s,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(s,e.localAccountId)||e.username&&!t.matchUsername(s,e.username)||e.environment&&!t.matchEnvironment(s,e.environment)||e.realm&&!t.matchRealm(s,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(s,e.nativeAccountId)||i.push(s))}}),i},r.prototype.isAccountKey=function(e,t,o){return!(e.split(Lt.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||o&&!e.toLowerCase().includes(o.toLowerCase()))},r.prototype.isCredentialKey=function(e){if(e.split(Lt.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(t.indexOf(ue.ID_TOKEN.toLowerCase())===-1&&t.indexOf(ue.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(ue.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(ue.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(ue.REFRESH_TOKEN.toLowerCase())>-1){var o=""+ue.REFRESH_TOKEN+Lt.CACHE_KEY_SEPARATOR+this.clientId+Lt.CACHE_KEY_SEPARATOR,i=""+ue.REFRESH_TOKEN+Lt.CACHE_KEY_SEPARATOR+ta+Lt.CACHE_KEY_SEPARATOR;if(t.indexOf(o.toLowerCase())===-1&&t.indexOf(i.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0},r.prototype.credentialMatchesFilter=function(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===ue.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===Be.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))},r.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},r.prototype.getAppMetadataFilteredByInternal=function(e,t){var o=this,i=this.getKeys(),n={};return i.forEach(function(s){if(o.isAppMetadata(s)){var a=o.getAppMetadata(s);a&&(e&&!o.matchEnvironment(a,e)||t&&!o.matchClientId(a,t)||(n[s]=a))}}),n},r.prototype.getAuthorityMetadataByAlias=function(e){var t=this,o=this.getAuthorityMetadataKeys(),i=null;return o.forEach(function(n){if(!(!t.isAuthorityMetadata(n)||n.indexOf(t.clientId)===-1)){var s=t.getAuthorityMetadata(n);s&&s.aliases.indexOf(e)!==-1&&(i=s)}}),i},r.prototype.removeAllAccounts=function(){return le(this,void 0,void 0,function(){var e,t,o=this;return ce(this,function(i){switch(i.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach(function(n){t.push(o.removeAccount(n))}),[4,Promise.all(t)];case 1:return i.sent(),[2]}})})},r.prototype.removeAccount=function(e){return le(this,void 0,void 0,function(){var t;return ce(this,function(o){switch(o.label){case 0:if(t=this.getAccount(e),!t)throw U.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return o.sent(),this.removeItem(e),[2]}})})},r.prototype.removeAccountContext=function(e){return le(this,void 0,void 0,function(){var t,o,i,n=this;return ce(this,function(s){switch(s.label){case 0:return t=this.getTokenKeys(),o=e.generateAccountId(),i=[],t.idToken.forEach(function(a){a.indexOf(o)===0&&n.removeIdToken(a)}),t.accessToken.forEach(function(a){a.indexOf(o)===0&&i.push(n.removeAccessToken(a))}),t.refreshToken.forEach(function(a){a.indexOf(o)===0&&n.removeRefreshToken(a)}),[4,Promise.all(i)];case 1:return s.sent(),[2]}})})},r.prototype.removeAccessToken=function(e){return le(this,void 0,void 0,function(){var t,o,i;return ce(this,function(n){switch(n.label){case 0:if(t=this.getAccessTokenCredential(e),!t)return[2];if(t.credentialType.toLowerCase()!==ue.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==Be.POP)return[3,4];if(o=t,i=o.keyId,!i)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(i)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),U.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}})})},r.prototype.removeAppMetadata=function(){var e=this,t=this.getKeys();return t.forEach(function(o){e.isAppMetadata(o)&&e.removeItem(o)}),!0},r.prototype.readCacheRecord=function(e,t,o){var i=this.getTokenKeys(),n=this.readAccountFromCache(e),s=this.getIdToken(e,i),a=this.getAccessToken(e,t,i),u=this.getRefreshToken(e,!1,i),h=this.readAppMetadataFromCache(o);return n&&s&&(n.idTokenClaims=new fr(s.secret,this.cryptoImpl).claims),{account:n,idToken:s,accessToken:a,refreshToken:u,appMetadata:h}},r.prototype.readAccountFromCache=function(e){var t=Nt.generateAccountCacheKey(e);return this.getAccount(t)},r.prototype.getIdToken=function(e,t){var o=this;this.commonLogger.trace("CacheManager - getIdToken called");var i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ue.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},n=this.getIdTokensByFilter(i,t),s=n.length;return s<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):s>1?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),n.forEach(function(a){o.removeIdToken(a.generateCredentialKey())}),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),n[0])},r.prototype.getIdTokensByFilter=function(e,t){var o=this,i=t&&t.idToken||this.getTokenKeys().idToken,n=[];return i.forEach(function(s){if(o.idTokenKeyMatchesFilter(s,rt({clientId:o.clientId},e))){var a=o.getIdTokenCredential(s);a&&o.credentialMatchesFilter(a,e)&&n.push(a)}}),n},r.prototype.idTokenKeyMatchesFilter=function(e,t){var o=e.toLowerCase();return!(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1)},r.prototype.removeIdToken=function(e){this.removeItem(e)},r.prototype.removeRefreshToken=function(e){this.removeItem(e)},r.prototype.getAccessToken=function(e,t,o){var i=this;this.commonLogger.trace("CacheManager - getAccessToken called");var n=It.createSearchScopes(t.scopes),s=t.authenticationScheme||Be.BEARER,a=s&&s.toLowerCase()!==Be.BEARER.toLowerCase()?ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:ue.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:a,clientId:this.clientId,realm:e.tenantId,target:n,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},h=o&&o.accessToken||this.getTokenKeys().accessToken,p=[];h.forEach(function(b){if(i.accessTokenKeyMatchesFilter(b,u,!0)){var C=i.getAccessTokenCredential(b);C&&i.credentialMatchesFilter(C,u)&&p.push(C)}});var f=p.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),p.forEach(function(b){i.removeAccessToken(b.generateCredentialKey())}),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),p[0])},r.prototype.accessTokenKeyMatchesFilter=function(e,t,o){var i=e.toLowerCase();if(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&i.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&i.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target)for(var n=t.target.asArray(),s=0;s<n.length;s++){if(o&&!i.includes(n[s].toLowerCase()))return!1;if(!o&&i.includes(n[s].toLowerCase()))return!0}return!0},r.prototype.getAccessTokensByFilter=function(e){var t=this,o=this.getTokenKeys(),i=[];return o.accessToken.forEach(function(n){if(t.accessTokenKeyMatchesFilter(n,e,!0)){var s=t.getAccessTokenCredential(n);s&&t.credentialMatchesFilter(s,e)&&i.push(s)}}),i},r.prototype.getRefreshToken=function(e,t,o){var i=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var n=t?ta:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ue.REFRESH_TOKEN,clientId:this.clientId,familyId:n},a=o&&o.refreshToken||this.getTokenKeys().refreshToken,u=[];a.forEach(function(p){if(i.refreshTokenKeyMatchesFilter(p,s)){var f=i.getRefreshTokenCredential(p);f&&i.credentialMatchesFilter(f,s)&&u.push(f)}});var h=u.length;return h<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),u[0])},r.prototype.refreshTokenKeyMatchesFilter=function(e,t){var o=e.toLowerCase();return!(t.familyId&&o.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1)},r.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},o=this.getAppMetadataFilteredBy(t),i=Object.keys(o).map(function(s){return o[s]}),n=i.length;if(n<1)return null;if(n>1)throw U.createMultipleMatchingAppMetadataInCacheError();return i[0]},r.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===ta)},r.prototype.matchHomeAccountId=function(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId},r.prototype.matchLocalAccountId=function(e,t){return typeof e.localAccountId=="string"&&t===e.localAccountId},r.prototype.matchUsername=function(e,t){return typeof e.username=="string"&&t.toLowerCase()===e.username.toLowerCase()},r.prototype.matchUserAssertionHash=function(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)},r.prototype.matchEnvironment=function(e,t){var o=this.getAuthorityMetadataByAlias(t);return!!(o&&o.aliases.indexOf(e.environment)>-1)},r.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},r.prototype.matchClientId=function(e,t){return!!(e.clientId&&t===e.clientId)},r.prototype.matchFamilyId=function(e,t){return!!(e.familyId&&t===e.familyId)},r.prototype.matchRealm=function(e,t){return!!(e.realm&&t===e.realm)},r.prototype.matchNativeAccountId=function(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)},r.prototype.matchTarget=function(e,t){var o=e.credentialType!==ue.ACCESS_TOKEN&&e.credentialType!==ue.ACCESS_TOKEN_WITH_AUTH_SCHEME;if(o||!e.target)return!1;var i=It.fromString(e.target);return i.containsScopeSet(t)},r.prototype.matchTokenType=function(e,t){return!!(e.tokenType&&e.tokenType===t)},r.prototype.matchKeyId=function(e,t){return!!(e.keyId&&e.keyId===t)},r.prototype.isAppMetadata=function(e){return e.indexOf(_u)!==-1},r.prototype.isAuthorityMetadata=function(e){return e.indexOf(vl.CACHE_KEY)!==-1},r.prototype.generateAuthorityMetadataCacheKey=function(e){return vl.CACHE_KEY+"-"+this.clientId+"-"+e},r.toObject=function(e,t){for(var o in t)e[o]=t[o];return e},r}(),cy=function(r){nt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setAccount=function(){var t="Storage interface - setAccount() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getAccount=function(){var t="Storage interface - getAccount() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.setIdTokenCredential=function(){var t="Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getIdTokenCredential=function(){var t="Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.setAccessTokenCredential=function(){var t="Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getAccessTokenCredential=function(){var t="Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.setRefreshTokenCredential=function(){var t="Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getRefreshTokenCredential=function(){var t="Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.setAppMetadata=function(){var t="Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getAppMetadata=function(){var t="Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.setServerTelemetry=function(){var t="Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getServerTelemetry=function(){var t="Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.setAuthorityMetadata=function(){var t="Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getAuthorityMetadata=function(){var t="Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getAuthorityMetadataKeys=function(){var t="Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.setThrottlingCache=function(){var t="Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getThrottlingCache=function(){var t="Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.removeItem=function(){var t="Storage interface - removeItem() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.containsKey=function(){var t="Storage interface - containsKey() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getKeys=function(){var t="Storage interface - getKeys() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getAccountKeys=function(){var t="Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.getTokenKeys=function(){var t="Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e.prototype.clear=function(){return le(this,void 0,void 0,function(){var t;return ce(this,function(o){throw t="Storage interface - clear() has not been implemented for the cacheStorage interface.",ee.createUnexpectedError(t)})})},e.prototype.updateCredentialCacheKey=function(){var t="Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.";throw ee.createUnexpectedError(t)},e}(Xr);var a9=300,If={tokenRenewalOffsetSeconds:a9,preventCorsPreflight:!1},l9={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:ir.Info,correlationId:_.EMPTY_STRING},c9={claimsBasedCachingEnabled:!0},d9={sendGetRequestAsync:function(){return le(this,void 0,void 0,function(){var r;return ce(this,function(e){throw r="Network interface - sendGetRequestAsync() has not been implemented",ee.createUnexpectedError(r)})})},sendPostRequestAsync:function(){return le(this,void 0,void 0,function(){var r;return ce(this,function(e){throw r="Network interface - sendPostRequestAsync() has not been implemented",ee.createUnexpectedError(r)})})}},u9={sku:_.SKU,version:yl,cpu:_.EMPTY_STRING,os:_.EMPTY_STRING},h9={clientSecret:_.EMPTY_STRING,clientAssertion:void 0},p9={azureCloudInstance:Tn.None,tenant:""+_.DEFAULT_COMMON_TENANT},f9={application:{appName:"",appVersion:""}};function C_(r){var e=r.authOptions,t=r.systemOptions,o=r.loggerOptions,i=r.cacheOptions,n=r.storageInterface,s=r.networkInterface,a=r.cryptoInterface,u=r.clientCredentials,h=r.libraryInfo,p=r.telemetry,f=r.serverTelemetryManager,b=r.persistencePlugin,C=r.serializableCache,S=rt(rt({},l9),o);return{authOptions:m9(e),systemOptions:rt(rt({},If),t),loggerOptions:S,cacheOptions:rt(rt({},c9),i),storageInterface:n||new cy(e.clientId,ra,new _n(S)),networkInterface:s||d9,cryptoInterface:a||ra,clientCredentials:u||h9,libraryInfo:rt(rt({},u9),h),telemetry:rt(rt({},f9),p),serverTelemetryManager:f||null,persistencePlugin:b||null,serializableCache:C||null}}function m9(r){return rt({clientCapabilities:[],azureCloudOptions:p9,skipAuthorityMetadataCache:!1},r)}l();c();d();l();c();d();l();c();d();var eo=function(r){nt(e,r);function e(t,o,i){var n=r.call(this,t,o,i)||this;return n.name="ServerError",Object.setPrototypeOf(n,e.prototype),n}return e}(ee);var ia=function(){function r(){}return r.generateThrottlingStorageKey=function(e){return us.THROTTLING_PREFIX+"."+JSON.stringify(e)},r.preProcess=function(e,t){var o,i=r.generateThrottlingStorageKey(t),n=e.getThrottlingCache(i);if(n){if(n.throttleTime<Date.now()){e.removeItem(i);return}throw new eo(((o=n.errorCodes)===null||o===void 0?void 0:o.join(" "))||_.EMPTY_STRING,n.errorMessage,n.subError)}},r.postProcess=function(e,t,o){if(r.checkResponseStatus(o)||r.checkResponseForRetryAfter(o)){var i={throttleTime:r.calculateThrottleTime(parseInt(o.headers[Dt.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),i)}},r.checkResponseStatus=function(e){return e.status===429||e.status>=500&&e.status<600},r.checkResponseForRetryAfter=function(e){return e.headers?e.headers.hasOwnProperty(Dt.RETRY_AFTER)&&(e.status<200||e.status>=300):!1},r.calculateThrottleTime=function(e){var t=e<=0?0:e,o=Date.now()/1e3;return Math.floor(Math.min(o+(t||us.DEFAULT_THROTTLE_TIME_SECONDS),o+us.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)},r.removeThrottle=function(e,t,o,i){var n={clientId:t,authority:o.authority,scopes:o.scopes,homeAccountIdentifier:i,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},s=this.generateThrottlingStorageKey(n);e.removeItem(s)},r}();var dy=function(){function r(e,t){this.networkClient=e,this.cacheManager=t}return r.prototype.sendPostRequest=function(e,t,o){return le(this,void 0,void 0,function(){var i,n;return ce(this,function(s){switch(s.label){case 0:ia.preProcess(this.cacheManager,e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,o)];case 2:return i=s.sent(),[3,4];case 3:throw n=s.sent(),n instanceof ee?n:U.createNetworkError(t,n);case 4:return ia.postProcess(this.cacheManager,e,i),[2,i]}})})},r}();l();c();d();var Cr;(function(r){r.HOME_ACCOUNT_ID="home_account_id",r.UPN="UPN"})(Cr||(Cr={}));l();c();d();l();c();d();var hs=function(){function r(){}return r.validateRedirectUri=function(e){if(z.isEmpty(e))throw je.createRedirectUriEmptyError()},r.validatePrompt=function(e){var t=[];for(var o in or)t.push(or[o]);if(t.indexOf(e)<0)throw je.createInvalidPromptError(e)},r.validateClaims=function(e){try{JSON.parse(e)}catch{throw je.createInvalidClaimsRequestError()}},r.validateCodeChallengeParams=function(e,t){if(z.isEmpty(e)||z.isEmpty(t))throw je.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},r.validateCodeChallengeMethod=function(e){if([_f.PLAIN,_f.S256].indexOf(e)<0)throw je.createInvalidCodeChallengeMethodError()},r.sanitizeEQParams=function(e,t){return e?(t.forEach(function(o,i){e[i]&&delete e[i]}),Object.fromEntries(Object.entries(e).filter(function(o){var i=o[1];return i!==""}))):{}},r}();var Nr=function(){function r(){this.parameters=new Map}return r.prototype.addResponseTypeCode=function(){this.parameters.set(Ne.RESPONSE_TYPE,encodeURIComponent(_.CODE_RESPONSE_TYPE))},r.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(Ne.RESPONSE_TYPE,encodeURIComponent(_.TOKEN_RESPONSE_TYPE+" "+_.ID_TOKEN_RESPONSE_TYPE))},r.prototype.addResponseMode=function(e){this.parameters.set(Ne.RESPONSE_MODE,encodeURIComponent(e||ml.QUERY))},r.prototype.addNativeBroker=function(){this.parameters.set(Ne.NATIVE_BROKER,encodeURIComponent("1"))},r.prototype.addScopes=function(e,t){t===void 0&&(t=!0);var o=t?Xs(e||[],Yi):e||[],i=new It(o);this.parameters.set(Ne.SCOPE,encodeURIComponent(i.printScopes()))},r.prototype.addClientId=function(e){this.parameters.set(Ne.CLIENT_ID,encodeURIComponent(e))},r.prototype.addRedirectUri=function(e){hs.validateRedirectUri(e),this.parameters.set(Ne.REDIRECT_URI,encodeURIComponent(e))},r.prototype.addPostLogoutRedirectUri=function(e){hs.validateRedirectUri(e),this.parameters.set(Ne.POST_LOGOUT_URI,encodeURIComponent(e))},r.prototype.addIdTokenHint=function(e){this.parameters.set(Ne.ID_TOKEN_HINT,encodeURIComponent(e))},r.prototype.addDomainHint=function(e){this.parameters.set(fl.DOMAIN_HINT,encodeURIComponent(e))},r.prototype.addLoginHint=function(e){this.parameters.set(fl.LOGIN_HINT,encodeURIComponent(e))},r.prototype.addCcsUpn=function(e){this.parameters.set(Dt.CCS_HEADER,encodeURIComponent("UPN:"+e))},r.prototype.addCcsOid=function(e){this.parameters.set(Dt.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},r.prototype.addSid=function(e){this.parameters.set(fl.SID,encodeURIComponent(e))},r.prototype.addClaims=function(e,t){var o=this.addClientCapabilitiesToClaims(e,t);hs.validateClaims(o),this.parameters.set(Ne.CLAIMS,encodeURIComponent(o))},r.prototype.addCorrelationId=function(e){this.parameters.set(Ne.CLIENT_REQUEST_ID,encodeURIComponent(e))},r.prototype.addLibraryInfo=function(e){this.parameters.set(Ne.X_CLIENT_SKU,e.sku),this.parameters.set(Ne.X_CLIENT_VER,e.version),e.os&&this.parameters.set(Ne.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(Ne.X_CLIENT_CPU,e.cpu)},r.prototype.addApplicationTelemetry=function(e){e?.appName&&this.parameters.set(Ne.X_APP_NAME,e.appName),e?.appVersion&&this.parameters.set(Ne.X_APP_VER,e.appVersion)},r.prototype.addPrompt=function(e){hs.validatePrompt(e),this.parameters.set(""+Ne.PROMPT,encodeURIComponent(e))},r.prototype.addState=function(e){z.isEmpty(e)||this.parameters.set(Ne.STATE,encodeURIComponent(e))},r.prototype.addNonce=function(e){this.parameters.set(Ne.NONCE,encodeURIComponent(e))},r.prototype.addCodeChallengeParams=function(e,t){if(hs.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(Ne.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(Ne.CODE_CHALLENGE_METHOD,encodeURIComponent(t));else throw je.createInvalidCodeChallengeParamsError()},r.prototype.addAuthorizationCode=function(e){this.parameters.set(Ne.CODE,encodeURIComponent(e))},r.prototype.addDeviceCode=function(e){this.parameters.set(Ne.DEVICE_CODE,encodeURIComponent(e))},r.prototype.addRefreshToken=function(e){this.parameters.set(Ne.REFRESH_TOKEN,encodeURIComponent(e))},r.prototype.addCodeVerifier=function(e){this.parameters.set(Ne.CODE_VERIFIER,encodeURIComponent(e))},r.prototype.addClientSecret=function(e){this.parameters.set(Ne.CLIENT_SECRET,encodeURIComponent(e))},r.prototype.addClientAssertion=function(e){z.isEmpty(e)||this.parameters.set(Ne.CLIENT_ASSERTION,encodeURIComponent(e))},r.prototype.addClientAssertionType=function(e){z.isEmpty(e)||this.parameters.set(Ne.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},r.prototype.addOboAssertion=function(e){this.parameters.set(Ne.OBO_ASSERTION,encodeURIComponent(e))},r.prototype.addRequestTokenUse=function(e){this.parameters.set(Ne.REQUESTED_TOKEN_USE,encodeURIComponent(e))},r.prototype.addGrantType=function(e){this.parameters.set(Ne.GRANT_TYPE,encodeURIComponent(e))},r.prototype.addClientInfo=function(){this.parameters.set(w_,"1")},r.prototype.addExtraQueryParameters=function(e){var t=this,o=hs.sanitizeEQParams(e,this.parameters);Object.keys(o).forEach(function(i){t.parameters.set(i,e[i])})},r.prototype.addClientCapabilitiesToClaims=function(e,t){var o;if(!e)o={};else try{o=JSON.parse(e)}catch{throw je.createInvalidClaimsRequestError()}return t&&t.length>0&&(o.hasOwnProperty(ea.ACCESS_TOKEN)||(o[ea.ACCESS_TOKEN]={}),o[ea.ACCESS_TOKEN][ea.XMS_CC]={values:t}),JSON.stringify(o)},r.prototype.addUsername=function(e){this.parameters.set(Ec.username,encodeURIComponent(e))},r.prototype.addPassword=function(e){this.parameters.set(Ec.password,encodeURIComponent(e))},r.prototype.addPopToken=function(e){z.isEmpty(e)||(this.parameters.set(Ne.TOKEN_TYPE,Be.POP),this.parameters.set(Ne.REQ_CNF,encodeURIComponent(e)))},r.prototype.addSshJwk=function(e){z.isEmpty(e)||(this.parameters.set(Ne.TOKEN_TYPE,Be.SSH),this.parameters.set(Ne.REQ_CNF,encodeURIComponent(e)))},r.prototype.addServerTelemetry=function(e){this.parameters.set(Ne.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(Ne.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},r.prototype.addThrottling=function(){this.parameters.set(Ne.X_MS_LIB_CAPABILITY,us.X_MS_LIB_CAPABILITY_VALUE)},r.prototype.addLogoutHint=function(e){this.parameters.set(Ne.LOGOUT_HINT,encodeURIComponent(e))},r.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach(function(t,o){e.push(o+"="+t)}),e.join("&")},r}();var Bo=function(){function r(e,t){this.config=C_(e),this.logger=new _n(this.config.loggerOptions,Ef,yl),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new dy(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return r.prototype.createTokenRequestHeaders=function(e){var t={};if(t[Dt.CONTENT_TYPE]=_.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Cr.HOME_ACCOUNT_ID:try{var o=En(e.credential);t[Dt.CCS_HEADER]="Oid:"+o.uid+"@"+o.utid}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Cr.UPN:t[Dt.CCS_HEADER]="UPN: "+e.credential;break}return t},r.prototype.executePostToTokenEndpoint=function(e,t,o,i){return le(this,void 0,void 0,function(){var n;return ce(this,function(s){switch(s.label){case 0:return[4,this.networkManager.sendPostRequest(i,e,{body:t,headers:o})];case 1:return n=s.sent(),this.config.serverTelemetryManager&&n.status<500&&n.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,n]}})})},r.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw U.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},r.prototype.createTokenQueryParameters=function(e){var t=new Nr;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},r}();l();c();d();l();c();d();l();c();d();var bl=function(){function r(){}return r.prototype.generateAccountId=function(){return r.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},r.prototype.generateCredentialId=function(){return r.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},r.prototype.generateTarget=function(){return r.generateTargetForCacheKey(this.target)},r.prototype.generateCredentialKey=function(){return r.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},r.prototype.generateType=function(){switch(this.credentialType){case ue.ID_TOKEN:return gi.ID_TOKEN;case ue.ACCESS_TOKEN:case ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:return gi.ACCESS_TOKEN;case ue.REFRESH_TOKEN:return gi.REFRESH_TOKEN;default:throw U.createUnexpectedCredentialTypeError()}},r.generateCredentialCacheKey=function(e,t,o,i,n,s,a,u,h){var p=[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(o,i,n,a),this.generateTargetForCacheKey(s),this.generateClaimsHashForCacheKey(h),this.generateSchemeForCacheKey(u)];return p.join(Lt.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateAccountIdForCacheKey=function(e,t){var o=[e,t];return o.join(Lt.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateCredentialIdForCacheKey=function(e,t,o,i){var n=e===ue.REFRESH_TOKEN&&i||t,s=[e,n,o||_.EMPTY_STRING];return s.join(Lt.CACHE_KEY_SEPARATOR).toLowerCase()},r.generateTargetForCacheKey=function(e){return(e||_.EMPTY_STRING).toLowerCase()},r.generateClaimsHashForCacheKey=function(e){return(e||_.EMPTY_STRING).toLowerCase()},r.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==Be.BEARER.toLowerCase()?e.toLowerCase():_.EMPTY_STRING},r}();var vi=function(r){nt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createIdTokenEntity=function(t,o,i,n,s){var a=new e;return a.credentialType=ue.ID_TOKEN,a.homeAccountId=t,a.environment=o,a.clientId=n,a.secret=i,a.realm=s,a},e.isIdTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===ue.ID_TOKEN:!1},e}(bl);l();c();d();l();c();d();var st=function(){function r(){}return r.nowSeconds=function(){return Math.round(new Date().getTime()/1e3)},r.isTokenExpired=function(e,t){var o=Number(e)||0,i=r.nowSeconds()+t;return i>o},r.wasClockTurnedBack=function(e){var t=Number(e);return t>r.nowSeconds()},r.delay=function(e,t){return new Promise(function(o){return setTimeout(function(){return o(t)},e)})},r}();var yi=function(r){nt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createAccessTokenEntity=function(t,o,i,n,s,a,u,h,p,f,b,C,S,R,N){var ye,ie,me=new e;me.homeAccountId=t,me.credentialType=ue.ACCESS_TOKEN,me.secret=i;var yt=st.nowSeconds();if(me.cachedAt=yt.toString(),me.expiresOn=u.toString(),me.extendedExpiresOn=h.toString(),f&&(me.refreshOn=f.toString()),me.environment=o,me.clientId=n,me.realm=s,me.target=a,me.userAssertionHash=C,me.tokenType=z.isEmpty(b)?Be.BEARER:b,R&&(me.requestedClaims=R,me.requestedClaimsHash=N),((ye=me.tokenType)===null||ye===void 0?void 0:ye.toLowerCase())!==Be.BEARER.toLowerCase())switch(me.credentialType=ue.ACCESS_TOKEN_WITH_AUTH_SCHEME,me.tokenType){case Be.POP:var Ge=fr.extractTokenClaims(i,p);if(!(!((ie=Ge?.cnf)===null||ie===void 0)&&ie.kid))throw U.createTokenClaimsRequiredError();me.keyId=Ge.cnf.kid;break;case Be.SSH:me.keyId=S}return me},e.isAccessTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===ue.ACCESS_TOKEN||t.credentialType===ue.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1},e}(bl);l();c();d();var In=function(r){nt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.createRefreshTokenEntity=function(t,o,i,n,s,a){var u=new e;return u.clientId=n,u.credentialType=ue.REFRESH_TOKEN,u.environment=o,u.homeAccountId=t,u.secret=i,u.userAssertionHash=a,s&&(u.familyId=s),u},e.isRefreshTokenEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===ue.REFRESH_TOKEN:!1},e}(bl);l();c();d();var x_=["interaction_required","consent_required","login_required"],g9=["message_only","additional_action","basic_action","user_password_expired","consent_required"],An={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}},xr=function(r){nt(e,r);function e(t,o,i,n,s,a,u){var h=r.call(this,t,o,i)||this;return Object.setPrototypeOf(h,e.prototype),h.timestamp=n||_.EMPTY_STRING,h.traceId=s||_.EMPTY_STRING,h.correlationId=a||_.EMPTY_STRING,h.claims=u||_.EMPTY_STRING,h.name="InteractionRequiredAuthError",h}return e.isInteractionRequiredError=function(t,o,i){var n=!!t&&x_.indexOf(t)>-1,s=!!i&&g9.indexOf(i)>-1,a=!!o&&x_.some(function(u){return o.indexOf(u)>-1});return n||a||s},e.createNoTokensFoundError=function(){return new e(An.noTokensFoundError.code,An.noTokensFoundError.desc)},e.createNativeAccountUnavailableError=function(){return new e(An.native_account_unavailable.code,An.native_account_unavailable.desc)},e}(ee);l();c();d();var ps=function(){function r(e,t,o,i,n){this.account=e||null,this.idToken=t||null,this.accessToken=o||null,this.refreshToken=i||null,this.appMetadata=n||null}return r}();l();c();d();var to=function(){function r(){}return r.setRequestState=function(e,t,o){var i=r.generateLibraryState(e,o);return z.isEmpty(t)?i:""+i+_.RESOURCE_DELIM+t},r.generateLibraryState=function(e,t){if(!e)throw U.createNoCryptoObjectError("generateLibraryState");var o={id:e.createNewGuid()};t&&(o.meta=t);var i=JSON.stringify(o);return e.base64Encode(i)},r.parseRequestState=function(e,t){if(!e)throw U.createNoCryptoObjectError("parseRequestState");if(z.isEmpty(t))throw U.createInvalidStateError(t,"Null, undefined or empty state");try{var o=t.split(_.RESOURCE_DELIM),i=o[0],n=o.length>1?o.slice(1).join(_.RESOURCE_DELIM):_.EMPTY_STRING,s=e.base64Decode(i),a=JSON.parse(s);return{userRequestState:z.isEmpty(n)?_.EMPTY_STRING:n,libraryState:a}}catch(u){throw U.createInvalidStateError(t,u)}},r}();l();c();d();l();c();d();var Se=function(){function r(e){if(this._urlString=e,z.isEmpty(this._urlString))throw je.createUrlEmptyError();z.isEmpty(this.getHash())&&(this._urlString=r.canonicalizeUri(e))}return Object.defineProperty(r.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),r.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return z.endsWith(t,"?")?t=t.slice(0,-1):z.endsWith(t,"?/")&&(t=t.slice(0,-2)),z.endsWith(t,"/")||(t+="/"),t}return e},r.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw je.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw je.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw je.createInsecureAuthorityUriError(this.urlString)},r.appendQueryString=function(e,t){return z.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},r.removeHashFromUrl=function(e){return r.canonicalizeUri(e.split("#")[0])},r.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),o=t.PathSegments;return e&&o.length!==0&&(o[0]===cs.COMMON||o[0]===cs.ORGANIZATIONS)&&(o[0]=e),r.constructAuthorityUriFromObject(t)},r.prototype.getHash=function(){return r.parseHash(this.urlString)},r.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw je.createUrlParseError("Given url string: "+this.urlString);var o={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},i=o.AbsolutePath.split("/");return i=i.filter(function(n){return n&&n.length>0}),o.PathSegments=i,!z.isEmpty(o.QueryString)&&o.QueryString.endsWith("/")&&(o.QueryString=o.QueryString.substring(0,o.QueryString.length-1)),o},r.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),o=e.match(t);if(!o)throw je.createUrlParseError("Given url string: "+e);return o[2]},r.getAbsoluteUrl=function(e,t){if(e[0]===_.FORWARD_SLASH){var o=new r(t),i=o.getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e},r.parseHash=function(e){var t=e.indexOf("#"),o=e.indexOf("#/");return o>-1?e.substring(o+2):t>-1?e.substring(t+1):_.EMPTY_STRING},r.parseQueryString=function(e){var t=e.indexOf("?"),o=e.indexOf("/?");return o>-1?e.substring(o+2):t>-1?e.substring(t+1):_.EMPTY_STRING},r.constructAuthorityUriFromObject=function(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},r.getDeserializedHash=function(e){if(z.isEmpty(e))return{};var t=r.parseHash(e),o=z.queryStringToObject(z.isEmpty(t)?e:t);if(!o)throw U.createHashNotDeserializedError(JSON.stringify(o));return o},r.getDeserializedQueryString=function(e){if(z.isEmpty(e))return{};var t=r.parseQueryString(e),o=z.queryStringToObject(z.isEmpty(t)?e:t);if(!o)throw U.createHashNotDeserializedError(JSON.stringify(o));return o},r.hashContainsKnownProperties=function(e){if(z.isEmpty(e)||e.indexOf("=")<0)return!1;var t=r.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},r}();l();c();d();var $;(function(r){r.AcquireTokenByCode="acquireTokenByCode",r.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",r.AcquireTokenSilent="acquireTokenSilent",r.AcquireTokenSilentAsync="acquireTokenSilentAsync",r.AcquireTokenPopup="acquireTokenPopup",r.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",r.CryptoOptsSignJwt="cryptoOptsSignJwt",r.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",r.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",r.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",r.SsoSilent="ssoSilent",r.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",r.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",r.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",r.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",r.BrokerHandhshake="brokerHandshake",r.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",r.AcquireTokenByBroker="acquireTokenByBroker",r.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",r.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",r.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",r.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",r.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",r.AcquireTokenFromCache="acquireTokenFromCache",r.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",r.InitializeBaseRequest="initializeBaseRequest",r.InitializeSilentRequest="initializeSilentRequest",r.InitializeClientApplication="initializeClientApplication",r.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",r.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",r.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",r.SilentHandlerLoadFrame="silentHandlerLoadFrame",r.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",r.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",r.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",r.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",r.GetAuthCodeUrl="getAuthCodeUrl",r.HandleCodeResponseFromServer="handleCodeResponseFromServer",r.HandleCodeResponseFromHash="handleCodeResponseFromHash",r.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",r.AuthClientAcquireToken="authClientAcquireToken",r.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",r.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",r.AuthClientCreateQueryString="authClientCreateQueryString",r.PopTokenGenerateCnf="popTokenGenerateCnf",r.PopTokenGenerateKid="popTokenGenerateKid",r.HandleServerTokenResponse="handleServerTokenResponse",r.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",r.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",r.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",r.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",r.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",r.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",r.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",r.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",r.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",r.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",r.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",r.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",r.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",r.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",r.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",r.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",r.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake",r.ClearTokensAndKeysWithClaims="clearTokensAndKeysWithClaims"})($||($={}));var Rc;(function(r){r[r.NotStarted=0]="NotStarted",r[r.InProgress=1]="InProgress",r[r.Completed=2]="Completed"})(Rc||(Rc={}));var uy=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);var hy;(function(r){r.SW="sw",r.UHW="uhw"})(hy||(hy={}));var ai=function(){function r(e,t){this.cryptoUtils=e,this.performanceClient=t}return r.prototype.generateCnf=function(e){var t,o;return le(this,void 0,void 0,function(){var i,n,s;return ce(this,function(a){switch(a.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.PopTokenGenerateCnf,e.correlationId),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime($.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return i=a.sent(),n=this.cryptoUtils.base64Encode(JSON.stringify(i)),s={kid:i.kid,reqCnfString:n},[4,this.cryptoUtils.hashString(n)];case 2:return[2,(s.reqCnfHash=a.sent(),s)]}})})},r.prototype.generateKid=function(e){var t;return le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return o=i.sent(),[2,{kid:o,xms_ksl:hy.SW}]}})})},r.prototype.signPopToken=function(e,t,o){return le(this,void 0,void 0,function(){return ce(this,function(i){return[2,this.signPayload(e,t,o)]})})},r.prototype.signPayload=function(e,t,o,i){return le(this,void 0,void 0,function(){var n,s,a,u,h,p;return ce(this,function(f){switch(f.label){case 0:return n=o.resourceRequestMethod,s=o.resourceRequestUri,a=o.shrClaims,u=o.shrNonce,h=s?new Se(s):void 0,p=h?.getUrlComponents(),[4,this.cryptoUtils.signJwt(rt({at:e,ts:st.nowSeconds(),m:n?.toUpperCase(),u:p?.HostNameAndPort,nonce:u||this.cryptoUtils.createNewGuid(),p:p?.AbsolutePath,q:p?.QueryString?[[],p.QueryString]:void 0,client_claims:a||void 0},i),t,o.correlationId)];case 1:return[2,f.sent()]}})})},r}();l();c();d();var Pc=function(){function r(){}return r.prototype.generateAppMetadataKey=function(){return r.generateAppMetadataCacheKey(this.environment,this.clientId)},r.generateAppMetadataCacheKey=function(e,t){var o=[_u,e,t];return o.join(Lt.CACHE_KEY_SEPARATOR).toLowerCase()},r.createAppMetadataEntity=function(e,t,o){var i=new r;return i.clientId=e,i.environment=t,o&&(i.familyId=o),i},r.isAppMetadataEntity=function(e,t){return t?e.indexOf(_u)===0&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"):!1},r}();l();c();d();var py=function(){function r(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(r.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),r}();var ro=function(){function r(e,t,o,i,n,s,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=o,this.logger=i,this.serializableCache=n,this.persistencePlugin=s,this.performanceClient=a}return r.prototype.validateServerAuthorizationCodeResponse=function(e,t,o){if(!e.state||!t)throw e.state?U.createStateNotFoundError("Cached State"):U.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw U.createStateMismatchError();if(e.error||e.error_description||e.suberror)throw xr.isInteractionRequiredError(e.error,e.error_description,e.suberror)?new xr(e.error||_.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||_.EMPTY_STRING,e.trace_id||_.EMPTY_STRING,e.correlation_id||_.EMPTY_STRING,e.claims||_.EMPTY_STRING):new eo(e.error||_.EMPTY_STRING,e.error_description,e.suberror);e.client_info&&oa(e.client_info,o)},r.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(xr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new xr(e.error,e.error_description,e.suberror,e.timestamp||_.EMPTY_STRING,e.trace_id||_.EMPTY_STRING,e.correlation_id||_.EMPTY_STRING,e.claims||_.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new eo(e.error,t,e.suberror)}},r.prototype.handleServerTokenResponse=function(e,t,o,i,n,s,a,u,h){var p;return le(this,void 0,void 0,function(){var f,b,C,S,R,N,ye;return ce(this,function(ie){switch(ie.label){case 0:if((p=this.performanceClient)===null||p===void 0||p.addQueueMeasurement($.HandleServerTokenResponse,e.correlation_id),e.id_token){if(f=new fr(e.id_token||_.EMPTY_STRING,this.cryptoObj),n&&!z.isEmpty(n.nonce)&&f.claims.nonce!==n.nonce)throw U.createNonceMismatchError();if(i.maxAge||i.maxAge===0){if(b=f.claims.auth_time,!b)throw U.createAuthTimeNotFoundError();fr.checkMaxAge(b,i.maxAge)}}this.homeAccountIdentifier=Nt.generateHomeAccountId(e.client_info||_.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,f),n&&n.state&&(C=to.parseRequestState(this.cryptoObj,n.state)),e.key_id=e.key_id||i.sshKid||void 0,S=this.generateCacheRecord(e,t,o,i,f,s,n),ie.label=1;case 1:return ie.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),R=new py(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(R)]):[3,3];case 2:ie.sent(),ie.label=3;case 3:return a&&!u&&S.account&&(N=S.account.generateAccountKey(),ye=this.cacheStorage.getAccount(N),!ye)?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,r.generateAuthenticationResult(this.cryptoObj,t,S,!1,i,f,C,void 0,h)]):[4,this.cacheStorage.saveCacheRecord(S)];case 4:return ie.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&R?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(R)]):[3,7];case 6:ie.sent(),ie.label=7;case 7:return[7];case 8:return[2,r.generateAuthenticationResult(this.cryptoObj,t,S,!1,i,f,C,e,h)]}})})},r.prototype.generateCacheRecord=function(e,t,o,i,n,s,a){var u=t.getPreferredCache();if(z.isEmpty(u))throw U.createInvalidCacheEnvironmentError();var h,p;!z.isEmpty(e.id_token)&&n&&(h=vi.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||_.EMPTY_STRING,this.clientId,n.claims.tid||_.EMPTY_STRING),p=this.generateAccountEntity(e,n,t,a));var f=null;if(!z.isEmpty(e.access_token)){var b=e.scope?It.fromString(e.scope):new It(i.scopes||[]),C=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,S=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,R=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,N=o+C,ye=N+S,ie=R&&R>0?o+R:void 0;f=yi.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||_.EMPTY_STRING,this.clientId,n?n.claims.tid||_.EMPTY_STRING:t.tenant,b.printScopes(),N,ye,this.cryptoObj,ie,e.token_type,s,e.key_id,i.claims,i.requestedClaimsHash)}var me=null;z.isEmpty(e.refresh_token)||(me=In.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||_.EMPTY_STRING,this.clientId,e.foci,s));var yt=null;return z.isEmpty(e.foci)||(yt=Pc.createAppMetadataEntity(this.clientId,u,e.foci)),new ps(p,h,f,me,yt)},r.prototype.generateAccountEntity=function(e,t,o,i){var n=o.authorityType,s=i?i.cloud_graph_host_name:_.EMPTY_STRING,a=i?i.msgraph_host:_.EMPTY_STRING;if(n===wr.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Nt.createGenericAccount(this.homeAccountIdentifier,t,o,s,a);if(z.isEmpty(e.client_info)&&o.protocolMode==="AAD")throw U.createClientInfoEmptyError();return e.client_info?Nt.createAccount(e.client_info,this.homeAccountIdentifier,t,o,s,a):Nt.createGenericAccount(this.homeAccountIdentifier,t,o,s,a)},r.generateAuthenticationResult=function(e,t,o,i,n,s,a,u,h){var p,f,b;return le(this,void 0,void 0,function(){var C,S,R,N,ye,ie,me,yt,Ge,tt,_o;return ce(this,function(Tr){switch(Tr.label){case 0:if(C=_.EMPTY_STRING,S=[],R=null,ye=_.EMPTY_STRING,!o.accessToken)return[3,4];if(o.accessToken.tokenType!==Be.POP)return[3,2];if(ie=new ai(e),me=o.accessToken,yt=me.secret,Ge=me.keyId,!Ge)throw U.createKeyIdMissingError();return[4,ie.signPopToken(yt,Ge,n)];case 1:return C=Tr.sent(),[3,3];case 2:C=o.accessToken.secret,Tr.label=3;case 3:S=It.fromString(o.accessToken.target).asArray(),R=new Date(Number(o.accessToken.expiresOn)*1e3),N=new Date(Number(o.accessToken.extendedExpiresOn)*1e3),Tr.label=4;case 4:return o.appMetadata&&(ye=o.appMetadata.familyId===ta?ta:_.EMPTY_STRING),tt=s?.claims.oid||s?.claims.sub||_.EMPTY_STRING,_o=s?.claims.tid||_.EMPTY_STRING,u?.spa_accountid&&o.account&&(o.account.nativeAccountId=u?.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:tt,tenantId:_o,scopes:S,account:o.account?o.account.getAccountInfo():null,idToken:s?s.rawToken:_.EMPTY_STRING,idTokenClaims:s?s.claims:{},accessToken:C,fromCache:i,expiresOn:R,correlationId:n.correlationId,requestId:h||_.EMPTY_STRING,extExpiresOn:N,familyId:ye,tokenType:((p=o.accessToken)===null||p===void 0?void 0:p.tokenType)||_.EMPTY_STRING,state:a?a.userRequestState:_.EMPTY_STRING,cloudGraphHostName:((f=o.account)===null||f===void 0?void 0:f.cloudGraphHostName)||_.EMPTY_STRING,msGraphHost:((b=o.account)===null||b===void 0?void 0:b.msGraphHost)||_.EMPTY_STRING,code:u?.spa_code,fromNativeBroker:!1}]}})})},r}();var Tu=function(r){nt(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.includeRedirectUri=!0,i}return e.prototype.getAuthCodeUrl=function(t){var o,i;return le(this,void 0,void 0,function(){var n;return ce(this,function(s){switch(s.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.GetAuthCodeUrl,t.correlationId),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.AuthClientCreateQueryString,t.correlationId),[4,this.createAuthCodeUrlQueryString(t)];case 1:return n=s.sent(),[2,Se.appendQueryString(this.authority.authorizationEndpoint,n)]}})})},e.prototype.acquireToken=function(t,o){var i,n,s,a,u,h;return le(this,void 0,void 0,function(){var p,f,b,C,S,R,N=this;return ce(this,function(ye){switch(ye.label){case 0:if(!t||!t.code)throw U.createTokenRequestCannotBeMadeError();return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement($.AuthClientAcquireToken,t.correlationId),p=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement("AuthCodeClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in auth-code client"),f=st.nowSeconds(),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.AuthClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(this.authority,t)];case 1:return b=ye.sent(),C=(a=b.headers)===null||a===void 0?void 0:a[Dt.X_MS_REQUEST_ID],S=(u=b.headers)===null||u===void 0?void 0:u[Dt.X_MS_HTTP_VERSION],S&&p?.addStaticFields({httpVerAuthority:S}),R=new ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient),R.validateTokenResponse(b.body),(h=this.performanceClient)===null||h===void 0||h.setPreQueueTime($.HandleServerTokenResponse,t.correlationId),[2,R.handleServerTokenResponse(b.body,this.authority,f,t,o,void 0,void 0,void 0,C).then(function(ie){return p?.endMeasurement({success:!0}),ie}).catch(function(ie){throw N.logger.verbose("Error in fetching token in ACC",t.correlationId),p?.endMeasurement({errorCode:ie.errorCode,subErrorCode:ie.subError,success:!1}),ie})]}})})},e.prototype.handleFragmentResponse=function(t,o){var i=new ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new Se(t),s=Se.getDeserializedHash(n.getHash());if(i.validateServerAuthorizationCodeResponse(s,o,this.cryptoUtils),!s.code)throw U.createNoAuthCodeInServerResponseError();return rt(rt({},s),{code:s.code})},e.prototype.getLogoutUri=function(t){if(!t)throw je.createEmptyLogoutRequestError();var o=this.createLogoutUrlQueryString(t);return Se.appendQueryString(this.authority.endSessionEndpoint,o)},e.prototype.executeTokenRequest=function(t,o){var i,n;return le(this,void 0,void 0,function(){var s,a,u,h,p,f,b;return ce(this,function(C){switch(C.label){case 0:return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement($.AuthClientExecuteTokenRequest,o.correlationId),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.AuthClientCreateTokenRequestBody,o.correlationId),s=this.createTokenQueryParameters(o),a=Se.appendQueryString(t.tokenEndpoint,s),[4,this.createTokenRequestBody(o)];case 1:if(u=C.sent(),h=void 0,o.clientInfo)try{p=oa(o.clientInfo,this.cryptoUtils),h={credential:""+p.uid+Lt.CLIENT_INFO_SEPARATOR+p.utid,type:Cr.HOME_ACCOUNT_ID}}catch(S){this.logger.verbose("Could not parse client info for CCS Header: "+S)}return f=this.createTokenRequestHeaders(h||o.ccsCredential),b={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},[2,this.executePostToTokenEndpoint(a,u,f,b)]}})})},e.prototype.createTokenRequestBody=function(t){var o,i;return le(this,void 0,void 0,function(){var n,s,a,u,h,p,f,f,b;return ce(this,function(C){switch(C.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.AuthClientCreateTokenRequestBody,t.correlationId),n=new Nr,n.addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(t.redirectUri):hs.validateRedirectUri(t.redirectUri),n.addScopes(t.scopes),n.addAuthorizationCode(t.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&n.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(s=this.config.clientCredentials.clientAssertion,n.addClientAssertion(s.assertion),n.addClientAssertionType(s.assertionType)),n.addGrantType(Uo.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),t.authenticationScheme!==Be.POP?[3,2]:(a=new ai(this.cryptoUtils,this.performanceClient),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.PopTokenGenerateCnf,t.correlationId),[4,a.generateCnf(t)]);case 1:return u=C.sent(),n.addPopToken(u.reqCnfString),[3,3];case 2:if(t.authenticationScheme===Be.SSH)if(t.sshJwk)n.addSshJwk(t.sshJwk);else throw je.createMissingSshJwkError();C.label=3;case 3:if(h=t.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(h),(!z.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(t.claims,this.config.authOptions.clientCapabilities),p=void 0,t.clientInfo)try{f=oa(t.clientInfo,this.cryptoUtils),p={credential:""+f.uid+Lt.CLIENT_INFO_SEPARATOR+f.utid,type:Cr.HOME_ACCOUNT_ID}}catch(S){this.logger.verbose("Could not parse client info for CCS Header: "+S)}else p=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&p)switch(p.type){case Cr.HOME_ACCOUNT_ID:try{f=En(p.credential),n.addCcsOid(f)}catch(S){this.logger.verbose("Could not parse home account ID for CCS Header: "+S)}break;case Cr.UPN:n.addCcsUpn(p.credential);break}return t.tokenBodyParameters&&n.addExtraQueryParameters(t.tokenBodyParameters),t.enableSpaAuthorizationCode&&(!t.tokenBodyParameters||!t.tokenBodyParameters[Ne.RETURN_SPA_CODE])&&n.addExtraQueryParameters((b={},b[Ne.RETURN_SPA_CODE]="1",b)),[2,n.createQueryString()]}})})},e.prototype.createAuthCodeUrlQueryString=function(t){var o;return le(this,void 0,void 0,function(){var i,n,s,a,u,h,h,h,p,f;return ce(this,function(b){switch(b.label){case 0:if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.AuthClientCreateQueryString,t.correlationId),i=new Nr,i.addClientId(this.config.authOptions.clientId),n=Xs(t.scopes||[],t.extraScopesToConsent||[]),i.addScopes(n),i.addRedirectUri(t.redirectUri),s=t.correlationId||this.config.cryptoInterface.createNewGuid(),i.addCorrelationId(s),i.addResponseMode(t.responseMode),i.addResponseTypeCode(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&i.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&i.addPrompt(t.prompt),t.domainHint&&i.addDomainHint(t.domainHint),t.prompt!==or.SELECT_ACCOUNT)if(t.sid&&t.prompt===or.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),i.addSid(t.sid);else if(t.account){if(a=this.extractAccountSid(t.account),u=this.extractLoginHint(t.account),u){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),i.addLoginHint(u);try{h=En(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&t.prompt===or.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),i.addSid(a);try{h=En(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),i.addLoginHint(t.loginHint),i.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),i.addLoginHint(t.account.username);try{h=En(t.account.homeAccountId),i.addCcsOid(h)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),i.addLoginHint(t.loginHint),i.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&i.addNonce(t.nonce),t.state&&i.addState(t.state),(!z.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&i.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(i.addNativeBroker(),t.authenticationScheme!==Be.POP?[3,2]:(p=new ai(this.cryptoUtils),[4,p.generateCnf(t)])):[3,2];case 1:f=b.sent(),i.addPopToken(f.reqCnfString),b.label=2;case 2:return[2,i.createQueryString()]}})})},e.prototype.createLogoutUrlQueryString=function(t){var o=new Nr;return t.postLogoutRedirectUri&&o.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&o.addCorrelationId(t.correlationId),t.idTokenHint&&o.addIdTokenHint(t.idTokenHint),t.state&&o.addState(t.state),t.logoutHint&&o.addLogoutHint(t.logoutHint),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),o.createQueryString()},e.prototype.extractAccountSid=function(t){var o;return((o=t.idTokenClaims)===null||o===void 0?void 0:o.sid)||null},e.prototype.extractLoginHint=function(t){var o;return((o=t.idTokenClaims)===null||o===void 0?void 0:o.login_hint)||null},e}(Bo);l();c();d();var v9=function(r){nt(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){return le(this,void 0,void 0,function(){var o,i,n,s;return ce(this,function(a){switch(a.label){case 0:return[4,this.getDeviceCode(t)];case 1:return o=a.sent(),t.deviceCodeCallback(o),i=st.nowSeconds(),[4,this.acquireTokenWithDeviceCode(t,o)];case 2:return n=a.sent(),s=new ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),s.validateTokenResponse(n),[4,s.handleServerTokenResponse(n,this.authority,i,t)];case 3:return[2,a.sent()]}})})},e.prototype.getDeviceCode=function(t){return le(this,void 0,void 0,function(){var o,i,n,s,a;return ce(this,function(u){return o=this.createExtraQueryParameters(t),i=Se.appendQueryString(this.authority.deviceCodeEndpoint,o),n=this.createQueryString(t),s=this.createTokenRequestHeaders(),a={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostRequestToDeviceCodeEndpoint(i,n,s,a)]})})},e.prototype.createExtraQueryParameters=function(t){var o=new Nr;return t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),o.createQueryString()},e.prototype.executePostRequestToDeviceCodeEndpoint=function(t,o,i,n){return le(this,void 0,void 0,function(){var s,a,u,h,p,f,b;return ce(this,function(C){switch(C.label){case 0:return[4,this.networkManager.sendPostRequest(n,t,{body:o,headers:i})];case 1:return s=C.sent().body,a=s.user_code,u=s.device_code,h=s.verification_uri,p=s.expires_in,f=s.interval,b=s.message,[2,{userCode:a,deviceCode:u,verificationUri:h,expiresIn:p,interval:f,message:b}]}})})},e.prototype.createQueryString=function(t){var o=new Nr;return o.addScopes(t.scopes),o.addClientId(this.config.authOptions.clientId),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),(!z.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e.prototype.continuePolling=function(t,o,i){if(i)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),U.createDeviceCodeCancelledError();if(o&&o<t&&st.nowSeconds()>o)throw this.logger.error("User defined timeout for device code polling reached. The timeout was set for "+o),U.createUserTimeoutReachedError();if(st.nowSeconds()>t)throw o&&this.logger.verbose("User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for "+o),this.logger.error("Device code expired. Expiration time of device code was "+t),U.createDeviceCodeExpiredError();return!0},e.prototype.acquireTokenWithDeviceCode=function(t,o){return le(this,void 0,void 0,function(){var i,n,s,a,u,h,p,f,b;return ce(this,function(C){switch(C.label){case 0:i=this.createTokenQueryParameters(t),n=Se.appendQueryString(this.authority.tokenEndpoint,i),s=this.createTokenRequestBody(t,o),a=this.createTokenRequestHeaders(),u=t.timeout?st.nowSeconds()+t.timeout:void 0,h=st.nowSeconds()+o.expiresIn,p=o.interval*1e3,C.label=1;case 1:return this.continuePolling(h,u,t.cancel)?(f={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[4,this.executePostToTokenEndpoint(n,s,a,f)]):[3,8];case 2:return b=C.sent(),b.body&&b.body.error?b.body.error!==_.AUTHORIZATION_PENDING?[3,4]:(this.logger.info("Authorization pending. Continue polling."),[4,st.delay(p)]):[3,6];case 3:return C.sent(),[3,5];case 4:throw this.logger.info("Unexpected error in polling from the server"),eo.createPostRequestFailed(b.body.error);case 5:return[3,7];case 6:return this.logger.verbose("Authorization completed successfully. Polling stopped."),[2,b.body];case 7:return[3,1];case 8:throw this.logger.error("Polling stopped for unknown reasons."),U.createDeviceCodeUnknownError()}})})},e.prototype.createTokenRequestBody=function(t,o){var i=new Nr;i.addScopes(t.scopes),i.addClientId(this.config.authOptions.clientId),i.addGrantType(Uo.DEVICE_CODE_GRANT),i.addDeviceCode(o.deviceCode);var n=t.correlationId||this.config.cryptoInterface.createNewGuid();return i.addCorrelationId(n),i.addClientInfo(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addThrottling(),this.serverTelemetryManager&&i.addServerTelemetry(this.serverTelemetryManager),(!z.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(t.claims,this.config.authOptions.clientCapabilities),i.createQueryString()},e}(Bo);l();c();d();var Eu=function(r){nt(e,r);function e(t,o){return r.call(this,t,o)||this}return e.prototype.acquireToken=function(t){var o,i,n,s,a,u,h;return le(this,void 0,void 0,function(){var p,f,b,C,S,R,N=this;return ce(this,function(ye){switch(ye.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RefreshTokenClientAcquireToken,t.correlationId),p=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement($.RefreshTokenClientAcquireToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",t.correlationId),f=st.nowSeconds(),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.RefreshTokenClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(t,this.authority)];case 1:return b=ye.sent(),C=(s=b.headers)===null||s===void 0?void 0:s[Dt.X_MS_HTTP_VERSION],p?.addStaticFields({refreshTokenSize:((a=b.body.refresh_token)===null||a===void 0?void 0:a.length)||0}),C&&p?.addStaticFields({httpVerToken:C}),S=(u=b.headers)===null||u===void 0?void 0:u[Dt.X_MS_REQUEST_ID],R=new ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),R.validateTokenResponse(b.body),(h=this.performanceClient)===null||h===void 0||h.setPreQueueTime($.HandleServerTokenResponse,t.correlationId),[2,R.handleServerTokenResponse(b.body,this.authority,f,t,void 0,void 0,!0,t.forceCache,S).then(function(ie){return p?.endMeasurement({success:!0}),ie}).catch(function(ie){throw N.logger.verbose("Error in fetching refresh token",t.correlationId),p?.endMeasurement({errorCode:ie.errorCode,subErrorCode:ie.subError,success:!1}),ie})]}})})},e.prototype.acquireTokenByRefreshToken=function(t){var o,i,n,s;return le(this,void 0,void 0,function(){var a,u,h;return ce(this,function(p){if(!t)throw je.createEmptyTokenRequestError();if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),!t.account)throw U.createNoAccountInSilentRequestError();if(a=this.cacheManager.isAppMetadataFOCI(t.account.environment),a)try{return(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(f){if(u=f instanceof xr&&f.errorCode===An.noTokensFoundError.code,h=f instanceof eo&&f.errorCode===Tf.INVALID_GRANT_ERROR&&f.subError===Tf.CLIENT_MISMATCH_ERROR,u||h)return(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw f}return(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)]})})},e.prototype.acquireTokenWithCachedRefreshToken=function(t,o){var i,n,s;return le(this,void 0,void 0,function(){var a,u,h;return ce(this,function(p){if((i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),a=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement($.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",t.correlationId),u=this.cacheManager.getRefreshToken(t.account,o),!u)throw a?.discardMeasurement(),xr.createNoTokensFoundError();return a?.endMeasurement({success:!0}),h=rt(rt({},t),{refreshToken:u.secret,authenticationScheme:t.authenticationScheme||Be.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:Cr.HOME_ACCOUNT_ID}}),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.RefreshTokenClientAcquireToken,t.correlationId),[2,this.acquireToken(h)]})})},e.prototype.executeTokenRequest=function(t,o){var i,n,s;return le(this,void 0,void 0,function(){var a,u,h,p,f,b;return ce(this,function(C){switch(C.label){case 0:return(i=this.performanceClient)===null||i===void 0||i.addQueueMeasurement($.RefreshTokenClientExecuteTokenRequest,t.correlationId),a=(n=this.performanceClient)===null||n===void 0?void 0:n.startMeasurement($.RefreshTokenClientExecuteTokenRequest,t.correlationId),(s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.RefreshTokenClientCreateTokenRequestBody,t.correlationId),u=this.createTokenQueryParameters(t),h=Se.appendQueryString(o.tokenEndpoint,u),[4,this.createTokenRequestBody(t)];case 1:return p=C.sent(),f=this.createTokenRequestHeaders(t.ccsCredential),b={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(h,p,f,b).then(function(S){return a?.endMeasurement({success:!0}),S}).catch(function(S){throw a?.endMeasurement({success:!1}),S})]}})})},e.prototype.createTokenRequestBody=function(t){var o,i,n;return le(this,void 0,void 0,function(){var s,a,u,h,p,f,b;return ce(this,function(C){switch(C.label){case 0:return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RefreshTokenClientCreateTokenRequestBody,t.correlationId),s=t.correlationId,a=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement($.BaseClientCreateTokenRequestHeaders,s),u=new Nr,u.addClientId(this.config.authOptions.clientId),u.addScopes(t.scopes),u.addGrantType(Uo.REFRESH_TOKEN_GRANT),u.addClientInfo(),u.addLibraryInfo(this.config.libraryInfo),u.addApplicationTelemetry(this.config.telemetry.application),u.addThrottling(),this.serverTelemetryManager&&u.addServerTelemetry(this.serverTelemetryManager),u.addCorrelationId(s),u.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&u.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(h=this.config.clientCredentials.clientAssertion,u.addClientAssertion(h.assertion),u.addClientAssertionType(h.assertionType)),t.authenticationScheme!==Be.POP?[3,2]:(p=new ai(this.cryptoUtils,this.performanceClient),(n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.PopTokenGenerateCnf,t.correlationId),[4,p.generateCnf(t)]);case 1:return f=C.sent(),u.addPopToken(f.reqCnfString),[3,3];case 2:if(t.authenticationScheme===Be.SSH)if(t.sshJwk)u.addSshJwk(t.sshJwk);else throw a?.endMeasurement({success:!1}),je.createMissingSshJwkError();C.label=3;case 3:if((!z.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&u.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case Cr.HOME_ACCOUNT_ID:try{b=En(t.ccsCredential.credential),u.addCcsOid(b)}catch(S){this.logger.verbose("Could not parse home account ID for CCS Header: "+S)}break;case Cr.UPN:u.addCcsUpn(t.ccsCredential.credential);break}return a?.endMeasurement({success:!0}),[2,u.createQueryString()]}})})},e}(Bo);l();c();d();var y9=function(r){nt(e,r);function e(t,o){var i=r.call(this,t)||this;return i.appTokenProvider=o,i}return e.prototype.acquireToken=function(t){return le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return this.scopeSet=new It(t.scopes||[]),t.skipCache?[4,this.executeTokenRequest(t,this.authority)]:[3,2];case 1:return[2,i.sent()];case 2:return[4,this.getCachedAuthenticationResult(t)];case 3:return o=i.sent(),o?[2,o]:[3,4];case 4:return[4,this.executeTokenRequest(t,this.authority)];case 5:return[2,i.sent()]}})})},e.prototype.getCachedAuthenticationResult=function(t){var o,i;return le(this,void 0,void 0,function(){var n;return ce(this,function(s){switch(s.label){case 0:return n=this.readAccessTokenFromCache(),n?st.isTokenExpired(n.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?((i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(vo.CACHED_ACCESS_TOKEN_EXPIRED),[2,null]):[4,ro.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:null,idToken:null,accessToken:n,refreshToken:null,appMetadata:null},!0,t)]:((o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(vo.NO_CACHED_ACCESS_TOKEN),[2,null]);case 1:return[2,s.sent()]}})})},e.prototype.readAccessTokenFromCache=function(){var t={homeAccountId:_.EMPTY_STRING,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ue.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:It.createSearchScopes(this.scopeSet.asArray())},o=this.cacheManager.getAccessTokensByFilter(t);if(o.length<1)return null;if(o.length>1)throw U.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.executeTokenRequest=function(t,o){return le(this,void 0,void 0,function(){var i,n,s,a,u,h,p,f,b,C,S,R;return ce(this,function(N){switch(N.label){case 0:return this.appTokenProvider?(this.logger.info("Using appTokenProvider extensibility."),s={correlationId:t.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:t.scopes,claims:t.claims},n=st.nowSeconds(),[4,this.appTokenProvider(s)]):[3,2];case 1:return a=N.sent(),i={access_token:a.accessToken,expires_in:a.expiresInSeconds,refresh_in:a.refreshInSeconds,token_type:Be.BEARER},[3,4];case 2:return u=this.createTokenQueryParameters(t),h=Se.appendQueryString(o.tokenEndpoint,u),p=this.createTokenRequestBody(t),f=this.createTokenRequestHeaders(),b={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},n=st.nowSeconds(),[4,this.executePostToTokenEndpoint(h,p,f,b)];case 3:C=N.sent(),i=C.body,N.label=4;case 4:return S=new ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),S.validateTokenResponse(i),[4,S.handleServerTokenResponse(i,this.authority,n,t)];case 5:return R=N.sent(),[2,R]}})})},e.prototype.createTokenRequestBody=function(t){var o=new Nr;o.addClientId(this.config.authOptions.clientId),o.addScopes(t.scopes,!1),o.addGrantType(Uo.CLIENT_CREDENTIALS_GRANT),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();o.addCorrelationId(i),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret);var n=t.clientAssertion||this.config.clientCredentials.clientAssertion;return n&&(o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)),(!z.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e}(Bo);l();c();d();var b9=function(r){nt(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){return le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return this.scopeSet=new It(t.scopes||[]),o=this,[4,this.cryptoUtils.hashString(t.oboAssertion)];case 1:return o.userAssertionHash=i.sent(),t.skipCache?[4,this.executeTokenRequest(t,this.authority,this.userAssertionHash)]:[3,3];case 2:return[2,i.sent()];case 3:return i.trys.push([3,5,,7]),[4,this.getCachedAuthenticationResult(t)];case 4:return[2,i.sent()];case 5:return i.sent(),[4,this.executeTokenRequest(t,this.authority,this.userAssertionHash)];case 6:return[2,i.sent()];case 7:return[2]}})})},e.prototype.getCachedAuthenticationResult=function(t){var o,i;return le(this,void 0,void 0,function(){var n,s,a,u,h,p;return ce(this,function(f){switch(f.label){case 0:if(n=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,t),n){if(st.isTokenExpired(n.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(vo.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),U.createRefreshRequiredError()}else throw(o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(vo.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),U.createRefreshRequiredError();return s=this.readIdTokenFromCacheForOBO(n.homeAccountId),u=null,s&&(a=new fr(s.secret,this.config.cryptoInterface),h=a.claims.oid?a.claims.oid:a.claims.sub,p={homeAccountId:s.homeAccountId,environment:s.environment,tenantId:s.realm,username:_.EMPTY_STRING,localAccountId:h||_.EMPTY_STRING},u=this.cacheManager.readAccountFromCache(p)),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,ro.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:u,accessToken:n,idToken:s,refreshToken:null,appMetadata:null},!0,t,a)];case 1:return[2,f.sent()]}})})},e.prototype.readIdTokenFromCacheForOBO=function(t){var o={homeAccountId:t,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:ue.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},i=this.cacheManager.getIdTokensByFilter(o);return i.length<1?null:i[0]},e.prototype.readAccessTokenFromCacheForOBO=function(t,o){var i=o.authenticationScheme||Be.BEARER,n=i&&i.toLowerCase()!==Be.BEARER.toLowerCase()?ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:ue.ACCESS_TOKEN,s={credentialType:n,clientId:t,target:It.createSearchScopes(this.scopeSet.asArray()),tokenType:i,keyId:o.sshKid,requestedClaimsHash:o.requestedClaimsHash,userAssertionHash:this.userAssertionHash},a=this.cacheManager.getAccessTokensByFilter(s),u=a.length;if(u<1)return null;if(u>1)throw U.createMultipleMatchingTokensInCacheError();return a[0]},e.prototype.executeTokenRequest=function(t,o,i){return le(this,void 0,void 0,function(){var n,s,a,u,h,p,f,b,C;return ce(this,function(S){switch(S.label){case 0:return n=this.createTokenQueryParameters(t),s=Se.appendQueryString(o.tokenEndpoint,n),a=this.createTokenRequestBody(t),u=this.createTokenRequestHeaders(),h={clientId:this.config.authOptions.clientId,authority:t.authority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},p=st.nowSeconds(),[4,this.executePostToTokenEndpoint(s,a,u,h)];case 1:return f=S.sent(),b=new ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),b.validateTokenResponse(f.body),[4,b.handleServerTokenResponse(f.body,this.authority,p,t,void 0,i)];case 2:return C=S.sent(),[2,C]}})})},e.prototype.createTokenRequestBody=function(t){var o=new Nr;o.addClientId(this.config.authOptions.clientId),o.addScopes(t.scopes),o.addGrantType(Uo.JWT_BEARER),o.addClientInfo(),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();if(o.addCorrelationId(i),o.addRequestTokenUse(Ne.ON_BEHALF_OF),o.addOboAssertion(t.oboAssertion),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)}return(t.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),o.createQueryString()},e}(Bo);l();c();d();var fy=function(r){nt(e,r);function e(t,o){return r.call(this,t,o)||this}return e.prototype.acquireToken=function(t){return le(this,void 0,void 0,function(){var o,i;return ce(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,n.sent()];case 2:if(o=n.sent(),o instanceof U&&o.errorCode===K.tokenRefreshRequired.code)return i=new Eu(this.config,this.performanceClient),[2,i.acquireTokenByRefreshToken(t)];throw o;case 3:return[2]}})})},e.prototype.acquireCachedToken=function(t){var o,i,n,s,a;return le(this,void 0,void 0,function(){var u,h;return ce(this,function(p){switch(p.label){case 0:if(!t)throw je.createEmptyTokenRequestError();if(t.forceRefresh)throw(o=this.serverTelemetryManager)===null||o===void 0||o.setCacheOutcome(vo.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),U.createRefreshRequiredError();if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!z.isEmptyObj(t.claims))throw(i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome(vo.CLAIMS_REQUESTED_CACHE_SKIPPED),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),U.createRefreshRequiredError();if(!t.account)throw U.createNoAccountInSilentRequestError();if(u=t.authority||this.authority.getPreferredCache(),h=this.cacheManager.readCacheRecord(t.account,t,u),h.accessToken){if(st.wasClockTurnedBack(h.accessToken.cachedAt)||st.isTokenExpired(h.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(s=this.serverTelemetryManager)===null||s===void 0||s.setCacheOutcome(vo.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),U.createRefreshRequiredError();if(h.accessToken.refreshOn&&st.isTokenExpired(h.accessToken.refreshOn,0))throw(a=this.serverTelemetryManager)===null||a===void 0||a.setCacheOutcome(vo.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),U.createRefreshRequiredError()}else throw(n=this.serverTelemetryManager)===null||n===void 0||n.setCacheOutcome(vo.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),U.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(h,t)];case 1:return[2,p.sent()]}})})},e.prototype.generateResultFromCacheRecord=function(t,o){return le(this,void 0,void 0,function(){var i,n;return ce(this,function(s){switch(s.label){case 0:if(t.idToken&&(i=new fr(t.idToken.secret,this.config.cryptoInterface)),o.maxAge||o.maxAge===0){if(n=i?.claims.auth_time,!n)throw U.createAuthTimeNotFoundError();fr.checkMaxAge(n,o.maxAge)}return[4,ro.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,o,i)];case 1:return[2,s.sent()]}})})},e}(Bo);l();c();d();var w9=function(r){nt(e,r);function e(t){return r.call(this,t)||this}return e.prototype.acquireToken=function(t){var o,i;return le(this,void 0,void 0,function(){var n,s,a,u,h,p;return ce(this,function(f){switch(f.label){case 0:return n=(o=this.performanceClient)===null||o===void 0?void 0:o.startMeasurement("UsernamePasswordClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in username-password client"),s=st.nowSeconds(),[4,this.executeTokenRequest(this.authority,t)];case 1:return a=f.sent(),u=(i=a.headers)===null||i===void 0?void 0:i[Dt.X_MS_HTTP_VERSION],n?.addStaticFields({httpVerToken:u}),h=new ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),h.validateTokenResponse(a.body),p=h.handleServerTokenResponse(a.body,this.authority,s,t),[2,p]}})})},e.prototype.executeTokenRequest=function(t,o){return le(this,void 0,void 0,function(){var i,n,s,a,u;return ce(this,function(h){return i=this.createTokenQueryParameters(o),n=Se.appendQueryString(t.tokenEndpoint,i),s=this.createTokenRequestBody(o),a=this.createTokenRequestHeaders({credential:o.username,type:Cr.UPN}),u={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},[2,this.executePostToTokenEndpoint(n,s,a,u)]})})},e.prototype.createTokenRequestBody=function(t){var o=new Nr;o.addClientId(this.config.authOptions.clientId),o.addUsername(t.username),o.addPassword(t.password),o.addScopes(t.scopes),o.addResponseTypeForTokenAndIdToken(),o.addGrantType(Uo.RESOURCE_OWNER_PASSWORD_GRANT),o.addClientInfo(),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager);var i=t.correlationId||this.config.cryptoInterface.createNewGuid();if(o.addCorrelationId(i),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;o.addClientAssertion(n.assertion),o.addClientAssertionType(n.assertionType)}return(!z.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.username&&o.addCcsUpn(t.username),o.createQueryString()},e}(Bo);l();c();d();l();c();d();function k_(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}l();c();d();var S_={endpointMetadata:{"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},instanceDiscoveryMetadata:{"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}}},my=S_.endpointMetadata,gy=S_.instanceDiscoveryMetadata;l();c();d();var fs;(function(r){r.AAD="AAD",r.OIDC="OIDC"})(fs||(fs={}));l();c();d();var $c=function(){function r(){this.expiresAt=st.nowSeconds()+vl.REFRESH_TIME_SECONDS}return r.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},r.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},r.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},r.prototype.resetExpiresAt=function(){this.expiresAt=st.nowSeconds()+vl.REFRESH_TIME_SECONDS},r.prototype.isExpired=function(){return this.expiresAt<=st.nowSeconds()},r.isAuthorityMetadataEntity=function(e,t){return t?e.indexOf(vl.CACHE_KEY)===0&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"):!1},r}();l();c();d();function __(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}l();c();d();function T_(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}l();c();d();var E_=function(){function r(e,t,o){this.networkInterface=e,this.performanceClient=t,this.correlationId=o}return r.prototype.detectRegion=function(e,t){var o,i,n,s;return le(this,void 0,void 0,function(){var a,u,h,p,f;return ce(this,function(b){switch(b.label){case 0:if((o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RegionDiscoveryDetectRegion,this.correlationId),a=e,a)return[3,8];u=r.IMDS_OPTIONS,b.label=1;case 1:return b.trys.push([1,6,,7]),(i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(_.IMDS_VERSION,u)];case 2:return h=b.sent(),h.status===gl.httpSuccess&&(a=h.body,t.region_source=ds.IMDS),h.status!==gl.httpBadRequest?[3,5]:((n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(u)]);case 3:return p=b.sent(),p?((s=this.performanceClient)===null||s===void 0||s.setPreQueueTime($.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(p,u)]):(t.region_source=ds.FAILED_AUTO_DETECTION,[2,null]);case 4:f=b.sent(),f.status===gl.httpSuccess&&(a=f.body,t.region_source=ds.IMDS),b.label=5;case 5:return[3,7];case 6:return b.sent(),t.region_source=ds.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=ds.ENVIRONMENT_VARIABLE,b.label=9;case 9:return a||(t.region_source=ds.FAILED_AUTO_DETECTION),[2,a||null]}})})},r.prototype.getRegionFromIMDS=function(e,t){var o;return le(this,void 0,void 0,function(){return ce(this,function(i){return(o=this.performanceClient)===null||o===void 0||o.addQueueMeasurement($.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(_.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,_.IMDS_TIMEOUT)]})})},r.prototype.getCurrentVersion=function(e){var t;return le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.RegionDiscoveryGetCurrentVersion,this.correlationId),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(_.IMDS_ENDPOINT+"?format=json",e)];case 2:return o=i.sent(),o.status===gl.httpBadRequest&&o.body&&o.body["newest-versions"]&&o.body["newest-versions"].length>0?[2,o.body["newest-versions"][0]]:[2,null];case 3:return i.sent(),[2,null];case 4:return[2]}})})},r.IMDS_OPTIONS={headers:{Metadata:"true"}},r}();var ms=function(){function r(e,t,o,i,n,s,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=o,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=n,this.performanceClient=s,this.correlationId=a,this.regionDiscovery=new E_(t,this.performanceClient,this.correlationId)}return r.prototype.getAuthorityType=function(e){if(e.HostNameAndPort.endsWith(_.CIAM_AUTH_URL))return wr.Ciam;var t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case _.ADFS:return wr.Adfs;case _.DSTS:return wr.Dsts}return wr.Default},Object.defineProperty(r.prototype,"authorityType",{get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Se(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw U.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw U.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw U.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw U.createLogoutNotSupportedError();return this.replacePath(this.metadata.end_session_endpoint)}else throw U.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw U.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"jwksUri",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw U.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),r.prototype.canReplaceTenant=function(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===wr.Default&&this.protocolMode===fs.AAD},r.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},r.prototype.replacePath=function(e){var t=this,o=e,i=new Se(this.metadata.canonical_authority),n=i.getUrlComponents(),s=n.PathSegments,a=this.canonicalAuthorityUrlComponents.PathSegments;return a.forEach(function(u,h){var p=s[h];if(h===0&&t.canReplaceTenant(n)){var f=new Se(t.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];p!==f&&(t.logger.verbose("Replacing tenant domain name "+p+" with id "+f),p=f)}u!==p&&(o=o.replace("/"+p+"/","/"+u+"/"))}),this.replaceTenant(o)},Object.defineProperty(r.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===wr.Adfs||this.authorityType===wr.Dsts||this.protocolMode===fs.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),r.prototype.discoveryComplete=function(){return!!this.metadata},r.prototype.resolveEndpointsAsync=function(){var e,t,o;return le(this,void 0,void 0,function(){var i,n,s,a;return ce(this,function(u){switch(u.label){case 0:return(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement($.AuthorityResolveEndpointsAsync,this.correlationId),i=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort),i||(i=new $c,i.updateCanonicalAuthority(this.canonicalAuthority)),(t=this.performanceClient)===null||t===void 0||t.setPreQueueTime($.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(i)];case 1:return n=u.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,i.preferred_network),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime($.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(i)];case 2:return s=u.sent(),n!==si.CACHE&&s!==si.CACHE&&(i.resetExpiresAt(),i.updateCanonicalAuthority(this.canonicalAuthority)),a=this.cacheManager.generateAuthorityMetadataCacheKey(i.preferred_cache),this.cacheManager.setAuthorityMetadata(a,i),this.metadata=i,[2]}})})},r.prototype.updateEndpointMetadata=function(e){var t,o,i,n,s,a;return le(this,void 0,void 0,function(){var u,h;return ce(this,function(p){switch(p.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.AuthorityUpdateEndpointMetadata,this.correlationId),u=this.getEndpointMetadataFromConfig(),u?(e.updateEndpointMetadata(u,!1),[2,si.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,si.CACHE]:((o=this.performanceClient)===null||o===void 0||o.setPreQueueTime($.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return u=p.sent(),u?!((i=this.authorityOptions.azureRegionConfiguration)===null||i===void 0)&&i.azureRegion?((n=this.performanceClient)===null||n===void 0||n.setPreQueueTime($.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(u)]):[3,3]:[3,4];case 2:u=p.sent(),p.label=3;case 3:return e.updateEndpointMetadata(u,!0),[2,si.NETWORK];case 4:return h=this.getEndpointMetadataFromHardcodedValues(),h&&!this.authorityOptions.skipAuthorityMetadataCache?!((s=this.authorityOptions.azureRegionConfiguration)===null||s===void 0)&&s.azureRegion?((a=this.performanceClient)===null||a===void 0||a.setPreQueueTime($.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(h)]):[3,6]:[3,7];case 5:h=p.sent(),p.label=6;case 6:return e.updateEndpointMetadata(h,!1),[2,si.HARDCODED_VALUES];case 7:throw U.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},r.prototype.isAuthoritySameType=function(e){var t=new Se(e.canonical_authority),o=t.getUrlComponents().PathSegments;return o.length===this.canonicalAuthorityUrlComponents.PathSegments.length},r.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw je.createInvalidAuthorityMetadataError()}return null},r.prototype.getEndpointMetadataFromNetwork=function(){var e;return le(this,void 0,void 0,function(){var t,o;return ce(this,function(i){switch(i.label){case 0:(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement($.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return o=i.sent(),[2,k_(o.body)?o.body:null];case 3:return i.sent(),[2,null];case 4:return[2]}})})},r.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in my?my[this.canonicalAuthority]:null},r.prototype.updateMetadataWithRegionalInformation=function(e){var t,o,i,n;return le(this,void 0,void 0,function(){var s,a;return ce(this,function(u){switch(u.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),s=(o=this.authorityOptions.azureRegionConfiguration)===null||o===void 0?void 0:o.azureRegion,s?s!==_.AZURE_REGION_AUTO_DISCOVER_FLAG?(this.regionDiscoveryMetadata.region_outcome=Ic.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=s,[2,r.replaceWithRegionalInformation(e,s)]):((i=this.performanceClient)===null||i===void 0||i.setPreQueueTime($.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion((n=this.authorityOptions.azureRegionConfiguration)===null||n===void 0?void 0:n.environmentRegion,this.regionDiscoveryMetadata)]):[3,2];case 1:if(a=u.sent(),a)return this.regionDiscoveryMetadata.region_outcome=Ic.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,[2,r.replaceWithRegionalInformation(e,a)];this.regionDiscoveryMetadata.region_outcome=Ic.AUTO_DETECTION_REQUESTED_FAILED,u.label=2;case 2:return[2,e]}})})},r.prototype.updateCloudDiscoveryMetadata=function(e){var t,o;return le(this,void 0,void 0,function(){var i,n,s;return ce(this,function(a){switch(a.label){case 0:return(t=this.performanceClient)===null||t===void 0||t.addQueueMeasurement($.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||_.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||_.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||_.NOT_APPLICABLE)),i=this.getCloudDiscoveryMetadataFromConfig(),i?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(i,!1),[2,si.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),n=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found metadata in the cache."),[2,si.CACHE]):(n&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),(o=this.performanceClient)===null||o===void 0||o.setPreQueueTime($.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(i=a.sent(),i)return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(i,!0),[2,si.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),s=this.getCloudDiscoveryMetadataFromHarcodedValues(),s&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(s,!1),[2,si.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),je.createUntrustedAuthorityError()}})})},r.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===wr.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=r.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),je.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},r.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var e;return le(this,void 0,void 0,function(){var t,o,i,n,s,a,u,h;return ce(this,function(p){switch(p.label){case 0:(e=this.performanceClient)===null||e===void 0||e.addQueueMeasurement($.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),t=""+_.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",o={},i=null,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t,o)];case 2:if(n=p.sent(),s=void 0,a=void 0,__(n.body))s=n.body,a=s.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+s.tenant_discovery_endpoint);else if(T_(n.body)){if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+n.status),s=n.body,s.error===_.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+s.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+s.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=r.getCloudDiscoveryMetadataFromNetworkResponse(a,this.hostnameAndPort),[3,4];case 3:return u=p.sent(),u instanceof ee?this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: `+u.errorCode+`
Error Description: `+u.errorMessage):(h=u,this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: `+h.name+`
Error Description: `+h.message)),[2,null];case 4:return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,i]}})})},r.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in gy?gy[this.canonicalAuthority]:null},r.prototype.isInKnownAuthorities=function(){var e=this,t=this.authorityOptions.knownAuthorities.filter(function(o){return Se.getDomainFromUrl(o).toLowerCase()===e.hostnameAndPort});return t.length>0},r.generateAuthority=function(e,t){var o;if(t&&t.azureCloudInstance!==Tn.None){var i=t.tenant?t.tenant:_.DEFAULT_COMMON_TENANT;o=t.azureCloudInstance+"/"+i+"/"}return o||e},r.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},r.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var o=0;o<e.length;o++){var i=e[o];if(i.aliases.indexOf(t)>-1)return i}return null},r.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw U.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},r.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},r.isPublicCloudAuthority=function(e){return _.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},r.buildRegionalAuthorityString=function(e,t,o){var i=new Se(e);i.validateAsUri();var n=i.getUrlComponents(),s=t+"."+n.HostNameAndPort;this.isPublicCloudAuthority(n.HostNameAndPort)&&(s=t+"."+_.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var a=Se.constructAuthorityUriFromObject(rt(rt({},i.getUrlComponents()),{HostNameAndPort:s})).urlString;return o?a+"?"+o:a},r.replaceWithRegionalInformation=function(e,t){return e.authorization_endpoint=r.buildRegionalAuthorityString(e.authorization_endpoint,t),e.token_endpoint=r.buildRegionalAuthorityString(e.token_endpoint,t,_.REGIONAL_AUTH_NON_MSI_QUERY_STRING),e.end_session_endpoint&&(e.end_session_endpoint=r.buildRegionalAuthorityString(e.end_session_endpoint,t)),e},r.transformCIAMAuthority=function(e){var t=e.endsWith(_.FORWARD_SLASH)?e:""+e+_.FORWARD_SLASH,o=new Se(e),i=o.getUrlComponents();if(i.PathSegments.length===0&&i.HostNameAndPort.endsWith(_.CIAM_AUTH_URL)){var n=i.HostNameAndPort.split(".")[0];t=""+t+n+_.AAD_TENANT_DOMAIN_SUFFIX}return t},r.reservedTenantDomains=new Set(["{tenant}","{tenantid}",cs.COMMON,cs.CONSUMERS,cs.ORGANIZATIONS]),r}();l();c();d();var na=function(){function r(){}return r.createDiscoveredInstance=function(e,t,o,i,n,s,a){return le(this,void 0,void 0,function(){var u,h,p;return ce(this,function(f){switch(f.label){case 0:s?.addQueueMeasurement($.AuthorityFactoryCreateDiscoveredInstance,a),u=ms.transformCIAMAuthority(e),h=r.createInstance(u,t,o,i,n,s,a),f.label=1;case 1:return f.trys.push([1,3,,4]),s?.setPreQueueTime($.AuthorityResolveEndpointsAsync,a),[4,h.resolveEndpointsAsync()];case 2:return f.sent(),[2,h];case 3:throw p=f.sent(),U.createEndpointDiscoveryIncompleteError(p);case 4:return[2]}})})},r.createInstance=function(e,t,o,i,n,s,a){if(z.isEmpty(e))throw je.createUrlEmptyError();return new ms(e,t,o,i,n,s,a)},r}();l();c();d();var wl=function(){function r(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return r.isServerTelemetryEntity=function(e,t){var o=e.indexOf(Ar.CACHE_KEY)===0,i=!0;return t&&(i=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),o&&i},r}();l();c();d();var Af=function(){function r(){}return r.isThrottlingEntity=function(e,t){var o=!1;e&&(o=e.indexOf(us.THROTTLING_PREFIX)===0);var i=!0;return t&&(i=t.hasOwnProperty("throttleTime")),o&&i},r}();l();c();d();var vy={sendGetRequestAsync:function(){var r="Network interface - sendGetRequestAsync() has not been implemented for the Network interface.";return Promise.reject(ee.createUnexpectedError(r))},sendPostRequestAsync:function(){var r="Network interface - sendPostRequestAsync() has not been implemented for the Network interface.";return Promise.reject(ee.createUnexpectedError(r))}};l();c();d();l();c();d();var Rf={missingKidError:{code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},missingAlgError:{code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."}},yy=function(r){nt(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="JoseHeaderError",Object.setPrototypeOf(i,e.prototype),i}return e.createMissingKidError=function(){return new e(Rf.missingKidError.code,Rf.missingKidError.desc)},e.createMissingAlgError=function(){return new e(Rf.missingAlgError.code,Rf.missingAlgError.desc)},e}(ee);var by=function(){function r(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return r.getShrHeaderString=function(e){if(!e.kid)throw yy.createMissingKidError();if(!e.alg)throw yy.createMissingAlgError();var t=new r({typ:e.typ||Sf.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)},r}();l();c();d();var I_=function(){function r(e){this.headers=e}return r.prototype.getShrNonce=function(){var e=this.headers[Dt.AuthenticationInfo];if(e){var t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw je.createInvalidAuthenticationHeaderError(Dt.AuthenticationInfo,"nextnonce challenge is missing.")}var o=this.headers[Dt.WWWAuthenticate];if(o){var i=this.parseChallenges(o);if(i.nonce)return i.nonce;throw je.createInvalidAuthenticationHeaderError(Dt.WWWAuthenticate,"nonce challenge is missing.")}throw je.createMissingNonceAuthenticationHeadersError()},r.prototype.parseChallenges=function(e){var t=e.indexOf(" "),o=e.substr(t+1).split(","),i={};return o.forEach(function(n){var s=n.split("="),a=s[0],u=s[1];i[a]=unescape(u.replace(/['"]+/g,_.EMPTY_STRING))}),i},r}();l();c();d();var wy=function(){function r(e,t){this.cacheOutcome=vo.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||_.EMPTY_STRING,this.wrapperVer=e.wrapperVer||_.EMPTY_STRING,this.telemetryCacheKey=Ar.CACHE_KEY+Lt.CACHE_KEY_SEPARATOR+e.clientId}return r.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+Ar.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(Ar.VALUE_SEPARATOR),o=this.getRegionDiscoveryFields(),i=[e,o].join(Ar.VALUE_SEPARATOR);return[Ar.SCHEMA_VERSION,i,t].join(Ar.CATEGORY_SEPARATOR)},r.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=r.maxErrorsToSend(e),o=e.failedRequests.slice(0,2*t).join(Ar.VALUE_SEPARATOR),i=e.errors.slice(0,t).join(Ar.VALUE_SEPARATOR),n=e.errors.length,s=t<n?Ar.OVERFLOW_TRUE:Ar.OVERFLOW_FALSE,a=[n,s].join(Ar.VALUE_SEPARATOR);return[Ar.SCHEMA_VERSION,e.cacheHits,o,i,a].join(Ar.CATEGORY_SEPARATOR)},r.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=Ar.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),z.isEmpty(e.subError)?z.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Ar.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},r.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},r.prototype.getLastRequests=function(){var e=new wl,t=this.cacheManager.getServerTelemetry(this.telemetryCacheKey);return t||e},r.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=r.maxErrorsToSend(e),o=e.errors.length;if(t===o)this.cacheManager.removeItem(this.telemetryCacheKey);else{var i=new wl;i.failedRequests=e.failedRequests.slice(t*2),i.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i)}},r.maxErrorsToSend=function(e){var t,o=0,i=0,n=e.errors.length;for(t=0;t<n;t++){var s=e.failedRequests[2*t]||_.EMPTY_STRING,a=e.failedRequests[2*t+1]||_.EMPTY_STRING,u=e.errors[t]||_.EMPTY_STRING;if(i+=s.toString().length+a.toString().length+u.length+3,i<Ar.MAX_LAST_HEADER_BYTES)o+=1;else break}return o},r.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||_.EMPTY_STRING),e.push(this.regionSource||_.EMPTY_STRING),e.push(this.regionOutcome||_.EMPTY_STRING),e.join(",")},r.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},r.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},r}();l();c();d();var Iu=function(){function r(e,t,o,i,n,s){this.authority=t,this.libraryName=i,this.libraryVersion=n,this.applicationTelemetry=s,this.clientId=e,this.logger=o,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return r.prototype.startPerformanceMeasurement=function(e,t){return{}},r.prototype.startPerformanceMeasuremeant=function(e,t){return{}},r.prototype.getIntFields=function(){return uy},r.prototype.getPreQueueTime=function(e,t){var o=this.preQueueTimeByCorrelationId.get(t);if(o){if(o.name!==e){this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement");return}}else{this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement");return}return o.time},r.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},r.prototype.addQueueMeasurement=function(e,t,o,i){if(!t){this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement");return}if(o===0)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+o);else if(!o){this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);return}var n={eventName:e,queueTime:o,manuallyCompleted:i},s=this.queueMeasurements.get(t);if(s)s.push(n),this.queueMeasurements.set(t,s);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var a=[n];this.queueMeasurements.set(t,a)}this.preQueueTimeByCorrelationId.delete(t)},r.prototype.startMeasurement=function(e,t){var o=this,i,n,s=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",s),this.logger.trace("PerformanceClient: Performance measurement started for "+e,s);var a=this.startPerformanceMeasuremeant(e,s);a.startMeasurement();var u={eventId:this.generateId(),status:Rc.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:s,appName:(i=this.applicationTelemetry)===null||i===void 0?void 0:i.appName,appVersion:(n=this.applicationTelemetry)===null||n===void 0?void 0:n.appVersion};return this.cacheEventByCorrelationId(u),{endMeasurement:function(h){return o.endMeasurement(rt(rt({},u),h),a)},discardMeasurement:function(){return o.discardMeasurements(u.correlationId)},addStaticFields:function(h){return o.addStaticFields(h,u.correlationId)},increment:function(h){return o.increment(h,u.correlationId)},measurement:a,event:u}},r.prototype.endMeasurement=function(e,t){var o=this,i,n,s=this.eventsByCorrelationId.get(e.correlationId);if(!s)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var a=e.eventId===s.eventId,u={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};a?(u=this.getQueueInfo(e.correlationId),this.discardCache(s.correlationId)):(i=s.incompleteSubMeasurements)===null||i===void 0||i.delete(e.eventId),t?.endMeasurement();var h=t?.flushMeasurement();if(!h)return this.logger.trace("PerformanceClient: Performance measurement not taken",s.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+h+" ms",e.correlationId),!a)return s[e.name+"DurationMs"]=Math.floor(h),rt({},s);var p=rt(rt({},s),e),f=0;return(n=p.incompleteSubMeasurements)===null||n===void 0||n.forEach(function(b){o.logger.trace("PerformanceClient: Incomplete submeasurement "+b.name+" found for "+e.name,p.correlationId),f++}),p.incompleteSubMeasurements=void 0,p=rt(rt({},p),{durationMs:Math.round(h),queuedTimeMs:u.totalQueueTime,queuedCount:u.totalQueueCount,queuedManuallyCompletedCount:u.manuallyCompletedCount,status:Rc.Completed,incompleteSubsCount:f}),this.truncateIntegralFields(p,this.getIntFields()),this.emitEvents([p],e.correlationId),p},r.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var o=this.eventsByCorrelationId.get(t);o?this.eventsByCorrelationId.set(t,rt(rt({},o),e)):this.logger.trace("PerformanceClient: Event not found for",t)},r.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var o=this.eventsByCorrelationId.get(t);if(o)for(var i in e)o.hasOwnProperty(i)||(o[i]=0),o[i]+=e[i];else this.logger.trace("PerformanceClient: Event not found for",t)},r.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,rt({},e)))},r.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var o=0,i=0,n=0;return t?.forEach(function(s){o+=s.queueTime,i++,n+=s.manuallyCompleted?1:0}),{totalQueueTime:o,totalQueueCount:i,manuallyCompletedCount:n}},r.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},r.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},r.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},r.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},r.prototype.emitEvents=function(e,t){var o=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach(function(i,n){o.logger.trace("PerformanceClient: Emitting event to callback "+n,t),i.apply(null,[e])})},r.prototype.truncateIntegralFields=function(e,t){t.forEach(function(o){o in e&&typeof e[o]=="number"&&(e[o]=Math.floor(e[o]))})},r}();l();c();d();var A_=function(){function r(){}return r.prototype.startMeasurement=function(){},r.prototype.endMeasurement=function(){},r.prototype.flushMeasurement=function(){return null},r}(),Cy=function(r){nt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.generateId=function(){return"callback-id"},e.prototype.startPerformanceMeasuremeant=function(){return new A_},e.prototype.startPerformanceMeasurement=function(){return new A_},e.prototype.calculateQueuedTime=function(t,o){return 0},e.prototype.addQueueMeasurement=function(t,o,i){},e.prototype.setPreQueueTime=function(t,o){},e}(Iu);l();c();d();var q={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},authCodeOrNativeAccountRequired:{code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},spaCodeAndNativeAccountPresent:{code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},unableToAcquireTokenFromNativePlatform:{code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},nativeHandshakeTimeout:{code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},nativeExtensionNotInstalled:{code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},nativeConnectionNotEstablished:{code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},nativeBrokerCalledBeforeInitialize:{code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},nativePromptNotSupported:{code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."}},B=function(r){mt(e,r);function e(t,o){var i=r.call(this,t,o)||this;return Object.setPrototypeOf(i,e.prototype),i.name="BrowserAuthError",i}return e.createPkceNotGeneratedError=function(t){return new e(q.pkceNotGenerated.code,q.pkceNotGenerated.desc+" Detail:"+t)},e.createCryptoNotAvailableError=function(t){return new e(q.cryptoDoesNotExist.code,q.cryptoDoesNotExist.desc+" Detail:"+t)},e.createHttpMethodNotImplementedError=function(t){return new e(q.httpMethodNotImplementedError.code,q.httpMethodNotImplementedError.desc+" Given Method: "+t)},e.createEmptyNavigationUriError=function(){return new e(q.emptyNavigateUriError.code,q.emptyNavigateUriError.desc)},e.createEmptyHashError=function(t){return new e(q.hashEmptyError.code,q.hashEmptyError.desc+" Given Url: "+t)},e.createHashDoesNotContainStateError=function(){return new e(q.hashDoesNotContainStateError.code,q.hashDoesNotContainStateError.desc)},e.createHashDoesNotContainKnownPropertiesError=function(){return new e(q.hashDoesNotContainKnownPropertiesError.code,q.hashDoesNotContainKnownPropertiesError.desc)},e.createUnableToParseStateError=function(){return new e(q.unableToParseStateError.code,q.unableToParseStateError.desc)},e.createStateInteractionTypeMismatchError=function(){return new e(q.stateInteractionTypeMismatchError.code,q.stateInteractionTypeMismatchError.desc)},e.createInteractionInProgressError=function(){return new e(q.interactionInProgress.code,q.interactionInProgress.desc)},e.createPopupWindowError=function(t){var o=q.popupWindowError.desc;return o=z.isEmpty(t)?o:o+" Details: "+t,new e(q.popupWindowError.code,o)},e.createEmptyWindowCreatedError=function(){return new e(q.emptyWindowError.code,q.emptyWindowError.desc)},e.createUserCancelledError=function(){return new e(q.userCancelledError.code,q.userCancelledError.desc)},e.createMonitorPopupTimeoutError=function(){return new e(q.monitorPopupTimeoutError.code,q.monitorPopupTimeoutError.desc)},e.createMonitorIframeTimeoutError=function(){return new e(q.monitorIframeTimeoutError.code,q.monitorIframeTimeoutError.desc)},e.createRedirectInIframeError=function(t){return new e(q.redirectInIframeError.code,q.redirectInIframeError.desc+" (window.parent !== window) => "+t)},e.createBlockReloadInHiddenIframeError=function(){return new e(q.blockTokenRequestsInHiddenIframeError.code,q.blockTokenRequestsInHiddenIframeError.desc)},e.createBlockAcquireTokenInPopupsError=function(){return new e(q.blockAcquireTokenInPopupsError.code,q.blockAcquireTokenInPopupsError.desc)},e.createIframeClosedPrematurelyError=function(){return new e(q.iframeClosedPrematurelyError.code,q.iframeClosedPrematurelyError.desc)},e.createSilentLogoutUnsupportedError=function(){return new e(q.silentLogoutUnsupportedError.code,q.silentLogoutUnsupportedError.desc)},e.createNoAccountError=function(){return new e(q.noAccountError.code,q.noAccountError.desc)},e.createSilentPromptValueError=function(t){return new e(q.silentPromptValueError.code,q.silentPromptValueError.desc+" Given value: "+t)},e.createUnableToParseTokenRequestCacheError=function(){return new e(q.unableToParseTokenRequestCacheError.code,q.unableToParseTokenRequestCacheError.desc)},e.createNoTokenRequestCacheError=function(){return new e(q.noTokenRequestCacheError.code,q.noTokenRequestCacheError.desc)},e.createAuthRequestNotSetError=function(){return new e(q.authRequestNotSet.code,q.authRequestNotSet.desc)},e.createNoCachedAuthorityError=function(){return new e(q.noCachedAuthorityError.code,q.noCachedAuthorityError.desc)},e.createInvalidCacheTypeError=function(){return new e(q.invalidCacheType.code,""+q.invalidCacheType.desc)},e.createNonBrowserEnvironmentError=function(){return new e(q.notInBrowserEnvironment.code,q.notInBrowserEnvironment.desc)},e.createDatabaseNotOpenError=function(){return new e(q.databaseNotOpen.code,q.databaseNotOpen.desc)},e.createNoNetworkConnectivityError=function(){return new e(q.noNetworkConnectivity.code,q.noNetworkConnectivity.desc)},e.createPostRequestFailedError=function(t,o){return new e(q.postRequestFailed.code,q.postRequestFailed.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},e.createGetRequestFailedError=function(t,o){return new e(q.getRequestFailed.code,q.getRequestFailed.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},e.createFailedToParseNetworkResponseError=function(t){return new e(q.failedToParseNetworkResponse.code,q.failedToParseNetworkResponse.desc+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToLoadTokenError=function(t){return new e(q.unableToLoadTokenError.code,q.unableToLoadTokenError.desc+" | "+t)},e.createSigningKeyNotFoundInStorageError=function(t){return new e(q.signingKeyNotFoundInStorage.code,q.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+t)},e.createAuthCodeRequiredError=function(){return new e(q.authCodeRequired.code,q.authCodeRequired.desc)},e.createAuthCodeOrNativeAccountIdRequiredError=function(){return new e(q.authCodeOrNativeAccountRequired.code,q.authCodeOrNativeAccountRequired.desc)},e.createSpaCodeAndNativeAccountIdPresentError=function(){return new e(q.spaCodeAndNativeAccountPresent.code,q.spaCodeAndNativeAccountPresent.desc)},e.createDatabaseUnavailableError=function(){return new e(q.databaseUnavailable.code,q.databaseUnavailable.desc)},e.createUnableToAcquireTokenFromNativePlatformError=function(){return new e(q.unableToAcquireTokenFromNativePlatform.code,q.unableToAcquireTokenFromNativePlatform.desc)},e.createNativeHandshakeTimeoutError=function(){return new e(q.nativeHandshakeTimeout.code,q.nativeHandshakeTimeout.desc)},e.createNativeExtensionNotInstalledError=function(){return new e(q.nativeExtensionNotInstalled.code,q.nativeExtensionNotInstalled.desc)},e.createNativeConnectionNotEstablishedError=function(){return new e(q.nativeConnectionNotEstablished.code,q.nativeConnectionNotEstablished.desc)},e.createNativeBrokerCalledBeforeInitialize=function(){return new e(q.nativeBrokerCalledBeforeInitialize.code,q.nativeBrokerCalledBeforeInitialize.desc)},e.createNativePromptParameterNotSupportedError=function(){return new e(q.nativePromptNotSupported.code,q.nativePromptNotSupported.desc)},e}(ee);l();c();d();var Ur={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},xl={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},Zi;(function(r){r.HandshakeRequest="Handshake",r.HandshakeResponse="HandshakeResponse",r.GetToken="GetToken",r.Response="Response"})(Zi||(Zi={}));var zt;(function(r){r.LocalStorage="localStorage",r.SessionStorage="sessionStorage",r.MemoryStorage="memoryStorage"})(zt||(zt={}));var bi;(function(r){r.GET="GET",r.POST="POST"})(bi||(bi={}));var Ye;(function(r){r.AUTHORITY="authority",r.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",r.SESSION_STATE="session.state",r.REQUEST_STATE="request.state",r.NONCE_IDTOKEN="nonce.id_token",r.ORIGIN_URI="request.origin",r.RENEW_STATUS="token.renew.status",r.URL_HASH="urlHash",r.REQUEST_PARAMS="request.params",r.SCOPES="scopes",r.INTERACTION_STATUS_KEY="interaction.status",r.CCS_CREDENTIAL="ccs.credential",r.CORRELATION_ID="request.correlationId",r.NATIVE_REQUEST="request.native",r.REDIRECT_CONTEXT="request.redirect.context"})(Ye||(Ye={}));var Ji;(function(r){r.ACCOUNT_KEYS="msal.account.keys",r.TOKEN_KEYS="msal.token.keys"})(Ji||(Ji={}));var Cl;(function(r){r.WRAPPER_SKU="wrapper.sku",r.WRAPPER_VER="wrapper.version"})(Cl||(Cl={}));var ct;(function(r){r[r.acquireTokenRedirect=861]="acquireTokenRedirect",r[r.acquireTokenPopup=862]="acquireTokenPopup",r[r.ssoSilent=863]="ssoSilent",r[r.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",r[r.handleRedirectPromise=865]="handleRedirectPromise",r[r.acquireTokenByCode=866]="acquireTokenByCode",r[r.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",r[r.logout=961]="logout",r[r.logoutPopup=962]="logoutPopup"})(ct||(ct={}));var ne;(function(r){r.Redirect="redirect",r.Popup="popup",r.Silent="silent",r.None="none"})(ne||(ne={}));var Hr;(function(r){r.Startup="startup",r.Login="login",r.Logout="logout",r.AcquireToken="acquireToken",r.SsoSilent="ssoSilent",r.HandleRedirect="handleRedirect",r.None="none"})(Hr||(Hr={}));var ky={scopes:Yi},gs="jwk",xy;(function(r){r.React="@azure/msal-react",r.Angular="@azure/msal-angular"})(xy||(xy={}));var Pf="msal.db",R_=1,P_=Pf+".keys",oo;(function(r){r[r.Default=0]="Default",r[r.AccessToken=1]="AccessToken",r[r.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",r[r.RefreshToken=3]="RefreshToken",r[r.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",r[r.Skip=5]="Skip"})(oo||(oo={}));l();c();d();l();c();d();var To={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}},vs=function(r){mt(e,r);function e(t,o){var i=r.call(this,t,o)||this;return i.name="BrowserConfigurationAuthError",Object.setPrototypeOf(i,e.prototype),i}return e.createRedirectUriEmptyError=function(){return new e(To.redirectUriNotSet.code,To.redirectUriNotSet.desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(To.postLogoutUriNotSet.code,To.postLogoutUriNotSet.desc)},e.createStorageNotSupportedError=function(t){return new e(To.storageNotSupportedError.code,To.storageNotSupportedError.desc+" Given Location: "+t)},e.createRedirectCallbacksNotSetError=function(){return new e(To.noRedirectCallbacksSet.code,To.noRedirectCallbacksSet.desc)},e.createStubPcaInstanceCalledError=function(){return new e(To.stubPcaInstanceCalled.code,To.stubPcaInstanceCalled.desc)},e.createInMemoryRedirectUnavailableError=function(){return new e(To.inMemRedirectUnavailable.code,To.inMemRedirectUnavailable.desc)},e.createEntropyNotProvided=function(){return new e(To.entropyNotProvided.code,To.entropyNotProvided.desc)},e}(ee);var Sy=function(){function r(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return r.prototype.validateWindowStorage=function(e){if(e!==zt.LocalStorage&&e!==zt.SessionStorage)throw vs.createStorageNotSupportedError(e);var t=!!window[e];if(!t)throw vs.createStorageNotSupportedError(e)},r.prototype.getItem=function(e){return this.windowStorage.getItem(e)},r.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},r.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},r.prototype.getKeys=function(){return Object.keys(this.windowStorage)},r.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},r}();l();c();d();var Au=function(){function r(){this.cache=new Map}return r.prototype.getItem=function(e){return this.cache.get(e)||null},r.prototype.setItem=function(e,t){this.cache.set(e,t)},r.prototype.removeItem=function(e){this.cache.delete(e)},r.prototype.getKeys=function(){var e=[];return this.cache.forEach(function(t,o){e.push(o)}),e},r.prototype.containsKey=function(e){return this.cache.has(e)},r.prototype.clear=function(){this.cache.clear()},r}();l();c();d();var $f=function(){function r(){}return r.extractBrowserRequestState=function(e,t){if(z.isEmpty(t))return null;try{var o=to.parseRequestState(e,t);return o.libraryState.meta}catch(i){throw U.createInvalidStateError(t,i)}},r.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Se(e);return Se.getDeserializedHash(t.getHash())},r}();var Ru=function(r){mt(e,r);function e(t,o,i,n){var s=r.call(this,t,i,n)||this;return s.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,s.cacheConfig=o,s.logger=n,s.internalStorage=new Au,s.browserStorage=s.setupBrowserStorage(s.cacheConfig.cacheLocation),s.temporaryCacheStorage=s.setupTemporaryCacheStorage(s.cacheConfig.temporaryCacheLocation,s.cacheConfig.cacheLocation),o.cacheMigrationEnabled&&(s.migrateCacheEntries(),s.createKeyMaps()),s}return e.prototype.setupBrowserStorage=function(t){switch(t){case zt.LocalStorage:case zt.SessionStorage:try{return new Sy(t)}catch(o){this.logger.verbose(o);break}}return this.cacheConfig.cacheLocation=zt.MemoryStorage,new Au},e.prototype.setupTemporaryCacheStorage=function(t,o){switch(o){case zt.LocalStorage:case zt.SessionStorage:try{return new Sy(t||zt.SessionStorage)}catch(i){return this.logger.verbose(i),this.internalStorage}case zt.MemoryStorage:default:return this.internalStorage}},e.prototype.migrateCacheEntries=function(){var t=this,o=_.CACHE_PREFIX+"."+pr.ID_TOKEN,i=_.CACHE_PREFIX+"."+pr.CLIENT_INFO,n=_.CACHE_PREFIX+"."+pr.ERROR,s=_.CACHE_PREFIX+"."+pr.ERROR_DESC,a=this.browserStorage.getItem(o),u=this.browserStorage.getItem(i),h=this.browserStorage.getItem(n),p=this.browserStorage.getItem(s),f=[a,u,h,p],b=[pr.ID_TOKEN,pr.CLIENT_INFO,pr.ERROR,pr.ERROR_DESC];b.forEach(function(C,S){return t.migrateCacheEntry(C,f[S])})},e.prototype.migrateCacheEntry=function(t,o){o&&this.setTemporaryCache(t,o,!0)},e.prototype.createKeyMaps=function(){var t=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var o=this.getItem(Ji.ACCOUNT_KEYS),i=this.getItem(Ji.TOKEN_KEYS+"."+this.clientId);if(o&&i){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}var n=this.browserStorage.getKeys();n.forEach(function(s){if(t.isCredentialKey(s)){var a=t.getItem(s);if(a){var u=t.validateAndParseJson(a);if(u&&u.hasOwnProperty("credentialType"))switch(u.credentialType){case ue.ID_TOKEN:if(vi.isIdTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+s+" found, saving key to token key map");var h=Xr.toObject(new vi,u),p=t.updateCredentialCacheKey(s,h);t.addTokenKey(p,ue.ID_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+s);break;case ue.ACCESS_TOKEN:case ue.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(yi.isAccessTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+s+" found, saving key to token key map");var f=Xr.toObject(new yi,u),p=t.updateCredentialCacheKey(s,f);t.addTokenKey(p,ue.ACCESS_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+s);break;case ue.REFRESH_TOKEN:if(In.isRefreshTokenEntity(u)){t.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+s+" found, saving key to token key map");var b=Xr.toObject(new In,u),p=t.updateCredentialCacheKey(s,b);t.addTokenKey(p,ue.REFRESH_TOKEN);return}else t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+s);break}}}if(t.isAccountKey(s)){var a=t.getItem(s);if(a){var C=t.validateAndParseJson(a);C&&Nt.isAccountEntity(C)&&(t.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+s+" found, saving key to account key map"),t.addAccountKeyToMap(s))}}})},e.prototype.validateAndParseJson=function(t){try{var o=JSON.parse(t);return o&&typeof o=="object"?o:null}catch{return null}},e.prototype.getItem=function(t){return this.browserStorage.getItem(t)},e.prototype.setItem=function(t,o){this.browserStorage.setItem(t,o)},e.prototype.getAccount=function(t){this.logger.trace("BrowserCacheManager.getAccount called");var o=this.getItem(t);if(!o)return this.removeAccountKeyFromMap(t),null;var i=this.validateAndParseJson(o);return!i||!Nt.isAccountEntity(i)?(this.removeAccountKeyFromMap(t),null):Xr.toObject(new Nt,i)},e.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var o=t.generateAccountKey();this.setItem(o,JSON.stringify(t)),this.addAccountKeyToMap(o)},e.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var t=this.getItem(Ji.ACCOUNT_KEYS);return t?JSON.parse(t):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},e.prototype.addAccountKeyToMap=function(t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+t);var o=this.getAccountKeys();o.indexOf(t)===-1?(o.push(t),this.setItem(Ji.ACCOUNT_KEYS,JSON.stringify(o)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},e.prototype.removeAccountKeyFromMap=function(t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+t);var o=this.getAccountKeys(),i=o.indexOf(t);i>-1?(o.splice(i,1),this.setItem(Ji.ACCOUNT_KEYS,JSON.stringify(o)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},e.prototype.removeAccount=function(t){return F(this,void 0,void 0,function(){return D(this,function(o){return r.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]})})},e.prototype.removeIdToken=function(t){r.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,ue.ID_TOKEN)},e.prototype.removeAccessToken=function(t){return F(this,void 0,void 0,function(){return D(this,function(o){return r.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,ue.ACCESS_TOKEN),[2]})})},e.prototype.removeRefreshToken=function(t){r.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,ue.REFRESH_TOKEN)},e.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var t=this.getItem(Ji.TOKEN_KEYS+"."+this.clientId);if(t){var o=this.validateAndParseJson(t);if(o&&o.hasOwnProperty("idToken")&&o.hasOwnProperty("accessToken")&&o.hasOwnProperty("refreshToken"))return o;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},e.prototype.addTokenKey=function(t,o){this.logger.trace("BrowserCacheManager addTokenKey called");var i=this.getTokenKeys();switch(o){case ue.ID_TOKEN:i.idToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),i.idToken.push(t));break;case ue.ACCESS_TOKEN:i.accessToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),i.accessToken.push(t));break;case ue.REFRESH_TOKEN:i.refreshToken.indexOf(t)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),i.refreshToken.push(t));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+o),U.createUnexpectedCredentialTypeError()}this.setItem(Ji.TOKEN_KEYS+"."+this.clientId,JSON.stringify(i))},e.prototype.removeTokenKey=function(t,o){this.logger.trace("BrowserCacheManager removeTokenKey called");var i=this.getTokenKeys();switch(o){case ue.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+t+" from map");var n=i.idToken.indexOf(t);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),i.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case ue.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+t+" from map");var s=i.accessToken.indexOf(t);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),i.accessToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case ue.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+t+" from map");var a=i.refreshToken.indexOf(t);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),i.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+o),U.createUnexpectedCredentialTypeError()}this.setItem(Ji.TOKEN_KEYS+"."+this.clientId,JSON.stringify(i))},e.prototype.getIdTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,ue.ID_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!vi.isIdTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,ue.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Xr.toObject(new vi,i))},e.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,ue.ID_TOKEN)},e.prototype.getAccessTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,ue.ACCESS_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!yi.isAccessTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,ue.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Xr.toObject(new yi,i))},e.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,ue.ACCESS_TOKEN)},e.prototype.getRefreshTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,ue.REFRESH_TOKEN),null;var i=this.validateAndParseJson(o);return!i||!In.isRefreshTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,ue.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Xr.toObject(new In,i))},e.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,ue.REFRESH_TOKEN)},e.prototype.getAppMetadata=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!Pc.isAppMetadataEntity(t,i)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Xr.toObject(new Pc,i))},e.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var o=t.generateAppMetadataKey();this.setItem(o,JSON.stringify(t))},e.prototype.getServerTelemetry=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!wl.isServerTelemetryEntity(t,i)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Xr.toObject(new wl,i))},e.prototype.setServerTelemetry=function(t,o){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(o))},e.prototype.getAuthorityMetadata=function(t){var o=this.internalStorage.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var i=this.validateAndParseJson(o);return i&&$c.isAuthorityMetadataEntity(t,i)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Xr.toObject(new $c,i)):null},e.prototype.getAuthorityMetadataKeys=function(){var t=this,o=this.internalStorage.getKeys();return o.filter(function(i){return t.isAuthorityMetadata(i)})},e.prototype.setWrapperMetadata=function(t,o){this.internalStorage.setItem(Cl.WRAPPER_SKU,t),this.internalStorage.setItem(Cl.WRAPPER_VER,o)},e.prototype.getWrapperMetadata=function(){var t=this.internalStorage.getItem(Cl.WRAPPER_SKU)||_.EMPTY_STRING,o=this.internalStorage.getItem(Cl.WRAPPER_VER)||_.EMPTY_STRING;return[t,o]},e.prototype.setAuthorityMetadata=function(t,o){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(o))},e.prototype.getActiveAccount=function(){var t=this.generateCacheKey(pr.ACTIVE_ACCOUNT_FILTERS),o=this.getItem(t);if(!o){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var i=this.generateCacheKey(pr.ACTIVE_ACCOUNT),n=this.getItem(i);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var s=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}var a=this.validateAndParseJson(o);return a?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:a.homeAccountId,localAccountId:a.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},e.prototype.setActiveAccount=function(t){var o=this.generateCacheKey(pr.ACTIVE_ACCOUNT_FILTERS),i=this.generateCacheKey(pr.ACTIVE_ACCOUNT);if(t){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:t.homeAccountId,localAccountId:t.localAccountId};this.browserStorage.setItem(o,JSON.stringify(n)),this.browserStorage.setItem(i,t.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(o),this.browserStorage.removeItem(i)},e.prototype.getAccountInfoByFilter=function(t){var o=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+o.length+" accounts found"),o.filter(function(i){return!(t.username&&t.username.toLowerCase()!==i.username.toLowerCase()||t.homeAccountId&&t.homeAccountId!==i.homeAccountId||t.localAccountId&&t.localAccountId!==i.localAccountId||t.tenantId&&t.tenantId!==i.tenantId||t.environment&&t.environment!==i.environment)})},e.prototype.getAccountInfoByHints=function(t,o){var i=this.getAllAccounts().filter(function(n){if(o){var s=n.idTokenClaims&&n.idTokenClaims.sid;return o===s}return t?t===n.username:!1});if(i.length===1)return i[0];if(i.length>1)throw U.createMultipleMatchingAccountsInCacheError();return null},e.prototype.getThrottlingCache=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var i=this.validateAndParseJson(o);return!i||!Af.isThrottlingEntity(t,i)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Xr.toObject(new Af,i))},e.prototype.setThrottlingCache=function(t,o){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(o))},e.prototype.getTemporaryCache=function(t,o){var i=o?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(i);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var s=this.temporaryCacheStorage.getItem(i);if(!s){if(this.cacheConfig.cacheLocation===zt.LocalStorage){var a=this.browserStorage.getItem(i);if(a)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),a}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s},e.prototype.setTemporaryCache=function(t,o,i){var n=i?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(n,o),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,o))},e.prototype.removeItem=function(t){this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t))},e.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},e.prototype.getKeys=function(){return Tc(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},e.prototype.clear=function(){return F(this,void 0,void 0,function(){var t=this;return D(this,function(o){switch(o.label){case 0:return[4,this.removeAllAccounts()];case 1:return o.sent(),this.removeAppMetadata(),this.getKeys().forEach(function(i){(t.browserStorage.containsKey(i)||t.temporaryCacheStorage.containsKey(i))&&(i.indexOf(_.CACHE_PREFIX)!==-1||i.indexOf(t.clientId)!==-1)&&t.removeItem(i)}),this.internalStorage.clear(),[2]}})})},e.prototype.clearTokensAndKeysWithClaims=function(){return F(this,void 0,void 0,function(){var t,o,i=this;return D(this,function(n){switch(n.label){case 0:return this.logger.trace("BrowserCacheManager.clearTokensAndKeysWithClaims called"),t=this.getTokenKeys(),o=[],t.accessToken.forEach(function(s){var a=i.getAccessTokenCredential(s);a?.requestedClaimsHash&&s.includes(a.requestedClaimsHash.toLowerCase())&&o.push(i.removeAccessToken(s))}),[4,Promise.all(o)];case 1:return n.sent(),o.length>0&&this.logger.warning(o.length+" access tokens with claims in the cache keys have been removed from the cache."),[2]}})})},e.prototype.setItemCookie=function(t,o,i){var n=encodeURIComponent(t)+"="+encodeURIComponent(o)+";path=/;SameSite=Lax;";if(i){var s=this.getCookieExpirationTime(i);n+="expires="+s+";"}this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},e.prototype.getItemCookie=function(t){for(var o=encodeURIComponent(t)+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var s=i[n];s.charAt(0)===" ";)s=s.substring(1);if(s.indexOf(o)===0)return decodeURIComponent(s.substring(o.length,s.length))}return _.EMPTY_STRING},e.prototype.clearMsalCookies=function(){var t=this,o=_.CACHE_PREFIX+"."+this.clientId,i=document.cookie.split(";");i.forEach(function(n){for(;n.charAt(0)===" ";)n=n.substring(1);if(n.indexOf(o)===0){var s=n.split("=")[0];t.clearItemCookie(s)}})},e.prototype.clearItemCookie=function(t){this.setItemCookie(t,_.EMPTY_STRING,-1)},e.prototype.getCookieExpirationTime=function(t){var o=new Date,i=new Date(o.getTime()+t*this.COOKIE_LIFE_MULTIPLIER);return i.toUTCString()},e.prototype.getCache=function(){return this.browserStorage},e.prototype.setCache=function(){},e.prototype.generateCacheKey=function(t){var o=this.validateAndParseJson(t);return o?JSON.stringify(t):z.startsWith(t,_.CACHE_PREFIX)||z.startsWith(t,pr.ADAL_ID_TOKEN)?t:_.CACHE_PREFIX+"."+this.clientId+"."+t},e.prototype.generateAuthorityKey=function(t){var o=to.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Ye.AUTHORITY+"."+o)},e.prototype.generateNonceKey=function(t){var o=to.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Ye.NONCE_IDTOKEN+"."+o)},e.prototype.generateStateKey=function(t){var o=to.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Ye.REQUEST_STATE+"."+o)},e.prototype.getCachedAuthority=function(t){var o=this.generateStateKey(t),i=this.getTemporaryCache(o);if(!i)return null;var n=this.generateAuthorityKey(i);return this.getTemporaryCache(n)},e.prototype.updateCacheEntries=function(t,o,i,n,s){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var a=this.generateStateKey(t);this.setTemporaryCache(a,t,!1);var u=this.generateNonceKey(t);this.setTemporaryCache(u,o,!1);var h=this.generateAuthorityKey(t);if(this.setTemporaryCache(h,i,!1),s){var p={credential:s.homeAccountId,type:Cr.HOME_ACCOUNT_ID};this.setTemporaryCache(Ye.CCS_CREDENTIAL,JSON.stringify(p),!0)}else if(!z.isEmpty(n)){var p={credential:n,type:Cr.UPN};this.setTemporaryCache(Ye.CCS_CREDENTIAL,JSON.stringify(p),!0)}},e.prototype.resetRequestCache=function(t){var o=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),z.isEmpty(t)||this.getKeys().forEach(function(i){i.indexOf(t)!==-1&&o.removeItem(i)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(Ye.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Ye.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Ye.URL_HASH)),this.removeItem(this.generateCacheKey(Ye.CORRELATION_ID)),this.removeItem(this.generateCacheKey(Ye.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(Ye.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},e.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var o=this.generateStateKey(t),i=this.temporaryCacheStorage.getItem(o);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+i),this.resetRequestCache(i||_.EMPTY_STRING)}this.clearMsalCookies()},e.prototype.cleanRequestByInteractionType=function(t){var o=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(i){if(i.indexOf(Ye.REQUEST_STATE)!==-1){var n=o.temporaryCacheStorage.getItem(i);if(n){var s=$f.extractBrowserRequestState(o.cryptoImpl,n);s&&s.interactionType===t&&(o.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),o.resetRequestCache(n))}}}),this.clearMsalCookies(),this.setInteractionInProgress(!1)},e.prototype.cacheCodeRequest=function(t,o){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var i=o.base64Encode(JSON.stringify(t));this.setTemporaryCache(Ye.REQUEST_PARAMS,i,!0)},e.prototype.getCachedRequest=function(t,o){this.logger.trace("BrowserCacheManager.getCachedRequest called");var i=this.getTemporaryCache(Ye.REQUEST_PARAMS,!0);if(!i)throw B.createNoTokenRequestCacheError();var n=this.validateAndParseJson(o.base64Decode(i));if(!n)throw B.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Ye.REQUEST_PARAMS)),z.isEmpty(n.authority)){var s=this.generateAuthorityKey(t),a=this.getTemporaryCache(s);if(!a)throw B.createNoCachedAuthorityError();n.authority=a}return n},e.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var t=this.getTemporaryCache(Ye.NATIVE_REQUEST,!0);if(!t)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var o=this.validateAndParseJson(t);return o||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},e.prototype.isInteractionInProgress=function(t){var o=this.getInteractionInProgress();return t?o===this.clientId:!!o},e.prototype.getInteractionInProgress=function(){var t=_.CACHE_PREFIX+"."+Ye.INTERACTION_STATUS_KEY;return this.getTemporaryCache(t,!1)},e.prototype.setInteractionInProgress=function(t){var o=_.CACHE_PREFIX+"."+Ye.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw B.createInteractionInProgressError();this.setTemporaryCache(o,this.clientId,!1)}else!t&&this.getInteractionInProgress()===this.clientId&&this.removeItem(o)},e.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(pr.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(pr.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var o=this.getTemporaryCache(pr.ID_TOKEN,!0);o&&(this.removeItem(this.generateCacheKey(pr.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var i=o||t;if(i){var n=new fr(i,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},e.prototype.updateCredentialCacheKey=function(t,o){var i=o.generateCredentialKey();if(t!==i){var n=this.getItem(t);if(n)return this.removeItem(t),this.setItem(i,n),this.logger.verbose("Updated an outdated "+o.credentialType+" cache key"),i;this.logger.error("Attempted to update an outdated "+o.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},e.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(Ye.REDIRECT_CONTEXT,!0)},e.prototype.setRedirectRequestContext=function(t){this.setTemporaryCache(Ye.REDIRECT_CONTEXT,t,!0)},e}(Xr),$_=function(r,e){var t={cacheLocation:zt.MemoryStorage,temporaryCacheLocation:zt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};return new Ru(r,t,ra,e)};l();c();d();l();c();d();l();c();d();var Oc="@azure/msal-browser",Xi="2.38.3";l();c();d();l();c();d();var O_=function(){function r(){}return r.prototype.sendGetRequestAsync=function(e,t){return F(this,void 0,void 0,function(){var o,i,n;return D(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,fetch(e,{method:bi.GET,headers:this.getFetchHeaders(t)})];case 1:return o=s.sent(),[3,3];case 2:throw i=s.sent(),window.navigator.onLine?B.createGetRequestFailedError(i,e):B.createNoNetworkConnectivityError();case 3:return s.trys.push([3,5,,6]),n={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 4:return[2,(n.body=s.sent(),n.status=o.status,n)];case 5:throw s.sent(),B.createFailedToParseNetworkResponseError(e);case 6:return[2]}})})},r.prototype.sendPostRequestAsync=function(e,t){return F(this,void 0,void 0,function(){var o,i,n,s;return D(this,function(a){switch(a.label){case 0:o=t&&t.body||_.EMPTY_STRING,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:bi.POST,headers:this.getFetchHeaders(t),body:o})];case 2:return i=a.sent(),[3,4];case 3:throw n=a.sent(),window.navigator.onLine?B.createPostRequestFailedError(n,e):B.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),s={headers:this.getHeaderDict(i.headers)},[4,i.json()];case 5:return[2,(s.body=a.sent(),s.status=i.status,s)];case 6:throw a.sent(),B.createFailedToParseNetworkResponseError(e);case 7:return[2]}})})},r.prototype.getFetchHeaders=function(e){var t=new Headers;if(!(e&&e.headers))return t;var o=e.headers;return Object.keys(o).forEach(function(i){t.append(i,o[i])}),t},r.prototype.getHeaderDict=function(e){var t={};return e.forEach(function(o,i){t[i]=o}),t},r}();l();c();d();var M_=function(){function r(){}return r.prototype.sendGetRequestAsync=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,this.sendRequestAsync(e,bi.GET,t)]})})},r.prototype.sendPostRequestAsync=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,this.sendRequestAsync(e,bi.POST,t)]})})},r.prototype.sendRequestAsync=function(e,t,o){var i=this;return new Promise(function(n,s){var a=new XMLHttpRequest;if(a.open(t,e,!0),i.setXhrHeaders(a,o),a.onload=function(){(a.status<200||a.status>=300)&&(t===bi.POST?s(B.createPostRequestFailedError("Failed with status "+a.status,e)):s(B.createGetRequestFailedError("Failed with status "+a.status,e)));try{var u=JSON.parse(a.responseText),h={headers:i.getHeaderDict(a),body:u,status:a.status};n(h)}catch{s(B.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===bi.POST?s(B.createPostRequestFailedError("Failed with status "+a.status,e)):s(B.createGetRequestFailedError("Failed with status "+a.status,e)):s(B.createNoNetworkConnectivityError())},t===bi.POST&&o&&o.body)a.send(o.body);else if(t===bi.GET)a.send();else throw B.createHttpMethodNotImplementedError(t)})},r.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var o=t.headers;Object.keys(o).forEach(function(i){e.setRequestHeader(i,o[i])})}},r.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders(),o=t.trim().split(/[\r\n]+/),i={};return o.forEach(function(n){var s=n.split(": "),a=s.shift(),u=s.join(": ");a&&u&&(i[a]=u)}),i},r}();var St=function(){function r(){}return r.clearHash=function(e){e.location.hash=_.EMPTY_STRING,typeof e.history.replaceState=="function"&&e.history.replaceState(null,_.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},r.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):_.EMPTY_STRING},r.isInIframe=function(){return window.parent!==window},r.isInPopup=function(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(Ur.POPUP_NAME_PREFIX+".")===0},r.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},r.getHomepage=function(){var e=new Se(window.location.href),t=e.getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},r.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new O_:new M_},r.blockReloadInHiddenIframes=function(){var e=Se.hashContainsKnownProperties(window.location.hash);if(e&&r.isInIframe())throw B.createBlockReloadInHiddenIframeError()},r.blockRedirectInIframe=function(e,t){var o=r.isInIframe();if(e===ne.Redirect&&o&&!t)throw B.createRedirectInIframeError(o)},r.blockAcquireTokenInPopups=function(){if(r.isInPopup())throw B.createBlockAcquireTokenInPopupsError()},r.blockNonBrowserEnvironment=function(e){if(!e)throw B.createNonBrowserEnvironmentError()},r.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw B.createNativeBrokerCalledBeforeInitialize()},r.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),o=e.indexOf("Trident/"),i=e.indexOf("Edge/"),n=t>0||o>0,s=i>0;return n||s},r}();var Of=function(){function r(e,t,o,i,n,s,a,u,h){this.config=e,this.browserStorage=t,this.browserCrypto=o,this.networkClient=this.config.system.networkClient,this.eventHandler=n,this.navigationClient=s,this.nativeMessageHandler=u,this.correlationId=h||this.browserCrypto.createNewGuid(),this.logger=i.clone(Ur.MSAL_SKU,Xi,this.correlationId),this.performanceClient=a}return r.prototype.clearCacheOnLogout=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){switch(t.label){case 0:if(!e)return[3,5];Nt.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Nt.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}})})},r.prototype.initializeBaseRequest=function(e,t){return F(this,void 0,void 0,function(){var o,i,n,s;return D(this,function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement($.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),o=e.authority||this.config.auth.authority,t?[4,this.validateRequestAuthority(o,t)]:[3,2];case 1:a.sent(),a.label=2;case 2:if(i=Tc(e&&e.scopes||[]),n=ae(ae({},e),{correlationId:this.correlationId,authority:o,scopes:i}),!n.authenticationScheme)n.authenticationScheme=Be.BEARER,this.logger.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(n.authenticationScheme===Be.SSH){if(!e.sshJwk)throw je.createMissingSshJwkError();if(!e.sshKid)throw je.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+n.authenticationScheme+'" as configured in Auth request')}return this.config.cache.claimsBasedCachingEnabled&&e.claims&&!z.isEmptyObj(e.claims)?(s=n,[4,this.browserCrypto.hashString(e.claims)]):[3,4];case 3:s.requestedClaimsHash=a.sent(),a.label=4;case 4:return[2,n]}})})},r.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||St.getCurrentUri();return Se.getAbsoluteUrl(t,St.getCurrentUri())},r.prototype.validateRequestAuthority=function(e,t){return F(this,void 0,void 0,function(){var o;return D(this,function(i){switch(i.label){case 0:return[4,this.getDiscoveredAuthority(e)];case 1:if(o=i.sent(),!o.isAlias(t.environment))throw je.createAuthorityMismatchError();return[2]}})})},r.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var o={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new wy(o,this.browserStorage)},r.prototype.getDiscoveredAuthority=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){switch(o.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,na.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:return[2,o.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,na.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)];case 3:return[2,o.sent()]}})})},r}();var li=function(r){mt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.initializeAuthorizationCodeRequest=function(t){return F(this,void 0,void 0,function(){var o,i;return D(this,function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return o=n.sent(),i=ae(ae({},t),{redirectUri:t.redirectUri,code:_.EMPTY_STRING,codeVerifier:o.verifier}),t.codeChallenge=o.challenge,t.codeChallengeMethod=_.S256_CODE_CHALLENGE_METHOD,[2,i]}})})},e.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",t?.correlationId);var o=ae({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var i=this.getLogoutHintFromIdTokenClaims(t.account);i&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),o.logoutHint=i)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!t||t.postLogoutRedirectUri!==null?t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",o.correlationId),o.postLogoutRedirectUri=Se.getAbsoluteUrl(t.postLogoutRedirectUri,St.getCurrentUri())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",o.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",o.correlationId),o.postLogoutRedirectUri=Se.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,St.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",o.correlationId),o.postLogoutRedirectUri=Se.getAbsoluteUrl(St.getCurrentUri(),St.getCurrentUri())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",o.correlationId),o},e.prototype.getLogoutHintFromIdTokenClaims=function(t){var o=t.idTokenClaims;if(o){if(o.login_hint)return o.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},e.prototype.createAuthCodeClient=function(t,o,i){return F(this,void 0,void 0,function(){var n;return D(this,function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime($.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new Tu(n,this.performanceClient)]}})})},e.prototype.getClientConfiguration=function(t,o,i){return F(this,void 0,void 0,function(){var n,s;return D(this,function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime($.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(o,i)];case 1:return n=a.sent(),s=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:Ur.MSAL_SKU,version:Xi,cpu:_.EMPTY_STRING,os:_.EMPTY_STRING},telemetry:this.config.telemetry}]}})})},e.prototype.validateAndExtractStateFromHash=function(t,o,i){if(this.logger.verbose("validateAndExtractStateFromHash called",i),!t.state)throw B.createHashDoesNotContainStateError();var n=$f.extractBrowserRequestState(this.browserCrypto,t.state);if(!n)throw B.createUnableToParseStateError();if(n.interactionType!==o)throw B.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",i),t.state},e.prototype.getDiscoveredAuthority=function(t,o){var i;return F(this,void 0,void 0,function(){var n,s,a,u;return D(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement($.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=t||this.config.auth.authority,u=ms.generateAuthority(a,o||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime($.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,na.createDiscoveredInstance(u,this.config.system.networkClient,this.browserStorage,s,this.logger,this.performanceClient,this.correlationId).then(function(p){return n.endMeasurement({success:!0}),p}).catch(function(p){throw n.endMeasurement({errorCode:p.errorCode,subErrorCode:p.subError,success:!1}),p})];case 1:return[2,h.sent()]}})})},e.prototype.initializeAuthorizationRequest=function(t,o){return F(this,void 0,void 0,function(){var i,n,s,a,u,h,p;return D(this,function(f){switch(f.label){case 0:return this.performanceClient.addQueueMeasurement($.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),i=this.getRedirectUri(t.redirectUri),n={interactionType:o},s=to.setRequestState(this.browserCrypto,t&&t.state||_.EMPTY_STRING,n),this.performanceClient.setPreQueueTime($.InitializeBaseRequest,this.correlationId),u=[{}],[4,this.initializeBaseRequest(t)];case 1:return a=ae.apply(void 0,[ae.apply(void 0,u.concat([f.sent()])),{redirectUri:i,state:s,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:ml.FRAGMENT}]),h=t.account||this.browserStorage.getActiveAccount(),h&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+h.homeAccountId,this.correlationId),a.account=h),z.isEmpty(a.loginHint)&&!h&&(p=this.browserStorage.getLegacyLoginHint(),p&&(a.loginHint=p)),[2,a]}})})},e}(Of);l();c();d();l();c();d();l();c();d();var Mc=function(){function r(e,t,o,i,n){this.authModule=e,this.browserStorage=t,this.authCodeRequest=o,this.logger=i,this.performanceClient=n}return r.prototype.handleCodeResponseFromHash=function(e,t,o,i){return F(this,void 0,void 0,function(){var n,s,a;return D(this,function(u){if(this.performanceClient.addQueueMeasurement($.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),z.isEmpty(e))throw B.createEmptyHashError(e);if(n=this.browserStorage.generateStateKey(t),s=this.browserStorage.getTemporaryCache(n),!s)throw U.createStateNotFoundError("Cached State");try{a=this.authModule.handleFragmentResponse(e,s)}catch(h){throw h instanceof eo&&h.subError===q.userCancelledError.code?B.createUserCancelledError():h}return this.performanceClient.setPreQueueTime($.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(a,t,o,i)]})})},r.prototype.handleCodeResponseFromServer=function(e,t,o,i,n){return n===void 0&&(n=!0),F(this,void 0,void 0,function(){var s,a,u,h,p,f;return D(this,function(b){switch(b.label){case 0:if(this.performanceClient.addQueueMeasurement($.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),s=this.browserStorage.generateStateKey(t),a=this.browserStorage.getTemporaryCache(s),!a)throw U.createStateNotFoundError("Cached State");return u=this.browserStorage.generateNonceKey(a),h=this.browserStorage.getTemporaryCache(u),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime($.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,o,i)]):[3,2];case 1:b.sent(),b.label=2;case 2:return n&&(e.nonce=h||void 0),e.state=a,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(p=this.checkCcsCredentials(),p&&(this.authCodeRequest.ccsCredential=p)),this.performanceClient.setPreQueueTime($.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return f=b.sent(),this.browserStorage.cleanRequestByState(t),[2,f]}})})},r.prototype.updateTokenEndpointAuthority=function(e,t,o){return F(this,void 0,void 0,function(){var i,n;return D(this,function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement($.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),i="https://"+e+"/"+t.tenant+"/",[4,na.createDiscoveredInstance(i,o,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return n=s.sent(),this.authModule.updateAuthority(n),[2]}})})},r.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(Ye.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},r}();var Mf=function(r){mt(e,r);function e(t,o,i,n,s,a){var u=r.call(this,t,o,i,n,a)||this;return u.browserCrypto=s,u}return e.prototype.initiateAuthRequest=function(t,o){return F(this,void 0,void 0,function(){var i,n;return D(this,function(s){switch(s.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),z.isEmpty(t)?[3,7]:(o.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Ye.ORIGIN_URI,o.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Ye.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),i={apiId:ct.acquireTokenRedirect,timeout:o.redirectTimeout,noHistory:!1},typeof o.onRedirectNavigate!="function"?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),n=o.onRedirectNavigate(t),n===!1?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,o.navigationClient.navigateExternal(t,i)])));case 1:return s.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,o.navigationClient.navigateExternal(t,i)];case 5:return s.sent(),[2];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),B.createEmptyNavigationUriError();case 8:return[2]}})})},e.prototype.handleCodeResponseFromHash=function(t,o,i,n){return F(this,void 0,void 0,function(){var s,a,u,h,p,f,b;return D(this,function(C){switch(C.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),z.isEmpty(t))throw B.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),s=this.browserStorage.generateStateKey(o),a=this.browserStorage.getTemporaryCache(s),!a)throw U.createStateNotFoundError("Cached State");try{u=this.authModule.handleFragmentResponse(t,a)}catch(S){throw S instanceof eo&&S.subError===q.userCancelledError.code?B.createUserCancelledError():S}return h=this.browserStorage.generateNonceKey(a),p=this.browserStorage.getTemporaryCache(h),this.authCodeRequest.code=u.code,u.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(u.cloud_instance_host_name,i,n)]:[3,2];case 1:C.sent(),C.label=2;case 2:return u.nonce=p||void 0,u.state=a,u.client_info?this.authCodeRequest.clientInfo=u.client_info:(f=this.checkCcsCredentials(),f&&(this.authCodeRequest.ccsCredential=f)),[4,this.authModule.acquireToken(this.authCodeRequest,u)];case 3:return b=C.sent(),this.browserStorage.cleanRequestByState(o),[2,b]}})})},e}(Mc);l();c();d();var he;(function(r){r.INITIALIZE_START="msal:initializeStart",r.INITIALIZE_END="msal:initializeEnd",r.ACCOUNT_ADDED="msal:accountAdded",r.ACCOUNT_REMOVED="msal:accountRemoved",r.LOGIN_START="msal:loginStart",r.LOGIN_SUCCESS="msal:loginSuccess",r.LOGIN_FAILURE="msal:loginFailure",r.ACQUIRE_TOKEN_START="msal:acquireTokenStart",r.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",r.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",r.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",r.SSO_SILENT_START="msal:ssoSilentStart",r.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",r.SSO_SILENT_FAILURE="msal:ssoSilentFailure",r.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",r.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",r.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",r.HANDLE_REDIRECT_START="msal:handleRedirectStart",r.HANDLE_REDIRECT_END="msal:handleRedirectEnd",r.POPUP_OPENED="msal:popupOpened",r.LOGOUT_START="msal:logoutStart",r.LOGOUT_SUCCESS="msal:logoutSuccess",r.LOGOUT_FAILURE="msal:logoutFailure",r.LOGOUT_END="msal:logoutEnd",r.RESTORE_FROM_BFCACHE="msal:restoreFromBFCache"})(he||(he={}));l();c();d();l();c();d();var sa;(function(r){r.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",r.USER_CANCEL="USER_CANCEL",r.NO_NETWORK="NO_NETWORK",r.TRANSIENT_ERROR="TRANSIENT_ERROR",r.PERSISTENT_ERROR="PERSISTENT_ERROR",r.DISABLED="DISABLED",r.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"})(sa||(sa={}));var Pu={extensionError:{code:"ContentError"},userSwitch:{code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},tokensNotFoundInCache:{code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"}},Eo=function(r){mt(e,r);function e(t,o,i){var n=r.call(this,t,o)||this;return Object.setPrototypeOf(n,e.prototype),n.name="NativeAuthError",n.ext=i,n}return e.prototype.isFatal=function(){if(this.ext&&this.ext.status&&(this.ext.status===sa.PERSISTENT_ERROR||this.ext.status===sa.DISABLED))return!0;switch(this.errorCode){case Pu.extensionError.code:return!0;default:return!1}},e.createError=function(t,o,i){if(i&&i.status)switch(i.status){case sa.ACCOUNT_UNAVAILABLE:return xr.createNativeAccountUnavailableError();case sa.USER_INTERACTION_REQUIRED:return new xr(t,o);case sa.USER_CANCEL:return B.createUserCancelledError();case sa.NO_NETWORK:return B.createNoNetworkConnectivityError()}return new e(t,o,i)},e.createUserSwitchError=function(){return new e(Pu.userSwitch.code,Pu.userSwitch.desc)},e.createTokensNotFoundInCacheError=function(){return new e(Pu.tokensNotFoundInCache.code,Pu.tokensNotFoundInCache.desc)},e}(ee);l();c();d();var $u=function(r){mt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a;return D(this,function(u){switch(u.label){case 0:return o=this.performanceClient.startMeasurement($.SilentCacheClientAcquireToken,t.correlationId),i=this.initializeServerTelemetryManager(ct.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(i,t.authority,t.azureCloudOptions)];case 1:n=u.sent(),this.logger.verbose("Silent auth client created"),u.label=2;case 2:return u.trys.push([2,4,,5]),[4,n.acquireCachedToken(t)];case 3:return s=u.sent(),o.endMeasurement({success:!0,fromCache:!0}),[2,s];case 4:throw a=u.sent(),a instanceof B&&a.errorCode===q.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o.endMeasurement({errorCode:a instanceof ee&&a.errorCode||void 0,subErrorCode:a instanceof ee&&a.subError||void 0,success:!1}),a;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(B.createSilentLogoutUnsupportedError())},e.prototype.createSilentFlowClient=function(t,o,i){return F(this,void 0,void 0,function(){var n;return D(this,function(s){switch(s.label){case 0:return this.performanceClient.setPreQueueTime($.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new fy(n,this.performanceClient)]}})})},e.prototype.initializeSilentRequest=function(t,o){return F(this,void 0,void 0,function(){var i;return D(this,function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement($.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime($.InitializeBaseRequest,this.correlationId),i=[ae({},t)],[4,this.initializeBaseRequest(t,o)];case 1:return[2,ae.apply(void 0,[ae.apply(void 0,i.concat([n.sent()])),{account:o,forceRefresh:t.forceRefresh||!1}])]}})})},e}(li);var en=function(r){mt(e,r);function e(t,o,i,n,s,a,u,h,p,f,b,C){var S=r.call(this,t,o,i,n,s,a,h,p,C)||this;return S.apiId=u,S.accountId=f,S.nativeMessageHandler=p,S.nativeStorageManager=b,S.silentCacheClient=new $u(t,S.nativeStorageManager,i,n,s,a,h,p,C),S}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h;return D(this,function(p){switch(p.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),o=this.performanceClient.startMeasurement($.NativeInteractionClientAcquireToken,t.correlationId),i=st.nowSeconds(),[4,this.initializeNativeRequest(t)];case 1:n=p.sent(),p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return s=p.sent(),o.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,s];case 4:return p.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return a={method:Zi.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(a)];case 6:return u=p.sent(),h=this.validateNativeResponse(u),[2,this.handleNativeResponse(h,n,i).then(function(f){return o.endMeasurement({success:!0,isNativeBroker:!0,requestId:f.requestId}),f}).catch(function(f){throw o.endMeasurement({success:!1,errorCode:f.errorCode,subErrorCode:f.subError,isNativeBroker:!0}),f})]}})})},e.prototype.createSilentCacheRequest=function(t,o){return{authority:t.authority,correlationId:this.correlationId,scopes:It.fromString(t.scope).asArray(),account:o,forceRefresh:!1}},e.prototype.acquireTokensFromCache=function(t,o){return F(this,void 0,void 0,function(){var i,n,s,a;return D(this,function(u){switch(u.label){case 0:if(!t)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),U.createNoAccountFoundError();if(i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t}),!i)throw U.createNoAccountFoundError();u.label=1;case 1:return u.trys.push([1,3,,4]),n=this.createSilentCacheRequest(o,i),[4,this.silentCacheClient.acquireToken(n)];case 2:return s=u.sent(),[2,s];case 3:throw a=u.sent(),a;case 4:return[2]}})})},e.prototype.acquireTokenRedirect=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u;return D(this,function(h){switch(h.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:o=h.sent(),i={method:Zi.GetToken,request:o},h.label=2;case 2:return h.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(i)];case 3:return n=h.sent(),this.validateNativeResponse(n),[3,5];case 4:if(s=h.sent(),s instanceof Eo&&s.isFatal())throw s;return[3,5];case 5:return this.browserStorage.setTemporaryCache(Ye.NATIVE_REQUEST,JSON.stringify(o),!0),a={apiId:ct.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(u,a)];case 6:return h.sent(),[2]}})})},e.prototype.handleRedirectPromise=function(){return F(this,void 0,void 0,function(){var t,o,i,n,s,a,u,h;return D(this,function(p){switch(p.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(t=this.browserStorage.getCachedNativeRequest(),!t)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];o=t.prompt,i=sy(t,["prompt"]),o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ye.NATIVE_REQUEST)),n={method:Zi.GetToken,request:i},s=st.nowSeconds(),p.label=1;case 1:return p.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return a=p.sent(),this.validateNativeResponse(a),u=this.handleNativeResponse(a,i,s),this.browserStorage.setInteractionInProgress(!1),[2,u];case 3:throw h=p.sent(),this.browserStorage.setInteractionInProgress(!1),h;case 4:return[2]}})})},e.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},e.prototype.handleNativeResponse=function(t,o,i){return F(this,void 0,void 0,function(){var n,s,a,u,h,p;return D(this,function(f){switch(f.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),t.account.id!==o.accountId)throw Eo.createUserSwitchError();return[4,this.getDiscoveredAuthority(o.authority)];case 1:return n=f.sent(),s=n.getPreferredCache(),a=this.createIdTokenObj(t),u=this.createHomeAccountIdentifier(t,a),h=this.createAccountEntity(t,u,a,s),[4,this.generateAuthenticationResult(t,o,a,h,n.canonicalAuthority,i)];case 2:return p=f.sent(),this.cacheAccount(h),this.cacheNativeTokens(t,o,u,h,a,p.accessToken,p.tenantId,i),[2,p]}})})},e.prototype.createIdTokenObj=function(t){return new fr(t.id_token||_.EMPTY_STRING,this.browserCrypto)},e.prototype.createHomeAccountIdentifier=function(t,o){var i=Nt.generateHomeAccountId(t.client_info||_.EMPTY_STRING,wr.Default,this.logger,this.browserCrypto,o);return i},e.prototype.createAccountEntity=function(t,o,i,n){return Nt.createAccount(t.client_info,o,i,void 0,void 0,void 0,n,t.account.id)},e.prototype.generateScopes=function(t,o){return t.scope?It.fromString(t.scope):It.fromString(o.scope)},e.prototype.generatePopAccessToken=function(t,o){return F(this,void 0,void 0,function(){var i,n;return D(this,function(s){switch(s.label){case 0:if(o.tokenType!==Be.POP)return[3,2];if(t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,t.shr];if(i=new ai(this.browserCrypto),n={resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,shrNonce:o.shrNonce},!o.keyId)throw U.createKeyIdMissingError();return[4,i.signPopToken(t.access_token,o.keyId,n)];case 1:return[2,s.sent()];case 2:return[2,t.access_token]}})})},e.prototype.generateAuthenticationResult=function(t,o,i,n,s,a){return F(this,void 0,void 0,function(){var u,h,p,f,b,C,S,R;return D(this,function(N){switch(N.label){case 0:return u=this.addTelemetryFromNativeResponse(t),h=t.scope?It.fromString(t.scope):It.fromString(o.scope),p=t.account.properties||{},f=p.UID||i.claims.oid||i.claims.sub||_.EMPTY_STRING,b=p.TenantId||i.claims.tid||_.EMPTY_STRING,[4,this.generatePopAccessToken(t,o)];case 1:return C=N.sent(),S=o.tokenType===Be.POP?Be.POP:Be.BEARER,R={authority:s,uniqueId:f,tenantId:b,scopes:h.asArray(),account:n.getAccountInfo(),idToken:t.id_token,idTokenClaims:i.claims,accessToken:C,fromCache:u?this.isResponseFromCache(u):!1,expiresOn:new Date(Number(a+t.expires_in)*1e3),tokenType:S,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0},[2,R]}})})},e.prototype.cacheAccount=function(t){var o=this;this.browserStorage.setAccount(t),this.browserStorage.removeAccountContext(t).catch(function(i){o.logger.error("Error occurred while removing account context from browser storage. "+i)})},e.prototype.cacheNativeTokens=function(t,o,i,n,s,a,u,h){var p=vi.createIdTokenEntity(i,o.authority,t.id_token||_.EMPTY_STRING,o.clientId,s.claims.tid||_.EMPTY_STRING),f=o.tokenType===Be.POP?_.SHR_NONCE_VALIDITY:(typeof t.expires_in=="string"?parseInt(t.expires_in,10):t.expires_in)||0,b=h+f,C=this.generateScopes(t,o),S=yi.createAccessTokenEntity(i,o.authority,a,o.clientId,s?s.claims.tid||_.EMPTY_STRING:u,C.printScopes(),b,0,this.browserCrypto),R=new ps(n,p,S);this.nativeStorageManager.saveCacheRecord(R)},e.prototype.addTelemetryFromNativeResponse=function(t){var o=this.getMATSFromResponse(t);return o?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:o.broker_version,matsAccountJoinOnStart:o.account_join_on_start,matsAccountJoinOnEnd:o.account_join_on_end,matsDeviceJoin:o.device_join,matsPromptBehavior:o.prompt_behavior,matsApiErrorCode:o.api_error_code,matsUiVisible:o.ui_visible,matsSilentCode:o.silent_code,matsSilentBiSubCode:o.silent_bi_sub_code,matsSilentMessage:o.silent_message,matsSilentStatus:o.silent_status,matsHttpStatus:o.http_status,matsHttpEventCount:o.http_event_count},this.correlationId),o):null},e.prototype.validateNativeResponse=function(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw Eo.createUnexpectedError("Response missing expected properties.")},e.prototype.getMATSFromResponse=function(t){if(t.properties.MATS)try{return JSON.parse(t.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},e.prototype.isResponseFromCache=function(t){return typeof t.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached},e.prototype.initializeNativeRequest=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p,f,b,C=this;return D(this,function(S){switch(S.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),o=t.authority||this.config.auth.authority,t.account?[4,this.validateRequestAuthority(o,t.account)]:[3,2];case 1:S.sent(),S.label=2;case 2:return i=new Se(o),i.validateAsUri(),n=t.scopes,s=sy(t,["scopes"]),a=new It(n||[]),a.appendScopes(Yi),u=function(){switch(C.apiId){case ct.ssoSilent:case ct.acquireTokenSilent_silentFlow:return C.logger.trace("initializeNativeRequest: silent request sets prompt to none"),or.NONE}if(!t.prompt){C.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(t.prompt){case or.NONE:case or.CONSENT:case or.LOGIN:return C.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw C.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),B.createNativePromptParameterNotSupportedError()}},h=ae(ae({},s),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:i.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:u(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:ae(ae(ae({},t.extraQueryParameters),t.tokenQueryParameters),{telemetry:xl.MATS_TELEMETRY}),extendedExpiryToken:!1}),t.authenticationScheme!==Be.POP?[3,4]:(p={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},f=new ai(this.browserCrypto),[4,f.generateCnf(p)]);case 3:b=S.sent(),h.reqCnf=b.reqCnfString,h.keyId=b.kid,S.label=4;case 4:return[2,h]}})})},e}(Of);l();c();d();var ci=function(){function r(e,t,o,i){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=i,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=o,this.handshakeEvent=o.startMeasurement($.NativeMessageHandlerHandshake)}return r.prototype.sendMessage=function(e){return F(this,void 0,void 0,function(){var t,o=this;return D(this,function(i){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:xl.CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise(function(n,s){o.resolvers.set(t.responseId,{resolve:n,reject:s})})]})})},r.createProvider=function(e,t,o){return F(this,void 0,void 0,function(){var i,n;return D(this,function(s){switch(s.label){case 0:e.trace("NativeMessageHandler - createProvider called."),s.label=1;case 1:return s.trys.push([1,3,,5]),i=new r(e,t,o,xl.PREFERRED_EXTENSION_ID),[4,i.sendHandshakeRequest()];case 2:return s.sent(),[2,i];case 3:return s.sent(),n=new r(e,t,o),[4,n.sendHandshakeRequest()];case 4:return s.sent(),[2,n];case 5:return[2]}})})},r.prototype.sendHandshakeRequest=function(){return F(this,void 0,void 0,function(){var e,t=this;return D(this,function(o){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:xl.CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:{method:Zi.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(i){t.onChannelMessage(i)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise(function(i,n){t.handshakeResolvers.set(e.responseId,{resolve:i,reject:n}),t.timeoutId=window.setTimeout(function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(B.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)},t.handshakeTimeoutMs)})]})})},r.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(!(!t.channel||t.channel!==xl.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===Zi.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var o=this.handshakeResolvers.get(t.responseId);o&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),o.reject(B.createNativeExtensionNotInstalledError()))}}},r.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,o=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{var n=t.body.method;if(n===Zi.Response){if(!o)return;var s=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(s)),s.status!=="Success")o.reject(Eo.createError(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?o.reject(Eo.createError(s.result.code,s.result.description,s.result.ext)):o.resolve(s.result);else throw ee.createUnexpectedError("Event does not contain result.");this.resolvers.delete(t.responseId)}else if(n===Zi.HandshakeResponse){if(!i)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(a){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+a.toString()),this.logger.errorPii("Unable to parse "+e),o?o.reject(a):i&&i.reject(a)}},r.prototype.getExtensionId=function(){return this.extensionId},r.prototype.getExtensionVersion=function(){return this.extensionVersion},r.isNativeAvailable=function(e,t,o,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!o)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case Be.BEARER:case Be.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},r}();var _y=function(r){mt(e,r);function e(t,o,i,n,s,a,u,h,p,f){var b=r.call(this,t,o,i,n,s,a,u,p,f)||this;return b.nativeStorage=h,b}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p,f,b=this;return D(this,function(C){switch(C.label){case 0:return this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,ne.Redirect)];case 1:o=C.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||_.EMPTY_STRING,o.account||null),i=this.initializeServerTelemetryManager(ct.acquireTokenRedirect),n=function(S){S.persisted&&(b.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),b.browserStorage.cleanRequestByState(o.state),b.eventHandler.emitEvent(he.RESTORE_FROM_BFCACHE,ne.Redirect))},C.label=2;case 2:return C.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 3:return s=C.sent(),this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(i,o.authority,o.azureCloudOptions)];case 4:return a=C.sent(),this.logger.verbose("Auth code client created"),u=new Mf(a,this.browserStorage,s,this.logger,this.browserCrypto,this.performanceClient),[4,a.getAuthCodeUrl(ae(ae({},o),{nativeBroker:ci.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return h=C.sent(),p=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+p),window.addEventListener("pageshow",n),[4,u.initiateAuthRequest(h,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:p,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,C.sent()];case 7:throw f=C.sent(),f instanceof ee&&f.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),i.cacheFailedRequest(f),this.browserStorage.cleanRequestByState(o.state),f;case 8:return[2]}})})},e.prototype.handleRedirectPromise=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p,f,b,C,S;return D(this,function(R){switch(R.label){case 0:o=this.initializeServerTelemetryManager(ct.handleRedirectPromise),R.label=1;case 1:if(R.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(i=this.getRedirectResponseHash(t||window.location.hash),!i)return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(ne.Redirect),[2,null];n=void 0;try{s=Se.getDeserializedHash(i),n=this.validateAndExtractStateFromHash(s,ne.Redirect),this.logger.verbose("State extracted from hash")}catch(N){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+N),this.browserStorage.cleanRequestByInteractionType(ne.Redirect),[2,null]}return a=this.browserStorage.getTemporaryCache(Ye.ORIGIN_URI,!0)||_.EMPTY_STRING,u=Se.removeHashFromUrl(a),h=Se.removeHashFromUrl(window.location.href),u===h&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(i,n,o)]):[3,3];case 2:return p=R.sent(),a.indexOf("#")>-1&&St.replaceHash(a),[2,p];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(i,n,o)]);case 4:return!St.isInIframe()||this.config.system.allowRedirectInIframe?(this.browserStorage.setTemporaryCache(Ye.URL_HASH,i,!0),f={apiId:ct.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},b=!0,!a||a==="null"?(C=St.getHomepage(),this.browserStorage.setTemporaryCache(Ye.ORIGIN_URI,C,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(C,f)]):[3,6]):[3,9];case 5:return b=R.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+a),[4,this.navigationClient.navigateInternal(a,f)];case 7:b=R.sent(),R.label=8;case 8:if(!b)return[2,this.handleHash(i,n,o)];R.label=9;case 9:return[2,null];case 10:throw S=R.sent(),S instanceof ee&&S.setCorrelationId(this.correlationId),o.cacheFailedRequest(S),this.browserStorage.cleanRequestByInteractionType(ne.Redirect),S;case 11:return[2]}})})},e.prototype.getRedirectResponseHash=function(t){this.logger.verbose("getRedirectResponseHash called");var o=Se.hashContainsKnownProperties(t);if(o)return St.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var i=this.browserStorage.getTemporaryCache(Ye.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ye.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),i},e.prototype.handleHash=function(t,o,i){return F(this,void 0,void 0,function(){var n,s,a,u,h,p,f,b=this;return D(this,function(C){switch(C.label){case 0:if(n=this.browserStorage.getCachedRequest(o,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),s=Se.getDeserializedHash(t),s.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw B.createNativeConnectionNotEstablishedError();return a=new en(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ct.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,s.accountId,this.nativeStorage,n.correlationId),u=to.parseRequestState(this.browserCrypto,o).userRequestState,[2,a.acquireToken(ae(ae({},n),{state:u,prompt:void 0})).finally(function(){b.browserStorage.cleanRequestByState(o)})]}if(h=this.browserStorage.getCachedAuthority(o),!h)throw B.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(i,h)];case 1:return p=C.sent(),this.logger.verbose("Auth code client created"),ia.removeThrottle(this.browserStorage,this.config.auth.clientId,n),f=new Mf(p,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient),[4,f.handleCodeResponseFromHash(t,o,p.authority,this.networkClient)];case 2:return[2,C.sent()]}})})},e.prototype.logout=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h;return D(this,function(p){switch(p.label){case 0:this.logger.verbose("logoutRedirect called"),o=this.initializeLogoutRequest(t),i=this.initializeServerTelemetryManager(ct.logout),p.label=1;case 1:return p.trys.push([1,10,,11]),this.eventHandler.emitEvent(he.LOGOUT_START,ne.Redirect,t),[4,this.clearCacheOnLogout(o.account)];case 2:return p.sent(),n={apiId:ct.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,o.correlationId),[4,this.createAuthCodeClient(i,t&&t.authority)];case 3:return s=p.sent(),this.logger.verbose("Auth code client created"),a=s.getLogoutUri(o),this.eventHandler.emitEvent(he.LOGOUT_SUCCESS,ne.Redirect,o),t&&typeof t.onRedirectNavigate=="function"?(u=t.onRedirectNavigate(a),u===!1?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(a,n)])):[3,7];case 4:return p.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),p.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(a,n)];case 8:return p.sent(),[2];case 9:return[3,11];case 10:throw h=p.sent(),h instanceof ee&&h.setCorrelationId(this.correlationId),i.cacheFailedRequest(h),this.eventHandler.emitEvent(he.LOGOUT_FAILURE,ne.Redirect,null,h),this.eventHandler.emitEvent(he.LOGOUT_END,ne.Redirect),h;case 11:return this.eventHandler.emitEvent(he.LOGOUT_END,ne.Redirect),[2]}})})},e.prototype.getRedirectStartPage=function(t){var o=t||window.location.href;return Se.getAbsoluteUrl(o,St.getCurrentUri())},e}(li);l();c();d();var Ty=function(r){mt(e,r);function e(t,o,i,n,s,a,u,h,p,f){var b=r.call(this,t,o,i,n,s,a,u,p,f)||this;return b.unloadWindow=b.unloadWindow.bind(b),b.nativeStorage=h,b}return e.prototype.acquireToken=function(t){try{var o=this.generatePopupName(t.scopes||Yi,t.authority||this.config.auth.authority),i=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,o,i);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",o,i);return this.acquireTokenPopupAsync(t,o,i,n)}catch(s){return Promise.reject(s)}},e.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var o=this.initializeLogoutRequest(t),i=this.generateLogoutPopupName(o),n=t&&t.authority,s=t&&t.mainWindowRedirectUri,a=t?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(o,i,a,n,void 0,s);this.logger.verbose("asyncPopup set to false, opening popup");var u=this.openSizedPopup("about:blank",i,a);return this.logoutPopupAsync(o,i,a,n,u,s)}catch(h){return Promise.reject(h)}},e.prototype.acquireTokenPopupAsync=function(t,o,i,n){return F(this,void 0,void 0,function(){var s,a,u,h,p,f,b,C,S,R,N,ye,ie,me,yt,Ge,tt,_o=this;return D(this,function(Tr){switch(Tr.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),s=this.initializeServerTelemetryManager(ct.acquireTokenPopup),this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,ne.Popup)];case 1:a=Tr.sent(),this.browserStorage.updateCacheEntries(a.state,a.nonce,a.authority,a.loginHint||_.EMPTY_STRING,a.account||null),Tr.label=2;case 2:return Tr.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(a)];case 3:return u=Tr.sent(),this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(s,a.authority,a.azureCloudOptions)];case 4:return h=Tr.sent(),this.logger.verbose("Auth code client created"),p=ci.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),f=void 0,p&&(f=this.performanceClient.startMeasurement($.FetchAccountIdWithNativeBroker,t.correlationId)),[4,h.getAuthCodeUrl(ae(ae({},a),{nativeBroker:p}))];case 5:return b=Tr.sent(),C=new Mc(h,this.browserStorage,u,this.logger,this.performanceClient),S={popup:n,popupName:o,popupWindowAttributes:i},R=this.initiateAuthRequest(b,S),this.eventHandler.emitEvent(he.POPUP_OPENED,ne.Popup,{popupWindow:R},null),[4,this.monitorPopupForHash(R)];case 6:if(N=Tr.sent(),ye=Se.getDeserializedHash(N),ie=this.validateAndExtractStateFromHash(ye,ne.Popup,a.correlationId),ia.removeThrottle(this.browserStorage,this.config.auth.clientId,u),ye.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),f&&f.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw B.createNativeConnectionNotEstablishedError();return me=new en(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ct.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,ye.accountId,this.nativeStorage,a.correlationId),yt=to.parseRequestState(this.browserCrypto,ie).userRequestState,[2,me.acquireToken(ae(ae({},a),{state:yt,prompt:void 0})).finally(function(){_o.browserStorage.cleanRequestByState(ie)})]}return[4,C.handleCodeResponseFromHash(N,ie,h.authority,this.networkClient)];case 7:return Ge=Tr.sent(),[2,Ge];case 8:throw tt=Tr.sent(),n&&n.close(),tt instanceof ee&&tt.setCorrelationId(this.correlationId),s.cacheFailedRequest(tt),this.browserStorage.cleanRequestByState(a.state),tt;case 9:return[2]}})})},e.prototype.logoutPopupAsync=function(t,o,i,n,s,a){return F(this,void 0,void 0,function(){var u,h,p,f,b,C,S;return D(this,function(R){switch(R.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(he.LOGOUT_START,ne.Popup,t),u=this.initializeServerTelemetryManager(ct.logoutPopup),R.label=1;case 1:return R.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(t.account)];case 2:return R.sent(),this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(u,n)];case 3:return h=R.sent(),this.logger.verbose("Auth code client created"),p=h.getLogoutUri(t),this.eventHandler.emitEvent(he.LOGOUT_SUCCESS,ne.Popup,t),f=this.openPopup(p,{popupName:o,popupWindowAttributes:i,popup:s}),this.eventHandler.emitEvent(he.POPUP_OPENED,ne.Popup,{popupWindow:f},null),[4,this.waitForLogoutPopup(f)];case 4:return R.sent(),a?(b={apiId:ct.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},C=Se.getAbsoluteUrl(a,St.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+C),this.navigationClient.navigateInternal(C,b)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw S=R.sent(),s&&s.close(),S instanceof ee&&S.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(he.LOGOUT_FAILURE,ne.Popup,null,S),this.eventHandler.emitEvent(he.LOGOUT_END,ne.Popup),u.cacheFailedRequest(S),S;case 6:return this.eventHandler.emitEvent(he.LOGOUT_END,ne.Popup),[2]}})})},e.prototype.initiateAuthRequest=function(t,o){if(z.isEmpty(t))throw this.logger.error("Navigate url is empty"),B.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+t),this.openPopup(t,o)},e.prototype.monitorPopupForHash=function(t){var o=this;return new Promise(function(i,n){var s=o.config.system.windowHashTimeout/o.config.system.pollIntervalMilliseconds,a=0;o.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var u=setInterval(function(){if(t.closed){o.logger.error("PopupHandler.monitorPopupForHash - window closed"),o.cleanPopup(),clearInterval(u),n(B.createUserCancelledError());return}var h=_.EMPTY_STRING,p=_.EMPTY_STRING;try{h=t.location.href,p=t.location.hash}catch{}z.isEmpty(h)||h==="about:blank"||(o.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),a++,p?(o.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(u),o.cleanPopup(t),Se.hashContainsKnownProperties(p)?(o.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),i(p)):(o.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),o.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+p),n(B.createHashDoesNotContainKnownPropertiesError()))):a>s&&(o.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(u),n(B.createMonitorPopupTimeoutError())))},o.config.system.pollIntervalMilliseconds)})},e.prototype.waitForLogoutPopup=function(t){var o=this;return new Promise(function(i){o.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval(function(){t.closed&&(o.logger.error("PopupHandler.waitForLogoutPopup - window closed"),o.cleanPopup(),clearInterval(n),i());var s=_.EMPTY_STRING;try{s=t.location.href}catch{}z.isEmpty(s)||s==="about:blank"||(o.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),o.cleanPopup(t),i())},o.config.system.pollIntervalMilliseconds)})},e.prototype.openPopup=function(t,o){try{var i=void 0;if(o.popup?(i=o.popup,this.logger.verbosePii("Navigating popup window to: "+t),i.location.assign(t)):typeof o.popup>"u"&&(this.logger.verbosePii("Opening popup window to: "+t),i=this.openSizedPopup(t,o.popupName,o.popupWindowAttributes)),!i)throw B.createEmptyWindowCreatedError();return i.focus&&i.focus(),this.currentWindow=i,window.addEventListener("beforeunload",this.unloadWindow),i}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),B.createPopupWindowError(n.toString())}},e.prototype.openSizedPopup=function(t,o,i){var n,s,a,u,h=window.screenLeft?window.screenLeft:window.screenX,p=window.screenTop?window.screenTop:window.screenY,f=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,C=(n=i.popupSize)===null||n===void 0?void 0:n.width,S=(s=i.popupSize)===null||s===void 0?void 0:s.height,R=(a=i.popupPosition)===null||a===void 0?void 0:a.top,N=(u=i.popupPosition)===null||u===void 0?void 0:u.left;return(!C||C<0||C>f)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),C=Ur.POPUP_WIDTH),(!S||S<0||S>b)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),S=Ur.POPUP_HEIGHT),(!R||R<0||R>b)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),R=Math.max(0,b/2-Ur.POPUP_HEIGHT/2+p)),(!N||N<0||N>f)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),N=Math.max(0,f/2-Ur.POPUP_WIDTH/2+h)),window.open(t,o,"width="+C+", height="+S+", top="+R+", left="+N+", scrollbars=yes")},e.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(ne.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()},e.prototype.cleanPopup=function(t){t&&t.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},e.prototype.generatePopupName=function(t,o){return Ur.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+t.join("-")+"."+o+"."+this.correlationId},e.prototype.generateLogoutPopupName=function(t){var o=t.account&&t.account.homeAccountId;return Ur.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+o+"."+this.correlationId},e}(li);l();c();d();l();c();d();l();c();d();l();c();d();var Ey=function(){function r(){}return r.prototype.navigateInternal=function(e,t){return r.defaultNavigateWindow(e,t)},r.prototype.navigateExternal=function(e,t){return r.defaultNavigateWindow(e,t)},r.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(function(o){setTimeout(function(){o(!0)},t.timeout)})},r}();var C9=6e4,Ou=6e3,x9=3e4,k9=2e3;function F_(r,e){var t=r.auth,o=r.cache,i=r.system,n=r.telemetry,s={clientId:_.EMPTY_STRING,authority:""+_.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:_.EMPTY_STRING,authorityMetadata:_.EMPTY_STRING,redirectUri:_.EMPTY_STRING,postLogoutRedirectUri:_.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:fs.AAD,azureCloudOptions:{azureCloudInstance:Tn.None,tenant:_.EMPTY_STRING},skipAuthorityMetadataCache:!1},a={cacheLocation:zt.SessionStorage,temporaryCacheLocation:zt.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(o&&o.cacheLocation===zt.LocalStorage),claimsBasedCachingEnabled:!0},u={loggerCallback:function(){},logLevel:ir.Info,piiLoggingEnabled:!1},h=ae(ae({},If),{loggerOptions:u,networkClient:e?St.getBrowserNetworkClient():vy,navigationClient:new Ey,loadFrameTimeout:0,windowHashTimeout:i?.loadFrameTimeout||C9,iframeHashTimeout:i?.loadFrameTimeout||Ou,navigateFrameWait:e&&St.detectIEOrEdge()?500:0,redirectNavigationTimeout:x9,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:i?.nativeBrokerHandshakeTimeout||k9,pollIntervalMilliseconds:Ur.DEFAULT_POLL_INTERVAL_MS,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),p=ae(ae({},i),{loggerOptions:i?.loggerOptions||u}),f={application:{appName:_.EMPTY_STRING,appVersion:_.EMPTY_STRING}},b={auth:ae(ae({},s),t),cache:ae(ae({},a),o),system:ae(ae({},h),p),telemetry:ae(ae({},f),n)};return b}var Ff=function(r){mt(e,r);function e(t,o,i,n,s,a){var u=r.call(this,t,o,i,n,a)||this;return u.navigateFrameWait=s.navigateFrameWait,u.pollIntervalMilliseconds=s.pollIntervalMilliseconds,u}return e.prototype.initiateAuthRequest=function(t){return F(this,void 0,void 0,function(){return D(this,function(o){switch(o.label){case 0:if(this.performanceClient.addQueueMeasurement($.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),z.isEmpty(t))throw this.logger.info("Navigate url is empty"),B.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime($.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(t)]):[3,2];case 1:return[2,o.sent()];case 2:return[2,this.loadFrameSync(t)]}})})},e.prototype.monitorIframeForHash=function(t,o){var i=this;return this.performanceClient.addQueueMeasurement($.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise(function(n,s){o<Ou&&i.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+o+"ms) than the default ("+Ou+"ms). This may result in timeouts.");var a=window.performance.now(),u=a+o,h=setInterval(function(){if(window.performance.now()>u){i.removeHiddenIframe(t),clearInterval(h),s(B.createMonitorIframeTimeoutError());return}var p=_.EMPTY_STRING,f=t.contentWindow;try{p=f?f.location.href:_.EMPTY_STRING}catch{}if(!z.isEmpty(p)){var b=f?f.location.hash:_.EMPTY_STRING;if(Se.hashContainsKnownProperties(b)){i.removeHiddenIframe(t),clearInterval(h),n(b);return}}},i.pollIntervalMilliseconds)})},e.prototype.loadFrame=function(t){var o=this;return this.performanceClient.addQueueMeasurement($.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise(function(i,n){var s=o.createHiddenIframe();setTimeout(function(){if(!s){n("Unable to load iframe");return}s.src=t,i(s)},o.navigateFrameWait)})},e.prototype.loadFrameSync=function(t){var o=this.createHiddenIframe();return o.src=t,o},e.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},e.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},e}(Mc);var Iy=function(r){mt(e,r);function e(t,o,i,n,s,a,u,h,p,f,b){var C=r.call(this,t,o,i,n,s,a,h,f,b)||this;return C.apiId=u,C.nativeStorage=p,C}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a;return D(this,function(u){switch(u.label){case 0:if(this.performanceClient.addQueueMeasurement($.SilentIframeClientAcquireToken,t.correlationId),this.logger.verbose("acquireTokenByIframe called"),o=this.performanceClient.startMeasurement($.SilentIframeClientAcquireToken,t.correlationId),z.isEmpty(t.loginHint)&&z.isEmpty(t.sid)&&(!t.account||z.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==or.NONE&&t.prompt!==or.NO_SESSION)throw o.endMeasurement({success:!1}),B.createSilentPromptValueError(t.prompt);return this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(ae(ae({},t),{prompt:t.prompt||or.NONE}),ne.Silent)];case 1:i=u.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||_.EMPTY_STRING,i.account||null),n=this.initializeServerTelemetryManager(this.apiId),u.label=2;case 2:return u.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime($.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(n,i.authority,i.azureCloudOptions)];case 3:return s=u.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime($.SilentIframeClientTokenHelper,t.correlationId),[4,this.silentTokenHelper(s,i).then(function(h){return o.endMeasurement({success:!0,fromCache:!1,requestId:h.requestId}),h})];case 4:return[2,u.sent()];case 5:throw a=u.sent(),a instanceof ee&&a.setCorrelationId(this.correlationId),n.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(i.state),o.endMeasurement({errorCode:a instanceof ee&&a.errorCode||void 0,subErrorCode:a instanceof ee&&a.subError||void 0,success:!1}),a;case 6:return[2]}})})},e.prototype.logout=function(){return Promise.reject(B.createSilentLogoutUnsupportedError())},e.prototype.silentTokenHelper=function(t,o){return F(this,void 0,void 0,function(){var i,n,s,a,u,h,p,f,b,C=this;return D(this,function(S){switch(S.label){case 0:return this.performanceClient.addQueueMeasurement($.SilentIframeClientTokenHelper,o.correlationId),this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationCodeRequest,o.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 1:return i=S.sent(),this.performanceClient.setPreQueueTime($.GetAuthCodeUrl,o.correlationId),[4,t.getAuthCodeUrl(ae(ae({},o),{nativeBroker:ci.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,o.authenticationScheme)}))];case 2:return n=S.sent(),s=new Ff(t,this.browserStorage,i,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime($.SilentHandlerInitiateAuthRequest,o.correlationId),[4,s.initiateAuthRequest(n)];case 3:return a=S.sent(),this.performanceClient.setPreQueueTime($.SilentHandlerMonitorIframeForHash,o.correlationId),[4,s.monitorIframeForHash(a,this.config.system.iframeHashTimeout)];case 4:if(u=S.sent(),h=Se.getDeserializedHash(u),p=this.validateAndExtractStateFromHash(h,ne.Silent,i.correlationId),h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw B.createNativeConnectionNotEstablishedError();return f=new en(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,this.correlationId),b=to.parseRequestState(this.browserCrypto,p).userRequestState,[2,f.acquireToken(ae(ae({},o),{state:b,prompt:o.prompt||or.NONE})).finally(function(){C.browserStorage.cleanRequestByState(p)})]}return this.performanceClient.setPreQueueTime($.HandleCodeResponseFromHash,o.correlationId),[2,s.handleCodeResponseFromHash(u,p,t.authority,this.networkClient)]}})})},e}(li);l();c();d();var Ay=function(r){mt(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u=this;return D(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement($.SilentRefreshClientAcquireToken,t.correlationId),this.performanceClient.setPreQueueTime($.InitializeBaseRequest,t.correlationId),i=[ae({},t)],[4,this.initializeBaseRequest(t,t.account)];case 1:return o=ae.apply(void 0,i.concat([h.sent()])),n=this.performanceClient.startMeasurement($.SilentRefreshClientAcquireToken,o.correlationId),s=this.initializeServerTelemetryManager(ct.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(s,o.authority,o.azureCloudOptions)];case 2:return a=h.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime($.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),[2,a.acquireTokenByRefreshToken(o).then(function(p){return n.endMeasurement({success:!0,fromCache:p.fromCache,requestId:p.requestId}),p}).catch(function(p){throw p instanceof ee&&p.setCorrelationId(u.correlationId),s.cacheFailedRequest(p),n.endMeasurement({errorCode:p.errorCode,subErrorCode:p.subError,success:!1}),p})]}})})},e.prototype.logout=function(){return Promise.reject(B.createSilentLogoutUnsupportedError())},e.prototype.createRefreshTokenClient=function(t,o,i){return F(this,void 0,void 0,function(){var n;return D(this,function(s){switch(s.label){case 0:return this.performanceClient.setPreQueueTime($.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,i)];case 1:return n=s.sent(),[2,new Eu(n,this.performanceClient)]}})})},e}(li);l();c();d();var Ry=function(){function r(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return r.prototype.addEventCallback=function(e){if(typeof window<"u"){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},r.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},r.prototype.enableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},r.prototype.disableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},r.prototype.emitEvent=function(e,t,o,i){var n=this;if(typeof window<"u"){var s={eventType:e,interactionType:t||null,payload:o||null,error:i||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach(function(a,u){n.logger.verbose("Emitting event to callback "+u+": "+e),a.apply(null,[s])})}},r.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var o=JSON.parse(t);if(typeof o!="object"||!Nt.isAccountEntity(o))return;var i=Xr.toObject(new Nt,o),n=i.getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(he.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(he.ACCOUNT_REMOVED,void 0,n))}catch{return}},r}();l();c();d();l();c();d();l();c();d();var io=function(){function r(){}return r.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r}();var Df=function(){function r(e){this.cryptoObj=e}return r.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,io.decimalToHex(e[0])+io.decimalToHex(e[1])+io.decimalToHex(e[2])+io.decimalToHex(e[3])+"-"+io.decimalToHex(e[4])+io.decimalToHex(e[5])+"-"+io.decimalToHex(e[6])+io.decimalToHex(e[7])+"-"+io.decimalToHex(e[8])+io.decimalToHex(e[9])+"-"+io.decimalToHex(e[10])+io.decimalToHex(e[11])+io.decimalToHex(e[12])+io.decimalToHex(e[13])+io.decimalToHex(e[14])+io.decimalToHex(e[15])}catch{for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,n=_.EMPTY_STRING,s=0;s<36;s++)t[s]!=="-"&&t[s]!=="4"&&(i=Math.random()*16|0),t[s]==="x"?n+=o[i]:t[s]==="y"?(i&=3,i|=8,n+=o[i]):n+=t[s];return n}},r.prototype.isGuid=function(e){var t=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return t.test(e)},r}();l();c();d();l();c();d();var zo=function(){function r(){}return r.stringToUtf8Arr=function(e){for(var t,o=0,i=e.length,n=0;n<i;n++)t=e.charCodeAt(n),o+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var s=new Uint8Array(o),a=0,u=0;a<o;u++)t=e.charCodeAt(u),t<128?s[a++]=t:t<2048?(s[a++]=192+(t>>>6),s[a++]=128+(t&63)):t<65536?(s[a++]=224+(t>>>12),s[a++]=128+(t>>>6&63),s[a++]=128+(t&63)):t<2097152?(s[a++]=240+(t>>>18),s[a++]=128+(t>>>12&63),s[a++]=128+(t>>>6&63),s[a++]=128+(t&63)):t<67108864?(s[a++]=248+(t>>>24),s[a++]=128+(t>>>18&63),s[a++]=128+(t>>>12&63),s[a++]=128+(t>>>6&63),s[a++]=128+(t&63)):(s[a++]=252+(t>>>30),s[a++]=128+(t>>>24&63),s[a++]=128+(t>>>18&63),s[a++]=128+(t>>>12&63),s[a++]=128+(t>>>6&63),s[a++]=128+(t&63));return s},r.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),o=new Uint8Array(t),i=0;i<e.length;i++)o[i]=e.charCodeAt(i);return t},r.utf8ArrToString=function(e){for(var t=_.EMPTY_STRING,o=void 0,i=e.length,n=0;n<i;n++)o=e[n],t+=String.fromCharCode(o>251&&o<254&&n+5<i?(o-252)*1073741824+(e[++n]-128<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>247&&o<252&&n+4<i?(o-248<<24)+(e[++n]-128<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>239&&o<248&&n+3<i?(o-240<<18)+(e[++n]-128<<12)+(e[++n]-128<<6)+e[++n]-128:o>223&&o<240&&n+2<i?(o-224<<12)+(e[++n]-128<<6)+e[++n]-128:o>191&&o<224&&n+1<i?(o-192<<6)+e[++n]-128:o);return t},r.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},r}();var Lf=function(){function r(){}return r.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,_.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},r.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,_.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},r.prototype.encode=function(e){var t=zo.stringToUtf8Arr(e);return this.base64EncArr(t)},r.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,o=_.EMPTY_STRING,i=void 0,n=e.length,s=0,a=0;a<n;a++)i=a%3,s|=e[a]<<(16>>>i&24),(i===2||e.length-a===1)&&(o+=String.fromCharCode(this.uint6ToB64(s>>>18&63),this.uint6ToB64(s>>>12&63),this.uint6ToB64(s>>>6&63),this.uint6ToB64(s&63)),s=0);return t===0?o:o.substring(0,o.length-t)+(t===1?"=":"==")},r.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:e===62?43:e===63?47:65},r}();l();c();d();var D_=function(){function r(){}return r.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var o=this.base64DecToArr(t);return zo.utf8ArrToString(o)},r.prototype.base64DecToArr=function(e,t){for(var o=e.replace(/[^A-Za-z0-9\+\/]/g,_.EMPTY_STRING),i=o.length,n=t?Math.ceil((i*3+1>>>2)/t)*t:i*3+1>>>2,s=new Uint8Array(n),a=void 0,u=void 0,h=0,p=0,f=0;f<i;f++)if(u=f&3,h|=this.b64ToUint6(o.charCodeAt(f))<<18-6*u,u===3||i-f===1){for(a=0;a<3&&p<n;a++,p++)s[p]=h>>>(16>>>a&24)&255;h=0}return s},r.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:e===43?62:e===47?63:0},r}();l();c();d();var S9=32,L_=function(){function r(e){this.base64Encode=new Lf,this.cryptoObj=e}return r.prototype.generateCodes=function(){return F(this,void 0,void 0,function(){var e,t;return D(this,function(o){switch(o.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=o.sent(),[2,{verifier:e,challenge:t}]}})})},r.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(S9);this.cryptoObj.getRandomValues(e);var t=this.base64Encode.urlEncodeArr(e);return t}catch(o){throw B.createPkceNotGeneratedError(o)}},r.prototype.generateCodeChallengeFromVerifier=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=i.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw o=i.sent(),B.createPkceNotGeneratedError(o);case 3:return[2]}})})},r}();l();c();d();l();c();d();var N_=function(){function r(){}return r.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,window.crypto.subtle.generateKey(e,t,o)]})})},r.prototype.exportKey=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){return[2,window.crypto.subtle.exportKey(gs,e)]})})},r.prototype.importKey=function(e,t,o,i){return F(this,void 0,void 0,function(){return D(this,function(n){return[2,window.crypto.subtle.importKey(gs,e,t,o,i)]})})},r.prototype.sign=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,window.crypto.subtle.sign(e,t,o)]})})},r.prototype.digest=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,window.crypto.subtle.digest(e,t)]})})},r}();l();c();d();var H_=function(){function r(){}return r.prototype.initPrng=function(e){return window.msrCrypto.initPrng(Tc(e))},r.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,window.msrCrypto.subtle.generateKey(e,t,o)]})})},r.prototype.exportKey=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){return[2,window.msrCrypto.subtle.exportKey(gs,e)]})})},r.prototype.importKey=function(e,t,o,i){return F(this,void 0,void 0,function(){return D(this,function(n){return[2,window.msrCrypto.subtle.importKey(gs,e,t,o,i)]})})},r.prototype.sign=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,window.msrCrypto.subtle.sign(e,t,o)]})})},r.prototype.digest=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,window.msrCrypto.subtle.digest(e,t)]})})},r}();l();c();d();var U_=function(){function r(){}return r.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},r.prototype.generateKey=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,new Promise(function(n,s){var a=window.msCrypto.subtle.generateKey(e,t,o);a.addEventListener("complete",function(u){n(u.target.result)}),a.addEventListener("error",function(u){s(u)})})]})})},r.prototype.exportKey=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){return[2,new Promise(function(o,i){var n=window.msCrypto.subtle.exportKey(gs,e);n.addEventListener("complete",function(s){var a=s.target.result,u=zo.utf8ArrToString(new Uint8Array(a)).replace(/\r/g,_.EMPTY_STRING).replace(/\n/g,_.EMPTY_STRING).replace(/\t/g,_.EMPTY_STRING).split(" ").join(_.EMPTY_STRING).replace("\0",_.EMPTY_STRING);try{o(JSON.parse(u))}catch(h){i(h)}}),n.addEventListener("error",function(s){i(s)})})]})})},r.prototype.importKey=function(e,t,o,i){return F(this,void 0,void 0,function(){var n,s;return D(this,function(a){return n=zo.getSortedObjectString(e),s=zo.stringToArrayBuffer(n),[2,new Promise(function(u,h){var p=window.msCrypto.subtle.importKey(gs,s,t,o,i);p.addEventListener("complete",function(f){u(f.target.result)}),p.addEventListener("error",function(f){h(f)})})]})})},r.prototype.sign=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,new Promise(function(n,s){var a=window.msCrypto.subtle.sign(e,t,o);a.addEventListener("complete",function(u){n(u.target.result)}),a.addEventListener("error",function(u){s(u)})})]})})},r.prototype.digest=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,new Promise(function(i,n){var s=window.msCrypto.subtle.digest(e,t.buffer);s.addEventListener("complete",function(a){i(a.target.result)}),s.addEventListener("error",function(a){n(a)})})]})})},r}();var _9="RSASSA-PKCS1-v1_5",B_="SHA-256",T9=2048,E9=new Uint8Array([1,0,1]),Nf=function(){function r(e,t){var o,i;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new N_;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new U_;else if(this.hasMsrCrypto()&&(!((o=this.cryptoOptions)===null||o===void 0)&&o.useMsrCrypto))this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new H_;else throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),B.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(!((i=this.cryptoOptions)===null||i===void 0)&&i.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),vs.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:_9,hash:B_,modulusLength:T9,publicExponent:E9}}return r.prototype.hasIECrypto=function(){return"msCrypto"in window},r.prototype.hasBrowserCrypto=function(){return"crypto"in window},r.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},r.prototype.sha256Digest=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){return t=zo.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:B_},t)]})})},r.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},r.prototype.generateKeyPair=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]})})},r.prototype.exportJwk=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){return[2,this.subtleCrypto.exportKey(e)]})})},r.prototype.importJwk=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,o)]})})},r.prototype.sign=function(e,t){return F(this,void 0,void 0,function(){return D(this,function(o){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]})})},r}();l();c();d();l();c();d();l();c();d();var z_=function(){function r(){this.dbName=Pf,this.version=R_,this.tableName=P_,this.dbOpen=!1}return r.prototype.open=function(){return F(this,void 0,void 0,function(){var e=this;return D(this,function(t){return[2,new Promise(function(o,i){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",function(s){var a=s;a.target.result.createObjectStore(e.tableName)}),n.addEventListener("success",function(s){var a=s;e.db=a.target.result,e.dbOpen=!0,o()}),n.addEventListener("error",function(){return i(B.createDatabaseUnavailableError())})})]})})},r.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},r.prototype.validateDbIsOpen=function(){return F(this,void 0,void 0,function(){return D(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}})})},r.prototype.getItem=function(e){return F(this,void 0,void 0,function(){var t=this;return D(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(B.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readonly"),a=s.objectStore(t.tableName),u=a.get(e);u.addEventListener("success",function(h){var p=h;t.closeConnection(),i(p.target.result)}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.setItem=function(e,t){return F(this,void 0,void 0,function(){var o=this;return D(this,function(i){switch(i.label){case 0:return[4,this.validateDbIsOpen()];case 1:return i.sent(),[2,new Promise(function(n,s){if(!o.db)return s(B.createDatabaseNotOpenError());var a=o.db.transaction([o.tableName],"readwrite"),u=a.objectStore(o.tableName),h=u.put(t,e);h.addEventListener("success",function(){o.closeConnection(),n()}),h.addEventListener("error",function(p){o.closeConnection(),s(p)})})]}})})},r.prototype.removeItem=function(e){return F(this,void 0,void 0,function(){var t=this;return D(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(B.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readwrite"),a=s.objectStore(t.tableName),u=a.delete(e);u.addEventListener("success",function(){t.closeConnection(),i()}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.getKeys=function(){return F(this,void 0,void 0,function(){var e=this;return D(this,function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise(function(o,i){if(!e.db)return i(B.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly"),s=n.objectStore(e.tableName),a=s.getAllKeys();a.addEventListener("success",function(u){var h=u;e.closeConnection(),o(h.target.result)}),a.addEventListener("error",function(u){e.closeConnection(),i(u)})})]}})})},r.prototype.containsKey=function(e){return F(this,void 0,void 0,function(){var t=this;return D(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(i,n){if(!t.db)return n(B.createDatabaseNotOpenError());var s=t.db.transaction([t.tableName],"readonly"),a=s.objectStore(t.tableName),u=a.count(e);u.addEventListener("success",function(h){var p=h;t.closeConnection(),i(p.target.result===1)}),u.addEventListener("error",function(h){t.closeConnection(),n(h)})})]}})})},r.prototype.deleteDatabase=function(){return F(this,void 0,void 0,function(){return D(this,function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise(function(t,o){var i=window.indexedDB.deleteDatabase(Pf);i.addEventListener("success",function(){return t(!0)}),i.addEventListener("blocked",function(){return t(!0)}),i.addEventListener("error",function(){return o(!1)})})]})})},r}();var Py=function(){function r(e,t){this.inMemoryCache=new Au,this.indexedDBCache=new z_,this.logger=e,this.storeName=t}return r.prototype.handleDatabaseAccessError=function(e){if(e instanceof B&&e.errorCode===q.databaseUnavailable.code)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e},r.prototype.getItem=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){switch(i.label){case 0:if(t=this.inMemoryCache.getItem(e),t)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,i.sent()];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}})})},r.prototype.setItem=function(e,t){return F(this,void 0,void 0,function(){var o;return D(this,function(i){switch(i.label){case 0:this.inMemoryCache.setItem(e,t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return i.sent(),[3,4];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2]}})})},r.prototype.removeItem=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){switch(o.label){case 0:this.inMemoryCache.removeItem(e),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return o.sent(),[3,4];case 3:return t=o.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}})})},r.prototype.getKeys=function(){return F(this,void 0,void 0,function(){var e,t;return D(this,function(o){switch(o.label){case 0:if(e=this.inMemoryCache.getKeys(),e.length!==0)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,o.sent()];case 3:return t=o.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}})})},r.prototype.containsKey=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){switch(i.label){case 0:if(t=this.inMemoryCache.containsKey(e),t)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,i.sent()];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}})})},r.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},r.prototype.clearPersistent=function(){return F(this,void 0,void 0,function(){var e,t;return D(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return e=o.sent(),e&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=o.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}})})},r}();var Hf;(function(r){r.asymmetricKeys="asymmetricKeys",r.symmetricKeys="symmetricKeys"})(Hf||(Hf={}));var V_=function(){function r(e){this.logger=e,this.asymmetricKeys=new Py(this.logger,Hf.asymmetricKeys),this.symmetricKeys=new Py(this.logger,Hf.symmetricKeys)}return r.prototype.clear=function(){return F(this,void 0,void 0,function(){var e;return D(this,function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return e=t.sent(),e instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}})})},r}();var Mu=function(){function r(e,t,o){this.logger=e,this.browserCrypto=new Nf(this.logger,o),this.b64Encode=new Lf,this.b64Decode=new D_,this.guidGenerator=new Df(this.browserCrypto),this.pkceGenerator=new L_(this.browserCrypto),this.cache=new V_(this.logger),this.performanceClient=t}return r.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},r.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},r.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},r.prototype.generatePkceCodes=function(){return F(this,void 0,void 0,function(){return D(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},r.prototype.getPublicKeyThumbprint=function(e){var t;return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p;return D(this,function(f){switch(f.label){case 0:return o=(t=this.performanceClient)===null||t===void 0?void 0:t.startMeasurement($.CryptoOptsGetPublicKeyThumbprint,e.correlationId),[4,this.browserCrypto.generateKeyPair(r.EXTRACTABLE,r.POP_KEY_USAGES)];case 1:return i=f.sent(),[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return n=f.sent(),s={e:n.e,kty:n.kty,n:n.n},a=zo.getSortedObjectString(s),[4,this.hashString(a)];case 3:return u=f.sent(),[4,this.browserCrypto.exportJwk(i.privateKey)];case 4:return h=f.sent(),[4,this.browserCrypto.importJwk(h,!1,["sign"])];case 5:return p=f.sent(),[4,this.cache.asymmetricKeys.setItem(u,{privateKey:p,publicKey:i.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri})];case 6:return f.sent(),o&&o.endMeasurement({success:!0}),[2,u]}})})},r.prototype.removeTokenBindingKey=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){switch(o.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return o.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return t=o.sent(),[2,!t]}})})},r.prototype.clearKeystore=function(){return F(this,void 0,void 0,function(){return D(this,function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}})})},r.prototype.signJwt=function(e,t,o){var i;return F(this,void 0,void 0,function(){var n,s,a,u,h,p,f,b,C,S,R,N,ye;return D(this,function(ie){switch(ie.label){case 0:return n=(i=this.performanceClient)===null||i===void 0?void 0:i.startMeasurement($.CryptoOptsSignJwt,o),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(s=ie.sent(),!s)throw B.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(s.publicKey)];case 2:return a=ie.sent(),u=zo.getSortedObjectString(a),h=this.b64Encode.urlEncode(JSON.stringify({kid:t})),p=by.getShrHeaderString({kid:h,alg:a.alg}),f=this.b64Encode.urlEncode(p),e.cnf={jwk:JSON.parse(u)},b=this.b64Encode.urlEncode(JSON.stringify(e)),C=f+"."+b,S=zo.stringToArrayBuffer(C),[4,this.browserCrypto.sign(s.privateKey,S)];case 3:return R=ie.sent(),N=this.b64Encode.urlEncodeArr(new Uint8Array(R)),ye=C+"."+N,n&&n.endMeasurement({success:!0}),[2,ye]}})})},r.prototype.hashString=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){switch(i.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=i.sent(),o=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(o)]}})})},r.POP_KEY_USAGES=["sign","verify"],r.EXTRACTABLE=!0,r}();l();c();d();l();c();d();var Uf=function(){function r(e,t){this.correlationId=t,this.measureName=r.makeMeasureName(e,t),this.startMark=r.makeStartMark(e,t),this.endMark=r.makeEndMark(e,t)}return r.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},r.makeStartMark=function(e,t){return"msal.start."+e+"."+t},r.makeEndMark=function(e,t){return"msal.end."+e+"."+t},r.supportsBrowserPerformance=function(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.mark=="function"&&typeof window.performance.measure=="function"&&typeof window.performance.clearMarks=="function"&&typeof window.performance.clearMeasures=="function"&&typeof window.performance.getEntriesByName=="function"},r.flushMeasurements=function(e,t){if(r.supportsBrowserPerformance())try{t.forEach(function(o){var i=r.makeMeasureName(o.name,e),n=window.performance.getEntriesByName(i,"measure");n.length>0&&(window.performance.clearMeasures(i),window.performance.clearMarks(r.makeStartMark(i,e)),window.performance.clearMarks(r.makeEndMark(i,e)))})}catch{}},r.prototype.startMeasurement=function(){if(r.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch{}},r.prototype.endMeasurement=function(){if(r.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch{}},r.prototype.flushMeasurement=function(){if(r.supportsBrowserPerformance())try{var e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){var t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch{}return null},r}();var $y=function(r){mt(e,r);function e(t,o,i,n,s,a,u){var h=r.call(this,t,o,i,n,s,a)||this;return h.browserCrypto=new Nf(h.logger,u),h.guidGenerator=new Df(h.browserCrypto),h}return e.prototype.startPerformanceMeasuremeant=function(t,o){return new Uf(t,o)},e.prototype.generateId=function(){return this.guidGenerator.generateGuid()},e.prototype.getPageVisibility=function(){var t;return((t=document.visibilityState)===null||t===void 0?void 0:t.toString())||null},e.prototype.deleteIncompleteSubMeasurements=function(t){var o=this.eventsByCorrelationId.get(t.event.correlationId),i=o&&o.eventId===t.event.eventId,n=[];i&&o?.incompleteSubMeasurements&&o.incompleteSubMeasurements.forEach(function(s){n.push(ae({},s))}),n.length>0&&Uf.flushMeasurements(t.event.correlationId,n)},e.prototype.supportsBrowserPerformanceNow=function(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.now=="function"},e.prototype.startMeasurement=function(t,o){var i=this,n=this.getPageVisibility(),s=r.prototype.startMeasurement.call(this,t,o);return ae(ae({},s),{endMeasurement:function(a){var u=s.endMeasurement(ae({startPageVisibility:n,endPageVisibility:i.getPageVisibility()},a));return i.deleteIncompleteSubMeasurements(s),u},discardMeasurement:function(){s.discardMeasurement(),i.deleteIncompleteSubMeasurements(s),s.measurement.flushMeasurement()}})},e.prototype.setPreQueueTime=function(t,o){if(!this.supportsBrowserPerformanceNow()){this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+t);return}if(!o){this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to set telemetry queue time");return}var i=this.preQueueTimeByCorrelationId.get(o);i&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+i.name+" found",o),this.addQueueMeasurement(i.name,o,void 0,!0)),this.preQueueTimeByCorrelationId.set(o,{name:t,time:window.performance.now()})},e.prototype.addQueueMeasurement=function(t,o,i,n){if(!this.supportsBrowserPerformanceNow()){this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t);return}if(!o){this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");return}var s=r.prototype.getPreQueueTime.call(this,t,o);if(s){var a=window.performance.now(),u=i||r.prototype.calculateQueuedTime.call(this,s,a);return r.prototype.addQueueMeasurement.call(this,t,o,u,n)}},e}(Iu);l();c();d();l();c();d();l();c();d();var q_=function(){function r(e,t,o,i){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=o,this.cryptoObj=i}return r.prototype.loadExternalTokens=function(e,t,o){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw B.createUnableToLoadTokenError("Please ensure server response includes id token.");var i=new fr(t.id_token,this.cryptoObj),n,s;if(e.account){var a=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new ps(a,this.loadIdToken(i,a.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,a.homeAccountId,e.account.environment,e.account.tenantId,o),this.loadRefreshToken(e,t,a.homeAccountId,e.account.environment))}else if(e.authority){var u=ms.generateAuthority(e.authority,e.azureCloudOptions),h={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(s=new ms(u,this.config.system.networkClient,this.storage,h,this.logger),o.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");var a=this.loadAccount(i,s.hostnameAndPort,o.clientInfo,s.authorityType);n=new ps(a,this.loadIdToken(i,a.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,t,a.homeAccountId,s.hostnameAndPort,s.tenant,o),this.loadRefreshToken(e,t,a.homeAccountId,s.hostnameAndPort))}else if(t.client_info){this.logger.trace("TokenCache - homeAccountId from response");var a=this.loadAccount(i,s.hostnameAndPort,t.client_info,s.authorityType);n=new ps(a,this.loadIdToken(i,a.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,t,a.homeAccountId,s.hostnameAndPort,s.tenant,o),this.loadRefreshToken(e,t,a.homeAccountId,s.hostnameAndPort))}else throw B.createUnableToLoadTokenError("Please provide clientInfo in the response or options.")}else throw B.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");return this.generateAuthenticationResult(e,i,n,s)},r.prototype.loadAccount=function(e,t,o,i,n){var s;if(n?s=n:i!==void 0&&o&&(s=Nt.generateHomeAccountId(o,i,this.logger,this.cryptoObj,e)),!s)throw B.createUnableToLoadTokenError("Unexpected missing homeAccountId");var a=o?Nt.createAccount(o,s,e,void 0,void 0,void 0,t):Nt.createGenericAccount(s,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(a),a;throw B.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadIdToken=function(e,t,o,i){var n=vi.createIdTokenEntity(t,o,e.rawToken,this.config.auth.clientId,i);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(n),n;throw B.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadAccessToken=function(e,t,o,i,n,s){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw B.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!s.extendedExpiresOn)throw B.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var a=new It(e.scopes).printScopes(),u=s.expiresOn||t.expires_in+new Date().getTime()/1e3,h=s.extendedExpiresOn,p=yi.createAccessTokenEntity(o,i,t.access_token,this.config.auth.clientId,n,a,u,h,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(p),p;throw B.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.loadRefreshToken=function(e,t,o,i){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var n=In.createRefreshTokenEntity(o,i,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(n),n;throw B.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},r.prototype.generateAuthenticationResult=function(e,t,o,i){var n,s,a,u=_.EMPTY_STRING,h=[],p=null,f;o?.accessToken&&(u=o.accessToken.secret,h=It.fromString(o.accessToken.target).asArray(),p=new Date(Number(o.accessToken.expiresOn)*1e3),f=new Date(Number(o.accessToken.extendedExpiresOn)*1e3));var b=t?.claims.oid||t?.claims.sub||_.EMPTY_STRING,C=t?.claims.tid||_.EMPTY_STRING;return{authority:i?i.canonicalAuthority:_.EMPTY_STRING,uniqueId:b,tenantId:C,scopes:h,account:o?.account?o.account.getAccountInfo():null,idToken:t?t.rawToken:_.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:u,fromCache:!0,expiresOn:p,correlationId:e.correlationId||_.EMPTY_STRING,requestId:_.EMPTY_STRING,extExpiresOn:f,familyId:_.EMPTY_STRING,tokenType:((n=o?.accessToken)===null||n===void 0?void 0:n.tokenType)||_.EMPTY_STRING,state:_.EMPTY_STRING,cloudGraphHostName:((s=o?.account)===null||s===void 0?void 0:s.cloudGraphHostName)||_.EMPTY_STRING,msGraphHost:((a=o?.account)===null||a===void 0?void 0:a.msGraphHost)||_.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},r}();l();c();d();l();c();d();var G_=function(r){mt(e,r);function e(t){var o=r.call(this,t)||this;return o.includeRedirectUri=!1,o}return e}(Tu);var j_=function(r){mt(e,r);function e(t,o,i,n,s,a,u,h,p,f){var b=r.call(this,t,o,i,n,s,a,h,p,f)||this;return b.apiId=u,b}return e.prototype.acquireToken=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h;return D(this,function(p){switch(p.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw B.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime($.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,ne.Silent)];case 1:o=p.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||_.EMPTY_STRING,o.account||null),i=this.initializeServerTelemetryManager(this.apiId),p.label=2;case 2:return p.trys.push([2,4,,5]),n=ae(ae({},o),{code:t.code}),this.performanceClient.setPreQueueTime($.StandardInteractionClientGetClientConfiguration,t.correlationId),[4,this.getClientConfiguration(i,o.authority)];case 3:return s=p.sent(),a=new G_(s),this.logger.verbose("Auth code client created"),u=new Ff(a,this.browserStorage,n,this.logger,this.config.system,this.performanceClient),[2,u.handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},o.state,a.authority,this.networkClient,!1)];case 4:throw h=p.sent(),h instanceof ee&&h.setCorrelationId(this.correlationId),i.cacheFailedRequest(h),this.browserStorage.cleanRequestByState(o.state),h;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(B.createSilentLogoutUnsupportedError())},e}(li);var K_=function(){function r(e){this.isBrowserEnvironment=typeof window<"u",this.config=F_(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new _n(this.config.system.loggerOptions,Oc,Xi),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new $y(this.config.auth.clientId,this.config.auth.authority,this.logger,Oc,Xi,this.config.telemetry.application,this.config.system.cryptoOptions):new Cy(this.config.auth.clientId,this.config.auth.authority,this.logger,Oc,Xi,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Mu(this.logger,this.performanceClient,this.config.system.cryptoOptions):ra,this.eventHandler=new Ry(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Ru(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):$_(this.config.auth.clientId,this.logger);var t={cacheLocation:zt.MemoryStorage,temporaryCacheLocation:zt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};this.nativeInternalStorage=new Ru(this.config.auth.clientId,t,this.browserCrypto,this.logger),this.tokenCache=new q_(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return r.prototype.initialize=function(){return F(this,void 0,void 0,function(){var e,t,o,i,n;return D(this,function(s){switch(s.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement($.InitializeClientApplication),this.eventHandler.emitEvent(he.INITIALIZE_START),!e)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),o=this,[4,ci.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return o.nativeExtensionProvider=s.sent(),[3,4];case 3:return i=s.sent(),this.logger.verbose(i),[3,4];case 4:return this.config.cache.claimsBasedCachingEnabled?[3,6]:(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),n=this.performanceClient.startMeasurement($.ClearTokensAndKeysWithClaims),[4,this.browserStorage.clearTokensAndKeysWithClaims()]);case 5:s.sent(),n.endMeasurement({success:!0}),s.label=6;case 6:return this.initialized=!0,this.eventHandler.emitEvent(he.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}})})},r.prototype.handleRedirectPromise=function(e){return F(this,void 0,void 0,function(){var t,o,i,n,s,a,u,h,p=this;return D(this,function(f){return this.logger.verbose("handleRedirectPromise called"),St.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(o=e||_.EMPTY_STRING,i=this.redirectResponse.get(o),typeof i>"u"?(this.eventHandler.emitEvent(he.HANDLE_REDIRECT_START,ne.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),n=this.browserStorage.getCachedNativeRequest(),s=void 0,n&&ci.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),a=new en(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ct.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId),s=a.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),u=this.browserStorage.getTemporaryCache(Ye.CORRELATION_ID,!0)||_.EMPTY_STRING,h=this.createRedirectClient(u),s=h.handleRedirectPromise(e)),i=s.then(function(b){if(b){var C=t.length<p.getAllAccounts().length;C?(p.eventHandler.emitEvent(he.LOGIN_SUCCESS,ne.Redirect,b),p.logger.verbose("handleRedirectResponse returned result, login success")):(p.eventHandler.emitEvent(he.ACQUIRE_TOKEN_SUCCESS,ne.Redirect,b),p.logger.verbose("handleRedirectResponse returned result, acquire token success"))}return p.eventHandler.emitEvent(he.HANDLE_REDIRECT_END,ne.Redirect),b}).catch(function(b){throw t.length>0?p.eventHandler.emitEvent(he.ACQUIRE_TOKEN_FAILURE,ne.Redirect,null,b):p.eventHandler.emitEvent(he.LOGIN_FAILURE,ne.Redirect,null,b),p.eventHandler.emitEvent(he.HANDLE_REDIRECT_END,ne.Redirect),b}),this.redirectResponse.set(o,i)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,i]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},r.prototype.acquireTokenRedirect=function(e){return F(this,void 0,void 0,function(){var t,o,i,n,s,a=this;return D(this,function(u){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(ne.Redirect),o=this.getAllAccounts().length>0,o?this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_START,ne.Redirect,e):this.eventHandler.emitEvent(he.LOGIN_START,ne.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(n=new en(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ct.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),i=n.acquireTokenRedirect(e).catch(function(h){if(h instanceof Eo&&h.isFatal()){a.nativeExtensionProvider=void 0;var p=a.createRedirectClient(e.correlationId);return p.acquireToken(e)}else if(h instanceof xr){a.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");var p=a.createRedirectClient(e.correlationId);return p.acquireToken(e)}throw a.browserStorage.setInteractionInProgress(!1),h})):(s=this.createRedirectClient(e.correlationId),i=s.acquireToken(e)),[2,i.catch(function(h){throw o?a.eventHandler.emitEvent(he.ACQUIRE_TOKEN_FAILURE,ne.Redirect,null,h):a.eventHandler.emitEvent(he.LOGIN_FAILURE,ne.Redirect,null,h),h})]})})},r.prototype.acquireTokenPopup=function(e){var t=this,o=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement($.AcquireTokenPopup,o);try{this.logger.verbose("acquireTokenPopup called",o),this.preflightBrowserEnvironmentCheck(ne.Popup)}catch(u){return Promise.reject(u)}var n=this.getAllAccounts();n.length>0?this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_START,ne.Popup,e):this.eventHandler.emitEvent(he.LOGIN_START,ne.Popup,e);var s;if(this.canUseNative(e))s=this.acquireTokenNative(e,ct.acquireTokenPopup).then(function(u){return t.browserStorage.setInteractionInProgress(!1),i.endMeasurement({success:!0,isNativeBroker:!0,requestId:u.requestId}),u}).catch(function(u){if(u instanceof Eo&&u.isFatal()){t.nativeExtensionProvider=void 0;var h=t.createPopupClient(e.correlationId);return h.acquireToken(e)}else if(u instanceof xr){t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");var h=t.createPopupClient(e.correlationId);return h.acquireToken(e)}throw t.browserStorage.setInteractionInProgress(!1),u});else{var a=this.createPopupClient(e.correlationId);s=a.acquireToken(e)}return s.then(function(u){var h=n.length<t.getAllAccounts().length;return h?t.eventHandler.emitEvent(he.LOGIN_SUCCESS,ne.Popup,u):t.eventHandler.emitEvent(he.ACQUIRE_TOKEN_SUCCESS,ne.Popup,u),i.addStaticFields({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),i.endMeasurement({success:!0,requestId:u.requestId}),u}).catch(function(u){return n.length>0?t.eventHandler.emitEvent(he.ACQUIRE_TOKEN_FAILURE,ne.Popup,null,u):t.eventHandler.emitEvent(he.LOGIN_FAILURE,ne.Popup,null,u),i.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),Promise.reject(u)})},r.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},r.prototype.ssoSilent=function(e){var t;return F(this,void 0,void 0,function(){var o,i,n,s,a=this;return D(this,function(u){return o=this.getRequestCorrelationId(e),i=ae(ae({},e),{prompt:e.prompt,correlationId:o}),this.preflightBrowserEnvironmentCheck(ne.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement($.SsoSilent,o),(t=this.ssoSilentMeasurement)===null||t===void 0||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",o),this.eventHandler.emitEvent(he.SSO_SILENT_START,ne.Silent,i),this.canUseNative(i)?n=this.acquireTokenNative(i,ct.ssoSilent).catch(function(h){if(h instanceof Eo&&h.isFatal()){a.nativeExtensionProvider=void 0;var p=a.createSilentIframeClient(i.correlationId);return p.acquireToken(i)}throw h}):(s=this.createSilentIframeClient(i.correlationId),n=s.acquireToken(i)),[2,n.then(function(h){var p,f;return a.eventHandler.emitEvent(he.SSO_SILENT_SUCCESS,ne.Silent,h),(p=a.ssoSilentMeasurement)===null||p===void 0||p.addStaticFields({accessTokenSize:h.accessToken.length,idTokenSize:h.idToken.length}),(f=a.ssoSilentMeasurement)===null||f===void 0||f.endMeasurement({success:!0,isNativeBroker:h.fromNativeBroker,requestId:h.requestId}),h}).catch(function(h){var p;throw a.eventHandler.emitEvent(he.SSO_SILENT_FAILURE,ne.Silent,null,h),(p=a.ssoSilentMeasurement)===null||p===void 0||p.endMeasurement({errorCode:h.errorCode,subErrorCode:h.subError,success:!1}),h}).finally(function(){document.removeEventListener("visibilitychange",a.trackPageVisibilityWithMeasurement)})]})})},r.prototype.acquireTokenByCode=function(e){return F(this,void 0,void 0,function(){var t,o,i,n,s=this;return D(this,function(a){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(ne.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_BY_CODE_START,ne.Silent,e),o=this.performanceClient.startMeasurement($.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw B.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return i=e.code,n=this.hybridAuthCodeResponses.get(i),n?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),o.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),n=this.acquireTokenByCodeAsync(ae(ae({},e),{correlationId:t})).then(function(u){return s.eventHandler.emitEvent(he.ACQUIRE_TOKEN_BY_CODE_SUCCESS,ne.Silent,u),s.hybridAuthCodeResponses.delete(i),o.addStaticFields({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),o.endMeasurement({success:!0,isNativeBroker:u.fromNativeBroker,requestId:u.requestId}),u}).catch(function(u){throw s.hybridAuthCodeResponses.delete(i),s.eventHandler.emitEvent(he.ACQUIRE_TOKEN_BY_CODE_FAILURE,ne.Silent,null,u),o.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),u}),this.hybridAuthCodeResponses.set(i,n)),[2,n];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,ct.acquireTokenByCode,e.nativeAccountId).catch(function(u){throw u instanceof Eo&&u.isFatal()&&(s.nativeExtensionProvider=void 0),u})];throw B.createUnableToAcquireTokenFromNativePlatformError()}else throw B.createAuthCodeOrNativeAccountIdRequiredError()}catch(u){throw this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_BY_CODE_FAILURE,ne.Silent,null,u),o.endMeasurement({errorCode:u instanceof ee&&u.errorCode||void 0,subErrorCode:u instanceof ee&&u.subError||void 0,success:!1}),u}return[2]})})},r.prototype.acquireTokenByCodeAsync=function(e){var t;return F(this,void 0,void 0,function(){var o,i,n=this;return D(this,function(s){switch(s.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement($.AcquireTokenByCodeAsync,e.correlationId),(t=this.acquireTokenByCodeAsyncMeasurement)===null||t===void 0||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),o=this.createSilentAuthCodeClient(e.correlationId),[4,o.acquireToken(e).then(function(a){var u;return(u=n.acquireTokenByCodeAsyncMeasurement)===null||u===void 0||u.endMeasurement({success:!0,fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker,requestId:a.requestId}),a}).catch(function(a){var u;throw(u=n.acquireTokenByCodeAsyncMeasurement)===null||u===void 0||u.endMeasurement({errorCode:a.errorCode,subErrorCode:a.subError,success:!1}),a}).finally(function(){document.removeEventListener("visibilitychange",n.trackPageVisibilityWithMeasurement)})];case 1:return i=s.sent(),[2,i]}})})},r.prototype.acquireTokenFromCache=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){switch(this.performanceClient.addQueueMeasurement($.AcquireTokenFromCache,t.correlationId),o.cacheLookupPolicy){case oo.Default:case oo.AccessToken:case oo.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw U.createRefreshRequiredError()}return[2]})})},r.prototype.acquireTokenByRefreshToken=function(e,t){return F(this,void 0,void 0,function(){var o;return D(this,function(i){switch(this.performanceClient.addQueueMeasurement($.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case oo.Default:case oo.AccessTokenAndRefreshToken:case oo.RefreshToken:case oo.RefreshTokenAndNetwork:return o=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime($.SilentRefreshClientAcquireToken,e.correlationId),[2,o.acquireToken(e)];default:throw U.createRefreshRequiredError()}return[2]})})},r.prototype.acquireTokenBySilentIframe=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){return this.performanceClient.addQueueMeasurement($.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime($.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]})})},r.prototype.logout=function(e){return F(this,void 0,void 0,function(){var t;return D(this,function(o){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(ae({correlationId:t},e))]})})},r.prototype.logoutRedirect=function(e){return F(this,void 0,void 0,function(){var t,o;return D(this,function(i){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(ne.Redirect),o=this.createRedirectClient(t),[2,o.logout(e)]})})},r.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);this.preflightBrowserEnvironmentCheck(ne.Popup);var o=this.createPopupClient(t);return o.logout(e)}catch(i){return Promise.reject(i)}},r.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},r.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},r.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},r.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},r.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},r.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},r.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(t===void 0&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),St.blockNonBrowserEnvironment(this.isBrowserEnvironment),St.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),St.blockReloadInHiddenIframes(),St.blockAcquireTokenInPopups(),St.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===ne.Redirect&&this.config.cache.cacheLocation===zt.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw vs.createInMemoryRedirectUnavailableError();(e===ne.Redirect||e===ne.Popup)&&this.preflightInteractiveRequest(t)},r.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),St.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},r.prototype.acquireTokenNative=function(e,t,o){return F(this,void 0,void 0,function(){var i;return D(this,function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw B.createNativeConnectionNotEstablishedError();return i=new en(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,o||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),[2,i.acquireToken(e)]})})},r.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!ci.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case or.NONE:case or.CONSENT:case or.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0},r.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},r.prototype.createPopupClient=function(e){return new Ty(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createRedirectClient=function(e){return new _y(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createSilentIframeClient=function(e){return new Iy(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ct.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},r.prototype.createSilentCacheClient=function(e){return new $u(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.createSilentRefreshClient=function(e){return new Ay(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.createSilentAuthCodeClient=function(e){return new j_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ct.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},r.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},r.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},r.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},r.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},r.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},r.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},r.prototype.getTokenCache=function(){return this.tokenCache},r.prototype.getLogger=function(){return this.logger},r.prototype.setLogger=function(e){this.logger=e},r.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},r.prototype.setNavigationClient=function(e){this.navigationClient=e},r.prototype.getConfiguration=function(){return this.config},r.prototype.getRequestCorrelationId=function(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():_.EMPTY_STRING},r}();var Oy=function(r){mt(e,r);function e(t){var o=r.call(this,t)||this;return o.astsAsyncMeasurement=void 0,o.activeSilentTokenRequests=new Map,o.trackPageVisibility=o.trackPageVisibility.bind(o),o}return e.prototype.loginRedirect=function(t){return F(this,void 0,void 0,function(){var o;return D(this,function(i){return o=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",o),[2,this.acquireTokenRedirect(ae({correlationId:o},t||ky))]})})},e.prototype.loginPopup=function(t){var o=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",o),this.acquireTokenPopup(ae({correlationId:o},t||ky))},e.prototype.acquireTokenSilent=function(t){return F(this,void 0,void 0,function(){var o,i,n,s,a,u,h,p=this;return D(this,function(f){if(o=this.getRequestCorrelationId(t),i=this.performanceClient.startMeasurement($.AcquireTokenSilent,o),i.addStaticFields({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(ne.Silent),this.logger.verbose("acquireTokenSilent called",o),n=t.account||this.getActiveAccount(),!n)throw B.createNoAccountError();return s={clientId:this.config.auth.clientId,authority:t.authority||_.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:n.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},a=JSON.stringify(s),u=this.activeSilentTokenRequests.get(a),typeof u>"u"?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",o),this.performanceClient.setPreQueueTime($.AcquireTokenSilentAsync,o),h=this.acquireTokenSilentAsync(ae(ae({},t),{correlationId:o}),n).then(function(b){return p.activeSilentTokenRequests.delete(a),i.addStaticFields({accessTokenSize:b.accessToken.length,idTokenSize:b.idToken.length}),i.endMeasurement({success:!0,fromCache:b.fromCache,isNativeBroker:b.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:b.requestId}),b}).catch(function(b){throw p.activeSilentTokenRequests.delete(a),i.endMeasurement({errorCode:b.errorCode,subErrorCode:b.subError,success:!1}),b}),this.activeSilentTokenRequests.set(a,h),[2,h]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",o),i.discardMeasurement(),[2,u])})})},e.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},e.prototype.acquireTokenSilentAsync=function(t,o){var i;return F(this,void 0,void 0,function(){var n,s,a,u,h,p=this;return D(this,function(f){switch(f.label){case 0:return this.performanceClient.addQueueMeasurement($.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_START,ne.Silent,t),this.astsAsyncMeasurement=this.performanceClient.startMeasurement($.AcquireTokenSilentAsync,t.correlationId),(i=this.astsAsyncMeasurement)===null||i===void 0||i.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),ci.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&o.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),s=ae(ae({},t),{account:o}),n=this.acquireTokenNative(s,ct.acquireTokenSilent_silentFlow).catch(function(b){return F(p,void 0,void 0,function(){var C;return D(this,function(S){if(b instanceof Eo&&b.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,C=this.createSilentIframeClient(t.correlationId),[2,C.acquireToken(t)];throw b})})}),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),a=this.createSilentCacheClient(t.correlationId),this.performanceClient.setPreQueueTime($.InitializeSilentRequest,t.correlationId),[4,a.initializeSilentRequest(t,o)];case 2:u=f.sent(),h=ae(ae({},t),{cacheLookupPolicy:t.cacheLookupPolicy||oo.Default}),this.performanceClient.setPreQueueTime($.AcquireTokenFromCache,u.correlationId),n=this.acquireTokenFromCache(a,u,h).catch(function(b){if(h.cacheLookupPolicy===oo.AccessToken)throw b;return St.blockReloadInHiddenIframes(),p.eventHandler.emitEvent(he.ACQUIRE_TOKEN_NETWORK_START,ne.Silent,u),p.performanceClient.setPreQueueTime($.AcquireTokenByRefreshToken,u.correlationId),p.acquireTokenByRefreshToken(u,h).catch(function(C){var S=C instanceof eo,R=C instanceof xr,N=C.errorCode===An.noTokensFoundError.code,ye=C.errorCode===Ur.INVALID_GRANT_ERROR;if((!S||!ye||R||h.cacheLookupPolicy===oo.AccessTokenAndRefreshToken||h.cacheLookupPolicy===oo.RefreshToken)&&h.cacheLookupPolicy!==oo.Skip&&!N)throw C;return p.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),p.performanceClient.setPreQueueTime($.AcquireTokenBySilentIframe,u.correlationId),p.acquireTokenBySilentIframe(u)})}),f.label=3;case 3:return[2,n.then(function(b){var C;return p.eventHandler.emitEvent(he.ACQUIRE_TOKEN_SUCCESS,ne.Silent,b),(C=p.astsAsyncMeasurement)===null||C===void 0||C.endMeasurement({success:!0,fromCache:b.fromCache,isNativeBroker:b.fromNativeBroker,requestId:b.requestId}),b}).catch(function(b){var C;throw p.eventHandler.emitEvent(he.ACQUIRE_TOKEN_FAILURE,ne.Silent,null,b),(C=p.astsAsyncMeasurement)===null||C===void 0||C.endMeasurement({errorCode:b.errorCode,subErrorCode:b.subError,success:!1}),b}).finally(function(){document.removeEventListener("visibilitychange",p.trackPageVisibility)})]}})})},e}(K_);l();c();d();l();c();d();var A9=function(){function r(){}return r.getInteractionStatusFromEvent=function(e,t){switch(e.eventType){case he.LOGIN_START:return Hr.Login;case he.SSO_SILENT_START:return Hr.SsoSilent;case he.ACQUIRE_TOKEN_START:if(e.interactionType===ne.Redirect||e.interactionType===ne.Popup)return Hr.AcquireToken;break;case he.HANDLE_REDIRECT_START:return Hr.HandleRedirect;case he.LOGOUT_START:return Hr.Logout;case he.SSO_SILENT_SUCCESS:case he.SSO_SILENT_FAILURE:if(t&&t!==Hr.SsoSilent)break;return Hr.None;case he.LOGOUT_END:if(t&&t!==Hr.Logout)break;return Hr.None;case he.HANDLE_REDIRECT_END:if(t&&t!==Hr.HandleRedirect)break;return Hr.None;case he.LOGIN_SUCCESS:case he.LOGIN_FAILURE:case he.ACQUIRE_TOKEN_SUCCESS:case he.ACQUIRE_TOKEN_FAILURE:case he.RESTORE_FROM_BFCACHE:if(e.interactionType===ne.Redirect||e.interactionType===ne.Popup){if(t&&t!==Hr.Login&&t!==Hr.AcquireToken)break;return Hr.None}break}return null},r}();l();c();d();var R9=function(){function r(e,t){var o=t&&t.loggerOptions||{};this.logger=new _n(o,Oc,Xi),this.cryptoOps=new Mu(this.logger),this.popTokenGenerator=new ai(this.cryptoOps),this.shrParameters=e}return r.prototype.generatePublicKeyThumbprint=function(){return F(this,void 0,void 0,function(){var e;return D(this,function(t){switch(t.label){case 0:return[4,this.popTokenGenerator.generateKid(this.shrParameters)];case 1:return e=t.sent().kid,[2,e]}})})},r.prototype.signRequest=function(e,t,o){return F(this,void 0,void 0,function(){return D(this,function(i){return[2,this.popTokenGenerator.signPayload(e,t,this.shrParameters,o)]})})},r.prototype.removeKeys=function(e){return F(this,void 0,void 0,function(){return D(this,function(t){switch(t.label){case 0:return[4,this.cryptoOps.removeTokenBindingKey(e)];case 1:return[2,t.sent()]}})})},r}();var Fu=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},My;(function(r){r.SELECT_ACCOUNT="select_account",r.LOGIN="login",r.CONSENT="consent"})(My||(My={}));var Bf=class extends Ka{get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}get isMultiAccountDisabled(){return!this.isMultipleAccountEnabled}set isMultiAccountDisabled(e){this.isMultipleAccountEnabled=!e}get isMultiAccountSupportedAndEnabled(){return this.isMultipleAccountEnabled}get sessionStorageRequestedScopesKey(){return"mgt-requested-scopes"}get sessionStorageDeniedScopesKey(){return"mgt-denied-scopes"}get homeAccountKey(){return"275f3731-e4a4-468a-bf9c-baca24b31e26"}constructor(e){super(),this.isMultipleAccountEnabled=!0,this.handleMsalEvent=t=>{t.eventType==="msal:acquireTokenSuccess"&&"scopes"in t.payload&&(this.approvedScopes=t.payload.scopes)},this.initProvider(e)}initProvider(e){return Fu(this,void 0,void 0,function*(){let t=e.options||{auth:{clientId:""}};if(this.ms_config=t,this.ms_config.cache=t.cache||{},this.ms_config.cache.cacheLocation=t.cache.cacheLocation||"localStorage",(typeof this.ms_config.cache.storeAuthStateInCookie>"u"||this.ms_config.cache.storeAuthStateInCookie===null)&&(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,e.authority&&(this.ms_config.auth.authority=e.authority),e.redirectUri&&(this.ms_config.auth.redirectUri=e.redirectUri),"clientId"in e)if(e.clientId)this.ms_config.auth.clientId=e.clientId,this._publicClientApplication=new Oy(this.ms_config);else throw new Error("clientId must be provided");else if("publicClientApplication"in e)if(e.publicClientApplication)this._publicClientApplication=e.publicClientApplication;else throw new Error("publicClientApplication must be provided");else throw new Error("either clientId or publicClientApplication must be provided");this._publicClientApplication.addEventCallback(this.handleMsalEvent),yield this._publicClientApplication.initialize(),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,this._loginType=typeof e.loginType<"u"?e.loginType:Xn.Redirect,this._loginHint=typeof e.loginHint<"u"?e.loginHint:null,this._sid=typeof e.sid<"u"?e.sid:null,this.isIncrementalConsentDisabled=typeof e.isIncrementalConsentDisabled<"u"?e.isIncrementalConsentDisabled:!1,this._domainHint=typeof e.domainHint<"u"?e.domainHint:null,this.scopes=typeof e.scopes<"u"?e.scopes:["user.read"],this._prompt=typeof e.prompt<"u"?e.prompt:My.SELECT_ACCOUNT;let o=e;this.isMultipleAccountEnabled=typeof o.isMultiAccountEnabled<"u"?o.isMultiAccountEnabled:!0,this.baseURL=typeof o.baseURL<"u"?o.baseURL:this.baseURL,this.customHosts=o.customHosts,this.graph=C0(this);try{let i=yield this._publicClientApplication.handleRedirectPromise();i!==null?this.handleResponse(i?.account):yield this.trySilentSignIn()}catch(i){throw console.error("\u{1F992}: Problem attempting to sign in",i),i}})}trySilentSignIn(){return Fu(this,void 0,void 0,function*(){let e={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){e.sid=this._sid,e.loginHint=this._loginHint;try{this.setState(oe.Loading);let t=yield this._publicClientApplication.ssoSilent(e);t&&this.handleResponse(t?.account)}catch{this.setState(oe.SignedOut)}}else{let t=this.getAccount();if(t&&(yield this.getAccessToken(null))){this.handleResponse(t);return}this.setState(oe.SignedOut)}})}login(){return Fu(this,void 0,void 0,function*(){let e={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType===Xn.Popup)try{let t=yield this._publicClientApplication.loginPopup(e);this.handleResponse(t?.account)}catch(t){switch(!0){case(t instanceof B&&t.errorCode==="user_cancelled"):console.warn("\u{1F992}: User cancelled the login flow."),this.setState(oe.SignedOut);break;case(t instanceof B&&t.errorCode==="interaction_in_progress"):console.warn("\u{1F992}: Login already in progess. Close the popup to login again."),this.setState(oe.SignedOut);break;default:throw console.error("\u{1F992}: Error occurred during login:",t),t}}else{let t=Object.assign({},e);yield this._publicClientApplication.loginRedirect(t)}})}getAllAccounts(){let e=[];return this._publicClientApplication.getAllAccounts().forEach(t=>{e.push({name:t.name,mail:t.username,id:t.homeAccountId})}),e}setActiveAccount(e){let t=this._publicClientApplication.getAccountByHomeId(e.id),o=this._publicClientApplication.getActiveAccount(),i=this.getStoredAccount();i&&t&&o&&i.homeAccountId===t.homeAccountId&&o.homeAccountId===t.homeAccountId||(this._publicClientApplication.setActiveAccount(t),this.setStoredAccount(),super.setActiveAccount(e))}getActiveAccount(){let e=this._publicClientApplication.getActiveAccount();if(e)return{name:e.name,mail:e.username,id:e.homeAccountId,tenantId:e.tenantId}}handleResponse(e){e!==null?(this.setActiveAccount({name:e.name,id:e.homeAccountId,mail:e.username}),this.setState(oe.SignedIn)):this.setState(oe.SignedOut),this.clearRequestedScopes()}storage(){switch(this.ms_config.cache.cacheLocation){case"localStorage":return window.localStorage;case"sessionStorage":default:return window.sessionStorage}}setStoredAccount(){this.clearStoredAccount(),this.storage().setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){let e=this.storage().getItem(this.homeAccountKey);return this._publicClientApplication.getAccountByHomeId(e)}clearStoredAccount(){this.storage().removeItem(this.homeAccountKey)}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let o=t.indexOf("openid");o!==-1&&t.splice(o,1),o=t.indexOf("profile"),o!==-1&&t.splice(o,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){let e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){let t=this.getDeniedScopes();if(t&&t.filter(o=>e.indexOf(o)!==-1).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){let e=this.getStoredAccount();return e||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return Fu(this,void 0,void 0,function*(){let t={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType===Xn.Redirect?(this.setState(oe.SignedOut),yield this._publicClientApplication.logoutRedirect(t)):(yield this._publicClientApplication.logoutPopup(Object.assign({},t)),this._publicClientApplication.getAllAccounts.length===1||!this.isMultipleAccountEnabled?this.setState(oe.SignedOut):yield this.trySilentSignIn())})}getAccessToken(e){var t;return Fu(this,void 0,void 0,function*(){let o=!((t=e?.scopes)===null||t===void 0)&&t.length?e.scopes:this.scopes,i={scopes:o,account:this.getAccount()};try{let n=i;return(yield this._publicClientApplication.acquireTokenSilent(n)).accessToken}catch(n){if(n instanceof xr){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===Xn.Redirect)if(!this.areScopesDenied(o))this.setRequestedScopes(o),yield this._publicClientApplication.acquireTokenRedirect(i);else throw n;else try{return(yield this._publicClientApplication.acquireTokenPopup(i)).accessToken}catch(s){throw console.error("\u{1F992}: problem with pop-up sign in",s),s}}else this.setState(oe.SignedOut)}throw null})}};l();c();d();var W_="9aeac104-a6b6-45ca-bb7c-bf7c3083eeb2";var Fy="mgt/setProvider",Q_="blank.html";ge();l();c();d();l();c();d();l();c();d();l();c();d();l();c();d();l();c();d();xe();gt();ge();ys();un();l();c();d();xe();var r6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size, 24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size, 12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size, 20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size, 12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--person-avatar-size:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:rgb(255,255,255)!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:rgb(0,0,0)!important}}
`];l();c();d();ge();var o6=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},ux=(r,e,t)=>o6(void 0,void 0,void 0,function*(){let o=r.api(e).middlewareOptions(be(t)).orderby("start/dateTime");return ls.create(r,o)}),i6=(r,e,t,o)=>o6(void 0,void 0,void 0,function*(){let i=`startdatetime=${e.toISOString()}`,n=`enddatetime=${t.toISOString()}`,s=o?`groups/${o}/calendar/calendarview?${i}&${n}`:`me/calendarview?${i}&${n}`;return ux(r,s,o?["Group.Read.All","Group.ReadWrite.All"]:["Calendars.ReadBasic","Calendars.Read","Calendars.ReadWrite"])});Yr();l();c();d();xe();gt();sc();Bs();vv();Ua();ge();ys();Cv();l();c();d();xe();var n6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .people-list .people-person{--person-avatar-size:var(--people-person-avatar-size, 24px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size, 12px);font-weight:var(--people-overflow-font-weight,400)}
`];un();var Bi=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},zi=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},gD=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},cc=()=>{Lo(),Re("people",Fr)},Fr=class extends it{static get styles(){return n6}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...pt.requiredScopes])]}constructor(){super(),this.personCardInteraction="hover",this.version="v1.0",this.scopes=[],this._peoplePresence={},this._arrowKeyLocation=-1,this.renderContent=()=>!this.people||this.people.length===0?this.renderNoData():this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople(),this.renderLoading=()=>this.renderTemplate("loading",null)||x``,this.handleKeyDown=e=>{let t=this.shadowRoot.querySelector(".people-list"),o,i=t?.children,n=e.key;for(let u of i){let h=u;h.removeAttribute("tabindex"),o=h?.querySelector("mgt-person"),o=o?.shadowRoot.querySelector(".person-root"),o?.removeAttribute("tabindex"),h.blur()}e.target===t&&(n==="Tab"||n==="Escape")&&(this._arrowKeyLocation=-1,t?.blur());let s=t?.childElementCount,a=t?.querySelector(".overflow");if(a&&(a=a,a.removeAttribute("tabindex"),s--),n==="ArrowRight")this._arrowKeyLocation=(this._arrowKeyLocation+1+s)%s;else if(n==="ArrowLeft")this._arrowKeyLocation=(this._arrowKeyLocation-1+s)%s;else if(["Enter","space"," "].includes(n)&&this.personCardInteraction!=="none"){let h=i[this._arrowKeyLocation].querySelector("mgt-person");h&&h.showPersonCard()}this._arrowKeyLocation>-1&&(o=i[this._arrowKeyLocation],o.setAttribute("tabindex","0"),o.focus(),o=o.querySelector(".people-person"),o?.shadowRoot.querySelector(".person-root").setAttribute("tabindex","0"))},this.showMax=3}clearState(){this.people=null}args(){return[this.providerState,this.groupId,this.userIds,this.peopleQueries,this.showMax,this.resource,this.version,this.fallbackDetails]}updated(e){super.updated(e),this.checkPeopleListAndFireEvent()}checkPeopleListAndFireEvent(){var e;let t=(e=this.shadowRoot)===null||e===void 0?void 0:e.querySelector(".people-list");t?.childElementCount>0&&this.fireCustomEvent("people-rendered")}renderPeople(){let e=this.people.slice(0,this.showMax).filter(t=>t);return x`
      <ul
        tabindex="0"
        class="people-list"
        aria-label="people"
        @keydown=${this.handleKeyDown}>
        ${co(e,t=>t.id?t.id:t.displayName,t=>x`
            <li class="people-person">
              ${this.renderPerson(t)}
            </li>
          `)}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){let e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||x`
        <li aria-label="and ${e} more attendees" class="overflow"><span>+${e}</span></li>
      `}renderPerson(e){let t={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]);let o="small";return this.renderTemplate("person",{person:e},e.id)||Te`
        <mgt-person
          .personDetails=${e}
          .fetchImage=${!0}
          .avatarSize=${o}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${t}
          .usage=${"people"}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||x``}loadState(){return gD(this,void 0,void 0,function*(){if(!this.people){let e=V.globalProvider;if(e&&e.state===oe.SignedIn){let t=e.graph.forComponent(this);this.groupId?this.people=yield tc(t,null,this.groupId,this.showMax,"person"):this.userIds?this.people=yield Xl(t,this.userIds,"","",this.fallbackDetails):this.peopleQueries?this.people=yield Z3(t,this.peopleQueries,this.fallbackDetails):this.resource?this.people=yield Q3(t,this.version,this.resource,this.scopes):this.people=yield mv(t),this.showPresence?this._peoplePresence=yield iP(t,this.people):this._peoplePresence=null}}})}};Bi([E({attribute:"group-id",type:String}),zi("design:type",String)],Fr.prototype,"groupId",void 0);Bi([E({attribute:"user-ids",converter:(r,e)=>r.split(",").map(t=>t.trim())}),zi("design:type",Array)],Fr.prototype,"userIds",void 0);Bi([E({attribute:"people",type:Object}),zi("design:type",Array)],Fr.prototype,"people",void 0);Bi([E({attribute:"people-queries",converter:(r,e)=>r.split(",").map(t=>t.trim())}),zi("design:type",Array)],Fr.prototype,"peopleQueries",void 0);Bi([E({attribute:"show-max",type:Number}),zi("design:type",Number)],Fr.prototype,"showMax",void 0);Bi([E({attribute:"show-presence",type:Boolean}),zi("design:type",Boolean)],Fr.prototype,"showPresence",void 0);Bi([E({attribute:"person-card",converter:(r,e)=>Rd(r,"hover")}),zi("design:type",String)],Fr.prototype,"personCardInteraction",void 0);Bi([E({attribute:"resource",type:String}),zi("design:type",String)],Fr.prototype,"resource",void 0);Bi([E({attribute:"version",type:String}),zi("design:type",Object)],Fr.prototype,"version",void 0);Bi([E({attribute:"scopes",converter:r=>r?r.toLowerCase().split(","):null,reflect:!0}),zi("design:type",Array)],Fr.prototype,"scopes",void 0);Bi([E({attribute:"fallback-details",type:Array}),zi("design:type",Array)],Fr.prototype,"fallbackDetails",void 0);Bi([X(),zi("design:type",Object)],Fr.prototype,"_arrowKeyLocation",void 0);Mr();cr();pi();ge();var js=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Ks=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},hx=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},px=()=>{at(ln),cc(),Re("agenda",Vi)},Vi=class extends it{constructor(){super(...arguments),this.days=3,this.renderContent=()=>{if(!this.events||this.events.length===0)return this.renderNoData();let e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});if(t)return t;let o={agenda:!0,grouped:this.groupByDay};return x`
      <div dir=${this.direction} class="${ze(o)}">
        ${this.groupByDay?this.renderGroups(e):this.renderEvents(e)}
      </div>
    `},this.renderLoading=()=>this.renderTemplate("loading",null)||x`
        <fluent-card class="event event-loading">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </fluent-card>`,this.onResize=()=>{this._isNarrow=this.offsetWidth<600}}static get styles(){return r6}static get requiredScopes(){return[...new Set(["calendars.read",...Fr.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}reload(){return hx(this,void 0,void 0,function*(){this.events=yield this.loadEvents()})}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||x``}renderEvent(e){this._isNarrow=this.offsetWidth<600;let t={narrow:this._isNarrow};return x`
      <fluent-card class="${ze(Object.assign({event:!0},t))}">
        <div class="${ze(Object.assign({"event-time-container":!0},t))}">
          <div class="event-time" aria-label="${this.getEventTimeString(e)}">${this.getEventTimeString(e)}</div>
        </div>
        <div class="${ze(Object.assign({"event-details-container":!0},t))}">
          ${this.renderTitle(e)} ${this.renderLocation(e)} ${this.renderAttendees(e)}
        </div>
        <div class="event-other-container">${this.renderOther(e)}</div>
      </fluent-card>
    `}renderHeader(e){return this.renderTemplate("header",{header:e},"header-"+e)||x`
        <div class="header" aria-label="${e}">${e}</div>
      `}renderTitle(e){return x`
      <div
        aria-label=${e.subject}
        class="${ze({"event-subject":!0,narrow:this._isNarrow})}"
      >
        ${e.subject}
      </div>`}renderLocation(e){return e.location.displayName?x`
      <div class="event-location-container">
        <div class="event-location-icon">${Z(P.OfficeLocation)}</div>
        <div class="event-location" aria-label="${e.location.displayName}">${e.location.displayName}</div>
      </div>
    `:null}renderAttendees(e){return e.attendees.length?Te`
      <mgt-people
        show-max="5"
        show-presence
        class="event-attendees"
        .peopleQueries=${e.attendees.map(t=>t.emailAddress.address)}
      ></mgt-people>
    `:null}renderOther(e){return this.hasTemplate("event-other")?x`
          ${this.renderTemplate("event-other",{event:e},e.id+"-other")}
        `:null}renderGroups(e){let t={};return e.forEach(o=>{var i;let n=(i=o?.start)===null||i===void 0?void 0:i.dateTime;o.end.timeZone==="UTC"&&(n+="Z");let s=this.getDateHeaderFromDateTimeString(n);t[s]=t[s]||[],t[s].push(o)}),x`
      ${Object.keys(t).map(o=>x`
            <div class="group">${this.renderHeader(o)} ${this.renderEvents(t[o])}</div>
          `)}
    `}renderEvents(e){return x`
        ${e.map(t=>x`
              <div
                class="event-container"
                tabindex="0"
                @focus=${()=>this.eventClicked(t)}>
                ${this.renderTemplate("event",{event:t},t.id)||this.renderEvent(t)}
              </div>`)}`}args(){return[this.providerState,this.preferredTimezone,this.eventQuery,this.date,this.groupId,this.days]}loadState(){return hx(this,void 0,void 0,function*(){if(this.events)return;let e=yield this.loadEvents();e?.length>0&&(this.events=e)})}eventClicked(e){this.fireCustomEvent("eventClick",e)}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";let t=e.start.dateTime;e.start.timeZone==="UTC"&&(t+="Z");let o=e.end.dateTime;e.end.timeZone==="UTC"&&(o+="Z");let i=this.prettyPrintTimeFromDateTime(new Date(t)),n=this.prettyPrintTimeFromDateTime(new Date(o));return`${i} - ${n}`}loadEvents(){return hx(this,void 0,void 0,function*(){let e=V.globalProvider,t=[];if(e?.state===oe.SignedIn){let o=e.graph.forComponent(this);if(this.eventQuery)try{let i=this.eventQuery.split("|"),n,s;i.length>1?(s=i[0].trim(),n=i[1].trim()):s=this.eventQuery;let a=yield ux(o,s,n?[n]:[]);if(a?.value)for(t=a.value;a.hasNext;)yield a.next(),t=a.value}catch{}else{let i=this.date?new Date(this.date):new Date,n=new Date(i.getTime());n.setDate(i.getDate()+this.days);try{let s=yield i6(o,i,n,this.groupId);if(s?.value)for(t=s.value;s.hasNext;)yield s.next(),t=s.value}catch{}}}return t})}prettyPrintTimeFromDateTime(e){return e.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}getDateHeaderFromDateTimeString(e){return new Date(e).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}};js([E({attribute:"date",type:String}),Ks("design:type",String)],Vi.prototype,"date",void 0);js([E({attribute:"group-id",type:String}),Ks("design:type",String)],Vi.prototype,"groupId",void 0);js([E({attribute:"days",type:Number}),Ks("design:type",Object)],Vi.prototype,"days",void 0);js([E({attribute:"event-query",type:String}),Ks("design:type",String)],Vi.prototype,"eventQuery",void 0);js([E({attribute:"events",type:Array,hasChanged:(r,e)=>r!==e}),Ks("design:type",Array)],Vi.prototype,"events",void 0);js([E({attribute:"show-max",type:Number}),Ks("design:type",Number)],Vi.prototype,"showMax",void 0);js([E({attribute:"group-by-day",type:Boolean}),Ks("design:type",Boolean)],Vi.prototype,"groupByDay",void 0);js([E({attribute:"preferred-timezone",type:String}),Ks("design:type",String)],Vi.prototype,"preferredTimezone",void 0);js([E({attribute:!1}),Ks("design:type",Boolean)],Vi.prototype,"_isNarrow",void 0);Od();Av();l();c();d();xe();gt();Cd();ge();l();c();d();var s6={comboboxPlaceholder:"Select an item"};cr();Mr();ys();l();c();d();xe();gt();ge();_d();Pd();Ni();ge();var Qn=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Yn=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},vD=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Dd=r=>Array.isArray(r?.value),yD=["json","image"],bD=r=>typeof r=="string"&&yD.includes(r),wD=(r,e="json")=>bD(r)?r:e,CD=r=>r||W.config.response.invalidationPeriod||W.config.defaultInvalidationPeriod,fx=()=>W.config.response.isEnabled&&W.config.isEnabled,dc=()=>Re("get",mi),mi=class extends it{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type="json",this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1,this.renderLoading=()=>{let e=this.renderTemplate("loading",null);return Dd(this.response)?this.renderValueContentWithDefaultTemplate(x`${this.response.value.map(t=>this.renderTemplate("value",t,t.id))} ${e} `):e},this.renderContent=()=>{if(this.hasTemplate("value")&&Dd(this.response)){let e=Dd(this.response)?x`
          ${this.response.value.map(t=>this.renderTemplate("value",t,t.id))}
        `:this.renderTemplate("value",this.response);return this.renderValueContentWithDefaultTemplate(e)}else return this.response?this.renderTemplate("default",this.response)||x``:this.hasTemplate("no-data")?this.renderTemplate("no-data",null):x``}}refresh(e=!1){this.isRefreshing=!0,e&&this.clearState(),this._task.run()}clearState(){this.response=null}args(){return[this.providerState,this.resource,this.scopes,this.version,this.pollingRate,this.type,this.maxPages,this.cacheEnabled,this.cacheInvalidationPeriod]}renderValueContentWithDefaultTemplate(e){var t,o;if(this.hasTemplate("default")){let i=this.renderTemplate("default",this.response);return((o=(t=this.templates.value)===null||t===void 0?void 0:t.templateOrder)!==null&&o!==void 0?o:999)>this.templates.default.templateOrder?x`
          ${i}${e}
        `:x`
          ${e}${i}
        `}else return e}loadState(){var e,t,o;return vD(this,void 0,void 0,function*(){let i=V.globalProvider;if(this.error=null,!(!i||i.state!==oe.SignedIn)){if(this.resource){try{let n,s=`${this.version}${this.resource}`,a=null;if(this.shouldRetrieveCache()){n=W.getCache(H.get,H.get.stores.responses);let u=fx()?yield n.getValue(s):null;u&&CD(this.cacheInvalidationPeriod)>Date.now()-u.timeCached&&(a=JSON.parse(u.response))}if(!a){let u=this.resource,h=!1;!((e=this.response)===null||e===void 0)&&e["@odata.deltaLink"]?(u=this.response["@odata.deltaLink"],h=!0):h=new URL(u,"https://graph.microsoft.com").pathname.endsWith("delta");let p=i.graph.forComponent(this),f=p.api(u).version(this.version);if(!((t=this.scopes)===null||t===void 0)&&t.length&&(f=f.middlewareOptions(be(this.scopes))),this.type==="json"){if(a=yield f.get(),h&&Dd(this.response)&&Dd(a)){let b=a.value;a.value=this.response.value.concat(b)}if(!this.isPolling&&!as(this.response,a)&&(this.response=a),Dd(a)&&a["@odata.nextLink"]){let b=1,C=a;for(;(b<this.maxPages||this.maxPages<=0||h&&this.pollingRate)&&C?.["@odata.nextLink"];){b++;let S=C["@odata.nextLink"].split(this.version)[1];C=yield p.api(S).version(this.version).get(),!((o=C?.value)===null||o===void 0)&&o.length&&(C.value=a.value.concat(C.value),a=C,this.isPolling||(this.response=a))}}}else{if(this.resource.indexOf("/photo/$value")===-1&&this.resource.indexOf("/thumbnails/")===-1)throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");let b;if(this.resource.indexOf("/photo/$value")>-1){let C=this.resource.replace("/photo/$value",""),S=yield Vs(p,C,this.scopes);S&&(b=S.photo)}else if(this.resource.indexOf("/thumbnails/")>-1){let C=yield VP(p,this.resource,this.scopes);C&&(b=C.thumbnail)}b&&(a={image:b})}this.shouldUpdateCache()&&a&&(n=W.getCache(H.get,H.get.stores.responses),yield n.putValue(s,{response:JSON.stringify(a)}))}as(this.response,a)||(this.response=a)}catch(n){this.error=n}this.response&&(this.error=null,this.pollingRate&&setTimeout(()=>{this.isPolling=!0,this.loadState().finally(()=>{this.isPolling=!1})},this.pollingRate))}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error},!0,!1,!0)}})}shouldRetrieveCache(){return fx()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return fx()&&this.cacheEnabled}};Qn([E({attribute:"resource",reflect:!0,type:String}),Yn("design:type",String)],mi.prototype,"resource",void 0);Qn([E({attribute:"scopes",converter:(r,e)=>r?r.toLowerCase().split(","):null,reflect:!0}),Yn("design:type",Array)],mi.prototype,"scopes",void 0);Qn([E({attribute:"version",reflect:!0,type:String}),Yn("design:type",Object)],mi.prototype,"version",void 0);Qn([E({attribute:"type",reflect:!0,type:String,converter:r=>wD(r,"json")}),Yn("design:type",String)],mi.prototype,"type",void 0);Qn([E({attribute:"max-pages",reflect:!0,type:Number}),Yn("design:type",Object)],mi.prototype,"maxPages",void 0);Qn([E({attribute:"polling-rate",reflect:!0,type:Number}),Yn("design:type",Object)],mi.prototype,"pollingRate",void 0);Qn([E({attribute:"cache-enabled",reflect:!0,type:Boolean}),Yn("design:type",Object)],mi.prototype,"cacheEnabled",void 0);Qn([E({attribute:"cache-invalidation-period",type:Number}),Yn("design:type",Object)],mi.prototype,"cacheInvalidationPeriod",void 0);Qn([E({attribute:!1}),Yn("design:type",Object)],mi.prototype,"response",void 0);Qn([E({attribute:!1}),Yn("design:type",Object)],mi.prototype,"error",void 0);l();c();d();xe();var a6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}
`];ge();var hn=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},pn=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Yh=()=>{at(Eh,Zl),dc(),Re("picker",ei)},ei=class extends it{get strings(){return s6}static get styles(){return a6}constructor(){super(),this.version="v1.0",this.maxPages=3,this.scopes=[],this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.renderLoading=()=>this.response?this.renderContent():this.renderTemplate("loading",null),this.renderContent=()=>{var e;let t=this.error?this.error:null;return t&&this.hasTemplate("error")?this.renderTemplate("error",{error:t},"error"):this.hasTemplate("no-data")?this.renderTemplate("no-data",null):((e=this.response)===null||e===void 0?void 0:e.length)>0?this.renderPicker():this.renderGet()},this.handleComboboxKeydown=e=>{let t,o,i=e.key,s=e.target.querySelector(".selected");s&&(t=s.getAttribute("value")),i==="Enter"&&t&&(o=this.response.filter(a=>a.id===t).pop(),this.fireCustomEvent("selectionChanged",o,!0,!1,!0))},this.placeholder=this.strings.comboboxPlaceholder,this.entityType=null,this.keyName=null}refresh(e=!1){e&&this.clearState(),this._task.run()}clearState(){this.response=null,this.error=null}renderPicker(){return Te`
      <fluent-combobox
        @keydown=${this.handleComboboxKeydown}
        current-value=${Zo(this.selectedValue)}
        part="picker"
        class="picker"
        id="combobox"
        autocomplete="list"
        placeholder=${this.placeholder}>
          ${this.response.map(e=>x`
            <fluent-option value=${e.id} @click=${t=>this.handleClick(t,e)}> ${this.getNestedPropertyValue(e,this.keyName)} </fluent-option>`)}
      </fluent-combobox>
     `}getNestedPropertyValue(e,t){let o=t.split("."),i=e;for(let n of o)if(i=i[n],i===void 0)return console.warn(`mgt-picker: Key '${n}' is undefined.`),"";return i}renderGet(){return Te`
      <mgt-get
        class="mgt-get"
        resource=${this.resource}
        version=${this.version}
        .scopes=${this.scopes}
        max-pages=${this.maxPages}
        ?cache-enabled=${this.cacheEnabled}
        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>
      </mgt-get>`}firstUpdated(e){super.firstUpdated(e);let t=this.renderRoot;t?t.addEventListener("dataChange",o=>this.handleDataChange(o)):console.error("\u{1F992}: mgt-picker component requires a renderRoot. Something has gone horribly wrong.")}handleDataChange(e){let t=e.detail.response.value,o=e.detail.error?e.detail.error:null;this.response=t,this.error=o}handleClick(e,t){this.fireCustomEvent("selectionChanged",t,!0,!1,!0)}};hn([E({attribute:"resource",type:String}),pn("design:type",String)],ei.prototype,"resource",void 0);hn([E({attribute:"version",type:String}),pn("design:type",Object)],ei.prototype,"version",void 0);hn([E({attribute:"max-pages",type:Number}),pn("design:type",Object)],ei.prototype,"maxPages",void 0);hn([E({attribute:"placeholder",type:String}),pn("design:type",String)],ei.prototype,"placeholder",void 0);hn([E({attribute:"key-name",type:String}),pn("design:type",String)],ei.prototype,"keyName",void 0);hn([E({attribute:"entity-type",type:String}),pn("design:type",String)],ei.prototype,"entityType",void 0);hn([E({attribute:"scopes",converter:r=>r?r.toLowerCase().split(","):null}),pn("design:type",Array)],ei.prototype,"scopes",void 0);hn([E({attribute:"cache-enabled",type:Boolean}),pn("design:type",Object)],ei.prototype,"cacheEnabled",void 0);hn([E({attribute:"cache-invalidation-period",type:Number}),pn("design:type",Object)],ei.prototype,"cacheInvalidationPeriod",void 0);hn([E({attribute:"selected-value",type:String}),pn("design:type",String)],ei.prototype,"selectedValue",void 0);hn([X(),pn("design:type",Array)],ei.prototype,"response",void 0);l();c();d();xe();gt();ge();l();c();d();var l6={termsetIdRequired:"The termsetId property or termset-id attribute is required",noTermsFound:"No terms found",comboboxPlaceholder:"Select a term",loadingMessage:"Loading..."};cr();Mr();ys();l();c();d();xe();var c6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--max-height:var(--taxonomy-picker-list-max-height, 380px)}:host .picker{background-color:var(--taxonomy-picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--taxonomy-picker-placeholder-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--taxonomy-picker-placeholder-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}
`];ge();qs();var ti=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},ri=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},mx=()=>{at(Eh,Zl),dn(),dc(),Re("taxonomy-picker",fo)},fo=class extends it{get strings(){return l6}static get styles(){return c6}constructor(){super(),this.version="beta",this.position="below",this.selectedTerm=null,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.renderLoading=()=>this.terms?this.renderContent():this.renderTemplate("loading",null,"loading")||Te`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `,this.renderContent=()=>{var e;return this.error?this.renderError():this.noTerms?this.renderNoData():((e=this.terms)===null||e===void 0?void 0:e.length)>0?this.renderTaxonomyPicker():this.renderGet()},this.renderError=()=>this.renderTemplate("error",null,"error")||x`<span>${this.error}</span>`,this.placeholder=this.strings.comboboxPlaceholder,this.noTerms=!1}refresh(e=!1){e&&this.clearState()}clearState(){this.terms=null,this.error=null,this.noTerms=!1}renderNoData(){return this.renderTemplate("no-data",null)||x`<span>${this.strings.noTermsFound}</span>`}renderTaxonomyPicker(){return Te`
      <fluent-combobox class="taxonomy-picker" autocomplete="both" placeholder=${this.placeholder} position=${this.position} ?disabled=${this.disabled}>
        ${this.terms.map(e=>this.renderTaxonomyPickerItem(e))}
      </fluent-combobox>
     `}renderTaxonomyPickerItem(e){let t=this.defaultSelectedTermId&&this.defaultSelectedTermId===e.id;return x`
        <fluent-option value=${e.id} ?selected=${t} @click=${o=>this.handleClick(o,e)}> ${this.renderTemplate("term",{term:e},e.id)||e.labels[0].name} </fluent-option>
        `}renderGet(){if(!this.termsetId)return x`<span>${this.strings.termsetIdRequired}</span>`;let e=`/termStore/sets/${this.termsetId}/children`;return this.termId&&(e=`/termStore/sets/${this.termsetId}/terms/${this.termId}/children`),this.siteId&&(e=`/sites/${this.siteId}${e}`),e+="?$select=id,labels,descriptions,properties",Te`
      <mgt-get
        class="mgt-get"
        resource=${e}
        version=${this.version}
        scopes="TermStore.Read.All, TermStore.ReadWrite.All"
        ?cache-enabled=${this.cacheEnabled}
        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>
      </mgt-get>`}firstUpdated(e){super.firstUpdated(e),this.renderRoot.addEventListener("dataChange",o=>this.handleDataChange(o))}handleDataChange(e){let t=e.detail.error?e.detail.error:null;if(t){this.error=t;return}this.locale&&(this.locale=this.locale.toLowerCase());let i=e.detail.response.value.map(n=>{let s=n.labels;if(s&&s.length>0&&this.locale){let a=s.find(u=>u.languageTag.toLowerCase()===this.locale);a&&(n.labels=[a,...s.filter(u=>u.languageTag.toLowerCase()!==this.locale)])}return n});this.terms=i,i.length===0&&(this.noTerms=!0)}handleClick(e,t){this.selectedTerm=t,this.fireCustomEvent("selectionChanged",t)}};ti([E({attribute:"term-set-id",type:String}),ri("design:type",String)],fo.prototype,"termsetId",void 0);ti([E({attribute:"term-id",type:String}),ri("design:type",String)],fo.prototype,"termId",void 0);ti([E({attribute:"site-id",type:String}),ri("design:type",String)],fo.prototype,"siteId",void 0);ti([E({attribute:"locale",type:String}),ri("design:type",String)],fo.prototype,"locale",void 0);ti([E({attribute:"version",type:String}),ri("design:type",Object)],fo.prototype,"version",void 0);ti([E({attribute:"placeholder",type:String}),ri("design:type",String)],fo.prototype,"placeholder",void 0);ti([E({attribute:"position",type:String,converter:r=>r==="above"?"above":"below"}),ri("design:type",String)],fo.prototype,"position",void 0);ti([E({attribute:"default-selected-term-id",type:String}),ri("design:type",String)],fo.prototype,"defaultSelectedTermId",void 0);ti([E({attribute:"selected-term",type:Object}),ri("design:type",Object)],fo.prototype,"selectedTerm",void 0);ti([E({attribute:"disabled",type:Boolean}),ri("design:type",Boolean)],fo.prototype,"disabled",void 0);ti([E({attribute:"cache-enabled",type:Boolean}),ri("design:type",Object)],fo.prototype,"cacheEnabled",void 0);ti([E({attribute:"cache-invalidation-period",type:Number}),ri("design:type",Object)],fo.prototype,"cacheInvalidationPeriod",void 0);ti([X(),ri("design:type",Array)],fo.prototype,"terms",void 0);ti([X(),ri("design:type",Boolean)],fo.prototype,"noTerms",void 0);l();c();d();xe();gt();pi();Cd();ge();Ad();bv();un();Yr();l();c();d();xe();var d6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .signed-in-person{--person-background-color:$signed-in-background-color;padding:var(--login-button-padding,10px 16px)}:host .account{padding:0;margin:7px 0}:host .account,:host .person,:host .signed-in-person{--person-avatar-size:var(--login-person-avatar-size, 40px)}:host fluent-button.signed-in{height:auto;min-width:auto}:host fluent-button.signed-in::part(control){width:100%;height:100%;padding:var(--login-button-padding,0);background:var(--login-signed-in-background,transparent);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-button.signed-in::part(control):focus-within,:host fluent-button.signed-in::part(control):hover{background:var(--login-signed-in-hover-background,var(--neutral-fill-stealth-hover));--secondary-text-color:var(--secondary-text-hover-color)}:host fluent-button.signed-out::part(control){color:var(--login-signed-out-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-signed-out-button-background,padding-box linear-gradient(var(--neutral-fill-rest),var(--neutral-fill-rest)),border-box var(--neutral-stroke-control-rest))}:host fluent-button.signed-out::part(control):focus-within,:host fluent-button.signed-out::part(control):hover{background:var(--login-signed-out-button-hover-background,var(--neutral-fill-stealth-hover))}:host fluent-button.small::part(control):hover{background:0 0}:host fluent-button:focus-visible{outline-style:var(--focus-ring-style,auto)}:host fluent-card{--fill-color:var(--login-popup-background-color, var(--neutral-layer-1));padding:var(--login-popup-padding,16px)}:host .login-root .small .signed-in-person{padding:0;background:0 0}:host .login-root .small .signed-in-person:focus-within,:host .login-root .small .signed-in-person:hover{background:0 0}:host .login-root .account-list{padding:calc(var(--design-unit) * 1px) 0;margin:0}:host .login-root .account-item{height:auto;min-width:auto;margin-top:4px;background:var(--login-popup-background-color,var(--neutral-layer-1));list-style-type:none;cursor:pointer}:host .login-root .account-item:hover{background:var(--login-account-item-hover-bg-color,var(--neutral-fill-stealth-hover));--person-background-color:$login-account-item-hover-bg-color}:host .login-root .flyout .flyout-command{color:var(--login-flyout-command-text-color,var(--accent-foreground-rest))}:host .login-root .flyout .popup-content .commands{display:flex;align-items:flex-end;justify-content:flex-end}:host .login-root .flyout .popup-content .commands fluent-button::part(control){color:var(--login-command-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-command-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .commands fluent-button::part(control):hover{background:var(--login-command-button-hover-background-color,var(--neutral-fill-stealth-hover))}:host .login-root .flyout .popup-content .content .main-profile{margin-bottom:56px;margin-top:27px}:host .login-root .flyout .popup-content .add-account{padding-top:16px}:host .login-root .flyout .popup-content .add-account fluent-button::part(control){color:var(--login-add-account-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-add-account-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .add-account fluent-button::part(control):hover{background:var(--login-add-account-button-hover-background-color,var(--neutral-fill-stealth-hover))}
`];l();c();d();var u6={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out",signInWithADifferentAccount:"Sign in with a different account"};ys();cr();Mr();ge();Cu();var Zh=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Jh=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},gx=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},vx=()=>{at(nC,Ph,Or,ln),Ba(),Lo(),Re("login",qa)},qa=class extends it{static get styles(){return d6}get strings(){return u6}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...pt.requiredScopes])]}get _userDetailsKey(){return"-userDetails"}constructor(){super(),this.showPresence=!1,this.loginView="full",this._arrowKeyLocation=-1,this.logout=()=>gx(this,void 0,void 0,function*(){if(!this.fireCustomEvent("logoutInitiated"))return;let e=V.globalProvider;e?.logout&&(yield e.logout())}),this.completeLogout=()=>{let e=V.globalProvider;if(e.state===oe.SignedOut){if(this.userDetails=null,e.isMultiAccountSupportedAndEnabled){let t=e.getActiveAccount();localStorage.removeItem(t?.id+this._userDetailsKey)}this.hideFlyout(),this.fireCustomEvent("logoutCompleted")}},this.renderContent=()=>x`
      <div class="login-root">
        ${this.renderButton()}
        ${this.renderFlyout()}
      </div>`,this.flyoutOpened=()=>{this._isFlyoutOpen=!0},this.flyoutClosed=()=>{this._isFlyoutOpen=!1},this.onUserKeyDown=e=>{if(!this.flyout.isOpen)return;let t=this.renderRoot.querySelector(".popup-content"),o=t.querySelectorAll("ul, fluent-button"),i=t.querySelector("#signout-button")||o[0],n=t.querySelector("#signin-different-account-button")||o[o.length-1];if(e.key==="Tab"&&e.shiftKey&&i===e.target&&(e.preventDefault(),n?.focus()),e.key==="Tab"&&!e.shiftKey&&n===e.target&&(e.preventDefault(),i?.focus()),e.key==="Escape"){let a=this.renderRoot.querySelector("#login-button");a?.focus()}let s=this.renderRoot.querySelector("fluent-card");e.shiftKey&&e.key==="Tab"&&e.target===s&&this.hideFlyout()},this.handleAccountListKeyDown=e=>{let t=this.renderRoot.querySelector("ul.account-list"),o,i=t?.children;for(let a of i){let u=a;u.setAttribute("tabindex","-1"),u.blur()}let n=t.childElementCount,s=e.key;if(s==="ArrowDown")this._arrowKeyLocation=(this._arrowKeyLocation+1+n)%n;else if(s==="ArrowUp")this._arrowKeyLocation=(this._arrowKeyLocation-1+n)%n;else if(s==="Tab"||s==="Escape"){this._arrowKeyLocation=-1,t.blur(),s==="Escape"&&(e.preventDefault(),e.stopPropagation());return}this._arrowKeyLocation>-1&&(o=i[this._arrowKeyLocation],o.setAttribute("tabindex","1"),o.focus())},this.onClick=()=>{this.userDetails&&this.flyout.isOpen?this.hideFlyout():this.userDetails?this.showFlyout():this.login()},this._isFlyoutOpen=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("click",e=>e.stopPropagation())}login(){return gx(this,void 0,void 0,function*(){let e=V.globalProvider;(this.userDetails||!this.fireCustomEvent("loginInitiated"))&&!e.isMultiAccountSupportedAndEnabled||e?.login&&(yield e.login(),e.state===oe.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))})}args(){return[this.providerState]}loadState(){return gx(this,void 0,void 0,function*(){let e=V.globalProvider;e&&!this.userDetails&&(e.state===oe.SignedIn?(this.userDetails=yield ic(e.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),e.isMultiAccountSupportedAndEnabled&&localStorage.setItem(V.globalProvider.getActiveAccount().id+this._userDetailsKey,JSON.stringify(this.userDetails)),this.fireCustomEvent("loginCompleted")):(e.logout&&this.completeLogout(),this.userDetails=null))})}renderButton(){var e;let t=((e=V.globalProvider)===null||e===void 0?void 0:e.state)===oe.SignedIn,o=ze({"signed-in":t&&!!this.userDetails,"signed-out":!t,small:this.loginView==="avatar"}),i=t?"stealth":"neutral",n=t&&this.userDetails,s=n?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent(),a=n?this._isFlyoutOpen:void 0;return x`
      <fluent-button
        id="login-button"
        aria-expanded="${Zo(a)}"
        appearance=${i}
        aria-label="${Zo(t?void 0:this.strings.signInLinkSubtitle)}"
        ?disabled=${this._task.status===Js.PENDING}
        @click=${this.onClick}
        class=${o}>
          ${s}
      </fluent-button>`}renderFlyout(){return Te`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${this.flyoutOpened}
        @closed=${this.flyoutClosed}>
        <fluent-card
          slot="flyout"
          tabindex="0"
          class="flyout-card"
          @keydown=${this.onUserKeyDown}
          >
          ${this.renderFlyoutContent()}
        </fluent-card>
      </mgt-flyout>`}renderFlyoutContent(){if(this.userDetails)return x`
       <div class="popup">
         <div class="popup-content">
           <div class="commands">
             ${this.renderFlyoutCommands()}
           </div>
           <div class="content">
             <div class="main-profile">
               ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
             </div>
             ${this.renderAccounts()}
           </div>
           ${this.renderAddAccountContent()}
         </div>
       </div>
     `}get hasMultipleAccounts(){var e,t,o,i;return((e=V.globalProvider)===null||e===void 0?void 0:e.isMultiAccountSupportedAndEnabled)&&((i=(o=(t=V.globalProvider)===null||t===void 0?void 0:t.getAllAccounts)===null||o===void 0?void 0:o.call(t))===null||i===void 0?void 0:i.length)>1}get usesVerticalPersonCard(){return this.loginView==="full"||this.hasMultipleAccounts}renderFlyoutPersonDetails(e,t){return this.renderTemplate("flyout-person-details",{personDetails:e,personImage:t})||Te`
        <mgt-person
          .personDetails=${e}
          .personImage=${t}
          view="twolines"
          .line2Property=${"email"}
          ?vertical-layout=${this.usesVerticalPersonCard}
          class="person">
        </mgt-person>`}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||x`
        <fluent-button
          id="signout-button"
          appearance="stealth"
          size="medium"
          class="flyout-command"
          @click=${this.logout}
          aria-label=${this.strings.signOutLinkSubtitle}>
            ${this.strings.signOutLinkSubtitle}
        </fluent-button>`}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderAddAccountContent(){if(V.globalProvider.isMultiAccountSupportedAndEnabled)return x`
        <div class="add-account">
          <fluent-button
            id="signin-different-account-button"
            appearance="stealth"
            aria-label="${this.strings.signInWithADifferentAccount}"
            @click=${()=>void this.login()}>
            <span slot="start"><i>${Z(P.SelectAccount,"currentColor")}</i></span>
            ${this.strings.signInWithADifferentAccount}
          </fluent-button>
        </div>`}parsePersonDisplayConfiguration(){let e={view:"twolines",avatarSize:"small"};switch(this.loginView){case"avatar":e.view="image",e.avatarSize="small";break;case"compact":e.view="oneline",e.avatarSize="small";break;case"full":default:e.view="twolines",e.avatarSize="auto";break}return e}renderSignedInButtonContent(e,t){let o=this.renderTemplate("signed-in-button-content",{personDetails:e,personImage:t}),i=this.parsePersonDisplayConfiguration();return o||Te`
        <mgt-person
          .personDetails=${this.userDetails}
          .personImage=${this._image}
          .view=${i.view}
          .showPresence=${this.showPresence}
          .avatarSize=${i.avatarSize}
          line2-property="email"
          class="signed-in-person"
        ></mgt-person>`}renderAccounts(){if(V.globalProvider.state===oe.SignedIn&&V.globalProvider.isMultiAccountSupportedAndEnabled){let e=V.globalProvider,t=e.getAllAccounts();if(t?.length>1)return x`
          <div id="accounts">
            <ul
              tabindex="0"
              class="account-list"
              part="account-list"
              aria-label="${this.ariaLabel}"
              @keydown=${this.handleAccountListKeyDown}
            >
              ${t.filter(o=>o.id!==e.getActiveAccount().id).map(o=>{let i=localStorage.getItem(o.id+this._userDetailsKey);return Te`
                    <li
                      tabindex="-1"
                      part="account-item"
                      class="account-item"
                      @click=${()=>this.setActiveAccount(o)}
                      @keyup=${n=>{n.key==="Enter"&&this.setActiveAccount(o)}}
                    >
                      <mgt-person
                        .personDetails=${i?JSON.parse(i):null}
                        .fallbackDetails=${{displayName:o.name,mail:o.mail}}
                        .view=${"twolines"}
                        class="account"
                      ></mgt-person>
                    </li>`})}
            </ul>
          </div>
       `}}setActiveAccount(e){V.globalProvider.setActiveAccount(e)}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||x`
        <span>${this.strings.signInLinkSubtitle}</span>`}showFlyout(){let e=this.flyout;e&&e.open()}hideFlyout(){let e=this.flyout;e&&e.close()}};Zh([E({attribute:"user-details",type:Object}),Jh("design:type",Object)],qa.prototype,"userDetails",void 0);Zh([E({attribute:"show-presence",type:Boolean}),Jh("design:type",Object)],qa.prototype,"showPresence",void 0);Zh([E({attribute:"login-view",type:String}),Jh("design:type",String)],qa.prototype,"loginView",void 0);Zh([X(),Jh("design:type",Boolean)],qa.prototype,"_isFlyoutOpen",void 0);Zh([X(),Jh("design:type",Object)],qa.prototype,"_arrowKeyLocation",void 0);l();c();d();xe();gt();sc();Cu();l();c();d();ge();Ni();var ep=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},xD=["any","unified","security","mailenabledsecurity","distribution"],yx=r=>xD.includes(r),h6=(r,e="any")=>yx(r)?r:e,bx=()=>W.config.groups.invalidationPeriod||W.config.defaultInvalidationPeriod,Ga=()=>W.config.groups.isEnabled&&W.config.isEnabled,Xh=["GroupMember.Read.All","Group.Read.All","Directory.Read.All","Group.ReadWrite.All","Directory.ReadWrite.All"];var Fv=(r,e,t=10,o=["any"],i="")=>ep(void 0,void 0,void 0,function*(){let n=Array.isArray(o)?o.join("+"):JSON.stringify(o),s,a=`${e||"*"}*${n}*${i}:${t}`;if(Ga()){s=W.getCache(H.groups,H.groups.stores.groupsQuery);let f=yield s.getValue(a);if(f&&bx()>Date.now()-f.timeCached&&f.top>=t)return f.groups.map(b=>JSON.parse(b)).slice(0,t+1)}let u="",h,p=[];if(e!==""&&(u=`(startswith(displayName,'${e}') or startswith(mailNickname,'${e}') or startswith(mail,'${e}'))`),i&&(u+=`${e?" and ":""}${i}`),o.includes("any")){if(p.length===0){let f=yield r.api("groups").filter(u).top(t).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(be(Xh)).get();return Ga()&&f&&(yield s.putValue(a,{groups:f.value.map(b=>JSON.stringify(b)),top:t})),f?f.value:null}}else{let f=r.createBatch(),b=[];o.includes("unified")&&b.push("groupTypes/any(c:c+eq+'Unified')"),o.includes("security")&&b.push("(mailEnabled eq false and securityEnabled eq true)"),o.includes("mailenabledsecurity")&&b.push("(mailEnabled eq true and securityEnabled eq true)"),o.includes("distribution")&&b.push("(mailEnabled eq true and securityEnabled eq false)"),u=u?`${u} and `:"";for(let C of b){let S=`/groups?$filter=${u+C}&$top=${t}`;f.get(C,S,Xh)}try{h=yield f.executeAll();for(let C of b)if(h.get(C).content.value)for(let S of h.get(C).content.value)p.find(N=>N.id===S.id)||p.push(S)}catch{try{let S=[];for(let R of b)S.push(r.api("groups").filter(`${u} and ${R}`).top(t).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(be(Xh)).get());return(yield Promise.all(S)).map(R=>R.value).reduce((R,N)=>R.concat(N),[])}catch{return[]}}}return p});var wx=(r,e,t)=>ep(void 0,void 0,void 0,function*(){let o;if(Ga()){o=W.getCache(H.groups,H.groups.stores.groups);let s=yield o.getValue(e);if(s&&bx()>Date.now()-s.timeCached){let a=s.group?JSON.parse(s.group):null,u=t&&a?t.filter(h=>!Object.keys(a).includes(h)):null;if(!u||u.length<=1)return a}}let i=`/groups/${e}`;t&&(i=i+"?$select="+t.toString());let n=yield r.api(i).middlewareOptions(be(Xh)).get();return Ga()&&(yield o.putValue(e,{group:JSON.stringify(n)})),n}),Dv=(r,e,t="")=>ep(void 0,void 0,void 0,function*(){if(!e||e.length===0)return[];let o=r.createBatch(),i={},n=[],s;Ga()&&(s=W.getCache(H.groups,H.groups.stores.groups));for(let a of e){i[a]=null;let u;if(Ga()&&(u=yield s.getValue(a)),u&&bx()>Date.now()-u.timeCached)i[a]=u.group?JSON.parse(u.group):null;else if(a!==""){let h=`/groups/${a}`;t&&(h=`${h}?$filters=${t}`),o.get(a,h,Xh),n.push(a)}}try{let a=yield o.executeAll();for(let u of e){let h=a.get(u);h?.content&&(i[u]=h.content,Ga()&&(yield s.putValue(u,{group:JSON.stringify(h.content)})))}return Promise.all(Object.values(i))}catch{try{return e.filter(u=>n.includes(u)).forEach(u=>{i[u]=wx(r,u)}),Ga()&&(yield Promise.all(e.filter(u=>n.includes(u)).map(u=>ep(void 0,void 0,void 0,function*(){return yield s.putValue(u,{group:JSON.stringify(yield i[u])})})))),Promise.all(Object.values(i))}catch{return[]}}}),p6=(r,e,t,o=10,i=["any"],n="")=>ep(void 0,void 0,void 0,function*(){let s=[],a=yield Fv(r,e,o,i,n);if(a)for(let u of a)u.id&&t.includes(u.id)&&s.push(u);return s});Bs();Ua();ge();ys();Jo();un();Ad();l();c();d();xe();var f6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--person-details-wrapper-width:0;width:auto}:host fluent-text-field{width:100%;font-size:var(--people-picker-font-size, 14px);margin-block-end:4px}:host fluent-text-field::part(root){display:flex;flex-wrap:wrap;height:auto;background:padding-box linear-gradient(var(--people-picker-input-background,var(--neutral-fill-input-rest)),var(--people-picker-input-background,var(--neutral-fill-input-rest))),border-box var(--people-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--people-picker-input-hover-background,var(--neutral-fill-input-hover)),var(--people-picker-input-hover-background,var(--neutral-fill-input-hover))),border-box var(--people-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--people-picker-input-focus-background,var(--neutral-fill-input-focus)),var(--people-picker-input-focus-background,var(--neutral-fill-input-focus))),border-box var(--people-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(start){margin:unset}:host fluent-text-field::part(control){width:auto;flex-grow:1;min-width:25%;height:calc((var(--base-height-multiplier) + var(--density)) * var(--design-unit) * 1px);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--people-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--people-picker-input-placeholder-hover-text-color,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--people-picker-input-placeholder-focus-text-color,var(--input-placeholder-filled))}:host fluent-text-field .search-icon{display:flex;padding-top:10px;padding-inline-start:10px}:host fluent-text-field .search-icon svg path{fill:var(--people-picker-search-icon-color,currentColor)}:host .selected-list{display:flex;flex-wrap:wrap;column-gap:5px;padding:unset;margin:0 5px}:host .selected-list-item{display:flex;column-gap:5px;border-radius:100px;margin-top:3px;background-color:var(--people-picker-selected-option-background-color,var(--person-background-color,var(--neutral-layer-3)))}:host .selected-list-item.highlighted{background-color:var(--people-picker-selected-option-highlight-background-color,var(--accent-fill-rest))}:host .selected-list-item-close-icon{display:flex;justify-content:center;align-items:center;padding-inline-end:8px;cursor:pointer}:host .selected-list-item-close-icon svg path{fill:var(--people-picker-remove-selected-close-icon-color,currentColor)}:host .selected-list-item .person-image-selected{width:max-content;--person-avatar-size:var(--people-picker-selected-person-avatar-size, 24px)}:host fluent-card{background-color:var(--people-picker-dropdown-background-color,var(--fill-color))}:host .searched-people-list{list-style:none;padding:4px;margin:auto;max-height:var(--people-picker-dropdown-max-height,300px);overflow-y:var(--people-picker-dropdown-scrollbar,auto)}:host .searched-people-list-result{padding:4px;border-radius:4px;background:var(--people-picker-dropdown-result-background-color,var(--person-background-color,transparent))}:host .searched-people-list-result:hover{background:var(--people-picker-dropdown-result-hover-background-color,var(--person-background-color,var(--neutral-fill-input-hover)))}:host .searched-people-list-result:focus,:host .searched-people-list-result:focus-within{background:var(--people-picker-dropdown-result-focus-background-color,var(--person-background-color,var(--neutral-fill-input-focus)))}:host .searched-people-list-result .person-image-result{--person-avatar-size:var(--people-picker-result-person-avatar-size, 40px)}:host .message-parent{display:flex;place-content:center;flex-direction:row;padding:10px 15px;column-gap:5px}:host .message-parent .loading-text,:host .message-parent .search-error-text{font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:var(--people-picker-no-results-text-color,var(--neutral-foreground-hint))}
`];Yr();cr();Mr();l();c();d();var m6={inputPlaceholderText:"Search for a name",maxSelectionsPlaceHolder:"Max contacts added",maxSelectionsAriaLabel:"Maximum contact selections reached",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",selected:"selected",removeSelectedUser:"Remove ",selectContact:"select a contact",suggestionsTitle:"Suggested contacts"};ge();qs();WC();Cv();var Et=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},xt=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Ld=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},tp=()=>{at(cn,ln),Ba(),Lo(),dn(),Re("people-picker",ft)},ft=class extends it{static get styles(){return f6}get strings(){return m6}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector("fluent-text-field")}get selectedPeople(){return this._selectedPeople}set selectedPeople(e){e||(e=[]),LS(this._selectedPeople,e)||(this._selectedPeople=e,this.fireCustomEvent("selectionChanged",this._selectedPeople))}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all","contacts.read",...pt.requiredScopes])]}constructor(){super(),this.groupIds=[],this.type="any",this.groupType=["any"],this.userType="any",this.transitiveSearch=!1,this.people=null,this.showMax=6,this.disableImages=!1,this.personCardInteraction="none",this.defaultSelectedUserIds=[],this.defaultSelectedGroupIds=[],this.disabled=!1,this.allowAnyEmail=!1,this.userIds=[],this.disableSuggestions=!1,this.userInput="",this._selectedPeople=[],this._arrowSelectionCount=-1,this.defaultSelectedUsers=[],this.defaultSelectedGroups=[],this._highlightedUsers=[],this._currentHighlightedUserPos=0,this._isFocused=!1,this._setAnyEmail=!1,this.handleSelectionChanged=()=>{this.selectedPeople.length===0&&!this.disabled&&this.enableTextInput()},this.renderLoading=()=>this.renderTemplate("loading",null)||Te`
         <div class="message-parent">
           <mgt-spinner></mgt-spinner>
           <div aria-label="${this.strings.loadingMessage}" aria-live="polite" role="alert" class="loading-text">
             ${this.strings.loadingMessage}
           </div>
         </div>
       `,this.handleInputClick=()=>{this.flyout.isOpen||this.handleUserSearch()},this.gainedFocus=()=>{this.clearHighlighted(),this._isFocused=!0,this.loadState(),this.showFlyout()},this.lostFocus=()=>{this._isFocused=!1,this.input&&this.input.setAttribute("aria-activedescendant","");let e=this.renderRoot.querySelector(".people-list");if(e)for(let t of e.children)t.classList.remove("focused"),t.setAttribute("aria-selected","false");this.requestUpdate()},this.onUserKeyUp=e=>{let t=e.key,o=e.getModifierState("Control")||e.getModifierState("Meta"),i=o&&t==="v",n=["ArrowDown","ArrowRight","ArrowUp","ArrowLeft"].includes(t);if(!i&&o||n){(o||["ArrowLeft","ArrowRight"].includes(t))&&this.hideFlyout(),t==="ArrowDown"&&!this.flyout.isOpen&&this._isFocused&&this.handleUserSearch();return}if(!["Tab","Enter","Shift"].includes(t)){if(t==="Escape"){this.clearInput(),this._foundPeople=[],this._arrowSelectionCount=-1;return}if(t==="Backspace"&&this.userInput.length===0&&this.selectedPeople.length>0){this.clearHighlighted(),this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout();return}if([";",","].includes(t)){this.allowAnyEmail&&(this._setAnyEmail=!0,e.preventDefault(),e.stopPropagation());return}}},this.onUserInput=e=>{let t=e.target;this.userInput=t.value,this.userInput?(dv(this.userInput)&&this.allowAnyEmail?this._setAnyEmail&&this.handleAnyEmail():this.handleUserSearch(),this._setAnyEmail=!1):this._foundPeople=[]},this.onUserKeyDown=e=>{e.stopPropagation();let t=e.key,o=this.renderRoot.querySelector(".selected-list"),i=e.getModifierState("Control")||e.getModifierState("Meta");if(i&&o){let n=o.querySelectorAll("mgt-person.person-image-selected");if(this.hideFlyout(),i&&t==="ArrowLeft")this._currentHighlightedUserPos=(this._currentHighlightedUserPos-1+n.length)%n.length,this._currentHighlightedUserPos>=0&&!Number.isNaN(this._currentHighlightedUserPos)?this._highlightedUsers.push(n[this._currentHighlightedUserPos]):this._currentHighlightedUserPos=0;else if(i&&t==="ArrowRight"){let s=this._highlightedUsers.pop();if(s){let a=s.parentElement;a&&(this.clearHighlighted(a),this._currentHighlightedUserPos++)}}else i&&t==="a"&&(this._highlightedUsers=[],n.forEach(s=>this._highlightedUsers.push(s)));this._highlightedUsers&&this.highlightSelectedPeople(this._highlightedUsers);return}if(this.clearHighlighted(),!!this.flyout.isOpen){if((t==="ArrowUp"||t==="ArrowDown")&&(this.handleArrowSelection(e),e.preventDefault()),t==="Enter"){if(!e.shiftKey&&this._foundPeople){e.preventDefault();let n=this._foundPeople[this._arrowSelectionCount];if(n){this.addPerson(n),this.hideFlyout(),this.input.value="",this.hasMaxSelections&&this.disableTextInput();return}}this.allowAnyEmail?this.handleAnyEmail():this.showFlyout()}[";",",","Tab"].includes(t)&&this.allowAnyEmail&&(t!=="Tab"&&e.preventDefault(),this.userInput=this.input.value,this.handleAnyEmail()),t==="Tab"&&this.hideFlyout()}},this.handleCut=()=>{this.writeHighlightedText().then(()=>{this.removeHighlightedOnCut()},()=>{})},this.handleCopy=()=>{this.writeHighlightedText()},this.handlePaste=()=>{navigator.clipboard.readText().then(e=>{if(e)try{let t=JSON.parse(e);if(t&&t.length>0)for(let o of t)this.addPerson(o)}catch(t){if(t instanceof SyntaxError){let o=[",",";"],i;try{for(let n of o)if(i=e.split(n),i.length>1){this.hideFlyout(),this.selectUsersById(i);break}}catch{}}}},e=>{})},this.addEventListener("copy",this.handleCopy),this.addEventListener("cut",this.handleCut),this.addEventListener("paste",this.handlePaste),this.addEventListener("selectionChanged",this.handleSelectionChanged)}disableTextInput(){let e=this.input.shadowRoot.querySelector("input");e&&(e.setAttribute("disabled","true"),e.value="")}enableTextInput(){let e=this.input.shadowRoot.querySelector("input");e&&(e.removeAttribute("disabled"),e.focus())}get hasMaxSelections(){return this.selectionMode==="single"&&this.selectedPeople.length>=1}focus(e){this.input&&(this.input.focus(e),this.input.select())}selectUsersById(e){var t;return Ld(this,void 0,void 0,function*(){let o=V.globalProvider,i=V.globalProvider.graph;if(o&&o.state===oe.SignedIn)for(let n in e){let s=e[n];try{let a=yield Lh(i,s,dx);this.addPerson(a)}catch(a){if(yv(a)&&(!((t=a.message)===null||t===void 0)&&t.includes("does not exist"))&&this.allowAnyEmail&&dv(s)){let u={mail:s,displayName:s};this.addPerson(u)}}}})}selectGroupsById(e){return Ld(this,void 0,void 0,function*(){let t=V.globalProvider,o=V.globalProvider.graph;if(t&&t.state===oe.SignedIn)for(let i in e)try{let n=yield wx(o,e[i]);this.addPerson(n)}catch{}})}render(){let e=this.renderTemplate("default",{people:this._foundPeople});if(e)return e;let t=this.renderSelectedPeople(this.selectedPeople);if(this.selectionMode==="single"&&this.selectedPeople.length===1)return t;{let o=this.renderInput(t),i=this.renderFlyout(o);return x`
      <div>
        ${i}
      </div>
    `}}args(){return[this.providerState,this.groupId,this.groupIds,this.type,this.groupType,this.userType,this.transitiveSearch,this.people,this.showMax,this.defaultSelectedUserIds,this.defaultSelectedGroupIds,this.userIds,this.userFilters,this.peopleFilters,this.groupFilters]}clearState(){this.selectedPeople=[],this.userInput="",this._highlightedUsers=[],this._currentHighlightedUserPos=0}renderInput(e){var t,o,i;let n=this.disabled?"":this.placeholder||this.strings.inputPlaceholderText,s=this.hasMaxSelections?this.strings.maxSelectionsAriaLabel:"",a=x`<span class="search-icon">${Z(P.Search)}</span>`,u=((t=this.selectedPeople)===null||t===void 0?void 0:t.length)>0?e:a;return x`
      <fluent-text-field
        autocomplete="off"
        appearance="outline"
        slot="anchor"
        id="people-picker-input"
        role="combobox"
        aria-live="assertive"
        aria-atomic="true"
        placeholder=${this.hasMaxSelections?this.strings.maxSelectionsPlaceHolder:n}
        aria-label=${this.ariaLabel||s||n||this.strings.selectContact}
        aria-expanded=${(i=(o=this.flyout)===null||o===void 0?void 0:o.isOpen)!==null&&i!==void 0?i:!1}
        @click="${this.hasMaxSelections?void 0:this.handleInputClick}"
        @focus="${this.hasMaxSelections?void 0:this.gainedFocus}"
        @keydown="${this.hasMaxSelections?void 0:this.onUserKeyDown}"
        @input="${this.hasMaxSelections?void 0:this.onUserInput}"
        @blur="${this.lostFocus}"
        ?disabled=${this.disabled}
      >
        <span slot="start">${u}</span>
      </fluent-text-field>
    `}renderSelectedPeople(e){return e?.length?x`
       <ul
        id="selected-list"
        aria-label="${this.strings.selected}"
        class="selected-list">
          ${co(e,t=>t?.id,t=>{var o;return x`
            <li class="selected-list-item">
              ${this.renderTemplate("selected-person",{person:t},`selected-${t?.id?t.id:t.displayName}`)||this.renderSelectedPerson(t)}

              <div
                role="button"
                tabindex="0"
                class="selected-list-item-close-icon"
                aria-label="${this.strings.removeSelectedUser}${(o=t?.displayName)!==null&&o!==void 0?o:""}"
                @click="${i=>this.removePerson(t,i)}"
                @keydown="${i=>this.handleRemovePersonKeyDown(t,i)}">
                  ${Z(P.Close)}
              </div>
          </li>`})}
      </ul>`:x``}renderFlyout(e){return Te`
       <mgt-flyout light-dismiss class="flyout">
         ${e}
         <fluent-card
          tabindex="0"
          slot="flyout"
          class="flyout-root"
          @wheel=${t=>this.handleSectionScroll(t)}
          @keydown=${t=>this.onUserKeyDown(t)}
          class="custom">
           ${this.renderFlyoutContent()}
         </fluent-card>
       </mgt-flyout>
     `}renderFlyoutContent(){if(this._task.status===Js.PENDING)return this.renderLoading();let e=this._foundPeople;return!e||e.length===0||this.showMax===0?this.renderNoData():this.renderSearchResults(e)}renderNoData(){if(!(!this._isFocused||this.userInput.trim().length===0))return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||x`
         <div class="message-parent">
           <div aria-label=${this.strings.noResultsFound} aria-live="polite" role="alert" class="search-error-text">
             ${this.strings.noResultsFound}
           </div>
         </div>
       `}renderSearchResults(e){let t=e.filter(o=>o.id);return x`
      <ul
        id="suggestions-list"
        class="searched-people-list"
        role="listbox"
        aria-live="polite"
        aria-label="${this.strings.suggestionsTitle}"
        title=${this.strings.suggestionsTitle}
      >
        ${co(t,o=>o.id,o=>x`
          <li
            id="${o.id}"
            class="searched-people-list-result"
            role="option"
            @click="${()=>this.handleSuggestionClick(o)}">
              ${this.renderPersonResult(o)}
          </li>
        `)}
      </ul>
     `}renderPersonResult(e){return this.renderTemplate("person",{person:e},e.id)||Te`
         <mgt-person
          class="person-image-result"
          ?show-presence=${this.showPresence}
          view="twolines"
          line2-property="jobTitle,mail"
          .personDetails=${e}
          ?fetch-image=${!this.disableImages}
          person-card="none"
        ></mgt-person>`}renderSelectedPerson(e){return Te`
       <mgt-person
         class="person-image-selected"
         .personDetails=${e}
         ?fetch-image=${!this.disableImages}
         view="oneline"
         person-card=${this.personCardInteraction}
        ></mgt-person>
     `}loadState(){var e,t;return Ld(this,void 0,void 0,function*(){this._groupPeople=null,this._foundPeople=null,this.defaultPeople=null;let o=this.people,i=this.userInput.toLowerCase(),n=V.globalProvider;if(o?.length)i&&(o=o.filter(a=>a?.displayName.toLowerCase().includes(i)));else if(!o&&n&&n.state===oe.SignedIn){let s=n.graph.forComponent(this);if(!i.length){if((this.defaultSelectedUserIds.length>0||this.defaultSelectedGroupIds.length>0)&&!this.selectedPeople.length&&!this.defaultSelectedUsers.length&&!this.defaultSelectedGroups.length&&(this.defaultSelectedUsers=yield Xl(s,this.defaultSelectedUserIds,"",this.userFilters),this.defaultSelectedGroups=yield Dv(s,this.defaultSelectedGroupIds,this.peopleFilters),this.defaultSelectedGroups=this.defaultSelectedGroups.filter(a=>a!==null),this.defaultSelectedUsers=this.defaultSelectedUsers.filter(a=>a!==null),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.hasMaxSelections&&this.disableTextInput(),this.requestUpdate()),this.disableSuggestions){this._foundPeople=[];return}if(this.defaultPeople)o=this.defaultPeople;else{if(this.groupId||this.groupIds.length){if(this._groupPeople===null)if(this.groupId)try{this.type==="group"?this._groupPeople=yield tc(s,null,this.groupId,this.showMax,this.type,this.transitiveSearch):this._groupPeople=yield tc(s,null,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters)}catch{this._groupPeople=[]}else if(this.type==="group")try{this._groupPeople=yield Dv(s,this.groupIds,this.groupFilters)}catch{this._groupPeople=[]}else try{let a=yield jC(s,"",this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters);this._groupPeople=a}catch{this._groupPeople=[]}o=this._groupPeople||[]}else if(this.type==="person"||this.type==="any")if(this.userIds.length)o=yield Xl(s,this.userIds,"",this.userFilters);else{let a=this.userType==="user"||this.userType==="contact";this.userFilters&&a?o=yield Y3(s,this.userFilters,this.showMax):o=yield mv(s,this.userType,this.peopleFilters,this.showMax)}else if(this.type==="group"){let a=(yield Fv(s,"",this.showMax,this.groupType,this.groupFilters))||[];a.length>0&&a[0].value&&(a=a[0].value),o=a}this.defaultPeople=o}}if(i)if(o=[],this.groupId)o=(yield tc(s,i,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters))||[];else{if(this.type==="person"||this.type==="any"){try{if(this.userType==="contact"||this.userType==="user")!((e=this.userIds)===null||e===void 0)&&e.length?o=yield Xl(s,this.userIds,i,this.userFilters):o=yield ec(s,i,this.showMax,this.userFilters);else if(!this.groupIds.length)!((t=this.userIds)===null||t===void 0)&&t.length?o=yield Xl(s,this.userIds,i,this.userFilters):o=(yield Ha(s,i,this.showMax,this.userType,this.peopleFilters))||[];else try{o=yield jC(s,i,this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters)}catch{}}catch{}if(o&&o.length<this.showMax&&this.userType!=="contact"&&this.type!=="person")try{let a=(yield ec(s,i,this.showMax,this.userFilters))||[],u=new Set(o.map(h=>h.id));for(let h of a)u.has(h.id)||o.push(h)}catch{}}if((this.type==="group"||this.type==="any")&&o.length<this.showMax)if(this.groupIds.length)try{o=yield p6(s,i,this.groupIds,this.showMax,this.groupType,this.userFilters)}catch{}else{let a=[];try{a=(yield Fv(s,i,this.showMax,this.groupType,this.groupFilters))||[],o=o.concat(a)}catch{}}}}this._foundPeople=this.filterPeople(o)})}getGroupsForGroupIds(e,t){return Ld(this,void 0,void 0,function*(){let o=yield Dv(e,this.groupIds,this.groupFilters);for(let i of o)t=t.concat(i);return t=t.filter(i=>i),t})}hideFlyout(){let e=this.flyout;e&&e.close(),this.input&&this.input.setAttribute("aria-activedescendant",""),this._arrowSelectionCount=-1}showFlyout(){let e=this.flyout;e&&e.open(),this._arrowSelectionCount=-1}removePerson(e,t){t.stopPropagation();let o=this.selectedPeople.filter(i=>!e.id&&i.displayName?i.displayName!==e.displayName:i.id!==e.id);this.selectedPeople=o,this.loadState()}handleRemovePersonKeyDown(e,t){t.key==="Enter"&&(this.removePerson(e,t),this.enableTextInput())}addPerson(e){e&&(setTimeout(()=>{this.clearInput()},50),this.selectedPeople.filter(o=>!e.id&&o.displayName?o.displayName===e.displayName:o.id===e.id).length===0&&(this.selectedPeople=[...this.selectedPeople,e],this.loadState(),this._foundPeople=[],this._arrowSelectionCount=-1),this._isFocused&&this.enableTextInput())}clearInput(){this.clearHighlighted(),this.selectionMode!=="single"&&(this.input.value=""),this.userInput=""}handleAnyEmail(){if(this._arrowSelectionCount=-1,dv(this.userInput)){let e={mail:this.userInput,displayName:this.userInput};this.addPerson(e)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}handleSuggestionClick(e){this.addPerson(e),this.hasMaxSelections&&(this.disableTextInput(),this.input.value=""),this.hideFlyout()}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=Na(()=>Ld(this,void 0,void 0,function*(){yield this._task.run(),this._arrowSelectionCount=-1,this.showFlyout()}),400)),this._debouncedSearch()}writeHighlightedText(){return Ld(this,void 0,void 0,function*(){let e=[];for(let o of this._highlightedUsers){let{id:i,displayName:n,mail:s,userPrincipalName:a,scoredEmailAddresses:u}=o._personDetails,h;u&&u.length>0?h=u.pop().address:h=a||s,e.push({id:i,displayName:n,email:h})}let t="";e.length>0&&(t=JSON.stringify(e)),yield navigator.clipboard.writeText(t)})}removeHighlightedOnCut(){this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-this._highlightedUsers.length),this._highlightedUsers=[],this._currentHighlightedUserPos=0,this.loadState(),this.hideFlyout()}highlightSelectedPeople(e){for(let t of e)(t?.parentElement).classList.add("highlighted")}clearHighlighted(e){if(e)e.classList.remove("highlighted");else{for(let t of this._highlightedUsers){let o=t.parentElement;o&&o.classList.remove("highlighted")}this._highlightedUsers=[],this._currentHighlightedUserPos=0}}handleArrowSelection(e){var t,o;let i=this.renderRoot.querySelector(".searched-people-list");if(!((t=i?.children)===null||t===void 0)&&t.length){e&&(e.key==="ArrowUp"&&(this._arrowSelectionCount===-1?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount-1+i.children.length)%i.children.length),e.key==="ArrowDown"&&(this._arrowSelectionCount===-1?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount+1+i.children.length)%i.children.length));for(let s of(o=i?.children)!==null&&o!==void 0?o:[]){let a=s;a.setAttribute("aria-selected","false"),a.blur(),a.removeAttribute("tabindex")}let n=i.children[this._arrowSelectionCount];n&&(n.setAttribute("tabindex","0"),n.focus(),n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),n.setAttribute("aria-selected","true"),this.input.setAttribute("aria-activedescendant",n?.id))}}filterPeople(e){let t=[];if(e&&e.length>0){e=e.filter(s=>s);let o=this.selectedPeople.map(s=>s.id?s.id:s.displayName),i=e.filter(s=>s?.id?o.indexOf(s.id)===-1:o.indexOf(s?.displayName)===-1),n=new Set;for(let s of i){let a=JSON.stringify(s);n.add(a)}n.forEach(s=>{let a=JSON.parse(s);t.push(a)})}return t}handleSectionScroll(e){let t=this.renderRoot.querySelector(".flyout-root");t&&!(e.deltaY<0&&t.scrollTop===0)&&!(e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1)&&e.stopPropagation()}};Et([E({attribute:"group-id",converter:r=>r.trim()}),xt("design:type",String)],ft.prototype,"groupId",void 0);Et([E({attribute:"group-ids",converter:r=>r.split(",").map(e=>e.trim())}),xt("design:type",Array)],ft.prototype,"groupIds",void 0);Et([E({attribute:"type",converter:r=>j3(r,"any")}),xt("design:type",String)],ft.prototype,"type",void 0);Et([E({attribute:"group-type",converter:r=>{let e=["any"];if(!r||r.length===0)return e;let t=r.split(","),o=[];for(let i of t)i=i.trim(),yx(i)&&o.push(h6(i));return o.length===0?e:o}}),xt("design:type",Array)],ft.prototype,"groupType",void 0);Et([E({attribute:"user-type",converter:r=>K3(r)}),xt("design:type",String)],ft.prototype,"userType",void 0);Et([E({attribute:"transitive-search",type:Boolean}),xt("design:type",Object)],ft.prototype,"transitiveSearch",void 0);Et([E({attribute:"people",type:Object}),xt("design:type",Array)],ft.prototype,"people",void 0);Et([E({attribute:"show-max",type:Number}),xt("design:type",Object)],ft.prototype,"showMax",void 0);Et([E({attribute:"disable-images",type:Boolean}),xt("design:type",Object)],ft.prototype,"disableImages",void 0);Et([E({attribute:"show-presence",type:Boolean}),xt("design:type",Boolean)],ft.prototype,"showPresence",void 0);Et([E({attribute:"person-card",converter:r=>Rd(r)}),xt("design:type",String)],ft.prototype,"personCardInteraction",void 0);Et([E({attribute:"selected-people",type:Array}),xt("design:type",Array),xt("design:paramtypes",[Array])],ft.prototype,"selectedPeople",null);Et([E({attribute:"default-selected-user-ids",converter:r=>r.split(",").map(e=>e.trim()),type:String}),xt("design:type",Array)],ft.prototype,"defaultSelectedUserIds",void 0);Et([E({attribute:"default-selected-group-ids",converter:r=>r.split(",").map(e=>e.trim()),type:String}),xt("design:type",Array)],ft.prototype,"defaultSelectedGroupIds",void 0);Et([E({attribute:"placeholder",type:String}),xt("design:type",String)],ft.prototype,"placeholder",void 0);Et([E({attribute:"disabled",type:Boolean}),xt("design:type",Object)],ft.prototype,"disabled",void 0);Et([E({attribute:"allow-any-email",type:Boolean}),xt("design:type",Object)],ft.prototype,"allowAnyEmail",void 0);Et([E({attribute:"selection-mode",type:String}),xt("design:type",String)],ft.prototype,"selectionMode",void 0);Et([E({attribute:"user-ids",converter:r=>r.split(",").map(e=>e.trim()),type:String}),xt("design:type",Array)],ft.prototype,"userIds",void 0);Et([E({attribute:"user-filters"}),xt("design:type",String)],ft.prototype,"userFilters",void 0);Et([E({attribute:"people-filters"}),xt("design:type",String)],ft.prototype,"peopleFilters",void 0);Et([E({attribute:"group-filters"}),xt("design:type",String)],ft.prototype,"groupFilters",void 0);Et([E({attribute:"aria-label",type:String}),xt("design:type",String)],ft.prototype,"ariaLabel",void 0);Et([E({attribute:"disable-suggestions",type:Boolean}),xt("design:type",Object)],ft.prototype,"disableSuggestions",void 0);Et([X(),xt("design:type",Object)],ft.prototype,"userInput",void 0);Et([X(),xt("design:type",Object)],ft.prototype,"_arrowSelectionCount",void 0);Et([X(),xt("design:type",Array)],ft.prototype,"_highlightedUsers",void 0);Et([X(),xt("design:type",Object)],ft.prototype,"_isFocused",void 0);Et([X(),xt("design:type",Object)],ft.prototype,"_setAnyEmail",void 0);Et([X(),xt("design:type",Array)],ft.prototype,"_foundPeople",void 0);Mv();un();xv();l();c();d();ge();xe();gt();pi();sc();Cd();Ua();Jo();un();l();c();d();xe();gt();pi();ge();l();c();d();xe();var g6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative}:host .header::part(control){font-size:var(--arrow-options-button-font-size, large);font-weight:var(--arrow-options-button-font-weight,600);color:var(--arrow-options-button-font-color,var(--accent-base-color));background:var(--arrow-options-button-background-color,transparent)}:host .header::part(control):hover{background:var(--neutral-fill-stealth-hover)}:host .header::part(control):active,:host .header::part(control):focus{background:var(--neutral-fill-stealth-active)}:host .menu{position:absolute;left:var(--arrow-options-left,0);z-index:1;display:none}:host .menu.open{display:block;width:max-content}
`];Mr();cr();ge();var Cx=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},xx=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},v6=()=>{at(Ih,Ah,Or),Re("arrow-options",Nd)},Nd=class extends Lr{static get styles(){return g6}constructor(){super(),this.onHeaderClick=e=>{Object.keys(this.options).length>1&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)},this.onHeaderKeyDown=e=>{if(e.key==="Enter"){e.preventDefault(),e.stopPropagation(),this.open=!this.open;let t=this.renderRoot.querySelector("fluent-menu");t&&(t.classList.remove("closed"),t.classList.add("open"));let o=e.target;if(o){let i=this.renderRoot.querySelector("fluent-menu-item[tabindex='0']");i&&(o.blur(),i.focus())}}},this.renderContent=()=>x`
      <fluent-button
        class="header"
        @click=${this.onHeaderClick}
        @keydown=${this.onHeaderKeyDown}
        appearance="lightweight"
        aria-haspopup="true"
        aria-expanded=${this.open}>
          ${this.value}
      </fluent-button>
      <fluent-menu
        class=${ze({menu:!0,open:this.open,closed:!this.open})}>
          ${this.getMenuOptions()}
      </fluent-menu>`,this.value="",this.options={},this._clickHandler=()=>this.open=!1,window.addEventListener("onblur",()=>this.open=!1)}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}getMenuOptions(){return Object.keys(this.options).map(t=>x`
          <fluent-menu-item
            @click=${n=>{this.open=!1,this.options[t](n)}}
            @keydown=${n=>{let s=this.renderRoot.querySelector(".header");n.key==="Enter"?(this.open=!1,this.options[t](n),s.focus()):n.key==="Tab"?this.open=!1:n.key==="Escape"&&(this.open=!1,s&&s.focus())}}>
              ${t}
          </fluent-menu-item>`)}};Cx([E({type:Boolean}),xx("design:type",Boolean)],Nd.prototype,"open",void 0);Cx([E({type:String}),xx("design:type",String)],Nd.prototype,"value",void 0);Cx([E({type:Object}),xx("design:type",Object)],Nd.prototype,"options",void 0);l();c();d();cr();ge();xe();gt();pi();l();c();d();var y6={dotOptionsTitle:"More options"};Mr();l();c();d();xe();var b6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{display:flex;flex-direction:column;align-items:flex-end}:host .dot-icon{font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .menu{position:absolute;box-shadow:var(--dot-options-menu-shadow-color,var(--fill-color)) 0 0 40px 5px;background:var(--dot-options-menu-background-color,var(--fill-color));z-index:1;display:none;white-space:nowrap;transform:var(--dot-options-translatey,translateY(32px))}:host .menu.open{display:block}:host fluent-button::part(control){background:inherit}:host fluent-menu>fluent-menu-item::part(content){color:var(--dot-options-menu-item-color,var(--neutral-foreground-hint))}:host fluent-menu>fluent-menu-item:hover{background:var(--dot-options-menu-item-hover-background-color,var(--neutral-fill-input-hover))}
`];ge();Yr();var w6=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},C6=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},x6=()=>{at(Ih,Ah,Or),Re("dot-options",rp)},rp=class extends Lr{constructor(){super(...arguments),this._clickHandler=()=>this.open=!1,this.renderContent=()=>{let e=Object.keys(this.options);return x`
      <fluent-button
        appearance="stealth"
        aria-label=${this.strings.dotOptionsTitle}
        aria-expanded=${this.open}
        @click=${this.onDotClick}
        @keydown=${this.onDotKeydown}
        class="dot-icon"
        aria-haspopup="true"
        aria-expanded=${this.open}>${Z(P.Dot)}</fluent-button>
      <fluent-menu class=${ze({menu:!0,open:this.open})} aria-expanded=${this.open} aria-label=${this.strings.dotOptionsTitle}>
        ${e.map(t=>this.getMenuOption(t,this.options[t]))}
      </fluent-menu>`},this.handleItemClick=(e,t)=>{e.preventDefault(),e.stopPropagation(),t(e),this.open=!1},this.handleItemKeydown=(e,t)=>{this.handleKeydownMenuOption(e),t(e),this.open=!1},this.onDotClick=e=>{e.preventDefault(),e.stopPropagation(),this.open=!this.open},this.onDotKeydown=e=>{e.key==="Enter"&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}}static get styles(){return b6}get strings(){return y6}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}getMenuOption(e,t){return x`
      <fluent-menu-item
        @click=${o=>this.handleItemClick(o,t)}
        @keydown=${o=>this.handleItemKeydown(o,t)}>
          ${e}
      </fluent-menu-item>`}handleKeydownMenuOption(e){e.key==="Enter"&&(e.preventDefault(),e.stopPropagation())}};w6([E({type:Boolean}),C6("design:type",Boolean)],rp.prototype,"open",void 0);w6([E({type:Object}),C6("design:type",Object)],rp.prototype,"options",void 0);Ad();l();c();d();xe();var k6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{background-color:var(--tasks-background-color,transparent);padding:var(--tasks-padding,12px);border:var(--tasks-border,0);border-radius:var(--tasks-border-radius,0);--skeleton-fill:var(--neutral-foreground-active)}:host .header{display:flex;align-items:center;justify-content:space-between;padding:var(--tasks-header-padding,0 0 14px 0);margin:var(--tasks-header-padding,0 0 14px 0);font-size:var(--tasks-header-font-size, 16px);font-weight:var(--tasks-header-font-weight,600);color:var(--tasks-header-text-color,var(--neutral-foreground-hint))}:host .header:hover{color:var(--tasks-header-text-hover-color,var(--neutral-foreground-hover))}:host .header .title{justify-content:left;display:flex;align-items:center}:host .header .title .shimmer{width:80px;height:20px}:host .header .title svg{margin-top:3px;padding:0 4px;width:16px;height:16px}:host .header .new-task-button{justify-content:right}:host .header .new-task-button .shimmer{width:40px;height:24px}:host .header .new-task-button::part(control){font-weight:var(--tasks-new-button-text-font-weight,700);color:var(--tasks-new-button-text-color,var(--foreground-on-accent-rest));width:var(--tasks-new-button-width,none);height:var(--tasks-new-button-height,none);background:var(--tasks-new-button-background,padding-box linear-gradient(var(--accent-fill-rest),var(--accent-fill-rest)),border-box var(--accent-stroke-control-rest))}:host .header .new-task-button::part(control):hover{background:var(--tasks-new-button-background-hover,var(--accent-fill-hover))}:host .header .new-task-button::part(control):active{background:var(--tasks-new-button-background-active,var(--accent-fill-active))}:host .tasks{display:flex;flex-direction:column;row-gap:var(--tasks-gap,20px)}:host .tasks .task{display:flex;column-gap:4px;align-items:flex-start;justify-content:space-between}:host .tasks .task.updating{background:var(--neutral-stroke-rest)!important;pointer-events:none;opacity:.4}:host .tasks .task.complete{border:var(--task-complete-border,2px dotted var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-complete-background-color,transparent);padding:var(--task-complete-padding,10px)}:host .tasks .task.incomplete{border:var(--task-incomplete-border,1px solid var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-incomplete-background-color,var(--neutral-layer-1));padding:var(--task-incomplete-padding,10px)}:host .tasks .task .task-details-container{display:flex;flex-direction:column;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top{display:flex;justify-content:space-between;column-gap:4px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:row}:host .tasks .task .task-details-container .top .check-and-title{display:flex;align-items:flex-start;flex-direction:column;width:100%;row-gap:12px}:host .tasks .task .task-details-container .top .check-and-title.shimmer{display:flex;flex-direction:inherit;gap:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .checkbox{height:10px;width:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .title{height:10px;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content{display:grid;grid-template-columns:repeat(auto-fit,250px);gap:12px;justify-content:start;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content .picker{max-width:250px}:host .tasks .task .task-details-container .top .check-and-title .task-content .task-due fluent-text-field.dark::part(control){color-scheme:dark}:host .tasks .task .task-details-container .top .task-options .options{height:10px;width:20px}:host .tasks .task .task-details-container .top .task-options.new-task-action-buttons{display:flex;flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:column;grid-auto-columns:1fr;grid-column-gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket,:host .tasks .task .task-details-container .bottom .task-due,:host .tasks .task .task-details-container .bottom .task-group{display:flex;align-items:center;gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon{display:flex;place-content:center;width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon .shimmer.icon{width:20px;height:20px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg{width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg path{fill:var(--task-icons-background-color,var(--neutral-foreground-hint))}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text{color:var(--task-icons-text-font-color,var(--neutral-foreground-hint));font-size:var(--task-icons-text-font-size, 12px);font-weight:var(--task-icons-text-font-weight,600);white-space:normal;width:100%}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details{display:flex;flex-direction:column;row-gap:8px}:host .tasks .task .task-details-container .task-details.shimmer{flex-direction:row;place-items:center;column-gap:6px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.icon{width:24px;height:24px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details .task-title{color:var(--foreground-on-neutral-rest)}:host .tasks .task .task-details-container .task-details .task-body{display:flex}:host fluent-button.add-task::part(control){font-weight:var(--task-add-new-button-text-font-weight,initial);color:var(--task-add-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-add-new-button-width,none);height:var(--task-add-new-button-height,none);background:var(--task-add-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-add-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.add-task::part(control):hover{background:var(--task-add-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.add-task::part(control):active{background:var(--task-add-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-button.cancel-task::part(control){font-weight:var(--task-cancel-new-button-text-font-weight,initial);color:var(--task-cancel-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-cancel-new-button-width,none);height:var(--task-cancel-new-button-height,none);background:var(--task-cancel-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-cancel-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.cancel-task::part(control):hover{background:var(--task-cancel-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.cancel-task::part(control):active{background:var(--task-cancel-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-option{background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-option:hover{background:var(--task-new-dropdown-option-hover-background-color,var(--neutral-fill-stealth-hover))}:host fluent-option::part(content){color:var(--task-new-dropdown-option-text-color,var(--neutral-foreground-rest))}:host fluent-select::part(listbox){background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-select::part(control){border:var(--task-new-dropdown-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-dropdown-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-dropdown-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-select::part(control):hover{background:var(--task-new-dropdown-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-select::part(control)::placeholder{color:var(--task-new-dropdown-placeholder-color,var(--input-placeholder-rest))}:host fluent-checkbox{padding-top:1px}:host fluent-checkbox::part(control){border-radius:50%;background:var(--task-incomplete-checkbox-background-color,var(--neutral-fill-input-alt-rest))}:host fluent-checkbox::part(control):hover{background:var(--task-incomplete-checkbox-background-hover-color,var(--neutral-fill-input-alt-hover))}:host fluent-checkbox::part(label){font-size:var(--task-title-text-font-size, medium);font-weight:var(--task-title-text-font-weight,600);color:var(--task-incomplete-title-text-color,var(var(--neutral-foreground-rest)))}:host fluent-checkbox.checked::part(control){background:var(--task-complete-checkbox-background-color,var(--accent-fill-rest));color:var(--task-complete-checkbox-text-color,currentColor)}:host fluent-checkbox.checked::part(label){text-decoration:line-through;color:var(--task-complete-title-text-color,var(--neutral-foreground-hint))}:host fluent-text-field.new-task{width:100%}:host fluent-text-field.new-task::part(root){border:var(--task-new-input-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-input-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-input-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-text-field.new-task::part(root):hover{background:var(--task-new-input-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-text-field.new-task::part(root)::placeholder{color:var(--task-new-input-placeholder-color,var(--input-placeholder-rest))}:host .people [slot=no-data] fluent-button::part(control){color:var(--task-new-person-icon-text-color,var(--neutral-foreground-hint))}:host .people [slot=no-data] svg{fill:var(--task-new-person-icon-color,var(--neutral-foreground-hint))}@media only screen and (width <= 600px){:host fluent-select{width:100%}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:row;grid-auto-columns:unset;row-gap:4px}:host .tasks .task .task-details-container .bottom .ask-bucket,:host .tasks .task .task-details-container .bottom .ask-due,:host .tasks .task .task-details-container .bottom .ask-group{margin-inline-start:8px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .top.add-new-task .check-and-title .task-content{display:grid;grid-auto-flow:row;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top.add-new-task .task-options.new-task-action-buttons{flex-direction:row;column-gap:4px}}
`];l();c();d();var S6={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding a task...",addTaskButtonSubtitle:"Add",due:"Due ",addTaskDate:"Add the task date",assign:"Assign",planNotFound:"Plan not found",plansSelfAssigned:"All Plans",bucketNotFound:"Bucket not found",bucketsSelfAssigned:"All Tasks",baseSelfAssigned:"Assigned to Me"};l();c();d();ge();l();c();d();ge();var fn=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},kx=["Tasks.ReadWrite","Group.ReadWrite.All"],op=["Tasks.Read","Group.Read.All","Tasks.ReadWrite","Group.ReadWrite.All"],_6=(r,e)=>fn(void 0,void 0,void 0,function*(){return yield r.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(be(kx)).post(e)}),T6=(r,e,t)=>fn(void 0,void 0,void 0,function*(){yield Sx(r,e,{assignments:t,appliedCategories:{category4:!0}})}),E6=(r,e)=>fn(void 0,void 0,void 0,function*(){yield r.api(`/planner/tasks/${e.id}`).header("Cache-Control","no-store").header("If-Match",e.eTag).middlewareOptions(be(kx)).delete()}),I6=(r,e)=>fn(void 0,void 0,void 0,function*(){yield Sx(r,e,{percentComplete:100})}),A6=(r,e)=>fn(void 0,void 0,void 0,function*(){yield Sx(r,e,{percentComplete:0})}),Sx=(r,e,t)=>fn(void 0,void 0,void 0,function*(){let o;try{o=yield r.api(`/planner/tasks/${e.id}`).header("Cache-Control","no-store").middlewareOptions(be(kx)).header("Prefer","return=representation").header("If-Match",e.eTag).update(t)}catch{}return o}),R6=(r,e)=>fn(void 0,void 0,void 0,function*(){let t=`/groups/${e}/planner/plans`,o=yield r.api(t).header("Cache-Control","no-store").middlewareOptions(be(op)).get();return o?.value}),P6=(r,e)=>fn(void 0,void 0,void 0,function*(){return yield r.api(`/planner/plans/${e}`).header("Cache-Control","no-store").middlewareOptions(be(op)).get()}),$6=(r,e)=>fn(void 0,void 0,void 0,function*(){let t=yield r.api(`/planner/plans/${e}/buckets`).header("Cache-Control","no-store").middlewareOptions(be(op)).get();return t?.value}),O6=r=>fn(void 0,void 0,void 0,function*(){let e=yield r.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(be(op)).get();return e?.value}),M6=(r,e)=>fn(void 0,void 0,void 0,function*(){let t=yield r.api(`/planner/buckets/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(be(op)).get();return t?.value});var Zn=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},_x=class{constructor(e){this.graph=wc.fromGraph(e)}},Lv=class extends _x{getTaskGroups(){return Zn(this,void 0,void 0,function*(){return(yield O6(this.graph)).map(t=>{var o;return{id:t.id,title:t.title,containerId:(o=t?.container)===null||o===void 0?void 0:o.containerId}})})}getTaskGroupsForGroup(e){return Zn(this,void 0,void 0,function*(){return(yield R6(this.graph,e)).map(o=>({id:o.id,title:o.title}))})}getTaskGroup(e){return Zn(this,void 0,void 0,function*(){let t=yield P6(this.graph,e);return{id:t.id,title:t.title,_raw:t}})}getTaskFoldersForTaskGroup(e){return Zn(this,void 0,void 0,function*(){return(yield $6(this.graph,e)).map(o=>({_raw:o,id:o.id,name:o.name,parentId:o.planId}))})}getTasksForTaskFolder(e){return Zn(this,void 0,void 0,function*(){return(yield M6(this.graph,e)).map(o=>({_raw:o,assignments:o.assignments,completed:o.percentComplete===100,dueDate:o.dueDateTime&&new Date(o.dueDateTime),eTag:o["@odata.etag"],id:o.id,immediateParentId:o.bucketId,name:o.title,topParentId:o.planId}))})}setTaskComplete(e){return Zn(this,void 0,void 0,function*(){return yield I6(this.graph,e)})}setTaskIncomplete(e){return Zn(this,void 0,void 0,function*(){return A6(this.graph,e)})}addTask(e){var t;return Zn(this,void 0,void 0,function*(){return yield _6(this.graph,{assignments:e.assignments,bucketId:e.immediateParentId,dueDateTime:(t=e.dueDate)===null||t===void 0?void 0:t.toISOString(),planId:e.topParentId,title:e.name})})}assignPeopleToTask(e,t){return Zn(this,void 0,void 0,function*(){return T6(this.graph,e,t)})}removeTask(e){return Zn(this,void 0,void 0,function*(){return yield E6(this.graph,e)})}isAssignedToMe(e,t){return Object.keys(e.assignments).includes(t)}};Yr();l();c();d();cr();var Nv=r=>{let e=Oi.getValueFor(r);return $i(Xe.create(e,e,e))};Mr();cr();ge();var Kt=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Wt=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},qi=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Tx={"@odata.type":"#microsoft.graph.plannerAssignment",orderHint:" !"},Ex=()=>{at(xC,Zl,cn,Or,Yl,Jl),v6(),x6(),Ba(),cc(),tp(),Re("planner",Pt)},Pt=class extends it{static get styles(){return k6}get strings(){return S6}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(e){this._isNewTaskVisible=e,e||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="",this._newTaskContainerId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...Fr.requiredScopes,...ft.requiredScopes])]}get filteredTasks(){let e=this._tasks.filter(t=>this.isTaskInSelectedGroupFilter(t)).filter(t=>this.isTaskInSelectedFolderFilter(t)).filter(t=>!this._hiddenTasks.includes(t.id));return this.taskFilter?e.filter(t=>this.taskFilter(t._raw)):e}constructor(){super(),this._isDarkMode=!1,this._me=null,this.renderLoading=()=>this._hasDoneInitialLoad?this.renderContent():this.renderLoadingTask(),this.renderContent=()=>{let e=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null,t;return this.hideHeader||(t=x`
        <div class="header">
          ${this.renderPlanOptions()}
        </div>
      `),x`
      ${t}
      <div class="tasks">
        ${this._isNewTaskVisible?this.renderNewTask():null} ${e}
        ${co(this.filteredTasks,o=>o.id,o=>this.renderTask(o))}
      </div>
    `},this.onResize=()=>{this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())},this.onThemeChanged=()=>{this._isDarkMode=Nv(this)},this.onAddTaskClick=()=>{var e;let t=this.getPeoplePicker(null),o={};if(t)for(let i of(e=t?.selectedPeople)!==null&&e!==void 0?e:[])o[i.id]=Tx;!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,o)},this.onAddTaskKeyDown=e=>{(e.key==="Enter"||e.key===" ")&&this.onAddTaskClick()},this.addNewTaskButtonClick=()=>{this.isNewTaskVisible=!this.isNewTaskVisible},this.newTaskVisible=e=>{e.key==="Enter"&&(this.isNewTaskVisible=!1)},this.handleDateChange=e=>{let t=e.target.value;t?this._newTaskDueDate=new Date(t+"T17:00"):this._newTaskDueDate=null},this.renderPlannerIcon=e=>Z(P.Planner,e),this.renderBucketIcon=e=>Z(P.Milestone,e),this.handlePeopleClick=(e,t)=>{this.togglePeoplePicker(t),e.stopPropagation()},this.handlePeopleKeydown=(e,t)=>{(e.key==="Enter"||e.key===" ")&&(this.togglePeoplePicker(t),e.stopPropagation(),e.preventDefault())},this.handlePeoplePickerKeydown=e=>{e.key==="Enter"&&e.stopPropagation()},this.clearState(),this.previousMediaQuery=this.mediaQuery}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("resize",this.onResize),window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1}firstUpdated(e){super.firstUpdated(e),this.initialId&&!this._currentGroup&&(this._currentGroup=this.initialId),this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}loadState(){return qi(this,void 0,void 0,function*(){let e=this.getTaskSource();if(!e)return;let t=V.globalProvider;if(!(!t||t.state!==oe.SignedIn)){if(this._inTaskLoad=!0,!this._me){let o=t.graph.forComponent(this);this._me=yield Dh(o)}this.groupId?yield this._loadTasksForGroup(e):this.targetId?yield this._loadTargetPlannerTasks(e):yield this._loadAllTasks(e),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0}})}_loadTargetPlannerTasks(e){return qi(this,void 0,void 0,function*(){let t=yield e.getTaskGroup(this.targetId),o=yield e.getTaskFoldersForTaskGroup(t.id);this.targetBucketId&&(o=o.filter(n=>n.id===this.targetBucketId));let i=(yield Promise.all(o.map(n=>e.getTasksForTaskFolder(n.id,n.parentId)))).reduce((n,s)=>[...n,...s],[]);this._tasks=i,this._folders=o,this._groups=[t]})}_loadAllTasks(e){return qi(this,void 0,void 0,function*(){let t=yield e.getTaskGroups(),o=(yield Promise.all(t.map(n=>e.getTaskFoldersForTaskGroup(n.id)))).reduce((n,s)=>[...n,...s],[]),i=(yield Promise.all(o.map(n=>e.getTasksForTaskFolder(n.id,n.parentId)))).reduce((n,s)=>[...n,...s],[]);this._tasks=i,this._folders=o,this._groups=t})}_loadTasksForGroup(e){return qi(this,void 0,void 0,function*(){let t=yield e.getTaskGroupsForGroup(this.groupId),o=(yield Promise.all(t.map(n=>e.getTaskFoldersForTaskGroup(n.id)))).reduce((n,s)=>[...n,...s],[]),i=(yield Promise.all(o.map(n=>e.getTasksForTaskFolder(n.id,n.parentId)))).reduce((n,s)=>[...n,...s],[]);this._tasks=i,this._folders=o,this._groups=t})}addTask(e,t,o,i,n={}){return qi(this,void 0,void 0,function*(){let s=this.getTaskSource();if(!s)return;let a={assignments:n,dueDate:t,immediateParentId:i,name:e,topParentId:o};this._newTaskBeingAdded=!0,a._raw=yield s.addTask(a),this.fireCustomEvent("taskAdded",a),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1,yield this._task.run()})}completeTask(e){return qi(this,void 0,void 0,function*(){let t=this.getTaskSource();t&&(yield t.setTaskComplete(e),this.fireCustomEvent("taskChanged",e),yield this._task.run())})}uncompleteTask(e){return qi(this,void 0,void 0,function*(){let t=this.getTaskSource();t&&(yield t.setTaskIncomplete(e),this.fireCustomEvent("taskChanged",e),yield this._task.run())})}removeTask(e,t){return qi(this,void 0,void 0,function*(){let o=this.getTaskSource();o&&(t instanceof KeyboardEvent&&t.key!=="Enter"||(this._hiddenTasks=[...this._hiddenTasks,e.id],yield o.removeTask(e),this.fireCustomEvent("taskRemoved",e),yield this._task.run(),this._hiddenTasks=this._hiddenTasks.filter(i=>i!==e.id)))})}assignPeople(e,t=[]){return qi(this,void 0,void 0,function*(){let o=this.getTaskSource();if(!o)return;let i=[];e&&e.assignments&&(i=Object.keys(e.assignments).sort());let n=t.map(u=>u.id);if(n.length===i.length&&n.sort().every((u,h)=>u===i[h]))return;let a={};for(let u of i)n.includes(u)?a[u]=Tx:a[u]=null;n.forEach(u=>{i.includes(u)||(a[u]=Tx)}),e&&(yield o.assignPeopleToTask(e,a),yield this._task.run())})}renderPlanOptions(){var e;let t=V.globalProvider;if(!t||t.state!==oe.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return x`<span class="loading-header"></span>`;let o=this.readOnly||this._isNewTaskVisible?null:x`
          <fluent-button
            appearance="accent"
            class="new-task-button"
            @click=${this.addNewTaskButtonClick}>
              <span slot="start">${Z(P.Add,"currentColor")}</span>
              ${this.strings.addTaskButtonSubtitle}
          </fluent-button>
        `,i=this._groups.find(f=>f.id===this._currentGroup)||{title:this.strings.baseSelfAssigned},n={[this.strings.baseSelfAssigned]:()=>{this._currentGroup=null,this._currentFolder=null}};for(let f of this._groups)n[f.title]=()=>{this._currentGroup=f.id,this._currentFolder=null};let s=Te`
        <mgt-arrow-options
          class="arrow-options"
          .options="${n}"
          .value="${i.title}"
        ></mgt-arrow-options>`,a=this._currentGroup?Z(P.ChevronRight):null,u=this._folders.find(f=>f.id===this._currentFolder)||{name:this.strings.bucketsSelfAssigned},h={[this.strings.bucketsSelfAssigned]:()=>{this._currentFolder=null}};for(let f of this._folders.filter(b=>b.parentId===this._currentGroup))h[f.name]=()=>{this._currentFolder=f.id};let p=this.targetBucketId?x`
            <span class="plan-title">
              ${((e=this._folders[0])===null||e===void 0?void 0:e.name)||""}
            </span>`:Te`
            <mgt-arrow-options class="arrow-options" .options="${h}" .value="${u.name}"></mgt-arrow-options>
          `;return x`
        <div class="title">
          ${s} ${a} ${this._currentGroup?p:null}
        </div>
        ${o}
      `}renderNewTask(){let e="var(--neutral-foreground-hint)",t=x`
      <fluent-text-field
        autocomplete="off"
        ?autofocus=${this.isNewTaskVisible}
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        class="new-task"
        aria-label=${this.strings.newTaskPlaceholder}
        @input=${b=>this._newTaskName=b.target.value}>
      </fluent-text-field>`;this._groups.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=this._groups[0].id);let o=x`
      ${co(this._groups,b=>b.id,b=>x`<fluent-option value="${b.id}">${b.title}</fluent-option>`)}`,i=this._currentGroup?x`
          <span class="new-task-group">
            ${this.renderPlannerIcon(e)}
            <span>${this.getPlanTitle(this._currentGroup)}</span>
          </span>`:x`
            <fluent-select>
              <span slot="start">${this.renderPlannerIcon(e)}</span>
              ${this._groups.length>0?o:x`<fluent-option selected>No groups found</fluent-option>`}
            </fluent-select>`,n=this._folders.filter(b=>this._currentGroup&&b.parentId===this._currentGroup||!this._currentGroup&&b.parentId===this._newTaskGroupId);n.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=n[0].id);let s=x`
      ${co(n,b=>b.id,b=>x`<fluent-option value="${b.id}">${b.name}</fluent-option>`)}`,a=this._currentFolder?x`
          <span class="new-task-bucket">
            ${this.renderBucketIcon(e)}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `:x`
         <fluent-select>
          <span slot="start">${this.renderBucketIcon(e)}</span>
          ${n.length>0?s:x`<fluent-option selected>No folders found</fluent-option>`}
        </fluent-select>`,u={dark:this._isDarkMode,"new-task":!0},h=x`
      <fluent-text-field
        autocomplete="off"
        type="date"
        class=${ze(u)}
        aria-label="${this.strings.addTaskDate}"
        .value="${this.dateToInputValue(this._newTaskDueDate)}"
        @change=${this.handleDateChange}>
      </fluent-text-field>`,p=this.renderAssignedPeople(null),f=this._newTaskBeingAdded?x`<div class="task-add-button-container"></div>`:x`
          <fluent-button
            class="add-task"
            ?disabled=${!this._newTaskName}
            @click=${this.onAddTaskClick}
            @keydown=${this.onAddTaskKeyDown}
            appearance="neutral">
              ${this.strings.addTaskButtonSubtitle}
          </fluent-button>
          <fluent-button
            class="cancel-task"
            @click=${()=>this.isNewTaskVisible=!1}
            @keydown=${this.newTaskVisible}
            appearance="neutral">
              ${this.strings.cancelNewTaskSubtitle}
          </fluent-button>`;return x`
    <div
      class=${ze({task:!0,"new-task":!0})}>
      <div class="task-details-container">
        <div class="top add-new-task">
          <div class="check-and-title">
            ${t}
            <div class="task-content">
              <div class="task-group">${i}</div>
              <div class="task-bucket">${a}</div>
              ${p}
              <div class="task-due">${h}</div>
            </div>
          </div>
          <div class="task-options new-task-action-buttons">${f}</div>
        </div>
      </div>
    </div>
  `}togglePeoplePicker(e){let t=this.getPeoplePicker(e),o=this.getMgtPeople(e),i=this.getFlyout(e);t&&o&&i&&(i.isOpen?i.close():(t.selectedPeople=o.people,i.open(),setTimeout(()=>t.focus(),100)))}updateAssignedPeople(e){let t=this.getPeoplePicker(e),o=this.getMgtPeople(e);t&&t.selectedPeople!==o.people&&(o.people=t.selectedPeople,this.assignPeople(e,t.selectedPeople))}getPeoplePicker(e){let t=e?e.id:"new-task";return this.renderRoot.querySelector(`.picker-${t}`)}getMgtPeople(e){let t=e?e.id:"new-task";return this.renderRoot.querySelector(`.people-${t}`)}getFlyout(e){let t=e?e.id:"new-task";return this.renderRoot.querySelector(`.flyout-${t}`)}renderTask(e){let{name:t="Task",completed:o=!1,dueDate:i}=e,n=this._currentGroup?null:this.getPlanTitle(e.topParentId),s=this._currentFolder?null:this.getFolderName(e.immediateParentId),a={task:Object.assign(Object.assign({},e._raw),{groupTitle:n,folderTitle:s})},u=this.renderTemplate("task",a,e.id);if(u)return u;let h=this.renderTemplate("task-details",a,`task-details-${e.id}`);if(!h){let b="var(--neutral-foreground-hint)",C=this._currentGroup?null:x`
              <div class="task-group">
                <span class="task-icon">${this.renderPlannerIcon(b)}</span>
                <span class="task-icon-text">${this.getPlanTitle(e.topParentId)}</span>
              </div>
            `,S=this._currentFolder?null:x`
            <div class="task-bucket">
              <span class="task-icon">${this.renderBucketIcon(b)}</span>
              <span class="task-icon-text">${this.getFolderName(e.immediateParentId)}</span>
            </div>
          `,R=i?x`
            <div class="task-due">
              <span class="task-icon-text">${this.strings.due}${q3(i)}</span>
            </div>
          `:null,N=this.renderAssignedPeople(e);h=x`${C} ${S} ${N} ${R}`}let p=this.readOnly||this.hideOptions?null:Te`
            <mgt-dot-options
              class="dot-options"
              .options="${{[this.strings.removeTaskSubtitle]:b=>this.removeTask(e,b)}}"
            ></mgt-dot-options>`,f=ze({task:!0,complete:o,incomplete:!o,"read-only":this.readOnly});return x`
      <div
        data-id="task-${e.id}"
        class=${f}
        @click=${()=>this.handleTaskClick(e)}>
        <div class="task-details-container">
          <div class="top">
            <div class="check-and-title">
              <fluent-checkbox
                @click=${b=>this.handleTaskCheckClick(b,e)}
                @keydown=${b=>this.handleTaskCheckKeyDown(b,e)}
                ?checked=${o}>
                  ${t}
              </fluent-checkbox>
            </div>
            <div class="task-options">${p}</div>
          </div>
          <div class="bottom">${h}</div>
        </div>
      </div>
    `}handleTaskCheckKeyDown(e,t){return qi(this,void 0,void 0,function*(){e.key==="Enter"&&(e.stopPropagation(),e.preventDefault(),yield this.checkTask(t))})}handleTaskCheckClick(e,t){return qi(this,void 0,void 0,function*(){e.stopPropagation(),e.preventDefault(),yield this.checkTask(t)})}checkTask(e){return qi(this,void 0,void 0,function*(){if(!this.readOnly){let t=this.shadowRoot.querySelector(`[data-id='task-${e.id}'`);t&&t.classList.add("updating"),e.completed?yield this.uncompleteTask(e):yield this.completeTask(e),t&&t.classList.remove("updating")}})}renderAssignedPeople(e){var t;let o,i={"new-task-assignee":e===null,"task-assignee":e!==null,"task-detail":e!==null},n=e?e.id:"new-task";i[`flyout-${n}`]=!0;let s=e?Object.keys(e.assignments).map(p=>p):[];if(!this.newTaskVisible){let p=e?._raw,f=p?.planId;f&&(o=(t=this._groups.filter(C=>C.id===f).pop())===null||t===void 0?void 0:t.containerId)}let a=this.isNewTaskVisible?this._newTaskContainerId:o,u=Te`
      <mgt-people
        class="people people-${n}"
        .userIds=${s}
        person-card="none"
        @click=${p=>this.handlePeopleClick(p,e)}
        @keydown=${p=>this.handlePeopleKeydown(p,e)}
      >
        <template data-type="no-data">
          <fluent-button>
            <span style="display:flex;place-content:start;gap:4px;padding-inline-start:4px">
              <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">
                <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>
                <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>
                <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>
              </svg> Assign</span>
            </fluent-button>
        </template>
      </mgt-people>`,h=Te`
      <mgt-people-picker
        class="people-picker picker-${n}"
        .groupId=${Zo(a)}
        @keydown=${this.handlePeoplePickerKeydown}>
      ></mgt-people-picker>`;return Te`
      <mgt-flyout
        light-dismiss
        class=${ze(i)}
        @closed=${()=>this.updateAssignedPeople(e)}
      >
        <div slot="anchor">${u}</div>
        <div slot="flyout" part="picker" class="picker">${h}</div>
      </mgt-flyout>
    `}handleTaskClick(e){e&&this.fireCustomEvent("taskClick",e)}renderLoadingTask(){return x`
      <div class="header">
        <div class="title">
          <fluent-skeleton shimmer class="shimmer" shape="rect"></fluent-skeleton>
        </div>
        <div class="new-task-button">
          <fluent-skeleton shimmer class="shimmer" shape="rect"></fluent-skeleton>
        </div>
      </div>
      <div class="tasks">
        <div class="task incomplete">
          <div class="task-details-container">
            <div class="top">
              <div class="check-and-title shimmer">
                <fluent-skeleton shimmer class="checkbox" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="title" shape="rect"></fluent-skeleton>
              </div>
              <div class="task-options">
                <fluent-skeleton shimmer class="options" shape="rect"></fluent-skeleton>
              </div>
            </div>
            <div class="bottom">
              <div class="task-group">
                <div class="task-icon">
                  <fluent-skeleton shimmer class="shimmer icon" shape="rect"></fluent-skeleton>
                </div>
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              <div class="task-bucket">
                <div class="task-icon">
                  <fluent-skeleton shimmer class="shimmer icon" shape="rect"></fluent-skeleton>
                </div>
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              <div class="task-details shimmer">
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
              </div>
              <div class="task-due">
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              </div>
          </div>
        </div>
      </div>
    `}getTaskSource(){let e=V.globalProvider;if(!e||e.state!==oe.SignedIn)return null;let t=e.graph.forComponent(this);return new Lv(t)}getPlanTitle(e){return e?e===this.strings.plansSelfAssigned?this.strings.plansSelfAssigned:(this._groups.find(t=>t.id===e)||{title:this.strings.planNotFound}).title:this.strings.baseSelfAssigned}getFolderName(e){return e?(this._folders.find(t=>t.id===e)||{name:this.strings.bucketNotFound}).name:this.strings.bucketsSelfAssigned}isTaskInSelectedGroupFilter(e){var t;return!this._currentGroup||e.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(e,(t=this._me)===null||t===void 0?void 0:t.id)}isTaskInSelectedFolderFilter(e){return e.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(e){return e?new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().split("T")[0]:null}};Kt([E({attribute:"read-only",type:Boolean}),Wt("design:type",Boolean)],Pt.prototype,"readOnly",void 0);Kt([E({attribute:"target-id",type:String}),Wt("design:type",String)],Pt.prototype,"targetId",void 0);Kt([E({attribute:"target-bucket-id",type:String}),Wt("design:type",String)],Pt.prototype,"targetBucketId",void 0);Kt([E({attribute:"initial-id",type:String}),Wt("design:type",String)],Pt.prototype,"initialId",void 0);Kt([E({attribute:"initial-bucket-id",type:String}),Wt("design:type",String)],Pt.prototype,"initialBucketId",void 0);Kt([E({attribute:"hide-header",type:Boolean}),Wt("design:type",Boolean)],Pt.prototype,"hideHeader",void 0);Kt([E({attribute:"hide-options",type:Boolean}),Wt("design:type",Boolean)],Pt.prototype,"hideOptions",void 0);Kt([E({attribute:"group-id",type:String}),Wt("design:type",String)],Pt.prototype,"groupId",void 0);Kt([X(),Wt("design:type",Boolean)],Pt.prototype,"_isNewTaskVisible",void 0);Kt([X(),Wt("design:type",Boolean)],Pt.prototype,"_newTaskBeingAdded",void 0);Kt([X(),Wt("design:type",String)],Pt.prototype,"_newTaskName",void 0);Kt([X(),Wt("design:type",Date)],Pt.prototype,"_newTaskDueDate",void 0);Kt([X(),Wt("design:type",String)],Pt.prototype,"_newTaskGroupId",void 0);Kt([X(),Wt("design:type",String)],Pt.prototype,"_newTaskFolderId",void 0);Kt([X(),Wt("design:type",String)],Pt.prototype,"_newTaskContainerId",void 0);Kt([X(),Wt("design:type",Array)],Pt.prototype,"_groups",void 0);Kt([X(),Wt("design:type",Array)],Pt.prototype,"_folders",void 0);Kt([X(),Wt("design:type",Array)],Pt.prototype,"_tasks",void 0);Kt([X(),Wt("design:type",Array)],Pt.prototype,"_hiddenTasks",void 0);Kt([X(),Wt("design:type",Boolean)],Pt.prototype,"_inTaskLoad",void 0);Kt([X(),Wt("design:type",Boolean)],Pt.prototype,"_hasDoneInitialLoad",void 0);Kt([X(),Wt("design:type",String)],Pt.prototype,"_currentGroup",void 0);Kt([X(),Wt("design:type",String)],Pt.prototype,"_currentFolder",void 0);Kt([X(),Wt("design:type",Object)],Pt.prototype,"_isDarkMode",void 0);Kt([X(),Wt("design:type",Object)],Pt.prototype,"_me",void 0);l();c();d();xe();gt();pi();Cu();ge();ys();Yr();Jo();l();c();d();xe();var F6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .container{display:flex;flex-direction:column;position:relative}:host .dropdown{display:none;position:absolute;z-index:1000;top:34px}:host .dropdown.visible{display:flex}:host .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text{font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text{margin:auto}:host fluent-card{background:var(--channel-picker-dropdown-background-color,var(--fill-color));padding:2px;--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){background:padding-box linear-gradient(var(--channel-picker-input-background-color,var(--neutral-fill-input-rest)),var(--channel-picker-input-background-color,var(--neutral-fill-input-rest))),border-box var(--channel-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover)),var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover))),border-box var(--channel-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus)),var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus))),border-box var(--channel-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(control){word-spacing:inherit;text-indent:inherit;letter-spacing:inherit;padding:0}:host fluent-text-field::part(control)::placeholder{color:var(--channel-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--channel-picker-input-placeholder-text-color-hover,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--channel-picker-input-placeholder-text-color-focus,var(--input-placeholder-filled))}:host fluent-text-field .search-icon svg path{fill:var(--channel-picker-search-icon-color,currentColor)}:host fluent-text-field .search-icon::part(control){border-color:transparent}:host fluent-text-field .down-chevron{height:auto;min-width:auto}:host fluent-text-field .down-chevron svg path{fill:var(--channel-picker-down-chevron-color,currentColor)}:host fluent-text-field .up-chevron{height:auto;min-width:auto}:host fluent-text-field .up-chevron svg path{fill:var(--channel-picker-up-chevron-color,currentColor)}:host fluent-text-field .close-icon{height:auto;min-width:auto}:host fluent-text-field .close-icon svg path{fill:var(--channel-picker-close-icon-color,currentColor)}:host fluent-tree-view{min-width:100%;--tree-item-nested-width:2em}:host fluent-tree-item{width:100%;--tree-item-nested-width:2em}:host fluent-tree-item:focus-visible{outline:0}:host fluent-tree-item::part(expand-collapse-button){background:0 0}:host fluent-tree-item::part(content-region),:host fluent-tree-item::part(positioning-region){color:var(--channel-picker-dropdown-item-text-color,currentColor);background:var(--channel-picker-dropdown-background-color,transparent);border:calc(var(--stroke-width) * 2px) solid transparent;height:auto}:host fluent-tree-item::part(content-region):hover,:host fluent-tree-item::part(positioning-region):hover{background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item::part(content-region):hover::part(expand-collapse-button),:host fluent-tree-item::part(positioning-region):hover::part(expand-collapse-button){background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item fluent-tree-item::part(content-region){height:auto}:host fluent-breadcrumb-item{color:var(--channel-picker-dropdown-item-text-color-selected,var(--neutral-foreground-rest))}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--channel-picker-arrow-fill,var(--neutral-foreground-rest))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{transform:scaleX(-1);filter:fliph;filter:"FlipH";margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:rgb(255,255,255)!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:rgb(0,0,0)!important}}
`];l();c();d();ge();_d();Ni();var Ix=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},kD=["Team.ReadBasic.All","TeamSettings.Read.All","TeamSettings.ReadWrite.All","User.Read.All","User.ReadWrite.All"],SD=["Channel.ReadBasic.All","ChannelSettings.Read.All","ChannelSettings.ReadWrite.All"],_D=["Team.ReadBasic.All","TeamSettings.Read.All","TeamSettings.ReadWrite.All"],D6=r=>Ix(void 0,void 0,void 0,function*(){let e=kD,t=yield r.api("/me/joinedTeams").select(["displayName","id","isArchived"]).middlewareOptions(be(e)).get();return t?.value}),L6=(r,e)=>Ix(void 0,void 0,void 0,function*(){let t,o={};if(fi()){t=W.getCache(H.photos,H.photos.stores.teams);for(let i of e)try{let n=yield t.getValue(i);n&&oc()>Date.now()-n.timeCached&&(o[i]=n)}catch{}if(Object.keys(o).length)return o}o={};for(let i of e)try{let n=yield Vs(r,`/teams/${i}`,_D);fi()&&n&&(yield t.putValue(i,n)),o[i]=n}catch{}return o}),N6=(r,e)=>Ix(void 0,void 0,void 0,function*(){var t,o;let i=r.createBatch();for(let a of e)i.get(a.id,`teams/${a.id}/channels`,SD);let n=yield i.executeAll(),s=[];for(let a of e){let u=n.get(a.id);!((o=(t=u?.content)===null||t===void 0?void 0:t.value)===null||o===void 0)&&o.length&&s.push({item:a,channels:u.content.value.map(h=>({item:h}))})}return s});l();c();d();var H6={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",photoFor:"Teams photo for",teamsChannels:"Teams and channels results",closeButtonAriaLabel:"remove the selected channel",downChevronButtonAriaLabel:"Teams show results",upChevronButtonAriaLabel:"Teams hide results",searchButtonAriaLabel:"Search icon"};sc();Mr();cr();ge();qs();var B6=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},z6=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},U6=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Ax=()=>{at(Dw,Nw,ln,UC,zC,cn),dn(),Re("teams-channel-picker",ip)},ip=class extends it{static get styles(){return F6}get strings(){return H6}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return["team.readbasic.all","channel.readbasic.all"]}set items(e){this._items!==e&&(this._items=e,this._treeViewState=e?this.generateTreeViewState(e):[],this.resetFocusState())}get items(){return this._items}get _inputWrapper(){return this.renderRoot.querySelector("fluent-text-field")}get _input(){let e=this._inputWrapper;return e?.shadowRoot.querySelector("input")}constructor(){super(),this.teamsPhotos={},this._inputValue="",this._treeViewState=[],this._focusList=[],this.renderLoading=()=>this.renderContent(),this.renderContent=()=>{var e;let t={dropdown:!0,visible:this._isDropdownVisible};return this.renderTemplate("default",{teams:(e=this.items)!==null&&e!==void 0?e:[]})||x`
        <div class="container" @blur=${this.lostFocus}>
          <fluent-text-field
            autocomplete="off"
            appearance="outline"
            id="teams-channel-picker-input"
            role="combobox"
            placeholder="${this._selectedItemState?"":this.strings.inputPlaceholderText} "
            aria-label=${this.strings.inputPlaceholderText}
            aria-expanded="${this._isDropdownVisible}"
            label="teams-channel-picker-input"
            @focus=${this.handleFocus}
            @keyup=${this.handleInputChanged}
            @click=${this.handleInputClick}
            @keydown=${this.handleInputKeydown}
          >
            <div slot="start" style="width: max-content;" @keydown=${this.handleStartSlotKeydown}>${this.renderSelected()}</div>
            <div slot="end" @keydown=${this.handleChevronKeydown}>${this.renderChevrons()}${this.renderCloseButton()}</div>
          </fluent-text-field>
          <fluent-card
            class=${ze(t)}
          >
            ${this.renderDropdown()}
          </fluent-card>
        </div>`},this.handleInputClick=e=>{e.stopPropagation(),this.gainedFocus()},this.handleInputKeydown=e=>{let t=e.key;["ArrowDown","Enter"].includes(t)?this._isDropdownVisible?this.renderRoot.querySelector("fluent-tree-item").focus():this.gainedFocus():t==="Escape"?this.lostFocus():t==="Tab"&&this.blurPicker()},this.onClickCloseButton=()=>{this.removeSelectedChannel(null)},this.onKeydownCloseButton=e=>{e.key==="Enter"&&this.removeSelectedChannel(null)},this.renderError=()=>this.renderTemplate("error",null,"error")||x`
        <div class="message-parent">
          <div
            label="search-error-text"
            aria-live="polite"
            aria-relevant="all"
            aria-atomic="true"
            class="search-error-text"
          >
            ${this.strings.noResultsFound}
          </div>
        </div>
      `,this.renderLoadingIndicator=()=>this.renderTemplate("loading",null,"loading")||Te`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `,this.onKeydownTreeView=e=>{e.key==="Escape"&&this.lostFocus()},this.handleTeamTreeItemClick=e=>{e.preventDefault(),e.stopImmediatePropagation();let t=e.target;t&&(t.hasAttribute("expanded")?t.removeAttribute("expanded"):t.setAttribute("expanded","true"),t.hasAttribute("id")?t.setAttribute("selected","true"):t.removeAttribute("selected"))},this.handleInputChanged=e=>{let t=e.target;if(this._inputValue!==t?.value)this._inputValue=t?.value;else return;e.key!=="Tab"&&e.key!=="Enter"&&e.key!=="Escape"&&this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=Na(()=>{this.filterList()},400)),this.debouncedSearch()},this.loadTeamsIfNotLoaded=()=>{!this.items&&this._task.status!==Js.PENDING&&this._task.run()},this.handleWindowClick=e=>{e.target!==this&&this.lostFocus()},this.gainedFocus=()=>{let e=this._input;e&&e.focus(),this._isDropdownVisible=!0,this.toggleChevron(),this.resetFocusState(),this.requestUpdate()},this.lostFocus=()=>{this._inputValue="",this._input&&(this._input.value=this._inputValue,this._input.textContent="");let e=this._inputWrapper;e&&(e.value="",e.blur()),this._isDropdownVisible=!1,this.filterList(),this.toggleChevron(),this.requestUpdate(),this._selectedItemState!==void 0&&this.showCloseIcon()},this.handleFocus=()=>{this.gainedFocus()},this.handleUpChevronClick=e=>{e.stopPropagation(),this.lostFocus()},this.handleChevronKeydown=e=>{if(e.key==="Tab")this.blurPicker();else if(e.key==="Enter"){e.preventDefault();let t=e.target;t.classList.contains("down-chevron")?this.gainedFocus():t.classList.contains("up-chevron")&&this.lostFocus()}},this.handleStartSlotKeydown=e=>{e.key==="Tab"&&e.shiftKey&&this.blurPicker()},this.blurPicker=()=>{let e=this._inputWrapper,t=this._input;e?.blur(),t?.blur()},this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick),this.addEventListener("focus",this.loadTeamsIfNotLoaded),this.addEventListener("mouseover",this.loadTeamsIfNotLoaded),this.addEventListener("blur",this.lostFocus);let e=this.renderRoot.ownerDocument;e&&e.documentElement.setAttribute("dir",this.direction)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),this.removeEventListener("focus",this.loadTeamsIfNotLoaded),this.removeEventListener("mouseover",this.loadTeamsIfNotLoaded),this.removeEventListener("blur",this.lostFocus),super.disconnectedCallback()}args(){return[]}selectChannelById(e){return U6(this,void 0,void 0,function*(){let t=V.globalProvider;if(t&&t.state===oe.SignedIn){this.items||(yield this._task.run());for(let o of this._treeViewState)for(let i of o.channels)if(i.item.id===e)return o.isExpanded=!0,this.selectChannel(i),this.markSelectedChannelInDropdown(e),!0}return!1})}markSelectedChannelInDropdown(e){let t=this.renderRoot.querySelector(`[id='${e}']`);t&&(t.setAttribute("selected","true"),t.parentElement&&t.parentElement.setAttribute("expanded","true"))}renderSelected(){var e,t,o,i,n,s;if(!this._selectedItemState)return this.renderSearchIcon();let a;if(this._selectedItemState.parent.channels){let p=(e=this.teamsPhotos[this._selectedItemState.parent.item.id])===null||e===void 0?void 0:e.photo;a=x`<img
        class="team-photo"
        alt="${this._selectedItemState.parent.item.displayName}"
        role="img"
        src=${p} />`}let u=(i=(o=(t=this._selectedItemState)===null||t===void 0?void 0:t.parent)===null||o===void 0?void 0:o.item)===null||i===void 0?void 0:i.displayName.trim(),h=(s=(n=this._selectedItemState)===null||n===void 0?void 0:n.item)===null||s===void 0?void 0:s.displayName.trim();return x`
      <fluent-breadcrumb title=${this._selectedItemState.item.displayName}>
        <fluent-breadcrumb-item>
          <span slot="start">${a}</span>
          <span class="team-parent-name">${u}</span>
          <span slot="separator" class="arrow">${Z(P.TeamSeparator,"#000000")}</span>
        </fluent-breadcrumb-item>
        <fluent-breadcrumb-item>${h}</fluent-breadcrumb-item>
      </fluent-breadcrumb>`}clearState(){this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}renderSearchIcon(){return x`
      <fluent-button 
        appearance="outline" 
        class="search-icon" 
        aria-label=${this.strings.searchButtonAriaLabel} 
        @click=${this.handleStartSlotKeydown}>
        ${Z(P.Search)}
      </fluent-button>
    `}renderCloseButton(){return x`
      <fluent-button
        appearance="stealth"
        class="close-icon"
        style="display:none"
        aria-label=${this.strings.closeButtonAriaLabel}
        @click=${this.onClickCloseButton}
        @keydown=${this.onKeydownCloseButton}>
        <svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L4 3.293L7.14645 0.146447C7.34171 -0.0488154 7.65829 -0.0488154 7.85355 0.146447C8.04882 0.341709 8.04882 0.658291 7.85355 0.853553L4.707 4L7.85355 7.14645C8.02712 7.32001 8.0464 7.58944 7.91141 7.78431L7.85355 7.85355C7.67999 8.02712 7.41056 8.0464 7.21569 7.91141L7.14645 7.85355L4 4.707L0.853553 7.85355C0.658291 8.04882 0.341709 8.04882 0.146447 7.85355C-0.0488154 7.65829 -0.0488154 7.34171 0.146447 7.14645L3.293 4L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z" fill="#212121"/>
        </svg>
      </fluent-button>
    `}showCloseIcon(){let e=this.renderRoot.querySelector(".down-chevron"),t=this.renderRoot.querySelector(".up-chevron"),o=this.renderRoot.querySelector(".close-icon");e&&(e.style.display="none"),t&&(t.style.display="none"),o&&(o.style.display=null)}renderDownChevron(){return x`
      <fluent-button
        aria-label=${this.strings.downChevronButtonAriaLabel}
        appearance="stealth"
        class="down-chevron"
        @click=${this.gainedFocus}
        @keydown=${this.handleChevronKeydown}>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.21967 4.46967C2.51256 4.17678 2.98744 4.17678 3.28033 4.46967L6 7.18934L8.71967 4.46967C9.01256 4.17678 9.48744 4.17678 9.78033 4.46967C10.0732 4.76256 10.0732 5.23744 9.78033 5.53033L6.53033 8.78033C6.23744 9.07322 5.76256 9.07322 5.46967 8.78033L2.21967 5.53033C1.92678 5.23744 1.92678 4.76256 2.21967 4.46967Z" fill="#212121" />
        </svg>
      </fluent-button>`}renderUpChevron(){return x`
      <fluent-button
        aria-label=${this.strings.upChevronButtonAriaLabel}
        appearance="stealth"
        style="display:none"
        class="up-chevron"
        @click=${this.handleUpChevronClick}
        @keydown=${this.handleChevronKeydown}>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.21967 7.53033C2.51256 7.82322 2.98744 7.82322 3.28033 7.53033L6 4.81066L8.71967 7.53033C9.01256 7.82322 9.48744 7.82322 9.78033 7.53033C10.0732 7.23744 10.0732 6.76256 9.78033 6.46967L6.53033 3.21967C6.23744 2.92678 5.76256 2.92678 5.46967 3.21967L2.21967 6.46967C1.92678 6.76256 1.92678 7.23744 2.21967 7.53033Z" fill="#212121" />
        </svg>
      </fluent-button>`}renderChevrons(){return x`${this.renderUpChevron()}${this.renderDownChevron()}`}renderDropdown(){return this._task.status===Js.PENDING||!this._treeViewState?this.renderLoadingIndicator():this._treeViewState?this._treeViewState.length===0&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):x``}renderDropdownList(e){if(e&&e.length>0){let t=null;return x`
        <fluent-tree-view
          class="tree-view"
          dir=${this.direction}
          aria-live="polite"
          aria-relevant="all"
          aria-atomic="true"
          aria-label=${this.strings.teamsChannels}
          aria-orientation="horizontal"
          @keydown=${this.onKeydownTreeView}>
          ${co(e,o=>o?.item,o=>{var i;return o.channels&&(t=x`<img
                  class="team-photo"
                  alt="${this.strings.photoFor} ${o.item.displayName}"
                  src=${(i=this.teamsPhotos[o.item.id])===null||i===void 0?void 0:i.photo} />`),x`
                <fluent-tree-item
                  ?expanded=${o?.isExpanded}
                  @click=${this.handleTeamTreeItemClick}>
                    <span slot="start">${t}</span>${o.item.displayName}
                    ${co(o?.channels,n=>n.item,n=>this.renderItem(n))}
                </fluent-tree-item>`})}
        </fluent-tree-view>`}return null}renderItem(e){var t;return x`
      <fluent-tree-item
        id=${(t=e?.item)===null||t===void 0?void 0:t.id}
        @keydown=${o=>this.onUserKeyDown(o,e)}
        @click=${()=>this.handleItemClick(e)}>
          ${e?.item.displayName}
      </fluent-tree-item>`}loadState(){return U6(this,void 0,void 0,function*(){let e=V.globalProvider,t;if(e&&e.state===oe.SignedIn){let o=e.graph.forComponent(this);t=yield D6(o),t=t.filter(n=>!n.isArchived);let i=t.map(n=>n.id);this.teamsPhotos=yield L6(o,i),this._items=yield N6(o,t)}this.filterList(),this.resetFocusState()})}clearSelectedItem(){this.removeSelectedChannel()}removeSelectedChannel(e){this.selectChannel(e);let t=this.renderRoot.querySelectorAll("fluent-tree-item");t&&t.forEach(o=>{o.removeAttribute("expanded"),o.removeAttribute("selected")})}handleItemClick(e){e.channels?e.isExpanded=!e.isExpanded:(this.selectChannel(e),this.lostFocus())}onUserKeyDown(e,t){switch(e.code){case"Enter":this.selectChannel(t),this.resetFocusState(),this.lostFocus(),e.preventDefault();break;case"Backspace":this._inputValue.length===0&&this._selectedItemState&&(this.selectChannel(null),this.resetFocusState(),e.preventDefault());break}}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this.resetFocusState())}generateTreeViewState(e,t="",o=null){let i=[];if(t=t.toLowerCase(),e)for(let n of e){let s;if(t.length===0||n.item.displayName.toLowerCase().includes(t))s={item:n.item,parent:o},n.channels&&(s.channels=this.generateTreeViewState(n.channels,"",s),s.isExpanded=t.length>0);else if(n.channels){let a={item:n.item,parent:o},u=this.generateTreeViewState(n.channels,t,a);u.length>0&&(s=a,s.channels=u,s.isExpanded=!0)}s&&i.push(s)}return i}generateFocusList(e){if(!e||e.length===0)return[];let t=[];for(let o of e)t.push(o),o.channels&&o.isExpanded&&(t=[...t,...this.generateFocusList(o.channels)]);return t}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}selectChannel(e){var t,o;e&&this._selectedItemState!==e?(t=this._input)===null||t===void 0||t.setAttribute("disabled","true"):(o=this._input)===null||o===void 0||o.removeAttribute("disabled"),this._selectedItemState=e,this.lostFocus(),this.fireCustomEvent("selectionChanged",this.selectedItem)}hideCloseIcon(){let e=this.renderRoot.querySelector(".close-icon");e&&(e.style.display="none")}toggleChevron(){let e=this.renderRoot.querySelector(".down-chevron"),t=this.renderRoot.querySelector(".up-chevron");this._isDropdownVisible?(e&&(e.style.display="none"),t&&(t.style.display=null)):(e&&(e.style.display=null,this.hideCloseIcon()),t&&(t.style.display="none")),this.hideCloseIcon()}};B6([X(),z6("design:type",Object)],ip.prototype,"_selectedItemState",void 0);B6([X(),z6("design:type",Boolean)],ip.prototype,"_isDropdownVisible",void 0);l();c();d();xe();gt();pi();Cd();sc();cr();ge();l();c();d();ge();var Hd=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Rx=["Tasks.ReadWrite"],Px=["Tasks.Read","Tasks.ReadWrite"],Hv=(r,e)=>Hd(void 0,void 0,void 0,function*(){let t=yield r.api(`/me/todo/lists/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(be(Px)).get();return t?.value});var V6=r=>Hd(void 0,void 0,void 0,function*(){let e=yield r.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(be(Px)).get();return e?.value}),$x=(r,e)=>Hd(void 0,void 0,void 0,function*(){return yield r.api(`/me/todo/lists/${e}`).header("Cache-Control","no-store").middlewareOptions(be(Px)).get()}),q6=(r,e,t)=>Hd(void 0,void 0,void 0,function*(){return yield r.api(`/me/todo/lists/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(be(Rx)).post(t)});var G6=(r,e,t)=>Hd(void 0,void 0,void 0,function*(){yield r.api(`/me/todo/lists/${e}/tasks/${t}`).header("Cache-Control","no-store").middlewareOptions(be(Rx)).delete()});var Ox=(r,e,t,o)=>Hd(void 0,void 0,void 0,function*(){return yield r.api(`/me/todo/lists/${e}/tasks/${t}`).header("Cache-Control","no-store").middlewareOptions(be(Rx)).patch(o)});l();c();d();xe();var j6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{display:flex;flex-direction:column;color:var(--color,var(--neutral-foreground-rest))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;appearance:none}:host .task-icon{font-family:FabricMDL2Icons;user-select:none}:host .task-icon.divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .header{margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .header select{font-size:var(--tasks-plan-title-font-size, 1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;appearance:none;cursor:pointer}:host .header select::-ms-expand{display:none}:host .header .plan-title{font-size:var(--tasks-plan-title-font-size, 1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .header .add-bar{display:flex}:host .header .add-bar .add-bar-item{flex:1 1 auto}:host .header .new-task-due{display:flex}:host .header .new-task-due input{flex:1 1 auto;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .header .title-cont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .header .new-task-button{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;cursor:pointer}:host .header .new-task-button span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .header .new-task-button .task-icon{margin-right:8px}:host .header .new-task-button.hidden{visibility:hidden}:host .header .new-task-button:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .header .new-task-button:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .task{position:relative;margin:var(--task-margin,0 0 0 0);padding:var(--task-padding,0 0 0 0);background-color:var(--task-background-color,var(--neutral-layer-floating));border:var(--task-border,var(--neutral-stroke-input-active));border-radius:8px}:host .task .task-content{display:flex}:host .task .task-content .divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-content .task-details-container{flex:1;display:grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .task .task-content .task-details-container .task-detail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .task .task-content .task-details-container .task-title{color:var(--task-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;grid-row:1;grid-column:1/3;grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .task .task-content .task-details-container .task-group{min-height:24px;grid-row:2;grid-column:1}:host .task .task-content .task-details-container .task-bucket{min-height:24px;grid-row:2;grid-column:2}:host .task .task-content .task-details-container .task-due{justify-content:flex-end;align-items:flex-start;grid-row:4;grid-column:1/3;grid-column:1;-ms-grid-column-span:2}:host .task .task-content .task-details-container.tablet{grid-template-columns:1fr 0.5fr 1fr 0.5fr;-ms-grid-columns:1fr 0.5fr 1fr 0.5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .task .task-content .task-details-container.tablet.no-plan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .task .task-content .task-details-container.tablet .task-detail{margin:4px 24px 6px 0}:host .task .task-content .task-details-container.tablet .task-title{grid-row:1;grid-column:1/5;grid-column:1;-ms-grid-column-span:4}:host .task .task-content .task-details-container.tablet .task-group{grid-row:2;grid-column:1}:host .task .task-content .task-details-container.tablet .task-bucket{grid-row:2;grid-column:2}:host .task .task-content .task-details-container.tablet .task-assignee{grid-row:2;grid-column:3}:host .task .task-content .task-details-container.tablet .task-due{justify-content:flex-start;align-items:center;grid-row:2;grid-column:4}:host .task .task-content .task-details-container.desktop{grid-template-columns:2fr 1fr 0.5fr 1fr 0.5fr;-ms-grid-columns:2fr 1fr 0.5fr 1fr 0.5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .task .task-content .task-details-container.desktop.no-plan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .task .task-content .task-details-container.desktop .task-detail{margin:0 24px 0 0}:host .task .task-content .task-details-container.desktop .task-title{padding:0;grid-row:1;grid-column:1}:host .task .task-content .task-details-container.desktop .task-group{min-height:61px;grid-row:1;grid-column:2}:host .task .task-content .task-details-container.desktop .task-bucket{grid-row:1;grid-column:3}:host .task .task-content .task-details-container.desktop .task-assignee{grid-row:1;grid-column:4}:host .task .task-content .task-details-container.desktop .task-due{justify-content:flex-start;align-items:center;grid-row:1;grid-column:5}:host .task .task-content .task-details-container svg{vertical-align:middle;margin-right:4px}:host .task .task-content .task-details-container svg path{fill:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container select,:host .task .task-content .task-details-container span{vertical-align:middle;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .task-icon{color:#797775;margin-right:8px}:host .task .task-content .task-details-container .people{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:16px}:host .task .task-content .task-details-container .person{display:inline-block}:host .task .task-content .task-details-container .picker{background-color:var(--task-background-color,var(--neutral-layer-floating));background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .task .task-content .task-details-container input,:host .task .task-content .task-details-container select{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:.9em;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-check-container{font-family:FabricMDL2Icons;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none}:host .task .task-check-container.complete .task-check{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .task .task-check-container.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-check-container .task-check{font-family:FabricMDL2Icons;font-size:12px;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-color,var(--neutral-foreground-rest));display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none}:host .task .task-check-container .task-check.loading .task-check-content{animation:rotate-icon 2s infinite linear}:host .task .task-options{cursor:pointer;user-select:none;margin:16px 8px 0 0}:host .task.read-only .task-check-container{cursor:default}:host .task.complete{background:var(--task-complete-background,var(--neutral-layer-1));border:var(--task-complete-border,2px dotted inherit)}:host .task.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task.new-task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .task.new-task .self-assign{display:none}:host .task.new-task .assign-to{border:0;background:0 0}:host .task.new-task .fake-check-box{width:15px;height:15px;cursor:pointer;margin:0 5px}:host .task.new-task .fake-check-box::after{font-family:FabricMDL2Icons;content:"uE739"}:host .task.new-task .fake-check-box~:checked{font-family:FabricMDL2Icons;content:"uE73A"}:host .task.new-task .task-content{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .task.new-task .task-content .task-details-container{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .task.new-task .task-content .task-details-container .task-title{display:flex;height:32px;padding:2px}:host .task.new-task .task-content .task-details-container .task-title input{flex:1;margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size, 14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task .task-content .task-details-container .task-title input:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-title input:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-title input:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-content .task-details-container .task-details{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .task.new-task .task-content .task-details-container .task-details .new-task-group{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-bucket{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-due{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-assignee{margin:8px 16px;min-width:80px}:host .task.new-task .task-content .task-details-container .task-details .task-people label{display:flex;align-content:center;align-items:center}:host .task.new-task .task-content .task-details-container .task-details input,:host .task.new-task .task-content .task-details-container .task-details select{font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .task.new-task .task-content .task-details-container .task-details input:hover,:host .task.new-task .task-content .task-details-container .task-details select:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-details input:active,:host .task.new-task .task-content .task-details-container .task-details select:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-details input:focus,:host .task.new-task .task-content .task-details-container .task-details select:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-add-button-container{margin-right:28px}:host .task.new-task .task-add-button-container .task-add,:host .task.new-task .task-add-button-container .task-cancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-size:14px;line-height:20px}:host .task.new-task .task-add-button-container .task-add{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .task.new-task .task-add-button-container .task-cancel{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest))}:host .task.new-task .task-add-button-container.disabled .task-add{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}@keyframes rotate-icon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translatex:translateX(60px)}[dir=rtl] .task-details{margin-right:14px!important}[dir=rtl] .task-icon{margin-left:8px}[dir=rtl] .task-detail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:rgb(255,255,255)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:rgb(0,0,0)!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px;width:100%}:host .task,:host.loading-task{margin-block:1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active));width:100%;display:flex;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task,:host.loading-task.new-task{margin:14px 0 1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active))}:host .task.complete,:host.loading-task.complete{border:1px solid var(--task-border-completed,var(--neutral-stroke-input-active));background:var(--task-complete-background,var(--neutral-layer-1))}:host .task.complete .task-details .task-due,:host .task.complete .task-details .title,:host.loading-task.complete .task-details .task-due,:host.loading-task.complete .task-details .title{text-decoration:line-through}:host .task.read-only,:host.loading-task.read-only{opacity:1}:host .task:hover,:host.loading-task:hover{background-color:var(--task-background-color-hover,var(--neutral-fill-hover));border-radius:8px}:host .task .task-details,:host.loading-task .task-details{box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:2px;line-height:24px;border-radius:4px;width:100%}:host .task .task-details .task>div,:host.loading-task .task-details .task>div{display:flex;align-items:center;width:200px}:host .task .task-details .task-delete,:host.loading-task .task-details .task-delete{display:flex}:host .task .task-details .container,:host.loading-task .task-details .container{display:flex;width:100%}:host .task .task-details .task-due,:host.loading-task .task-details .task-due{min-width:120px;margin-inline-end:12px;height:32px;text-decoration:inherit;display:flex}:host fluent-text-field::part(end),:host fluent-text-field::part(start){margin-inline:unset}:host fluent-text-field::part(control){padding:0;cursor:pointer}:host fluent-text-field::part(root){background:0 0}:host fluent-text-field.new-task{width:100%;height:34px}:host fluent-text-field.new-task div.start .add-icon{display:flex;margin-inline:10px}:host fluent-text-field.new-task div:nth-child(2){display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar{display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar .date{margin-inline-start:10px;color:var(--task-color,var(--neutral-foreground-rest));width:auto;cursor:pointer}:host fluent-text-field.new-task div:nth-child(2) .calendar input{flex:1;border:none;border-bottom:1px solid var(--task-color,var(--neutral-foreground-rest));outline:0;border-radius:0}:host fluent-text-field.new-task div:nth-child(2) .calendar input:hover{border-bottom:1px solid var(--task-date-input-hover-color,var(--neutral-layer-1))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:active,:host fluent-text-field.new-task div:nth-child(2) .calendar input:focus{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-text-field.title{flex-grow:1;display:inline}:host fluent-text-field.date{color:var(--task-detail-color,var(--neutral-foreground-hint))}:host fluent-text-field::after{border-bottom:none}:host fluent-text-field.dark::part(control){color-scheme:dark}:host fluent-button.task-add-icon.neutral,:host fluent-button.task-cancel-icon.neutral,:host fluent-button.task-delete.neutral{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-button.task-add-icon.neutral::part(control),:host fluent-button.task-cancel-icon.neutral::part(control),:host fluent-button.task-delete.neutral::part(control){border:none;background:inherit}:host fluent-button.task-add-icon.neutral::part(control) svg,:host fluent-button.task-cancel-icon.neutral::part(control) svg,:host fluent-button.task-delete.neutral::part(control) svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-checkbox.complete div>svg .filled{display:block}:host fluent-checkbox.complete div>svg .regular{display:none}:host fluent-checkbox.complete div>svg path{fill:var(--task-radio-background-color,var(--accent-fill-rest))}:host fluent-checkbox div>svg .filled{display:none}:host fluent-checkbox div>svg .regular{display:block}:host fluent-checkbox div>svg path{fill:var(--task-background-color,var(--neutral-layer-floating))}:host fluent-checkbox::part(control){margin-inline-start:10px;background:0 0;border-radius:50%}:host fluent-checkbox::part(label){margin-inline-end:unset;width:100%}
`];l();c();d();var K6={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",newTaskLabel:"New Task Input",editTaskLabel:"Edit Task Input",addTaskButtonSubtitle:"Add",deleteTaskOption:"Delete",editTaskOption:"Edit",dueDate:"Due date",newTaskDateInputLabel:"New Task Date Input",changeTaskDateInputLabel:"Change Task Date Input",newTaskNameInputLabel:"New Task Name Input",cancelAddingTask:"Cancel adding a new task",taskNameCheckboxLabel:"Task Name Checkbox"};l();c();d();xe();gt();ge();l();c();d();var W6={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};Mr();cr();var np=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},sp=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Ws=class extends it{get strings(){return W6}constructor(){super(),this.renderLoading=()=>this.renderLoadingTask(),this.renderContent=()=>{let e=V.globalProvider;if(!e||e.state!==oe.SignedIn)return x``;let t=this.renderPicker(),o=this.renderNewTask(),i=this.renderTasks();return x`
      ${t}
      ${o}
      <div class="tasks" dir=${this.direction}>
        ${i}
      </div>
    `},this.handleTaskClick=e=>{this.fireCustomEvent("taskClick",{task:e})},this.onResize=()=>{this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())},at(cn,Or,Bw),this.clearState(),this._previousMediaQuery=this.mediaQuery}args(){return[this.providerState,this.targetId,this.initialId]}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}renderLoadingTask(){return x`
      <div class="task loading-task">
        <div class="task-details">
          <div class="title"></div>
          <div class="task-due"></div>
          <div class="task-delete"></div>
        </div>
      </div>
    `}clearState(){this.requestUpdate()}dateToInputValue(e){return e?new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().split("T")[0]:null}};np([E({attribute:"read-only",type:Boolean}),sp("design:type",Boolean)],Ws.prototype,"readOnly",void 0);np([E({attribute:"hide-header",type:Boolean}),sp("design:type",Boolean)],Ws.prototype,"hideHeader",void 0);np([E({attribute:"hide-options",type:Boolean}),sp("design:type",Boolean)],Ws.prototype,"hideOptions",void 0);np([E({attribute:"target-id",type:String}),sp("design:type",String)],Ws.prototype,"targetId",void 0);np([E({attribute:"initial-id",type:String}),sp("design:type",String)],Ws.prototype,"initialId",void 0);Mr();Yr();var mn=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},gn=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Jn=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Mx=()=>{at(Yl,vC,Or),Yh(),Re("todo",oi)},oi=class extends Ws{static get styles(){return j6}get strings(){return K6}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}constructor(){super(),this._isChangedDueDate=!1,this._isDarkMode=!1,this.onThemeChanged=()=>{this._isDarkMode=Nv(this)},this.renderNewTask=()=>{let e=this._newTaskName?x`
        <fluent-checkbox
          class="task-add-icon"
          aria-label="${this.strings.newTaskPlaceholder}"
          @click="${this.addTask}">
        </fluent-checkbox>
      `:x`
        <span class="add-icon">${Z(P.Add)}</span>
      `,t=x`
      <fluent-button
        aria-label=${this.strings.cancelAddingTask}
        class="task-cancel-icon" 
        @click="${this.clearNewTaskData}"
      >
        ${Z(P.Cancel)}
      </fluent-button>
    `,o={dark:this._isDarkMode,date:!0},i=x`
      <fluent-text-field
        autocomplete="off"
        type="date"
        id="new-taskDate-input"
        class="${ze(o)}"
        aria-label="${this.strings.newTaskDateInputLabel}"
        .value="${this.dateToInputValue(this._newTaskDueDate)}"
        @change="${this.handleDateChange}"
      >
      </fluent-text-field>
    `,n=this.readOnly?ot:x`
      <fluent-text-field
        autocomplete="off"
        appearance="outline"
        class="new-task"
        id="new-task-name-input"
        aria-label="${this.strings.newTaskLabel}"
        .value=${this._newTaskName}
        placeholder="${this.strings.newTaskPlaceholder}"
        @keydown="${this.handleKeyDown}"
        @input="${this.handleInput}"
      >
        <div slot="start" class="start">${e}</div>
        ${this._newTaskName?x`
              <div slot="end" class="end">
                <span class="calendar">${i}</span>
                ${t}
              </div> `:x``}
      </fluent-text-field>
    `;return x`
      ${this.currentList?x`
            <div dir=${this.direction} class="task new-task incomplete">
              ${n}
            </div>
        `:x``}  
     `},this.handleSelectionChanged=e=>{this.currentList=e.detail,this.loadTasks(this.currentList)},this.renderTaskDetails=e=>{let t={task:e,list:this.currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",t,e.id);let o=null,i=x`
      <fluent-button class="task-delete"
        @click="${()=>this.removeTask(e.id)}"
        aria-label="${this.strings.deleteTaskOption}">
        ${Z(P.Delete)}
      </fluent-button>`;if(this.hasTemplate("task-details"))o=this.renderTemplate("task-details",t,`task-details-${e.id}`);else{let n={dark:this._isDarkMode,date:!0,"task-due":!0},s=x`
        <fluent-text-field
          autocomplete="off"
          type="date"
          id="${e.id}-taskDate-input"
          class="${ze(n)}"
          aria-label="${this.strings.changeTaskDateInputLabel}"
          .value="${e.dueDateTime?this.dateToInputValue(new Date(e.dueDateTime.dateTime)):this._taskBeingUpdated===e?this.dateToInputValue(this._newTaskDueDate):ot}"
          @change="${this.handleDateUpdate}"
          @focus="${u=>this.updatingTask(u,e)}"
          @blur="${this.handleBlur}"
        >
        </fluent-text-field>
      `,a=x`
          <fluent-text-field 
            autocomplete="off"
            appearance="outline"
            class="title"
            id=${e.id}
            .value="${e.title?e.title:this._taskBeingUpdated===e?this._changedTaskName:""}"
            aria-label="${this.strings.editTaskLabel}"
            @keydown="${u=>this.handleChange(u,e)}"
            @input="${u=>this.handleChange(u,e)}"
            @focus="${u=>this.updatingTask(u,e)}"
          >
          </fluent-text-field>
          ${e.dueDateTime||this._taskBeingUpdated===e?x`${s}`:ot}
          ${i}
      `;o=x`
      <div class="task-details">
        ${a}
      </div>
      `}return x`${o}`},this.renderTask=e=>{let t=e.status==="completed",o=ze({complete:t,"read-only":this.readOnly,task:!0}),i=ze({complete:t}),n=x`${Z(P.CheckMark)}`;return x`
      <div class=${o} @blur="${this.handleBlur}">
        <fluent-checkbox 
          id=${e.id} 
          class=${i}
          ?checked=${t}
          aria-label=${this.strings.taskNameCheckboxLabel}
          @click="${()=>this.handleTaskCheckClick(e)}"
          @keydown="${s=>this.handleTaskCheckKeydown(s,e)}"
        >
          <div slot="checked-indicator">
            ${n}
          </div>
        </fluent-checkbox>
        ${this.renderTaskDetails(e)}
      </div>
    `},this.loadState=()=>Jn(this,void 0,void 0,function*(){let e=V.globalProvider;if(!(!e||e.state!==oe.SignedIn)){if(!this._graph){let t=e.graph.forComponent(this);this._graph=t}if(!this.currentList&&!this.initialId){let t=yield V6(this._graph),o=t?.find(i=>i.wellknownListName==="defaultList");o&&(yield this.loadTasks(o))}this.targetId?(this.currentList=yield $x(this._graph,this.targetId),this._tasks=yield Hv(this._graph,this.targetId)):this.initialId&&(this.currentList=yield $x(this._graph,this.initialId),this._tasks=yield Hv(this._graph,this.initialId))}}),this.addTask=()=>Jn(this,void 0,void 0,function*(){if(!(this._isNewTaskBeingAdded||!this._newTaskName)){this._isNewTaskBeingAdded=!0;try{yield this.createNewTask()}finally{this.clearNewTaskData(),this._isNewTaskBeingAdded=!1}}}),this.updateTask=e=>Jn(this,void 0,void 0,function*(){try{if(!this._changedTaskName&&!this._isChangedDueDate)return;yield this.updateTaskItem(e)}finally{this.clearNewTaskData()}}),this.clearNewTaskData=()=>{this._newTaskDueDate=null,this._newTaskName="",this._changedTaskName="",this._isChangedDueDate=!1,this.focusOnTaskInput()},this.focusOnTaskInput=()=>{let e=this.renderRoot.querySelector("#new-task-name-input"),t=e?.shadowRoot.querySelector("input");t&&t.focus()},this.clearState=()=>{super.clearState(),this.currentList=null,this._tasks=[],this._taskBeingUpdated=null},this.loadTasks=e=>Jn(this,void 0,void 0,function*(){this.currentList=e,this._tasks=yield Hv(this._graph,e.id)}),this.updateTaskStatus=(e,t)=>Jn(this,void 0,void 0,function*(){e.status=t;let o=this.currentList.id;e=yield Ox(this._graph,o,e.id,e);let i=this._tasks.findIndex(n=>n.id===e.id);this._tasks[i]=e,yield this._task.run()}),this.removeTask=e=>Jn(this,void 0,void 0,function*(){this._tasks=this._tasks.filter(o=>o.id!==e),this.requestUpdate();let t=this.currentList.id;yield G6(this._graph,t,e),this._tasks=this._tasks.filter(o=>o.id!==e)}),this.handleInput=e=>{e.target.id==="new-task-name-input"&&(this._newTaskName=e.target.value)},this.handleChange=(e,t)=>Jn(this,void 0,void 0,function*(){var o;e.target.id===t.id&&(e.key==="Enter"&&(yield this.updateTask(t),(o=e.target)===null||o===void 0||o.blur()),this._changedTaskName=e.target.value)}),this.handleKeyDown=e=>Jn(this,void 0,void 0,function*(){e.key==="Enter"&&e.target.id==="new-task-name-input"&&(yield this.addTask())}),this.updatingTask=(e,t)=>{e.target.id===t.id&&(this._taskBeingUpdated=t),e.target.id===`${t.id}-taskDate-input`&&(this._updatingTaskDate=!0,this._taskBeingUpdated=t)},this.handleBlur=()=>{let e=this._taskBeingUpdated,t=this.renderRoot.querySelectorAll("fluent-text-field");for(let o of t)e&&(o.id===e.id||o.id===`${e.id}-taskDate-input`)&&(this.updateTask(e),o?.blur(),this._taskBeingUpdated=null,this._updatingTaskDate=!1)},this.handleDateChange=e=>{let t=e.target.value;t?this._newTaskDueDate=new Date(t+"T17:00"):this._newTaskDueDate=null},this.handleDateUpdate=e=>{let t=this._taskBeingUpdated;if(t){let o=e.target.value;o?this._newTaskDueDate=new Date(o+"T17:00"):this._newTaskDueDate=null,t.dueDateTime&&this._newTaskDueDate?this._isChangedDueDate=new Date(t.dueDateTime.dateTime)!==this._newTaskDueDate:t.dueDateTime||this._newTaskDueDate?this._isChangedDueDate=!0:this._isChangedDueDate=!1}},this._graph=null,this._newTaskDueDate=null,this._tasks=[],this.addEventListener("selectionChanged",this.handleSelectionChanged),this.addEventListener("blur",this.handleBlur)}connectedCallback(){super.connectedCallback(),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}renderTasks(){let e=this._tasks;e&&this.taskFilter&&(e=e.filter(n=>this.taskFilter(n)));let t=e.filter(n=>n.status==="completed"),o=co(e.filter(n=>n.status!=="completed"),n=>n.id,n=>this.renderTask(n)),i=co(t.sort((n,s)=>n.lastModifiedDateTime<s.lastModifiedDateTime?-1:1).filter(n=>n.status==="completed"),n=>n.id,n=>this.renderTask(n));return x`
      ${o}
      ${i}
    `}renderPicker(){var e,t;return this.targetId?x`<p>${(e=this.currentList)===null||e===void 0?void 0:e.displayName}</p>`:Te`
        <mgt-picker
          resource="me/todo/lists"
          scopes="tasks.read, tasks.readwrite"
          key-name="displayName"
          selected-value="${Zo((t=this.currentList)===null||t===void 0?void 0:t.displayName)}"
          placeholder="Select a task list">
        </mgt-picker>`}createNewTask(){return Jn(this,void 0,void 0,function*(){let e=this.currentList.id,t={title:this._newTaskName};this._newTaskDueDate&&(t.dueDateTime={dateTime:new Date(this._newTaskDueDate).toLocaleDateString(),timeZone:"UTC"});let o=yield q6(this._graph,e,t);this._tasks.unshift(o)})}updateTaskItem(e){return Jn(this,void 0,void 0,function*(){let t=this.currentList.id,o={};if(this._changedTaskName&&this._changedTaskName!==e.title&&(o={title:this._changedTaskName}),this._updatingTaskDate){if(!this._isChangedDueDate)return;this._newTaskDueDate?o.dueDateTime={dateTime:new Date(this._newTaskDueDate).toLocaleDateString(),timeZone:"UTC"}:(this._isChangedDueDate&&this._newTaskDueDate,o.dueDateTime=null)}if(!Object.keys(o).length)return;let i=yield Ox(this._graph,t,e.id,o),n=this._tasks.findIndex(s=>s.id===i.id);this._tasks[n]=i})}handleTaskCheckClick(e){this.handleTaskClick(e),this.readOnly||(e.status==="completed"?this.updateTaskStatus(e,"notStarted"):this.updateTaskStatus(e,"completed"))}handleTaskCheckKeydown(e,t){e.key==="Enter"&&!this.readOnly&&(this.handleTaskClick(t),t.status==="completed"?this.updateTaskStatus(t,"notStarted"):this.updateTaskStatus(t,"completed"))}};mn([X(),gn("design:type",Array)],oi.prototype,"_tasks",void 0);mn([X(),gn("design:type",Object)],oi.prototype,"_taskBeingUpdated",void 0);mn([X(),gn("design:type",Boolean)],oi.prototype,"_updatingTaskDate",void 0);mn([X(),gn("design:type",Object)],oi.prototype,"_isChangedDueDate",void 0);mn([X(),gn("design:type",Date)],oi.prototype,"_newTaskDueDate",void 0);mn([X(),gn("design:type",String)],oi.prototype,"_newTaskName",void 0);mn([X(),gn("design:type",String)],oi.prototype,"_changedTaskName",void 0);mn([X(),gn("design:type",Boolean)],oi.prototype,"_isNewTaskBeingAdded",void 0);mn([X(),gn("design:type",Object)],oi.prototype,"_graph",void 0);mn([X(),gn("design:type",Object)],oi.prototype,"currentList",void 0);mn([X(),gn("design:type",Object)],oi.prototype,"_isDarkMode",void 0);Kh();Rv();Pv();$v();l();c();d();xe();gt();ge();cr();Mr();l();c();d();var Uv={placeholder:"Search",title:"Search"};l();c();d();xe();var Q6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host fluent-search{width:100%}
`];Jo();ge();var Fx=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},Bv=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Dx=()=>{at(wC),Re("search-box",Ud)},Ud=class extends Lr{static get styles(){return Q6}get strings(){return Uv}get searchTerm(){return this._searchTerm}set searchTerm(e){this._searchTerm=e,this.fireSearchTermChanged()}constructor(){super(),this._searchTerm="",this.renderContent=()=>{var e;return x`
      <fluent-search
        autocomplete="off"
        class="search-term-input"
        appearance="outline"
        value=${(e=this.searchTerm)!==null&&e!==void 0?e:""}
        placeholder=${this.placeholder?this.placeholder:Uv.placeholder}
        title=${this.title?this.title:Uv.title}
        @input=${this.onInputChanged}
        @change=${this.onInputChanged}
      >
      </fluent-search>`},this.onInputChanged=e=>{this.searchTerm=e.target.value},this.debounceDelay=300}fireSearchTermChanged(){this.debouncedSearchTermChanged||(this.debouncedSearchTermChanged=Na(()=>{this.fireCustomEvent("searchTermChanged",this.searchTerm)},this.debounceDelay)),this.debouncedSearchTermChanged()}};Fx([E({attribute:"placeholder",type:String}),Bv("design:type",String)],Ud.prototype,"placeholder",void 0);Fx([E({attribute:"search-term",type:String}),Bv("design:type",Object),Bv("design:paramtypes",[Object])],Ud.prototype,"searchTerm",null);Fx([E({attribute:"debounce-delay",type:Number,reflect:!0}),Bv("design:type",Number)],Ud.prototype,"debounceDelay",void 0);l();c();d();xe();gt();ge();Ni();l();c();d();var vn={modified:"modified on",back:"Back",next:"Next",pages:"pages",page:"Page"};l();c();d();xe();var Y6=[Oe`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px;color:var(--color,var(--neutral-foreground-rest))}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--color,var(--neutral-foreground-rest))}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color,var(--neutral-foreground-rest));text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color,var(--neutral-foreground-rest));text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}
`];Jo();Yr();cr();Mr();ge();Od();un();var No=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},mo=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},TD=function(r,e,t,o){function i(n){return n instanceof t?n:new t(function(s){s(n)})}return new(t||(t=Promise))(function(n,s){function a(p){try{h(o.next(p))}catch(f){s(f)}}function u(p){try{h(o.throw(p))}catch(f){s(f)}}function h(p){p.done?n(p.value):i(p.value).then(a,u)}h((o=o.apply(r,e||[])).next())})},Lx=()=>{at(Jl,Or,NC,Xw),Gs(),Lo(),Re("search-results",Jr)},Jr=class extends it{static get styles(){return Y6}get strings(){return vn}get queryString(){return this._queryString}set queryString(e){this._queryString!==e&&(this._queryString=e,this.currentPage=1)}get from(){return(this.currentPage-1)*this.size}get size(){return this._size}set size(e){e>this.maxPageSize?this._size=this.maxPageSize:this._size=e}get searchEndpoint(){return"/search/query"}get maxPageSize(){return 1e3}constructor(){super(),this._size=10,this.entityTypes=["driveItem","listItem","site"],this.scopes=[],this.contentSources=[],this.version="v1.0",this.pagingMax=7,this.enableTopResults=!1,this.cacheEnabled=!1,this.cacheInvalidationPeriod=3e4,this.isRefreshing=!1,this.defaultFields=["webUrl","lastModifiedBy","lastModifiedDateTime","summary","displayName","name"],this.currentPage=1,this.renderContent=()=>{var e,t,o,i,n,s,a,u,h;let p=null,f=null,b=null;return this.hasTemplate("header")&&(f=this.renderTemplate("header",this.response)),b=this.renderFooter((t=(e=this.response)===null||e===void 0?void 0:e.value[0])===null||t===void 0?void 0:t.hitsContainers[0]),this.response&&this.hasTemplate("default")?p=this.renderTemplate("default",this.response)||x``:!((n=(i=(o=this.response)===null||o===void 0?void 0:o.value[0])===null||i===void 0?void 0:i.hitsContainers[0])===null||n===void 0)&&n.hits?p=x`${(h=(u=(a=(s=this.response)===null||s===void 0?void 0:s.value[0])===null||a===void 0?void 0:a.hitsContainers[0])===null||u===void 0?void 0:u.hits)===null||h===void 0?void 0:h.map(C=>this.renderResult(C))}`:this.hasTemplate("no-data")?p=this.renderTemplate("no-data",null):p=x``,x`
      ${f}
      <div class="search-results">
        ${p}
      </div>
      ${b}`},this.renderLoading=()=>this.renderTemplate("loading",null)||x`
        ${[...Array(this.size)].map(()=>x`
            <div class="search-result">
              <div class="search-result-grid">
                <div class="search-result-icon">
                  <fluent-skeleton class="search-result-icon__shimmer" shape="rect" shimmer></fluent-skeleton>
                </div>
                <div class="searc-result-content">
                  <div class="search-result-name">
                    <fluent-skeleton class="search-result-name__shimmer" shape="rect" shimmer></fluent-skeleton>
                  </div>
                  <div class="search-result-info">
                    <div class="search-result-author">
                      <fluent-skeleton class="search-result-author__shimmer" shape="circle" shimmer></fluent-skeleton>
                    </div>
                    <div class="search-result-date">
                      <fluent-skeleton class="search-result-date__shimmer" shape="rect" shimmer></fluent-skeleton>
                    </div>
                  </div>
                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>
                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>
                </div>
                ${this.fetchThumbnail&&x`
                    <div class="search-result-thumbnail">
                      <fluent-skeleton class="search-result-thumbnail__shimmer" shape="rect" shimmer></fluent-skeleton>
                    </div>
                  `}
              </div>
              <fluent-divider></fluent-divider>
            </div>
          `)}
       `,this.onFirstPageClick=()=>{this.currentPage=1,this.scrollToFirstResult()},this.onPageBackClick=()=>{this.currentPage--,this.scrollToFirstResult()},this.onPageNextClick=()=>{this.currentPage++,this.scrollToFirstResult()}}args(){return[this.providerState,this.queryString,this.queryTemplate,this.entityTypes,this.contentSources,this.scopes,this.version,this.size,this.fetchThumbnail,this.fields,this.enableTopResults,this.currentPage]}refresh(e=!1){this.isRefreshing=!0,e&&this.clearState(),this._task.run()}clearState(){this.response=null}loadState(){var e,t,o,i,n,s;return TD(this,void 0,void 0,function*(){let a=V.globalProvider;if(this.error=null,!(!a||a.state!==oe.SignedIn)){if(this.queryString){try{let u=this.getRequestOptions(),h,p=JSON.stringify({endpoint:`${this.version}${this.searchEndpoint}`,requestOptions:u}),f=null;if(this.shouldRetrieveCache()){h=W.getCache(H.search,H.search.stores.responses);let b=hv()?yield h.getValue(p):null;b&&G3(this.cacheInvalidationPeriod)>Date.now()-b.timeCached&&(f=JSON.parse(b.response))}if(!f){let b=a.graph.forComponent(this),C=b.api(this.searchEndpoint).version(this.version);if(!((e=this.scopes)===null||e===void 0)&&e.length&&(C=C.middlewareOptions(be(this.scopes))),f=yield C.post({requests:[u]}),this.fetchThumbnail){let S=b.createBatch(),R=wc.fromGraph(b).createBatch(),N=!((t=f.value)===null||t===void 0)&&t.length&&(!((o=f.value[0].hitsContainers)===null||o===void 0)&&o.length)?(n=(i=f.value[0].hitsContainers[0])===null||i===void 0?void 0:i.hits)!==null&&n!==void 0?n:[]:[];for(let ie of N){let me=ie.resource;(me.size>0||!((s=me.webUrl)===null||s===void 0)&&s.endsWith(".aspx"))&&(me["@odata.type"]==="#microsoft.graph.driveItem"||me["@odata.type"]==="#microsoft.graph.listItem")&&(me["@odata.type"]==="#microsoft.graph.listItem"?R.get(ie.hitId.toString(),`/sites/${me.parentReference.siteId}/pages/${me.id}`):S.get(ie.hitId.toString(),`/drives/${me.parentReference.driveId}/items/${me.id}/thumbnails/0/medium`))}let ye=ie=>{if(ie&&ie.size>0)for(let[me,yt]of ie){let Ge=f.value[0].hitsContainers[0].hits[me],tt=Ge.resource["@odata.type"]==="#microsoft.graph.listItem"?{url:yt.content.thumbnailWebUrl}:{url:yt.content.url};Ge.resource.thumbnail=tt}};try{ye(yield S.executeAll()),ye(yield R.executeAll())}catch{}}this.shouldUpdateCache()&&f&&(h=W.getCache(H.search,H.search.stores.responses),yield h.putValue(p,{response:JSON.stringify(f)}))}as(this.response,f)||(this.response=f)}catch(u){this.error=u}this.response&&(this.error=null)}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}})}renderResult(e){let t=this.getResourceType(e.resource);if(this.hasTemplate(`result-${t}`))return this.renderTemplate(`result-${t}`,e,e.hitId);switch(e.resource["@odata.type"]){case"#microsoft.graph.driveItem":return this.renderDriveItem(e);case"#microsoft.graph.site":return this.renderSite(e);case"#microsoft.graph.person":return this.renderPerson(e);case"#microsoft.graph.drive":case"#microsoft.graph.list":return this.renderList(e);case"#microsoft.graph.listItem":return this.renderListItem(e);case"#microsoft.graph.search.bookmark":return this.renderBookmark(e);case"#microsoft.graph.search.acronym":return this.renderAcronym(e);case"#microsoft.graph.search.qna":return this.renderQnA(e);default:return this.renderDefault(e)}}renderFooter(e){if(this.pagingRequired(e)){let t=this.getActivePages(e.total);return x`
        <div class="search-results-pages">
          ${this.renderPreviousPage()}
          ${this.renderFirstPage(t)}
          ${this.renderAllPages(t)}
          ${this.renderNextPage()}
        </div>
      `}}pagingRequired(e){return e?.moreResultsAvailable||this.currentPage*this.size<e?.total}getActivePages(e){let t=()=>{let n=this.currentPage-Math.floor(this.pagingMax/2)-1;return n>=Math.floor(this.pagingMax/2)?n:0},o=[],i=t();if(i+1>this.pagingMax-this.currentPage||this.pagingMax===this.currentPage)for(let n=i+1;n<Math.ceil(e/this.size)&&n<this.pagingMax+(this.currentPage-1)&&o.length<this.pagingMax-2;++n)o.push(n+1);else for(let n=i;n<this.pagingMax;++n)o.push(n+1);return o}renderAllPages(e){return x`
      ${e.map(t=>x`
            <fluent-button
              title="${vn.page} ${t}"
              appearance="stealth"
              class="${t===this.currentPage?"search-results-page-active":"search-results-page"}"
              @click="${()=>this.onPageClick(t)}">
                ${t}
            </fluent-button>`)}`}renderFirstPage(e){return x`
      ${e.some(t=>t===1)?ot:x`
              <fluent-button
                 title="${vn.page} 1"
                 appearance="stealth"
                 class="search-results-page"
                 @click="${this.onFirstPageClick}">
                 1
               </fluent-button>`?x`
              <fluent-button
                id="page-back-dot"
                appearance="stealth"
                class="search-results-page"
                title="${this.getDotButtonTitle()}"
                @click="${()=>this.onPageClick(this.currentPage-Math.ceil(this.pagingMax/2))}"
              >
                ...
              </fluent-button>`:ot}`}getDotButtonTitle(){return`${vn.back} ${Math.ceil(this.pagingMax/2)} ${vn.pages}`}renderPreviousPage(){return this.currentPage>1?x`
          <fluent-button
            appearance="stealth"
            class="search-results-page"
            title="${vn.back}"
            @click="${this.onPageBackClick}">
              ${Z(P.ChevronLeft)}
            </fluent-button>`:ot}renderNextPage(){return this.isLastPage()?ot:x`
          <fluent-button
            appearance="stealth"
            class="search-results-page"
            title="${vn.next}"
            aria-label="${vn.next}"
            @click="${this.onPageNextClick}">
              ${Z(P.ChevronRight)}
            </fluent-button>`}onPageClick(e){this.currentPage=e,this.scrollToFirstResult()}isLastPage(){return this.currentPage===Math.ceil(this.response.value[0].hitsContainers[0].total/this.size)}scrollToFirstResult(){this.renderRoot.querySelector(".search-results").scrollIntoView({block:"start",behavior:"smooth"})}getResourceType(e){return e["@odata.type"].split(".").pop()}renderDriveItem(e){var t,o;let i=e.resource;return Te`
      <div class="search-result-grid">
        <div class="search-result-icon">
          <mgt-file
            .fileDetails="${e.resource}"
            view="image"
            class="file-icon">
          </mgt-file>
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${i.webUrl}?Web=1" target="_blank">${kd(i.name)}</a>
          </div>
          <div class="search-result-info">
            <div class="search-result-author">
              <mgt-person
                person-query=${i.lastModifiedBy.user.email}
                view="oneline"
                person-card="hover"
                show-presence="true">
              </mgt-person>
            </div>
            <div class="search-result-date">
              &nbsp; ${vn.modified} ${Hs(new Date(i.lastModifiedDateTime))}
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${xd(e.summary)}"></div>
        </div>
        ${((t=i.thumbnail)===null||t===void 0?void 0:t.url)&&x`
          <div class="search-result-thumbnail">
            <a href="${i.webUrl}" target="_blank"><img alt="${i.name}" src="${(o=i.thumbnail)===null||o===void 0?void 0:o.url}" /></a>
          </div>`}

      </div>
      <fluent-divider></fluent-divider>
    `}renderSite(e){let t=e.resource;return x`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${this.getResourceIcon(t)}
        </div>
        <div class="searc-result-content">
          <div class="search-result-name">
            <a href="${t.webUrl}" target="_blank">${t.displayName}</a>
          </div>
          <div class="search-result-info">
            <div class="search-result-url">
              <a href="${t.webUrl}" target="_blank">${t.webUrl}</a>
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${xd(e.summary)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderList(e){let t=e.resource;return Te`
      <div class="search-result-grid">
        <div class="search-result-icon">
          <mgt-file
            .fileDetails="${e.resource}"
            view="image">
          </mgt-file>
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${t.webUrl}?Web=1" target="_blank">
              ${kd(t.name||uv(t.webUrl))}
            </a>
          </div>
          <div class="search-result-summary" .innerHTML="${xd(e.summary)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderListItem(e){var t,o;let i=e.resource;return Te`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${i.webUrl.endsWith(".aspx")?Z(P.News):Z(P.FileOuter)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${i.webUrl}?Web=1" target="_blank">
              ${kd(i.name||uv(i.webUrl))}
            </a>
          </div>
          <div class="search-result-info">
            <div class="search-result-author">
              <mgt-person
                person-query=${i.lastModifiedBy.user.email}
                view="oneline"
                person-card="hover"
                show-presence="true">
              </mgt-person>
            </div>
            <div class="search-result-date">
              &nbsp; ${vn.modified} ${Hs(new Date(i.lastModifiedDateTime))}
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${xd(e.summary)}"></div>
        </div>
        ${((t=i.thumbnail)===null||t===void 0?void 0:t.url)&&x`
          <div class="search-result-thumbnail">
            <a href="${i.webUrl}" target="_blank"><img alt="${kd(i.name||uv(i.webUrl))}" src="${((o=i.thumbnail)===null||o===void 0?void 0:o.url)||ot}" /></a>
          </div>`}
      </div>
      <fluent-divider></fluent-divider>
    `}renderPerson(e){let t=e.resource;return Te`
      <div class="search-result">
        <mgt-person
          view="fourlines"
          person-query=${t.userPrincipalName}
          person-card="hover"
          show-presence="true">
        </mgt-person>
      </div>
      <fluent-divider></fluent-divider>
    `}renderBookmark(e){return this.renderAnswer(e,P.DoubleBookmark)}renderAcronym(e){return this.renderAnswer(e,P.BookOpen)}renderQnA(e){return this.renderAnswer(e,P.BookQuestion)}renderAnswer(e,t){let o=e.resource;return x`
      <div class="search-result-grid search-result-answer">
        <div class="search-result-icon">
          ${Z(t)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${this.getResourceUrl(o)}?Web=1" target="_blank">${o.displayName}</a>
          </div>
          <div class="search-result-summary">${o.description}</div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderDefault(e){let t=e.resource,o=this.getResourceUrl(t);return x`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${this.getResourceIcon(t)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            ${o?x`
                  <a href="${o}?Web=1" target="_blank">${this.getResourceName(t)}</a>
                `:x`
                  ${this.getResourceName(t)}
                `}
          </div>
          <div class="search-result-summary" .innerHTML="${this.getResultSummary(e)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}getResourceUrl(e){return e.webUrl||e.webLink||null}getResourceName(e){return e.displayName||e.subject||kd(e.name)}getResultSummary(e){var t;return xd(e.summary||((t=e.resource)===null||t===void 0?void 0:t.description)||null)}getResourceIcon(e){switch(e["@odata.type"]){case"#microsoft.graph.site":return Z(P.Globe);case"#microsoft.graph.message":return Z(P.Email);case"#microsoft.graph.event":return Z(P.Event);case"microsoft.graph.chatMessage":return Z(P.SmallChat);default:return Z(P.FileOuter)}}shouldRetrieveCache(){return hv()&&this.cacheEnabled&&!this.isRefreshing}shouldUpdateCache(){return hv()&&this.cacheEnabled}getRequestOptions(){let e={entityTypes:this.entityTypes,query:{queryString:this.queryString},from:this.from?this.from:void 0,size:this.size?this.size:void 0,fields:this.getFields(),enableTopResults:this.enableTopResults?this.enableTopResults:void 0};return this.entityTypes.includes("externalItem")&&(e.contentSources=this.contentSources),this.version==="beta"&&(e.query.queryTemplate=this.queryTemplate?this.queryTemplate:void 0),e}getFields(){if(this.fields)return this.defaultFields.concat(this.fields)}};No([E({attribute:"query-string",type:String}),mo("design:type",String),mo("design:paramtypes",[String])],Jr.prototype,"queryString",null);No([E({attribute:"query-template",type:String}),mo("design:type",String)],Jr.prototype,"queryTemplate",void 0);No([E({attribute:"entity-types",converter:r=>r.split(",").map(e=>e.trim()),type:String}),mo("design:type",Array)],Jr.prototype,"entityTypes",void 0);No([E({attribute:"scopes",converter:(r,e)=>r?r.toLowerCase().split(","):null}),mo("design:type",Array)],Jr.prototype,"scopes",void 0);No([E({attribute:"content-sources",converter:(r,e)=>r?r.toLowerCase().split(","):null}),mo("design:type",Array)],Jr.prototype,"contentSources",void 0);No([E({attribute:"version",reflect:!0,type:String}),mo("design:type",Object)],Jr.prototype,"version",void 0);No([E({attribute:"size",reflect:!0,type:Number}),mo("design:type",Number),mo("design:paramtypes",[Object])],Jr.prototype,"size",null);No([E({attribute:"paging-max",reflect:!0,type:Number}),mo("design:type",Object)],Jr.prototype,"pagingMax",void 0);No([E({attribute:"fetch-thumbnail",type:Boolean}),mo("design:type",Boolean)],Jr.prototype,"fetchThumbnail",void 0);No([E({attribute:"fields",converter:r=>r.split(",").map(e=>e.trim()),type:String}),mo("design:type",Array)],Jr.prototype,"fields",void 0);No([E({attribute:"enable-top-results",reflect:!0,type:Boolean}),mo("design:type",Object)],Jr.prototype,"enableTopResults",void 0);No([E({attribute:"cache-enabled",reflect:!0,type:Boolean}),mo("design:type",Object)],Jr.prototype,"cacheEnabled",void 0);No([E({attribute:"cache-invalidation-period",reflect:!0,type:Number}),mo("design:type",Object)],Jr.prototype,"cacheInvalidationPeriod",void 0);No([X(),mo("design:type",Object)],Jr.prototype,"response",void 0);No([E({attribute:!1}),mo("design:type",Object)],Jr.prototype,"currentPage",void 0);l();c();d();xe();gt();ge();cr();Mr();l();c();d();cr();Q();As();var X6="#717171",Z6=Je.create("secondary-text-color").withDefault(X6),e7="#1a1a1a",J6=Je.create("secondary-text-hover-color").withDefault(e7),t7=(r,e=document.body)=>{let t=ID(r);ED(t,e)},ED=(r,e=document.body)=>{var t;Ch.setValueFor(e,Xe.from(ht(r.accentBaseColor))),wh.setValueFor(e,Xe.from(ht(r.neutralBaseColor))),Oi.setValueFor(e,r.baseLayerLuminance),(t=r.designTokenOverrides)===null||t===void 0||t.call(r,e)},ID=r=>{switch(r){case"contrast":return{accentBaseColor:"#7f85f5",neutralBaseColor:"#adadad",baseLayerLuminance:Hn.DarkMode};case"default":return{accentBaseColor:"#5b5fc7",neutralBaseColor:"#616161",baseLayerLuminance:Hn.LightMode};case"dark":return{accentBaseColor:"#479ef5",neutralBaseColor:"#adadad",baseLayerLuminance:Hn.DarkMode,designTokenOverrides:e=>{Ke.setValueFor(e,Xe.from(ht("#115ea3"))),Kr.setValueFor(e,Xe.from(ht("#0f6cbd"))),Wr.setValueFor(e,Xe.from(ht("#0c3b5e"))),nd.setValueFor(e,Xe.from(ht("#0f548c"))),xh.setValueFor(e,Xe.from(ht("#479EF5"))),kh.setValueFor(e,Xe.from(ht("#62abf5"))),Sh.setValueFor(e,Xe.from(ht("#2886de"))),ER.setValueFor(e,Xe.from(ht("#479ef5"))),Sg.setValueFor(e,Xe.from(ht("#115ea3"))),_g.setValueFor(e,Xe.from(ht("#0f6cbd"))),Tg.setValueFor(e,Xe.from(ht("#0c3b5e"))),IR.setValueFor(e,Xe.from(ht("#0f548c"))),ad.setValueFor(e,Xe.from(ht("#ffffff"))),Mo.setValueFor(e,Xe.from(ht("#ffffff"))),sd.setValueFor(e,Xe.from(ht("#ffffff"))),TR.setValueFor(e,Xe.from(ht("#ffffff"))),Z6.setValueFor(e,"#8e8e8e"),J6.setValueFor(e,"#ffffff")}};case"light":default:return{accentBaseColor:"#0f6cbd",neutralBaseColor:"#616161",baseLayerLuminance:Hn.LightMode,designTokenOverrides:e=>{Z6.setValueFor(e,X6),J6.setValueFor(e,e7)}}}};l();c();d();var ap={label:"Color mode:",on:"Dark",off:"Light"};ge();var AD=function(r,e,t,o){var i=arguments.length,n=i<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(r,e,t,o);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(n=(i<3?s(n):i>3?s(e,t,n):s(e,t))||n);return i>3&&n&&Object.defineProperty(e,t,n),n},RD=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Nx=()=>{at(EC),Re("theme-toggle",zv)},zv=class extends Lr{constructor(){super(),this.onSwitchChanged=t=>{this.darkModeActive=t.target.checked};let e=window.matchMedia("(prefers-color-scheme:dark)").matches;this.darkModeActive=e,this.applyTheme(this.darkModeActive)}get strings(){return ap}updated(e){e.has("darkModeActive")&&this.applyTheme(this.darkModeActive)}render(){return x`
      <fluent-switch checked=${this.darkModeActive} @change=${this.onSwitchChanged}>
        <span slot="checked-message">${ap.on}</span>
        <span slot="unchecked-message">${ap.off}</span>
        <label for="direction-switch">${ap.label}</label>
      </fluent-switch>
`}applyTheme(e){let t=e?"dark":"light";t7(t),document.body.classList.remove("mgt-dark-mode","mgt-light-mode"),document.body.classList.add(`mgt-${t}-mode`),this.fireCustomEvent("darkmodechanged",this.darkModeActive,!0,!1,!0)}};AD([E({attribute:"mode",reflect:!0,type:String,converter:{fromAttribute:r=>r==="dark",toAttribute:r=>r?"dark":"light"}}),RD("design:type",Boolean)],zv.prototype,"darkModeActive",void 0);qs();Od();Av();zh();cx();Mv();un();xv();Kh();Kh();Rv();Pv();$v();qs();l();c();d();l();c();d();Bh();av();l();c();d();l();c();d();var r7=__REACT_DOM__,{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ZCt,createPortal:JCt,findDOMNode:XCt,flushSync:ext,hydrate:txt,render:rxt,unmountComponentAtNode:oxt,unstable_batchedUpdates:ixt,unstable_createPortal:nxt,unstable_renderSubtreeIntoContainer:sxt,version:axt}=__REACT_DOM__;l();c();d();l();c();d();var PD=new Set(["children","wcType"]),Vv=class extends Zx{get element(){return this._element}getTag(){let e;return typeof this.props.wcType=="function"?e=this.props.wcType.name.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase():typeof this.props.wcType=="string"&&(e=this.props.wcType),e}render(){let e=this.getTag();if(!e)throw'"wcType" must be set!';let t={};for(let o of Object.keys(this.props))o&&this.props[o]===!0&&(t[o]=!0);return Er.createElement(e,Object.assign(Object.assign({},t),{ref:o=>this.setRef(o)}),this.props.children)}setRef(e){e?(e!==this._element&&this.cleanUp(),this._element=e,this.syncProps(this.props)):this.cleanUp(),this.props.innerRef&&(typeof this.props.innerRef=="function"?this.props.innerRef(e):this.props.innerRef.current=e)}cleanUp(){if(this._element){for(let e in this.props)this.props.hasOwnProperty(e)&&this.isEventProp(e,this.props[e])&&this.removeEventListener(e,this.props[e]);this._element=null}}componentDidUpdate(e){let t={};for(let o in this.props)this.props.hasOwnProperty(o)&&(!e[o]||e[o]!==this.props[o])&&(t[o]=this.props[o],e[o]&&this.isEventProp(o,e[o])&&this.removeEventListener(o,e[o]));for(let o in e)e.hasOwnProperty(o)&&!this.props[o]&&this.isEventProp(o,e[o])&&this.removeEventListener(o,e[o]);this.syncProps(t)}syncProps(e){if(this._element)for(let t in e)PD.has(t)||(this.isEventProp(t,e[t])&&this.addEventListener(t,e[t]),this._element[t]=e[t])}isEventProp(e,t){return e&&typeof t=="function"}addEventListener(e,t){let o=e;o.match(/^on[A-Z]/gm)&&(o=o.substring(2).toLowerCase()),this._element.addEventListener(o,t)}removeEventListener(e,t){let o=e;o.match(/^on[A-Z]/gm)&&(o=o.substring(2).toLowerCase()),this._element.removeEventListener(o,t)}};ge();var Hx=class extends Vv{_templates;constructor(e){super(e)}getTag(){let e=super.getTag(),t=`${yr.prefix}-`;return e.startsWith(t)||(e=t+e),e}render(){let e=this.getTag();if(!e)throw new Error('"wcType" must be set!');this.processTemplates(this.props.children);let t=[];if(this._templates){for(let o in this._templates)if(Object.prototype.hasOwnProperty.call(this._templates,o)){let i=Er.createElement("template",{key:o,"data-type":o},null);t.push(i)}}return Er.createElement(e,{ref:o=>this.setRef(o)},t)}setRef(e){e&&e.addEventListener("templateRendered",this.handleTemplateRendered),super.setRef(e)}cleanUp(){this.element&&(this.element.removeEventListener("templateRendered",this.handleTemplateRendered),super.cleanUp())}handleTemplateRendered=e=>{if(!this._templates)return;let t=e.detail.templateType,o=e.detail.context,i=e.detail.element,n=this._templates[t];n&&(n=Er.cloneElement(n,{dataContext:o}),r7.render(n,i))};processTemplates(e){if(!e)return;let t={};Er.Children.forEach(e,o=>{let i=o,n=i?.props?.template;n?t[n]=i:t.default=i}),this._templates=t}},lt=(r,e)=>{e();let t=(i,n)=>Er.createElement(Hx,{wcType:r,innerRef:n,...i});return Er.forwardRef(t)};var o7=lt("person",Lo);l();c();d();var Vxt=lt("person-card",Ov);l();c();d();var Yxt=lt("agenda",px);l();c();d();var okt=lt("get",dc);l();c();d();var i7=lt("login",vx);l();c();d();var gkt=lt("people-picker",tp);l();c();d();var kkt=lt("people",cc);l();c();d();var Rkt=lt("planner",Ex);l();c();d();var Lkt=lt("teams-channel-picker",Ax);l();c();d();var qkt=lt("todo",Mx);l();c();d();var Zkt=lt("file",Gs);l();c();d();var iSt=lt("file-list",Qh);l();c();d();var uSt=lt("picker",Yh);l();c();d();var ySt=lt("taxonomy-picker",mx);l();c();d();var _St=lt("theme-toggle",Nx);l();c();d();var $St=lt("search-box",Dx);l();c();d();var HSt=lt("search-results",Lx);l();c();d();var jSt=lt("spinner",dn);var $D=()=>{let e=new window.URL(window.location.href).searchParams.get("clientId");return e||W_};document.getElementById("mgt-version").innerText=rs;var n7=new kf(!0),u7=new Bf({clientId:$D(),redirectUri:window.location.origin+"/"+Q_,scopes:["user.read","user.read.all","mail.readBasic","people.read","people.read.all","sites.read.all","user.readbasic.all","contacts.read","presence.read","presence.read.all","tasks.readwrite","tasks.read","calendars.read","group.read.all","files.read","files.read.all","files.readwrite","files.readwrite.all"],loginType:Xn.Popup}),s7=!1;V.globalProvider=u7;var OD=()=>{let[r,e]=Jx(V.globalProvider.state),t=Xx({STORY_RENDERED:u=>{console.log("storyRendered",u)}}),o=u=>{V.globalProvider.state===oe.SignedOut&&V.globalProvider!==n7?t(Fy,{state:u,provider:n7,name:"MgtMockProvider"}):t(Fy,{state:u,provider:u7,name:"MgtMsal2Provider"})};V.onProviderUpdated(()=>{r!==V.globalProvider.state&&(e(V.globalProvider.state),o(V.globalProvider.state))});let i=async()=>{await V.globalProvider.logout(),n()},n=()=>{console.log("reload"),window.location.reload()},s=u=>{s7&&n(),console.log("loginCompleted")},a=u=>{s7=!0,console.log("loginInitiated")};return o(r),Er.createElement(Er.Fragment,null,Er.createElement("div",{style:{marginTop:"3px",display:V.globalProvider.state!==oe.SignedIn?"flex":"none"}},Er.createElement(i7,{loginView:"compact",loginCompleted:s,loginInitiated:a})),Er.createElement("div",{style:{display:V.globalProvider.state===oe.SignedIn?"flex":"none"}},Er.createElement("div",{style:{marginTop:"8px"}},Er.createElement(o7,{personQuery:"me"})),Er.createElement("fluent-button",{appearance:"lightweight",style:{marginTop:"3px"},onClick:i},"Sign Out")))};lp.register("mgt",r=>{lp.add("mgt/login",{type:Ux.TOOLEXTRA,title:"Sign In",render:({active:e})=>Er.createElement(OD,null)})});lp.setConfig({enableShortcuts:!1,theme:Yx,sidebar:{filters:{patterns:r=>!(r.tags.includes("hidden")&&r.type==="story")}}});var a7="http://www.w3.org/2000/svg";window.onload=()=>{h7()};window.onclick=()=>{p7()};function h7(){let r="color: black; text-decoration: none; text-align: center; cursor: pointer; padding-right: 0.5rem;",e="margin-left: 0.25rem; font-size: 0.75rem;",t="display: flex;",o=document.getElementsByClassName("sidebar-header");if(o.length===0)return setTimeout(h7,500),!1;o[0].innerHTML='<h1 tabindex="-1" class="css-1su1ft1"><a href="https://aka.ms/mgt" target="_blank" class="css-ixbm00">Microsoft Graph Toolkit Playground</a></h1>';let i=o[0].parentNode,s=l7("M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"),a=document.createElement("span");a.style=e,a.innerText="GitHub";let u=document.createElement("span");u.style=t,u.append(s,a);let h=document.createElement("a");h.href="https://aka.ms/mgt",h.target="_blank",h.style=r,h.appendChild(u);let f=l7("M1.763 0C.786 0 0 .786 0 1.763v20.474C0 23.214.786 24 1.763 24h20.474c.977 0 1.763-.786 1.763-1.763V1.763C24 .786 23.214 0 22.237 0zM5.13 5.323l13.837.019-.009 13.836h-3.464l.01-10.382h-3.456L12.04 19.17H5.113z"),b=document.createElement("span");b.style=e,b.innerText="npm";let C=document.createElement("span");C.style=t,C.append(f,b);let S=document.createElement("a");S.href="https://www.npmjs.com/package/@microsoft/mgt",S.target="_blank",S.style=r+" margin-left: 0.5rem;",S.appendChild(C);let R=document.createElement("div");R.id="useful-links",R.style="display: flex; margin: 1rem 0rem; font-size: 0.875rem;",R.append(h,S),i.insertBefore(R,i.childNodes[1]);let N=document.getElementsByClassName("sidebar-subheading");if(N)for(let Ge=0;Ge<N.length;Ge++)N[Ge].removeAttribute("aria-expanded");function ye(){let Ge=document.getElementsByClassName("css-ulso1l");if(Ge)for(let tt=0;tt<Ge.length;tt++)Ge[tt].addEventListener("click",ie,{useCapture:!0})}function ie(){let Ge=document.getElementsByClassName("css-rl1ij0");if(Ge)for(let tt=0;tt<Ge.length;tt++){let _o=Ge[tt];yt(_o),_o.addEventListener("click",me,{useCapture:!0})}}function me(Ge){let tt=Ge.target;yt(tt)}function yt(Ge){let _o=Ge.getAttribute("data-expanded")==="true"?"expand":"collapse";Ge.setAttribute("aria-label",_o)}ye(),p7()}function l7(r){let o="height: 0.75rem; margin-top: 0.125rem;",i=document.createElementNS(a7,"svg");i.setAttributeNS(null,"viewBox",`0 0 ${12*2} ${12*2}`),i.setAttributeNS(null,"width",12),i.setAttributeNS(null,"height",12),i.setAttributeNS(null,"role","img"),i.setAttributeNS(null,"aria-label"," to "),i.setAttributeNS(null,"style",o);let n=document.createElementNS(a7,"path");return n.setAttributeNS(null,"d",r),i.appendChild(n),i}function p7(){let r={"Exit full screen [F]":"Exit full screen","Go full screen [F]":"Go full screen"},e=document.getElementsByClassName("css-6jc9zw");for(let t=0;t<e.length;t++){let o=e[t],i=o.getAttribute("title");o.setAttribute("title",r[i]??i),o.setAttribute("aria-label",r[i]??i)}}var MD=()=>{let r=document.createElement("script");r.src="https://consentdeliveryfd.azurefd.net/mscc/lib/v2/wcp-consent.js",document.head.appendChild(r);let e=document.createElement("script");e.type="module",e.src="https://unpkg.com/@fluentui/web-components@2",document.head.appendChild(e)};MD();var c7=0,d7=setInterval(()=>{if(c7++,c7>100){clearInterval(d7);return}let r=document.querySelector("footer"),e=document.querySelector("nav.sidebar-container");e&&(e.parentElement.appendChild(r),e.style.height=`calc(100% - ${r.clientHeight}px)`,clearInterval(d7))},100);navigator.serviceWorker.register("sw.js");})();
}catch(e){ console.error("[Storybook] One of your manager-entries failed: " + import.meta.url, e); }
