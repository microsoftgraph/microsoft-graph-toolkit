class BatchResponse{}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics$2=function(e,t){return extendStatics$2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics$2(e,t)};function __extends$2(e,t){function __(){this.constructor=e}extendStatics$2(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}var e,__assign$2=function(){return __assign$2=Object.assign||function __assign(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$2.apply(this,arguments)};function __decorate$x(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s}function __awaiter$H(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))}function __generator$2(e,t){var r,o,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function verb(n){return function(a){return function step(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}function __spreadArrays$1(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<r;t++)for(var n=arguments[t],s=0,a=n.length;s<a;s++,i++)o[i]=n[s];return o}!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(e||(e={}));class BatchRequestContent{constructor(e){if(this.requests=new Map,void 0!==e){const t=BatchRequestContent.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let r=t.next();for(;!r.done;){const e=r.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const o=r.value[1];if(void 0!==o.dependsOn&&o.dependsOn.length>0)return!1;let i=r;for(r=t.next();!r.done;){const e=r.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==i.value[1].id)return!1;i=r,r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const o=r.value[1];let i;if(void 0===o.dependsOn||0===o.dependsOn.length)i=o.id;else{if(1!==o.dependsOn.length)return!1;{const t=o.dependsOn[0];if(t===o.id||!e.has(t))return!1;i=t}}for(r=t.next();!r.done;){const e=r.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&i!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===i||e.dependsOn[0]!==i))return!1;if(e.dependsOn.length>1)return!1}r=t.next()}return!0})(e)}static getRequestData(t){return __awaiter$H(this,void 0,void 0,(function*(){const r={url:""},o=new RegExp("^https?://");r.url=o.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,r.method=t.method;const i={};return t.headers.forEach(((e,t)=>{i[t]=e})),Object.keys(i).length&&(r.headers=i),t.method!==e.PATCH&&t.method!==e.POST&&t.method!==e.PUT||(r.body=yield BatchRequestContent.getRequestBody(t)),r}))}static getRequestBody(e){return __awaiter$H(this,void 0,void 0,(function*(){let t,r=!1;try{const o=e.clone();t=yield o.json(),r=!0}catch(e){}if(!r)try{if("undefined"!=typeof Blob){const r=yield e.blob(),o=new FileReader;t=yield new Promise((e=>{o.addEventListener("load",(()=>{const t=o.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])}),!1),o.readAsDataURL(r)}))}else if("undefined"!=typeof Buffer){t=(yield e.buffer()).toString("base64")}r=!0}catch(e){}return t}))}addRequest(e){const t=BatchRequestContent.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),r=this.requests.entries();let o=r.next();for(;!o.done;){const t=o.value[1].dependsOn;if(void 0!==t){const r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&delete o.value[1].dependsOn}o=r.next()}return t}getContent(){return __awaiter$H(this,void 0,void 0,(function*(){const e=[],t={requests:e},r=this.requests.entries();let o=r.next();if(o.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!BatchRequestContent.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!o.done;){const t=o.value[1],i=yield BatchRequestContent.getRequestData(t.request);if(void 0!==i.body&&(void 0===i.headers||void 0===i.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}i.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(i.dependsOn=t.dependsOn),e.push(i),o=r.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const r=this.requests.get(e);if(void 0===r.dependsOn&&(r.dependsOn=[]),-1!==r.dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}r.dependsOn.push(t)}else{const r=this.requests.entries();let o,i=r.next();for(;!i.done&&i.value[1].id!==e;)o=i,i=r.next();if(void 0===o){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=o.value[0];if(void 0===i.value[1].dependsOn&&(i.value[1].dependsOn=[]),-1!==i.value[1].dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}i.value[1].dependsOn.push(t)}}}removeDependency(e,t){const r=this.requests.get(e);if(void 0===r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if(void 0!==t){const e=r.dependsOn.indexOf(t);return-1!==e&&(r.dependsOn.splice(e,1),!0)}return delete r.dependsOn,!0}}BatchRequestContent.requestLimit=20;class MiddlewareControl{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const getRequestHeader=(e,t,r)=>{let o=null;if("undefined"!=typeof Request&&e instanceof Request)o=e.headers.get(r);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)o=t.headers.get(r);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,i=e.length;t<i;t++)if(e[t][0]===r){o=e[t][1];break}}else void 0!==t.headers[r]&&(o=t.headers[r]);return o},setRequestHeader=(e,t,r,o)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(r,o);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[r]:o});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(r,o);else if(t.headers instanceof Array){let e=0;const i=t.headers.length;for(;e<i;e++){const i=t.headers[e];if(i[0]===r){i[1]=o;break}}e===i&&t.headers.push([r,o])}else Object.assign(t.headers,{[r]:o})},appendRequestHeader=(e,t,r,o)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(r,o):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[r]:o}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(r,o):t.headers instanceof Array?t.headers.push([r,o]):void 0===t.headers?t.headers={[r]:o}:void 0===t.headers[r]?t.headers[r]=o:t.headers[r]+=`, ${o}`)};class AuthenticationHandlerOptions{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var t;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(t||(t={}));class TelemetryHandlerOptions{constructor(){this.featureUsage=t.NONE}static updateFeatureUsageFlag(e,t){let r;e.middlewareControl instanceof MiddlewareControl?r=e.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions):e.middlewareControl=new MiddlewareControl,void 0===r&&(r=new TelemetryHandlerOptions,e.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions,r)),r.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class AuthenticationHandler{constructor(e){this.authenticationProvider=e}execute(e){return __awaiter$H(this,void 0,void 0,(function*(){try{let r,o,i;e.middlewareControl instanceof MiddlewareControl&&(r=e.middlewareControl.getMiddlewareOptions(AuthenticationHandlerOptions)),void 0!==r&&(o=r.authenticationProvider,i=r.authenticationProviderOptions),void 0===o&&(o=this.authenticationProvider);const n=`Bearer ${yield o.getAccessToken(i)}`;return appendRequestHeader(e.request,e.options,AuthenticationHandler.AUTHORIZATION_HEADER,n),TelemetryHandlerOptions.updateFeatureUsageFlag(e,t.AUTHENTICATION_HANDLER_ENABLED),yield this.nextMiddleware.execute(e)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}AuthenticationHandler.AUTHORIZATION_HEADER="Authorization";class HTTPMessageHandler{execute(e){return __awaiter$H(this,void 0,void 0,(function*(){try{return void(e.response=yield fetch(e.request,e.options))}catch(e){throw e}}))}}class RetryHandlerOptions{constructor(e=RetryHandlerOptions.DEFAULT_DELAY,t=RetryHandlerOptions.DEFAULT_MAX_RETRIES,r=RetryHandlerOptions.DEFAULT_SHOULD_RETRY){if(e>RetryHandlerOptions.MAX_DELAY&&t>RetryHandlerOptions.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>RetryHandlerOptions.MAX_DELAY){const e=new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>RetryHandlerOptions.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,RetryHandlerOptions.MAX_DELAY),this.maxRetries=Math.min(t,RetryHandlerOptions.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return RetryHandlerOptions.MAX_DELAY}}RetryHandlerOptions.DEFAULT_DELAY=3,RetryHandlerOptions.DEFAULT_MAX_RETRIES=3,RetryHandlerOptions.MAX_DELAY=180,RetryHandlerOptions.MAX_MAX_RETRIES=10,RetryHandlerOptions.DEFAULT_SHOULD_RETRY=()=>!0;class RetryHandler{constructor(e=new RetryHandlerOptions){this.options=e}isRetry(e){return-1!==RetryHandler.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(t,r){const o="string"==typeof t?r.method:t.method;if(o===e.PUT||o===e.PATCH||o===e.POST){if("application/octet-stream"===getRequestHeader(t,r,"Content-Type"))return!1}return!0}getDelay(e,t,r){const getRandomness=()=>Number(Math.random().toFixed(3)),o=void 0!==e.headers?e.headers.get(RetryHandler.RETRY_AFTER_HEADER):null;let i;return i=null!==o?Number.isNaN(Number(o))?Math.round((new Date(o).getTime()-Date.now())/1e3):Number(o):t>=2?this.getExponentialBackOffTime(t)+r+getRandomness():r+getRandomness(),Math.min(i,this.options.getMaxDelay()+getRandomness())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return __awaiter$H(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof MiddlewareControl&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new RetryHandlerOptions,this.options)),t}executeWithRetry(e,t,r){return __awaiter$H(this,void 0,void 0,(function*(){try{if(yield this.nextMiddleware.execute(e),t<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,t,e.request,e.options,e.response)){++t,setRequestHeader(e.request,e.options,RetryHandler.RETRY_ATTEMPT_HEADER,t.toString());const o=this.getDelay(e.response,t,r.delay);return yield this.sleep(o),yield this.executeWithRetry(e,t,r)}return}catch(e){throw e}}))}execute(e){return __awaiter$H(this,void 0,void 0,(function*(){try{const r=0,o=this.getOptions(e);return TelemetryHandlerOptions.updateFeatureUsageFlag(e,t.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,r,o)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}RetryHandler.RETRY_STATUS_CODES=[429,503,504],RetryHandler.RETRY_ATTEMPT_HEADER="Retry-Attempt",RetryHandler.RETRY_AFTER_HEADER="Retry-After";class RedirectHandlerOptions{constructor(e=RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS,t=RedirectHandlerOptions.DEFAULT_SHOULD_RETRY){if(e>RedirectHandlerOptions.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS=5,RedirectHandlerOptions.MAX_MAX_REDIRECTS=20,RedirectHandlerOptions.DEFAULT_SHOULD_RETRY=()=>!0;class RedirectHandler$1{constructor(e=new RedirectHandlerOptions){this.options=e}isRedirect(e){return-1!==RedirectHandler$1.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(RedirectHandler$1.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(RedirectHandler$1.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=r.exec(e);let i,n;null!==o&&(i=o[0]);const s=r.exec(t);return null!==s&&(n=s[0]),void 0!==i&&void 0!==n&&i!==n}updateRequestUrl(e,t){return __awaiter$H(this,void 0,void 0,(function*(){var r,o;t.request="string"==typeof t.request?e:yield(r=e,o=t.request,__awaiter$H(void 0,void 0,void 0,(function*(){const e=o.headers.get("Content-Type")?yield o.blob():yield Promise.resolve(void 0),{method:t,headers:i,referrer:n,referrerPolicy:s,mode:a,credentials:l,cache:c,redirect:d,integrity:u,keepalive:h,signal:p}=o;return new Request(r,{method:t,headers:i,body:e,referrer:n,referrerPolicy:s,mode:a,credentials:l,cache:c,redirect:d,integrity:u,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof MiddlewareControl&&(t=e.middlewareControl.getMiddlewareOptions(RedirectHandlerOptions)),void 0===t&&(t=Object.assign(new RedirectHandlerOptions,this.options)),t}executeWithRedirect(t,r,o){return __awaiter$H(this,void 0,void 0,(function*(){try{yield this.nextMiddleware.execute(t);const i=t.response;if(!(r<o.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&o.shouldRedirect(i)))return;if(++r,i.status===RedirectHandler$1.STATUS_CODE_SEE_OTHER)t.options.method=e.GET,delete t.options.body;else{const e=this.getLocationHeader(i);!this.isRelativeURL(e)&&this.shouldDropAuthorizationHeader(i.url,e)&&delete t.options.headers[RedirectHandler$1.AUTHORIZATION_HEADER],yield this.updateRequestUrl(e,t)}yield this.executeWithRedirect(t,r,o)}catch(e){throw e}}))}execute(e){return __awaiter$H(this,void 0,void 0,(function*(){try{const r=0,o=this.getOptions(e);return e.options.redirect=RedirectHandler$1.MANUAL_REDIRECT,TelemetryHandlerOptions.updateFeatureUsageFlag(e,t.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,r,o)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}RedirectHandler$1.REDIRECT_STATUS_CODES=[301,302,303,307,308],RedirectHandler$1.STATUS_CODE_SEE_OTHER=303,RedirectHandler$1.LOCATION_HEADER="Location",RedirectHandler$1.AUTHORIZATION_HEADER="Authorization",RedirectHandler$1.MANUAL_REDIRECT="manual";const r=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn"]),o=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],serializeContent=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e};class TelemetryHandler{execute(e){return __awaiter$H(this,void 0,void 0,(function*(){try{if((e=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const t=(e=e.replace("https://","")).indexOf(":"),o=e.indexOf("/");let i="";if(-1!==o)return-1!==t&&t<o?(i=e.substring(0,t),r.has(i)):(i=e.substring(0,o),r.has(i))}return!1})("string"==typeof e.request?e.request:e.request.url)){let t=getRequestHeader(e.request,e.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER);t||(t=(()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e})(),setRequestHeader(e.request,e.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER,t));let r,o=`${TelemetryHandler.PRODUCT_NAME}/2.2.1`;if(e.middlewareControl instanceof MiddlewareControl&&(r=e.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions)),r){const e=r.getFeatureUsage();o+=` (${TelemetryHandler.FEATURE_USAGE_STRING}=${e})`}appendRequestHeader(e.request,e.options,TelemetryHandler.SDK_VERSION_HEADER,o)}else delete e.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[TelemetryHandler.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}catch(e){throw e}}))}setNext(e){this.nextMiddleware=e}}var i,n,s,a,l;TelemetryHandler.CLIENT_REQUEST_ID_HEADER="client-request-id",TelemetryHandler.SDK_VERSION_HEADER="SdkVersion",TelemetryHandler.PRODUCT_NAME="graph-js",TelemetryHandler.FEATURE_USAGE_STRING="featureUsage",function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(i||(i={}));class CustomAuthenticationProvider{constructor(e){this.provider=e}getAccessToken(){return __awaiter$H(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((r,o)=>{o?e(o):t(r)}))}))}))}}class GraphError extends Error{constructor(e=-1,t,r){super(t||r&&r.message),Object.setPrototypeOf(this,GraphError.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class GraphErrorHandler{static constructError(e,t){const r=new GraphError(t,"",e);return void 0!==e.name&&(r.code=e.name),r.body=e.toString(),r.date=new Date,r}static constructErrorFromResponse(e,t){e=e.error;const r=new GraphError(t,e.message);r.code=e.code,void 0!==e.innerError&&(r.requestId=e.innerError["request-id"],r.date=new Date(e.innerError.date));try{r.body=JSON.stringify(e)}catch(e){}return r}static getError(e=null,t=-1,r){return __awaiter$H(this,void 0,void 0,(function*(){let o;if(o=e&&e.error?GraphErrorHandler.constructErrorFromResponse(e,t):"undefined"!=typeof Error&&e instanceof Error?GraphErrorHandler.constructError(e,t):new GraphError(t),"function"!=typeof r)return o;r(o,null)}))}}!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(n||(n={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(s||(s={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(a||(a={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(l||(l={}));class GraphResponseHandler{static parseDocumentResponse(e,t){try{return"undefined"!=typeof DOMParser?new Promise(((r,o)=>{e.text().then((e=>{try{const o=(new DOMParser).parseFromString(e,t);r(o)}catch(e){o(e)}}))})):Promise.resolve(e.body)}catch(e){throw e}}static convertResponse(e,t){return __awaiter$H(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let r;try{switch(t){case n.ARRAYBUFFER:r=yield e.arrayBuffer();break;case n.BLOB:r=yield e.blob();break;case n.DOCUMENT:r=yield GraphResponseHandler.parseDocumentResponse(e,s.TEXT_XML);break;case n.JSON:r=yield e.json();break;case n.STREAM:r=yield Promise.resolve(e.body);break;case n.TEXT:r=yield e.text();break;default:const t=e.headers.get("Content-type");if(null!==t){const o=t.split(";")[0];r=new RegExp(l.DOCUMENT).test(o)?yield GraphResponseHandler.parseDocumentResponse(e,o):new RegExp(l.IMAGE).test(o)?e.blob():o===a.TEXT_PLAIN?yield e.text():o===a.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else r=Promise.resolve(e.body)}}catch(e){throw e}return r}))}static getResponse(e,t,r){return __awaiter$H(this,void 0,void 0,(function*(){try{if(t===n.RAW)return Promise.resolve(e);{const o=yield GraphResponseHandler.convertResponse(e,t);if(!e.ok)throw o;if("function"!=typeof r)return o;r(null,o)}}catch(e){throw e}}))}}class GraphRequest{constructor(e,t,r){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const r=e.indexOf("/");-1!==r&&(this.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const r=e.substring(t+1,e.length).split("&");for(const e of r)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];r.length>1&&"string"==typeof t?o=Array.prototype.slice.call(r):"string"==typeof t?o.push(t):o=o.concat(t),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=(e=>{const removePreSlash=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,t)=>{return[(r=e,r.replace(/\/+$/,"")),removePreSlash(t)].join("/");var r}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const r in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const r in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.otherURLQueryParams[r]);if(0!==e.otherURLQueryOptions.length)for(const r of e.otherURLQueryOptions)t.push(r);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)e.hasOwnProperty(t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),r=e.substring(0,t),o=e.substring(t+1);this.setURLComponentsQueryParamater(r,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==o.indexOf(e)){const r=this.urlComponents.oDataQueryParams[e],o=r&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=o?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");if(-1===t)return!1;return!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,r){return __awaiter$H(this,void 0,void 0,(function*(){let o;const i=new MiddlewareControl(this._middlewareOptions);this.updateRequestOptions(t);try{o=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:i})).response;return yield GraphResponseHandler.getResponse(o,this._responseType,r)}catch(e){let t;void 0!==o&&(t=o.status);throw yield GraphErrorHandler.getError(e,t,r)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!1){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(t){return __awaiter$H(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),o={method:e.GET};try{return yield this.send(r,o,t)}catch(e){throw e}}))}post(t,r){return __awaiter$H(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),i={method:e.POST,body:serializeContent(t)};"FormData"===(t&&t.constructor&&t.constructor.name)?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers);try{return yield this.send(o,i,r)}catch(e){throw e}}))}create(e,t){return __awaiter$H(this,void 0,void 0,(function*(){try{return yield this.post(e,t)}catch(e){throw e}}))}put(t,r){return __awaiter$H(this,void 0,void 0,(function*(){const o=this.buildFullUrl();this.setHeaderContentType();const i={method:e.PUT,body:serializeContent(t)};try{return yield this.send(o,i,r)}catch(e){throw e}}))}patch(t,r){return __awaiter$H(this,void 0,void 0,(function*(){const o=this.buildFullUrl();this.setHeaderContentType();const i={method:e.PATCH,body:serializeContent(t)};try{return yield this.send(o,i,r)}catch(e){throw e}}))}update(e,t){return __awaiter$H(this,void 0,void 0,(function*(){try{return yield this.patch(e,t)}catch(e){throw e}}))}delete(t){return __awaiter$H(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),o={method:e.DELETE};try{return yield this.send(r,o,t)}catch(e){throw e}}))}del(e){return __awaiter$H(this,void 0,void 0,(function*(){try{return yield this.delete(e)}catch(e){throw e}}))}getStream(t){return __awaiter$H(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),o={method:e.GET};this.responseType(n.STREAM);try{return yield this.send(r,o,t)}catch(e){throw e}}))}putStream(t,r){return __awaiter$H(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),i={method:e.PUT,headers:{"Content-Type":"application/octet-stream"},body:t};try{return yield this.send(o,i,r)}catch(e){throw e}}))}}class HTTPClient{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,r)=>{r<e.length-1&&t.setNext(e[r+1])})),this.middleware=e[0]}sendRequest(e){return __awaiter$H(this,void 0,void 0,(function*(){try{if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}catch(e){throw e}}))}}class HTTPClientFactory{static createWithAuthenticationProvider(e){const t=new AuthenticationHandler(e),r=new RetryHandler(new RetryHandlerOptions),o=new TelemetryHandler,i=new HTTPMessageHandler;if(t.setNext(r),"object"==typeof process&&"function"==typeof require){const e=new RedirectHandler$1(new RedirectHandlerOptions);r.setNext(e),e.setNext(o)}else r.setNext(o);return o.setNext(i),HTTPClientFactory.createWithMiddleware(t)}static createWithMiddleware(...e){return new HTTPClient(...e)}}class Client{constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"};try{(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})()}catch(e){throw e}for(const t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=HTTPClientFactory.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new HTTPClient(...[].concat(e.middleware))}this.httpClient=t}static init(e){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[r]="authProvider"===r?new CustomAuthenticationProvider(e[r]):e[r]);return Client.initWithMiddleware(t)}static initWithMiddleware(e){try{return new Client(e)}catch(e){throw e}}api(e){return new GraphRequest(this.httpClient,this.config,e)}}var c,d=function(){function CryptoUtils(){}return CryptoUtils.createNewGuid=function(){var e=window.crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,CryptoUtils.decimalToHex(t[0])+CryptoUtils.decimalToHex(t[1])+CryptoUtils.decimalToHex(t[2])+CryptoUtils.decimalToHex(t[3])+"-"+CryptoUtils.decimalToHex(t[4])+CryptoUtils.decimalToHex(t[5])+"-"+CryptoUtils.decimalToHex(t[6])+CryptoUtils.decimalToHex(t[7])+"-"+CryptoUtils.decimalToHex(t[8])+CryptoUtils.decimalToHex(t[9])+"-"+CryptoUtils.decimalToHex(t[10])+CryptoUtils.decimalToHex(t[11])+CryptoUtils.decimalToHex(t[12])+CryptoUtils.decimalToHex(t[13])+CryptoUtils.decimalToHex(t[14])+CryptoUtils.decimalToHex(t[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,n="",s=0;s<36;s++)"-"!==r[s]&&"4"!==r[s]&&(i=16*Math.random()|0),"x"===r[s]?n+=o[i]:"y"===r[s]?(i&=3,n+=o[i|=8]):n+=r[s];return n},CryptoUtils.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},CryptoUtils.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},CryptoUtils.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function toSolidBytes(e,t){return String.fromCharCode(Number("0x"+t))})))},CryptoUtils.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},CryptoUtils.deserialize=function(e){var t,r=/\+/g,o=/([^&=]+)=([^&]*)/g,decode=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=o.exec(e);t;)i[decode(t[1])]=decode(t[2]),t=o.exec(e);return i},CryptoUtils}(),u=function(){function Constants(){}return Object.defineProperty(Constants,"libraryName",{get:function(){return"Msal.js"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"claims",{get:function(){return"claims"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"clientId",{get:function(){return"clientId"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"cachePrefix",{get:function(){return"msal"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"scopes",{get:function(){return"scopes"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"upn",{get:function(){return"upn"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"domain_hint",{get:function(){return"domain_hint"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt",{get:function(){return"prompt"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"resourceDelimiter",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"cacheDelimiter",{get:function(){return"."},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"login",{get:function(){return"LOGIN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"unknown",{get:function(){return"UNKNOWN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"ADFS",{get:function(){return"adfs"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"common",{get:function(){return"common"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"openidScope",{get:function(){return"openid"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"profileScope",{get:function(){return"profile"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"inProgress",{get:function(){return"inProgress"},enumerable:!1,configurable:!0}),Constants._popUpWidth=483,Constants._popUpHeight=600,Constants}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(c||(c={}));var h,p,f,g="id_token",m="token",v="id_token token";!function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction.status",e.REDIRECT_REQUEST="redirect_request"}(h||(h={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(p||(p={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(f||(f={}));var b;!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(b||(b={}));var y,w=[b.SID,b.LOGIN_HINT],k="GET",T={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},_="msalIdTokenFrame",S="msalRenewFrame",E={code:"unexpected_error",desc:"Unexpected error in authentication."},I={code:"no_window_object",desc:"No window object available. Details:"},x=function(e){function AuthError(t,r){var o=e.call(this,r)||this;return Object.setPrototypeOf(o,AuthError.prototype),o.errorCode=t,o.errorMessage=r,o.name="AuthError",o}return __extends$2(AuthError,e),AuthError.createUnexpectedError=function(e){return new AuthError(E.code,E.desc+": "+e)},AuthError.createNoWindowObjectError=function(e){return new AuthError(I.code,I.desc+" "+e)},AuthError}(Error),A=function(){function StringUtils(){}return StringUtils.isEmpty=function(e){return void 0===e||!e||0===e.length},StringUtils.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},StringUtils}(),P={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},R={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},O={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},N={code:"invalid_id_token",desc:"Invalid ID token format."},L={code:"invalid_state_error",desc:"Invalid state."},M={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},$={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},U={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},F={code:"user_cancelled",desc:"User cancelled the flow."},H={code:"callback_error",desc:"Error occurred in token received callback function."},B={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},q={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},z={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},j={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},V={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},G={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},K={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},W={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},Q={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},Y={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},J=function(e){function ClientAuthError(t,r){var o=e.call(this,t,r)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,ClientAuthError.prototype),o}return __extends$2(ClientAuthError,e),ClientAuthError.createEndpointResolutionError=function(e){var t=P.desc;return e&&!A.isEmpty(e)&&(t+=" Details: "+e),new ClientAuthError(P.code,t)},ClientAuthError.createPopupWindowError=function(e){var t=R.desc;return e&&!A.isEmpty(e)&&(t+=" Details: "+e),new ClientAuthError(R.code,t)},ClientAuthError.createTokenRenewalTimeoutError=function(){return new ClientAuthError(O.code,O.desc)},ClientAuthError.createInvalidIdTokenError=function(e){return new ClientAuthError(N.code,N.desc+" Given token: "+e)},ClientAuthError.createInvalidStateError=function(e,t){return new ClientAuthError(L.code,L.desc+" "+e+", state expected : "+t+".")},ClientAuthError.createNonceMismatchError=function(e,t){return new ClientAuthError(M.code,M.desc+" "+e+", nonce expected : "+t+".")},ClientAuthError.createLoginInProgressError=function(){return new ClientAuthError($.code,$.desc)},ClientAuthError.createAcquireTokenInProgressError=function(){return new ClientAuthError(U.code,U.desc)},ClientAuthError.createUserCancelledError=function(){return new ClientAuthError(F.code,F.desc)},ClientAuthError.createErrorInCallbackFunction=function(e){return new ClientAuthError(H.code,H.desc+" "+e+".")},ClientAuthError.createUserLoginRequiredError=function(){return new ClientAuthError(B.code,B.desc)},ClientAuthError.createUserDoesNotExistError=function(){return new ClientAuthError(q.code,q.desc)},ClientAuthError.createClientInfoDecodingError=function(e){return new ClientAuthError(z.code,z.desc+" Failed with error: "+e)},ClientAuthError.createClientInfoNotPopulatedError=function(e){return new ClientAuthError(j.code,j.desc+" Failed with error: "+e)},ClientAuthError.createIdTokenNullOrEmptyError=function(e){return new ClientAuthError(V.code,V.desc+" Raw ID Token Value: "+e)},ClientAuthError.createIdTokenParsingError=function(e){return new ClientAuthError(G.code,G.desc+" Failed with error: "+e)},ClientAuthError.createTokenEncodingError=function(e){return new ClientAuthError(K.code,K.desc+" Attempted to decode: "+e)},ClientAuthError.createInvalidInteractionTypeError=function(){return new ClientAuthError(W.code,W.desc)},ClientAuthError.createCacheParseError=function(e){var t="invalid key: "+e+", "+Q.desc;return new ClientAuthError(Q.code,t)},ClientAuthError.createBlockTokenRequestsInHiddenIframeError=function(){return new ClientAuthError(Y.code,Y.desc)},ClientAuthError}(x),Z={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},X={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},ee={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},te={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},re={code:"scopes_required",desc:"Scopes are required to obtain an access token."},oe={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},ie={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},ne={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},se={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},ae={code:"authority_uri_insecure",desc:"Authority URIs must use https."},le={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},ce={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},de={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},ue={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},he={code:"empty_request_error",desc:"Request object is required."},pe={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},fe={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ge={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},me={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},ve=function(e){function ClientConfigurationError(t,r){var o=e.call(this,t,r)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,ClientConfigurationError.prototype),o}return __extends$2(ClientConfigurationError,e),ClientConfigurationError.createNoSetConfigurationError=function(){return new ClientConfigurationError(Z.code,""+Z.desc)},ClientConfigurationError.createStorageNotSupportedError=function(e){return new ClientConfigurationError(X.code,X.desc+" Given location: "+e)},ClientConfigurationError.createRedirectCallbacksNotSetError=function(){return new ClientConfigurationError(ee.code,ee.desc)},ClientConfigurationError.createInvalidCallbackObjectError=function(e){return new ClientConfigurationError(te.code,te.desc+" Given value for callback function: "+e)},ClientConfigurationError.createEmptyScopesArrayError=function(e){return new ClientConfigurationError(oe.code,oe.desc+" Given value: "+e+".")},ClientConfigurationError.createScopesNonArrayError=function(e){return new ClientConfigurationError(ie.code,ie.desc+" Given value: "+e+".")},ClientConfigurationError.createScopesRequiredError=function(e){return new ClientConfigurationError(re.code,re.desc+" Given value: "+e)},ClientConfigurationError.createInvalidPromptError=function(e){return new ClientConfigurationError(ne.code,ne.desc+" Given value: "+e)},ClientConfigurationError.createClaimsRequestParsingError=function(e){return new ClientConfigurationError(ue.code,ue.desc+" Given value: "+e)},ClientConfigurationError.createEmptyRequestError=function(){var e=he;return new ClientConfigurationError(e.code,e.desc)},ClientConfigurationError.createInvalidCorrelationIdError=function(){return new ClientConfigurationError(pe.code,pe.desc)},ClientConfigurationError.createKnownAuthoritiesNotSetError=function(){return new ClientConfigurationError(de.code,de.desc)},ClientConfigurationError.createInvalidAuthorityTypeError=function(){return new ClientConfigurationError(se.code,se.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(e){return new ClientConfigurationError(ce.code,ce.desc+" Provided Authority: "+e)},ClientConfigurationError.createTelemetryConfigError=function(e){var t=fe,r=t.code,o=t.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new ClientConfigurationError(r,o+" mising values: "+Object.keys(i).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"])}),[]).join(","))},ClientConfigurationError.createSsoSilentError=function(){return new ClientConfigurationError(ge.code,ge.desc)},ClientConfigurationError.createInvalidAuthorityMetadataError=function(){return new ClientConfigurationError(me.code,me.desc)},ClientConfigurationError}(J),be=function(){function ScopeSet(){}return ScopeSet.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(e)),o=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t)),i=0;i<o.length;i++)if(r.indexOf(o[i].toLowerCase())>-1)return!0;return!1},ScopeSet.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(e));return this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t)).every((function(e){return r.indexOf(e.toString().toLowerCase())>=0}))},ScopeSet.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},ScopeSet.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},ScopeSet.trimScopes=function(e){return e.map((function(e){return e.trim()}))},ScopeSet.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==r}))},ScopeSet.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},ScopeSet.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw ve.createScopesNonArrayError(e);if(e.length<1&&t)throw ve.createEmptyScopesArrayError(e.toString())}else if(t)throw ve.createScopesRequiredError(e)},ScopeSet.getScopeFromState=function(e){if(e){var t=e.indexOf(u.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},ScopeSet.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t)):null,o=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(e));return r?__spreadArrays$1(o,r):o}return null},ScopeSet.onlyContainsOidcScopes=function(e){var t=e.length,r=0;return e.indexOf(u.openidScope)>-1&&(r+=1),e.indexOf(u.profileScope)>-1&&(r+=1),t>0&&t===r},ScopeSet.containsAnyOidcScopes=function(e){var t=e.indexOf(u.openidScope)>-1,r=e.indexOf(u.profileScope)>-1;return t||r},ScopeSet.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},ScopeSet.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(u.openidScope)&&t.push(u.openidScope),-1===t.indexOf(u.profileScope)&&t.push(u.profileScope),t},ScopeSet.removeDefaultScopes=function(e){return e.filter((function(e){return e!==u.openidScope&&e!==u.profileScope}))},ScopeSet.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?u.oidcScopes:e},ScopeSet}(),ye=function(){function UrlUtils(){}return UrlUtils.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},UrlUtils.createNavigationUrlString=function(e){var t=be.appendDefaultScopes(e.scopes),r=[];return r.push("response_type="+e.responseType),r.push("scope="+encodeURIComponent(be.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},UrlUtils.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},UrlUtils.removeHashFromUrl=function(e){return e.split("#")[0]},UrlUtils.replaceTenantPath=function(e,t){var r=e.toLowerCase(),o=this.GetUrlComponents(r),i=o.PathSegments;return!t||0===i.length||i[0]!==u.common&&i[0]!==b.ORGANIZATIONS&&i[0]!==b.CONSUMERS||(i[0]=t),this.constructAuthorityUriFromObject(o,i)},UrlUtils.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},UrlUtils.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===u.common},UrlUtils.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===b.ORGANIZATIONS},UrlUtils.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===b.CONSUMERS},UrlUtils.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var o={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},i=o.AbsolutePath.split("/");return i=i.filter((function(e){return e&&e.length>0})),o.PathSegments=i,r[6]&&(o.Search=r[6]),r[8]&&(o.Hash=r[8]),o},UrlUtils.CanonicalizeUri=function(e){if(e){var t=e.toLowerCase();return UrlUtils.endsWith(t,"/")||(t+="/"),t}return e},UrlUtils.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},UrlUtils.urlRemoveQueryStringParameter=function(e,t){if(A.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},UrlUtils.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},UrlUtils.urlContainsHash=function(e){var t=UrlUtils.deserializeHash(e);return t.hasOwnProperty(c.ERROR_DESCRIPTION)||t.hasOwnProperty(c.ERROR)||t.hasOwnProperty(c.ACCESS_TOKEN)||t.hasOwnProperty(c.ID_TOKEN)},UrlUtils.deserializeHash=function(e){var t=UrlUtils.getHashFromUrl(e);return d.deserialize(t)},UrlUtils.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},UrlUtils}(),we=function we(e,t,r,o,i){this.authority=ye.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=d.base64Encode(o)+"."+d.base64Encode(i)},Ce=function Ce(e,t,r,o){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=o},ke=function(){function ServerRequestParameters(e,t,r,o,i,n,s){this.authorityInstance=e,this.clientId=t,this.nonce=d.createNewGuid(),this.scopes=i?__spreadArrays$1(i):u.oidcScopes,this.scopes=be.trimScopes(this.scopes),this.state=n,this.correlationId=s,this.xClientSku="MSAL.JS",this.xClientVer="1.4.16",this.responseType=r,this.redirectUri=o}return Object.defineProperty(ServerRequestParameters.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!1,configurable:!0}),ServerRequestParameters.prototype.populateQueryParams=function(e,t,r,o){var i={};t&&(t.prompt&&(this.promptValue=t.prompt),t.claimsRequest&&(this.claimsValue=t.claimsRequest),ServerRequestParameters.isSSOParam(t)&&(i=this.constructUnifiedCacheQueryParameter(t,null))),r&&(i=this.constructUnifiedCacheQueryParameter(null,r)),i=this.addHintParameters(e,i);var n=t?t.extraQueryParameters:null;this.queryParameters=ServerRequestParameters.generateQueryParametersString(i),this.extraQueryParameters=ServerRequestParameters.generateQueryParametersString(n,o)},ServerRequestParameters.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,o;if(e)if(e.account){var i=e.account;i.sid?(r=b.SID,o=i.sid):i.userName&&(r=b.LOGIN_HINT,o=i.userName)}else e.sid?(r=b.SID,o=e.sid):e.loginHint&&(r=b.LOGIN_HINT,o=e.loginHint);else t&&t.hasOwnProperty(u.upn)&&(r=b.ID_TOKEN,o=t.upn);return this.addSSOParameter(r,o)},ServerRequestParameters.prototype.addHintParameters=function(e,t){var r=t;e&&!r[b.SID]&&(!r[b.LOGIN_HINT]&&e.sid&&this.promptValue===T.NONE?r=this.addSSOParameter(b.SID,e.sid,r):!r[b.LOGIN_HINT]&&e.userName&&!A.isEmpty(e.userName)&&(r=this.addSSOParameter(b.LOGIN_HINT,e.userName,r)));return r},ServerRequestParameters.prototype.addSSOParameter=function(e,t,r){var o=r||{};if(!t)return o;switch(e){case b.SID:o[b.SID]=t;break;case b.ID_TOKEN:case b.LOGIN_HINT:o[b.LOGIN_HINT]=t}return o},ServerRequestParameters.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach((function(o){o===u.domain_hint&&(t||e[b.SID])||(r?r+="&"+o+"="+encodeURIComponent(e[o]):r=o+"="+encodeURIComponent(e[o]))})),r},ServerRequestParameters.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},ServerRequestParameters.determineResponseType=function(e,t){return be.onlyContainsOidcScopes(t)?g:e?this.responseTypeForMatchingAccounts(t):v},ServerRequestParameters.responseTypeForMatchingAccounts=function(e){return be.containsAnyOidcScopes(e)?v:m},ServerRequestParameters}(),Te=function(){function XhrClient(){}return XhrClient.prototype.sendRequestAsync=function(e,t,r){var o=this;return new Promise((function(r,i){var n=new XMLHttpRequest;if(n.open(t,e,!0),n.onload=function(){var e;(n.status<200||n.status>=300)&&i(o.handleError(n.responseText));try{e=JSON.parse(n.responseText)}catch(e){i(o.handleError(n.responseText))}var t={statusCode:n.status,body:e};r(t)},n.onerror=function(){i(n.status)},t!==k)throw"not implemented";n.send()}))},XhrClient.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},XhrClient}(),_e=function(){function TrustedAuthority(){}return TrustedAuthority.setTrustedAuthoritiesFromConfig=function(e,t){e&&!this.getTrustedHostList().length&&t.forEach((function(e){TrustedAuthority.TrustedHostList.push(e.toLowerCase())}))},TrustedAuthority.getAliases=function(e,t,r){return __awaiter$H(this,void 0,void 0,(function(){var o,i,n,s;return __generator$2(this,(function(a){return o=new Te,i=k,n="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",s=t.createAndStartHttpEvent(r,i,n,"getAliases"),[2,o.sendRequestAsync(n,i,!0).then((function(e){return s.httpResponseStatus=e.statusCode,t.stopEvent(s),e.body.metadata})).catch((function(e){throw s.serverErrorCode=e,t.stopEvent(s),e}))]}))}))},TrustedAuthority.setTrustedAuthoritiesFromNetwork=function(e,t,r){return __awaiter$H(this,void 0,void 0,(function(){var o;return __generator$2(this,(function(i){switch(i.label){case 0:return[4,this.getAliases(e,t,r)];case 1:return i.sent().forEach((function(e){e.aliases.forEach((function(e){TrustedAuthority.TrustedHostList.push(e.toLowerCase())}))})),o=ye.GetUrlComponents(e).HostNameAndPort,TrustedAuthority.getTrustedHostList().length&&!TrustedAuthority.IsInTrustedHostList(o)&&TrustedAuthority.TrustedHostList.push(o.toLowerCase()),[2]}}))}))},TrustedAuthority.getTrustedHostList=function(){return this.TrustedHostList},TrustedAuthority.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},TrustedAuthority.TrustedHostList=[],TrustedAuthority}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(y||(y={}));var Se,Ee=function(){function Authority(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return Authority.isAdfs=function(e){var t=ye.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===u.ADFS},Object.defineProperty(Authority.prototype,"AuthorityType",{get:function(){return Authority.isAdfs(this.canonicalAuthority)?y.Adfs:y.Default},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Authority.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(Authority.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=ye.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=ye.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===y.Adfs?this.CanonicalAuthority+".well-known/openid-configuration":this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),Authority.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw se}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ae;if(!e.PathSegments||e.PathSegments.length<1)throw le},Authority.prototype.DiscoverEndpoints=function(e,t,r){var o=new Te,i=k,n=t.createAndStartHttpEvent(r,i,e,"openIdConfigurationEndpoint");return o.sendRequestAsync(e,i,!0).then((function(e){return n.httpResponseStatus=e.statusCode,t.stopEvent(n),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw n.serverErrorCode=e,t.stopEvent(n),e}))},Authority.prototype.resolveEndpointsAsync=function(e,t){return __awaiter$H(this,void 0,void 0,(function(){var r,o,i;return __generator$2(this,(function(n){switch(n.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==_e.getTrustedHostList().length?[3,2]:[4,_e.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:n.sent(),n.label=2;case 2:if(!_e.IsInTrustedHostList(r))throw ve.createUntrustedAuthorityError(r);n.label=3;case 3:return o=this.GetOpenIdConfigurationEndpoint(),i=this,[4,this.DiscoverEndpoints(o,e,t)];case 4:return i.tenantDiscoveryResponse=n.sent(),[2,this.tenantDiscoveryResponse]}}))}))},Authority.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},Authority.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},Authority}(),Ie=function(){function ClientInfo(e,t){if(!e||A.isEmpty(e))return this.uid="",void(this.utid="");try{var r=d.base64Decode(e),o=JSON.parse(r);o&&(o.hasOwnProperty("uid")&&(this.uid=t?ClientInfo.stripPolicyFromUid(o.uid,t):o.uid),o.hasOwnProperty("utid")&&(this.utid=o.utid))}catch(e){throw J.createClientInfoDecodingError(e)}}return Object.defineProperty(ClientInfo.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!1,configurable:!0}),Object.defineProperty(ClientInfo.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!1,configurable:!0}),ClientInfo.createClientInfoFromIdToken=function(e,t){var r={uid:e.subject,utid:""};return new ClientInfo(d.base64Encode(JSON.stringify(r)),t)},ClientInfo.stripPolicyFromUid=function(e,t){var r=e.split("-"),o=t.split("/").reverse(),i="";return A.isEmpty(o[0])?o.length>1&&(i=o[1]):i=o[0],r[r.length-1]===i?r.slice(0,r.length-1).join("-"):e},ClientInfo.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return d.base64Encode(e)},ClientInfo}(),xe=function(){function TimeUtils(){}return TimeUtils.parseExpiresIn=function(e){return parseInt(e||"3599",10)},TimeUtils.now=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.relativeNowMs=function(){return window.performance.now()},TimeUtils}(),Ae=function(){function TokenUtils(){}return TokenUtils.decodeJwt=function(e){if(A.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},TokenUtils.validateExpirationIsWithinOffset=function(e,t){var r=t||300;return e&&e>xe.now()+r},TokenUtils.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=d.base64Decode(r);return o?JSON.parse(o):null}catch(e){}return null},TokenUtils}(),Pe=function Pe(e){if(A.isEmpty(e))throw J.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=Ae.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw J.createIdTokenParsingError(e)}},Re=function Re(e,t){this.key=e,this.value=t},Oe=function(){function BrowserStorage(e){if(!window)throw x.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!==window[e]))throw ve.createStorageNotSupportedError(e);this.cacheLocation=e}return BrowserStorage.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},BrowserStorage.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},BrowserStorage.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},BrowserStorage.prototype.clear=function(){return window[this.cacheLocation].clear()},BrowserStorage.prototype.setItemCookie=function(e,t,r){var o=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(o+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=o},BrowserStorage.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var i=r[o];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""},BrowserStorage.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},BrowserStorage.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},BrowserStorage}(),Ne=function(){function RequestUtils(){}return RequestUtils.validateRequest=function(e,t,r,o){if(!t&&!e)throw ve.createEmptyRequestError();var i,n;e&&(i=t?be.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,be.validateInputScope(i,!t),i=be.translateClientIdIfSingleScope(i,r),this.validatePromptParameter(e.prompt),n=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var s=this.validateAndGenerateState(e&&e.state,o),a=this.validateAndGenerateCorrelationId(e&&e.correlationId);return __assign$2(__assign$2({},e),{extraQueryParameters:n,scopes:i,state:s,correlationId:a})},RequestUtils.validatePromptParameter=function(e){if(e&&[T.LOGIN,T.SELECT_ACCOUNT,T.CONSENT,T.NONE].indexOf(e)<0)throw ve.createInvalidPromptError(e)},RequestUtils.validateEQParameters=function(e,t){var r=__assign$2({},e);return r?(t&&delete r[u.claims],w.forEach((function(e){r[e]&&delete r[e]})),r):null},RequestUtils.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw ve.createClaimsRequestParsingError(e)}},RequestUtils.validateAndGenerateState=function(e,t){return A.isEmpty(e)?RequestUtils.generateLibraryState(t):""+RequestUtils.generateLibraryState(t)+u.resourceDelimiter+e},RequestUtils.generateLibraryState=function(e){var t={id:d.createNewGuid(),ts:xe.now(),method:e},r=JSON.stringify(t);return d.base64Encode(r)},RequestUtils.parseLibraryState=function(e){var t=decodeURIComponent(e).split(u.resourceDelimiter)[0];if(d.isGuid(t))return{id:t,ts:xe.now(),method:u.interactionTypeRedirect};try{var r=d.base64Decode(t);return JSON.parse(r)}catch(t){throw J.createInvalidStateError(e,null)}},RequestUtils.validateAndGenerateCorrelationId=function(e){if(e&&!d.isGuid(e))throw ve.createInvalidCorrelationIdError();return d.isGuid(e)?e:d.createNewGuid()},RequestUtils.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+u.resourceDelimiter+e.authority},RequestUtils}(),De=function(e){function AuthCache(t,r,o){var i=e.call(this,r)||this;return i.temporaryCache=new Oe("sessionStorage"),i.clientId=t,i.rollbackEnabled=!0,i.migrateCacheEntries(o),i}return __extends$2(AuthCache,e),AuthCache.prototype.migrateCacheEntries=function(t){var r,o=this,i=u.cachePrefix+"."+p.IDTOKEN,n=u.cachePrefix+"."+p.CLIENT_INFO,s=u.cachePrefix+"."+f.ERROR,a=u.cachePrefix+"."+f.ERROR_DESC,l=e.prototype.getItem.call(this,i);if(l)try{r=new Pe(l)}catch(e){return}if(r&&r.claims&&r.claims.aud===this.clientId){var c=[l,e.prototype.getItem.call(this,n),e.prototype.getItem.call(this,s),e.prototype.getItem.call(this,a)];[p.IDTOKEN,p.CLIENT_INFO,f.ERROR,f.ERROR_DESC].forEach((function(e,r){return o.duplicateCacheEntry(e,c[r],t)}))}},AuthCache.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},AuthCache.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+u.cachePrefix)||0===e.indexOf(u.adalIdToken)?e:t?u.cachePrefix+"."+this.clientId+"."+e:u.cachePrefix+"."+e}},AuthCache.prototype.matchKeyForType=function(e,t,r,o){var i=A.validateAndParseJsonCacheKey(e);if(!i)return null;var n=e.match(t)&&e.match(r),s=!1;switch(o){case c.ACCESS_TOKEN:s=!!e.match(u.scopes);break;case c.ID_TOKEN:s=!e.match(u.scopes)}return n&&s?i:null},AuthCache.prototype.setItem=function(t,r,o){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,o),this.rollbackEnabled&&!o&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,o)},AuthCache.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},AuthCache.prototype.removeItem=function(t){this.temporaryCache.removeItem(this.generateCacheKey(t,!0)),e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},AuthCache.prototype.setTemporaryItem=function(e,t,r){this.temporaryCache.setItem(this.generateCacheKey(e,!0),t,r)},AuthCache.prototype.getTemporaryItem=function(e,t){return this.temporaryCache.getItem(this.generateCacheKey(e,!0),t)},AuthCache.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(u.cachePrefix)&&e.prototype.removeItem.call(this,t)},AuthCache.prototype.resetTempCacheItems=function(t){var r=this,o=t&&Ne.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),n=window[this.cacheLocation];o&&!i&&Object.keys(n).forEach((function(t){-1!==t.indexOf(o)&&(r.removeItem(t),e.prototype.clearItemCookie.call(r,t))})),this.setInteractionInProgress(!1),this.removeItem(h.REDIRECT_REQUEST)},AuthCache.prototype.setItemCookie=function(t,r,o){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,o),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,o)},AuthCache.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},AuthCache.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},AuthCache.prototype.getAllTokensByType=function(e,t,r){var o=this;return Object.keys(window[this.cacheLocation]).reduce((function(i,n){var s=o.matchKeyForType(n,e,t,r);if(s){var a=o.getItem(n);if(a)try{var l=new Re(s,JSON.parse(a));return i.concat([l])}catch(e){return i}}return i}),[])},AuthCache.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,c.ACCESS_TOKEN)},AuthCache.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,c.ID_TOKEN)},AuthCache.prototype.getAllTokens=function(e,t){return __spreadArrays$1(this.getAllAccessTokens(e,t),this.getAllIdTokens(e,t))},AuthCache.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},AuthCache.prototype.getInteractionInProgress=function(){return this.getTemporaryItem(this.generateCacheKey(h.INTERACTION_STATUS,!1))},AuthCache.prototype.setInteractionInProgress=function(e){if(e){if(this.isInteractionInProgress(!1))throw J.createAcquireTokenInProgressError();this.setTemporaryItem(this.generateCacheKey(h.INTERACTION_STATUS,!1),this.clientId)}else!e&&this.isInteractionInProgress(!0)&&this.removeItem(this.generateCacheKey(h.INTERACTION_STATUS,!1))},AuthCache.prototype.tokenRenewalInProgress=function(e){var t=this.getItem(AuthCache.generateTemporaryCacheKey(h.RENEW_STATUS,e));return!(!t||t!==u.inProgress)},AuthCache.prototype.clearMsalCookie=function(t){var r=this;t?(this.clearItemCookie(AuthCache.generateTemporaryCacheKey(h.NONCE_IDTOKEN,t)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(h.STATE_LOGIN,t)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(h.LOGIN_REQUEST,t)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(h.STATE_ACQ_TOKEN,t))):document.cookie.split(";").forEach((function(t){var o=t.trim().split("=")[0];o.indexOf(u.cachePrefix)>-1&&e.prototype.clearItemCookie.call(r,o)}))},AuthCache.generateAcquireTokenAccountKey=function(e,t){var r=Ne.parseLibraryState(t).id;return""+h.ACQUIRE_TOKEN_ACCOUNT+u.resourceDelimiter+e+u.resourceDelimiter+r},AuthCache.generateAuthorityKey=function(e){return AuthCache.generateTemporaryCacheKey(h.AUTHORITY,e)},AuthCache.generateTemporaryCacheKey=function(e,t){var r=Ne.parseLibraryState(t).id;return""+e+u.resourceDelimiter+r},AuthCache}(Oe),Le=function(){function Account(e,t,r,o,i,n,s){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=o,this.idToken=i,this.idTokenClaims=i,this.sid=n,this.environment=s}return Account.createAccount=function(e,t){var r,o=e.objectId||e.subject,i=t?t.uid:"",n=t?t.utid:"";return A.isEmpty(i)||(r=A.isEmpty(n)?d.base64Encode(i):d.base64Encode(i)+"."+d.base64Encode(n)),new Account(o,r,e.preferredName,e.name,e.claims,e.sid,e.issuer)},Account.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},Account}(),Me=function(){function WindowUtils(){}return WindowUtils.isInIframe=function(){return window.parent!==window},WindowUtils.isInPopup=function(){return!(!window.opener||window.opener===window)},WindowUtils.generateFrameName=function(e,t){return""+e+u.resourceDelimiter+t},WindowUtils.monitorIframeForHash=function(e,t,r,o){return new Promise((function(i,n){var s=xe.relativeNowMs()+t;o.verbose("monitorWindowForIframe polling started");var a=setInterval((function(){if(xe.relativeNowMs()>s)return o.error("monitorIframeForHash unable to find hash in url, timing out"),o.errorPii("monitorIframeForHash polling timed out for url: "+r),clearInterval(a),void n(J.createTokenRenewalTimeoutError());var t;try{t=e.location.href}catch(e){}t&&ye.urlContainsHash(t)&&(o.verbose("monitorIframeForHash found url in hash"),clearInterval(a),i(e.location.hash))}),WindowUtils.POLLING_INTERVAL_MS)}))},WindowUtils.monitorPopupForHash=function(e,t,r,o){return new Promise((function(i,n){var s=t/WindowUtils.POLLING_INTERVAL_MS,a=0;o.verbose("monitorWindowForHash polling started");var l=setInterval((function(){if(e.closed)return o.error("monitorWindowForHash window closed"),clearInterval(l),void n(J.createUserCancelledError());var t;try{t=e.location.href}catch(e){}if(t&&"about:blank"!==t)if(a++,t&&ye.urlContainsHash(t)){o.verbose("monitorPopupForHash found url in hash"),clearInterval(l);var c=e.location.hash;WindowUtils.clearUrlFragment(e),i(c)}else a>s&&(o.error("monitorPopupForHash unable to find hash in url, timing out"),o.errorPii("monitorPopupForHash polling timed out for url: "+r),clearInterval(l),n(J.createTokenRenewalTimeoutError()))}),WindowUtils.POLLING_INTERVAL_MS)}))},WindowUtils.loadFrame=function(e,t,r,o){var i=this;return o.infoPii("LoadFrame: "+t),new Promise((function(n,s){setTimeout((function(){var r=i.loadFrameSync(e,t,o);r?n(r):s("Unable to load iframe with name: "+t)}),r)}))},WindowUtils.loadFrameSync=function(e,t,r){var o=WindowUtils.addHiddenIFrame(t,r);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=e,r.infoPii("Frame Name : "+t+" Navigated to: "+e)),o):null},WindowUtils.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.info("Add msal iframe to document"),t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(r)t.verbose("Add msal iframe already exists");else{t.verbose("Add msal iframe does not exist");var o=document.createElement("iframe");o.setAttribute("id",e),o.setAttribute("aria-hidden","true"),o.style.visibility="hidden",o.style.position="absolute",o.style.width=o.style.height="0",o.style.border="0",o.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(o)}return r},WindowUtils.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},WindowUtils.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,r){return t.item(r)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}}))[0]},WindowUtils.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},WindowUtils.getPopUpWithHash=function(e){return WindowUtils.getPopups().filter((function(t){try{return t.location.hash===e}catch(e){return!1}}))[0]},WindowUtils.trackPopup=function(e){WindowUtils.getPopups().push(e)},WindowUtils.closePopups=function(){WindowUtils.getPopups().forEach((function(e){return e.close()}))},WindowUtils.blockReloadInHiddenIframes=function(){if(ye.urlContainsHash(window.location.hash)&&WindowUtils.isInIframe())throw J.createBlockTokenRequestsInHiddenIframeError()},WindowUtils.checkIfBackButtonIsPressed=function(e){var t=e.getItem(h.REDIRECT_REQUEST);if(t&&!ye.urlContainsHash(window.location.hash)){var r=t.split(u.resourceDelimiter);r.shift();var o=r.length>0?r.join(u.resourceDelimiter):null;e.resetTempCacheItems(o)}},WindowUtils.clearUrlFragment=function(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},WindowUtils.POLLING_INTERVAL_MS=50,WindowUtils}(),$e=function(){function ResponseUtils(){}return ResponseUtils.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),__assign$2(__assign$2({},e),{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},ResponseUtils.buildAuthResponse=function(e,t,r,o,i,n){switch(r.responseType){case g:var s=__assign$2(__assign$2({},t),{tokenType:c.ID_TOKEN,account:o,scopes:i,accountState:n});return(s=ResponseUtils.setResponseIdToken(s,e)).idToken?s:null;case v:var a=ResponseUtils.setResponseIdToken(t,e);return a&&a.accessToken&&a.idToken?a:null;case m:return ResponseUtils.setResponseIdToken(t,e);default:return null}},ResponseUtils}(),Ue=function(){function AuthorityFactory(){}return AuthorityFactory.saveMetadataFromNetwork=function(e,t,r){return __awaiter$H(this,void 0,void 0,(function(){var o;return __generator$2(this,(function(i){switch(i.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return o=i.sent(),this.metadataMap.set(e.CanonicalAuthority,o),[2,o]}}))}))},AuthorityFactory.getMetadata=function(e){return this.metadataMap.get(e)},AuthorityFactory.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw ve.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw ve.createInvalidAuthorityMetadataError()}},AuthorityFactory.CreateInstance=function(e,t,r){return A.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new Ee(e,t,this.metadataMap.get(e)))},AuthorityFactory.metadataMap=new Map,AuthorityFactory}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Se||(Se={}));var Fe=function(){function Logger(e,t){void 0===t&&(t={}),this.level=Se.Info;var r=t.correlationId,o=void 0===r?"":r,i=t.level,n=void 0===i?Se.Info:i,s=t.piiLoggingEnabled,a=void 0!==s&&s;this.localCallback=e,this.correlationId=o,this.level=n,this.piiLoggingEnabled=a}return Logger.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var o,i=(new Date).toUTCString();o=A.isEmpty(this.correlationId)?i+":1.4.16-"+Se[e]+(r?"-pii":"")+" "+t:i+":"+this.correlationId+"-1.4.16-"+Se[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,o,r)}},Logger.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},Logger.prototype.error=function(e){this.logMessage(Se.Error,e,!1)},Logger.prototype.errorPii=function(e){this.logMessage(Se.Error,e,!0)},Logger.prototype.warning=function(e){this.logMessage(Se.Warning,e,!1)},Logger.prototype.warningPii=function(e){this.logMessage(Se.Warning,e,!0)},Logger.prototype.info=function(e){this.logMessage(Se.Info,e,!1)},Logger.prototype.infoPii=function(e){this.logMessage(Se.Info,e,!0)},Logger.prototype.verbose=function(e){this.logMessage(Se.Verbose,e,!1)},Logger.prototype.verbosePii=function(e){this.logMessage(Se.Verbose,e,!0)},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},Logger}(),He={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return ye.getCurrentUrl()},postLogoutRedirectUri:function(){return ye.getCurrentUrl()},navigateToLoginRequestUrl:!0},Be={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},qe={logger:new Fe(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},ze={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var je={code:"server_unavailable",desc:"Server is temporarily unavailable."},Ve={code:"unknown_server_error"},Ge=function(e){function ServerError(t,r){var o=e.call(this,t,r)||this;return o.name="ServerError",Object.setPrototypeOf(o,ServerError.prototype),o}return __extends$2(ServerError,e),ServerError.createServerUnavailableError=function(){return new ServerError(je.code,je.desc)},ServerError.createUnknownServerError=function(e){return new ServerError(Ve.code,e)},ServerError}(x),Ke={code:"interaction_required"},We={code:"consent_required"},Qe={code:"login_required"},Ye=function(e){function InteractionRequiredAuthError(t,r){var o=e.call(this,t,r)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,InteractionRequiredAuthError.prototype),o}return __extends$2(InteractionRequiredAuthError,e),InteractionRequiredAuthError.isInteractionRequiredError=function(e){var t=[Ke.code,We.code,Qe.code];return e&&t.indexOf(e)>-1},InteractionRequiredAuthError.createLoginRequiredAuthError=function(e){return new InteractionRequiredAuthError(Qe.code,e)},InteractionRequiredAuthError.createInteractionRequiredAuthError=function(e){return new InteractionRequiredAuthError(Ke.code,e)},InteractionRequiredAuthError.createConsentRequiredAuthError=function(e){return new InteractionRequiredAuthError(We.code,e)},InteractionRequiredAuthError}(Ge);function buildResponseStateOnly(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var Je,Ze,Xe,et="Microsoft.MSAL.correlation_id",tt="msal.api_telem_id",rt="msal.api_id",ot="Microsoft_MSAL_cache_event_count",it="Microsoft_MSAL_http_event_count",nt="Microsoft_MSAL_ui_event_count",scrubTenantFromUri=function(e){var t=ye.GetUrlComponents(e);if(Ee.isAdfs(e))return e;var r=t.PathSegments;if(r&&r.length>=2){var o="tfp"===r[1]?2:1;o<r.length&&(r[o]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},hashPersonalIdentifier=function(e){return d.base64Encode(e)},prependEventNamePrefix=function(e){return"msal."+(e||"")},supportsBrowserPerformance=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},st=function(){function TelemetryEvent(e,t,r){var o;this.eventId=d.createNewGuid(),this.label=r,this.event=((o={})[prependEventNamePrefix("event_name")]=e,o[prependEventNamePrefix("elapsed_time")]=-1,o[""+et]=t,o)}return TelemetryEvent.prototype.setElapsedTime=function(e){this.event[prependEventNamePrefix("elapsed_time")]=e},TelemetryEvent.prototype.stop=function(){var e,t,r;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,r=this.perfEndMark,supportsBrowserPerformance()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},TelemetryEvent.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[prependEventNamePrefix("start_time")]=this.startTimestamp,e=this.perfStartMark,supportsBrowserPerformance()&&window.performance.mark(e)},Object.defineProperty(TelemetryEvent.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+et]},set:function(e){this.event[""+et]=e},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"eventName",{get:function(){return this.event[prependEventNamePrefix("event_name")]},enumerable:!1,configurable:!0}),TelemetryEvent.prototype.get=function(){return __assign$2(__assign$2({},this.event),{eventId:this.eventId})},Object.defineProperty(TelemetryEvent.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!1,configurable:!0}),TelemetryEvent}(),at=function(e){function DefaultEvent(t,r,o,i){var n=e.call(this,prependEventNamePrefix("default_event"),r,"DefaultEvent")||this;return n.event[prependEventNamePrefix("client_id")]=o,n.event[prependEventNamePrefix("sdk_plaform")]=t.sdk,n.event[prependEventNamePrefix("sdk_version")]=t.sdkVersion,n.event[prependEventNamePrefix("application_name")]=t.applicationName,n.event[prependEventNamePrefix("application_version")]=t.applicationVersion,n.event[prependEventNamePrefix("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,n.event[""+nt]=n.getEventCount(prependEventNamePrefix("ui_event"),i),n.event[""+it]=n.getEventCount(prependEventNamePrefix("http_event"),i),n.event[""+ot]=n.getEventCount(prependEventNamePrefix("cache_event"),i),n}return __extends$2(DefaultEvent,e),DefaultEvent.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},DefaultEvent}(st),lt=prependEventNamePrefix("authority"),ct=prependEventNamePrefix("authority_type"),dt=prependEventNamePrefix("ui_behavior"),ut=prependEventNamePrefix("tenant_id"),ht=prependEventNamePrefix("user_id"),pt=prependEventNamePrefix("was_successful"),ft=prependEventNamePrefix("api_error_code"),gt=prependEventNamePrefix("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(Ze||(Ze={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(Xe||(Xe={}));var mt=((Je={})[Xe.AcquireTokenSilent]=Ze.AcquireTokenSilent,Je[Xe.AcquireTokenPopup]=Ze.AcquireTokenPopup,Je[Xe.AcquireTokenRedirect]=Ze.AcquireTokenRedirect,Je[Xe.LoginPopup]=Ze.LoginPopup,Je[Xe.LoginRedirect]=Ze.LoginRedirect,Je[Xe.Logout]=Ze.Logout,Je),vt=function(e){function ApiEvent(t,r,o){var i=e.call(this,prependEventNamePrefix("api_event"),t,o)||this;return o&&(i.apiCode=mt[o],i.apiEventIdentifier=o),i.piiEnabled=r,i}return __extends$2(ApiEvent,e),Object.defineProperty(ApiEvent.prototype,"apiEventIdentifier",{set:function(e){this.event[tt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"apiCode",{set:function(e){this.event[rt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"authority",{set:function(e){this.event[lt]=scrubTenantFromUri(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"apiErrorCode",{set:function(e){this.event[ft]=e},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"tenantId",{set:function(e){this.event[ut]=this.piiEnabled&&e?hashPersonalIdentifier(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"accountId",{set:function(e){this.event[ht]=this.piiEnabled&&e?hashPersonalIdentifier(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"wasSuccessful",{get:function(){return!0===this.event[pt]},set:function(e){this.event[pt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"loginHint",{set:function(e){this.event[gt]=this.piiEnabled&&e?hashPersonalIdentifier(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"authorityType",{set:function(e){this.event[ct]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"promptType",{set:function(e){this.event[dt]=e.toLowerCase()},enumerable:!1,configurable:!0}),ApiEvent}(st),bt=prependEventNamePrefix("http_path"),yt=prependEventNamePrefix("user_agent"),wt=prependEventNamePrefix("query_parameters"),Ct=prependEventNamePrefix("api_version"),kt=prependEventNamePrefix("response_code"),Tt=prependEventNamePrefix("oauth_error_code"),_t=prependEventNamePrefix("http_method"),St=prependEventNamePrefix("request_id_header"),Et=prependEventNamePrefix("spe_info"),It=prependEventNamePrefix("server_error_code"),xt=prependEventNamePrefix("server_sub_error_code"),At=prependEventNamePrefix("url"),Pt=function(e){function HttpEvent(t,r){return e.call(this,prependEventNamePrefix("http_event"),t,r)||this}return __extends$2(HttpEvent,e),Object.defineProperty(HttpEvent.prototype,"url",{set:function(e){var t=scrubTenantFromUri(e);this.event[At]=t&&t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpPath",{set:function(e){this.event[bt]=scrubTenantFromUri(e).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"userAgent",{set:function(e){this.event[yt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"queryParams",{set:function(e){this.event[wt]=ke.generateQueryParametersString(e)},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"apiVersion",{set:function(e){this.event[Ct]=e.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpResponseStatus",{set:function(e){this.event[kt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"oAuthErrorCode",{set:function(e){this.event[Tt]=e},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpMethod",{set:function(e){this.event[_t]=e},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"requestIdHeader",{set:function(e){this.event[St]=e},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"speInfo",{set:function(e){this.event[Et]=e},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"serverErrorCode",{set:function(e){this.event[It]=e},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"serverSubErrorCode",{set:function(e){this.event[xt]=e},enumerable:!1,configurable:!0}),HttpEvent}(st),Rt=function(){function TelemetryManager(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=__assign$2({sdk:u.libraryName,sdkVersion:"1.4.16",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return TelemetryManager.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},TelemetryManager.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},TelemetryManager.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=__spreadArrays$1(t||[],[e]),delete this.inProgressEvents[e.key]}},TelemetryManager.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach((function(e){return t.incrementEventCount(e)}));var o=__spreadArrays$1(this.completedEvents[e],r);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],o&&o.length){var n=__spreadArrays$1(o,[new at(this.telemetryPlatform,e,this.clientId,i)]);this.telemetryEmitter(n.map((function(e){return e.get()})))}}},TelemetryManager.prototype.createAndStartApiEvent=function(e,t){var r=new vt(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},TelemetryManager.prototype.stopAndFlushApiEvent=function(e,t,r,o){t.wasSuccessful=r,o&&(t.apiErrorCode=o),this.stopEvent(t),this.flush(e)},TelemetryManager.prototype.createAndStartHttpEvent=function(e,t,r,o){var i=new Pt(e,o);return i.url=r,i.httpMethod=t,this.startEvent(i),i},TelemetryManager.prototype.incrementEventCount=function(e){var t,r=e.eventName,o=this.eventCountByCorrelationId[e.telemetryCorrelationId];o?o[r]=o[r]?o[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},TelemetryManager.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(r,o){if(-1!==o.indexOf(e)){var i=t.inProgressEvents[o];return delete t.inProgressEvents[o],__spreadArrays$1(r,[i])}return r}),[])},TelemetryManager}(),Ot=function(){function AuthCacheUtils(){}return AuthCacheUtils.filterTokenCacheItemsByScope=function(e,t){return e.filter((function(e){var r=e.key.scopes.split(" "),o=be.removeDefaultScopes(t);return 0===o.length?be.containsScope(r,t):be.containsScope(r,o)}))},AuthCacheUtils.filterTokenCacheItemsByAuthority=function(e,t){return e.filter((function(e){return ye.CanonicalizeUri(e.key.authority)===t}))},AuthCacheUtils.filterTokenCacheItemsByDomain=function(e,t){return e.filter((function(e){return ye.GetUrlComponents(e.key.authority).HostNameAndPort===t}))},AuthCacheUtils}(),Nt=function(){function UserAgentApplication(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=function buildConfiguration$1(e){var t=e.auth,r=e.cache,o=void 0===r?{}:r,i=e.system,n=void 0===i?{}:i,s=e.framework,a=void 0===s?{}:s;return{auth:__assign$2(__assign$2({},He),t),cache:__assign$2(__assign$2({},Be),o),system:__assign$2(__assign$2({},qe),n),framework:__assign$2(__assign$2({},ze),a)}}(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),_e.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),Ue.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new De(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var t=window.location.hash,r=ye.urlContainsHash(t);(Me.checkIfBackButtonIsPressed(this.cacheStorage),r&&this.cacheStorage.isInteractionInProgress(!0))&&(this.getResponseState(t).method===u.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t))}return Object.defineProperty(UserAgentApplication.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=Ue.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!1,configurable:!0}),UserAgentApplication.prototype.getAuthorityInstance=function(){return this.authorityInstance},UserAgentApplication.prototype.handleRedirectCallback=function(e,t){if(!e)throw ve.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(u.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(u.interactionTypeRedirect,this.redirectResponse)},UserAgentApplication.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),ye.urlContainsHash(e)},UserAgentApplication.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===u.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==u.interactionTypePopup)throw J.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},UserAgentApplication.prototype.authErrorHandler=function(e,t,r,o){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===u.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r)}else{if(e!==u.interactionTypePopup)throw J.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),o(t)}},UserAgentApplication.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=Ne.validateRequest(e,!0,this.clientId,u.interactionTypeRedirect);this.acquireTokenInteractive(u.interactionTypeRedirect,!0,t,null,null)},UserAgentApplication.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=Ne.validateRequest(e,!1,this.clientId,u.interactionTypeRedirect);this.acquireTokenInteractive(u.interactionTypeRedirect,!1,t,null,null)},UserAgentApplication.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=Ne.validateRequest(e,!0,this.clientId,u.interactionTypePopup),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,Xe.LoginPopup);return new Promise((function(e,o){t.acquireTokenInteractive(u.interactionTypePopup,!0,r,e,o)})).then((function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e}))},UserAgentApplication.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=Ne.validateRequest(e,!1,this.clientId,u.interactionTypePopup),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,Xe.AcquireTokenPopup);return new Promise((function(e,o){t.acquireTokenInteractive(u.interactionTypePopup,!1,r,e,o)})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e}))},UserAgentApplication.prototype.acquireTokenInteractive=function(e,t,r,o,i){var n,s=this;this.logger.verbose("AcquireTokenInteractive has been called"),Me.blockReloadInHiddenIframes();try{this.cacheStorage.setInteractionInProgress(!0)}catch(o){var a=t?J.createLoginInProgressError():J.createAcquireTokenInProgressError(),l=buildResponseStateOnly(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,a,l,i)}if(e===u.interactionTypeRedirect&&this.cacheStorage.setItem(h.REDIRECT_REQUEST,""+u.inProgress+u.resourceDelimiter+r.state),r&&r.account&&!t?(n=r.account,this.logger.verbose("Account set from request")):(n=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),n||ke.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(n,e,t,r,o,i);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");l=buildResponseStateOnly(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,J.createUserLoginRequiredError(),l,i)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var c=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(c).then((function(t){s.silentLogin=!1,s.logger.info("Unified cache call is successful"),s.authResponseHandler(e,t,o)}),(function(n){s.silentLogin=!1,s.logger.error("Error occurred during unified cache ATS: "+n),s.acquireTokenHelper(null,e,t,r,o,i)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,o,i)}},UserAgentApplication.prototype.acquireTokenHelper=function(e,t,r,o,i,n){return __awaiter$H(this,void 0,void 0,(function(){var s,a,l,c,d,p,m,v,b,y;return __generator$2(this,(function(w){switch(w.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),s=o.scopes?o.scopes.join(" ").toLowerCase():u.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+s),l=o&&o.authority?Ue.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata):this.authorityInstance,w.label=1;case 1:return w.trys.push([1,11,,12]),l.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,Ue.saveMetadataFromNetwork(l,this.telemetryManager,o.correlationId)]);case 2:return w.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),w.label=4;case 4:if(d=r?g:this.getTokenType(e,o.scopes),p=o.redirectStartPage||window.location.href,a=new ke(l,this.clientId,d,this.getRedirectUri(o&&o.redirectUri),o.scopes,o.state,o.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(a,e,r,p),this.logger.verbose("Updating cache entries"),a.populateQueryParams(e,o),this.logger.verbose("Query parameters populated from account"),m=ye.createNavigateUrl(a)+u.response_mode_fragment,t===u.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(De.generateTemporaryCacheKey(h.STATE_ACQ_TOKEN,o.state),a.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+a.state));else{if(t!==u.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),J.createInvalidInteractionTypeError();window.renewStates.push(a.state),window.requestType=r?u.login:u.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+a.state),this.registerCallback(a.state,s,i,n)}if(t!==u.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{c=this.openPopup(m,"msal",u.popUpWidth,u.popUpHeight),Me.trackPopup(c)}catch(e){if(this.logger.info(R.code+":"+R.desc),this.cacheStorage.setItem(f.ERROR,R.code),this.cacheStorage.setItem(f.ERROR_DESC,R.desc),n)return n(J.createPopupWindowError()),[2]}if(!c)return[3,8];w.label=5;case 5:return w.trys.push([5,7,,8]),[4,Me.monitorPopupForHash(c,this.config.system.loadFrameTimeout,m,this.logger)];case 6:return v=w.sent(),this.handleAuthenticationResponse(v),this.cacheStorage.setInteractionInProgress(!1),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",v),Me.closePopups(),[3,8];case 7:return b=w.sent(),n&&n(b),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",b.errorCode+u.resourceDelimiter+b.errorMessage):(this.cacheStorage.setInteractionInProgress(!1),c.close()),[3,8];case 8:return[3,10];case 9:o.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==o.onRedirectNavigate(m)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(m)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(m)),w.label=10;case 10:return[3,12];case 11:return y=w.sent(),this.logger.error(y),this.cacheStorage.resetTempCacheItems(o.state),this.authErrorHandler(t,J.createEndpointResolutionError(y.toString),buildResponseStateOnly(o.state),n),c&&c.close(),[3,12];case 12:return[2]}}))}))},UserAgentApplication.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw ve.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw ve.createSsoSilentError();return this.acquireTokenSilent(__assign$2(__assign$2({},e),{scopes:u.oidcScopes}))},UserAgentApplication.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=Ne.validateRequest(e,!1,this.clientId,u.interactionTypeSilent),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,Xe.AcquireTokenSilent),i=Ne.createRequestSignature(r);return new Promise((function(e,o){return __awaiter$H(t,void 0,void 0,(function(){var t,n,s,a,l,c,d,h,p,f,g;return __generator$2(this,(function(m){switch(m.label){case 0:if(Me.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(n=r.account,this.logger.verbose("Account set from request")):(n=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),s=this.cacheStorage.getItem(u.adalIdToken),!n&&!r.sid&&!r.loginHint&&A.isEmpty(s))return this.logger.info("User login is required"),[2,o(J.createUserLoginRequiredError())];if(a=this.getTokenType(n,r.scopes),this.logger.verbose("Response type: "+a),l=new ke(Ue.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,a,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),ke.isSSOParam(r)||n?(l.populateQueryParams(n,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):n||A.isEmpty(s)?this.logger.verbose("No additional query parameters added"):(c=Ae.extractIdToken(s),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),l.populateQueryParams(n,null,c,!0)),!(d=r.claimsRequest||l.claimsValue)&&!r.forceRefresh)try{p=this.getCachedToken(l,n)}catch(e){h=e}return p?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(p.scopes)),e(p),[2,null]):[3,1];case 1:return h?(this.logger.infoPii(h.errorCode+":"+h.errorMessage),o(h),[2,null]):[3,2];case 2:f=void 0,f=d?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(f),l.authorityInstance||(l.authorityInstance=r.authority?Ue.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+l.authority),m.label=3;case 3:return m.trys.push([3,7,,8]),l.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,Ue.saveMetadataFromNetwork(l.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return m.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),m.label=6;case 6:return window.activeRenewals[i]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[i],i,e,o)):r.scopes&&be.onlyContainsOidcScopes(r.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(i,e,o,n,l)):(this.logger.verbose("Renewing access token"),this.renewToken(i,e,o,n,l)),[3,8];case 7:return g=m.sent(),this.logger.error(g),o(J.createEndpointResolutionError(g.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e}))},UserAgentApplication.prototype.openPopup=function(e,t,r,o){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,n=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=s/2-r/2+i,c=a/2-o/2+n,d=window.open(e,t,"width="+r+", height="+o+", top="+c+", left="+l+", scrollbars=yes");if(!d)throw J.createPopupWindowError();return d.focus&&d.focus(),d}catch(e){throw this.cacheStorage.setInteractionInProgress(!1),J.createPopupWindowError(e.toString())}},UserAgentApplication.prototype.loadIframeTimeout=function(e,t,r){return __awaiter$H(this,void 0,void 0,(function(){var o,i,n,s,a;return __generator$2(this,(function(l){switch(l.label){case 0:return o=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem(De.generateTemporaryCacheKey(h.RENEW_STATUS,o),u.inProgress),this.config.system.navigateFrameWait?[4,Me.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return n=l.sent(),[3,3];case 2:n=Me.loadFrameSync(e,t,this.logger),l.label=3;case 3:i=n,l.label=4;case 4:return l.trys.push([4,6,,7]),[4,Me.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(s=l.sent())&&this.handleAuthenticationResponse(s),[3,7];case 6:throw a=l.sent(),this.cacheStorage.getItem(De.generateTemporaryCacheKey(h.RENEW_STATUS,o))===u.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,a),this.cacheStorage.removeItem(De.generateTemporaryCacheKey(h.RENEW_STATUS,o))),Me.removeHiddenIframe(i),a;case 7:return Me.removeHiddenIframe(i),[2]}}))}))},UserAgentApplication.prototype.navigateWindow=function(e,t){if(!e||A.isEmpty(e))throw this.logger.info("Navigate url is empty"),x.createUnexpectedError("Navigate url is empty");var r=t||window,o=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(o),r.location.assign(e)},UserAgentApplication.prototype.registerCallback=function(e,t,r,o){var i=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:o}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,o){delete window.activeRenewals[t];for(var n=0;n<window.promiseMappedToRenewStates[e].length;++n)try{if(o)window.promiseMappedToRenewStates[e][n].reject(o);else{if(!r)throw i.cacheStorage.resetTempCacheItems(e),x.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][n].resolve(r)}}catch(e){i.logger.warning(e)}delete window.promiseMappedToRenewStates[e],delete window.callbackMappedToRenewStates[e]})},UserAgentApplication.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},UserAgentApplication.prototype.logoutAsync=function(e){return __awaiter$H(this,void 0,void 0,(function(){var t,r,o,i,n,s;return __generator$2(this,(function(a){switch(a.label){case 0:t=e||d.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,Xe.Logout),this.clearCache(),this.account=null,a.label=1;case 1:return a.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,Ue.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return a.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),a.label=4;case 4:return o="client-request-id="+t,i=void 0,this.getPostLogoutRedirectUri()?(i="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(i="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),n=void 0,this.authorityInstance.EndSessionEndpoint?(n=this.authorityInstance.EndSessionEndpoint+"?"+o+i,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(n=this.authority+"oauth2/v2.0/logout?"+o+i,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(n),[3,6];case 5:return s=a.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,s.errorCode),[3,6];case 6:return[2]}}))}))},UserAgentApplication.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(u.clientId,u.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},UserAgentApplication.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(u.clientId,u.homeAccountIdentifier),r=0;r<t.length;r++){var o=t[r];o.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(o.key)),this.logger.verbosePii("Access token removed: "+o.key))}},UserAgentApplication.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),ye.urlContainsHash(e)},UserAgentApplication.prototype.processCallBack=function(e,t,r){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var o,i,n=t;n||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),n=this.getResponseState(e));try{o=this.saveTokenFromHash(e,n)}catch(e){i=e}try{this.cacheStorage.clearMsalCookie(n.state);var s=this.getAccountState(n.state);if(o){if(n.requestType===u.renewToken||o.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+c.ACCESS_TOKEN),o.tokenType=c.ACCESS_TOKEN):n.requestType===u.login&&(this.logger.verbose("Response tokenType set to "+c.ID_TOKEN),o.tokenType=c.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=o)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=buildResponseStateOnly(s),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(n.state);this.logger.verbose("Calling callback provided to processCallback"),r(o,i)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),J.createErrorInCallbackFunction(e.toString())}},UserAgentApplication.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var o=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,o)},UserAgentApplication.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),Me.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(De.generateTemporaryCacheKey(h.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var o=ye.removeHashFromUrl(window.location.href),i=ye.removeHashFromUrl(r);if(o!==i)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+o+", finalRedirectUrl: "+i),void window.location.assign(""+i+e);this.logger.verbose("Current url matches login request url");var n=ye.GetUrlComponents(r);n.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=n.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},UserAgentApplication.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=ye.deserializeHash(e);if(!r)throw x.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(c.STATE))throw x.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var o=Ne.parseLibraryState(r.state);if((t={requestType:u.unknown,state:r.state,timestamp:o.ts,method:o.method,stateMatch:!1}).state===this.cacheStorage.getItem(De.generateTemporaryCacheKey(h.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=u.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(De.generateTemporaryCacheKey(h.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=u.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var i=window.renewStates,n=0;n<i.length;n++)if(i[n]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},UserAgentApplication.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=e.scopes,o=this.getCachedIdToken(e,t),i=this.getCachedAccessToken(e,t,r),n=this.getAccountState(e.state);return $e.buildAuthResponse(o,i,e,t,r,n)},UserAgentApplication.prototype.getTokenCacheItemByAuthority=function(e,t,r,o){var i,n=this;return 1===(i=ye.isCommonAuthority(e)||ye.isOrganizationsAuthority(e)||ye.isConsumersAuthority(e)?Ot.filterTokenCacheItemsByDomain(t,ye.GetUrlComponents(e).HostNameAndPort):Ot.filterTokenCacheItemsByAuthority(t,e)).length?i[0]:i.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),i.forEach((function(e){n.cacheStorage.removeItem(JSON.stringify(e.key))})),null):(this.logger.verbose("No matching tokens of type "+o+" found"),null)},UserAgentApplication.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var r=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),o=e.authority||this.authority,i=this.getTokenCacheItemByAuthority(o,r,null,c.ID_TOKEN);if(i){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(i)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var n=i.value;return n?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),n?new Pe(n.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(i.key)),null}return this.logger.verbose("No tokens found"),null},UserAgentApplication.prototype.getCachedAccessToken=function(e,t,r){this.logger.verbose("Getting all cached tokens of type Access Token");var o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),i=Ot.filterTokenCacheItemsByScope(o,r),n=e.authority||this.authority,s=this.getTokenCacheItemByAuthority(n,i,r,c.ACCESS_TOKEN);if(s){if(e.authorityInstance=Ue.CreateInstance(s.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(s)){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var a=t||this.getAccount();if(!a)throw x.createUnexpectedError("Account should not be null here.");var l=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:c.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:s.value.accessToken,scopes:s.key.scopes.split(" "),expiresOn:new Date(1e3*Number(s.value.expiresIn)),account:a,accountState:l,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(s.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},UserAgentApplication.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return Ae.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},UserAgentApplication.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(u.adalIdToken);return A.isEmpty(e)?null:Ae.extractIdToken(e)},UserAgentApplication.prototype.renewToken=function(e,t,r,o,i){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var n=Me.generateFrameName(S,e);Me.addHiddenIFrame(n,this.logger),this.updateCacheEntries(i,o,!1),this.logger.verbosePii("RenewToken expected state: "+i.state);var s=ye.urlRemoveQueryStringParameter(ye.createNavigateUrl(i),u.prompt)+u.prompt_none+u.response_mode_fragment;window.renewStates.push(i.state),window.requestType=u.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(i.state,e,t,r),this.logger.infoPii("Navigate to: "+s),this.loadIframeTimeout(s,n,e).catch((function(e){return r(e)}))},UserAgentApplication.prototype.renewIdToken=function(e,t,r,o,i){this.logger.info("RenewIdToken has been called");var n=Me.generateFrameName(_,e);Me.addHiddenIFrame(n,this.logger),this.updateCacheEntries(i,o,!1),this.logger.verbose("RenewIdToken expected state: "+i.state);var s=ye.urlRemoveQueryStringParameter(ye.createNavigateUrl(i),u.prompt)+u.prompt_none+u.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=u.login,this.silentAuthenticationState=i.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=u.renewToken,window.renewStates.push(i.state)),this.registerCallback(i.state,e,t,r),this.logger.infoPii('Navigate to:" '+s),this.loadIframeTimeout(s,n,e).catch((function(e){return r(e)}))},UserAgentApplication.prototype.saveToken=function(e,t,r,o,i){var n=new we(t,this.clientId,r,o.uid,o.utid),s=new Ce(e.accessToken,e.idToken.rawIdToken,i.toString(),o.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(n),JSON.stringify(s)),i?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*i)):this.logger.error("Could not parse expiresIn parameter for access token"),e},UserAgentApplication.prototype.saveIdToken=function(e,t,r,o,i){this.logger.verbose("SaveIdToken has been called");var n=__assign$2({},e);n.scopes=u.oidcScopes,n.accessToken=r[c.ID_TOKEN];var s=Number(i.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(n,t,undefined,o,s)},UserAgentApplication.prototype.saveAccessToken=function(e,t,r,o){this.logger.verbose("SaveAccessToken has been called");var i=__assign$2({},e),n=r[c.SCOPE],s=n.split(" "),a=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var l=0;l<a.length;l++){var d=a[l];if(d.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var u=d.key.scopes.split(" ");be.isIntersectingScopes(u,s)&&this.cacheStorage.removeItem(JSON.stringify(d.key))}}i.accessToken=r[c.ACCESS_TOKEN],i.scopes=s;var h=xe.parseExpiresIn(r[c.EXPIRES_IN]),p=Ne.parseLibraryState(r[c.STATE]).ts+h;return this.logger.verbose("Saving access token to cache"),this.saveToken(i,t,n,o,p)},UserAgentApplication.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,o={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},i=ye.deserializeHash(e),n="",s="",a=null;if(i.hasOwnProperty(c.ERROR_DESCRIPTION)||i.hasOwnProperty(c.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+i[c.ERROR]+"; Error description: "+i[c.ERROR_DESCRIPTION]),this.cacheStorage.setItem(f.ERROR,i[c.ERROR]),this.cacheStorage.setItem(f.ERROR_DESC,i[c.ERROR_DESCRIPTION]),t.requestType===u.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(f.LOGIN_ERROR,i[c.ERROR_DESCRIPTION]+":"+i[c.ERROR]),n=De.generateAuthorityKey(t.state)),t.requestType===u.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),n=De.generateAuthorityKey(t.state);var l=this.getAccount(),d=void 0;l&&!A.isEmpty(l.homeAccountIdentifier)?(d=l.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(d=u.no_account,this.logger.verbose("AccountId is set as no_account")),s=De.generateAcquireTokenAccountKey(d,t.state)}var g=i[c.ERROR],m=i[c.ERROR_DESCRIPTION];r=Ye.isInteractionRequiredError(g)||Ye.isInteractionRequiredError(m)?new Ye(i[c.ERROR],i[c.ERROR_DESCRIPTION]):new Ge(i[c.ERROR],i[c.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),i.hasOwnProperty(c.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(De.generateTemporaryCacheKey(h.SESSION_STATE,t.state),i[c.SESSION_STATE])),o.accountState=this.getAccountState(t.state);var v=void 0;if(i.hasOwnProperty(c.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),o.accessToken=i[c.ACCESS_TOKEN],i.hasOwnProperty(c.SCOPE)&&(o.scopes=i[c.SCOPE].split(" ")),i.hasOwnProperty(c.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),a=new Pe(i[c.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),a=new Pe(this.cacheStorage.getItem(p.IDTOKEN))),o=$e.setResponseIdToken(o,a);var b=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,a);this.logger.verbose("Got authority from cache"),i.hasOwnProperty(c.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),v=new Ie(i[c.CLIENT_INFO],b)):this.authorityInstance.AuthorityType===y.Adfs?v=Ie.createClientInfoFromIdToken(a,b):this.logger.warning("ClientInfo not received in the response from AAD"),o.account=Le.createAccount(a,v),this.logger.verbose("Account object created from response");var w=void 0;o.account&&!A.isEmpty(o.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),w=o.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),w=u.no_account),s=De.generateAcquireTokenAccountKey(w,t.state);var k=De.generateAcquireTokenAccountKey(u.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var T=this.cacheStorage.getItem(s),_=void 0;A.isEmpty(T)?A.isEmpty(this.cacheStorage.getItem(k))||(this.logger.verbose("No acquireToken account retrieved from cache"),o=this.saveAccessToken(o,b,i,v)):(_=JSON.parse(T),this.logger.verbose("AcquireToken request account retrieved from cache"),o.account&&_&&Le.compareAccounts(o.account,_)?(o=this.saveAccessToken(o,b,i,v),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(i.hasOwnProperty(c.ID_TOKEN)){this.logger.info("Fragment has idToken"),a=new Pe(i[c.ID_TOKEN]);b=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,a);if(o=$e.setResponseIdToken(o,a),i.hasOwnProperty(c.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),v=new Ie(i[c.CLIENT_INFO],b)):this.authorityInstance.AuthorityType===y.Adfs?v=Ie.createClientInfoFromIdToken(a,b):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=Le.createAccount(a,v),o.account=this.account,this.logger.verbose("Account object created from response"),a&&a.nonce){this.logger.verbose("IdToken has nonce");var S=this.cacheStorage.getItem(De.generateTemporaryCacheKey(h.NONCE_IDTOKEN,t.state),this.inCookie);a.nonce!==S?(this.account=null,this.cacheStorage.setItem(f.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+S+",Actual Nonce: "+a.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+S+", Actual Nonce: "+a.nonce),r=J.createNonceMismatchError(S,a.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(p.IDTOKEN,i[c.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(p.CLIENT_INFO,v.encodeClientInfo(),this.inCookie),this.saveIdToken(o,b,i,v,a))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),n=t.state,s=t.state,this.logger.error("Invalid id_token received in the response"),r=J.createInvalidIdTokenError(a),this.cacheStorage.setItem(f.ERROR,r.errorCode),this.cacheStorage.setItem(f.ERROR_DESC,r.errorMessage)}}else{this.logger.verbose("State mismatch"),n=t.state,s=t.state;var E=this.cacheStorage.getItem(De.generateTemporaryCacheKey(h.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+E+", Actual State: "+t.state),r=J.createInvalidStateError(t.state,E),this.cacheStorage.setItem(f.ERROR,r.errorCode),this.cacheStorage.setItem(f.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(De.generateTemporaryCacheKey(h.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(n,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!o)throw x.createUnexpectedError("Response is null");return o},UserAgentApplication.prototype.populateAuthority=function(e,t,r,o){this.logger.verbose("PopulateAuthority has been called");var i=De.generateAuthorityKey(e),n=r.getItem(i,t);return A.isEmpty(n)?n:ye.replaceTenantPath(n,o.tenantId)},UserAgentApplication.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(p.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(p.CLIENT_INFO,this.inCookie);if(!A.isEmpty(e)&&!A.isEmpty(t)){var r=new Pe(e),o=new Ie(t,"");return this.account=Le.createAccount(r,o),this.account}return null},UserAgentApplication.prototype.getAccountState=function(e){if(e){var t=e.indexOf(u.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},UserAgentApplication.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(u.clientId,u.homeAccountIdentifier),r=0;r<t.length;r++){var o=new Pe(t[r].value.idToken),i=new Ie(t[r].value.homeAccountIdentifier,""),n=Le.createAccount(o,i);e.push(n)}return this.getUniqueAccounts(e)},UserAgentApplication.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],o=0;o<e.length;++o)e[o].homeAccountIdentifier&&-1===t.indexOf(e[o].homeAccountIdentifier)&&(t.push(e[o].homeAccountIdentifier),r.push(e[o]));return r},UserAgentApplication.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},UserAgentApplication.prototype.getCachedTokenInternal=function(e,t,r,o){var i=t||this.getAccount();if(!i)return null;var n=this.authorityInstance?this.authorityInstance:Ue.CreateInstance(this.authority,this.config.auth.validateAuthority),s=this.getTokenType(i,e),a=new ke(n,this.clientId,s,this.getRedirectUri(),e,r,o);return this.getCachedToken(a,t)},UserAgentApplication.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,o=Array.from(this.config.framework.protectedResourceMap.keys());r<o.length;r++){var i=o[r];if(e.indexOf(i)>-1)return this.config.framework.protectedResourceMap.get(i)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?ye.getHostFromUri(e)===ye.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},UserAgentApplication.prototype.getLoginInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},UserAgentApplication.prototype.setInteractionInProgress=function(e){this.cacheStorage.setInteractionInProgress(e)},UserAgentApplication.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},UserAgentApplication.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},UserAgentApplication.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},UserAgentApplication.prototype.getLogger=function(){return this.logger},UserAgentApplication.prototype.setLogger=function(e){this.logger=e},UserAgentApplication.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},UserAgentApplication.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},UserAgentApplication.prototype.getCurrentConfiguration=function(){if(!this.config)throw ve.createNoSetConfigurationError();return this.config},UserAgentApplication.prototype.getTokenType=function(e,t){var r=Le.compareAccounts(e,this.getAccount());return ke.determineResponseType(r,t)},UserAgentApplication.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):u.no_account,o=De.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(o,JSON.stringify(e))},UserAgentApplication.prototype.setAuthorityCache=function(e,t){var r=De.generateAuthorityKey(e);this.cacheStorage.setItem(r,ye.CanonicalizeUri(t),this.inCookie)},UserAgentApplication.prototype.updateCacheEntries=function(e,t,r,o){o&&this.cacheStorage.setItem(De.generateTemporaryCacheKey(h.LOGIN_REQUEST,e.state),o,this.inCookie),r?this.cacheStorage.setItem(De.generateTemporaryCacheKey(h.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(De.generateTemporaryCacheKey(h.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},UserAgentApplication.prototype.getAccountId=function(e){return A.isEmpty(e.homeAccountIdentifier)?u.no_account:e.homeAccountIdentifier},UserAgentApplication.prototype.buildIDTokenRequest=function(e){return{scopes:u.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},UserAgentApplication.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return Rt.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,o=e.applicationVersion,i=e.telemetryEmitter;if(!r||!o||!i)throw ve.createTelemetryConfigError(e);return new Rt({platform:{applicationName:r,applicationVersion:o},clientId:t},i,this.logger)},UserAgentApplication}();function prepScopes(...e){const t={scopes:e};return Providers.globalProvider.isIncrementalConsentDisabled?[]:[new AuthenticationHandlerOptions(void 0,t)]}function chainMiddleware(...e){const t=e[0];let r=t;for(let t=1;t<e.length;++t){const o=e[t];r.setNext&&r.setNext(o),r=o}return t}var __awaiter$G=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class BatchRequest{constructor(e,t,r,o){"/"!==r.charAt(0)&&(r="/"+r),this.resource=r,this.method=o,this.index=e,this.id=t}}class Batch{constructor(e){this.graph=e,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(e,t,r,o){const i=this.nextIndex++,n=new BatchRequest(i,e,t,"GET");n.headers=o,this.allRequests.push(n),this.requestsQueue.push(i),r&&(this.scopes=this.scopes.concat(r))}executeNext(){return __awaiter$G(this,void 0,void 0,(function*(){const e=new Map;if(this.retryAfter&&(yield function delay(e){return new Promise((t=>{setTimeout(t,e)}))}(1e3*this.retryAfter),this.retryAfter=0),!this.hasRequests)return e;const t=this.requestsQueue.splice(0,20),r=new BatchRequestContent;for(const e of t.map((e=>this.allRequests[e])))r.addRequest({id:e.index.toString(),request:new Request(Batch.baseUrl+e.resource,{method:e.method,headers:e.headers})});const o=this.scopes.length?prepScopes(...this.scopes):[],i=this.graph.api("$batch").middlewareOptions(o),n=yield r.getContent(),s=yield i.post(n);for(const t of s.responses){const r=new BatchResponse,o=this.allRequests[t.id];r.id=o.id,r.index=o.index,r.headers=t.headers,200===t.status?(t.headers["Content-Type"].includes("image/jpeg")?r.content="data:image/jpeg;base64,"+t.body:t.headers["Content-Type"].includes("image/pjpeg")?r.content="data:image/pjpeg;base64,"+t.body:t.headers["Content-Type"].includes("image/png")?r.content="data:image/png;base64,"+t.body:r.content=t.body,e.set(o.id,r)):429===t.status&&(this.requestsQueue.unshift(t.id),this.retryAfter=Math.max(this.retryAfter,parseInt(t.headers["Retry-After"],10)||1))}return e}))}executeAll(){return __awaiter$G(this,void 0,void 0,(function*(){const e=new Map;for(;this.hasRequests;){const t=yield this.executeNext();for(const[r,o]of t)e.set(r,o)}return e}))}}Batch.baseUrl="https://graph.microsoft.com";class ComponentMiddlewareOptions{constructor(e){this.componentName="string"==typeof e?e:e.tagName.toLowerCase()}}var __awaiter$F=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class SdkVersionMiddleware{constructor(e,t){this._packageVersion=e,this._providerName=t}execute(e){return __awaiter$F(this,void 0,void 0,(function*(){try{const t=[],r=e.middlewareControl.getMiddlewareOptions(ComponentMiddlewareOptions);if(r){const e=`${r.componentName}/${this._packageVersion}`;t.push(e)}if(this._providerName){const e=`${this._providerName}/${this._packageVersion}`;t.push(e)}const o=`mgt/${this._packageVersion}`;t.push(o),t.push(getRequestHeader(e.request,e.options,"SdkVersion"));const i=t.join(", ");setRequestHeader(e.request,e.options,"SdkVersion",i)}catch(e){}return yield this._nextMiddleware.execute(e)}))}setNext(e){this._nextMiddleware=e}}class Graph{constructor(e,t="v1.0"){this._client=e,this._version=t}get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}forComponent(e){const t=new Graph(this._client,this._version);return t.setComponent(e),t}api(e){let t=this._client.api(e).version(this._version);return this._componentName&&(t.middlewareOptions=e=>{const r=t;return r._middlewareOptions=r._middlewareOptions.concat(e),t},t=t.middlewareOptions([new ComponentMiddlewareOptions(this._componentName)])),t}createBatch(){return new Batch(this)}setComponent(e){this._componentName=e instanceof Element?e.tagName:e}}function createFromProvider(e,t,r){const o=[new AuthenticationHandler(e),new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new SdkVersionMiddleware("2.5.3",e.name),new HTTPMessageHandler],i=Client.initWithMiddleware({middleware:chainMiddleware(...o)}),n=new Graph(i,t);return r?n.forComponent(r):n}class BetaGraph extends Graph{static fromGraph(e){const t=new BetaGraph(e.client);return t.setComponent(e.componentName),t}constructor(e,t="beta"){super(e,t)}forComponent(e){const t=new BetaGraph(this.client);return this.setComponent(e),t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Dt="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,removeNodes=(e,t,r=null)=>{for(;t!==r;){const r=t.nextSibling;e.removeChild(t),t=r}},Lt=`{{lit-${String(Math.random()).slice(2)}}}`,Mt=`\x3c!--${Lt}--\x3e`,$t=new RegExp(`${Lt}|${Mt}`);class Template{constructor(e,t){this.parts=[],this.element=t;const r=[],o=[],i=document.createTreeWalker(t.content,133,null,!1);let n=0,s=-1,a=0;const{strings:l,values:{length:c}}=e;for(;a<c;){const e=i.nextNode();if(null!==e){if(s++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:r}=t;let o=0;for(let e=0;e<r;e++)endsWith(t[e].name,"$lit$")&&o++;for(;o-- >0;){const t=l[a],r=Ut.exec(t)[2],o=r.toLowerCase()+"$lit$",i=e.getAttribute(o);e.removeAttribute(o);const n=i.split($t);this.parts.push({type:"attribute",index:s,name:r,strings:n}),a+=n.length-1}}"TEMPLATE"===e.tagName&&(o.push(e),i.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(Lt)>=0){const o=e.parentNode,i=t.split($t),n=i.length-1;for(let t=0;t<n;t++){let r,n=i[t];if(""===n)r=createMarker();else{const e=Ut.exec(n);null!==e&&endsWith(e[2],"$lit$")&&(n=n.slice(0,e.index)+e[1]+e[2].slice(0,-"$lit$".length)+e[3]),r=document.createTextNode(n)}o.insertBefore(r,e),this.parts.push({type:"node",index:++s})}""===i[n]?(o.insertBefore(createMarker(),e),r.push(e)):e.data=i[n],a+=n}}else if(8===e.nodeType)if(e.data===Lt){const t=e.parentNode;null!==e.previousSibling&&s!==n||(s++,t.insertBefore(createMarker(),e)),n=s,this.parts.push({type:"node",index:s}),null===e.nextSibling?e.data="":(r.push(e),s--),a++}else{let t=-1;for(;-1!==(t=e.data.indexOf(Lt,t+1));)this.parts.push({type:"node",index:-1}),a++}}else i.currentNode=o.pop()}for(const e of r)e.parentNode.removeChild(e)}}const endsWith=(e,t)=>{const r=e.length-t.length;return r>=0&&e.slice(r)===t},isTemplatePartActive=e=>-1!==e.index,createMarker=()=>document.createComment(""),Ut=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function removeNodesFromTemplate(e,t){const{element:{content:r},parts:o}=e,i=document.createTreeWalker(r,133,null,!1);let n=nextActiveIndexInTemplateParts(o),s=o[n],a=-1,l=0;const c=[];let d=null;for(;i.nextNode();){a++;const e=i.currentNode;for(e.previousSibling===d&&(d=null),t.has(e)&&(c.push(e),null===d&&(d=e)),null!==d&&l++;void 0!==s&&s.index===a;)s.index=null!==d?-1:s.index-l,n=nextActiveIndexInTemplateParts(o,n),s=o[n]}c.forEach((e=>e.parentNode.removeChild(e)))}const countNodes=e=>{let t=11===e.nodeType?0:1;const r=document.createTreeWalker(e,133,null,!1);for(;r.nextNode();)t++;return t},nextActiveIndexInTemplateParts=(e,t=-1)=>{for(let r=t+1;r<e.length;r++){const t=e[r];if(isTemplatePartActive(t))return r}return-1};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Ft=new WeakMap,directive=e=>(...t)=>{const r=e(...t);return Ft.set(r,!0),r},isDirective=e=>"function"==typeof e&&Ft.has(e),Ht={},Bt={};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class TemplateInstance{constructor(e,t,r){this.__parts=[],this.template=e,this.processor=t,this.options=r}update(e){let t=0;for(const r of this.__parts)void 0!==r&&r.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=Dt?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],r=this.template.parts,o=document.createTreeWalker(e,133,null,!1);let i,n=0,s=0,a=o.nextNode();for(;n<r.length;)if(i=r[n],isTemplatePartActive(i)){for(;s<i.index;)s++,"TEMPLATE"===a.nodeName&&(t.push(a),o.currentNode=a.content),null===(a=o.nextNode())&&(o.currentNode=t.pop(),a=o.nextNode());if("node"===i.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(a.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(a,i.name,i.strings,this.options));n++}else this.__parts.push(void 0),n++;return Dt&&(document.adoptNode(e),customElements.upgrade(e)),e}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const qt=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),zt=` ${Lt} `;class TemplateResult{constructor(e,t,r,o){this.strings=e,this.values=t,this.type=r,this.processor=o}getHTML(){const e=this.strings.length-1;let t="",r=!1;for(let o=0;o<e;o++){const e=this.strings[o],i=e.lastIndexOf("\x3c!--");r=(i>-1||r)&&-1===e.indexOf("--\x3e",i+1);const n=Ut.exec(e);t+=null===n?e+(r?zt:Mt):e.substr(0,n.index)+n[1]+n[2]+"$lit$"+n[3]+Lt}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==qt&&(t=qt.createHTML(t)),e.innerHTML=t,e}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const isPrimitive=e=>null===e||!("object"==typeof e||"function"==typeof e),isIterable=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class AttributeCommitter{constructor(e,t,r){this.dirty=!0,this.element=e,this.name=t,this.strings=r,this.parts=[];for(let e=0;e<r.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new AttributePart(this)}_getValue(){const e=this.strings,t=e.length-1,r=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=r[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!isIterable(e))return e}let o="";for(let i=0;i<t;i++){o+=e[i];const t=r[i];if(void 0!==t){const e=t.value;if(isPrimitive(e)||!isIterable(e))o+="string"==typeof e?e:String(e);else for(const t of e)o+="string"==typeof t?t:String(t)}}return o+=e[t],o}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class AttributePart{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===Ht||isPrimitive(e)&&e===this.value||(this.value=e,isDirective(e)||(this.committer.dirty=!0))}commit(){for(;isDirective(this.value);){const e=this.value;this.value=Ht,e(this)}this.value!==Ht&&this.committer.commit()}}class NodePart{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(createMarker()),this.endNode=e.appendChild(createMarker())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=createMarker()),e.__insert(this.endNode=createMarker())}insertAfterPart(e){e.__insert(this.startNode=createMarker()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;isDirective(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Ht,e(this)}const e=this.__pendingValue;e!==Ht&&(isPrimitive(e)?e!==this.value&&this.__commitText(e):e instanceof TemplateResult?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):isIterable(e)?this.__commitIterable(e):e===Bt?(this.value=Bt,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,r="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=r:this.__commitNode(document.createTextNode(r)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof TemplateInstance&&this.value.template===t)this.value.update(e.values);else{const r=new TemplateInstance(t,e.processor,this.options),o=r._clone();r.update(e.values),this.__commitNode(o),this.value=r}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let r,o=0;for(const i of e)r=t[o],void 0===r&&(r=new NodePart(this.options),t.push(r),0===o?r.appendIntoPart(this):r.insertAfterPart(t[o-1])),r.setValue(i),r.commit(),o++;o<t.length&&(t.length=o,this.clear(r&&r.endNode))}clear(e=this.startNode){removeNodes(this.startNode.parentNode,e.nextSibling,this.endNode)}}class BooleanAttributePart{constructor(e,t,r){if(this.value=void 0,this.__pendingValue=void 0,2!==r.length||""!==r[0]||""!==r[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=r}setValue(e){this.__pendingValue=e}commit(){for(;isDirective(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Ht,e(this)}if(this.__pendingValue===Ht)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=Ht}}class PropertyCommitter extends AttributeCommitter{constructor(e,t,r){super(e,t,r),this.single=2===r.length&&""===r[0]&&""===r[1]}_createPart(){return new PropertyPart(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class PropertyPart extends AttributePart{}let jt=!1;(()=>{try{const e={get capture(){return jt=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class EventPart{constructor(e,t,r){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=r,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;isDirective(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Ht,e(this)}if(this.__pendingValue===Ht)return;const e=this.__pendingValue,t=this.value,r=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),o=null!=e&&(null==t||r);r&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),o&&(this.__options=getOptions(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=Ht}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const getOptions=e=>e&&(jt?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;function templateFactory(e){let t=Vt.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},Vt.set(e.type,t));let r=t.stringsArray.get(e.strings);if(void 0!==r)return r;const o=e.strings.join(Lt);return r=t.keyString.get(o),void 0===r&&(r=new Template(e,e.getTemplateElement()),t.keyString.set(o,r)),t.stringsArray.set(e.strings,r),r}const Vt=new Map,Gt=new WeakMap;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Kt=new
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class DefaultTemplateProcessor{handleAttributeExpressions(e,t,r,o){const i=t[0];if("."===i){return new PropertyCommitter(e,t.slice(1),r).parts}if("@"===i)return[new EventPart(e,t.slice(1),o.eventContext)];if("?"===i)return[new BooleanAttributePart(e,t.slice(1),r)];return new AttributeCommitter(e,t,r).parts}handleTextExpression(e){return new NodePart(e)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const html$1=(e,...t)=>new TemplateResult(e,t,"html",Kt)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */,getTemplateCacheKey=(e,t)=>`${e}--${t}`;let Wt=!0;void 0===window.ShadyCSS?Wt=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),Wt=!1);const shadyTemplateFactory=e=>t=>{const r=getTemplateCacheKey(t.type,e);let o=Vt.get(r);void 0===o&&(o={stringsArray:new WeakMap,keyString:new Map},Vt.set(r,o));let i=o.stringsArray.get(t.strings);if(void 0!==i)return i;const n=t.strings.join(Lt);if(i=o.keyString.get(n),void 0===i){const r=t.getTemplateElement();Wt&&window.ShadyCSS.prepareTemplateDom(r,e),i=new Template(t,r),o.keyString.set(n,i)}return o.stringsArray.set(t.strings,i),i},Qt=["html","svg"],Yt=new Set,prepareTemplateStyles=(e,t,r)=>{Yt.add(e);const o=r?r.element:document.createElement("template"),i=t.querySelectorAll("style"),{length:n}=i;if(0===n)return void window.ShadyCSS.prepareTemplateStyles(o,e);const s=document.createElement("style");for(let e=0;e<n;e++){const t=i[e];t.parentNode.removeChild(t),s.textContent+=t.textContent}(e=>{Qt.forEach((t=>{const r=Vt.get(getTemplateCacheKey(t,e));void 0!==r&&r.keyString.forEach((e=>{const{element:{content:t}}=e,r=new Set;Array.from(t.querySelectorAll("style")).forEach((e=>{r.add(e)})),removeNodesFromTemplate(e,r)}))}))})(e);const a=o.content;r?function insertNodeIntoTemplate(e,t,r=null){const{element:{content:o},parts:i}=e;if(null==r)return void o.appendChild(t);const n=document.createTreeWalker(o,133,null,!1);let s=nextActiveIndexInTemplateParts(i),a=0,l=-1;for(;n.nextNode();)for(l++,n.currentNode===r&&(a=countNodes(t),r.parentNode.insertBefore(t,r));-1!==s&&i[s].index===l;){if(a>0){for(;-1!==s;)i[s].index+=a,s=nextActiveIndexInTemplateParts(i,s);return}s=nextActiveIndexInTemplateParts(i,s)}}(r,s,a.firstChild):a.insertBefore(s,a.firstChild),window.ShadyCSS.prepareTemplateStyles(o,e);const l=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)t.insertBefore(l.cloneNode(!0),t.firstChild);else if(r){a.insertBefore(s,a.firstChild);const e=new Set;e.add(s),removeNodesFromTemplate(r,e)}};window.JSCompiler_renameProperty=(e,t)=>e;const Jt={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},notEqual=(e,t)=>t!==e&&(t==t||e==e),Zt={attribute:!0,type:String,converter:Jt,reflect:!1,hasChanged:notEqual};class UpdatingElement extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach(((t,r)=>{const o=this._attributeNameForProperty(r,t);void 0!==o&&(this._attributeToPropertyMap.set(o,r),e.push(o))})),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach(((e,t)=>this._classProperties.set(t,e)))}}static createProperty(e,t=Zt){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const r="symbol"==typeof e?Symbol():`__${e}`,o=this.getPropertyDescriptor(e,r,t);void 0!==o&&Object.defineProperty(this.prototype,e,o)}static getPropertyDescriptor(e,t,r){return{get(){return this[t]},set(o){const i=this[e];this[t]=o,this.requestUpdateInternal(e,i,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||Zt}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const r of t)this.createProperty(r,e[r])}}static _attributeNameForProperty(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,r=notEqual){return r(e,t)}static _propertyValueFromAttribute(e,t){const r=t.type,o=t.converter||Jt,i="function"==typeof o?o:o.fromAttribute;return i?i(e,r):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const r=t.type,o=t.converter;return(o&&o.toAttribute||Jt.toAttribute)(e,r)}initialize(){this._updateState=0,this._updatePromise=new Promise((e=>this._enableUpdatingResolver=e)),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach(((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}}))}_applyInstanceProperties(){this._instanceProperties.forEach(((e,t)=>this[t]=e)),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,r){t!==r&&this._attributeToProperty(e,r)}_propertyToAttribute(e,t,r=Zt){const o=this.constructor,i=o._attributeNameForProperty(e,r);if(void 0!==i){const e=o._propertyValueToAttribute(t,r);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(i):this.setAttribute(i,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const r=this.constructor,o=r._attributeToPropertyMap.get(e);if(void 0!==o){const e=r.getPropertyOptions(o);this._updateState=16|this._updateState,this[o]=r._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}requestUpdateInternal(e,t,r){let o=!0;if(void 0!==e){const i=this.constructor;r=r||i.getPropertyOptions(e),i._valueHasChanged(this[e],t,r.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==r.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,r))):o=!1}!this._hasRequestedUpdate&&o&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(((e,t)=>this._propertyToAttribute(t,this[t],e))),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}UpdatingElement.finalized=!0;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const standardProperty$1=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher(r){r.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(r){r.createProperty(t.key,e)}};function property$1(e){return(t,r)=>void 0!==r?((e,t,r)=>{t.constructor.createProperty(r,e)})(e,t,r):standardProperty$1(e,t)}
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const Xt=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,er=Symbol();class CSSResult$1{constructor(e,t){if(t!==er)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(Xt?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const tr={};class LitElement extends UpdatingElement{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const addStyles=(e,t)=>e.reduceRight(((e,t)=>Array.isArray(t)?addStyles(t,e):(e.add(t),e)),t),t=addStyles(e,new Set),r=[];t.forEach((e=>r.unshift(e))),this._styles=r}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map((e=>{if(e instanceof CSSStyleSheet&&!Xt){const t=Array.prototype.slice.call(e.cssRules).reduce(((e,t)=>e+t.cssText),"");return new CSSResult$1(String(t),er)}return e}))}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Xt?this.renderRoot.adoptedStyleSheets=e.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map((e=>e.cssText)),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==tr&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach((e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)})))}render(){return tr}}LitElement.finalized=!0,LitElement.render=(e,t,r)=>{if(!r||"object"!=typeof r||!r.scopeName)throw new Error("The `scopeName` option is required.");const o=r.scopeName,i=Gt.has(t),n=Wt&&11===t.nodeType&&!!t.host,s=n&&!Yt.has(o),a=s?document.createDocumentFragment():t;if(((e,t,r)=>{let o=Gt.get(t);void 0===o&&(removeNodes(t,t.firstChild),Gt.set(t,o=new NodePart(Object.assign({templateFactory:templateFactory},r))),o.appendInto(t)),o.setValue(e),o.commit()})(e,a,Object.assign({templateFactory:shadyTemplateFactory(o)},r)),s){const e=Gt.get(a);Gt.delete(a);const r=e.value instanceof TemplateInstance?e.value.template:void 0;prepareTemplateStyles(o,a,r),removeNodes(t,t.firstChild),t.appendChild(a),Gt.set(t,e)}!i&&n&&window.ShadyCSS.styleElement(t.host)},LitElement.shadowRootOptions={mode:"open"};class EventDispatcher{constructor(){this.eventHandlers=[]}fire(e){for(const t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}class IProvider{constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new EventDispatcher,this._activeAccountChangedDispatcher=new EventDispatcher,this._isIncrementalConsentDisabled=!1,this._state=or.Loading}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(e){this._isIncrementalConsentDisabled=e}get name(){return"MgtIProvider"}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}setActiveAccount(e){this.fireActiveAccountChanged()}onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}removeActiveAccountChangedHandler(e){this._activeAccountChangedDispatcher.remove(e)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...e){return this.getAccessToken({scopes:e})}}var rr,or;!function(e){e[e.Popup=0]="Popup",e[e.Redirect=1]="Redirect"}(rr||(rr={})),function(e){e[e.Loading=0]="Loading",e[e.SignedOut=1]="SignedOut",e[e.SignedIn=2]="SignedIn"}(or||(or={}));var ir,__awaiter$E=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class Providers{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(ir.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}static removeActiveAccountChangedListener(e){this._activeAccountChangedDispatcher.remove(e)}static me(){return __awaiter$E(this,void 0,void 0,(function*(){if(!this._me){const e=this.client;if(e)try{const t=yield e.api("me").get();t&&t.id&&(this._me=t)}catch(e){}}return this._me}))}static get client(){return Providers.globalProvider&&Providers.globalProvider.state===or.SignedIn?Providers.globalProvider.graph.client:null}static handleProviderStateChanged(){Providers.globalProvider&&Providers.globalProvider.state===or.SignedIn||(Providers._me=null),Providers._eventDispatcher.fire(ir.ProviderStateChanged)}static handleActiveAccountChanged(){Providers._activeAccountChangedDispatcher.fire(null)}}Providers._eventDispatcher=new EventDispatcher,Providers._activeAccountChangedDispatcher=new EventDispatcher,function(e){e[e.ProviderChanged=0]="ProviderChanged",e[e.ProviderStateChanged=1]="ProviderStateChanged"}(ir||(ir={}));class LocalizationHelper{static get strings(){return this._strings}static set strings(e){this._strings=e,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){return document.body.getAttribute("dir")||document.documentElement.getAttribute("dir")}static onStringsUpdated(e){this._stringsEventDispatcher.add(e)}static removeOnStringsUpdated(e){this._stringsEventDispatcher.remove(e)}static onDirectionUpdated(e){this._directionEventDispatcher.add(e),this.initDirection()}static removeOnDirectionUpdated(e){this._directionEventDispatcher.remove(e)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver((e=>{e.forEach((e=>{"dir"==e.attributeName&&this._directionEventDispatcher.fire(null)}))}));const e={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,e),this.mutationObserver.observe(document.documentElement,e)}static updateStringsForTag(e,t){if((e=e.toLowerCase()).startsWith("mgt-")&&(e=e.substring(4)),this._strings&&t){for(let e of Object.entries(t))this._strings[e[0]]&&(t[e[0]]=this._strings[e[0]]);if(this._strings._components&&this._strings._components[e]){let r=this._strings._components[e];for(let e of Object.keys(r))t[e]&&(t[e]=r[e])}}return t}}LocalizationHelper._stringsEventDispatcher=new EventDispatcher,LocalizationHelper._directionEventDispatcher=new EventDispatcher,LocalizationHelper._isDirectionInit=!1;var nr,__decorate$w=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$v=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$D=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};!function(e){e.mobile="",e.tablet="tablet",e.desktop="desktop"}(nr||(nr={}));class MgtBaseComponent extends LitElement{constructor(){super(),this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.handleLocalizationChanged=this.handleLocalizationChanged.bind(this),this.handleDirectionChanged=this.handleDirectionChanged.bind(this),this.handleProviderUpdates=this.handleProviderUpdates.bind(this),this.handleActiveAccountUpdates=this.handleActiveAccountUpdates.bind(this),this.handleDirectionChanged(),this.handleLocalizationChanged()}get mediaQuery(){return this.offsetWidth<768?nr.mobile:this.offsetWidth<1200?nr.tablet:nr.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}connectedCallback(){super.connectedCallback(),LocalizationHelper.onStringsUpdated(this.handleLocalizationChanged),LocalizationHelper.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),LocalizationHelper.removeOnStringsUpdated(this.handleLocalizationChanged),LocalizationHelper.removeOnDirectionUpdated(this.handleDirectionChanged),Providers.removeProviderUpdatedListener(this.handleProviderUpdates),Providers.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(e){super.firstUpdated(e),this._isFirstUpdated=!0,Providers.onProviderUpdated(this.handleProviderUpdates),Providers.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(e,t,r=!1,o=!1){const i=new CustomEvent(e,{bubbles:r,cancelable:o,detail:t});return this.dispatchEvent(i)}updated(e){super.updated(e);const t=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(t)}requestStateUpdate(e=!1){return __awaiter$D(this,void 0,void 0,(function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!e&&(yield this._currentLoadStatePromise);const t=Providers.globalProvider;if(!t)return Promise.resolve();if(t.state!==or.SignedOut){if(t.state===or.Loading)return Promise.resolve();{const t=new Promise(((r,o)=>__awaiter$D(this,void 0,void 0,(function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),r()}catch(e){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),o(e)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&e?this._currentLoadStatePromise.then((()=>t)):t}))))}}else this.clearState()}))}setLoadingState(e){this._isLoadingState!==e&&(this._isLoadingState=e,this.requestUpdate("isLoadingState"))}handleProviderUpdates(){this.requestStateUpdate()}handleActiveAccountUpdates(){return __awaiter$D(this,void 0,void 0,(function*(){this.clearState(),this.requestStateUpdate()}))}handleLocalizationChanged(){LocalizationHelper.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()}handleDirectionChanged(){this.direction=LocalizationHelper.getDocumentDirection()}}__decorate$w([function internalProperty$1(e){return property$1({attribute:!1,hasChanged:null==e?void 0:e.hasChanged})}(),__metadata$v("design:type",Object)],MgtBaseComponent.prototype,"direction",void 0);var __decorate$v=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$u=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class MgtBaseProvider extends MgtBaseComponent{get provider(){return this._provider}set provider(e){this._provider&&this.provider.removeStateChangedHandler((()=>this.stateChangedHandler)),this._provider=e,this._provider&&this.provider.onStateChanged((()=>this.stateChangedHandler))}get isAvailable(){return!0}firstUpdated(e){super.firstUpdated(e);let t=!1;if(this.dependsOn){let e=this.dependsOn;for(;e;){if(e.isAvailable){t=!0;break}e=e.dependsOn}}!t&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}stateChangedHandler(){this.fireCustomEvent("onStateChanged",this.provider.state)}}function equals(e,t){return equalsInternal(e,t,new Set)}function equalsInternal(e,t,r){const o=Object.prototype.toString.call(e),i=Object.prototype.toString.call(t);if(o===i&&"[object Object]"===o&&!r.has(e)){r.add(e);for(const o in e)if(!equalsInternal(e[o],t[o],r))return!1;for(const r in t)if(!e.hasOwnProperty(r))return!1;return!0}if(o===i&&"[object Array]"===o&&!r.has(e)){if(r.add(e),e.length!==t.length)return!1;for(let o=0;o<e.length;o++)if(!equalsInternal(e[o],t[o],r))return!1;return!0}return e===t}function arraysAreEqual(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;if(0===e.length)return!0;const r=new Set(e);for(const e of t)if(!r.has(e))return!1;return!0}__decorate$v([property$1({attribute:"depends-on",converter:e=>document.querySelector(e),type:String}),__metadata$u("design:type",MgtBaseProvider)],MgtBaseProvider.prototype,"dependsOn",void 0);class TemplateHelper{static renderTemplate(e,t,r){let o;if(t.$parentTemplateContext&&(r=Object.assign(Object.assign({},r),{$parent:t.$parentTemplateContext})),t.content&&t.content.childNodes.length){const i=t.content.cloneNode(!0);o=this.renderNode(i,e,r)}else if(t.childNodes.length){const i=document.createElement("div");for(let e=0;e<t.childNodes.length;e++)i.appendChild(this.simpleCloneNode(t.childNodes[e]));o=this.renderNode(i,e,r)}o&&e.appendChild(o)}static setBindingSyntax(e,t){this._startExpression=e,this._endExpression=t;const r=this.escapeRegex(this._startExpression),o=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${r}\\s*([$\\w\\.,'"\\s()\\[\\]]+)\\s*${o}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(e){if(!e)return null;const t=e.cloneNode(!1);for(let r=0;r<e.childNodes.length;r++){const o=this.simpleCloneNode(e.childNodes[r]);o&&t.appendChild(o)}return t}static expandExpressionsAsString(e,t){return e.replace(this.expression,((e,r)=>{const o=this.evalInContext(r||this.trimExpression(e),t);return o?"object"==typeof o?JSON.stringify(o):o.toString():""}))}static renderNode(e,t,r){if("#text"===e.nodeName)return e.textContent=this.expandExpressionsAsString(e.textContent,r),e;if("TEMPLATE"===e.nodeName)return e.$parentTemplateContext=r,e;let o=e;if(o.attributes)for(let e=0;e<o.attributes.length;e++){const i=o.attributes[e];if("data-props"===i.name){const e=this.trimExpression(i.value);for(const i of e.split(",")){const e=i.trim().split(":");if(2===e.length){const i=e[0].trim(),n=this.evalInContext(e[1].trim(),r);i.startsWith("@")?"function"==typeof n&&o.addEventListener(i.substring(1),(e=>n(e,r,t))):o[i]=n}}}else o.setAttribute(i.name,this.expandExpressionsAsString(i.value,r))}const i=[],n=[];let s=!1;for(let o=0;o<e.childNodes.length;o++){const a=e.childNodes[o],l=a;let c=!1;if(l.dataset){let e=!1;if(l.dataset.if){const t=l.dataset.if;this.evalBoolInContext(this.trimExpression(t),r)?(l.removeAttribute("data-if"),s=!0,c=!0):(n.push(l),e=!0)}else void 0!==l.dataset.else&&(s?(n.push(l),e=!0):l.removeAttribute("data-else"));l.dataset.for&&!e?i.push(l):e||this.renderNode(a,t,r)}else this.renderNode(a,t,r);c||"#text"===a.nodeName||(s=!1)}for(const e of n)o.removeChild(e);for(let e=0;e<i.length;e++){const n=i[e],s=n.dataset.for,a=this.trimExpression(s).split(/\s(in|of)\s/i);if(3===a.length){const e=a[0].trim(),i=a[2].trim(),s=this.evalInContext(i,r);if(Array.isArray(s)){n.removeAttribute("data-for");for(let i=0;i<s.length;i++){const a=Object.assign({$index:i},r);a[e]=s[i];const l=n.cloneNode(!0);this.renderNode(l,t,a),o.insertBefore(l,n)}}o.removeChild(n)}}return e}static evalBoolInContext(e,t){return t=Object.assign(Object.assign({},t),this.globalContext),new Function("with(this) { return !!("+e+")}").call(t)}static evalInContext(e,t){t=Object.assign(Object.assign({},t),this.globalContext);const r=new Function("with(this) { return "+e+";}");let o;try{o=r.call(t)}catch(e){}return o}static trimExpression(e){return(e=e.trim()).startsWith(this._startExpression)&&e.endsWith(this._endExpression)&&(e=(e=e.substr(this._startExpression.length,e.length-this._startExpression.length-this._endExpression.length)).trim()),e}}TemplateHelper._globalContext={};var __decorate$u=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$t=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class MgtTemplatedComponent extends MgtBaseComponent{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,r){if(!this.hasTemplate(e))return null;r=r||e,this._slotNamesAddedDuringRender.push(r),this._renderedSlots=!0;const o=html$1`
      <slot name=${r}></slot>
    `,i=Object.assign(Object.assign({},t),this.templateContext);if(this._renderedTemplates.hasOwnProperty(r)){const{context:e,slot:t}=this._renderedTemplates[r];if(equals(e,i))return o;this.removeChild(t)}const n=document.createElement("div");return n.slot=r,n.dataset.generated="template",TemplateHelper.renderTemplate(n,this.templates[e],i),this.appendChild(n),this._renderedTemplates[r]={context:i,slot:n},this.fireCustomEvent("templateRendered",{templateType:e,context:i,element:n}),o}hasTemplate(e){return this.templates&&this.templates[e]}getTemplates(){const e={};for(let t=0;t<this.children.length;t++){const r=this.children[t];if("TEMPLATE"===r.nodeName){const o=r;o.dataset.type?e[o.dataset.type]=o:e.default=o,o.templateOrder=t}}return e}removeUnusedSlottedElements(){if(this._renderedSlots){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.dataset&&t.dataset.generated&&!this._slotNamesAddedDuringRender.includes(t.slot)&&(this.removeChild(t),delete this._renderedTemplates[t.slot],e--)}this._renderedSlots=!1}}}__decorate$u([property$1({attribute:!1}),__metadata$t("design:type",Object)],MgtTemplatedComponent.prototype,"templateContext",void 0);class SimpleProvider extends IProvider{constructor(e,t,r){super(),this._getAccessTokenHandler=e,this._loginHandler=t,this._logoutHandler=r,this.graph=createFromProvider(this)}get name(){return"MgtSimpleProvider"}getAccessToken(e){return this._getAccessTokenHandler(null==e?void 0:e.scopes)}login(){return this._loginHandler()}logout(){return this._logoutHandler()}}let sr,ar;const lr=new WeakMap,cr=new WeakMap,dr=new WeakMap,ur=new WeakMap,hr=new WeakMap;let pr={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return cr.get(e);if("objectStoreNames"===t)return e.objectStoreNames||dr.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return wrap(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function wrapFunction(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function getCursorAdvanceMethods(){return ar||(ar=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(e)?function(...t){return e.apply(unwrap(this),t),wrap(lr.get(this))}:function(...t){return wrap(e.apply(unwrap(this),t))}:function(t,...r){const o=e.call(unwrap(this),t,...r);return dr.set(o,t.sort?t.sort():[t]),wrap(o)}}function transformCachableValue(e){return"function"==typeof e?wrapFunction(e):(e instanceof IDBTransaction&&function cacheDonePromiseForTransaction(e){if(cr.has(e))return;const t=new Promise(((t,r)=>{const unlisten=()=>{e.removeEventListener("complete",complete),e.removeEventListener("error",error),e.removeEventListener("abort",error)},complete=()=>{t(),unlisten()},error=()=>{r(e.error||new DOMException("AbortError","AbortError")),unlisten()};e.addEventListener("complete",complete),e.addEventListener("error",error),e.addEventListener("abort",error)}));cr.set(e,t)}(e),t=e,function getIdbProxyableTypes(){return sr||(sr=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}().some((e=>t instanceof e))?new Proxy(e,pr):e);var t}function wrap(e){if(e instanceof IDBRequest)return function promisifyRequest(e){const t=new Promise(((t,r)=>{const unlisten=()=>{e.removeEventListener("success",success),e.removeEventListener("error",error)},success=()=>{t(wrap(e.result)),unlisten()},error=()=>{r(e.error),unlisten()};e.addEventListener("success",success),e.addEventListener("error",error)}));return t.then((t=>{t instanceof IDBCursor&&lr.set(t,e)})).catch((()=>{})),hr.set(t,e),t}(e);if(ur.has(e))return ur.get(e);const t=transformCachableValue(e);return t!==e&&(ur.set(e,t),hr.set(t,e)),t}const unwrap=e=>hr.get(e);const fr=["get","getKey","getAll","getAllKeys","count"],gr=["put","add","delete","clear"],mr=new Map;function getMethod(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(mr.get(t))return mr.get(t);const r=t.replace(/FromIndex$/,""),o=t!==r,i=gr.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!i&&!fr.includes(r))return;const method=async function(e,...t){const n=this.transaction(e,i?"readwrite":"readonly");let s=n.store;return o&&(s=s.index(t.shift())),(await Promise.all([s[r](...t),i&&n.done]))[0]};return mr.set(t,method),method}!function replaceTraps(e){pr=e(pr)}((e=>({...e,get:(t,r,o)=>getMethod(t,r)||e.get(t,r,o),has:(t,r)=>!!getMethod(t,r)||e.has(t,r)})));var __awaiter$C=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class CacheService{static getCache(e,t){const r=`${e.name}/${t}`;return this.isInitialized||this.init(),this.cacheStore.has(t)||this.cacheStore.set(r,new CacheStore(e,t)),this.cacheStore.get(r)}static clearCaches(){this.cacheStore.forEach((e=>indexedDB.deleteDatabase(e.getDBName())))}static get config(){return this.cacheConfig}static init(){let e;Providers.globalProvider&&(e=Providers.globalProvider.state),Providers.onProviderUpdated((()=>{e===or.SignedIn&&Providers.globalProvider.state===or.SignedOut&&this.clearCaches(),e=Providers.globalProvider.state})),this.isInitialized=!0}}CacheService.cacheStore=new Map,CacheService.isInitialized=!1,CacheService.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}};class CacheStore{constructor(e,t){if(!(t in e.stores))throw Error('"store" must be defined in the "schema"');this.schema=e,this.store=t}getValue(e){return __awaiter$C(this,void 0,void 0,(function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,e)}catch(e){return null}}))}putValue(e,t){return __awaiter$C(this,void 0,void 0,(function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},t),{timeCached:Date.now()}),e)}catch(e){return}}))}clearStore(){return __awaiter$C(this,void 0,void 0,(function*(){if(window.indexedDB)try{(yield this.getDb()).clear(this.store)}catch(e){return}}))}getDBName(){return`mgt-${this.schema.name}`}getDb(){return function openDB(e,t,{blocked:r,upgrade:o,blocking:i,terminated:n}={}){const s=indexedDB.open(e,t),a=wrap(s);return o&&s.addEventListener("upgradeneeded",(e=>{o(wrap(s.result),e.oldVersion,e.newVersion,wrap(s.transaction))})),r&&s.addEventListener("blocked",(()=>r())),a.then((e=>{n&&e.addEventListener("close",(()=>n())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}(this.getDBName(),this.schema.version,{upgrade:(e,t,r,o)=>{for(const t in this.schema.stores)this.schema.stores.hasOwnProperty(t)&&(e.objectStoreNames.contains(t)||e.createObjectStore(t))}})}}class TeamsHelper{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(e){this._microsoftTeamsLib=e}static get isAvailable(){return!!this.microsoftTeamsLib&&(!(window.parent!==window.self||!window.nativeInterface)||("embedded-page-container"===window.name||"extension-tab-frame"===window.name))}static executeDeepLink(e,t){const r=this.microsoftTeamsLib;r.initialize(),r.executeDeepLink(e,t)}}var __awaiter$B=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class GraphPageIterator{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(e,t,r){return __awaiter$B(this,void 0,void 0,(function*(){const o=yield t.get();if(o&&o.value){const t=new GraphPageIterator;return t._graph=e,t._value=o.value,t._nextLink=o["@odata.nextLink"],t._version=r||e.version,t}return null}))}static createFromValue(e,t,r){let o=new GraphPageIterator;return o._graph=e,o._value=t,o._nextLink=r||null,o._version=e.version,o||null}next(){return __awaiter$B(this,void 0,void 0,(function*(){if(this._nextLink){const e=this._nextLink.split(this._version)[1],t=yield this._graph.api(e).version(this._version).get();if(t&&t.value&&t.value.length)return this._value=this._value.concat(t.value),this._nextLink=t["@odata.nextLink"],t.value}return null}))}}var __awaiter$A=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class MockGraph extends Graph{constructor(e){const t=[new AuthenticationHandler(e),new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new MockMiddleware,new HTTPMessageHandler];super(Client.initWithMiddleware({middleware:chainMiddleware(...t)}))}forComponent(e){return this}}class MockMiddleware{execute(e){return __awaiter$A(this,void 0,void 0,(function*(){try{const t=yield MockMiddleware.getBaseUrl();e.request=t+escape(e.request)}catch(e){}return yield this._nextMiddleware.execute(e)}))}setNext(e){this._nextMiddleware=e}static getBaseUrl(){return __awaiter$A(this,void 0,void 0,(function*(){if(!this._baseUrl)try{let e=yield fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint");this._baseUrl=(yield e.json())+"?url="}catch(e){this._baseUrl="https://proxy.apisandbox.msdn.microsoft.com/svc?url="}return this._baseUrl}))}}var __awaiter$z=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class MockProvider extends IProvider{constructor(e=!1){super(),this.graph=new MockGraph(this),e?this.setState(or.SignedIn):this.setState(or.SignedOut)}login(){return __awaiter$z(this,void 0,void 0,(function*(){this.setState(or.Loading),yield new Promise((e=>setTimeout(e,3e3))),this.setState(or.SignedIn)}))}logout(){return __awaiter$z(this,void 0,void 0,(function*(){this.setState(or.Loading),yield new Promise((e=>setTimeout(e,3e3))),this.setState(or.SignedOut)}))}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}}var __decorate$t=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let vr=class MgtMockProvider extends MgtBaseProvider{initializeProvider(){Providers.globalProvider=new MockProvider(!this.signedOut)}};var br;__decorate$t([property$1({attribute:"signed-out",type:Boolean}),__metadata$s("design:type",Object)],vr.prototype,"signedOut",void 0),vr=__decorate$t([(br="mgt-mock-provider",e=>"function"==typeof e?((e,t)=>(window.customElements.define(e,t),t))(br,e):((e,t)=>{const{kind:r,elements:o}=t;return{kind:r,elements:o,finisher(t){window.customElements.define(e,t)}}})(br,e))],vr),
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
window.JSCompiler_renameProperty=(e,t)=>e
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;const customElement=e=>t=>"function"==typeof t?((e,t)=>(window.customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:r,elements:o}=t;return{kind:r,elements:o,finisher(t){window.customElements.define(e,t)}}})(e,t),standardProperty=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher(r){r.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(r){r.createProperty(t.key,e)}};function property(e){return(t,r)=>void 0!==r?((e,t,r)=>{t.constructor.createProperty(r,e)})(e,t,r):standardProperty(e,t)}function internalProperty(e){return property({attribute:!1,hasChanged:null==e?void 0:e.hasChanged})}
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/const yr=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,wr=Symbol();class CSSResult{constructor(e,t){if(t!==wr)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(yr?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const css$1=(e,...t)=>{const r=t.reduce(((t,r,o)=>t+(e=>{if(e instanceof CSSResult)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(r)+e[o+1]),e[0]);return new CSSResult(r,wr)};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.5.0");const Cr=[css$1`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--selected-person-background-color:#f0f0f0}.mgt-dark{--selected-person-background-color:#4f4f4f}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}
`],kr=document.createElement("style");kr.type="text/css",kr.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");;\n}\n")),document.head.appendChild(kr);const Tr=document.createElement("style");function getRelativeDisplayDate(e){const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=r)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});const o=new Date(r);if(o.setDate(t.getDate()-t.getDay()),e>=o)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});const i=new Date(o);return i.setDate(o.getDate()-7),e>=i?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})}function getShortDateString(e){const t=e.getMonth(),r=e.getDate();return`${getMonthString(t)} ${r}`}function getMonthString(e){switch(e){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}}function debounce(e,t){let r;return function(){const functionCall=()=>e.apply(this,arguments);clearTimeout(r),r=setTimeout(functionCall,t)}}function blobToBase64(e){return new Promise(((t,r)=>{const o=new FileReader;o.onerror=r,o.onload=e=>{t(o.result)},o.readAsDataURL(e)}))}function extractEmailAddress(e){return e.startsWith("[")?e.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():e}function isValidEmail(e){return/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/.test(e)}function formatBytes(e,t=2){if(0===e)return"0 Bytes";const r=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(r))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]}
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */Tr.innerHTML=Cr.toString(),document.head.appendChild(Tr);class ClassList{constructor(e){this.classes=new Set,this.changed=!1,this.element=e;const t=(e.getAttribute("class")||"").split(/\s+/);for(const e of t)this.classes.add(e)}add(e){this.classes.add(e),this.changed=!0}remove(e){this.classes.delete(e),this.changed=!0}commit(){if(this.changed){let e="";this.classes.forEach((t=>e+=t+" ")),this.element.setAttribute("class",e)}}}const _r=new WeakMap,Sr=directive((e=>t=>{if(!(t instanceof AttributePart)||t instanceof PropertyPart||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:r}=t,{element:o}=r;let i=_r.get(t);void 0===i&&(o.setAttribute("class",r.strings.join(" ")),_r.set(t,i=new Set));const n=o.classList||new ClassList(o);i.forEach((t=>{t in e||(n.remove(t),i.delete(t))}));for(const t in e){const r=e[t];r!=i.has(t)&&(r?(n.add(t),i.add(t)):(n.remove(t),i.delete(t)))}"function"==typeof n.commit&&n.commit()})),Er={name:"presence",stores:{presence:"presence"},version:1},Ir={name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters"},version:2},xr={name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups"},version:1},Ar={name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:2},Pr={name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:3},Rr={name:"responses",stores:{responses:"responses"},version:1},Or={name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:1},Nr={name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:1};var Dr,Lr,__awaiter$y=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};!function(e){e[e.any=0]="any",e.person="person",e.group="group"}(Dr||(Dr={})),function(e){e.any="any",e.user="user",e.contact="contact"}(Lr||(Lr={}));const getPeopleInvalidationTime=()=>CacheService.config.people.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPeopleCacheEnabled=()=>CacheService.config.people.isEnabled&&CacheService.config.isEnabled;function findPeople(e,t,r=10,o=Lr.any,i=""){return __awaiter$y(this,void 0,void 0,(function*(){let n,s=`${t}:${r}:${o}`;if(getIsPeopleCacheEnabled()){n=CacheService.getCache(Ar,Ar.stores.peopleQuery);const e=getIsPeopleCacheEnabled()?yield n.getValue(s):null;if(e&&getPeopleInvalidationTime()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}let a,l="personType/class eq 'Person'";o!==Lr.any&&(o===Lr.user?l+="and personType/subclass eq 'OrganizationUser'":l+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),""!==i&&(l=`${l} and ${i}`);try{if(a=yield e.api("/me/people").search('"'+t+'"').top(r).filter(l).middlewareOptions(prepScopes("people.read")).get(),getIsPeopleCacheEnabled()&&a){const e={maxResults:r,results:null};e.results=a.value.map((e=>JSON.stringify(e))),n.putValue(s,e)}}catch(e){}return a?a.value:null}))}function getPeople(e,t=Lr.any,r=""){return __awaiter$y(this,void 0,void 0,(function*(){let o,i=r||`*:${t}`;if(getIsPeopleCacheEnabled()){o=CacheService.getCache(Ar,Ar.stores.peopleQuery);const e=yield o.getValue(i);if(e&&getPeopleInvalidationTime()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}let n,s="personType/class eq 'Person'";t!==Lr.any&&(t===Lr.user?s+="and personType/subclass eq 'OrganizationUser'":s+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),r&&(s+=` and ${r}`);try{n=yield e.api("/me/people").middlewareOptions(prepScopes("people.read")).filter(s).get(),getIsPeopleCacheEnabled()&&n&&o.putValue(i,{maxResults:10,results:n.value.map((e=>JSON.stringify(e)))})}catch(e){}return n?n.value:null}))}function getEmailFromGraphEntity(e){const t=e,r=e,o=e;return r.mail?extractEmailAddress(r.mail):t.scoredEmailAddresses&&t.scoredEmailAddresses.length?extractEmailAddress(t.scoredEmailAddresses[0].address):o.emailAddresses&&o.emailAddresses.length?extractEmailAddress(o.emailAddresses[0].address):null}function findContactsByEmail(e,t){return __awaiter$y(this,void 0,void 0,(function*(){let r;if(getIsPeopleCacheEnabled()){r=CacheService.getCache(Ar,Ar.stores.contacts);const e=yield r.getValue(t);if(e&&getPeopleInvalidationTime()>Date.now()-e.timeCached)return JSON.parse(e.person)}let o=`${t.replace(/#/g,"%2523")}`;const i=yield e.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${o}')`).middlewareOptions(prepScopes("contacts.read")).get();return getIsPeopleCacheEnabled()&&i&&r.putValue(t,{person:JSON.stringify(i.value)}),i?i.value:null}))}var __awaiter$x=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};const getUserInvalidationTime=()=>CacheService.config.users.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsUsersCacheEnabled=()=>CacheService.config.users.isEnabled&&CacheService.config.isEnabled;function getMe(e,t){return __awaiter$x(this,void 0,void 0,(function*(){let r;if(getIsUsersCacheEnabled()){r=CacheService.getCache(Ir,Ir.stores.users);const e=yield r.getValue("me");if(e&&getUserInvalidationTime()>Date.now()-e.timeCached){const r=JSON.parse(e.user),o=t?t.filter((e=>!Object.keys(r).includes(e))):null;if(!o||o.length<=1)return r}}let o="me";t&&(o=o+"?$select="+t.toString());const i=e.api(o).middlewareOptions(prepScopes("user.read")).get();return getIsUsersCacheEnabled()&&r.putValue("me",{user:JSON.stringify(yield i)}),i}))}function getUser(e,t,r){return __awaiter$x(this,void 0,void 0,(function*(){let o;if(getIsUsersCacheEnabled()){o=CacheService.getCache(Ir,Ir.stores.users);const e=yield o.getValue(t);if(e&&getUserInvalidationTime()>Date.now()-e.timeCached){const t=e.user?JSON.parse(e.user):null,o=r&&t?r.filter((e=>!Object.keys(t).includes(e))):null;if(!o||o.length<=1)return t}}let i,n=`/users/${t}`;r&&(n=n+"?$select="+r.toString());try{i=yield e.api(n).middlewareOptions(prepScopes("user.readbasic.all")).get()}catch(e){}return getIsUsersCacheEnabled()&&o.putValue(t,{user:JSON.stringify(i)}),i}))}function getUsersForUserIds(e,t,r="",o=""){return __awaiter$x(this,void 0,void 0,(function*(){if(!t||0===t.length)return[];const i=e.createBatch(),n={},s={},a=[];let l;r=r.toLowerCase(),getIsUsersCacheEnabled()&&(l=CacheService.getCache(Ir,Ir.stores.users));for(const c of t){n[c]=null;let t=null;if(getIsUsersCacheEnabled()&&(t=yield l.getValue(c)),t&&getUserInvalidationTime()>Date.now()-t.timeCached){t=JSON.parse(null==t?void 0:t.user);const e=t.displayName;if(r){!!(e&&e.toLowerCase().includes(r))&&(s[c]=t||null)}else n[c]=t||null}else if(""!==c)if("me"===c.toString())n[c]=yield getMe(e);else{let e=`/users/${c}`;o&&(e+=`${e}?$filter=${o}`),i.get(c,e,["user.readbasic.all"]),a.push(c)}}try{const e=yield i.executeAll();for(const o of t){const t=e.get(o);if(t&&t.content){const e=t.content;if(r){(null==e?void 0:e.displayName.toLowerCase()).contains(r)&&(s[o]=e)}else n[o]=e;getIsUsersCacheEnabled()&&l.putValue(o,{user:JSON.stringify(e)})}}return r&&Object.keys(s).length?Promise.all(Object.values(s)):Promise.all(Object.values(n))}catch(r){try{return t.filter((e=>a.includes(e))).forEach((t=>n[t]=getUser(e,t))),getIsUsersCacheEnabled()&&t.filter((e=>a.includes(e))).forEach((e=>__awaiter$x(this,void 0,void 0,(function*(){return l.putValue(e,{user:JSON.stringify(yield n[e])})})))),Promise.all(Object.values(n))}catch(e){return[]}}}))}function findUsers(e,t,r=10,o=""){return __awaiter$x(this,void 0,void 0,(function*(){const i={maxResults:r,results:null};let n;if(getIsUsersCacheEnabled()){n=CacheService.getCache(Ir,Ir.stores.usersQuery);const e=yield n.getValue(t);if(e&&getUserInvalidationTime()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}let s,a=`${t.replace(/#/g,"%2523")}`,l=e.api("users").header("ConsistencyLevel","eventual").count(!0).search(`"displayName:${a}" OR "mail:${a}"`);""!==o&&l.filter(o);try{s=yield l.top(r).middlewareOptions(prepScopes("User.ReadBasic.All")).get()}catch(e){}return getIsUsersCacheEnabled()&&s&&(i.results=s.value.map((e=>JSON.stringify(e))),n.putValue(t,i)),s?s.value:null}))}function findGroupMembers(e,t,r,o=10,i=Dr.person,n=!1,s=""){return __awaiter$x(this,void 0,void 0,(function*(){const a={maxResults:o,results:null};let l;const c=`${r||"*"}:${t||"*"}:${i}:${n}`;if(getIsUsersCacheEnabled()){l=CacheService.getCache(Ir,Ir.stores.usersQuery);const e=yield l.getValue(c);if(e&&getUserInvalidationTime()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}let d="";t&&(d=`startswith(displayName,'${t}') or startswith(givenName,'${t}') or startswith(surname,'${t}') or startswith(mail,'${t}') or startswith(userPrincipalName,'${t}')`);let u=`/groups/${r}/${n?"transitiveMembers":"members"}`;i===Dr.person?u+="/microsoft.graph.user":i===Dr.group&&(u+="/microsoft.graph.group",t&&(d=`startswith(displayName,'${t}') or startswith(mail,'${t}')`)),s&&(d+=` and ${s}`);const h=yield e.api(u).count(!0).top(o).filter(d).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes("user.read.all","people.read")).get();return getIsUsersCacheEnabled()&&h&&(a.results=h.value.map((e=>JSON.stringify(e))),l.putValue(c,a)),h?h.value:null}))}var __awaiter$w=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};const getPhotoInvalidationTime=()=>CacheService.config.photos.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPhotosCacheEnabled=()=>CacheService.config.photos.isEnabled&&CacheService.config.isEnabled;function getPhotoForResource(e,t,r){return __awaiter$w(this,void 0,void 0,(function*(){try{const o=yield e.api(`${t}/photo/$value`).responseType(n.RAW).middlewareOptions(prepScopes(...r)).get();if(404===o.status)return{eTag:null,photo:null};if(!o.ok)return null;const i=o.headers.get("eTag");return{eTag:i,photo:yield blobToBase64(yield o.blob())}}catch(e){return null}}))}function getContactPhoto(e,t){return __awaiter$w(this,void 0,void 0,(function*(){let r,o;return getIsPhotosCacheEnabled()&&(r=CacheService.getCache(xr,xr.stores.contacts),o=yield r.getValue(t),o&&getPhotoInvalidationTime()>Date.now()-o.timeCached)?o.photo:(o=yield getPhotoForResource(e,`me/contacts/${t}`,["contacts.read"]),getIsPhotosCacheEnabled()&&o&&r.putValue(t,o),o?o.photo:null)}))}function getUserPhoto(e,t){return __awaiter$w(this,void 0,void 0,(function*(){let r,o;if(getIsPhotosCacheEnabled()){if(r=CacheService.getCache(xr,xr.stores.users),o=yield r.getValue(t),o&&getPhotoInvalidationTime()>Date.now()-o.timeCached)return o.photo;if(o)try{const r=yield e.api(`users/${t}/photo`).get();r&&(r["@odata.mediaEtag"]!==o.eTag||null===r["@odata.mediaEtag"]&&null===r.eTag)&&(o=null)}catch(e){return null}}return o=o||(yield getPhotoForResource(e,`users/${t}`,["user.readbasic.all"])),getIsPhotosCacheEnabled()&&o&&r.putValue(t,o),o?o.photo:null}))}function getPersonImage(e,t,r=!0){return __awaiter$w(this,void 0,void 0,(function*(){if("personType"in t&&"OrganizationUser"!==t.personType.subclass){if("PersonalContact"===t.personType.subclass&&r){const r=getEmailFromGraphEntity(t),o=yield findContactsByEmail(e,r);if(o&&o.length&&o[0].id)return yield getContactPhoto(e,o[0].id)}return null}if(t.userPrincipalName||t.id){const r=t.userPrincipalName||t.id;return yield getUserPhoto(e,r)}if(t.id){const r=yield getUserPhoto(e,t.id);if(r)return r}const o=getEmailFromGraphEntity(t);if(o){const t=yield findUsers(e,o,1);if(t&&t.length)return yield getUserPhoto(e,t[0].id);if(r){const t=yield findContactsByEmail(e,o);if(t&&t.length)return yield getContactPhoto(e,t[0].id)}}return null}))}function storePhotoInCache(e,t,r){return __awaiter$w(this,void 0,void 0,(function*(){CacheService.getCache(xr,t).putValue(e,r)}))}var __awaiter$v=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};const getPresenceInvalidationTime=()=>CacheService.config.presence.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPresenceCacheEnabled=()=>CacheService.config.presence.isEnabled&&CacheService.config.isEnabled;function getUserPresence(e,t){return __awaiter$v(this,void 0,void 0,(function*(){let r;if(getIsPresenceCacheEnabled()){r=CacheService.getCache(Er,Er.stores.presence);const e=yield r.getValue(t||"me");if(e&&getPresenceInvalidationTime()>Date.now()-e.timeCached)return JSON.parse(e.presence)}const o=t?["presence.read.all"]:["presence.read"],i=t?`/users/${t}/presence`:"/me/presence",n=yield e.api(i).middlewareOptions(prepScopes(...o)).get();return getIsPresenceCacheEnabled()&&r.putValue(t||"me",{presence:JSON.stringify(n)}),n}))}var Mr,$r,__awaiter$u=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};function getUserWithPhoto(e,t,r){return __awaiter$u(this,void 0,void 0,(function*(){let o,i,n=null,s=null;const a=t?`users/${t}`:"me";let l=a+(r?`?$select=${r.toString()}`:"");const c=t?["user.readbasic.all"]:["user.read"];if(getIsUsersCacheEnabled()){const e=CacheService.getCache(Ir,Ir.stores.users);if(i=yield e.getValue(t||"me"),void 0!==i&&getUserInvalidationTime()>Date.now()-i.timeCached){if(s=i.user?JSON.parse(i.user):null,null!==s&&r){r.filter((e=>!Object.keys(s).includes(e))).length>=1&&(s=null,i=null)}}else i=null}if(getIsPhotosCacheEnabled())if(o=yield function getPhotoFromCache(e,t){return __awaiter$w(this,void 0,void 0,(function*(){const r=CacheService.getCache(xr,t);return yield r.getValue(e)}))}(t||"me",xr.stores.users),void 0!==o&&getPhotoInvalidationTime()>Date.now()-o.timeCached)n=o.photo;else if(o)try{const r=yield e.api(`${a}/photo`).get();r&&r["@odata.mediaEtag"]&&r["@odata.mediaEtag"]===o.eTag?(storePhotoInCache(t||"me",xr.stores.users,o),n=o.photo):o=null}catch(e){"ErrorItemNotFound"===e.code&&storePhotoInCache(t||"me",xr.stores.users,{eTag:null,photo:null})}if(o||i)if(o){if(!i)try{const r=yield e.api(l).middlewareOptions(prepScopes(...c)).get();if(r){if(getIsUsersCacheEnabled()){CacheService.getCache(Ir,Ir.stores.users).putValue(t||"me",{user:JSON.stringify(r)})}s=r}}catch(e){}}else try{const r=yield getPhotoForResource(e,a,c);r&&(getIsPhotosCacheEnabled()&&storePhotoInCache(t||"me",xr.stores.users,{eTag:r.eTag,photo:r.photo}),n=r.photo)}catch(e){}else{let o;const i=e.createBatch();t?(i.get("user",`/users/${t}${r?"?$select="+r.toString():""}`,["user.readbasic.all"]),i.get("photo",`users/${t}/photo/$value`,["user.readbasic.all"])):(i.get("user","me",["user.read"]),i.get("photo","me/photo/$value",["user.read"]));const a=yield i.executeAll(),l=a.get("photo");l&&(o=l.headers.ETag,n=l.content);const c=a.get("user");if(c&&(s=c.content),getIsUsersCacheEnabled()){CacheService.getCache(Ir,Ir.stores.users).putValue(t||"me",{user:JSON.stringify(s)})}getIsPhotosCacheEnabled()&&storePhotoInCache(t||"me",xr.stores.users,{eTag:o,photo:n})}return s&&(s.personImage=n),s}))}function getSvg(e,t){switch(e){case $r.ArrowRight:return html$1`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 7L4.46481 10.5359L4.46481 7L4.46481 3.46413L8 7Z" />
        </svg>
      `;case $r.ArrowDown:return html$1`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case $r.TeamSeparator:return html$1`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${t}
          />
        </svg>
      `;case $r.Search:return html$1`
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0)">
            <circle cx="5.36377" cy="5.36396" r="4" transform="rotate(45 5.36377 5.36396)" stroke="#B3B0AD" />
            <path
              d="M8.19189 7.48529L12.7881 12.0815C12.9834 12.2767 12.9834 12.5933 12.7881 12.7886V12.7886C12.5928 12.9839 12.2762 12.9839 12.081 12.7886L7.48479 8.1924L8.19189 7.48529Z"
              fill="#B3B0AD"
            />
          </g>
          <defs>
            <clipPath id="clip0">
              <rect width="14" height="14" fill="white" />
            </clipPath>
          </defs>
        </svg>
      `;case $r.SkypeArrow:return html$1`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case $r.SmallEmail:return html$1`
        <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.165 0C15.5458 0 16.665 1.11929 16.665 2.5V10.5C16.665 11.8807 15.5458 13 14.165 13H3.16504C1.78433 13 0.665039 11.8807 0.665039 10.5V2.5C0.665039 1.11929 1.78433 0 3.16504 0H14.165ZM15.665 3.961L8.91855 7.93097C8.78815 8.00767 8.63165 8.02045 8.49255 7.96932L8.41153 7.93097L1.66504 3.963V10.5C1.66504 11.3284 2.33661 12 3.16504 12H14.165C14.9935 12 15.665 11.3284 15.665 10.5V3.961ZM14.165 1H3.16504C2.33661 1 1.66504 1.67157 1.66504 2.5V2.802L8.66504 6.91991L15.665 2.801V2.5C15.665 1.67157 14.9935 1 14.165 1Z" fill="#023B8F"/>
        </svg>
      `;case $r.SmallChat:return html$1`
        <svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.94299 0C13.3613 0 16.943 3.58172 16.943 8C16.943 12.4183 13.3613 16 8.94299 16C7.66978 16 6.4389 15.7018 5.32968 15.1393L5.20899 15.075L1.56408 15.9851C1.25426 16.0625 0.969217 15.8369 0.944303 15.5438L0.944134 15.4624L0.957926 15.3787L1.86799 11.735L1.80468 11.6153C1.3496 10.7186 1.06732 9.74223 0.97574 8.72826L0.950369 8.34634L0.942993 8C0.942993 3.58172 4.52471 0 8.94299 0ZM8.94299 1C5.077 1 1.94299 4.13401 1.94299 8C1.94299 9.21704 2.25354 10.3878 2.83652 11.4249C2.88346 11.5084 2.9051 11.603 2.89991 11.6973L2.88573 11.7912L2.12999 14.812L5.15403 14.0583C5.21593 14.0429 5.27961 14.0396 5.34172 14.0479L5.4333 14.0691L5.52 14.1075C6.55661 14.6898 7.72669 15 8.94299 15C12.809 15 15.943 11.866 15.943 8C15.943 4.13401 12.809 1 8.94299 1ZM9.44299 9C9.71914 9 9.94299 9.22386 9.94299 9.5C9.94299 9.74546 9.76612 9.94961 9.53287 9.99194L9.44299 10H6.44299C6.16685 10 5.94299 9.77614 5.94299 9.5C5.94299 9.25454 6.11987 9.05039 6.35312 9.00806L6.44299 9H9.44299ZM11.443 6C11.7191 6 11.943 6.22386 11.943 6.5C11.943 6.74546 11.7661 6.94961 11.5329 6.99194L11.443 7L6.44299 7C6.16685 7 5.94299 6.77614 5.94299 6.5C5.94299 6.25454 6.11987 6.05039 6.35312 6.00806L6.44299 6L11.443 6Z" fill="#023B8F"/>
        </svg>
      `;case $r.Video:return html$1`
        <svg width="17" height="12" viewBox="0 0 17 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.72095 0C1.34024 0 0.220947 1.11929 0.220947 2.5V9.5C0.220947 10.8807 1.34024 12 2.72095 12H9.72095C11.1017 12 12.2209 10.8807 12.2209 9.5V8.49998L14.6209 10.3C15.2802 10.7944 16.2209 10.324 16.2209 9.49998V2.49998C16.2209 1.67594 15.2802 1.20556 14.6209 1.69998L12.2209 3.49998V2.5C12.2209 1.11929 11.1017 0 9.72095 0H2.72095ZM12.2209 4.74998L15.2209 2.49998V9.49998L12.2209 7.24998V4.74998ZM11.2209 2.5V9.5C11.2209 10.3284 10.5494 11 9.72095 11H2.72095C1.89252 11 1.22095 10.3284 1.22095 9.5V2.5C1.22095 1.67157 1.89252 1 2.72095 1H9.72095C10.5494 1 11.2209 1.67157 11.2209 2.5Z" fill="#023B8F"/>
        </svg>
      `;case $r.Phone:return html$1`
        <svg width="13" height="17" viewBox="0 0 13 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.48621 1.06583L2.76951 1.28186C1.46598 1.67478 0.508589 2.78795 0.315123 4.13559C0.0181492 6.20432 0.68238 8.62236 2.28283 11.3944C3.87991 14.1606 5.63781 15.9432 7.57304 16.723C8.84263 17.2346 10.2939 16.9591 11.2878 16.0179L11.8306 15.5039C12.5581 14.8149 12.6635 13.694 12.0772 12.8815L10.7206 11.0013C10.345 10.4807 9.67962 10.2568 9.06566 10.4445L7.01495 11.0715L6.96194 11.0819C6.73578 11.1149 6.21455 10.6259 5.56441 9.4998C4.88427 8.32175 4.74331 7.63292 4.93109 7.45535L5.97444 6.48242C6.75637 5.75326 6.98739 4.60722 6.54901 3.63206L5.88756 2.16069C5.47566 1.24445 4.44803 0.775914 3.48621 1.06583ZM4.97548 2.57071L5.63694 4.04209C5.89977 4.62676 5.76126 5.31388 5.29244 5.75107L4.24654 6.72639C3.57744 7.35912 3.79906 8.44212 4.69839 9.9998C5.5446 11.4655 6.31659 12.1898 7.14609 12.0642L7.27042 12.0376L9.35803 11.4008C9.56268 11.3383 9.78446 11.4129 9.90968 11.5864L11.2663 13.4666C11.5594 13.8728 11.5067 14.4333 11.143 14.7778L10.6002 15.2918C9.89029 15.9641 8.85363 16.1609 7.94678 15.7955C6.24871 15.1112 4.6439 13.4839 3.14886 10.8944C1.65075 8.29963 1.04445 6.09248 1.30498 4.27769C1.44317 3.31509 2.12702 2.51997 3.05811 2.23931L3.77481 2.02328C4.25572 1.87832 4.76953 2.11259 4.97548 2.57071Z" fill="#023B8F"/>
        </svg>
      `;case $r.ExpandDown:return html$1`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="#3078CD" />
        </svg>
      `;case $r.Overview:return html$1`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.5 10.5C2.67157 10.5 2 9.82843 2 9V4C2 3.17157 2.67157 2.5 3.5 2.5H12.5C13.3284 2.5 14 3.17157 14 4V9C14 9.82843 13.3284 10.5 12.5 10.5H3.5ZM3.5 3.5C3.22386 3.5 3 3.72386 3 4V5.5H13V4C13 3.72386 12.7761 3.5 12.5 3.5H3.5ZM5 6.5H3V9C3 9.27614 3.22386 9.5 3.5 9.5H5V6.5ZM6 9.5H12.5C12.7761 9.5 13 9.27614 13 9V6.5H6V9.5ZM0 3C0 1.61929 1.11929 0.5 2.5 0.5H13.5C14.8807 0.5 16 1.61929 16 3V10C16 11.3807 14.8807 12.5 13.5 12.5H2.5C1.11929 12.5 0 11.3807 0 10V3ZM2.5 1.5C1.67157 1.5 1 2.17157 1 3V10C1 10.8284 1.67157 11.5 2.5 11.5H13.5C14.3284 11.5 15 10.8284 15 10V3C15 2.17157 14.3284 1.5 13.5 1.5H2.5Z" fill="#717171"/>
        </svg>
      `;case $r.Send:return html$1`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case $r.Contact:return html$1`
        <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5ZM2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879ZM9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5ZM0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z" fill="#717171"/>
        </svg>
      `;case $r.Copy:return html$1`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case $r.CellPhone:return html$1`
        <svg width="10" height="16" viewBox="0 0 10 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 12C3.72386 12 3.5 12.2239 3.5 12.5C3.5 12.7761 3.72386 13 4 13H6C6.27614 13 6.5 12.7761 6.5 12.5C6.5 12.2239 6.27614 12 6 12H4ZM2 0C0.89543 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H8C9.10457 16 10 15.1046 10 14V2C10 0.89543 9.10457 0 8 0H2ZM1 2C1 1.44772 1.44772 1 2 1H8C8.55228 1 9 1.44772 9 2V14C9 14.5523 8.55228 15 8 15H2C1.44772 15 1 14.5523 1 14V2Z" fill="#717171"/>
        </svg>
      `;case $r.Chat:return html$1`
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7L5.5 7C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6L10.5 6Z" fill="#717171"/>
        </svg>
      `;case $r.Department:return html$1`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 1.5V3H2C0.895431 3 0 3.89543 0 5V12C0 13.1046 0.895432 14 2 14H14.0026C15.1071 14 16.0026 13.1046 16.0026 12V5C16.0026 3.89543 15.1071 3 14.0026 3H12V1.5C12 0.671573 11.3284 0 10.5 0H5.5C4.67157 0 4 0.671573 4 1.5ZM5.5 1H10.5C10.7761 1 11 1.22386 11 1.5V3H5V1.5C5 1.22386 5.22386 1 5.5 1ZM2 4H14.0026C14.5549 4 15.0026 4.44772 15.0026 5V7H12L12 6.50073C12 6.22459 11.7761 6.00073 11.5 6.00073C11.2239 6.00073 11 6.22459 11 6.50074L11 7H5V6.50073C5 6.22459 4.77614 6.00073 4.5 6.00073C4.22386 6.00073 4 6.22459 4 6.50073V7H1V5C1 4.44772 1.44772 4 2 4ZM11 8L11 8.5C11 8.77615 11.2239 9 11.5 9C11.7762 9 12 8.77614 12 8.5L12 8H15.0026V12C15.0026 12.5523 14.5549 13 14.0026 13H2C1.44772 13 1 12.5523 1 12V8H4V8.5C4 8.77614 4.22386 9 4.5 9C4.77614 9 5 8.77614 5 8.5V8H11Z" fill="#717171"/>
        </svg>
      `;case $r.Email:return html$1`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case $r.OfficeLocation:return html$1`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10 7C10 8.65685 8.65685 10 7 10C5.34315 10 4 8.65685 4 7C4 5.34315 5.34315 4 7 4C8.65685 4 10 5.34315 10 7ZM9 7C9 5.89543 8.10457 5 7 5C5.89543 5 5 5.89543 5 7C5 8.10457 5.89543 9 7 9C8.10457 9 9 8.10457 9 7ZM11.9497 11.955C14.6834 9.2201 14.6834 4.78601 11.9497 2.05115C9.21608 -0.683716 4.78392 -0.683716 2.05025 2.05115C-0.683418 4.78601 -0.683418 9.2201 2.05025 11.955L3.57128 13.4538L5.61408 15.4389L5.74691 15.5567C6.52168 16.1847 7.65623 16.1455 8.38611 15.4391L10.8223 13.0691L11.9497 11.955ZM2.75499 2.75619C5.09944 0.410715 8.90055 0.410715 11.245 2.75619C13.5294 5.04153 13.5879 8.71039 11.4207 11.0667L11.245 11.2499L9.92371 12.5539L7.69315 14.7225L7.60016 14.8021C7.24594 15.0699 6.7543 15.0698 6.40012 14.802L6.30713 14.7224L3.3263 11.817L2.75499 11.2499L2.57927 11.0667C0.412077 8.71039 0.47065 5.04153 2.75499 2.75619Z" fill="#717171"/>
        </svg>
      `;case $r.Person:return html$1`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case $r.Messages:return html$1`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case $r.Organization:return html$1`
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.99992 0C6.34271 0 4.99927 1.34344 4.99927 3.00066C4.99927 4.48754 6.08073 5.72183 7.49999 5.95985V7.5H4.5C3.67157 7.5 3 8.17157 3 9V10.0416C1.5811 10.2799 0.5 11.514 0.5 13.0007C0.5 14.6579 1.84344 16.0013 3.50066 16.0013C5.15787 16.0013 6.50131 14.6579 6.50131 13.0007C6.50131 11.5136 5.41954 10.2791 4 10.0414V9C4 8.72386 4.22386 8.5 4.5 8.5H11.5C11.7761 8.5 12 8.72386 12 9V10.0416C10.5811 10.2799 9.5 11.514 9.5 13.0007C9.5 14.6579 10.8434 16.0013 12.5007 16.0013C14.1579 16.0013 15.5013 14.6579 15.5013 13.0007C15.5013 11.5136 14.4195 10.2791 13 10.0414V9C13 8.17157 12.3284 7.5 11.5 7.5H8.49999V5.95983C9.91918 5.72176 11.0006 4.48749 11.0006 3.00066C11.0006 1.34344 9.65714 0 7.99992 0ZM5.99927 3.00066C5.99927 1.89572 6.89499 1 7.99992 1C9.10485 1 10.0006 1.89572 10.0006 3.00066C10.0006 4.10559 9.10485 5.00131 7.99992 5.00131C6.89499 5.00131 5.99927 4.10559 5.99927 3.00066ZM1.5 13.0007C1.5 11.8957 2.39572 11 3.50066 11C4.60559 11 5.50131 11.8957 5.50131 13.0007C5.50131 14.1056 4.60559 15.0013 3.50066 15.0013C2.39572 15.0013 1.5 14.1056 1.5 13.0007ZM12.5007 11C13.6056 11 14.5013 11.8957 14.5013 13.0007C14.5013 14.1056 13.6056 15.0013 12.5007 15.0013C11.3957 15.0013 10.5 14.1056 10.5 13.0007C10.5 11.8957 11.3957 11 12.5007 11Z" fill="#717171"/>
        </svg>
      `;case $r.ExpandRight:return html$1`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case $r.Profile:return html$1`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case $r.File:return html$1`
        <svg width="20" height="26" viewBox="0 0 20 26" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case $r.Files:return html$1`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.9956 4.07309V4C14.9956 2.61929 13.8763 1.5 12.4956 1.5H7.66418L6.06391 0.299946C5.80428 0.105247 5.48851 0 5.16399 0H2.5C1.11916 0 -0.000181445 1.11949 2.20615e-08 2.50033L0.0011832 11.4978C0.00135142 12.7772 0.962583 13.8321 2.2023 13.9798C2.2867 13.9945 2.37375 14.0021 2.46289 14.0021H13.1798C13.8981 14.0021 14.5156 13.4929 14.6524 12.7877L16.0097 5.78769C16.1587 5.01967 15.696 4.29703 14.9956 4.07309ZM2.5 1H5.16399C5.27216 1 5.37742 1.03508 5.46396 1.09998L7.19756 2.40002C7.2841 2.46492 7.38936 2.5 7.49753 2.5H12.4956C13.324 2.5 13.9956 3.17157 13.9956 4V4.00214H3.824C3.10596 4.00214 2.48863 4.511 2.35158 5.21583L1.05351 11.8916C1.01941 11.7661 1.0012 11.634 1.00118 11.4976L1 2.5002C0.999891 1.67169 1.6715 1 2.5 1ZM3.33319 5.4067C3.37888 5.17176 3.58465 5.00214 3.824 5.00214H14.5372C14.8515 5.00214 15.0879 5.28874 15.028 5.59732L13.6706 12.5973C13.6251 12.8324 13.4192 13.0021 13.1798 13.0021H2.46289C2.14845 13.0021 1.91206 12.7154 1.97208 12.4067L3.33319 5.4067Z" fill="#717171"/>
        </svg>
      `;case $r.Back:return html$1`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `;case $r.Close:return html$1`
        <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.73838 5.032L9.70337 1.067L8.99638 0.360001L5.03137 4.325L1.06637 0.360001L0.359375 1.067L4.32438 5.032L0.359375 8.997L1.06637 9.704L5.03137 5.739L8.99638 9.704L9.70337 8.997L5.73838 5.032Z" fill="black"/>
        </svg>
       `;case $r.Upload:return html$1`
    <svg class="upload-icon" width="10" height="12"  xmlns="http://www.w3.org/2000/svg">
      <path
        d="m9.58733,0l0,0.74599l-9.22101,0l0,-0.74599l9.22101,0zm0.3602,5.70569l-0.72039,0.52453l-3.73803,-2.7392l0,8.44489l-1.02456,0l0,-8.44489l-3.73803,2.7392l-0.72039,-0.52453l4.9707,-3.64838l4.9707,3.64838z"
      />
    </svg>
  `;case $r.FileCloud:return html$1`
    <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">
      <path
        d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"
      />
    </svg>
  `;case $r.DragFile:return html$1`
    <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">
      <path 
        d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z" 
      />
    </svg>
  `;case $r.Cancel:return html$1`
    <svg class="cancel-icon" width="10" height="10" xmlns="http://www.w3.org/2000/svg">
      <path 
      d="m5.52795,4.92946l4.37418,4.36141l-0.57055,0.56806l-4.38052,-4.35509l-4.38052,4.35509l-0.57055,-0.56806l4.37418,-4.36141l-4.37418,-4.36141l0.57055,-0.56806l4.38052,4.35509l4.38052,-4.35509l0.57055,0.56806l-4.37418,4.36141z"
      />
    </svg>
  `;case $r.Success:return html$1`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>
      <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>
    </svg>
  `;case $r.Fail:return html$1`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>
      <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />
    </svg>
  `}}function isWindowSegmentAware(){return void 0!==window.getWindowSegments}!function(e){e[e.image=2]="image",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines",e[e.fourlines=6]="fourlines"}(Mr||(Mr={})),function(e){e[e.ArrowRight=0]="ArrowRight",e[e.ArrowDown=1]="ArrowDown",e[e.TeamSeparator=2]="TeamSeparator",e[e.Search=3]="Search",e[e.SkypeArrow=4]="SkypeArrow",e[e.SmallEmail=5]="SmallEmail",e[e.SmallChat=6]="SmallChat",e[e.Video=7]="Video",e[e.Phone=8]="Phone",e[e.ExpandDown=9]="ExpandDown",e[e.Overview=10]="Overview",e[e.Send=11]="Send",e[e.Contact=12]="Contact",e[e.Copy=13]="Copy",e[e.CellPhone=14]="CellPhone",e[e.Chat=15]="Chat",e[e.Department=16]="Department",e[e.Email=17]="Email",e[e.OfficeLocation=18]="OfficeLocation",e[e.Person=19]="Person",e[e.Messages=20]="Messages",e[e.Organization=21]="Organization",e[e.ExpandRight=22]="ExpandRight",e[e.Profile=23]="Profile",e[e.Birthday=24]="Birthday",e[e.File=25]="File",e[e.Files=26]="Files",e[e.Back=27]="Back",e[e.Upload=28]="Upload",e[e.FileCloud=29]="FileCloud",e[e.DragFile=30]="DragFile",e[e.Cancel=31]="Cancel",e[e.Success=32]="Success",e[e.Fail=33]="Fail",e[e.Close=34]="Close"}($r||($r={}));const Ur=[css$1`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border-radius:8px}.root.visible .flyout{display:inline-block;animation-name:fadeIn;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}@keyframes fadeIn{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`];var __decorate$s=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$r=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Fr=class MgtFlyout extends MgtBaseComponent{constructor(){super(),this._edgePadding=24,this._renderedOnce=!1,this.avoidHidingAnchor=!0,this.handleWindowEvent=this.handleWindowEvent.bind(this),this.handleResize=this.handleResize.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.addEventListener("expanded",(()=>{window.requestAnimationFrame((()=>{this.updateFlyout()}))}))}static get styles(){return Ur}get isOpen(){return this._isOpen}set isOpen(e){const t=this._isOpen;t!==e&&(this._isOpen=e,window.requestAnimationFrame((()=>{this.setupWindowEvents(this.isOpen);const e=this._flyout;!this.isOpen&&e&&(e.style.width=null,e.style.setProperty("--mgt-flyout-set-width",null),e.style.setProperty("--mgt-flyout-set-height",null),e.style.maxHeight=null,e.style.top=null,e.style.left=null,e.style.bottom=null)})),this.requestUpdate("isOpen",t),this.dispatchEvent(new Event(e?"opened":"closed")))}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(e){super.updated(e),window.requestAnimationFrame((()=>{this.updateFlyout()}))}render(){const e={dir:this.direction,root:!0,visible:this.isOpen},t=this.renderAnchor();let r=null;return(this.isOpen||this._renderedOnce)&&(this._renderedOnce=!0,r=html$1`
        <div class="flyout" @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `),html$1`
      <div class=${Sr(e)}>
        <div class="anchor">
          ${t}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${r}
      </div>
    `}renderAnchor(){return html$1`
      <slot></slot>
    `}renderFlyout(){return html$1`
      <slot name="flyout"></slot>
    `}updateFlyout(){if(!this.isOpen)return;const e=this._anchor,t=this._flyout;if(t&&e){const r=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth,o=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let i,n,s,a=0,l=0;const c=t.getBoundingClientRect(),d=e.getBoundingClientRect(),u=this._topScout.getBoundingClientRect(),h=this._bottomScout.getBoundingClientRect(),p={height:o,left:0,top:0,width:r};if(isWindowSegmentAware()){const e=function getSegmentAwareWindow(){return isWindowSegmentAware()?window:null}().getWindowSegments();let t;const r=d.left+d.width/2,o=d.top+d.height/2;for(const i of e)if(r>=i.left&&o>=i.top){t=i;break}t&&(p.left=t.left,p.top=t.top,p.width=t.width,p.height=t.height)}c.width+2*this._edgePadding>p.width?c.width>p.width?(s=p.width,a=0):a=(p.width-c.width)/2:a=d.left+c.width+this._edgePadding>p.width?d.left-(d.left+c.width+this._edgePadding-p.width):d.left<this._edgePadding?this._edgePadding:d.left;const f=p.height-(d.top+d.height),g=d.top;this.avoidHidingAnchor?f<=c.height?g<c.height?g>f?(i=p.height-d.top,n=g):(l=d.bottom,n=f):(i=p.height-d.top,n=g):(l=d.bottom,n=f):c.height+2*this._edgePadding>p.height?c.height>=p.height?(n=p.height,l=0):l=(p.height-c.height)/2:l=d.top+d.height+c.height+this._edgePadding>p.height?p.height-c.height-this._edgePadding:Math.max(d.top+d.height,this._edgePadding),0===u.top&&0===u.left||(a-=u.left,void 0!==i?i+=h.top-o:l-=u.top),"rtl"===this.direction?a>100&&this.offsetLeft>100&&(t.style.left=p.width-a+c.left-c.width-30+"px"):t.style.left=`${a+p.left}px`,void 0!==i?(t.style.top="unset",t.style.bottom=`${i}px`):(t.style.bottom="unset",t.style.top=`${l+p.top}px`),s&&(t.style.width=`${s}px`,t.style.setProperty("--mgt-flyout-set-width",`${s}px`),window.requestAnimationFrame((()=>this.updateFlyout()))),n?(t.style.maxHeight=`${n}px`,t.style.setProperty("--mgt-flyout-set-height",`${n}px`)):(t.style.maxHeight=null,t.style.setProperty("--mgt-flyout-set-height","unset"))}}setupWindowEvents(e){e&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}handleWindowEvent(e){const t=this._flyout;if(t)if(e.composedPath){const r=e.composedPath();if(r.includes(t)||"pointerdown"===e.type&&r.includes(this))return}else{let r=e.target;for(;r;)if(r=r.parentElement,r===t||"pointerdown"===e.type&&r===this)return}this.close()}handleResize(e){this.close()}handleKeyUp(e){"Escape"===e.key&&this.close()}handleFlyoutWheel(e){e.preventDefault()}};var Hr;__decorate$s([property({attribute:"light-dismiss",type:Boolean}),__metadata$r("design:type",Boolean)],Fr.prototype,"isLightDismiss",void 0),__decorate$s([property({attribute:null,type:Boolean}),__metadata$r("design:type",Boolean)],Fr.prototype,"avoidHidingAnchor",void 0),__decorate$s([property({attribute:"isOpen",type:Boolean}),__metadata$r("design:type",Boolean),__metadata$r("design:paramtypes",[Boolean])],Fr.prototype,"isOpen",null),Fr=__decorate$s([customElement("mgt-flyout"),__metadata$r("design:paramtypes",[])],Fr),function(e){e[e.none=0]="none",e[e.hover=1]="hover",e[e.click=2]="click"}(Hr||(Hr={}));const Br=[css$1`
@charset "UTF-8";:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host([hidden]){display:none}:host{display:block;font-family:var(--font-family,var(--default-font-family))}:host .root{display:block;margin:-11px -13px;padding:11px 13px}:host svg,mgt-person svg{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;color:var(--color,var(--color-sub1,#323130))}:host .person-root.clickable,mgt-person .person-root.clickable{cursor:pointer}:host .person-root.vertical,mgt-person .person-root.vertical{text-align:center;display:block}:host .person-root .user-avatar,mgt-person .person-root .user-avatar{position:relative;width:var(--avatar-size,var(--avatar-size-s,40px));height:var(--avatar-size,var(--avatar-size-s,40px));display:flex;justify-content:center;align-items:center;flex-shrink:0;cursor:var(--avatar-cursor,inherit)}:host .person-root .user-avatar .user-presence,mgt-person .person-root .user-avatar .user-presence{margin:1px;position:absolute;left:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .72 - 2px);top:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .72 - 2px);width:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .28);height:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .28);border:1px solid var(--presence-background-color,var(--background-color,#fff));border-radius:50%}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#b4009e}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg{color:#b4009e;width:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .14);margin-left:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-basic,mgt-person .person-root .user-avatar .user-presence .presence-basic{width:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .28 - 4px);height:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .28 - 4px);border-style:solid;border-width:2px;border-radius:50%;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .14);vertical-align:top;display:flex;align-items:center}:host .person-root .user-avatar .user-presence .presence-basic.presence-offline,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-offline{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#8a8886}:host .person-root .user-avatar .user-presence .presence-basic.presence-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-available{background-color:#13a10e;border-color:#13a10e}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-available{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#13a10e}:host .person-root .user-avatar .user-presence .presence-basic.presence-away,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-away{background-color:#fa4;border-color:#fa4}:host .person-root .user-avatar .user-presence .presence-basic.presence-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-dnd{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-busy{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-offline::before,mgt-person .person-root .user-avatar .user-presence .presence-offline::before{content:"";color:#8a8886;font-weight:700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-available::before,mgt-person .person-root .user-avatar .user-presence .presence-available::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-available::before{content:"";color:#13a10e;margin-left:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-away::before,mgt-person .person-root .user-avatar .user-presence .presence-away::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-dnd::before{content:"";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-dnd::before{content:"";color:#c50f1f;margin-left:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}:host .person-root .user-avatar.initials,mgt-person .person-root .user-avatar.initials{color:var(--initials-color,#fff);border-radius:var(--avatar-border-radius,50%);font-weight:400}:host .person-root .user-avatar.initials .contact-icon,:host .person-root .user-avatar.initials .initials-text,mgt-person .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .initials-text{cursor:var(--avatar-cursor,inherit);margin-top:-1px;font-size:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .4)}:host .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .contact-icon{display:inline}:host .person-root .user-avatar.small,mgt-person .person-root .user-avatar.small{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root .user-avatar.small .contact-icon,:host .person-root .user-avatar.small .initials-text,mgt-person .person-root .user-avatar.small .contact-icon,mgt-person .person-root .user-avatar.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}:host .person-root .user-avatar.small .user-presence,mgt-person .person-root .user-avatar.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:6px;height:6px}:host .person-root .user-avatar.small .user-presence .presence-basic,mgt-person .person-root .user-avatar.small .user-presence .presence-basic{width:2px;height:2px;border-radius:50%;padding:0;font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .14)}:host .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg{width:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .14);margin-left:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .07 - 2px)}:host .person-root .user-avatar.small .user-presence .presence-available::before,:host .person-root .user-avatar.small .user-presence .presence-away::before,:host .person-root .user-avatar.small .user-presence .presence-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-offline::before,:host .person-root .user-avatar.small .user-presence .presence-oof-available::before,:host .person-root .user-avatar.small .user-presence .presence-oof-away::before,:host .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-offline::before{margin-left:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .07 - 2px)}:host .person-root .user-avatar.threeLines,mgt-person .person-root .user-avatar.threeLines{width:var(--avatar-size-3-lines,var(--avatar-size-s,56px));height:var(--avatar-size-3-lines,var(--avatar-size-s,56px))}:host .person-root .user-avatar.threeLines .contact-icon,:host .person-root .user-avatar.threeLines .initials-text,mgt-person .person-root .user-avatar.threeLines .contact-icon,mgt-person .person-root .user-avatar.threeLines .initials-text{font-size:calc(var(--avatar-size-3-lines,var(--avatar-size-s,56px)) * .4)}:host .person-root .user-avatar.threeLines .user-presence,mgt-person .person-root .user-avatar.threeLines .user-presence{left:calc(var(--avatar-size-3-lines,var(--avatar-size-s,56px)) - 18px);top:calc(var(--avatar-size-3-lines,var(--avatar-size-s,56px)) - 18px);width:16px;height:16px}:host .person-root .user-avatar.threeLines .user-presence .presence-basic,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-basic{width:12px;height:12px;border-radius:50%;padding:0;font-size:calc(var(--avatar-size-3-lines,var(--avatar-size-s,56px)) * .14)}:host .person-root .user-avatar.threeLines .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-basic .presence-oof-offline svg{width:calc(var(--avatar-size-3-lines,var(--avatar-size-s,56px)) * .14);margin-left:calc(var(--avatar-size-4-lines,var(--avatar-size-s,72px)) * .07 - 2px)}:host .person-root .user-avatar.threeLines .user-presence .presence-available::before,:host .person-root .user-avatar.threeLines .user-presence .presence-away::before,:host .person-root .user-avatar.threeLines .user-presence .presence-dnd::before,:host .person-root .user-avatar.threeLines .user-presence .presence-offline::before,:host .person-root .user-avatar.threeLines .user-presence .presence-oof-available::before,:host .person-root .user-avatar.threeLines .user-presence .presence-oof-away::before,:host .person-root .user-avatar.threeLines .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.threeLines .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-available::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-away::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.threeLines .user-presence .presence-oof-offline::before{margin-left:calc(var(--avatar-size-3-lines,var(--avatar-size-s,56px)) * .07 - 2px)}:host .person-root .user-avatar.fourLines,:host .person-root .user-avatar.vertical,mgt-person .person-root .user-avatar.fourLines,mgt-person .person-root .user-avatar.vertical{width:var(--avatar-size-4-lines,var(--avatar-size-s,72px));height:var(--avatar-size-4-lines,var(--avatar-size-s,72px))}:host .person-root .user-avatar.fourLines .contact-icon,:host .person-root .user-avatar.fourLines .initials-text,:host .person-root .user-avatar.vertical .contact-icon,:host .person-root .user-avatar.vertical .initials-text,mgt-person .person-root .user-avatar.fourLines .contact-icon,mgt-person .person-root .user-avatar.fourLines .initials-text,mgt-person .person-root .user-avatar.vertical .contact-icon,mgt-person .person-root .user-avatar.vertical .initials-text{font-size:calc(var(--avatar-size-4-lines,var(--avatar-size-s,72px)) * .4)}:host .person-root .user-avatar.fourLines .user-presence,:host .person-root .user-avatar.vertical .user-presence,mgt-person .person-root .user-avatar.fourLines .user-presence,mgt-person .person-root .user-avatar.vertical .user-presence{left:calc(var(--avatar-size-4-lines,var(--avatar-size-s,72px)) - 22px);top:calc(var(--avatar-size-4-lines,var(--avatar-size-s,72px)) - 22px);width:20px;height:20px}:host .person-root .user-avatar.fourLines .user-presence .presence-basic,:host .person-root .user-avatar.vertical .user-presence .presence-basic,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-basic,mgt-person .person-root .user-avatar.vertical .user-presence .presence-basic{width:16px;height:16px;border-radius:50%;padding:0;font-size:calc(var(--avatar-size-4-lines,var(--avatar-size-s,72px)) * .14)}:host .person-root .user-avatar.fourLines .user-presence .presence-basic .presence-oof-offline svg,:host .person-root .user-avatar.vertical .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.vertical .user-presence .presence-basic .presence-oof-offline svg{width:calc(var(--avatar-size-4-lines,var(--avatar-size-s,72px)) * .14);margin-left:calc(var(--avatar-size-4-lines,var(--avatar-size-s,72px)) * .07 - 2px)}:host .person-root .user-avatar.fourLines .user-presence .presence-available::before,:host .person-root .user-avatar.fourLines .user-presence .presence-away::before,:host .person-root .user-avatar.fourLines .user-presence .presence-dnd::before,:host .person-root .user-avatar.fourLines .user-presence .presence-offline::before,:host .person-root .user-avatar.fourLines .user-presence .presence-oof-available::before,:host .person-root .user-avatar.fourLines .user-presence .presence-oof-away::before,:host .person-root .user-avatar.fourLines .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.fourLines .user-presence .presence-oof-offline::before,:host .person-root .user-avatar.vertical .user-presence .presence-available::before,:host .person-root .user-avatar.vertical .user-presence .presence-away::before,:host .person-root .user-avatar.vertical .user-presence .presence-dnd::before,:host .person-root .user-avatar.vertical .user-presence .presence-offline::before,:host .person-root .user-avatar.vertical .user-presence .presence-oof-available::before,:host .person-root .user-avatar.vertical .user-presence .presence-oof-away::before,:host .person-root .user-avatar.vertical .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.vertical .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-available::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-away::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.fourLines .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-available::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-away::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.vertical .user-presence .presence-oof-offline::before{margin-left:calc(var(--avatar-size-4-lines,var(--avatar-size-s,72px)) * .07 - 2px)}:host .person-root .user-avatar.vertical,mgt-person .person-root .user-avatar.vertical{margin-left:auto;margin-right:auto}:host .person-root .user-avatar .img-wrapper,mgt-person .person-root .user-avatar .img-wrapper{height:100%;width:100%;display:flex;overflow:hidden;border:var(--avatar-border,0);border-radius:var(--avatar-border-radius,50%);position:relative}:host .person-root .user-avatar .img-wrapper img,mgt-person .person-root .user-avatar .img-wrapper img{position:absolute;display:block;top:-100%;right:-100%;bottom:-100%;left:-100%;margin:auto;height:100%;width:100%;object-fit:cover;object-position:top}:host .person-root .user-avatar .img-wrapper img:focus(),mgt-person .person-root .user-avatar .img-wrapper img:focus(){outline:0}:host .person-root .user-avatar.pinkRed10,mgt-person .person-root .user-avatar.pinkRed10{background-color:var(--initials-background-color,#750b1c)}:host .person-root .user-avatar.red20,mgt-person .person-root .user-avatar.red20{background-color:var(--initials-background-color,#a4262c)}:host .person-root .user-avatar.red10,mgt-person .person-root .user-avatar.red10{background-color:var(--initials-background-color,#d13438)}:host .person-root .user-avatar.orange20,mgt-person .person-root .user-avatar.orange20{background-color:var(--initials-background-color,#ca5010)}:host .person-root .user-avatar.orangeYellow20,mgt-person .person-root .user-avatar.orangeYellow20{background-color:var(--initials-background-color,#986f0b)}:host .person-root .user-avatar.green10,mgt-person .person-root .user-avatar.green10{background-color:var(--initials-background-color,#498205)}:host .person-root .user-avatar.green20,mgt-person .person-root .user-avatar.green20{background-color:var(--initials-background-color,#0b6a0b)}:host .person-root .user-avatar.cyan20,mgt-person .person-root .user-avatar.cyan20{background-color:var(--initials-background-color,#038387)}:host .person-root .user-avatar.cyan30,mgt-person .person-root .user-avatar.cyan30{background-color:var(--initials-background-color,#005b70)}:host .person-root .user-avatar.cyanBlue10,mgt-person .person-root .user-avatar.cyanBlue10{background-color:var(--initials-background-color,#0078d4)}:host .person-root .user-avatar.cyanBlue20,mgt-person .person-root .user-avatar.cyanBlue20{background-color:var(--initials-background-color,#004e8c)}:host .person-root .user-avatar.blue10,mgt-person .person-root .user-avatar.blue10{background-color:var(--initials-background-color,#4f6bed)}:host .person-root .user-avatar.blueMagenta30,mgt-person .person-root .user-avatar.blueMagenta30{background-color:var(--initials-background-color,#5c2e91)}:host .person-root .user-avatar.blueMagenta20,mgt-person .person-root .user-avatar.blueMagenta20{background-color:var(--initials-background-color,#8764b8)}:host .person-root .user-avatar.magenta20,mgt-person .person-root .user-avatar.magenta20{background-color:var(--initials-background-color,#881798)}:host .person-root .user-avatar.magenta10,mgt-person .person-root .user-avatar.magenta10{background-color:var(--initials-background-color,#c239b3)}:host .person-root .user-avatar.magentaPink10,mgt-person .person-root .user-avatar.magentaPink10{background-color:var(--initials-background-color,#e3008c)}:host .person-root .user-avatar.orange30,mgt-person .person-root .user-avatar.orange30{background-color:var(--initials-background-color,#8e562e)}:host .person-root .user-avatar.gray30,mgt-person .person-root .user-avatar.gray30{background-color:var(--initials-background-color,#7a7574)}:host .person-root .user-avatar.lightGrey,mgt-person .person-root .user-avatar.lightGrey{background-color:#e5e5e5}:host .person-root .details,mgt-person .person-root .details{flex-shrink:1;display:flex;flex-direction:column;overflow:hidden;line-height:1.4;margin:var(--details-spacing,0 0 0 12px)}:host .person-root .details.small,mgt-person .person-root .details.small{margin:var(--details-spacing,0 0 0 8px)}:host .person-root .details.small .line1,mgt-person .person-root .details.small .line1{font-weight:400}:host .person-root .details.threeLines,mgt-person .person-root .details.threeLines{margin:var(--details-spacing,0 0 0 14px)}:host .person-root .details.threeLines .line1,mgt-person .person-root .details.threeLines .line1{font-size:16px;line-height:22px}:host .person-root .details.fourLines,mgt-person .person-root .details.fourLines{margin:var(--details-spacing,0 0 0 16px)}:host .person-root .details.fourLines .line1,mgt-person .person-root .details.fourLines .line1{font-size:20px;line-height:26px}:host .person-root .details.vertical,mgt-person .person-root .details.vertical{text-align:center;margin:var(--details-spacing,10px 12px 0 0)}:host .person-root .details.vertical.small,mgt-person .person-root .details.vertical.small{margin:var(--details-spacing,10px 6px 0 0)}:host .person-root .details.vertical.fourlines,:host .person-root .details.vertical.threelines,mgt-person .person-root .details.vertical.fourlines,mgt-person .person-root .details.vertical.threelines{margin:var(--details-spacing,14px 0 0 0)}:host .person-root .details.vertical.fourlines .line1,:host .person-root .details.vertical.threelines .line1,mgt-person .person-root .details.vertical.fourlines .line1,mgt-person .person-root .details.vertical.threelines .line1{margin-bottom:0}:host .person-root .details>div,mgt-person .person-root .details>div{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}:host .person-root .details .line1,mgt-person .person-root .details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);text-transform:var(text-transform,none);line-height:20px}:host .person-root .details .line2,mgt-person .person-root .details .line2{color:var(--line2-color,var(--color-sub2,#717171));font-size:var(--line2-font-size,var(--email-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:16px}:host .person-root .details .line3,mgt-person .person-root .details .line3{color:var(--line3-color,var(--color-sub2,#717171));font-size:var(--line3-font-size,var(--email-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:16px}:host .person-root .details .line4,mgt-person .person-root .details .line4{color:var(--line4-color,var(--color-sub2,#717171));font-size:var(--line4-font-size,var(--email-font-size,12px));font-weight:var(--line4-font-weight,400);text-transform:var(--line4-text-transform,var(text-transform,none));line-height:16px}:host .avatar-icon,mgt-person .avatar-icon{display:flex;align-items:center;justify-content:center;line-height:1;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .5);width:var(--avatar-size,var(--avatar-size-s,40px));height:var(--avatar-size,var(--avatar-size-s,40px));overflow:hidden;border-radius:var(--avatar-border-radius,50%)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,var(--avatar-size,24px));width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .avatar-icon.threeLines,mgt-person .avatar-icon.threeLines{font-size:var(--avatar-size-3-lines,var(--avatar-size-s,56px));width:var(--avatar-size-3-lines,var(--avatar-size-s,56px));height:var(--avatar-size-3-lines,var(--avatar-size-s,56px))}:host .avatar-icon.fourLines,mgt-person .avatar-icon.fourLines{font-size:var(--avatar-size-4-lines,var(--avatar-size-s,72px));width:var(--avatar-size-4-lines,var(--avatar-size-s,72px));height:var(--avatar-size-4-lines,var(--avatar-size-s,72px))}:host .vertical,mgt-person .vertical{display:block}[dir=rtl] .root{direction:rtl}[dir=rtl] svg{direction:rtl}[dir=rtl] .person-root .user-avatar{position:relative}[dir=rtl] .person-root .details{margin:var(--details-spacing,0 12px 0 0)}[dir=rtl] .person-root .details.small{margin:var(--details-spacing,0 8px 0 0)}[dir=rtl] .person-root .details.threelines{margin:var(--details-spacing,0 14px 0 0)}[dir=rtl] .person-root .details.fourlines{margin:var(--details-spacing,0 16px 0 0)}[dir=rtl] .person-root .user-presence .presence-oof-offline svg{margin-right:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-offline::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-away::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,40px)) * .07 - 2px)}[dir=rtl] .person-root.small .contact-icon,[dir=rtl] .person-root.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}[dir=rtl] .person-root.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}[dir=rtl] .person-root.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}[dir=rtl] .person-root.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}[dir=rtl] .person-root.vertical{text-align:center;display:block}[dir=rtl] .person-root.vertical .user-avatar{display:block;margin-left:auto;margin-right:auto}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var qr,zr,jr,__decorate$r=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$q=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$t=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};!function(e){e[e.avatar=2]="avatar",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines",e[e.fourlines=6]="fourlines"}(zr||(zr={})),function(e){e.photo="photo",e.initials="initials"}(jr||(jr={}));const Vr=["businessPhones","displayName","givenName","jobTitle","department","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id"];let Gr=qr=class MgtPerson extends MgtTemplatedComponent{constructor(){super(),this.personCardInteraction=Hr.none,this.line1Property="displayName",this.line2Property="jobTitle",this.line3Property="department",this.line4Property="email",this.view=Mr.image,this.avatarSize="auto",this.disableImageFetch=!1,this._isInvalidImageSrc=!1,this._avatarType="photo",this.verticalLayout=!1}static get styles(){return Br}get personQuery(){return this._personQuery}set personQuery(e){e!==this._personQuery&&(this._personQuery=e,this.personDetailsInternal=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.personDetailsInternal||(e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="lightGrey",this.requestStateUpdate()))}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetailsInternal=null,this.requestStateUpdate())}get personDetailsInternal(){return this._personDetailsInternal}set personDetailsInternal(e){this._personDetailsInternal!==e&&(this._personDetailsInternal=e,e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="lightGrey",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetailsInternal"))}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,e&&e.displayName?this._personAvatarBg=this.getColorFromName(e.displayName):this._personAvatarBg="lightGrey",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetails"))}get personImage(){return this._personImage||this._fetchedImage}set personImage(e){if(e===this._personImage)return;this._isInvalidImageSrc=!e;const t=this._personImage;this._personImage=e,this.requestUpdate("personImage",t)}get avatarType(){return this._avatarType}set avatarType(e){e!==this._avatarType&&(this._avatarType=e,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(e){if(e===this._personPresence)return;const t=this._personPresence;this._personPresence=e,this.requestUpdate("personPresence",t)}static get requiredScopes(){const e=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return qr.config.useContactApis&&e.push("contacts.read"),e}get flyout(){return this.renderRoot.querySelector(".flyout")}render(){if(this.isLoadingState&&!this.personDetails&&!this.personDetailsInternal&&!this.fallbackDetails)return this.renderLoading();const e=this.personDetails||this.personDetailsInternal||this.fallbackDetails,t=this.getImage(),r=this.personPresence||this._fetchedPresence;if(!e&&!t)return this.renderNoData();e&&e.personImage||!t||(e.personImage=t);let o=this.renderTemplate("default",{person:e,personImage:t,personPresence:r});if(!o){const i=this.renderDetails(e,r),n=this.renderAvatar(e,t,r),s={"person-root":!0,clickable:this.personCardInteraction===Hr.click,vertical:this.isVertical()};o=html$1`
        <div class=${Sr(s)}>
          ${n} ${i}
        </div>
      `}return this.personCardInteraction!==Hr.none&&(o=this.renderFlyout(o,e,t,r)),html$1`
      <div
        class="root"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
        @keydown=${this.handleKeyDown}
        tabindex=0
      >
        ${o}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||html$1``}clearState(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){const e=this.renderTemplate("no-data",null);if(e)return e;const t={"avatar-icon":!0,vertical:this.isVertical(),small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines()};return html$1`
      <i class=${Sr(t)}></i>
    `}renderPersonIcon(){return html$1`
      <svg width="10" height="13" viewBox="0 0 10 13" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M8.5 7C9.32843 7 10 7.67157 10 8.5V9C10 10.9714 8.14049 13 5 13C1.85951 13 0 10.9714 0 9V8.5C0 7.67157 0.671573 7 1.5 7H8.5ZM8.5 8H1.5C1.22386 8 1 8.22386 1 8.5V9C1 10.4376 2.43216 12 5 12C7.56784 12 9 10.4376 9 9V8.5C9 8.22386 8.77614 8 8.5 8ZM5 0.5C6.51878 0.5 7.75 1.73122 7.75 3.25C7.75 4.76878 6.51878 6 5 6C3.48122 6 2.25 4.76878 2.25 3.25C2.25 1.73122 3.48122 0.5 5 0.5ZM5 1.5C4.0335 1.5 3.25 2.2835 3.25 3.25C3.25 4.2165 4.0335 5 5 5C5.9665 5 6.75 4.2165 6.75 3.25C6.75 2.2835 5.9665 1.5 5 1.5Z" fill="#616161"/>
      </svg>
    `}renderImage(e,t){if(e&&this.personCardInteraction===Hr.none&&(e.displayName||getEmailFromGraphEntity(e)),t&&!this._isInvalidImageSrc&&"photo"===this._avatarType)return html$1`
        <div class="img-wrapper">
          <img alt=${e.displayName} src=${t} @error=${()=>this._isInvalidImageSrc=!0} />
        </div>
      `;if(e){const t=this.getInitials(e);return html$1`
        <span class="initials-text" aria-label="${t}">
          ${t&&t.length?html$1`
                ${t}
              `:html$1`
                <i class="contact-icon">
                ${this.renderPersonIcon()}
                </i>
              `}
        </span>
      `}}renderPresence(e){if(!this.showPresence||!e)return html$1``;let t=null;switch(e.availability){case"DoNotDisturb":if("OutOfOffice"===e.activity)t="presence-oof-dnd";else t="presence-dnd";break;case"BeRightBack":t="presence-away";break;case"Available":switch(e.activity){case"Available":t="presence-available";break;case"OutOfOffice":t="presence-oof-available"}break;case"Busy":if("OutOfOffice"===e.activity)t="presence-oof-busy";else t="presence-busy";break;case"Away":switch(e.activity){case"Away":t="presence-away";break;case"OutOfOffice":t="presence-oof-offline"}break;case"Offline":switch(e.activity){case"Offline":case"OffWork":t="presence-offline";break;case"OutOfOffice":t="presence-oof-offline"}break;default:t="presence-offline"}const r={"ms-Icon":!0,"presence-basic":!0};r[t]=!0;let o=null;return o="presence-oof-offline"===t?html$1`
        <div class="ms-Icon presence-basic presence-oof-offline-wrapper">
          <i class="presence-oof-offline">
            ${getSvg($r.SkypeArrow,"#666666")}
          </i>
        </div>
      `:html$1`
        <i class=${Sr(r)} aria-hidden="true"></i>
      `,html$1`
      <div class="user-presence" title=${e.activity} aria-label=${e.activity} role="img">
        ${o}
      </div>
    `}renderAvatar(e,t,r){const o=e&&this.personCardInteraction===Hr.none&&(e.displayName||getEmailFromGraphEntity(e))||"",i={initials:!t||this._isInvalidImageSrc||"initials"===this._avatarType,small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines(),"user-avatar":!0,vertical:this.isVertical()};t&&!this._isInvalidImageSrc&&"initials"!==this._avatarType||!e||(i[this._personAvatarBg]=!0);const n=this.renderImage(e,t),s=this.renderPresence(r);return html$1`
      <div class=${Sr(i)} title=${o} aria-label=${o}>
        ${n} ${s}
      </div>
    `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}handleLine4Clicked(){this.fireCustomEvent("line4clicked",this.personDetailsInternal)}renderDetails(e,t){if(!e||this.view===Mr.image||this.view===zr.avatar)return html$1``;let r=e;t&&(r.presenceActivity=null==t?void 0:t.activity,r.presenceAvailability=null==t?void 0:t.availability);const o=[];if(this.view>Mr.image){const e=this.getTextFromProperty(r,this.line1Property);if(this.hasTemplate("line1")){const t=this.renderTemplate("line1",{person:r});o.push(html$1`
          <div class="line1" @click=${()=>this.handleLine1Clicked()} aria-label="${e}">${t}</div>
        `)}else e&&o.push(html$1`
            <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${e}">${e}</div>
          `)}if(this.view>Mr.oneline){const e=this.getTextFromProperty(r,this.line2Property);if(this.hasTemplate("line2")){const t=this.renderTemplate("line2",{person:r});o.push(html$1`
          <div class="line2" @click=${()=>this.handleLine2Clicked()} aria-label="${e}">${t}</div>
        `)}else e&&o.push(html$1`
            <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${e}">${e}</div>
          `)}if(this.view>Mr.twolines){const e=this.getTextFromProperty(r,this.line3Property);if(this.hasTemplate("line3")){const t=this.renderTemplate("line3",{person:r});o.push(html$1`
          <div class="line3" @click=${()=>this.handleLine3Clicked()} aria-label="${e}">${t}</div>
        `)}else e&&o.push(html$1`
            <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${e}">${e}</div>
          `)}if(this.view>Mr.threelines){const e=this.getTextFromProperty(r,this.line4Property);if(this.hasTemplate("line4")){const t=this.renderTemplate("line4",{person:r});o.push(html$1` 
          <div class="line4" @click=${()=>this.handleLine4Clicked()} aria-label="${e}">${t}</div>
        `)}else e&&o.push(html$1`
            <div class="line4" @click=${()=>this.handleLine4Clicked()} aria-label="${e}">${e}</div>
          `)}const i=Sr({details:!0,small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines(),vertical:this.isVertical()});return html$1`
      <div class="${i}">
        ${o}
      </div>
    `}renderFlyout(e,t,r,o){const i=this._personCardShouldRender?html$1`
          <div slot="flyout">
            ${this.renderFlyoutContent(t,r,o)}
          </div>
        `:html$1``;return html$1`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        ${e} ${i}
      </mgt-flyout>
    `}renderFlyoutContent(e,t,r){return this.renderTemplate("person-card",{person:e,personImage:t})||html$1`
        <mgt-person-card
          .personDetails=${e}
          .personImage=${t}
          .personPresence=${r}
          .showPresence=${this.showPresence}
        ></mgt-person-card>
      `}loadState(){return __awaiter$t(this,void 0,void 0,(function*(){const e=Providers.globalProvider;if(!e||e.state===or.Loading)return;if(e&&e.state===or.SignedOut)return void(this.personDetailsInternal=null);const t=e.graph.forComponent(this);this.fallbackDetails&&(this.line2Property="email"),this.verticalLayout&&this.view<Mr.fourlines&&(this.line2Property="email");let r=[...Vr,this.line1Property,this.line2Property,this.line3Property,this.line4Property];r=r.filter((e=>"email"!==e));let o=this.personDetailsInternal||this.personDetails||this.fallbackDetails;if(o){if(!o.personImage&&this.fetchImage&&"photo"===this._avatarType&&!this.personImage&&!this._fetchedImage){let e;e="groupTypes"in o?yield function getGroupImage(e,t,r=!0){return __awaiter$w(this,void 0,void 0,(function*(){let r,o,i=t.id;if(getIsPhotosCacheEnabled()){if(o=CacheService.getCache(xr,xr.stores.groups),r=yield o.getValue(i),r&&getPhotoInvalidationTime()>Date.now()-r.timeCached)return r.photo;if(r)try{const t=yield e.api(`group/${i}/photo`).get();t&&(t["@odata.mediaEtag"]!==r.eTag||null===t["@odata.mediaEtag"]&&null===t.eTag)&&(r=null)}catch(e){return null}}return r=r||(yield getPhotoForResource(e,`groups/${i}`,["user.readbasic.all"])),getIsPhotosCacheEnabled()&&r&&o.putValue(i,r),r?r.photo:null}))}(t,o,qr.config.useContactApis):yield getPersonImage(t,o,qr.config.useContactApis),e&&(o.personImage=e,this._fetchedImage=e)}}else if(this.userId||"me"===this.personQuery){let e;e="photo"!==this._avatarType||this.disableImageFetch?"me"===this.personQuery?yield getMe(t,r):yield getUser(t,this.userId,r):yield getUserWithPhoto(t,this.userId,r),this.personDetailsInternal=e,this._fetchedImage=this.getImage()}else if(this.personQuery){let e=yield findPeople(t,this.personQuery,1);if(e&&0!==e.length||(e=(yield findUsers(t,this.personQuery,1))||[]),e&&e.length&&(this.personDetailsInternal=e[0],"photo"===this._avatarType&&!this.disableImageFetch)){const r=yield getPersonImage(t,e[0],qr.config.useContactApis);r&&(this.personDetailsInternal.personImage=r,this._fetchedImage=r)}}const i={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(this.personDetailsInternal&&this.personDetailsInternal.id){const e="me"!==this.personQuery?this.personDetailsInternal.id:null;this._fetchedPresence=yield getUserPresence(t,e)}else this._fetchedPresence=i}catch(e){this._fetchedPresence=i}}))}getInitials(e){if(e||(e=this.personDetailsInternal),e.initials)return e.initials;let t="";if(e.givenName&&(t+=e.givenName[0].toUpperCase()),e.surname&&(t+=e.surname[0].toUpperCase()),!t&&e.displayName){const r=e.displayName.split(/\s+/);for(let e=0;e<2&&e<r.length;e++)r[e][0]&&this.isLetter(r[e][0])&&(t+=r[e][0].toUpperCase())}return t}getColorFromName(e){const t=e.split("").map((e=>e.charCodeAt(0))).join(""),r=["pinkRed10","red20","red10","orange20","orangeYellow20","green10","green20","cyan20","cyan30","cyanBlue10","cyanBlue20","blue10","blueMagenta30","blueMagenta20","magenta20","magenta10","magentaPink10","orange30","gray30","lightGrey"];return r[parseInt(t,10)%r.length]}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;const e=this.personDetailsInternal||this.personDetails;return e&&e.personImage?e.personImage:null}isLetter(e){try{return e.match(new RegExp("\\p{L}","u"))}catch(t){return e.toLowerCase()!==e.toUpperCase()}}getTextFromProperty(e,t){if(!t||0===t.length)return null;const r=t.trim().split(",");let o,i=0;for(;!o&&i<r.length;){const t=r[i].trim();switch(t){case"mail":case"email":o=getEmailFromGraphEntity(e);break;default:o=e[t]}i++}return o}isLargeAvatar(){return"large"===this.avatarSize||"auto"===this.avatarSize&&this.view>Mr.oneline}isThreeLines(){return this.view===Mr.threelines}isFourLines(){return this.view===Mr.fourlines}isVertical(){return this.verticalLayout}handleMouseClick(e){this.personCardInteraction===Hr.click&&this.showPersonCard()}handleKeyDown(e){e&&"Enter"===e.key&&this.showPersonCard()}handleMouseEnter(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===Hr.hover&&(this._mouseEnterTimeout=setTimeout(this.showPersonCard.bind(this),500))}handleMouseLeave(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this.hidePersonCard.bind(this),500)}hidePersonCard(){const e=this.flyout;e&&e.close();const t=this.querySelector("mgt-person-card")||this.renderRoot.querySelector("mgt-person-card");t&&(t.isExpanded=!1,t.clearHistory())}showPersonCard(){this._personCardShouldRender||(this._personCardShouldRender=!0);const e=this.flyout;e&&e.open()}};Gr.config={useContactApis:!0},__decorate$r([property({attribute:"person-query"}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[String])],Gr.prototype,"personQuery",null),__decorate$r([property({attribute:"fallback-details",type:Object}),__metadata$q("design:type",Object),__metadata$q("design:paramtypes",[Object])],Gr.prototype,"fallbackDetails",null),__decorate$r([property({attribute:"user-id"}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[String])],Gr.prototype,"userId",null),__decorate$r([property({attribute:"show-presence",type:Boolean}),__metadata$q("design:type",Boolean)],Gr.prototype,"showPresence",void 0),__decorate$r([property({attribute:"avatar-size",type:String}),__metadata$q("design:type",String)],Gr.prototype,"avatarSize",void 0),__decorate$r([property({attribute:null,type:Object}),__metadata$q("design:type",Object),__metadata$q("design:paramtypes",[Object])],Gr.prototype,"personDetailsInternal",null),__decorate$r([property({attribute:"person-details",type:Object}),__metadata$q("design:type",Object),__metadata$q("design:paramtypes",[Object])],Gr.prototype,"personDetails",null),__decorate$r([property({attribute:"person-image",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[String])],Gr.prototype,"personImage",null),__decorate$r([property({attribute:"fetch-image",type:Boolean}),__metadata$q("design:type",Boolean)],Gr.prototype,"fetchImage",void 0),__decorate$r([property({attribute:"disable-image-fetch",type:Boolean}),__metadata$q("design:type",Boolean)],Gr.prototype,"disableImageFetch",void 0),__decorate$r([property({attribute:"vertical-layout",type:Boolean}),__metadata$q("design:type",Boolean)],Gr.prototype,"verticalLayout",void 0),__decorate$r([property({attribute:"avatar-type",converter:e=>"initials"===(e=e.toLowerCase())?jr.initials:jr.photo}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[String])],Gr.prototype,"avatarType",null),__decorate$r([property({attribute:"person-presence",type:Object}),__metadata$q("design:type",Object),__metadata$q("design:paramtypes",[Object])],Gr.prototype,"personPresence",null),__decorate$r([property({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),void 0===Hr[e]?Hr.none:Hr[e])}),__metadata$q("design:type",Number)],Gr.prototype,"personCardInteraction",void 0),__decorate$r([property({attribute:"line1-property"}),__metadata$q("design:type",String)],Gr.prototype,"line1Property",void 0),__decorate$r([property({attribute:"line2-property"}),__metadata$q("design:type",String)],Gr.prototype,"line2Property",void 0),__decorate$r([property({attribute:"line3-property"}),__metadata$q("design:type",String)],Gr.prototype,"line3Property",void 0),__decorate$r([property({attribute:"line4-property"}),__metadata$q("design:type",String)],Gr.prototype,"line4Property",void 0),__decorate$r([property({converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===Mr[e]?Mr.image:Mr[e]):Mr.image}),__metadata$q("design:type",Number)],Gr.prototype,"view",void 0),__decorate$r([internalProperty(),__metadata$q("design:type",String)],Gr.prototype,"_fetchedImage",void 0),__decorate$r([internalProperty(),__metadata$q("design:type",Object)],Gr.prototype,"_fetchedPresence",void 0),__decorate$r([internalProperty(),__metadata$q("design:type",Boolean)],Gr.prototype,"_isInvalidImageSrc",void 0),__decorate$r([internalProperty(),__metadata$q("design:type",Boolean)],Gr.prototype,"_personCardShouldRender",void 0),Gr=qr=__decorate$r([customElement("mgt-person"),__metadata$q("design:paramtypes",[])],Gr);const Kr=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,var(--color-sub1,#323130))}:host .agenda>.group:first-child>.header,mgt-agenda .agenda>.group:first-child>.header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background-color,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px var(--box-shadow-color,rgba(0,0,0,.092)));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex;border-radius:8px}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:125px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,var(--color,#000));font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,var(--color-sub1,#323130))}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location-icon svg,mgt-agenda .event-location-icon svg{height:12px}:host .event-location-icon svg path,mgt-agenda .event-location-icon svg path{stroke:var(--event-location-color,var(--color,#000))}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,var(--color,#000));margin:0 0 0 4px;line-height:17px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}[dir=rtl] .event-location{margin:0 4px 0 0}[dir=rtl] .event-time-container{direction:ltr;margin:18px 18px 18px 38px}[dir=rtl] .event-details-container{margin:14px 0 14px 18px}[dir=rtl] .event-details-container .event-subject{margin:0 0 0 18px}[dir=rtl] .event-details-container .event-location-container{margin:8px 0 0 18px}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}}
`];
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const createAndInsertPart=(e,t)=>{const r=e.startNode.parentNode,o=void 0===t?e.endNode:t.startNode,i=r.insertBefore(createMarker(),o);r.insertBefore(createMarker(),o);const n=new NodePart(e.options);return n.insertAfterNode(i),n},updatePart=(e,t)=>(e.setValue(t),e.commit(),e),insertPartBefore=(e,t,r)=>{const o=e.startNode.parentNode,i=r?r.startNode:e.endNode,n=t.endNode.nextSibling;n!==i&&((e,t,r=null,o=null)=>{for(;t!==r;){const r=t.nextSibling;e.insertBefore(t,o),t=r}})(o,t.startNode,n,i)},removePart=e=>{removeNodes(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},generateMap=(e,t,r)=>{const o=new Map;for(let i=t;i<=r;i++)o.set(e[i],i);return o},Wr=new WeakMap,Qr=new WeakMap,Yr=directive(((e,t,r)=>{let o;return void 0===r?r=t:void 0!==t&&(o=t),t=>{if(!(t instanceof NodePart))throw new Error("repeat can only be used in text bindings");const i=Wr.get(t)||[],n=Qr.get(t)||[],s=[],a=[],l=[];let c,d,u=0;for(const t of e)l[u]=o?o(t,u):u,a[u]=r(t,u),u++;let h=0,p=i.length-1,f=0,g=a.length-1;for(;h<=p&&f<=g;)if(null===i[h])h++;else if(null===i[p])p--;else if(n[h]===l[f])s[f]=updatePart(i[h],a[f]),h++,f++;else if(n[p]===l[g])s[g]=updatePart(i[p],a[g]),p--,g--;else if(n[h]===l[g])s[g]=updatePart(i[h],a[g]),insertPartBefore(t,i[h],s[g+1]),h++,g--;else if(n[p]===l[f])s[f]=updatePart(i[p],a[f]),insertPartBefore(t,i[p],i[h]),p--,f++;else if(void 0===c&&(c=generateMap(l,f,g),d=generateMap(n,h,p)),c.has(n[h]))if(c.has(n[p])){const e=d.get(l[f]),r=void 0!==e?i[e]:null;if(null===r){const e=createAndInsertPart(t,i[h]);updatePart(e,a[f]),s[f]=e}else s[f]=updatePart(r,a[f]),insertPartBefore(t,r,i[h]),i[e]=null;f++}else removePart(i[p]),p--;else removePart(i[h]),h++;for(;f<=g;){const e=createAndInsertPart(t,s[g+1]);updatePart(e,a[f]),s[f++]=e}for(;h<=p;){const e=i[h++];null!==e&&removePart(e)}Wr.set(t,s),Qr.set(t,l)}})),Jr=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family);color:var(--color,#000);font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}
`];var __decorate$q=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$s=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};let Zr=class MgtPeople extends MgtTemplatedComponent{constructor(){super(),this.personCardInteraction=Hr.hover,this.scopes=[],this._version="v1.0",this.showMax=3}static get styles(){return Jr}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(e){arraysAreEqual(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}get peopleQueries(){return this._peopleQueries}set peopleQueries(e){arraysAreEqual(this._peopleQueries,e)||(this._peopleQueries=e,this.requestStateUpdate(!0))}get resource(){return this._resource}set resource(e){this._resource!==e&&(this._resource=e,this.requestStateUpdate(!0))}get version(){return this._version}set version(e){this._version!==e&&(this._version=e,this.requestStateUpdate(!0))}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...Gr.requiredScopes])]}clearState(){this.people=null}requestStateUpdate(e){return e&&(this.people=null),super.requestStateUpdate(e)}render(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||html$1``}renderPeople(){const e=this.people.slice(0,this.showMax).filter((e=>e));return html$1`
      <ul class="people-list" aria-label="people">
        ${Yr(e,(e=>e.id?e.id:e.displayName),(e=>html$1`
            <li class="people-person">
              ${this.renderPerson(e)}
            </li>
          `))}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){const e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||html$1`
        <li tabindex=0 aria-label="and ${e} more attendees" class="overflow"><span>+${e}<span></li>
      `}renderPerson(e){let t={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]);return this.renderTemplate("person",{person:e},e.id)||html$1`
        <mgt-person
          .personDetails=${e}
          .fetchImage=${!0}
          .avatarSize=${"small"}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${t}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||html$1``}loadState(){return __awaiter$s(this,void 0,void 0,(function*(){if(!this.people){const e=Providers.globalProvider;if(e&&e.state===or.SignedIn){const t=e.graph.forComponent(this);this.groupId?this.people=yield findGroupMembers(t,null,this.groupId,this.showMax,Dr.person):this.userIds||this.peopleQueries?(this.userIds?this.people=yield getUsersForUserIds(t,this.userIds):this.people=yield function getUsersForPeopleQueries(e,t){return __awaiter$x(this,void 0,void 0,(function*(){if(!t||0===t.length)return[];const r=e.createBatch(),o=[];let i,n;getIsUsersCacheEnabled()&&(n=CacheService.getCache(Ir,Ir.stores.usersQuery));for(const e of t)getIsUsersCacheEnabled()&&(i=yield n.getValue(e)),getIsUsersCacheEnabled()&&i&&getUserInvalidationTime()>Date.now()-i.timeCached?o.push(JSON.parse(i.results[0])):""!==e&&r.get(e,`/me/people?$search="${e}"`,["people.read"]);try{const e=yield r.executeAll();for(const r of t){const t=e.get(r);t&&t.content&&t.content.value&&t.content.value.length>0?(o.push(t.content.value[0]),getIsUsersCacheEnabled()&&n.putValue(r,{maxResults:1,results:[JSON.stringify(t.content.value[0])]})):o.push(null)}return o}catch(r){try{return Promise.all(t.filter((e=>e&&""!==e)).map((t=>__awaiter$x(this,void 0,void 0,(function*(){const r=yield findPeople(e,t,1);if(r&&r.length)return getIsUsersCacheEnabled()&&n.putValue(t,{maxResults:1,results:[JSON.stringify(r[0])]}),r[0]})))))}catch(e){return[]}}}))}(t,this.peopleQueries),this._fallbackDetails&&(this.people=this.people.map(((e,t)=>e||(t<this._fallbackDetails.length?this._fallbackDetails[t]:null))))):this.resource?this.people=yield function getPeopleFromResource(e,t,r,o){return __awaiter$y(this,void 0,void 0,(function*(){let i;const n=`${t}${r}`;if(getIsPeopleCacheEnabled()){i=CacheService.getCache(Ar,Ar.stores.peopleQuery);const e=yield i.getValue(n);if(e&&getPeopleInvalidationTime()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}let s=e.api(r).version(t);o&&o.length&&(s=s.middlewareOptions(prepScopes(...o)));let a=yield s.get();if(a&&Array.isArray(a.value)&&a["@odata.nextLink"]){let r=a;for(;r&&r["@odata.nextLink"];){const o=r["@odata.nextLink"].split(t)[1];r=yield e.client.api(o).version(t).get(),r&&r.value&&r.value.length&&(r.value=a.value.concat(r.value),a=r)}}if(getIsPeopleCacheEnabled()&&a){const e={results:null};Array.isArray(a.value)?e.results=a.value.map((e=>JSON.stringify(e))):e.results=[JSON.stringify(a)],i.putValue(n,e)}return a?Array.isArray(a.value)?a.value:[a]:null}))}(t,this.version,this.resource,this.scopes):this.people=yield getPeople(t),this.showPresence?this._peoplePresence=yield function getUsersPresenceByPeople(e,t){return __awaiter$v(this,void 0,void 0,(function*(){if(!t||0===t.length)return{};const r={},o=[],i=["presence.read.all"];let n;getIsPresenceCacheEnabled()&&(n=CacheService.getCache(Er,Er.stores.presence));for(const e of t)if(""!==e&&e.id){const t=e.id;let i;r[t]=null,getIsPresenceCacheEnabled()&&(i=yield n.getValue(t)),getIsPresenceCacheEnabled()&&i&&getPresenceInvalidationTime()>Date.now()-(yield i).timeCached?r[t]=JSON.parse(i.presence):o.push(t)}try{if(o.length>0){const t=yield e.api("/communications/getPresencesByUserId").middlewareOptions(prepScopes(...i)).post({ids:o});for(const e of t.value)r[e.id]=e,getIsPresenceCacheEnabled()&&n.putValue(e.id,{presence:JSON.stringify(e)})}return r}catch(o){try{const o=yield Promise.all(t.filter((e=>e&&e.id&&!r[e.id]&&"personType"in e&&"OrganizationUser"===e.personType.subclass)).map((t=>getUserPresence(e,t.id))));for(const e of o)r[e.id]=e;return r}catch(e){return null}}}))}(t,this.people):this._peoplePresence=null}}}))}};__decorate$q([property({attribute:"group-id",type:String}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[Object])],Zr.prototype,"groupId",null),__decorate$q([property({attribute:"user-ids",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),__metadata$p("design:type",Array),__metadata$p("design:paramtypes",[Array])],Zr.prototype,"userIds",null),__decorate$q([property({attribute:"people",type:Object}),__metadata$p("design:type",Array)],Zr.prototype,"people",void 0),__decorate$q([property({attribute:"people-queries",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),__metadata$p("design:type",Array),__metadata$p("design:paramtypes",[Array])],Zr.prototype,"peopleQueries",null),__decorate$q([property({attribute:"show-max",type:Number}),__metadata$p("design:type",Number)],Zr.prototype,"showMax",void 0),__decorate$q([property({attribute:"show-presence",type:Boolean}),__metadata$p("design:type",Boolean)],Zr.prototype,"showPresence",void 0),__decorate$q([property({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),void 0===Hr[e]?Hr.hover:Hr[e])}),__metadata$p("design:type",Number)],Zr.prototype,"personCardInteraction",void 0),__decorate$q([property({attribute:"resource",type:String}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[Object])],Zr.prototype,"resource",null),__decorate$q([property({attribute:"version",type:String}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[Object])],Zr.prototype,"version",null),__decorate$q([property({attribute:"scopes",converter:e=>e?e.toLowerCase().split(","):null,reflect:!0}),__metadata$p("design:type",Array)],Zr.prototype,"scopes",void 0),__decorate$q([property({attribute:"fallback-details",type:Array}),__metadata$p("design:type",Array),__metadata$p("design:paramtypes",[Array])],Zr.prototype,"fallbackDetails",null),Zr=__decorate$q([customElement("mgt-people"),__metadata$p("design:paramtypes",[])],Zr);var __decorate$p=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$o=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$r=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};let Xr=class MgtAgenda extends MgtTemplatedComponent{constructor(){super(),this._days=3,this.onResize=this.onResize.bind(this)}static get styles(){return Kr}get date(){return this._date}set date(e){this._date!==e&&(this._date=e,this.reloadState())}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.reloadState())}get days(){return this._days}set days(e){this._days!==e&&(this._days=e,this.reloadState())}get eventQuery(){return this._eventQuery}set eventQuery(e){this._eventQuery!==e&&(this._eventQuery=e,this.reloadState())}get preferredTimezone(){return this._preferredTimezone}set preferredTimezone(e){this._preferredTimezone!==e&&(this._preferredTimezone=e,this.reloadState())}static get requiredScopes(){return[...new Set(["calendars.read",...Zr.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();const e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});return t||(this._isNarrow=this.offsetWidth<600,html$1`
      <div dir=${this.direction} class="agenda${this._isNarrow?" narrow":""}${this.groupByDay?" grouped":""}">
        ${this.groupByDay?this.renderGroups(e):this.renderEvents(e)}
        ${this.isLoadingState?this.renderLoading():html$1``}
      </div>
    `)}reload(){return __awaiter$r(this,void 0,void 0,(function*(){this.events=yield this.loadEvents()}))}renderLoading(){return this.renderTemplate("loading",null)||html$1`
        <div class="event">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </div>
      `}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||html$1``}renderEvent(e){return html$1`
      <div class="event">
        <div class="event-time-container">
          <div class="event-time" aria-label="${this.getEventTimeString(e)}">${this.getEventTimeString(e)}</div>
        </div>
        <div class="event-details-container">
          ${this.renderTitle(e)} ${this.renderLocation(e)} ${this.renderAttendees(e)}
        </div>
        <div class="event-other-container">${this.renderOther(e)}</div>
      </div>
    `}renderHeader(e){return this.renderTemplate("header",{header:e},"header-"+e)||html$1`
        <div class="header" aria-label="${e}">${e}</div>
      `}renderTitle(e){return html$1`
      <div aria-label=${e.subject} class="event-subject">${e.subject}</div>
    `}renderLocation(e){return e.location.displayName?html$1`
      <div class="event-location-container">
        <div class="event-location-icon">${getSvg($r.OfficeLocation)}</div>
        <div class="event-location" aria-label="${e.location.displayName}">${e.location.displayName}</div>
      </div>
    `:null}renderAttendees(e){return e.attendees.length?html$1`
      <mgt-people
        class="event-attendees"
        .peopleQueries=${e.attendees.map((e=>e.emailAddress.address))}
      ></mgt-people>
    `:null}renderOther(e){return this.hasTemplate("event-other")?html$1`
          ${this.renderTemplate("event-other",{event:e},e.id+"-other")}
        `:null}renderGroups(e){const t={};return e.forEach((e=>{var r=new Date(e.start.dateTime).toISOString().replace("Z","");const o=this.getDateHeaderFromDateTimeString(r);t[o]=t[o]||[],t[o].push(e)})),html$1`
      ${Object.keys(t).map((e=>html$1`
            <div class="group">${this.renderHeader(e)} ${this.renderEvents(t[e])}</div>
          `))}
    `}renderEvents(e){return html$1`
      <ul class="agenda-list">
        ${e.map((e=>html$1`
              <li @click=${()=>this.eventClicked(e)}>
                ${this.renderTemplate("event",{event:e},e.id)||this.renderEvent(e)}
              </li>
            `))}
      </ul>
    `}loadState(){return __awaiter$r(this,void 0,void 0,(function*(){if(this.events)return;const e=yield this.loadEvents();e&&e.length>0&&(this.events=e)}))}reloadState(){return __awaiter$r(this,void 0,void 0,(function*(){this.events=null,this.requestStateUpdate(!0)}))}onResize(){this._isNarrow=this.offsetWidth<600}eventClicked(e){this.fireCustomEvent("eventClick",{event:e})}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";let t=e.start.dateTime;"UTC"===e.start.timeZone&&(t+="Z");let r=e.end.dateTime;"UTC"===e.end.timeZone&&(r+="Z");return`${this.prettyPrintTimeFromDateTime(new Date(t))} - ${this.prettyPrintTimeFromDateTime(new Date(r))}`}loadEvents(){return __awaiter$r(this,void 0,void 0,(function*(){const e=Providers.globalProvider;let t=[];if(e&&e.state===or.SignedIn){const r=e.graph.forComponent(this);if(this.eventQuery)try{const e=this.eventQuery.split("|");let o,i;e.length>1?(i=e[0].trim(),o=e[1].trim()):i=this.eventQuery;let n=yield r.api(i);o&&(n=n.middlewareOptions(prepScopes(o))),this.preferredTimezone&&(n=n.header("Prefer",`outlook.timezone="${this.preferredTimezone}"`));const s=yield n.get();s&&s.value&&(t=s.value)}catch(e){}else{const e=this.date?new Date(this.date):new Date;e.setHours(0,0,0,0);const o=new Date(e.getTime());o.setDate(e.getDate()+this.days);try{const i=yield function getEventsPageIterator(e,t,r,o,i){let n;n=o?`groups/${o}/calendar`:"me",n+=`/calendarview?startdatetime=${t.toISOString()}&enddatetime=${r.toISOString()}`;let s=e.api(n).middlewareOptions(prepScopes("calendars.read")).orderby("start/dateTime");return i&&(s=s.header("Prefer",`outlook.timezone="${i}"`)),GraphPageIterator.create(e,s)}(r,e,o,this.groupId,this.preferredTimezone);if(i&&i.value)for(t=i.value;i.hasNext;)yield i.next(),t=i.value}catch(e){}}}return t}))}prettyPrintTimeFromDateTime(e){this.preferredTimezone||e.setMinutes(e.getMinutes()-e.getTimezoneOffset());let t=e.getHours();const r=e.getMinutes(),o=t>=12?"PM":"AM";t%=12,t=t||12;return`${t}:${r<10?"0"+r:r} ${o}`}getDateHeaderFromDateTimeString(e){const t=new Date(e);t.setMinutes(t.getMinutes()-t.getTimezoneOffset());const r=t.getDay(),o=t.getMonth(),i=t.getDate(),n=t.getFullYear();return`${function getDayOfWeekString(e){switch(e){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return"Day"}}(r)}, ${getMonthString(o)} ${i}, ${n}`}getEventDuration(e){let t=new Date(e.start.dateTime);const r=new Date(e.end.dateTime),o=new Date;let i="";o>t&&(t=o);const n=r.getTime()-t.getTime(),s=Math.round(n/6e4);if(s>1440||e.isAllDay)i=Math.ceil(s/1440)+"d";else if(s>60){i=Math.round(s/60)+"h";const e=s%60;e&&(i+=e+"m")}else i=s+"m";return i}};__decorate$p([property({attribute:"date",type:String}),__metadata$o("design:type",String),__metadata$o("design:paramtypes",[Object])],Xr.prototype,"date",null),__decorate$p([property({attribute:"group-id",type:String}),__metadata$o("design:type",String),__metadata$o("design:paramtypes",[Object])],Xr.prototype,"groupId",null),__decorate$p([property({attribute:"days",type:Number}),__metadata$o("design:type",Number),__metadata$o("design:paramtypes",[Object])],Xr.prototype,"days",null),__decorate$p([property({attribute:"event-query",type:String}),__metadata$o("design:type",String),__metadata$o("design:paramtypes",[Object])],Xr.prototype,"eventQuery",null),__decorate$p([property({attribute:"events",type:Array}),__metadata$o("design:type",Array)],Xr.prototype,"events",void 0),__decorate$p([property({attribute:"show-max",type:Number}),__metadata$o("design:type",Number)],Xr.prototype,"showMax",void 0),__decorate$p([property({attribute:"group-by-day",type:Boolean}),__metadata$o("design:type",Boolean)],Xr.prototype,"groupByDay",void 0),__decorate$p([property({attribute:"preferred-timezone",type:String}),__metadata$o("design:type",String),__metadata$o("design:paramtypes",[Object])],Xr.prototype,"preferredTimezone",null),__decorate$p([property({attribute:!1}),__metadata$o("design:type",Boolean)],Xr.prototype,"_isNarrow",void 0),Xr=__decorate$p([customElement("mgt-agenda"),__metadata$o("design:paramtypes",[])],Xr);const eo=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}:host{font-family:var(--font-family,var(--default-font-family))}:host .item,mgt-file .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(background-color,#fff)}:host .item__file-type-icon,mgt-file .item__file-type-icon{padding:16px;width:var(--file-type-icon-size,28px);min-width:var(--file-type-icon-size,28px);height:var(--file-type-icon-size,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img,mgt-file .item__file-type-icon img{height:var(--file-type-icon-size,28px);width:var(--file-type-icon-size,28px)}:host .item__details,mgt-file .item__details{padding:10px 0}:host .item__details .line1,mgt-file .item__details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,400);text-transform:var(text-transform,none);line-height:20px;color:var(--color-sub1,#323130)}:host .item__details .line2,mgt-file .item__details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:16px}:host .item__details .line3,mgt-file .item__details .line3{color:var(--line3-color,var(--color-sub1,#323130));font-size:var(--line3-font-size,var(--size-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:16px}[dir=rtl] .item__details{direction:ltr}
`];var __awaiter$q=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};function clearFilesCache(){let e;e=CacheService.getCache(Nr,Nr.stores.fileLists),e.clearStore()}const getFileInvalidationTime=()=>CacheService.config.files.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsFilesCacheEnabled=()=>CacheService.config.files.isEnabled&&CacheService.config.isEnabled,getIsFileListsCacheEnabled=()=>CacheService.config.fileLists.isEnabled&&CacheService.config.isEnabled;function getDriveItemByQuery(e,t){return __awaiter$q(this,void 0,void 0,(function*(){let r;r=CacheService.getCache(Or,Or.stores.fileQueries);const o=yield getFileFromCache(r,t);if(o)return o;let i;try{i=yield e.api(t).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&r.putValue(t,{file:JSON.stringify(i)})}catch(e){}return i||null}))}function getDriveItemsByInsights(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){if(!t)return[];const o=t.value,i=e.createBatch(),n=[];for(const e of o){const t=e.resourceReference.id;""!==t&&i.get(t,t,r)}try{const e=yield i.executeAll();for(const t of o){const r=e.get(t.resourceReference.id);r&&r.content&&n.push(r.content)}return n}catch(t){try{return Promise.all(o.filter((e=>e.resourceReference.id&&""!==e.resourceReference.id)).map((t=>__awaiter$q(this,void 0,void 0,(function*(){const o=yield e.api(t.resourceReference.id).middlewareOptions(prepScopes(...r)).get();if(o&&o.length)return o[0].content})))))}catch(e){return[]}}}))}function getFilesPageIteratorFromRequest(e,t){return __awaiter$q(this,void 0,void 0,(function*(){return GraphPageIterator.create(e,t)}))}function getFilesPageIteratorFromCache(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){return GraphPageIterator.createFromValue(e,t,r)}))}function getFileFromCache(e,t){return __awaiter$q(this,void 0,void 0,(function*(){if(getIsFilesCacheEnabled()){const r=yield e.getValue(t);if(r&&getFileInvalidationTime()>Date.now()-r.timeCached){return JSON.parse(r.file)}}return null}))}function getFileListFromCache(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){if(e||(e=CacheService.getCache(Nr,t)),getIsFileListsCacheEnabled()){const t=yield e.getValue(r);if(t&&(CacheService.config.fileLists.invalidationPeriod||CacheService.config.defaultInvalidationPeriod)>Date.now()-t.timeCached)return t}return null}))}function fetchNextAndCacheForFilesPageIterator(e){return __awaiter$q(this,void 0,void 0,(function*(){const t=e._nextLink;if(e.hasNext&&(yield e.next()),getIsFileListsCacheEnabled()){let r;r=CacheService.getCache(Nr,Nr.stores.fileLists);const o=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(t)[3];r.putValue(o,{files:e.value,nextLink:e._nextLink})}}))}function sendFileChunck(e,t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){try{const n="files.readwrite",s={"Content-Length":r,"Content-Range":o};let a;try{a=yield e.client.api(t).middlewareOptions(prepScopes(n)).headers(s).put(i)}catch(e){}return a||null}catch(e){return null}}))}const to={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},ro="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types";const oo={modifiedSubtitle:"Modified",sizeSubtitle:"Size"};var __decorate$o=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$n=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$p=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};let io=class MgtFile extends MgtTemplatedComponent{constructor(){super(),this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view=Mr.threelines}static get styles(){return eo}get strings(){return oo}get fileQuery(){return this._fileQuery}set fileQuery(e){e!==this._fileQuery&&(this._fileQuery=e,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}get listId(){return this._listId}set listId(e){e!==this._listId&&(this._listId=e,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(e){e!==this._insightId&&(this._insightId=e,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(e){e!==this._fileDetails&&(this._fileDetails=e,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(e){e!==this._fileIcon&&(this._fileIcon=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();const e=this.driveItem;let t;if(t=this.renderTemplate("default",{file:e}),!t){const r=this.renderDetails(e),o=this.renderFileTypeIcon();t=html$1`
        <div class="item">
          ${o} ${r}
        </div>
      `}return html$1`
      <span dir=${this.direction}>
        ${t}
      </span>
    `}renderLoading(){return this.renderTemplate("loading",null)||html$1``}renderNoData(){return this.renderTemplate("no-data",null)||html$1``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return html$1``;let e;if(this.fileIcon)e=this.fileIcon;else{const t=/(?:\.([^.]+))?$/;e=function getFileTypeIconUriByExtension(e,t,r){return Object.keys(to).find((t=>to[t]===e))?`${ro}/${t.toString()}/${e}.${r}`:"jpg"===e||"png"===e?(e="photo",`${ro}/${t.toString()}/${e}.${r}`):null}(void 0===this.driveItem.package&&void 0===this.driveItem.folder?t.exec(this.driveItem.name)[1]?t.exec(this.driveItem.name)[1].toLowerCase():"null":void 0!==this.driveItem.package&&"oneNote"===this.driveItem.package.type?"onetoc":"folder",48,"svg")}return html$1`
      <div class="item__file-type-icon">
        ${e?html$1`
              <img src=${e} alt="File icon" />
            `:html$1`
              ${getSvg($r.File)}
            `}
      </div>
    `}renderDetails(e){if(!e||this.view===Mr.image)return html$1``;const t=[];if(this.view>Mr.image){const r=this.getTextFromProperty(e,this.line1Property);r&&t.push(html$1`
          <div class="line1" aria-label="${r}">${r}</div>
        `)}if(this.view>Mr.oneline){const r=this.getTextFromProperty(e,this.line2Property);r&&t.push(html$1`
          <div class="line2" aria-label="${r}">${r}</div>
        `)}if(this.view>Mr.twolines){const r=this.getTextFromProperty(e,this.line3Property);r&&t.push(html$1`
          <div class="line3" aria-label="${r}">${r}</div>
        `)}return html$1`
      <div class="item__details">
        ${t}
      </div>
    `}loadState(){return __awaiter$p(this,void 0,void 0,(function*(){if(this.fileDetails)return void(this.driveItem=this.fileDetails);const e=Providers.globalProvider;if(!e||e.state===or.Loading)return;if(e.state===or.SignedOut)return void(this.driveItem=null);const t=e.graph.forComponent(this);let r;const o=!(this.driveId||this.siteId||this.groupId||this.listId||this.userId);this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?r=null:this.fileQuery?r=yield getDriveItemByQuery(t,this.fileQuery):this.itemId&&o?r=yield function getMyDriveItemById(e,t){return __awaiter$q(this,void 0,void 0,(function*(){const r=`/me/drive/items/${t}`;let o;o=CacheService.getCache(Or,Or.stores.userFiles);const i=yield getFileFromCache(o,r);if(i)return i;let n;try{n=yield e.api(r).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&o.putValue(r,{file:JSON.stringify(n)})}catch(e){}return n||null}))}(t,this.itemId):this.itemPath&&o?r=yield function getMyDriveItemByPath(e,t){return __awaiter$q(this,void 0,void 0,(function*(){const r=`/me/drive/root:/${t}`;let o;o=CacheService.getCache(Or,Or.stores.userFiles);const i=yield getFileFromCache(o,r);if(i)return i;let n;try{n=yield e.api(r).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&o.putValue(r,{file:JSON.stringify(n)})}catch(e){}return n||null}))}(t,this.itemPath):this.userId?this.itemId?r=yield function getUserDriveItemById(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/users/${t}/drive/items/${r}`;let i;i=CacheService.getCache(Or,Or.stores.userFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.userId,this.itemId):this.itemPath?r=yield function getUserDriveItemByPath(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/users/${t}/drive/root:/${r}`;let i;i=CacheService.getCache(Or,Or.stores.userFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.userId,this.itemPath):this.insightType&&this.insightId&&(r=yield function getUserInsightsDriveItemById(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/users/${t}/insights/${r}/${o}/resource`;let n;n=CacheService.getCache(Or,Or.stores.insightFiles);const s=yield getFileFromCache(n,i);if(s)return s;let a;try{a=yield e.api(i).middlewareOptions(prepScopes("sites.read.all")).get(),getIsFilesCacheEnabled()&&n.putValue(i,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(t,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?r=yield function getDriveItemById(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/drives/${t}/items/${r}`;let i;i=CacheService.getCache(Or,Or.stores.driveFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.driveId,this.itemId):this.itemPath&&(r=yield function getDriveItemByPath(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/drives/${t}/root:/${r}`;let i;i=CacheService.getCache(Or,Or.stores.driveFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?r=yield function getSiteDriveItemById(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/sites/${t}/drive/items/${r}`;let i;i=CacheService.getCache(Or,Or.stores.siteFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.siteId,this.itemId):this.itemPath&&(r=yield function getSiteDriveItemByPath(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/sites/${t}/drive/root:/${r}`;let i;i=CacheService.getCache(Or,Or.stores.siteFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.siteId,this.itemPath)):this.listId?r=yield function getListDriveItemById(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/sites/${t}/lists/${r}/items/${o}/driveItem`;let n;n=CacheService.getCache(Or,Or.stores.siteFiles);const s=yield getFileFromCache(n,i);if(s)return s;let a;try{a=yield e.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&n.putValue(i,{file:JSON.stringify(a)})}catch(e){}return a||null}))}(t,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?r=yield function getGroupDriveItemById(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/groups/${t}/drive/items/${r}`;let i;i=CacheService.getCache(Or,Or.stores.groupFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.groupId,this.itemId):this.itemPath&&(r=yield function getGroupDriveItemByPath(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/groups/${t}/drive/root:/${r}`;let i;i=CacheService.getCache(Or,Or.stores.groupFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(r=yield function getMyInsightsDriveItemById(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/me/insights/${t}/${r}/resource`;let i;i=CacheService.getCache(Or,Or.stores.insightFiles);const n=yield getFileFromCache(i,o);if(n)return n;let s;try{s=yield e.api(o).middlewareOptions(prepScopes("sites.read.all")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(s)})}catch(e){}return s||null}))}(t,this.insightType,this.insightId)),this.driveItem=r}))}getTextFromProperty(e,t){if(!t||0===t.length)return null;const r=t.trim().split(",");let o,i=0;for(;!o&&i<r.length;){const t=r[i].trim();switch(t){case"size":let r;r=e.size?this.formatBytes(e.size):"0",o=`${this.strings.sizeSubtitle}: ${r}`;break;case"lastModifiedDateTime":let i,n;if(e.lastModifiedDateTime){i=getRelativeDisplayDate(new Date(e.lastModifiedDateTime)),n=`${this.strings.modifiedSubtitle} ${i}`}else n="";o=n;break;default:o=e[t]}i++}return o}formatBytes(e,t=2){if(0===e)return"0 Bytes";const r=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(r))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]}};__decorate$o([property({attribute:"file-query"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"fileQuery",null),__decorate$o([property({attribute:"site-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"siteId",null),__decorate$o([property({attribute:"drive-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"driveId",null),__decorate$o([property({attribute:"group-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"groupId",null),__decorate$o([property({attribute:"list-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"listId",null),__decorate$o([property({attribute:"user-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"userId",null),__decorate$o([property({attribute:"item-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"itemId",null),__decorate$o([property({attribute:"item-path"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"itemPath",null),__decorate$o([property({attribute:"insight-type"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"insightType",null),__decorate$o([property({attribute:"insight-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"insightId",null),__decorate$o([property({type:Object}),__metadata$n("design:type",Object),__metadata$n("design:paramtypes",[Object])],io.prototype,"fileDetails",null),__decorate$o([property({attribute:"file-icon"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],io.prototype,"fileIcon",null),__decorate$o([property({type:Object}),__metadata$n("design:type",Object)],io.prototype,"driveItem",void 0),__decorate$o([property({attribute:"line1-property"}),__metadata$n("design:type",String)],io.prototype,"line1Property",void 0),__decorate$o([property({attribute:"line2-property"}),__metadata$n("design:type",String)],io.prototype,"line2Property",void 0),__decorate$o([property({attribute:"line3-property"}),__metadata$n("design:type",String)],io.prototype,"line3Property",void 0),__decorate$o([property({attribute:"view",converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===Mr[e]?Mr.threelines:Mr[e]):Mr.threelines}),__metadata$n("design:type",Number)],io.prototype,"view",void 0),io=__decorate$o([customElement("mgt-file"),__metadata$n("design:paramtypes",[])],io);const no=[css$1`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host .file-upload-area-button{width:100%}:host .file-upload-area-button div{float:var(--file-upload-button-float,right);text-align:center;display:table;margin-top:39px;margin-right:16px;margin-left:16px}:host .file-upload-area-button fluent-button.file-upload-button{color:var(--file-upload-button-color,inherit);vertical-align:middle;display:table-cell;background-color:var(--file-upload-button-background-color,#f3f2f1);width:120px;height:32px;cursor:pointer;font-size:var(--default-font-size);font-family:var(--default-font-family);position:relative}:host .file-upload-area-button fluent-button.file-upload-button:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1))}:host .file-upload-area-button input{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}:host .file-upload-table{margin:var(--file-item-margin,0)}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;width:50%;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;top:12px;left:16px}:host .file-upload-table .file-upload-cell fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-left:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-button-color,var(--color,inherit))}:host .file-upload-table.upload{display:table;width:260px}:host .mgt-file-item{--file-background-color:transparent}:host .upload-icon{fill:var(--file-upload-button-color,var(--color,inherit));height:12px}:host .file-upload-Template{clear:both}:host .file-upload-Template .file-upload-folder-tab{padding-left:20px}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border,dashed #0078d4 1px);background-color:var(--file-upload-background-color,rgba(0,120,212,.1));position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;display:inline-block}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-content-background-color,#fff);margin:auto;padding:24px;width:294px;height:auto;margin-top:165px;font-size:var(--default-font-size);font-family:var(--default-font-family);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));line-height:20px}:host .file-upload-dialog .file-upload-dialog-content div{color:var(--file-upload-dialog-content-color,#323130)}:host .file-upload-dialog .file-upload-dialog-check-wrapper{margin-top:12px}:host .file-upload-dialog fluent-checkbox.file-upload-dialog-check{--neutral-fill-input-rest:$file-upload-dialog-content-color}:host .file-upload-dialog fluent-checkbox.file-upload-dialog-check span{color:var(--file-upload-dialog-content-color,#323130)}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{text-align:right}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-button-color,var(--color,inherit));padding-right:5px}:host .file-upload-dialog .file-upload-dialog-ok{height:32px;min-width:60px;border:1px solid var(--file-upload-dialog-primarybutton-background-color,#006cbe);background-color:var(--file-upload-dialog-primarybutton-background-color,#006cbe);color:var(--file-upload-dialog-primarybutton-color,#fff);font-size:var(--default-font-size);margin-right:5px}:host .file-upload-dialog .file-upload-dialog-cancel{height:32px;min-width:82px;border:1px solid #8a8886;background-color:var(--file-upload-dialog-content-background-color,#fff);color:var(--file-upload-dialog-content-color,#323130);font-size:var(--default-font-size)}:host .file-upload-dialog.visible{position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:var(--file-upload-dialog-background-color,rgba(0,0,0,.1));display:inline-block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-upload-dialog-success.focused,:host .file-upload-dialog-success:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1))}:host .file-upload-dialog-success.focused mgt-file,:host .file-upload-dialog-success:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-upload-dialog-success.selected,:host .file-upload-dialog-success:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-upload-dialog-success.selected mgt-file,:host .file-upload-dialog-success:active mgt-file{--file-background-color:$file-item-background-color--active}
`],so={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep file with new name?'},ao=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;try{return new Function("return this")()}catch(e){return{}}}();void 0===ao.trustedTypes&&(ao.trustedTypes={createPolicy:(e,t)=>t});const lo={configurable:!1,enumerable:!1,writable:!1};void 0===ao.FAST&&Reflect.defineProperty(ao,"FAST",Object.assign({value:Object.create(null)},lo));const co=ao.FAST;if(void 0===co.getById){const e=Object.create(null);Reflect.defineProperty(co,"getById",Object.assign({value(t,r){let o=e[t];return void 0===o&&(o=r?e[t]=r():null),o}},lo))}const uo=Object.freeze([]),ho=ao.FAST.getById(1,(()=>{const e=[],t=[];function throwFirstError(){if(t.length)throw t.shift()}function tryRunTask(e){try{e.call()}catch(e){t.push(e),setTimeout(throwFirstError,0)}}function process(){let t=0;for(;t<e.length;)if(tryRunTask(e[t]),t++,t>1024){for(let r=0,o=e.length-t;r<o;r++)e[r]=e[r+t];e.length-=t,t=0}e.length=0}return Object.freeze({enqueue:function enqueue(t){e.length<1&&ao.requestAnimationFrame(process),e.push(t)},process:process})})),po=ao.trustedTypes.createPolicy("fast-html",{createHTML:e=>e});let fo=po;const go=`fast-${Math.random().toString(36).substring(2,8)}`,mo=`${go}{`,vo=`}${go}`,bo=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(e){if(fo!==po)throw new Error("The HTML policy can only be set once.");fo=e},createHTML:e=>fo.createHTML(e),isMarker:e=>e&&8===e.nodeType&&e.data.startsWith(go),extractDirectiveIndexFromMarker:e=>parseInt(e.data.replace(`${go}:`,"")),createInterpolationPlaceholder:e=>`${mo}${e}${vo}`,createCustomAttributePlaceholder(e,t){return`${e}="${this.createInterpolationPlaceholder(t)}"`},createBlockPlaceholder:e=>`\x3c!--${go}:${e}--\x3e`,queueUpdate:ho.enqueue,processUpdates:ho.process,nextUpdate:()=>new Promise(ho.enqueue),setAttribute(e,t,r){null==r?e.removeAttribute(t):e.setAttribute(t,r)},setBooleanAttribute(e,t,r){r?e.setAttribute(t,""):e.removeAttribute(t)},removeChildNodes(e){for(let t=e.firstChild;null!==t;t=e.firstChild)e.removeChild(t)},createTemplateWalker:e=>document.createTreeWalker(e,133,null,!1)});class SubscriberSet{constructor(e,t){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=e,this.sub1=t}has(e){return void 0===this.spillover?this.sub1===e||this.sub2===e:-1!==this.spillover.indexOf(e)}subscribe(e){const t=this.spillover;if(void 0===t){if(this.has(e))return;if(void 0===this.sub1)return void(this.sub1=e);if(void 0===this.sub2)return void(this.sub2=e);this.spillover=[this.sub1,this.sub2,e],this.sub1=void 0,this.sub2=void 0}else{-1===t.indexOf(e)&&t.push(e)}}unsubscribe(e){const t=this.spillover;if(void 0===t)this.sub1===e?this.sub1=void 0:this.sub2===e&&(this.sub2=void 0);else{const r=t.indexOf(e);-1!==r&&t.splice(r,1)}}notify(e){const t=this.spillover,r=this.source;if(void 0===t){const t=this.sub1,o=this.sub2;void 0!==t&&t.handleChange(r,e),void 0!==o&&o.handleChange(r,e)}else for(let o=0,i=t.length;o<i;++o)t[o].handleChange(r,e)}}class PropertyChangeNotifier{constructor(e){this.subscribers={},this.sourceSubscribers=null,this.source=e}notify(e){var t;const r=this.subscribers[e];void 0!==r&&r.notify(e),null===(t=this.sourceSubscribers)||void 0===t||t.notify(e)}subscribe(e,t){var r;if(t){let r=this.subscribers[t];void 0===r&&(this.subscribers[t]=r=new SubscriberSet(this.source)),r.subscribe(e)}else this.sourceSubscribers=null!==(r=this.sourceSubscribers)&&void 0!==r?r:new SubscriberSet(this.source),this.sourceSubscribers.subscribe(e)}unsubscribe(e,t){var r;if(t){const r=this.subscribers[t];void 0!==r&&r.unsubscribe(e)}else null===(r=this.sourceSubscribers)||void 0===r||r.unsubscribe(e)}}const yo=co.getById(2,(()=>{const e=/(:|&&|\|\||if)/,t=new WeakMap,r=new WeakMap,o=bo.queueUpdate;let i,createArrayObserver=e=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function getNotifier(e){let r=e.$fastController||t.get(e);return void 0===r&&(Array.isArray(e)?r=createArrayObserver(e):t.set(e,r=new PropertyChangeNotifier(e))),r}function getAccessors(e){let t=r.get(e);if(void 0===t){let o=Reflect.getPrototypeOf(e);for(;void 0===t&&null!==o;)t=r.get(o),o=Reflect.getPrototypeOf(o);t=void 0===t?[]:t.slice(0),r.set(e,t)}return t}class DefaultObservableAccessor{constructor(e){this.name=e,this.field=`_${e}`,this.callback=`${e}Changed`}getValue(e){return void 0!==i&&i.watch(e,this.name),e[this.field]}setValue(e,t){const r=this.field,o=e[r];if(o!==t){e[r]=t;const i=e[this.callback];"function"==typeof i&&i.call(e,o,t),getNotifier(e).notify(this.name)}}}class BindingObserverImplementation extends SubscriberSet{constructor(e,t,r=!1){super(e,t),this.binding=e,this.isVolatileBinding=r,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(e,t){this.needsRefresh&&null!==this.last&&this.disconnect();const r=i;i=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;const o=this.binding(e,t);return i=r,o}disconnect(){if(null!==this.last){let e=this.first;for(;void 0!==e;)e.notifier.unsubscribe(this,e.propertyName),e=e.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(e,t){const r=this.last,o=getNotifier(e),n=null===r?this.first:{};if(n.propertySource=e,n.propertyName=t,n.notifier=o,o.subscribe(this,t),null!==r){if(!this.needsRefresh){let t;i=void 0,t=r.propertySource[r.propertyName],i=this,e===t&&(this.needsRefresh=!0)}r.next=n}this.last=n}handleChange(){this.needsQueue&&(this.needsQueue=!1,o(this))}call(){null!==this.last&&(this.needsQueue=!0,this.notify(this))}records(){let e=this.first;return{next:()=>{const t=e;return void 0===t?{value:void 0,done:!0}:(e=e.next,{value:t,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(e){createArrayObserver=e},getNotifier:getNotifier,track(e,t){void 0!==i&&i.watch(e,t)},trackVolatile(){void 0!==i&&(i.needsRefresh=!0)},notify(e,t){getNotifier(e).notify(t)},defineProperty(e,t){"string"==typeof t&&(t=new DefaultObservableAccessor(t)),getAccessors(e).push(t),Reflect.defineProperty(e,t.name,{enumerable:!0,get:function(){return t.getValue(this)},set:function(e){t.setValue(this,e)}})},getAccessors:getAccessors,binding(e,t,r=this.isVolatileBinding(e)){return new BindingObserverImplementation(e,t,r)},isVolatileBinding:t=>e.test(t.toString())})}));function observable(e,t){yo.defineProperty(e,t)}const wo=co.getById(3,(()=>{let e=null;return{get:()=>e,set(t){e=t}}}));class ExecutionContext{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return wo.get()}get isEven(){return this.index%2==0}get isOdd(){return this.index%2!=0}get isFirst(){return 0===this.index}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(e){wo.set(e)}}yo.defineProperty(ExecutionContext.prototype,"index"),yo.defineProperty(ExecutionContext.prototype,"length");const Co=Object.seal(new ExecutionContext);class HTMLDirective{constructor(){this.targetIndex=0}}class TargetedHTMLDirective extends HTMLDirective{constructor(){super(...arguments),this.createPlaceholder=bo.createInterpolationPlaceholder}}class AttachedBehaviorHTMLDirective extends HTMLDirective{constructor(e,t,r){super(),this.name=e,this.behavior=t,this.options=r}createPlaceholder(e){return bo.createCustomAttributePlaceholder(this.name,e)}createBehavior(e){return new this.behavior(e,this.options)}}function normalBind(e,t){this.source=e,this.context=t,null===this.bindingObserver&&(this.bindingObserver=yo.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(e,t))}function triggerBind(e,t){this.source=e,this.context=t,this.target.addEventListener(this.targetName,this)}function normalUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function contentUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null;const e=this.target.$fastView;void 0!==e&&e.isComposed&&(e.unbind(),e.needsBindOnly=!0)}function triggerUnbind(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function updateAttributeTarget(e){bo.setAttribute(this.target,this.targetName,e)}function updateBooleanAttributeTarget(e){bo.setBooleanAttribute(this.target,this.targetName,e)}function updateContentTarget(e){if(null==e&&(e=""),e.create){this.target.textContent="";let t=this.target.$fastView;void 0===t?t=e.create():this.target.$fastTemplate!==e&&(t.isComposed&&(t.remove(),t.unbind()),t=e.create()),t.isComposed?t.needsBindOnly&&(t.needsBindOnly=!1,t.bind(this.source,this.context)):(t.isComposed=!0,t.bind(this.source,this.context),t.insertBefore(this.target),this.target.$fastView=t,this.target.$fastTemplate=e)}else{const t=this.target.$fastView;void 0!==t&&t.isComposed&&(t.isComposed=!1,t.remove(),t.needsBindOnly?t.needsBindOnly=!1:t.unbind()),this.target.textContent=e}}function updatePropertyTarget(e){this.target[this.targetName]=e}function updateClassTarget(e){const t=this.classVersions||Object.create(null),r=this.target;let o=this.version||0;if(null!=e&&e.length){const i=e.split(/\s+/);for(let e=0,n=i.length;e<n;++e){const n=i[e];""!==n&&(t[n]=o,r.classList.add(n))}}if(this.classVersions=t,this.version=o+1,0!==o){o-=1;for(const e in t)t[e]===o&&r.classList.remove(e)}}class HTMLBindingDirective extends TargetedHTMLDirective{constructor(e){super(),this.binding=e,this.bind=normalBind,this.unbind=normalUnbind,this.updateTarget=updateAttributeTarget,this.isBindingVolatile=yo.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(e){if(this.originalTargetName=e,void 0!==e)switch(e[0]){case":":if(this.cleanedTargetName=e.substr(1),this.updateTarget=updatePropertyTarget,"innerHTML"===this.cleanedTargetName){const e=this.binding;this.binding=(t,r)=>bo.createHTML(e(t,r))}break;case"?":this.cleanedTargetName=e.substr(1),this.updateTarget=updateBooleanAttributeTarget;break;case"@":this.cleanedTargetName=e.substr(1),this.bind=triggerBind,this.unbind=triggerUnbind;break;default:this.cleanedTargetName=e,"class"===e&&(this.updateTarget=updateClassTarget)}}targetAtContent(){this.updateTarget=updateContentTarget,this.unbind=contentUnbind}createBehavior(e){return new BindingBehavior(e,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}}class BindingBehavior{constructor(e,t,r,o,i,n,s){this.source=null,this.context=null,this.bindingObserver=null,this.target=e,this.binding=t,this.isBindingVolatile=r,this.bind=o,this.unbind=i,this.updateTarget=n,this.targetName=s}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(e){ExecutionContext.setEvent(e);const t=this.binding(this.source,this.context);ExecutionContext.setEvent(null),!0!==t&&e.preventDefault()}}let ko=null;class CompilationContext{addFactory(e){e.targetIndex=this.targetIndex,this.behaviorFactories.push(e)}captureContentBinding(e){e.targetAtContent(),this.addFactory(e)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){ko=this}static borrow(e){const t=ko||new CompilationContext;return t.directives=e,t.reset(),ko=null,t}}function createAggregateBinding(e){if(1===e.length)return e[0];let t;const r=e.length,o=e.map((e=>"string"==typeof e?()=>e:(t=e.targetName||t,e.binding))),i=new HTMLBindingDirective(((e,t)=>{let i="";for(let n=0;n<r;++n)i+=o[n](e,t);return i}));return i.targetName=t,i}const To=vo.length;function parseContent(e,t){const r=t.split(mo);if(1===r.length)return null;const o=[];for(let t=0,i=r.length;t<i;++t){const i=r[t],n=i.indexOf(vo);let s;if(-1===n)s=i;else{const t=parseInt(i.substring(0,n));o.push(e.directives[t]),s=i.substring(n+To)}""!==s&&o.push(s)}return o}function compileAttributes(e,t,r=!1){const o=t.attributes;for(let i=0,n=o.length;i<n;++i){const s=o[i],a=s.value,l=parseContent(e,a);let c=null;null===l?r&&(c=new HTMLBindingDirective((()=>a)),c.targetName=s.name):c=createAggregateBinding(l),null!==c&&(t.removeAttributeNode(s),i--,n--,e.addFactory(c))}}function compileContent(e,t,r){const o=parseContent(e,t.textContent);if(null!==o){let i=t;for(let n=0,s=o.length;n<s;++n){const s=o[n],a=0===n?t:i.parentNode.insertBefore(document.createTextNode(""),i.nextSibling);"string"==typeof s?a.textContent=s:(a.textContent=" ",e.captureContentBinding(s)),i=a,e.targetIndex++,a!==t&&r.nextNode()}e.targetIndex--}}const _o=document.createRange();class HTMLView{constructor(e,t){this.fragment=e,this.behaviors=t,this.source=null,this.context=null,this.firstChild=e.firstChild,this.lastChild=e.lastChild}appendTo(e){e.appendChild(this.fragment)}insertBefore(e){if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{const t=e.parentNode,r=this.lastChild;let o,i=this.firstChild;for(;i!==r;)o=i.nextSibling,t.insertBefore(i,e),i=o;t.insertBefore(r,e)}}remove(){const e=this.fragment,t=this.lastChild;let r,o=this.firstChild;for(;o!==t;)r=o.nextSibling,e.appendChild(o),o=r;e.appendChild(t)}dispose(){const e=this.firstChild.parentNode,t=this.lastChild;let r,o=this.firstChild;for(;o!==t;)r=o.nextSibling,e.removeChild(o),o=r;e.removeChild(t);const i=this.behaviors,n=this.source;for(let e=0,t=i.length;e<t;++e)i[e].unbind(n)}bind(e,t){const r=this.behaviors;if(this.source!==e)if(null!==this.source){const o=this.source;this.source=e,this.context=t;for(let i=0,n=r.length;i<n;++i){const n=r[i];n.unbind(o),n.bind(e,t)}}else{this.source=e,this.context=t;for(let o=0,i=r.length;o<i;++o)r[o].bind(e,t)}}unbind(){if(null===this.source)return;const e=this.behaviors,t=this.source;for(let r=0,o=e.length;r<o;++r)e[r].unbind(t);this.source=null}static disposeContiguousBatch(e){if(0!==e.length){_o.setStartBefore(e[0].firstChild),_o.setEndAfter(e[e.length-1].lastChild),_o.deleteContents();for(let t=0,r=e.length;t<r;++t){const r=e[t],o=r.behaviors,i=r.source;for(let e=0,t=o.length;e<t;++e)o[e].unbind(i)}}}}class ViewTemplate{constructor(e,t){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=e,this.directives=t}create(e){if(null===this.fragment){let e;const t=this.html;if("string"==typeof t){e=document.createElement("template"),e.innerHTML=bo.createHTML(t);const r=e.content.firstElementChild;null!==r&&"TEMPLATE"===r.tagName&&(e=r)}else e=t;const r=function compileTemplate(e,t){const r=e.content;document.adoptNode(r);const o=CompilationContext.borrow(t);compileAttributes(o,e,!0);const i=o.behaviorFactories;o.reset();const n=bo.createTemplateWalker(r);let s;for(;s=n.nextNode();)switch(o.targetIndex++,s.nodeType){case 1:compileAttributes(o,s);break;case 3:compileContent(o,s,n);break;case 8:bo.isMarker(s)&&o.addFactory(t[bo.extractDirectiveIndexFromMarker(s)])}let a=0;(bo.isMarker(r.firstChild)||1===r.childNodes.length&&t.length)&&(r.insertBefore(document.createComment(""),r.firstChild),a=-1);const l=o.behaviorFactories;return o.release(),{fragment:r,viewBehaviorFactories:l,hostBehaviorFactories:i,targetOffset:a}}(e,this.directives);this.fragment=r.fragment,this.viewBehaviorFactories=r.viewBehaviorFactories,this.hostBehaviorFactories=r.hostBehaviorFactories,this.targetOffset=r.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}const t=this.fragment.cloneNode(!0),r=this.viewBehaviorFactories,o=new Array(this.behaviorCount),i=bo.createTemplateWalker(t);let n=0,s=this.targetOffset,a=i.nextNode();for(let e=r.length;n<e;++n){const e=r[n],t=e.targetIndex;for(;null!==a;){if(s===t){o[n]=e.createBehavior(a);break}a=i.nextNode(),s++}}if(this.hasHostBehaviors){const t=this.hostBehaviorFactories;for(let r=0,i=t.length;r<i;++r,++n)o[n]=t[r].createBehavior(e)}return new HTMLView(t,o)}render(e,t,r){"string"==typeof t&&(t=document.getElementById(t)),void 0===r&&(r=t);const o=this.create(r);return o.bind(e,Co),o.appendTo(t),o}}const So=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function html(e,...t){const r=[];let o="";for(let i=0,n=e.length-1;i<n;++i){const n=e[i];let s=t[i];if(o+=n,s instanceof ViewTemplate){const e=s;s=()=>e}if("function"==typeof s&&(s=new HTMLBindingDirective(s)),s instanceof TargetedHTMLDirective){const e=So.exec(n);null!==e&&(s.targetName=e[2])}s instanceof HTMLDirective?(o+=s.createPlaceholder(r.length),r.push(s)):o+=s}return o+=e[e.length-1],new ViewTemplate(o,r)}class ElementStyles{constructor(){this.targets=new WeakSet}addStylesTo(e){this.targets.add(e)}removeStylesFrom(e){this.targets.delete(e)}isAttachedTo(e){return this.targets.has(e)}withBehaviors(...e){return this.behaviors=null===this.behaviors?e:this.behaviors.concat(e),this}}function reduceStyles(e){return e.map((e=>e instanceof ElementStyles?reduceStyles(e.styles):[e])).reduce(((e,t)=>e.concat(t)),[])}function reduceBehaviors(e){return e.map((e=>e instanceof ElementStyles?e.behaviors:null)).reduce(((e,t)=>null===t?e:(null===e&&(e=[]),e.concat(t))),null)}ElementStyles.create=(()=>{if(bo.supportsAdoptedStyleSheets){const e=new Map;return t=>new AdoptedStyleSheetsStyles(t,e)}return e=>new StyleElementStyles(e)})();class AdoptedStyleSheetsStyles extends ElementStyles{constructor(e,t){super(),this.styles=e,this.styleSheetCache=t,this._styleSheets=void 0,this.behaviors=reduceBehaviors(e)}get styleSheets(){if(void 0===this._styleSheets){const e=this.styles,t=this.styleSheetCache;this._styleSheets=reduceStyles(e).map((e=>{if(e instanceof CSSStyleSheet)return e;let r=t.get(e);return void 0===r&&(r=new CSSStyleSheet,r.replaceSync(e),t.set(e,r)),r}))}return this._styleSheets}addStylesTo(e){e.adoptedStyleSheets=[...e.adoptedStyleSheets,...this.styleSheets],super.addStylesTo(e)}removeStylesFrom(e){const t=this.styleSheets;e.adoptedStyleSheets=e.adoptedStyleSheets.filter((e=>-1===t.indexOf(e))),super.removeStylesFrom(e)}}let Eo=0;class StyleElementStyles extends ElementStyles{constructor(e){super(),this.styles=e,this.behaviors=null,this.behaviors=reduceBehaviors(e),this.styleSheets=reduceStyles(e),this.styleClass=function getNextStyleClass(){return"fast-style-class-"+ ++Eo}()}addStylesTo(e){const t=this.styleSheets,r=this.styleClass;e=this.normalizeTarget(e);for(let o=0;o<t.length;o++){const i=document.createElement("style");i.innerHTML=t[o],i.className=r,e.append(i)}super.addStylesTo(e)}removeStylesFrom(e){const t=(e=this.normalizeTarget(e)).querySelectorAll(`.${this.styleClass}`);for(let r=0,o=t.length;r<o;++r)e.removeChild(t[r]);super.removeStylesFrom(e)}isAttachedTo(e){return super.isAttachedTo(this.normalizeTarget(e))}normalizeTarget(e){return e===document?document.body:e}}const Io={toView:e=>e?"true":"false",fromView:e=>null!=e&&"false"!==e&&!1!==e&&0!==e},xo={toView(e){if(null==e)return null;const t=1*e;return isNaN(t)?null:t.toString()},fromView(e){if(null==e)return null;const t=1*e;return isNaN(t)?null:t}};class AttributeDefinition{constructor(e,t,r=t.toLowerCase(),o="reflect",i){this.guards=new Set,this.Owner=e,this.name=t,this.attribute=r,this.mode=o,this.converter=i,this.fieldName=`_${t}`,this.callbackName=`${t}Changed`,this.hasCallback=this.callbackName in e.prototype,"boolean"===o&&void 0===i&&(this.converter=Io)}setValue(e,t){const r=e[this.fieldName],o=this.converter;void 0!==o&&(t=o.fromView(t)),r!==t&&(e[this.fieldName]=t,this.tryReflectToAttribute(e),this.hasCallback&&e[this.callbackName](r,t),e.$fastController.notify(this.name))}getValue(e){return yo.track(e,this.name),e[this.fieldName]}onAttributeChangedCallback(e,t){this.guards.has(e)||(this.guards.add(e),this.setValue(e,t),this.guards.delete(e))}tryReflectToAttribute(e){const t=this.mode,r=this.guards;r.has(e)||"fromView"===t||bo.queueUpdate((()=>{r.add(e);const o=e[this.fieldName];switch(t){case"reflect":const t=this.converter;bo.setAttribute(e,this.attribute,void 0!==t?t.toView(o):o);break;case"boolean":bo.setBooleanAttribute(e,this.attribute,o)}r.delete(e)}))}static collect(e,...t){const r=[];t.push(e.attributes);for(let o=0,i=t.length;o<i;++o){const i=t[o];if(void 0!==i)for(let t=0,o=i.length;t<o;++t){const o=i[t];"string"==typeof o?r.push(new AttributeDefinition(e,o)):r.push(new AttributeDefinition(e,o.property,o.attribute,o.mode,o.converter))}}return r}}function attr(e,t){let r;function decorator(e,t){arguments.length>1&&(r.property=t);const o=e.constructor.attributes||(e.constructor.attributes=[]);o.push(r)}return arguments.length>1?(r={},void decorator(e,t)):(r=void 0===e?{}:e,decorator)}const Ao={mode:"open"},Po={},Ro=co.getById(4,(()=>{const e=new Map;return Object.freeze({register:t=>!e.has(t.type)&&(e.set(t.type,t),!0),getByType:t=>e.get(t)})}));class FASTElementDefinition{constructor(e,t=e.definition){"string"==typeof t&&(t={name:t}),this.type=e,this.name=t.name,this.template=t.template;const r=AttributeDefinition.collect(e,t.attributes),o=new Array(r.length),i={},n={};for(let e=0,t=r.length;e<t;++e){const t=r[e];o[e]=t.attribute,i[t.name]=t,n[t.attribute]=t}this.attributes=r,this.observedAttributes=o,this.propertyLookup=i,this.attributeLookup=n,this.shadowOptions=void 0===t.shadowOptions?Ao:null===t.shadowOptions?void 0:Object.assign(Object.assign({},Ao),t.shadowOptions),this.elementOptions=void 0===t.elementOptions?Po:Object.assign(Object.assign({},Po),t.elementOptions),this.styles=void 0===t.styles?void 0:Array.isArray(t.styles)?ElementStyles.create(t.styles):t.styles instanceof ElementStyles?t.styles:ElementStyles.create([t.styles])}get isDefined(){return!!Ro.getByType(this.type)}define(e=customElements){const t=this.type;if(Ro.register(this)){const e=this.attributes,r=t.prototype;for(let t=0,o=e.length;t<o;++t)yo.defineProperty(r,e[t]);Reflect.defineProperty(t,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return e.get(this.name)||e.define(this.name,t,this.elementOptions),this}}FASTElementDefinition.forType=Ro.getByType;const Oo=new WeakMap,No={bubbles:!0,composed:!0,cancelable:!0};function getShadowRoot(e){return e.shadowRoot||Oo.get(e)||null}class Controller extends PropertyChangeNotifier{constructor(e,t){super(e),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=e,this.definition=t;const r=t.shadowOptions;if(void 0!==r){const t=e.attachShadow(r);"closed"===r.mode&&Oo.set(e,t)}const o=yo.getAccessors(e);if(o.length>0){const t=this.boundObservables=Object.create(null);for(let r=0,i=o.length;r<i;++r){const i=o[r].name,n=e[i];void 0!==n&&(delete e[i],t[i]=n)}}}get isConnected(){return yo.track(this,"isConnected"),this._isConnected}setIsConnected(e){this._isConnected=e,yo.notify(this,"isConnected")}get template(){return this._template}set template(e){this._template!==e&&(this._template=e,this.needsInitialization||this.renderTemplate(e))}get styles(){return this._styles}set styles(e){this._styles!==e&&(null!==this._styles&&this.removeStyles(this._styles),this._styles=e,this.needsInitialization||null===e||this.addStyles(e))}addStyles(e){const t=getShadowRoot(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.append(e);else if(!e.isAttachedTo(t)){const r=e.behaviors;e.addStylesTo(t),null!==r&&this.addBehaviors(r)}}removeStyles(e){const t=getShadowRoot(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.removeChild(e);else if(e.isAttachedTo(t)){const r=e.behaviors;e.removeStylesFrom(t),null!==r&&this.removeBehaviors(r)}}addBehaviors(e){const t=this.behaviors||(this.behaviors=new Map),r=e.length,o=[];for(let i=0;i<r;++i){const r=e[i];t.has(r)?t.set(r,t.get(r)+1):(t.set(r,1),o.push(r))}if(this._isConnected){const e=this.element;for(let t=0;t<o.length;++t)o[t].bind(e,Co)}}removeBehaviors(e,t=!1){const r=this.behaviors;if(null===r)return;const o=e.length,i=[];for(let n=0;n<o;++n){const o=e[n];if(r.has(o)){const e=r.get(o)-1;0===e||t?r.delete(o)&&i.push(o):r.set(o,e)}}if(this._isConnected){const e=this.element;for(let t=0;t<i.length;++t)i[t].unbind(e)}}onConnectedCallback(){if(this._isConnected)return;const e=this.element;this.needsInitialization?this.finishInitialization():null!==this.view&&this.view.bind(e,Co);const t=this.behaviors;if(null!==t)for(const[r]of t)r.bind(e,Co);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);const e=this.view;null!==e&&e.unbind();const t=this.behaviors;if(null!==t){const e=this.element;for(const[r]of t)r.unbind(e)}}onAttributeChangedCallback(e,t,r){const o=this.definition.attributeLookup[e];void 0!==o&&o.onAttributeChangedCallback(this.element,r)}emit(e,t,r){return!!this._isConnected&&this.element.dispatchEvent(new CustomEvent(e,Object.assign(Object.assign({detail:t},No),r)))}finishInitialization(){const e=this.element,t=this.boundObservables;if(null!==t){const r=Object.keys(t);for(let o=0,i=r.length;o<i;++o){const i=r[o];e[i]=t[i]}this.boundObservables=null}const r=this.definition;null===this._template&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():r.template&&(this._template=r.template||null)),null!==this._template&&this.renderTemplate(this._template),null===this._styles&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():r.styles&&(this._styles=r.styles||null)),null!==this._styles&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(e){const t=this.element,r=getShadowRoot(t)||t;null!==this.view?(this.view.dispose(),this.view=null):this.needsInitialization||bo.removeChildNodes(r),e&&(this.view=e.render(t,r,t))}static forCustomElement(e){const t=e.$fastController;if(void 0!==t)return t;const r=FASTElementDefinition.forType(e.constructor);if(void 0===r)throw new Error("Missing FASTElement definition.");return e.$fastController=new Controller(e,r)}}function createFASTElement(e){return class extends e{constructor(){super(),Controller.forCustomElement(this)}$emit(e,t,r){return this.$fastController.emit(e,t,r)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(e,t,r){this.$fastController.onAttributeChangedCallback(e,t,r)}}}const Do=Object.assign(createFASTElement(HTMLElement),{from:e=>createFASTElement(e),define:(e,t)=>new FASTElementDefinition(e,t).define().type});class CSSDirective{createCSS(){return""}createBehavior(){}}function collectStyles(e,t){const r=[];let o="";const i=[];for(let n=0,s=e.length-1;n<s;++n){o+=e[n];let s=t[n];if(s instanceof CSSDirective){const e=s.createBehavior();s=s.createCSS(),e&&i.push(e)}s instanceof ElementStyles||s instanceof CSSStyleSheet?(""!==o.trim()&&(r.push(o),o=""),r.push(s)):o+=s}return o+=e[e.length-1],""!==o.trim()&&r.push(o),{styles:r,behaviors:i}}function css(e,...t){const{styles:r,behaviors:o}=collectStyles(e,t),i=ElementStyles.create(r);return o.length&&i.withBehaviors(...o),i}class CSSPartial extends CSSDirective{constructor(e,t){super(),this.behaviors=t,this.css="";const r=e.reduce(((e,t)=>("string"==typeof t?this.css+=t:e.push(t),e)),[]);r.length&&(this.styles=ElementStyles.create(r))}createBehavior(){return this}createCSS(){return this.css}bind(e){this.styles&&e.$fastController.addStyles(this.styles),this.behaviors.length&&e.$fastController.addBehaviors(this.behaviors)}unbind(e){this.styles&&e.$fastController.removeStyles(this.styles),this.behaviors.length&&e.$fastController.removeBehaviors(this.behaviors)}}class RefBehavior{constructor(e,t){this.target=e,this.propertyName=t}bind(e){e[this.propertyName]=this.target}unbind(){}}function ref(e){return new AttachedBehaviorHTMLDirective("fast-ref",RefBehavior,e)}function when(e,t){const r="function"==typeof t?t:()=>t;return(t,o)=>e(t,o)?r(t,o):null}class SlottedBehavior extends class NodeObservationBehavior{constructor(e,t){this.target=e,this.options=t,this.source=null}bind(e){const t=this.options.property;this.shouldUpdate=yo.getAccessors(e).some((e=>e.name===t)),this.source=e,this.updateTarget(this.computeNodes()),this.shouldUpdate&&this.observe()}unbind(){this.updateTarget(uo),this.source=null,this.shouldUpdate&&this.disconnect()}handleEvent(){this.updateTarget(this.computeNodes())}computeNodes(){let e=this.getNodes();return void 0!==this.options.filter&&(e=e.filter(this.options.filter)),e}updateTarget(e){this.source[this.options.property]=e}}{constructor(e,t){super(e,t)}observe(){this.target.addEventListener("slotchange",this)}disconnect(){this.target.removeEventListener("slotchange",this)}getNodes(){return this.target.assignedNodes(this.options)}}function slotted(e){return"string"==typeof e&&(e={property:e}),new AttachedBehaviorHTMLDirective("fast-slotted",SlottedBehavior,e)}class StartEnd{handleStartContentChange(){this.startContainer.classList.toggle("start",this.start.assignedNodes().length>0)}handleEndContentChange(){this.endContainer.classList.toggle("end",this.end.assignedNodes().length>0)}}const endSlotTemplate=(e,t)=>html`
    <span
        part="end"
        ${ref("endContainer")}
        class=${e=>t.end?"end":void 0}
    >
        <slot name="end" ${ref("end")} @slotchange="${e=>e.handleEndContentChange()}">
            ${t.end||""}
        </slot>
    </span>
`,startSlotTemplate=(e,t)=>html`
    <span
        part="start"
        ${ref("startContainer")}
        class="${e=>t.start?"start":void 0}"
    >
        <slot
            name="start"
            ${ref("start")}
            @slotchange="${e=>e.handleStartContentChange()}"
        >
            ${t.start||""}
        </slot>
    </span>
`;html`
    <span part="end" ${ref("endContainer")}>
        <slot
            name="end"
            ${ref("end")}
            @slotchange="${e=>e.handleEndContentChange()}"
        ></slot>
    </span>
`,html`
    <span part="start" ${ref("startContainer")}>
        <slot
            name="start"
            ${ref("start")}
            @slotchange="${e=>e.handleStartContentChange()}"
        ></slot>
    </span>
`;const Lo=new Map;"metadata"in Reflect||(Reflect.metadata=function(e,t){return function(r){Reflect.defineMetadata(e,t,r)}},Reflect.defineMetadata=function(e,t,r){let o=Lo.get(r);void 0===o&&Lo.set(r,o=new Map),o.set(e,t)},Reflect.getOwnMetadata=function(e,t){const r=Lo.get(t);if(void 0!==r)return r.get(e)});class ResolverBuilder{constructor(e,t){this.container=e,this.key=t}instance(e){return this.registerResolver(0,e)}singleton(e){return this.registerResolver(1,e)}transient(e){return this.registerResolver(2,e)}callback(e){return this.registerResolver(3,e)}cachedCallback(e){return this.registerResolver(3,cacheCallbackResult(e))}aliasTo(e){return this.registerResolver(5,e)}registerResolver(e,t){const{container:r,key:o}=this;return this.container=this.key=void 0,r.registerResolver(o,new ResolverImpl(o,e,t))}}function cloneArrayWithPossibleProps(e){const t=e.slice(),r=Object.keys(e),o=r.length;let i;for(let n=0;n<o;++n)i=r[n],isArrayIndex(i)||(t[i]=e[i]);return t}const Mo=Object.freeze({none(e){throw Error(`${e.toString()} not registered, did you forget to add @singleton()?`)},singleton:e=>new ResolverImpl(e,1,e),transient:e=>new ResolverImpl(e,2,e)}),$o=Object.freeze({default:Object.freeze({parentLocator:()=>null,responsibleForOwnerRequests:!1,defaultResolver:Mo.singleton})}),Uo=new Map;function getParamTypes(e){return t=>Reflect.getOwnMetadata(e,t)}let Fo=null;const Ho=Object.freeze({createContainer:e=>new ContainerImpl(null,Object.assign({},$o.default,e)),findResponsibleContainer(e){const t=e.$$container$$;return t&&t.responsibleForOwnerRequests?t:Ho.findParentContainer(e)},findParentContainer(e){const t=new CustomEvent(Vo,{bubbles:!0,composed:!0,cancelable:!0,detail:{container:void 0}});return e.dispatchEvent(t),t.detail.container||Ho.getOrCreateDOMContainer()},getOrCreateDOMContainer:(e,t)=>e?e.$$container$$||new ContainerImpl(e,Object.assign({},$o.default,t,{parentLocator:Ho.findParentContainer})):Fo||(Fo=new ContainerImpl(null,Object.assign({},$o.default,t,{parentLocator:()=>null}))),getDesignParamtypes:getParamTypes("design:paramtypes"),getAnnotationParamtypes:getParamTypes("di:paramtypes"),getOrCreateAnnotationParamTypes(e){let t=this.getAnnotationParamtypes(e);return void 0===t&&Reflect.defineMetadata("di:paramtypes",t=[],e),t},getDependencies(e){let t=Uo.get(e);if(void 0===t){const r=e.inject;if(void 0===r){const r=Ho.getDesignParamtypes(e),o=Ho.getAnnotationParamtypes(e);if(void 0===r)if(void 0===o){const r=Object.getPrototypeOf(e);t="function"==typeof r&&r!==Function.prototype?cloneArrayWithPossibleProps(Ho.getDependencies(r)):[]}else t=cloneArrayWithPossibleProps(o);else if(void 0===o)t=cloneArrayWithPossibleProps(r);else{t=cloneArrayWithPossibleProps(r);let e,i=o.length;for(let r=0;r<i;++r)e=o[r],void 0!==e&&(t[r]=e);const n=Object.keys(o);let s;i=n.length;for(let e=0;e<i;++e)s=n[e],isArrayIndex(s)||(t[s]=o[s])}}else t=cloneArrayWithPossibleProps(r);Uo.set(e,t)}return t},defineProperty(e,t,r,o=!1){const i=`$di_${t}`;Reflect.defineProperty(e,t,{get:function(){let e=this[i];if(void 0===e){const n=this instanceof HTMLElement?Ho.findResponsibleContainer(this):Ho.getOrCreateDOMContainer();if(e=n.get(r),this[i]=e,o&&this instanceof Do){const o=this.$fastController,handleChange=()=>{Ho.findResponsibleContainer(this).get(r)!==this[i]&&(this[i]=e,o.notify(t))};o.subscribe({handleChange:handleChange},"isConnected")}}return e}})},createInterface(e,t){const r="function"==typeof e?e:t,o="string"==typeof e?e:e&&"friendlyName"in e&&e.friendlyName||Qo,i="string"!=typeof e&&(e&&"respectConnection"in e&&e.respectConnection||!1),Interface=function(e,t,r){if(null==e||void 0!==new.target)throw new Error(`No registration for interface: '${Interface.friendlyName}'`);if(t)Ho.defineProperty(e,t,Interface,i);else{Ho.getOrCreateAnnotationParamTypes(e)[r]=Interface}};return Interface.$isInterface=!0,Interface.friendlyName=null==o?"(anonymous)":o,null!=r&&(Interface.register=function(e,t){return r(new ResolverBuilder(e,null!=t?t:Interface))}),Interface.toString=function toString(){return`InterfaceSymbol<${Interface.friendlyName}>`},Interface},inject:(...e)=>function(t,r,o){if("number"==typeof o){const r=Ho.getOrCreateAnnotationParamTypes(t),i=e[0];void 0!==i&&(r[o]=i)}else if(r)Ho.defineProperty(t,r,e[0]);else{const r=o?Ho.getOrCreateAnnotationParamTypes(o.value):Ho.getOrCreateAnnotationParamTypes(t);let i;for(let t=0;t<e.length;++t)i=e[t],void 0!==i&&(r[t]=i)}},transient:e=>(e.register=function register(t){return Wo.transient(e,e).register(t)},e.registerInRequestor=!1,e),singleton:(e,t=qo)=>(e.register=function register(t){return Wo.singleton(e,e).register(t)},e.registerInRequestor=t.scoped,e)}),Bo=Ho.createInterface("Container");Ho.inject;const qo={scoped:!1};class ResolverImpl{constructor(e,t,r){this.key=e,this.strategy=t,this.state=r,this.resolving=!1}get $isResolver(){return!0}register(e){return e.registerResolver(this.key,this)}resolve(e,t){switch(this.strategy){case 0:return this.state;case 1:if(this.resolving)throw new Error(`Cyclic dependency found: ${this.state.name}`);return this.resolving=!0,this.state=e.getFactory(this.state).construct(t),this.strategy=0,this.resolving=!1,this.state;case 2:{const r=e.getFactory(this.state);if(null===r)throw new Error(`Resolver for ${String(this.key)} returned a null factory`);return r.construct(t)}case 3:return this.state(e,t,this);case 4:return this.state[0].resolve(e,t);case 5:return t.get(this.state);default:throw new Error(`Invalid resolver strategy specified: ${this.strategy}.`)}}getFactory(e){var t,r,o;switch(this.strategy){case 1:case 2:return e.getFactory(this.state);case 5:return null!==(o=null===(r=null===(t=e.getResolver(this.state))||void 0===t?void 0:t.getFactory)||void 0===r?void 0:r.call(t,e))&&void 0!==o?o:null;default:return null}}}function containerGetKey(e){return this.get(e)}function transformInstance(e,t){return t(e)}class FactoryImpl{constructor(e,t){this.Type=e,this.dependencies=t,this.transformers=null}construct(e,t){let r;return r=void 0===t?new this.Type(...this.dependencies.map(containerGetKey,e)):new this.Type(...this.dependencies.map(containerGetKey,e),...t),null==this.transformers?r:this.transformers.reduce(transformInstance,r)}registerTransformer(e){(this.transformers||(this.transformers=[])).push(e)}}const zo={$isResolver:!0,resolve:(e,t)=>t};function isRegistry(e){return"function"==typeof e.register}function isRegisterInRequester(e){return function isSelfRegistry(e){return isRegistry(e)&&"boolean"==typeof e.registerInRequestor}(e)&&e.registerInRequestor}const jo=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]),Vo="__DI_LOCATE_PARENT__",Go=new Map;class ContainerImpl{constructor(e,t){this.owner=e,this.config=t,this._parent=void 0,this.registerDepth=0,this.context=null,null!==e&&(e.$$container$$=this),this.resolvers=new Map,this.resolvers.set(Bo,zo),e instanceof Node&&e.addEventListener(Vo,(e=>{e.composedPath()[0]!==this.owner&&(e.detail.container=this,e.stopImmediatePropagation())}))}get parent(){return void 0===this._parent&&(this._parent=this.config.parentLocator(this.owner)),this._parent}get depth(){return null===this.parent?0:this.parent.depth+1}get responsibleForOwnerRequests(){return this.config.responsibleForOwnerRequests}registerWithContext(e,...t){return this.context=e,this.register(...t),this.context=null,this}register(...e){if(100==++this.registerDepth)throw new Error("Unable to autoregister dependency");let t,r,o,i,n;const s=this.context;for(let a=0,l=e.length;a<l;++a)if(t=e[a],isObject(t))if(isRegistry(t))t.register(this,s);else if(void 0!==t.prototype)Wo.singleton(t,t).register(this);else for(r=Object.keys(t),i=0,n=r.length;i<n;++i)o=t[r[i]],isObject(o)&&(isRegistry(o)?o.register(this,s):this.register(o));return--this.registerDepth,this}registerResolver(e,t){validateKey(e);const r=this.resolvers,o=r.get(e);return null==o?r.set(e,t):o instanceof ResolverImpl&&4===o.strategy?o.state.push(t):r.set(e,new ResolverImpl(e,4,[o,t])),t}registerTransformer(e,t){const r=this.getResolver(e);if(null==r)return!1;if(r.getFactory){const e=r.getFactory(this);return null!=e&&(e.registerTransformer(t),!0)}return!1}getResolver(e,t=!0){if(validateKey(e),void 0!==e.resolve)return e;let r,o=this;for(;null!=o;){if(r=o.resolvers.get(e),null!=r)return r;if(null==o.parent){const r=isRegisterInRequester(e)?this:o;return t?this.jitRegister(e,r):null}o=o.parent}return null}has(e,t=!1){return!!this.resolvers.has(e)||!(!t||null==this.parent)&&this.parent.has(e,!0)}get(e){if(validateKey(e),e.$isResolver)return e.resolve(this,this);let t,r=this;for(;null!=r;){if(t=r.resolvers.get(e),null!=t)return t.resolve(r,this);if(null==r.parent){const o=isRegisterInRequester(e)?this:r;return t=this.jitRegister(e,o),t.resolve(r,this)}r=r.parent}throw new Error(`Unable to resolve key: ${e}`)}getAll(e,t=!1){validateKey(e);const r=this;let o,i=r;if(t){let t=uo;for(;null!=i;)o=i.resolvers.get(e),null!=o&&(t=t.concat(buildAllResponse(o,i,r))),i=i.parent;return t}for(;null!=i;){if(o=i.resolvers.get(e),null!=o)return buildAllResponse(o,i,r);if(i=i.parent,null==i)return uo}return uo}getFactory(e){let t=Go.get(e);if(void 0===t){if(Yo(e))throw new Error(`${e.name} is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.`);Go.set(e,t=new FactoryImpl(e,Ho.getDependencies(e)))}return t}registerFactory(e,t){Go.set(e,t)}createChild(e){return new ContainerImpl(null,Object.assign({},this.config,e,{parentLocator:()=>this}))}jitRegister(e,t){if("function"!=typeof e)throw new Error(`Attempted to jitRegister something that is not a constructor: '${e}'. Did you forget to register this dependency?`);if(jo.has(e.name))throw new Error(`Attempted to jitRegister an intrinsic type: ${e.name}. Did you forget to add @inject(Key)`);if(isRegistry(e)){const r=e.register(t);if(!(r instanceof Object)||null==r.resolve){const r=t.resolvers.get(e);if(null!=r)return r;throw new Error("A valid resolver was not returned from the static register method")}return r}if(e.$isInterface)throw new Error(`Attempted to jitRegister an interface: ${e.friendlyName}`);{const r=this.config.defaultResolver(e,t);return t.resolvers.set(e,r),r}}}const Ko=new WeakMap;function cacheCallbackResult(e){return function(t,r,o){if(Ko.has(o))return Ko.get(o);const i=e(t,r,o);return Ko.set(o,i),i}}const Wo=Object.freeze({instance:(e,t)=>new ResolverImpl(e,0,t),singleton:(e,t)=>new ResolverImpl(e,1,t),transient:(e,t)=>new ResolverImpl(e,2,t),callback:(e,t)=>new ResolverImpl(e,3,t),cachedCallback:(e,t)=>new ResolverImpl(e,3,cacheCallbackResult(t)),aliasTo:(e,t)=>new ResolverImpl(t,5,e)});function validateKey(e){if(null==e)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}function buildAllResponse(e,t,r){if(e instanceof ResolverImpl&&4===e.strategy){const o=e.state;let i=o.length;const n=new Array(i);for(;i--;)n[i]=o[i].resolve(t,r);return n}return[e.resolve(t,r)]}const Qo="(anonymous)";function isObject(e){return"object"==typeof e&&null!==e||"function"==typeof e}const Yo=function(){const e=new WeakMap;let t=!1,r="",o=0;return function(i){return t=e.get(i),void 0===t&&(r=i.toString(),o=r.length,t=o>=29&&o<=100&&125===r.charCodeAt(o-1)&&r.charCodeAt(o-2)<=32&&93===r.charCodeAt(o-3)&&101===r.charCodeAt(o-4)&&100===r.charCodeAt(o-5)&&111===r.charCodeAt(o-6)&&99===r.charCodeAt(o-7)&&32===r.charCodeAt(o-8)&&101===r.charCodeAt(o-9)&&118===r.charCodeAt(o-10)&&105===r.charCodeAt(o-11)&&116===r.charCodeAt(o-12)&&97===r.charCodeAt(o-13)&&110===r.charCodeAt(o-14)&&88===r.charCodeAt(o-15),e.set(i,t)),t}}(),Jo={};function isArrayIndex(e){switch(typeof e){case"number":return e>=0&&(0|e)===e;case"string":{const t=Jo[e];if(void 0!==t)return t;const r=e.length;if(0===r)return Jo[e]=!1;let o=0;for(let t=0;t<r;++t)if(o=e.charCodeAt(t),0===t&&48===o&&r>1||o<48||o>57)return Jo[e]=!1;return Jo[e]=!0}default:return!1}}function presentationKeyFromTag(e){return`${e.toLowerCase()}:presentation`}const Zo=new Map,Xo=Object.freeze({define(e,t,r){const o=presentationKeyFromTag(e);void 0===Zo.get(o)?Zo.set(o,t):Zo.set(o,!1),r.register(Wo.instance(o,t))},forTag(e,t){const r=presentationKeyFromTag(e),o=Zo.get(r);if(!1===o){return Ho.findResponsibleContainer(t).get(r)}return o||null}});class DefaultComponentPresentation{constructor(e,t){this.template=e||null,this.styles=void 0===t?null:Array.isArray(t)?ElementStyles.create(t):t instanceof ElementStyles?t:ElementStyles.create([t])}applyTo(e){const t=e.$fastController;null===t.template&&(t.template=this.template),null===t.styles&&(t.styles=this.styles)}}class FoundationElement extends Do{constructor(){super(...arguments),this._presentation=void 0}get $presentation(){return void 0===this._presentation&&(this._presentation=Xo.forTag(this.tagName,this)),this._presentation}templateChanged(){void 0!==this.template&&(this.$fastController.template=this.template)}stylesChanged(){void 0!==this.styles&&(this.$fastController.styles=this.styles)}connectedCallback(){null!==this.$presentation&&this.$presentation.applyTo(this),super.connectedCallback()}static compose(e){return(t={})=>new FoundationElementRegistry(this===FoundationElement?class extends FoundationElement{}:this,e,t)}}function resolveOption(e,t,r){return"function"==typeof e?e(t,r):e}__decorate$x([observable],FoundationElement.prototype,"template",void 0),__decorate$x([observable],FoundationElement.prototype,"styles",void 0);class FoundationElementRegistry{constructor(e,t,r){this.type=e,this.elementDefinition=t,this.overrideDefinition=r,this.definition=Object.assign(Object.assign({},this.elementDefinition),this.overrideDefinition)}register(e,t){const r=this.definition,o=this.overrideDefinition,i=`${r.prefix||t.elementPrefix}-${r.baseName}`;t.tryDefineElement({name:i,type:this.type,baseClass:this.elementDefinition.baseClass,callback:e=>{const t=new DefaultComponentPresentation(resolveOption(r.template,e,r),resolveOption(r.styles,e,r));e.definePresentation(t);let i=resolveOption(r.shadowOptions,e,r);e.shadowRootMode&&(i?o.shadowOptions||(i.mode=e.shadowRootMode):null!==i&&(i={mode:e.shadowRootMode})),e.defineElement({elementOptions:resolveOption(r.elementOptions,e,r),shadowOptions:i,attributes:resolveOption(r.attributes,e,r)})}})}}function applyMixins(e,...t){t.forEach((t=>{if(Object.getOwnPropertyNames(t.prototype).forEach((r=>{"constructor"!==r&&Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r))})),t.attributes){const r=e.attributes||[];e.attributes=r.concat(t.attributes)}}))}let ei;var ti;!function(e){e[e.alt=18]="alt",e[e.arrowDown=40]="arrowDown",e[e.arrowLeft=37]="arrowLeft",e[e.arrowRight=39]="arrowRight",e[e.arrowUp=38]="arrowUp",e[e.back=8]="back",e[e.backSlash=220]="backSlash",e[e.break=19]="break",e[e.capsLock=20]="capsLock",e[e.closeBracket=221]="closeBracket",e[e.colon=186]="colon",e[e.colon2=59]="colon2",e[e.comma=188]="comma",e[e.ctrl=17]="ctrl",e[e.delete=46]="delete",e[e.end=35]="end",e[e.enter=13]="enter",e[e.equals=187]="equals",e[e.equals2=61]="equals2",e[e.equals3=107]="equals3",e[e.escape=27]="escape",e[e.forwardSlash=191]="forwardSlash",e[e.function1=112]="function1",e[e.function10=121]="function10",e[e.function11=122]="function11",e[e.function12=123]="function12",e[e.function2=113]="function2",e[e.function3=114]="function3",e[e.function4=115]="function4",e[e.function5=116]="function5",e[e.function6=117]="function6",e[e.function7=118]="function7",e[e.function8=119]="function8",e[e.function9=120]="function9",e[e.home=36]="home",e[e.insert=45]="insert",e[e.menu=93]="menu",e[e.minus=189]="minus",e[e.minus2=109]="minus2",e[e.numLock=144]="numLock",e[e.numPad0=96]="numPad0",e[e.numPad1=97]="numPad1",e[e.numPad2=98]="numPad2",e[e.numPad3=99]="numPad3",e[e.numPad4=100]="numPad4",e[e.numPad5=101]="numPad5",e[e.numPad6=102]="numPad6",e[e.numPad7=103]="numPad7",e[e.numPad8=104]="numPad8",e[e.numPad9=105]="numPad9",e[e.numPadDivide=111]="numPadDivide",e[e.numPadDot=110]="numPadDot",e[e.numPadMinus=109]="numPadMinus",e[e.numPadMultiply=106]="numPadMultiply",e[e.numPadPlus=107]="numPadPlus",e[e.openBracket=219]="openBracket",e[e.pageDown=34]="pageDown",e[e.pageUp=33]="pageUp",e[e.period=190]="period",e[e.print=44]="print",e[e.quote=222]="quote",e[e.scrollLock=145]="scrollLock",e[e.shift=16]="shift",e[e.space=32]="space",e[e.tab=9]="tab",e[e.tilde=192]="tilde",e[e.windowsLeft=91]="windowsLeft",e[e.windowsOpera=219]="windowsOpera",e[e.windowsRight=92]="windowsRight"}(ti||(ti={}));var ri;!function(e){e.ltr="ltr",e.rtl="rtl"}(ri||(ri={}));let oi=0;function uniqueId(e=""){return`${e}${oi++}`}var ii;!function(e){e.Canvas="Canvas",e.CanvasText="CanvasText",e.LinkText="LinkText",e.VisitedText="VisitedText",e.ActiveText="ActiveText",e.ButtonFace="ButtonFace",e.ButtonText="ButtonText",e.Field="Field",e.FieldText="FieldText",e.Highlight="Highlight",e.HighlightText="HighlightText",e.GrayText="GrayText"}(ii||(ii={}));class ARIAGlobalStatesAndProperties{}__decorate$x([attr({attribute:"aria-atomic"})],ARIAGlobalStatesAndProperties.prototype,"ariaAtomic",void 0),__decorate$x([attr({attribute:"aria-busy"})],ARIAGlobalStatesAndProperties.prototype,"ariaBusy",void 0),__decorate$x([attr({attribute:"aria-controls"})],ARIAGlobalStatesAndProperties.prototype,"ariaControls",void 0),__decorate$x([attr({attribute:"aria-current"})],ARIAGlobalStatesAndProperties.prototype,"ariaCurrent",void 0),__decorate$x([attr({attribute:"aria-describedby"})],ARIAGlobalStatesAndProperties.prototype,"ariaDescribedby",void 0),__decorate$x([attr({attribute:"aria-details"})],ARIAGlobalStatesAndProperties.prototype,"ariaDetails",void 0),__decorate$x([attr({attribute:"aria-disabled"})],ARIAGlobalStatesAndProperties.prototype,"ariaDisabled",void 0),__decorate$x([attr({attribute:"aria-errormessage"})],ARIAGlobalStatesAndProperties.prototype,"ariaErrormessage",void 0),__decorate$x([attr({attribute:"aria-flowto"})],ARIAGlobalStatesAndProperties.prototype,"ariaFlowto",void 0),__decorate$x([attr({attribute:"aria-haspopup"})],ARIAGlobalStatesAndProperties.prototype,"ariaHaspopup",void 0),__decorate$x([attr({attribute:"aria-hidden"})],ARIAGlobalStatesAndProperties.prototype,"ariaHidden",void 0),__decorate$x([attr({attribute:"aria-invalid"})],ARIAGlobalStatesAndProperties.prototype,"ariaInvalid",void 0),__decorate$x([attr({attribute:"aria-keyshortcuts"})],ARIAGlobalStatesAndProperties.prototype,"ariaKeyshortcuts",void 0),__decorate$x([attr({attribute:"aria-label"})],ARIAGlobalStatesAndProperties.prototype,"ariaLabel",void 0),__decorate$x([attr({attribute:"aria-labelledby"})],ARIAGlobalStatesAndProperties.prototype,"ariaLabelledby",void 0),__decorate$x([attr({attribute:"aria-live"})],ARIAGlobalStatesAndProperties.prototype,"ariaLive",void 0),__decorate$x([attr({attribute:"aria-owns"})],ARIAGlobalStatesAndProperties.prototype,"ariaOwns",void 0),__decorate$x([attr({attribute:"aria-relevant"})],ARIAGlobalStatesAndProperties.prototype,"ariaRelevant",void 0),__decorate$x([attr({attribute:"aria-roledescription"})],ARIAGlobalStatesAndProperties.prototype,"ariaRoledescription",void 0);const ni="ElementInternals"in window&&"setFormValue"in window.ElementInternals.prototype,si=new WeakMap;function FormAssociated(e){const t=class extends e{constructor(...e){super(...e),this.dirtyValue=!1,this.disabled=!1,this.proxyEventsToBlock=["change","click"],this.proxyInitialized=!1,this.required=!1,this.initialValue=this.initialValue||"",this.elementInternals||(this.formResetCallback=this.formResetCallback.bind(this))}static get formAssociated(){return ni}get validity(){return this.elementInternals?this.elementInternals.validity:this.proxy.validity}get form(){return this.elementInternals?this.elementInternals.form:this.proxy.form}get validationMessage(){return this.elementInternals?this.elementInternals.validationMessage:this.proxy.validationMessage}get willValidate(){return this.elementInternals?this.elementInternals.willValidate:this.proxy.willValidate}get labels(){if(this.elementInternals)return Object.freeze(Array.from(this.elementInternals.labels));if(this.proxy instanceof HTMLElement&&this.proxy.ownerDocument&&this.id){const e=this.proxy.labels,t=Array.from(this.proxy.getRootNode().querySelectorAll(`[for='${this.id}']`)),r=e?t.concat(Array.from(e)):t;return Object.freeze(r)}return uo}valueChanged(e,t){this.dirtyValue=!0,this.proxy instanceof HTMLElement&&(this.proxy.value=this.value),this.currentValue=this.value,this.setFormValue(this.value),this.validate()}currentValueChanged(){this.value=this.currentValue}initialValueChanged(e,t){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}disabledChanged(e,t){this.proxy instanceof HTMLElement&&(this.proxy.disabled=this.disabled),bo.queueUpdate((()=>this.classList.toggle("disabled",this.disabled)))}nameChanged(e,t){this.proxy instanceof HTMLElement&&(this.proxy.name=this.name)}requiredChanged(e,t){this.proxy instanceof HTMLElement&&(this.proxy.required=this.required),bo.queueUpdate((()=>this.classList.toggle("required",this.required))),this.validate()}get elementInternals(){if(!ni)return null;let e=si.get(this);return e||(e=this.attachInternals(),si.set(this,e)),e}connectedCallback(){super.connectedCallback(),this.addEventListener("keypress",this._keypressHandler),this.value||(this.value=this.initialValue,this.dirtyValue=!1),this.elementInternals||(this.attachProxy(),this.form&&this.form.addEventListener("reset",this.formResetCallback))}disconnectedCallback(){this.proxyEventsToBlock.forEach((e=>this.proxy.removeEventListener(e,this.stopPropagation))),!this.elementInternals&&this.form&&this.form.removeEventListener("reset",this.formResetCallback)}checkValidity(){return this.elementInternals?this.elementInternals.checkValidity():this.proxy.checkValidity()}reportValidity(){return this.elementInternals?this.elementInternals.reportValidity():this.proxy.reportValidity()}setValidity(e,t,r){this.elementInternals?this.elementInternals.setValidity(e,t,r):"string"==typeof t&&this.proxy.setCustomValidity(t)}formDisabledCallback(e){this.disabled=e}formResetCallback(){this.value=this.initialValue,this.dirtyValue=!1}attachProxy(){var e;this.proxyInitialized||(this.proxyInitialized=!0,this.proxy.style.display="none",this.proxyEventsToBlock.forEach((e=>this.proxy.addEventListener(e,this.stopPropagation))),this.proxy.disabled=this.disabled,this.proxy.required=this.required,"string"==typeof this.name&&(this.proxy.name=this.name),"string"==typeof this.value&&(this.proxy.value=this.value),this.proxy.setAttribute("slot","form-associated-proxy"),this.proxySlot=document.createElement("slot"),this.proxySlot.setAttribute("name","form-associated-proxy")),null===(e=this.shadowRoot)||void 0===e||e.appendChild(this.proxySlot),this.appendChild(this.proxy)}detachProxy(){var e;this.removeChild(this.proxy),null===(e=this.shadowRoot)||void 0===e||e.removeChild(this.proxySlot)}validate(){this.proxy instanceof HTMLElement&&this.setValidity(this.proxy.validity,this.proxy.validationMessage)}setFormValue(e,t){this.elementInternals&&this.elementInternals.setFormValue(e,t||e)}_keypressHandler(e){if("Enter"===e.key)if(this.form instanceof HTMLFormElement){const e=this.form.querySelector("[type=submit]");null==e||e.click()}}stopPropagation(e){e.stopPropagation()}};return attr({mode:"boolean"})(t.prototype,"disabled"),attr({mode:"fromView",attribute:"value"})(t.prototype,"initialValue"),attr({attribute:"current-value"})(t.prototype,"currentValue"),attr(t.prototype,"name"),attr({mode:"boolean"})(t.prototype,"required"),observable(t.prototype,"value"),t}class _Button extends FoundationElement{}class FormAssociatedButton extends(FormAssociated(_Button)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Button$1 extends FormAssociatedButton{constructor(){super(...arguments),this.handleClick=e=>{var t;this.disabled&&(null===(t=this.defaultSlottedContent)||void 0===t?void 0:t.length)<=1&&e.stopPropagation()},this.handleSubmission=()=>{if(!this.form)return;const e=this.proxy.isConnected;e||this.attachProxy(),"function"==typeof this.form.requestSubmit?this.form.requestSubmit(this.proxy):this.proxy.click(),e||this.detachProxy()},this.handleFormReset=()=>{var e;null===(e=this.form)||void 0===e||e.reset()},this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(null===(e=this.$fastController.definition.shadowOptions)||void 0===e?void 0:e.delegatesFocus)&&(this.focus=()=>{this.control.focus()})}}formactionChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formAction=this.formaction)}formenctypeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formEnctype=this.formenctype)}formmethodChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formMethod=this.formmethod)}formnovalidateChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formNoValidate=this.formnovalidate)}formtargetChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formTarget=this.formtarget)}typeChanged(e,t){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type),"submit"===t&&this.addEventListener("click",this.handleSubmission),"submit"===e&&this.removeEventListener("click",this.handleSubmission),"reset"===t&&this.addEventListener("click",this.handleFormReset),"reset"===e&&this.removeEventListener("click",this.handleFormReset)}connectedCallback(){var e;super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.handleUnsupportedDelegatesFocus();const t=Array.from(null===(e=this.control)||void 0===e?void 0:e.children);t&&t.forEach((e=>{e.addEventListener("click",this.handleClick)}))}disconnectedCallback(){var e;super.disconnectedCallback();const t=Array.from(null===(e=this.control)||void 0===e?void 0:e.children);t&&t.forEach((e=>{e.removeEventListener("click",this.handleClick)}))}}__decorate$x([attr({mode:"boolean"})],Button$1.prototype,"autofocus",void 0),__decorate$x([attr({attribute:"form"})],Button$1.prototype,"formId",void 0),__decorate$x([attr],Button$1.prototype,"formaction",void 0),__decorate$x([attr],Button$1.prototype,"formenctype",void 0),__decorate$x([attr],Button$1.prototype,"formmethod",void 0),__decorate$x([attr({mode:"boolean"})],Button$1.prototype,"formnovalidate",void 0),__decorate$x([attr],Button$1.prototype,"formtarget",void 0),__decorate$x([attr],Button$1.prototype,"type",void 0),__decorate$x([observable],Button$1.prototype,"defaultSlottedContent",void 0);class DelegatesARIAButton{}__decorate$x([attr({attribute:"aria-expanded"})],DelegatesARIAButton.prototype,"ariaExpanded",void 0),__decorate$x([attr({attribute:"aria-pressed"})],DelegatesARIAButton.prototype,"ariaPressed",void 0),applyMixins(DelegatesARIAButton,ARIAGlobalStatesAndProperties),applyMixins(Button$1,StartEnd,DelegatesARIAButton);class Card$1 extends FoundationElement{}class _Checkbox extends FoundationElement{}class FormAssociatedCheckbox extends(function CheckableFormAssociated(e){class C extends(FormAssociated(e)){}class D extends C{constructor(...e){super(e),this.dirtyChecked=!1,this.checkedAttribute=!1,this.checked=!1,this.dirtyChecked=!1}checkedAttributeChanged(){this.defaultChecked=this.checkedAttribute}defaultCheckedChanged(){this.dirtyChecked||(this.checked=this.defaultChecked,this.dirtyChecked=!1)}checkedChanged(e,t){this.dirtyChecked||(this.dirtyChecked=!0),this.currentChecked=this.checked,this.updateForm(),this.proxy instanceof HTMLInputElement&&(this.proxy.checked=this.checked),void 0!==e&&this.$emit("change"),this.validate()}currentCheckedChanged(e,t){this.checked=this.currentChecked}updateForm(){const e=this.checked?this.value:null;this.setFormValue(e,e)}connectedCallback(){super.connectedCallback(),this.updateForm()}formResetCallback(){super.formResetCallback(),this.checked=!!this.checkedAttribute,this.dirtyChecked=!1}}return attr({attribute:"checked",mode:"boolean"})(D.prototype,"checkedAttribute"),attr({attribute:"current-checked",converter:Io})(D.prototype,"currentChecked"),observable(D.prototype,"defaultChecked"),observable(D.prototype,"checked"),D}(_Checkbox)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Checkbox extends FormAssociatedCheckbox{constructor(){super(),this.initialValue="on",this.indeterminate=!1,this.keypressHandler=e=>{if(" "===e.key)this.checked=!this.checked},this.clickHandler=e=>{this.disabled||this.readOnly||(this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}}function composedParent(e){const t=e.parentElement;if(t)return t;{const t=e.getRootNode();if(t.host instanceof HTMLElement)return t.host}return null}__decorate$x([attr({attribute:"readonly",mode:"boolean"})],Checkbox.prototype,"readOnly",void 0),__decorate$x([observable],Checkbox.prototype,"defaultSlottedNodes",void 0),__decorate$x([observable],Checkbox.prototype,"indeterminate",void 0);const ai=document.createElement("div");class QueuedStyleSheetTarget{setProperty(e,t){bo.queueUpdate((()=>this.target.setProperty(e,t)))}removeProperty(e){bo.queueUpdate((()=>this.target.removeProperty(e)))}}class DocumentStyleSheetTarget extends QueuedStyleSheetTarget{constructor(){super();const e=new CSSStyleSheet;this.target=e.cssRules[e.insertRule(":root{}")].style,document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}}class HeadStyleElementStyleSheetTarget extends QueuedStyleSheetTarget{constructor(){super(),this.style=document.createElement("style"),document.head.appendChild(this.style);const{sheet:e}=this.style;if(e){const t=e.insertRule(":root{}",e.cssRules.length);this.target=e.cssRules[t].style}}}class StyleElementStyleSheetTarget{constructor(e){this.store=new Map,this.target=null;const t=e.$fastController;this.style=document.createElement("style"),t.addStyles(this.style),yo.getNotifier(t).subscribe(this,"isConnected"),this.handleChange(t,"isConnected")}targetChanged(){if(null!==this.target)for(const[e,t]of this.store.entries())this.target.setProperty(e,t)}setProperty(e,t){this.store.set(e,t),bo.queueUpdate((()=>{null!==this.target&&this.target.setProperty(e,t)}))}removeProperty(e){this.store.delete(e),bo.queueUpdate((()=>{null!==this.target&&this.target.removeProperty(e)}))}handleChange(e,t){const{sheet:r}=this.style;if(r){const e=r.insertRule(":host{}",r.cssRules.length);this.target=r.cssRules[e].style}else this.target=null}}__decorate$x([observable],StyleElementStyleSheetTarget.prototype,"target",void 0);class ElementStyleSheetTarget{constructor(e){this.target=e.style}setProperty(e,t){bo.queueUpdate((()=>this.target.setProperty(e,t)))}removeProperty(e){bo.queueUpdate((()=>this.target.removeProperty(e)))}}class RootStyleSheetTarget{setProperty(e,t){RootStyleSheetTarget.properties[e]=t;for(const r of RootStyleSheetTarget.roots.values())di.getOrCreate(RootStyleSheetTarget.normalizeRoot(r)).setProperty(e,t)}removeProperty(e){delete RootStyleSheetTarget.properties[e];for(const t of RootStyleSheetTarget.roots.values())di.getOrCreate(RootStyleSheetTarget.normalizeRoot(t)).removeProperty(e)}static registerRoot(e){const{roots:t}=RootStyleSheetTarget;if(!t.has(e)){t.add(e);const r=di.getOrCreate(this.normalizeRoot(e));for(const e in RootStyleSheetTarget.properties)r.setProperty(e,RootStyleSheetTarget.properties[e])}}static unregisterRoot(e){const{roots:t}=RootStyleSheetTarget;if(t.has(e)){t.delete(e);const r=di.getOrCreate(RootStyleSheetTarget.normalizeRoot(e));for(const e in RootStyleSheetTarget.properties)r.removeProperty(e)}}static normalizeRoot(e){return e===ai?document:e}}RootStyleSheetTarget.roots=new Set,RootStyleSheetTarget.properties={};const li=new WeakMap,ci=bo.supportsAdoptedStyleSheets?class ConstructableStyleSheetTarget extends QueuedStyleSheetTarget{constructor(e){super();const t=new CSSStyleSheet;this.target=t.cssRules[t.insertRule(":host{}")].style,e.$fastController.addStyles(ElementStyles.create([t]))}}:StyleElementStyleSheetTarget,di=Object.freeze({getOrCreate(e){if(li.has(e))return li.get(e);let t;return t=e===ai?new RootStyleSheetTarget:e instanceof Document?bo.supportsAdoptedStyleSheets?new DocumentStyleSheetTarget:new HeadStyleElementStyleSheetTarget:function isFastElement(e){return e instanceof Do}(e)?new ci(e):new ElementStyleSheetTarget(e),li.set(e,t),t}});class DesignTokenImpl extends CSSDirective{constructor(e){super(),this.subscribers=new WeakMap,this._appliedTo=new Set,this.name=e.name,null!==e.cssCustomPropertyName&&(this.cssCustomProperty=`--${e.cssCustomPropertyName}`,this.cssVar=`var(${this.cssCustomProperty})`),this.id=DesignTokenImpl.uniqueId(),DesignTokenImpl.tokensById.set(this.id,this)}get appliedTo(){return[...this._appliedTo]}static from(e){return new DesignTokenImpl({name:"string"==typeof e?e:e.name,cssCustomPropertyName:"string"==typeof e?e:void 0===e.cssCustomPropertyName?e.name:e.cssCustomPropertyName})}static isCSSDesignToken(e){return"string"==typeof e.cssCustomProperty}static isDerivedDesignTokenValue(e){return"function"==typeof e}static getTokenById(e){return DesignTokenImpl.tokensById.get(e)}getOrCreateSubscriberSet(e=this){return this.subscribers.get(e)||this.subscribers.set(e,new Set)&&this.subscribers.get(e)}createCSS(){return this.cssVar||""}getValueFor(e){const t=DesignTokenNode.getOrCreate(e).get(this);if(void 0!==t)return t;throw new Error(`Value could not be retrieved for token named "${this.name}". Ensure the value is set for ${e} or an ancestor of ${e}.`)}setValueFor(e,t){return this._appliedTo.add(e),t instanceof DesignTokenImpl&&(t=this.alias(t)),DesignTokenNode.getOrCreate(e).set(this,t),this}deleteValueFor(e){return this._appliedTo.delete(e),DesignTokenNode.existsFor(e)&&DesignTokenNode.getOrCreate(e).delete(this),this}withDefault(e){return this.setValueFor(ai,e),this}subscribe(e,t){const r=this.getOrCreateSubscriberSet(t);t&&!DesignTokenNode.existsFor(t)&&DesignTokenNode.getOrCreate(t),r.has(e)||r.add(e)}unsubscribe(e,t){const r=this.subscribers.get(t||this);r&&r.has(e)&&r.delete(e)}notify(e){const t=Object.freeze({token:this,target:e});this.subscribers.has(this)&&this.subscribers.get(this).forEach((e=>e.handleChange(t))),this.subscribers.has(e)&&this.subscribers.get(e).forEach((e=>e.handleChange(t)))}alias(e){return t=>e.getValueFor(t)}}DesignTokenImpl.uniqueId=(()=>{let e=0;return()=>(e++,e.toString(16))})(),DesignTokenImpl.tokensById=new Map;class DesignTokenBindingObserver{constructor(e,t,r){this.source=e,this.token=t,this.node=r,this.dependencies=new Set,this.observer=yo.binding(e,this,!1),this.observer.handleChange=this.observer.call,this.handleChange()}disconnect(){this.observer.disconnect()}handleChange(){this.node.store.set(this.token,this.observer.observe(this.node.target,Co))}}class Store{constructor(){this.values=new Map}set(e,t){this.values.get(e)!==t&&(this.values.set(e,t),yo.getNotifier(this).notify(e.id))}get(e){return yo.track(this,e.id),this.values.get(e)}delete(e){this.values.delete(e)}all(){return this.values.entries()}}const ui=new WeakMap,hi=new WeakMap;class DesignTokenNode{constructor(e){this.target=e,this.store=new Store,this.children=[],this.assignedValues=new Map,this.reflecting=new Set,this.bindingObservers=new Map,this.tokenValueChangeHandler={handleChange:(e,t)=>{const r=DesignTokenImpl.getTokenById(t);if(r&&(r.notify(this.target),DesignTokenImpl.isCSSDesignToken(r))){const t=this.parent,o=this.isReflecting(r);if(t){const i=t.get(r),n=e.get(r);i===n||o?i===n&&o&&this.stopReflectToCSS(r):this.reflectToCSS(r)}else o||this.reflectToCSS(r)}}},ui.set(e,this),yo.getNotifier(this.store).subscribe(this.tokenValueChangeHandler),e instanceof Do?e.$fastController.addBehaviors([this]):e.isConnected&&this.bind()}static getOrCreate(e){return ui.get(e)||new DesignTokenNode(e)}static existsFor(e){return ui.has(e)}static findParent(e){if(ai!==e.target){let t=composedParent(e.target);for(;null!==t;){if(ui.has(t))return ui.get(t);t=composedParent(t)}return DesignTokenNode.getOrCreate(ai)}return null}static findClosestAssignedNode(e,t){let r=t;do{if(r.has(e))return r;r=r.parent?r.parent:r.target!==ai?DesignTokenNode.getOrCreate(ai):null}while(null!==r);return null}get parent(){return hi.get(this)||null}has(e){return this.assignedValues.has(e)}get(e){const t=this.store.get(e);if(void 0!==t)return t;const r=this.getRaw(e);return void 0!==r?(this.hydrate(e,r),this.get(e)):void 0}getRaw(e){var t;return this.assignedValues.has(e)?this.assignedValues.get(e):null===(t=DesignTokenNode.findClosestAssignedNode(e,this))||void 0===t?void 0:t.getRaw(e)}set(e,t){DesignTokenImpl.isDerivedDesignTokenValue(this.assignedValues.get(e))&&this.tearDownBindingObserver(e),this.assignedValues.set(e,t),DesignTokenImpl.isDerivedDesignTokenValue(t)?this.setupBindingObserver(e,t):this.store.set(e,t)}delete(e){this.assignedValues.delete(e),this.tearDownBindingObserver(e);const t=this.getRaw(e);t?this.hydrate(e,t):this.store.delete(e)}bind(){const e=DesignTokenNode.findParent(this);e&&e.appendChild(this);for(const e of this.assignedValues.keys())e.notify(this.target)}unbind(){if(this.parent){hi.get(this).removeChild(this)}}appendChild(e){e.parent&&hi.get(e).removeChild(e);const t=this.children.filter((t=>e.contains(t)));hi.set(e,this),this.children.push(e),t.forEach((t=>e.appendChild(t))),yo.getNotifier(this.store).subscribe(e);for(const[t,r]of this.store.all())e.hydrate(t,this.bindingObservers.has(t)?this.getRaw(t):r)}removeChild(e){const t=this.children.indexOf(e);return-1!==t&&this.children.splice(t,1),yo.getNotifier(this.store).unsubscribe(e),e.parent===this&&hi.delete(e)}contains(e){return function composedContains(e,t){let r=t;for(;null!==r;){if(r===e)return!0;r=composedParent(r)}return!1}(this.target,e.target)}reflectToCSS(e){this.isReflecting(e)||(this.reflecting.add(e),DesignTokenNode.cssCustomPropertyReflector.startReflection(e,this.target))}stopReflectToCSS(e){this.isReflecting(e)&&(this.reflecting.delete(e),DesignTokenNode.cssCustomPropertyReflector.stopReflection(e,this.target))}isReflecting(e){return this.reflecting.has(e)}handleChange(e,t){const r=DesignTokenImpl.getTokenById(t);r&&this.hydrate(r,this.getRaw(r))}hydrate(e,t){if(!this.has(e)){const r=this.bindingObservers.get(e);DesignTokenImpl.isDerivedDesignTokenValue(t)?r?r.source!==t&&(this.tearDownBindingObserver(e),this.setupBindingObserver(e,t)):this.setupBindingObserver(e,t):(r&&this.tearDownBindingObserver(e),this.store.set(e,t))}}setupBindingObserver(e,t){const r=new DesignTokenBindingObserver(t,e,this);return this.bindingObservers.set(e,r),r}tearDownBindingObserver(e){return!!this.bindingObservers.has(e)&&(this.bindingObservers.get(e).disconnect(),this.bindingObservers.delete(e),!0)}}DesignTokenNode.cssCustomPropertyReflector=new class CustomPropertyReflector{startReflection(e,t){e.subscribe(this,t),this.handleChange({token:e,target:t})}stopReflection(e,t){e.unsubscribe(this,t),this.remove(e,t)}handleChange(e){const{token:t,target:r}=e;this.add(t,r)}add(e,t){di.getOrCreate(t).setProperty(e.cssCustomProperty,this.resolveCSSValue(DesignTokenNode.getOrCreate(t).get(e)))}remove(e,t){di.getOrCreate(t).removeProperty(e.cssCustomProperty)}resolveCSSValue(e){return e&&"function"==typeof e.createCSS?e.createCSS():e}},__decorate$x([observable],DesignTokenNode.prototype,"children",void 0);const pi=Object.freeze({create:function create$1(e){return DesignTokenImpl.from(e)},notifyConnection:e=>!(!e.isConnected||!DesignTokenNode.existsFor(e))&&(DesignTokenNode.getOrCreate(e).bind(),!0),notifyDisconnection:e=>!(e.isConnected||!DesignTokenNode.existsFor(e))&&(DesignTokenNode.getOrCreate(e).unbind(),!0),registerRoot(e=ai){RootStyleSheetTarget.registerRoot(e)},unregisterRoot(e=ai){RootStyleSheetTarget.unregisterRoot(e)}}),fi=Object.freeze({definitionCallbackOnly:null,ignoreDuplicate:Symbol()}),gi=new Map,mi=new Map;let vi=null;const bi=Ho.createInterface((e=>e.cachedCallback((e=>(null===vi&&(vi=new DefaultDesignSystem(null,e)),vi))))),yi=Object.freeze({tagFor:e=>mi.get(e),responsibleFor(e){const t=e.$$designSystem$$;if(t)return t;return Ho.findResponsibleContainer(e).get(bi)},getOrCreate(e){if(!e)return null===vi&&(vi=Ho.getOrCreateDOMContainer().get(bi)),vi;const t=e.$$designSystem$$;if(t)return t;const r=Ho.getOrCreateDOMContainer(e);if(r.has(bi,!1))return r.get(bi);{const t=new DefaultDesignSystem(e,r);return r.register(Wo.instance(bi,t)),t}}});class DefaultDesignSystem{constructor(e,t){this.owner=e,this.container=t,this.designTokensInitialized=!1,this.prefix="fast",this.shadowRootMode=void 0,this.disambiguate=()=>fi.definitionCallbackOnly,null!==e&&(e.$$designSystem$$=this)}withPrefix(e){return this.prefix=e,this}withShadowRootMode(e){return this.shadowRootMode=e,this}withElementDisambiguation(e){return this.disambiguate=e,this}withDesignTokenRoot(e){return this.designTokenRoot=e,this}register(...e){const t=this.container,r=[],o=this.disambiguate,i=this.shadowRootMode,n={elementPrefix:this.prefix,tryDefineElement(e,n,s){const a=function extractTryDefineElementParams(e,t,r){return"string"==typeof e?{name:e,type:t,callback:r}:e}(e,n,s),{name:l,callback:c,baseClass:d}=a;let{type:u}=a,h=l,p=gi.get(h),f=!0;for(;p;){const e=o(h,u,p);switch(e){case fi.ignoreDuplicate:return;case fi.definitionCallbackOnly:f=!1,p=void 0;break;default:h=e,p=gi.get(h)}}f&&((mi.has(u)||u===FoundationElement)&&(u=class extends u{}),gi.set(h,u),mi.set(u,h),d&&mi.set(d,h)),r.push(new ElementDefinitionEntry(t,h,u,i,c,f))}};this.designTokensInitialized||(this.designTokensInitialized=!0,null!==this.designTokenRoot&&pi.registerRoot(this.designTokenRoot)),t.registerWithContext(n,...e);for(const e of r)e.callback(e),e.willDefine&&null!==e.definition&&e.definition.define();return this}}class ElementDefinitionEntry{constructor(e,t,r,o,i,n){this.container=e,this.name=t,this.type=r,this.shadowRootMode=o,this.callback=i,this.willDefine=n,this.definition=null}definePresentation(e){Xo.define(this.name,e,this.container)}defineElement(e){this.definition=new FASTElementDefinition(this.type,Object.assign(Object.assign({},e),{name:this.name}))}tagFor(e){return yi.tagFor(e)}}class _TextField extends FoundationElement{}class FormAssociatedTextField extends(FormAssociated(_TextField)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}const wi="text";class TextField$1 extends FormAssociatedTextField{constructor(){super(...arguments),this.type=wi}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}typeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type,this.validate())}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.validate(),this.autofocus&&bo.queueUpdate((()=>{this.focus()}))}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.value=this.control.value}handleChange(){this.$emit("change")}}__decorate$x([attr({attribute:"readonly",mode:"boolean"})],TextField$1.prototype,"readOnly",void 0),__decorate$x([attr({mode:"boolean"})],TextField$1.prototype,"autofocus",void 0),__decorate$x([attr],TextField$1.prototype,"placeholder",void 0),__decorate$x([attr],TextField$1.prototype,"type",void 0),__decorate$x([attr],TextField$1.prototype,"list",void 0),__decorate$x([attr({converter:xo})],TextField$1.prototype,"maxlength",void 0),__decorate$x([attr({converter:xo})],TextField$1.prototype,"minlength",void 0),__decorate$x([attr],TextField$1.prototype,"pattern",void 0),__decorate$x([attr({converter:xo})],TextField$1.prototype,"size",void 0),__decorate$x([attr({mode:"boolean"})],TextField$1.prototype,"spellcheck",void 0),__decorate$x([observable],TextField$1.prototype,"defaultSlottedNodes",void 0);class DelegatesARIATextbox{}applyMixins(DelegatesARIATextbox,ARIAGlobalStatesAndProperties),applyMixins(TextField$1,StartEnd,DelegatesARIATextbox);class BaseProgress extends FoundationElement{constructor(){super(...arguments),this.percentComplete=0}valueChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}minChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}maxChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}connectedCallback(){super.connectedCallback(),this.updatePercentComplete()}updatePercentComplete(){const e="number"==typeof this.min?this.min:0,t="number"==typeof this.max?this.max:100,r="number"==typeof this.value?this.value:0,o=t-e;this.percentComplete=0===o?0:Math.fround((r-e)/o*100)}}__decorate$x([attr({converter:xo})],BaseProgress.prototype,"value",void 0),__decorate$x([attr({converter:xo})],BaseProgress.prototype,"min",void 0),__decorate$x([attr({converter:xo})],BaseProgress.prototype,"max",void 0),__decorate$x([attr({mode:"boolean"})],BaseProgress.prototype,"paused",void 0),__decorate$x([observable],BaseProgress.prototype,"percentComplete",void 0);function whitespaceFilter(e,t,r){return e.nodeType!==Node.TEXT_NODE||"string"==typeof e.nodeValue&&!!e.nodeValue.trim().length}class Tab extends FoundationElement{}__decorate$x([attr({mode:"boolean"})],Tab.prototype,"disabled",void 0);const Ci="horizontal";class Tabs extends FoundationElement{constructor(){super(...arguments),this.orientation=Ci,this.activeindicator=!0,this.showActiveIndicator=!0,this.prevActiveTabIndex=0,this.activeTabIndex=0,this.ticking=!1,this.change=()=>{this.$emit("change",this.activetab)},this.isDisabledElement=e=>"true"===e.getAttribute("aria-disabled"),this.isFocusableElement=e=>!this.isDisabledElement(e),this.setTabs=()=>{const e="gridColumn",t="gridRow",r=this.isHorizontal()?e:t;this.activeTabIndex=this.getActiveIndex(),this.showActiveIndicator=!1,this.tabs.forEach(((e,t)=>{if("tab"===e.slot){const r=this.activeTabIndex===t&&this.isFocusableElement(e);this.activeindicator&&this.isFocusableElement(e)&&(this.showActiveIndicator=!0);const o=this.tabIds[t],i=this.tabpanelIds[t];e.setAttribute("id",o),e.setAttribute("aria-selected",r?"true":"false"),e.setAttribute("aria-controls",i),e.addEventListener("click",this.handleTabClick),e.addEventListener("keydown",this.handleTabKeyDown),e.setAttribute("tabindex",r?"0":"-1"),r&&(this.activetab=e)}e.style.gridColumn="",e.style.gridRow="",e.style[r]=`${t+1}`,this.isHorizontal()?e.classList.remove("vertical"):e.classList.add("vertical")}))},this.setTabPanels=()=>{this.tabpanels.forEach(((e,t)=>{const r=this.tabIds[t],o=this.tabpanelIds[t];e.setAttribute("id",o),e.setAttribute("aria-labelledby",r),this.activeTabIndex!==t?e.setAttribute("hidden",""):e.removeAttribute("hidden")}))},this.handleTabClick=e=>{const t=e.currentTarget;1===t.nodeType&&this.isFocusableElement(t)&&(this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=this.tabs.indexOf(t),this.setComponent())},this.handleTabKeyDown=e=>{if(this.isHorizontal())switch(e.key){case"ArrowLeft":e.preventDefault(),this.adjustBackward(e);break;case"ArrowRight":e.preventDefault(),this.adjustForward(e)}else switch(e.key){case"ArrowUp":e.preventDefault(),this.adjustBackward(e);break;case"ArrowDown":e.preventDefault(),this.adjustForward(e)}switch(e.key){case"Home":e.preventDefault(),this.adjust(-this.activeTabIndex);break;case"End":e.preventDefault(),this.adjust(this.tabs.length-this.activeTabIndex-1)}},this.adjustForward=e=>{const t=this.tabs;let r=0;for(r=this.activetab?t.indexOf(this.activetab)+1:1,r===t.length&&(r=0);r<t.length&&t.length>1;){if(this.isFocusableElement(t[r])){this.moveToTabByIndex(t,r);break}if(this.activetab&&r===t.indexOf(this.activetab))break;r+1>=t.length?r=0:r+=1}},this.adjustBackward=e=>{const t=this.tabs;let r=0;for(r=this.activetab?t.indexOf(this.activetab)-1:0,r=r<0?t.length-1:r;r>=0&&t.length>1;){if(this.isFocusableElement(t[r])){this.moveToTabByIndex(t,r);break}r-1<0?r=t.length-1:r-=1}},this.moveToTabByIndex=(e,t)=>{const r=e[t];this.activetab=r,this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=t,r.focus(),this.setComponent()}}orientationChanged(){this.$fastController.isConnected&&(this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}activeidChanged(e,t){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.prevActiveTabIndex=this.tabs.findIndex((t=>t.id===e)),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabsChanged(){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabpanelsChanged(){this.$fastController.isConnected&&this.tabpanels.length<=this.tabs.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}getActiveIndex(){return void 0!==this.activeid?-1===this.tabIds.indexOf(this.activeid)?0:this.tabIds.indexOf(this.activeid):0}getTabIds(){return this.tabs.map((e=>{var t;return null!==(t=e.getAttribute("id"))&&void 0!==t?t:`tab-${uniqueId()}`}))}getTabPanelIds(){return this.tabpanels.map((e=>{var t;return null!==(t=e.getAttribute("id"))&&void 0!==t?t:`panel-${uniqueId()}`}))}setComponent(){this.activeTabIndex!==this.prevActiveTabIndex&&(this.activeid=this.tabIds[this.activeTabIndex],this.focusTab(),this.change())}isHorizontal(){return this.orientation===Ci}handleActiveIndicatorPosition(){this.showActiveIndicator&&this.activeindicator&&this.activeTabIndex!==this.prevActiveTabIndex&&(this.ticking?this.ticking=!1:(this.ticking=!0,this.animateActiveIndicator()))}animateActiveIndicator(){this.ticking=!0;const e=this.isHorizontal()?"gridColumn":"gridRow",t=this.isHorizontal()?"translateX":"translateY",r=this.isHorizontal()?"offsetLeft":"offsetTop",o=this.activeIndicatorRef[r];this.activeIndicatorRef.style[e]=`${this.activeTabIndex+1}`;const i=this.activeIndicatorRef[r];this.activeIndicatorRef.style[e]=`${this.prevActiveTabIndex+1}`;const n=i-o;this.activeIndicatorRef.style.transform=`${t}(${n}px)`,this.activeIndicatorRef.classList.add("activeIndicatorTransition"),this.activeIndicatorRef.addEventListener("transitionend",(()=>{this.ticking=!1,this.activeIndicatorRef.style[e]=`${this.activeTabIndex+1}`,this.activeIndicatorRef.style.transform=`${t}(0px)`,this.activeIndicatorRef.classList.remove("activeIndicatorTransition")}))}adjust(e){this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=function wrapInBounds(e,t,r){return r<e?t:r>t?e:r}(0,this.tabs.length-1,this.activeTabIndex+e),this.setComponent()}focusTab(){this.tabs[this.activeTabIndex].focus()}connectedCallback(){super.connectedCallback(),this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.activeTabIndex=this.getActiveIndex()}}__decorate$x([attr],Tabs.prototype,"orientation",void 0),__decorate$x([attr],Tabs.prototype,"activeid",void 0),__decorate$x([observable],Tabs.prototype,"tabs",void 0),__decorate$x([observable],Tabs.prototype,"tabpanels",void 0),__decorate$x([attr({mode:"boolean"})],Tabs.prototype,"activeindicator",void 0),__decorate$x([observable],Tabs.prototype,"activeIndicatorRef",void 0),__decorate$x([observable],Tabs.prototype,"showActiveIndicator",void 0),applyMixins(Tabs,StartEnd);class MatchMediaStyleSheetBehavior extends class MatchMediaBehavior{constructor(e){this.listenerCache=new WeakMap,this.query=e}bind(e){const{query:t}=this,r=this.constructListener(e);r.bind(t)(),t.addListener(r),this.listenerCache.set(e,r)}unbind(e){const t=this.listenerCache.get(e);t&&(this.query.removeListener(t),this.listenerCache.delete(e))}}{constructor(e,t){super(e),this.styles=t}static with(e){return t=>new MatchMediaStyleSheetBehavior(e,t)}constructListener(e){let t=!1;const r=this.styles;return function listener(){const{matches:o}=this;o&&!t?(e.$fastController.addStyles(r),t=o):!o&&t&&(e.$fastController.removeStyles(r),t=o)}}unbind(e){super.unbind(e),e.$fastController.removeStyles(this.styles)}}const ki=MatchMediaStyleSheetBehavior.with(window.matchMedia("(forced-colors)"));MatchMediaStyleSheetBehavior.with(window.matchMedia("(prefers-color-scheme: dark)")),MatchMediaStyleSheetBehavior.with(window.matchMedia("(prefers-color-scheme: light)"));class PropertyStyleSheetBehavior{constructor(e,t,r){this.propertyName=e,this.value=t,this.styles=r}bind(e){yo.getNotifier(e).subscribe(this,this.propertyName),this.handleChange(e,this.propertyName)}unbind(e){yo.getNotifier(e).unsubscribe(this,this.propertyName),e.$fastController.removeStyles(this.styles)}handleChange(e,t){e[t]===this.value?e.$fastController.addStyles(this.styles):e.$fastController.removeStyles(this.styles)}}function display(e){return`:host([hidden]){display:none}:host{display:${e}}`}const Ti=function canUseFocusVisible(){if("boolean"==typeof ei)return ei;if(!function canUseDOM(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}())return ei=!1,ei;const e=document.createElement("style"),t=function getNonce(){const e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null}();null!==t&&e.setAttribute("nonce",t),document.head.appendChild(e);try{e.sheet.insertRule("foo:focus-visible {color:inherit}",0),ei=!0}catch(e){ei=!1}finally{document.head.removeChild(e)}return ei}()?"focus-visible":"focus";function clamp(e,t,r){return isNaN(e)||e<=t?t:e>=r?r:e}function normalize(e,t,r){return isNaN(e)||e<=t?0:e>=r?1:e/(r-t)}function denormalize(e,t,r){return isNaN(e)?t:t+e*(r-t)}function degreesToRadians(e){return e*(Math.PI/180)}function lerp(e,t,r){return isNaN(e)||e<=0?t:e>=1?r:t+e*(r-t)}function lerpAnglesInDegrees(e,t,r){if(e<=0)return t%360;if(e>=1)return r%360;const o=(t-r+360)%360;return o<=(r-t+360)%360?(t-o*e+360)%360:(t+o*e+360)%360}function roundToPrecisionSmall(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}class ColorHSL{constructor(e,t,r){this.h=e,this.s=t,this.l=r}static fromObject(e){return!e||isNaN(e.h)||isNaN(e.s)||isNaN(e.l)?null:new ColorHSL(e.h,e.s,e.l)}equalValue(e){return this.h===e.h&&this.s===e.s&&this.l===e.l}roundToPrecision(e){return new ColorHSL(roundToPrecisionSmall(this.h,e),roundToPrecisionSmall(this.s,e),roundToPrecisionSmall(this.l,e))}toObject(){return{h:this.h,s:this.s,l:this.l}}}class ColorHSV{constructor(e,t,r){this.h=e,this.s=t,this.v=r}static fromObject(e){return!e||isNaN(e.h)||isNaN(e.s)||isNaN(e.v)?null:new ColorHSV(e.h,e.s,e.v)}equalValue(e){return this.h===e.h&&this.s===e.s&&this.v===e.v}roundToPrecision(e){return new ColorHSV(roundToPrecisionSmall(this.h,e),roundToPrecisionSmall(this.s,e),roundToPrecisionSmall(this.v,e))}toObject(){return{h:this.h,s:this.s,v:this.v}}}class ColorLAB{constructor(e,t,r){this.l=e,this.a=t,this.b=r}static fromObject(e){return!e||isNaN(e.l)||isNaN(e.a)||isNaN(e.b)?null:new ColorLAB(e.l,e.a,e.b)}equalValue(e){return this.l===e.l&&this.a===e.a&&this.b===e.b}roundToPrecision(e){return new ColorLAB(roundToPrecisionSmall(this.l,e),roundToPrecisionSmall(this.a,e),roundToPrecisionSmall(this.b,e))}toObject(){return{l:this.l,a:this.a,b:this.b}}}ColorLAB.epsilon=216/24389,ColorLAB.kappa=24389/27;class ColorLCH{constructor(e,t,r){this.l=e,this.c=t,this.h=r}static fromObject(e){return!e||isNaN(e.l)||isNaN(e.c)||isNaN(e.h)?null:new ColorLCH(e.l,e.c,e.h)}equalValue(e){return this.l===e.l&&this.c===e.c&&this.h===e.h}roundToPrecision(e){return new ColorLCH(roundToPrecisionSmall(this.l,e),roundToPrecisionSmall(this.c,e),roundToPrecisionSmall(this.h,e))}toObject(){return{l:this.l,c:this.c,h:this.h}}}class ColorRGBA64{constructor(e,t,r,o){this.r=e,this.g=t,this.b=r,this.a="number"!=typeof o||isNaN(o)?1:o}static fromObject(e){return!e||isNaN(e.r)||isNaN(e.g)||isNaN(e.b)?null:new ColorRGBA64(e.r,e.g,e.b,e.a)}equalValue(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}toStringHexRGB(){return"#"+[this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringHexRGBA(){return this.toStringHexRGB()+this.formatHexValue(this.a)}toStringHexARGB(){return"#"+[this.a,this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringWebRGB(){return`rgb(${Math.round(denormalize(this.r,0,255))},${Math.round(denormalize(this.g,0,255))},${Math.round(denormalize(this.b,0,255))})`}toStringWebRGBA(){return`rgba(${Math.round(denormalize(this.r,0,255))},${Math.round(denormalize(this.g,0,255))},${Math.round(denormalize(this.b,0,255))},${clamp(this.a,0,1)})`}roundToPrecision(e){return new ColorRGBA64(roundToPrecisionSmall(this.r,e),roundToPrecisionSmall(this.g,e),roundToPrecisionSmall(this.b,e),roundToPrecisionSmall(this.a,e))}clamp(){return new ColorRGBA64(clamp(this.r,0,1),clamp(this.g,0,1),clamp(this.b,0,1),clamp(this.a,0,1))}toObject(){return{r:this.r,g:this.g,b:this.b,a:this.a}}formatHexValue(e){return function getHexStringForByte(e){const t=Math.round(clamp(e,0,255)).toString(16);return 1===t.length?"0"+t:t}(denormalize(e,0,255))}}class ColorXYZ{constructor(e,t,r){this.x=e,this.y=t,this.z=r}static fromObject(e){return!e||isNaN(e.x)||isNaN(e.y)||isNaN(e.z)?null:new ColorXYZ(e.x,e.y,e.z)}equalValue(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}roundToPrecision(e){return new ColorXYZ(roundToPrecisionSmall(this.x,e),roundToPrecisionSmall(this.y,e),roundToPrecisionSmall(this.z,e))}toObject(){return{x:this.x,y:this.y,z:this.z}}}function rgbToLinearLuminance(e){return.2126*e.r+.7152*e.g+.0722*e.b}function rgbToRelativeLuminance(e){function luminanceHelper(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return rgbToLinearLuminance(new ColorRGBA64(luminanceHelper(e.r),luminanceHelper(e.g),luminanceHelper(e.b),1))}ColorXYZ.whitePoint=new ColorXYZ(.95047,1,1.08883);const calculateContrastRatio=(e,t)=>(e+.05)/(t+.05);function contrastRatio(e,t){const r=rgbToRelativeLuminance(e),o=rgbToRelativeLuminance(t);return r>o?calculateContrastRatio(r,o):calculateContrastRatio(o,r)}function rgbToHSL(e){const t=Math.max(e.r,e.g,e.b),r=Math.min(e.r,e.g,e.b),o=t-r;let i=0;0!==o&&(i=t===e.r?(e.g-e.b)/o%6*60:t===e.g?60*((e.b-e.r)/o+2):60*((e.r-e.g)/o+4)),i<0&&(i+=360);const n=(t+r)/2;let s=0;return 0!==o&&(s=o/(1-Math.abs(2*n-1))),new ColorHSL(i,s,n)}function hslToRGB(e,t=1){const r=(1-Math.abs(2*e.l-1))*e.s,o=r*(1-Math.abs(e.h/60%2-1)),i=e.l-r/2;let n=0,s=0,a=0;return e.h<60?(n=r,s=o,a=0):e.h<120?(n=o,s=r,a=0):e.h<180?(n=0,s=r,a=o):e.h<240?(n=0,s=o,a=r):e.h<300?(n=o,s=0,a=r):e.h<360&&(n=r,s=0,a=o),new ColorRGBA64(n+i,s+i,a+i,t)}function rgbToHSV(e){const t=Math.max(e.r,e.g,e.b),r=t-Math.min(e.r,e.g,e.b);let o=0;0!==r&&(o=t===e.r?(e.g-e.b)/r%6*60:t===e.g?60*((e.b-e.r)/r+2):60*((e.r-e.g)/r+4)),o<0&&(o+=360);let i=0;return 0!==t&&(i=r/t),new ColorHSV(o,i,t)}function labToLCH(e){let t=0;(Math.abs(e.b)>.001||Math.abs(e.a)>.001)&&(t=function radiansToDegrees(e){return e*(180/Math.PI)}(Math.atan2(e.b,e.a))),t<0&&(t+=360);const r=Math.sqrt(e.a*e.a+e.b*e.b);return new ColorLCH(e.l,r,t)}function rgbToXYZ(e){function rgbToXYZHelper(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}const t=rgbToXYZHelper(e.r),r=rgbToXYZHelper(e.g),o=rgbToXYZHelper(e.b);return new ColorXYZ(.4124564*t+.3575761*r+.1804375*o,.2126729*t+.7151522*r+.072175*o,.0193339*t+.119192*r+.9503041*o)}function xyzToRGB(e,t=1){function xyzToRGBHelper(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}const r=xyzToRGBHelper(3.2404542*e.x-1.5371385*e.y-.4985314*e.z),o=xyzToRGBHelper(-.969266*e.x+1.8760108*e.y+.041556*e.z),i=xyzToRGBHelper(.0556434*e.x-.2040259*e.y+1.0572252*e.z);return new ColorRGBA64(r,o,i,t)}function rgbToLAB(e){return function xyzToLAB(e){function xyzToLABHelper(e){return e>ColorLAB.epsilon?Math.pow(e,1/3):(ColorLAB.kappa*e+16)/116}const t=xyzToLABHelper(e.x/ColorXYZ.whitePoint.x),r=xyzToLABHelper(e.y/ColorXYZ.whitePoint.y),o=xyzToLABHelper(e.z/ColorXYZ.whitePoint.z);return new ColorLAB(116*r-16,500*(t-r),200*(r-o))}(rgbToXYZ(e))}function labToRGB(e,t=1){return xyzToRGB(function labToXYZ(e){const t=(e.l+16)/116,r=t+e.a/500,o=t-e.b/200,i=Math.pow(r,3),n=Math.pow(t,3),s=Math.pow(o,3);let a=0;a=i>ColorLAB.epsilon?i:(116*r-16)/ColorLAB.kappa;let l=0;l=e.l>ColorLAB.epsilon*ColorLAB.kappa?n:e.l/ColorLAB.kappa;let c=0;return c=s>ColorLAB.epsilon?s:(116*o-16)/ColorLAB.kappa,a=ColorXYZ.whitePoint.x*a,l=ColorXYZ.whitePoint.y*l,c=ColorXYZ.whitePoint.z*c,new ColorXYZ(a,l,c)}(e),t)}function rgbToLCH(e){return labToLCH(rgbToLAB(e))}function lchToRGB(e,t=1){return labToRGB(function lchToLAB(e){let t=0,r=0;return 0!==e.h&&(t=Math.cos(degreesToRadians(e.h))*e.c,r=Math.sin(degreesToRadians(e.h))*e.c),new ColorLAB(e.l,t,r)}(e),t)}function saturateViaLCH(e,t,r=18){const o=rgbToLCH(e);let i=o.c+t*r;return i<0&&(i=0),lchToRGB(new ColorLCH(o.l,i,o.h))}function blendMultiplyChannel(e,t){return e*t}function blendMultiply(e,t){return new ColorRGBA64(blendMultiplyChannel(e.r,t.r),blendMultiplyChannel(e.g,t.g),blendMultiplyChannel(e.b,t.b),1)}function blendOverlayChannel(e,t){return clamp(e<.5?2*t*e:1-2*(1-t)*(1-e),0,1)}function blendOverlay(e,t){return new ColorRGBA64(blendOverlayChannel(e.r,t.r),blendOverlayChannel(e.g,t.g),blendOverlayChannel(e.b,t.b),1)}var _i,Si;function interpolateByColorSpace(e,t,r,o){if(isNaN(e)||e<=0)return r;if(e>=1)return o;switch(t){case Si.HSL:return hslToRGB(function interpolateHSL(e,t,r){return isNaN(e)||e<=0?t:e>=1?r:new ColorHSL(lerpAnglesInDegrees(e,t.h,r.h),lerp(e,t.s,r.s),lerp(e,t.l,r.l))}(e,rgbToHSL(r),rgbToHSL(o)));case Si.HSV:return function hsvToRGB(e,t=1){const r=e.s*e.v,o=r*(1-Math.abs(e.h/60%2-1)),i=e.v-r;let n=0,s=0,a=0;return e.h<60?(n=r,s=o,a=0):e.h<120?(n=o,s=r,a=0):e.h<180?(n=0,s=r,a=o):e.h<240?(n=0,s=o,a=r):e.h<300?(n=o,s=0,a=r):e.h<360&&(n=r,s=0,a=o),new ColorRGBA64(n+i,s+i,a+i,t)}(function interpolateHSV(e,t,r){return isNaN(e)||e<=0?t:e>=1?r:new ColorHSV(lerpAnglesInDegrees(e,t.h,r.h),lerp(e,t.s,r.s),lerp(e,t.v,r.v))}(e,rgbToHSV(r),rgbToHSV(o)));case Si.XYZ:return xyzToRGB(function interpolateXYZ(e,t,r){return isNaN(e)||e<=0?t:e>=1?r:new ColorXYZ(lerp(e,t.x,r.x),lerp(e,t.y,r.y),lerp(e,t.z,r.z))}(e,rgbToXYZ(r),rgbToXYZ(o)));case Si.LAB:return labToRGB(function interpolateLAB(e,t,r){return isNaN(e)||e<=0?t:e>=1?r:new ColorLAB(lerp(e,t.l,r.l),lerp(e,t.a,r.a),lerp(e,t.b,r.b))}(e,rgbToLAB(r),rgbToLAB(o)));case Si.LCH:return lchToRGB(function interpolateLCH(e,t,r){return isNaN(e)||e<=0?t:e>=1?r:new ColorLCH(lerp(e,t.l,r.l),lerp(e,t.c,r.c),lerpAnglesInDegrees(e,t.h,r.h))}(e,rgbToLCH(r),rgbToLCH(o)));default:return function interpolateRGB(e,t,r){return isNaN(e)||e<=0?t:e>=1?r:new ColorRGBA64(lerp(e,t.r,r.r),lerp(e,t.g,r.g),lerp(e,t.b,r.b),lerp(e,t.a,r.a))}(e,r,o)}}!function(e){e[e.Burn=0]="Burn",e[e.Color=1]="Color",e[e.Darken=2]="Darken",e[e.Dodge=3]="Dodge",e[e.Lighten=4]="Lighten",e[e.Multiply=5]="Multiply",e[e.Overlay=6]="Overlay",e[e.Screen=7]="Screen"}(_i||(_i={})),function(e){e[e.RGB=0]="RGB",e[e.HSL=1]="HSL",e[e.HSV=2]="HSV",e[e.XYZ=3]="XYZ",e[e.LAB=4]="LAB",e[e.LCH=5]="LCH"}(Si||(Si={}));class ColorScale{constructor(e){if(null==e||0===e.length)throw new Error("The stops argument must be non-empty");this.stops=this.sortColorScaleStops(e)}static createBalancedColorScale(e){if(null==e||0===e.length)throw new Error("The colors argument must be non-empty");const t=new Array(e.length);for(let r=0;r<e.length;r++)0===r?t[r]={color:e[r],position:0}:r===e.length-1?t[r]={color:e[r],position:1}:t[r]={color:e[r],position:r*(1/(e.length-1))};return new ColorScale(t)}getColor(e,t=Si.RGB){if(1===this.stops.length)return this.stops[0].color;if(e<=0)return this.stops[0].color;if(e>=1)return this.stops[this.stops.length-1].color;let r=0;for(let t=0;t<this.stops.length;t++)this.stops[t].position<=e&&(r=t);let o=r+1;o>=this.stops.length&&(o=this.stops.length-1);return interpolateByColorSpace((e-this.stops[r].position)*(1/(this.stops[o].position-this.stops[r].position)),t,this.stops[r].color,this.stops[o].color)}trim(e,t,r=Si.RGB){if(e<0||t>1||t<e)throw new Error("Invalid bounds");if(e===t)return new ColorScale([{color:this.getColor(e,r),position:0}]);const o=[];for(let r=0;r<this.stops.length;r++)this.stops[r].position>=e&&this.stops[r].position<=t&&o.push(this.stops[r]);if(0===o.length)return new ColorScale([{color:this.getColor(e),position:e},{color:this.getColor(t),position:t}]);o[0].position!==e&&o.unshift({color:this.getColor(e),position:e}),o[o.length-1].position!==t&&o.push({color:this.getColor(t),position:t});const i=t-e,n=new Array(o.length);for(let t=0;t<o.length;t++)n[t]={color:o[t].color,position:(o[t].position-e)/i};return new ColorScale(n)}findNextColor(e,t,r=!1,o=Si.RGB,i=.005,n=32){isNaN(e)||e<=0?e=0:e>=1&&(e=1);const s=this.getColor(e,o),a=r?0:1;if(contrastRatio(s,this.getColor(a,o))<=t)return a;let l=r?0:e,c=r?e:0,d=a,u=0;for(;u<=n;){d=Math.abs(c-l)/2+l;const e=contrastRatio(s,this.getColor(d,o));if(Math.abs(e-t)<=i)return d;e>t?r?l=d:c=d:r?c=d:l=d,u++}return d}clone(){const e=new Array(this.stops.length);for(let t=0;t<e.length;t++)e[t]={color:this.stops[t].color,position:this.stops[t].position};return new ColorScale(e)}sortColorScaleStops(e){return e.sort(((e,t)=>{const r=e.position,o=t.position;return r<o?-1:r>o?1:0}))}}const Ei=/^#((?:[0-9a-f]{6}|[0-9a-f]{3}))$/i;function parseColorHexRGB(e){const t=Ei.exec(e);if(null===t)return null;let r=t[1];if(3===r.length){const e=r.charAt(0),t=r.charAt(1),o=r.charAt(2);r=e.concat(e,t,t,o,o)}const o=parseInt(r,16);return isNaN(o)?null:new ColorRGBA64(normalize((16711680&o)>>>16,0,255),normalize((65280&o)>>>8,0,255),normalize(255&o,0,255),1)}class ColorPalette{constructor(e){this.config=Object.assign({},ColorPalette.defaultPaletteConfig,e),this.palette=[],this.updatePaletteColors()}updatePaletteGenerationValues(e){let t=!1;for(const r in e)this.config[r]&&(this.config[r].equalValue?this.config[r].equalValue(e[r])||(this.config[r]=e[r],t=!0):e[r]!==this.config[r]&&(this.config[r]=e[r],t=!0));return t&&this.updatePaletteColors(),t}updatePaletteColors(){const e=this.generatePaletteColorScale();for(let t=0;t<this.config.steps;t++)this.palette[t]=e.getColor(t/(this.config.steps-1),this.config.interpolationMode)}generatePaletteColorScale(){const e=rgbToHSL(this.config.baseColor),t=new ColorScale([{position:0,color:this.config.scaleColorLight},{position:.5,color:this.config.baseColor},{position:1,color:this.config.scaleColorDark}]).trim(this.config.clipLight,1-this.config.clipDark);let r=t.getColor(0),o=t.getColor(1);if(e.s>=this.config.saturationAdjustmentCutoff&&(r=saturateViaLCH(r,this.config.saturationLight),o=saturateViaLCH(o,this.config.saturationDark)),0!==this.config.multiplyLight){const e=blendMultiply(this.config.baseColor,r);r=interpolateByColorSpace(this.config.multiplyLight,this.config.interpolationMode,r,e)}if(0!==this.config.multiplyDark){const e=blendMultiply(this.config.baseColor,o);o=interpolateByColorSpace(this.config.multiplyDark,this.config.interpolationMode,o,e)}if(0!==this.config.overlayLight){const e=blendOverlay(this.config.baseColor,r);r=interpolateByColorSpace(this.config.overlayLight,this.config.interpolationMode,r,e)}if(0!==this.config.overlayDark){const e=blendOverlay(this.config.baseColor,o);o=interpolateByColorSpace(this.config.overlayDark,this.config.interpolationMode,o,e)}return this.config.baseScalePosition?this.config.baseScalePosition<=0?new ColorScale([{position:0,color:this.config.baseColor},{position:1,color:o.clamp()}]):this.config.baseScalePosition>=1?new ColorScale([{position:0,color:r.clamp()},{position:1,color:this.config.baseColor}]):new ColorScale([{position:0,color:r.clamp()},{position:this.config.baseScalePosition,color:this.config.baseColor},{position:1,color:o.clamp()}]):new ColorScale([{position:0,color:r.clamp()},{position:.5,color:this.config.baseColor},{position:1,color:o.clamp()}])}}ColorPalette.defaultPaletteConfig={baseColor:parseColorHexRGB("#808080"),steps:11,interpolationMode:Si.RGB,scaleColorLight:new ColorRGBA64(1,1,1,1),scaleColorDark:new ColorRGBA64(0,0,0,1),clipLight:.185,clipDark:.16,saturationAdjustmentCutoff:.05,saturationLight:.35,saturationDark:1.25,overlayLight:0,overlayDark:.25,multiplyLight:0,multiplyDark:0,baseScalePosition:.5},ColorPalette.greyscalePaletteConfig={baseColor:parseColorHexRGB("#808080"),steps:11,interpolationMode:Si.RGB,scaleColorLight:new ColorRGBA64(1,1,1,1),scaleColorDark:new ColorRGBA64(0,0,0,1),clipLight:0,clipDark:0,saturationAdjustmentCutoff:0,saturationLight:0,saturationDark:0,overlayLight:0,overlayDark:0,multiplyLight:0,multiplyDark:0,baseScalePosition:.5},ColorPalette.defaultPaletteConfig.scaleColorLight,ColorPalette.defaultPaletteConfig.scaleColorDark;class ComponentStateColorPalette{constructor(e){this.palette=[],this.config=Object.assign({},ComponentStateColorPalette.defaultPaletteConfig,e),this.regenPalettes()}regenPalettes(){let e=this.config.steps;(isNaN(e)||e<3)&&(e=3);const t=.14,r=new ColorRGBA64(t,t,t,1),o=new ColorPalette(Object.assign(Object.assign({},ColorPalette.greyscalePaletteConfig),{baseColor:r,baseScalePosition:86/94,steps:e})).palette,i=(rgbToLinearLuminance(this.config.baseColor)+rgbToHSL(this.config.baseColor).l)/2,n=this.matchRelativeLuminanceIndex(i,o)/(e-1),s=this.matchRelativeLuminanceIndex(t,o)/(e-1),a=rgbToHSL(this.config.baseColor),l=hslToRGB(ColorHSL.fromObject({h:a.h,s:a.s,l:t})),c=hslToRGB(ColorHSL.fromObject({h:a.h,s:a.s,l:.06})),d=new Array(5);d[0]={position:0,color:new ColorRGBA64(1,1,1,1)},d[1]={position:n,color:this.config.baseColor},d[2]={position:s,color:l},d[3]={position:.99,color:c},d[4]={position:1,color:new ColorRGBA64(0,0,0,1)};const u=new ColorScale(d);this.palette=new Array(e);for(let t=0;t<e;t++){const r=u.getColor(t/(e-1),Si.RGB);this.palette[t]=r}}matchRelativeLuminanceIndex(e,t){let r=Number.MAX_VALUE,o=0,i=0;const n=t.length;for(;i<n;i++){const n=Math.abs(rgbToLinearLuminance(t[i])-e);n<r&&(r=n,o=i)}return o}}function contrast(e,t){const r=e.relativeLuminance>t.relativeLuminance?e:t,o=e.relativeLuminance>t.relativeLuminance?t:e;return(r.relativeLuminance+.05)/(o.relativeLuminance+.05)}ComponentStateColorPalette.defaultPaletteConfig={baseColor:parseColorHexRGB("#808080"),steps:94};const Ii=Object.freeze({create:(e,t,r)=>new SwatchRGBImpl(e,t,r),from:e=>new SwatchRGBImpl(e.r,e.g,e.b)});class SwatchRGBImpl extends ColorRGBA64{constructor(e,t,r){super(e,t,r,1),this.toColorString=this.toStringHexRGB,this.contrast=contrast.bind(null,this),this.createCSS=this.toColorString,this.relativeLuminance=rgbToRelativeLuminance(this)}static fromObject(e){return new SwatchRGBImpl(e.r,e.g,e.b)}}function binarySearch(e,t,r=0,o=e.length-1){if(o===r)return e[r];const i=Math.floor((o-r)/2)+r;return t(e[i])?binarySearch(e,t,r,i):binarySearch(e,t,i+1,o)}const xi=(-.1+Math.sqrt(.21))/2;function directionByIsDark(e){return function isDark(e){return e.relativeLuminance<=xi}(e)?-1:1}const Ai=Object.freeze({create:e=>PaletteRGBImpl.from(e)});class PaletteRGBImpl{constructor(e,t){this.closestIndexCache=new Map,this.source=e,this.swatches=t,this.reversedSwatches=Object.freeze([...this.swatches].reverse()),this.lastIndex=this.swatches.length-1}colorContrast(e,t,r,o){void 0===r&&(r=this.closestIndexOf(e));let i=this.swatches;const n=this.lastIndex;let s=r;void 0===o&&(o=directionByIsDark(e));return-1===o&&(i=this.reversedSwatches,s=n-s),binarySearch(i,(r=>contrast(e,r)>=t),s,n)}get(e){return this.swatches[e]||this.swatches[clamp(e,0,this.lastIndex)]}closestIndexOf(e){if(this.closestIndexCache.has(e.relativeLuminance))return this.closestIndexCache.get(e.relativeLuminance);let t=this.swatches.indexOf(e);if(-1!==t)return this.closestIndexCache.set(e.relativeLuminance,t),t;const r=this.swatches.reduce(((t,r)=>Math.abs(r.relativeLuminance-e.relativeLuminance)<Math.abs(t.relativeLuminance-e.relativeLuminance)?r:t));return t=this.swatches.indexOf(r),this.closestIndexCache.set(e.relativeLuminance,t),t}static from(e){return new PaletteRGBImpl(e,Object.freeze(new ComponentStateColorPalette({baseColor:ColorRGBA64.fromObject(e)}).palette.map((e=>{const t=parseColorHexRGB(e.toStringHexRGB());return Ii.create(t.r,t.g,t.b)}))))}}const Pi=Ii.create(1,1,1),Ri=Ii.create(0,0,0),Oi=Ii.create(.5,.5,.5),Ni=parseColorHexRGB("#0078D4"),Di=Ii.create(Ni.r,Ni.g,Ni.b);function baseLayerLuminanceSwatch(e){return Ii.create(e,e,e)}var Li;function neutralLayer2Index(e,t,r,o,i,n){return Math.max(e.closestIndexOf(baseLayerLuminanceSwatch(t))+r,o,i,n)}!function(e){e[e.LightMode=1]="LightMode",e[e.DarkMode=.23]="DarkMode"}(Li||(Li={}));const{create:Mi}=pi;Mi("direction").withDefault(ri.ltr);const $i=Mi("disabled-opacity").withDefault(.3),Ui=Mi("base-height-multiplier").withDefault(8);Mi("base-horizontal-spacing-multiplier").withDefault(3);const Fi=Mi("density").withDefault(0),Hi=Mi("design-unit").withDefault(4),Bi=Mi("control-corner-radius").withDefault(4),qi=Mi("layer-corner-radius").withDefault(4),zi=Mi("stroke-width").withDefault(1),ji=Mi("focus-stroke-width").withDefault(2),Vi=Mi("body-font").withDefault("Segoe UI, sans-serif"),Gi=Mi("type-ramp-base-font-size").withDefault("14px"),Ki=Mi("type-ramp-base-line-height").withDefault("20px"),Wi=Mi("type-ramp-minus-1-font-size").withDefault("12px"),Qi=Mi("type-ramp-minus-1-line-height").withDefault("16px");Mi("type-ramp-minus-2-font-size").withDefault("10px"),Mi("type-ramp-minus-2-line-height").withDefault("14px"),Mi("type-ramp-plus-1-font-size").withDefault("16px"),Mi("type-ramp-plus-1-line-height").withDefault("22px"),Mi("type-ramp-plus-2-font-size").withDefault("20px"),Mi("type-ramp-plus-2-line-height").withDefault("28px"),Mi("type-ramp-plus-3-font-size").withDefault("24px"),Mi("type-ramp-plus-3-line-height").withDefault("32px"),Mi("type-ramp-plus-4-font-size").withDefault("28px"),Mi("type-ramp-plus-4-line-height").withDefault("36px"),Mi("type-ramp-plus-5-font-size").withDefault("32px"),Mi("type-ramp-plus-5-line-height").withDefault("40px"),Mi("type-ramp-plus-6-font-size").withDefault("40px"),Mi("type-ramp-plus-6-line-height").withDefault("52px");const Yi=Mi("base-layer-luminance").withDefault(Li.LightMode);Mi("accent-fill-rest-delta").withDefault(0);const Ji=Mi("accent-fill-hover-delta").withDefault(4),Zi=Mi("accent-fill-active-delta").withDefault(-5),Xi=Mi("accent-fill-focus-delta").withDefault(0),en=Mi("accent-foreground-rest-delta").withDefault(0),tn=Mi("accent-foreground-hover-delta").withDefault(6),rn=Mi("accent-foreground-active-delta").withDefault(-4),on=Mi("accent-foreground-focus-delta").withDefault(0),nn=Mi("neutral-fill-rest-delta").withDefault(7),sn=Mi("neutral-fill-hover-delta").withDefault(10),an=Mi("neutral-fill-active-delta").withDefault(5),ln=Mi("neutral-fill-focus-delta").withDefault(0),cn=Mi("neutral-fill-input-rest-delta").withDefault(0),dn=Mi("neutral-fill-input-hover-delta").withDefault(0),un=Mi("neutral-fill-input-active-delta").withDefault(0),hn=Mi("neutral-fill-input-focus-delta").withDefault(0),pn=Mi("neutral-fill-inverse-rest-delta").withDefault(0),fn=Mi("neutral-fill-inverse-hover-delta").withDefault(-3),gn=Mi("neutral-fill-inverse-active-delta").withDefault(7),mn=Mi("neutral-fill-inverse-focus-delta").withDefault(0),vn=Mi("neutral-fill-layer-rest-delta").withDefault(3),bn=Mi("neutral-fill-stealth-rest-delta").withDefault(0),yn=Mi("neutral-fill-stealth-hover-delta").withDefault(5),wn=Mi("neutral-fill-stealth-active-delta").withDefault(3),Cn=Mi("neutral-fill-stealth-focus-delta").withDefault(0),kn=Mi("neutral-fill-strong-rest-delta").withDefault(0),Tn=Mi("neutral-fill-strong-hover-delta").withDefault(8),_n=Mi("neutral-fill-strong-active-delta").withDefault(-5),Sn=Mi("neutral-fill-strong-focus-delta").withDefault(0),En=Mi("neutral-stroke-rest-delta").withDefault(25),In=Mi("neutral-stroke-hover-delta").withDefault(40),xn=Mi("neutral-stroke-active-delta").withDefault(16),An=Mi("neutral-stroke-focus-delta").withDefault(25),Pn=Mi("neutral-stroke-divider-rest-delta").withDefault(8),Rn=Mi("neutral-stroke-strong-hover-delta").withDefault(40),On=Mi("neutral-stroke-strong-active-delta").withDefault(16),Nn=Mi("neutral-stroke-strong-focus-delta").withDefault(25),Dn=Mi({name:"neutral-palette",cssCustomPropertyName:null}).withDefault(Ai.create(Oi)),Ln=Mi({name:"accent-palette",cssCustomPropertyName:null}).withDefault(Ai.create(Di)),Mn=Mi({name:"neutral-layer-card-container-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralLayerCardContainer(e,t,r){const o=clamp(e.closestIndexOf(baseLayerLuminanceSwatch(t))-r,0,e.swatches.length-1);return e.get(o+r)}(Dn.getValueFor(e),Yi.getValueFor(e),vn.getValueFor(e))});Mi("neutral-layer-card-container").withDefault((e=>Mn.getValueFor(e).evaluate(e)));const $n=Mi({name:"neutral-layer-floating-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralLayerFloating(e,t,r){const o=e.closestIndexOf(baseLayerLuminanceSwatch(t))-r;return e.get(o-r)}(Dn.getValueFor(e),Yi.getValueFor(e),vn.getValueFor(e))});Mi("neutral-layer-floating").withDefault((e=>$n.getValueFor(e).evaluate(e)));const Un=Mi({name:"neutral-layer-1-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralLayer1$1(e,t){return e.get(e.closestIndexOf(baseLayerLuminanceSwatch(t)))}(Dn.getValueFor(e),Yi.getValueFor(e))}),Fn=Mi("neutral-layer-1").withDefault((e=>Un.getValueFor(e).evaluate(e))),Hn=Mi({name:"neutral-layer-2-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralLayer2(e,t,r,o,i,n){return e.get(neutralLayer2Index(e,t,r,o,i,n))}(Dn.getValueFor(e),Yi.getValueFor(e),vn.getValueFor(e),nn.getValueFor(e),sn.getValueFor(e),an.getValueFor(e))});Mi("neutral-layer-2").withDefault((e=>Hn.getValueFor(e).evaluate(e)));const Bn=Mi({name:"neutral-layer-3-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralLayer3(e,t,r,o,i,n){return e.get(neutralLayer2Index(e,t,r,o,i,n)+r)}(Dn.getValueFor(e),Yi.getValueFor(e),vn.getValueFor(e),nn.getValueFor(e),sn.getValueFor(e),an.getValueFor(e))});Mi("neutral-layer-3").withDefault((e=>Bn.getValueFor(e).evaluate(e)));const qn=Mi({name:"neutral-layer-4-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralLayer4(e,t,r,o,i,n){return e.get(neutralLayer2Index(e,t,r,o,i,n)+2*r)}(Dn.getValueFor(e),Yi.getValueFor(e),vn.getValueFor(e),nn.getValueFor(e),sn.getValueFor(e),an.getValueFor(e))});Mi("neutral-layer-4").withDefault((e=>qn.getValueFor(e).evaluate(e)));const zn=Mi("fill-color").withDefault((e=>Fn.getValueFor(e)));var jn;!function(e){e[e.normal=4.5]="normal",e[e.large=7]="large"}(jn||(jn={}));const Vn=Mi({name:"accent-fill-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>(jn.normal,(e,t)=>function accentFill(e,t,r,o,i,n,s,a,l){const c=e.source,d=e.closestIndexOf(c),u=d+1*o,h=d+1*i,p=d+1*n;return{rest:e.get(d),hover:e.get(u),active:e.get(h),focus:e.get(p)}}(Ln.getValueFor(e),Dn.getValueFor(e),t||zn.getValueFor(e),Ji.getValueFor(e),Zi.getValueFor(e),Xi.getValueFor(e),nn.getValueFor(e),sn.getValueFor(e),an.getValueFor(e)))(e,t)}),Gn=Mi("accent-fill-rest").withDefault((e=>Vn.getValueFor(e).evaluate(e).rest)),Kn=Mi("accent-fill-hover").withDefault((e=>Vn.getValueFor(e).evaluate(e).hover)),Wn=Mi("accent-fill-active").withDefault((e=>Vn.getValueFor(e).evaluate(e).active)),Qn=Mi("accent-fill-focus").withDefault((e=>Vn.getValueFor(e).evaluate(e).focus)),foregroundOnAccentByContrast=e=>(t,r)=>function foregroundOnAccent(e,t){return e.contrast(Pi)>=t?Pi:Ri}(r||Gn.getValueFor(t),e),Yn=Mi({name:"foreground-on-accent-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>foregroundOnAccentByContrast(jn.normal)(e,t)}),Jn=Mi("foreground-on-accent-rest").withDefault((e=>Yn.getValueFor(e).evaluate(e,Gn.getValueFor(e)))),Zn=Mi("foreground-on-accent-hover").withDefault((e=>Yn.getValueFor(e).evaluate(e,Kn.getValueFor(e)))),Xn=Mi("foreground-on-accent-active").withDefault((e=>Yn.getValueFor(e).evaluate(e,Wn.getValueFor(e))));Mi("foreground-on-accent-focus").withDefault((e=>Yn.getValueFor(e).evaluate(e,Qn.getValueFor(e))));const es=Mi({name:"foreground-on-accent-large-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>foregroundOnAccentByContrast(jn.large)(e,t)});Mi("foreground-on-accent-rest-large").withDefault((e=>es.getValueFor(e).evaluate(e))),Mi("foreground-on-accent-hover-large").withDefault((e=>es.getValueFor(e).evaluate(e,Kn.getValueFor(e)))),Mi("foreground-on-accent-active-large").withDefault((e=>es.getValueFor(e).evaluate(e,Wn.getValueFor(e)))),Mi("foreground-on-accent-focus-large").withDefault((e=>es.getValueFor(e).evaluate(e,Qn.getValueFor(e))));const accentForegroundByContrast=e=>(t,r)=>function accentForeground(e,t,r,o,i,n,s){const a=e.source,l=e.closestIndexOf(a),c=directionByIsDark(t),d=l+(1===c?Math.min(o,i):Math.max(c*o,c*i)),u=e.colorContrast(t,r,d,c),h=e.closestIndexOf(u),p=h+c*Math.abs(o-i);let f,g;return(1===c?o<i:c*o>c*i)?(f=h,g=p):(f=p,g=h),{rest:e.get(f),hover:e.get(g),active:e.get(f+c*n),focus:e.get(f+c*s)}}(Ln.getValueFor(t),r||zn.getValueFor(t),e,en.getValueFor(t),tn.getValueFor(t),rn.getValueFor(t),on.getValueFor(t)),ts=Mi({name:"accent-foreground-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>accentForegroundByContrast(jn.normal)(e,t)}),rs=Mi("accent-foreground-rest").withDefault((e=>ts.getValueFor(e).evaluate(e).rest)),os=Mi("accent-foreground-hover").withDefault((e=>ts.getValueFor(e).evaluate(e).hover)),is=Mi("accent-foreground-active").withDefault((e=>ts.getValueFor(e).evaluate(e).active));Mi("accent-foreground-focus").withDefault((e=>ts.getValueFor(e).evaluate(e).focus));const ns=Mi({name:"neutral-fill-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>function neutralFill(e,t,r,o,i,n){const s=e.closestIndexOf(t),a=s>=Math.max(r,o,i,n)?-1:1;return{rest:e.get(s+a*r),hover:e.get(s+a*o),active:e.get(s+a*i),focus:e.get(s+a*n)}}(Dn.getValueFor(e),t||zn.getValueFor(e),nn.getValueFor(e),sn.getValueFor(e),an.getValueFor(e),ln.getValueFor(e))}),ss=Mi("neutral-fill-rest").withDefault((e=>ns.getValueFor(e).evaluate(e).rest)),as=Mi("neutral-fill-hover").withDefault((e=>ns.getValueFor(e).evaluate(e).hover)),ls=Mi("neutral-fill-active").withDefault((e=>ns.getValueFor(e).evaluate(e).active));Mi("neutral-fill-focus").withDefault((e=>ns.getValueFor(e).evaluate(e).focus));const cs=Mi({name:"neutral-fill-input-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>function neutralFillInput(e,t,r,o,i,n){const s=directionByIsDark(t),a=e.closestIndexOf(t);return{rest:e.get(a-s*r),hover:e.get(a-s*o),active:e.get(a-s*i),focus:e.get(a-s*n)}}(Dn.getValueFor(e),t||zn.getValueFor(e),cn.getValueFor(e),dn.getValueFor(e),un.getValueFor(e),hn.getValueFor(e))}),ds=Mi("neutral-fill-input-rest").withDefault((e=>cs.getValueFor(e).evaluate(e).rest)),us=Mi("neutral-fill-input-hover").withDefault((e=>cs.getValueFor(e).evaluate(e).hover));Mi("neutral-fill-input-focus").withDefault((e=>cs.getValueFor(e).evaluate(e).focus));const hs=Mi("neutral-fill-input-active").withDefault((e=>cs.getValueFor(e).evaluate(e).active)),ps=Mi({name:"neutral-fill-inverse-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>function neutralFillInverse(e,t,r,o,i,n){const s=directionByIsDark(t),a=e.closestIndexOf(e.colorContrast(t,14)),l=a+s*Math.abs(r-o);let c,d;return(1===s?r<o:s*r>s*o)?(c=a,d=l):(c=l,d=a),{rest:e.get(c),hover:e.get(d),active:e.get(c+s*i),focus:e.get(c+s*n)}}(Dn.getValueFor(e),t||zn.getValueFor(e),pn.getValueFor(e),fn.getValueFor(e),gn.getValueFor(e),mn.getValueFor(e))});Mi("neutral-fill-inverse-rest").withDefault((e=>ps.getValueFor(e).evaluate(e).rest)),Mi("neutral-fill-inverse-hover").withDefault((e=>ps.getValueFor(e).evaluate(e).hover)),Mi("neutral-fill-inverse-active").withDefault((e=>ps.getValueFor(e).evaluate(e).active)),Mi("neutral-fill-inverse-focus").withDefault((e=>ps.getValueFor(e).evaluate(e).focus));const fs=Mi({name:"neutral-fill-layer-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>function neutralFillLayer(e,t,r){const o=e.closestIndexOf(t);return e.get(o-r)}(Dn.getValueFor(e),t||zn.getValueFor(e),vn.getValueFor(e))});Mi("neutral-fill-layer-rest").withDefault((e=>fs.getValueFor(e).evaluate(e)));const gs=Mi({name:"neutral-fill-stealth-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>function neutralFillStealth(e,t,r,o,i,n,s,a,l,c){const d=Math.max(r,o,i,n,s,a,l,c),u=e.closestIndexOf(t),h=u>=d?-1:1;return{rest:e.get(u+h*r),hover:e.get(u+h*o),active:e.get(u+h*i),focus:e.get(u+h*n)}}(Dn.getValueFor(e),t||zn.getValueFor(e),bn.getValueFor(e),yn.getValueFor(e),wn.getValueFor(e),Cn.getValueFor(e),nn.getValueFor(e),sn.getValueFor(e),an.getValueFor(e),ln.getValueFor(e))}),ms=Mi("neutral-fill-stealth-rest").withDefault((e=>gs.getValueFor(e).evaluate(e).rest)),vs=Mi("neutral-fill-stealth-hover").withDefault((e=>gs.getValueFor(e).evaluate(e).hover)),bs=Mi("neutral-fill-stealth-active").withDefault((e=>gs.getValueFor(e).evaluate(e).active));Mi("neutral-fill-stealth-focus").withDefault((e=>gs.getValueFor(e).evaluate(e).focus));const ys=Mi({name:"neutral-fill-strong-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>function neutralFillContrast(e,t,r,o,i,n){const s=directionByIsDark(t),a=e.closestIndexOf(e.colorContrast(t,4.5)),l=a+s*Math.abs(r-o);let c,d;return(1===s?r<o:s*r>s*o)?(c=a,d=l):(c=l,d=a),{rest:e.get(c),hover:e.get(d),active:e.get(c+s*i),focus:e.get(c+s*n)}}(Dn.getValueFor(e),t||zn.getValueFor(e),kn.getValueFor(e),Tn.getValueFor(e),_n.getValueFor(e),Sn.getValueFor(e))});Mi("neutral-fill-strong-rest").withDefault((e=>ys.getValueFor(e).evaluate(e).rest)),Mi("neutral-fill-strong-hover").withDefault((e=>ys.getValueFor(e).evaluate(e).hover)),Mi("neutral-fill-strong-active").withDefault((e=>ys.getValueFor(e).evaluate(e).active)),Mi("neutral-fill-strong-focus").withDefault((e=>ys.getValueFor(e).evaluate(e).focus));const ws=Mi({name:"neutral-stroke-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralStroke(e,t,r,o,i,n){const s=e.closestIndexOf(t),a=directionByIsDark(t),l=s+a*r,c=l+a*(o-r),d=l+a*(i-r),u=l+a*(n-r);return{rest:e.get(l),hover:e.get(c),active:e.get(d),focus:e.get(u)}}(Dn.getValueFor(e),zn.getValueFor(e),En.getValueFor(e),In.getValueFor(e),xn.getValueFor(e),An.getValueFor(e))}),Cs=Mi("neutral-stroke-rest").withDefault((e=>ws.getValueFor(e).evaluate(e).rest)),ks=Mi("neutral-stroke-hover").withDefault((e=>ws.getValueFor(e).evaluate(e).hover)),Ts=Mi("neutral-stroke-active").withDefault((e=>ws.getValueFor(e).evaluate(e).active));Mi("neutral-stroke-focus").withDefault((e=>ws.getValueFor(e).evaluate(e).focus));const _s=Mi({name:"neutral-stroke-divider-recipe",cssCustomPropertyName:null}).withDefault({evaluate:(e,t)=>function neutralDivider(e,t,r){return e.get(e.closestIndexOf(t)+directionByIsDark(t)*r)}(Dn.getValueFor(e),t||zn.getValueFor(e),Pn.getValueFor(e))});Mi("neutral-stroke-divider-rest").withDefault((e=>_s.getValueFor(e).evaluate(e)));const Ss=Mi({name:"neutral-stroke-strong-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralStrokeStrong(e,t,r,o,i,n){const s=directionByIsDark(t),a=e.colorContrast(t,r),l=e.closestIndexOf(a);return{rest:a,hover:e.get(l+s*o),active:e.get(l+s*i),focus:e.get(l+s*n)}}(Dn.getValueFor(e),zn.getValueFor(e),3,Rn.getValueFor(e),On.getValueFor(e),Nn.getValueFor(e))}),Es=Mi("neutral-stroke-strong-rest").withDefault((e=>Ss.getValueFor(e).evaluate(e).rest)),Is=Mi("neutral-stroke-strong-hover").withDefault((e=>Ss.getValueFor(e).evaluate(e).hover)),xs=Mi("neutral-stroke-strong-active").withDefault((e=>Ss.getValueFor(e).evaluate(e).active));Mi("neutral-stroke-strong-focus").withDefault((e=>Ss.getValueFor(e).evaluate(e).focus));const As=Mi({name:"focus-stroke-outer-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function focusStrokeOuter$1(e,t){return e.colorContrast(t,3.5)}(Dn.getValueFor(e),zn.getValueFor(e))}),Ps=Mi("focus-stroke-outer").withDefault((e=>As.getValueFor(e).evaluate(e))),Rs=Mi({name:"focus-stroke-inner-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function focusStrokeInner$1(e,t,r){return e.colorContrast(r,3.5,e.closestIndexOf(e.source),-1*directionByIsDark(t))}(Ln.getValueFor(e),zn.getValueFor(e),Ps.getValueFor(e))}),Os=Mi("focus-stroke-inner").withDefault((e=>Rs.getValueFor(e).evaluate(e))),Ns=Mi({name:"neutral-foreground-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralForeground(e,t){return e.colorContrast(t,14)}(Dn.getValueFor(e),zn.getValueFor(e))}),Ds=Mi("neutral-foreground-rest").withDefault((e=>Ns.getValueFor(e).evaluate(e))),Ls=Mi({name:"neutral-foreground-hint-recipe",cssCustomPropertyName:null}).withDefault({evaluate:e=>function neutralForegroundHint$1(e,t){return e.colorContrast(t,4.5)}(Dn.getValueFor(e),zn.getValueFor(e))}),Ms=Mi("neutral-foreground-hint").withDefault((e=>Ls.getValueFor(e).evaluate(e))),$s=(function cssPartial(e,...t){const{styles:r,behaviors:o}=collectStyles(e,t);return new CSSPartial(r,o)})`(${Ui} + ${Fi}) * ${Hi}`,Us=css`
  :host([appearance='accent']) {
    background: ${Gn};
    color: ${Jn};
  }

  :host([appearance='accent']:hover) {
    background: ${Kn};
    color: ${Zn};
  }

  :host([appearance='accent']:active) .control:active {
    background: ${Wn};
    color: ${Xn};
  }

  :host([appearance="accent"]) .control:${Ti} {
    box-shadow: 0 0 0 calc(${ji} * 1px) inset ${Os},
      0 0 0 calc((${ji} - ${zi}) * 1px) ${Ps};
  }
`.withBehaviors(ki(css`
      :host([appearance='accent']) .control {
        forced-color-adjust: none;
        background: ${ii.Highlight};
        color: ${ii.HighlightText};
      }

      :host([appearance='accent']) .control:hover,
      :host([appearance='accent']:active) .control:active {
        background: ${ii.HighlightText};
        border-color: ${ii.Highlight};
        color: ${ii.Highlight};
      }

      :host([appearance="accent"]) .control:${Ti} {
        border-color: ${ii.ButtonText};
        box-shadow: 0 0 0 2px ${ii.HighlightText} inset;
      }

      :host([appearance='accent'][href]) .control {
        background: ${ii.LinkText};
        color: ${ii.HighlightText};
      }

      :host([appearance='accent'][href]) .control:hover {
        background: ${ii.ButtonFace};
        border-color: ${ii.LinkText};
        box-shadow: none;
        color: ${ii.LinkText};
        fill: currentcolor;
      }

      :host([appearance="accent"][href]) .control:${Ti} {
        border-color: ${ii.LinkText};
        box-shadow: 0 0 0 2px ${ii.HighlightText} inset;
      }
    `));css`
  :host([appearance='hypertext']) {
    height: auto;
    font-size: inherit;
    line-height: inherit;
    background: transparent;
    min-width: 0;
  }

  :host([appearance='hypertext']) .control {
    display: inline;
    padding: 0;
    border: none;
    box-shadow: none;
    border-radius: 0;
    line-height: 1;
  }
  :host a.control:not(:link) {
    background-color: transparent;
    cursor: default;
  }
  :host([appearance='hypertext']) .control:link,
  :host([appearance='hypertext']) .control:visited {
    background: transparent;
    color: ${rs};
    border-bottom: calc(${zi} * 1px) solid ${rs};
  }
  :host([appearance='hypertext']) .control:hover {
    border-bottom-color: ${os};
  }
  :host([appearance='hypertext']) .control:active {
    border-bottom-color: ${is};
  }
  :host([appearance="hypertext"]) .control:${Ti} {
    border-bottom: calc(${ji} * 1px) solid ${Ps};
    margin-bottom: calc(calc(${zi} - ${ji}) * 1px);
  }
`.withBehaviors(ki(css`
      :host([appearance="hypertext"]) .control:${Ti} {
        color: ${ii.LinkText};
        border-bottom-color: ${ii.LinkText};
      }
    `));const Fs=css`
  :host([appearance='lightweight']) {
    background: transparent;
    color: ${rs};
  }

  :host([appearance='lightweight']) .control {
    padding: 0;
    height: initial;
    border: none;
    box-shadow: none;
    border-radius: 0;
  }

  :host([appearance='lightweight']:hover) {
    color: ${os};
  }

  :host([appearance='lightweight']:active) {
    color: ${is};
  }

  :host([appearance='lightweight']) .content {
    position: relative;
  }

  :host([appearance='lightweight']) .content::before {
    content: '';
    display: block;
    height: calc(${zi} * 1px);
    position: absolute;
    top: calc(1em + 3px);
    width: 100%;
  }

  :host([appearance='lightweight']:hover) .content::before {
    background: ${os};
  }

  :host([appearance='lightweight']:active) .content::before {
    background: ${is};
  }

  :host([appearance="lightweight"]) .control:${Ti} .content::before {
    background: ${Ds};
    height: calc(${ji} * 1px);
  }
`.withBehaviors(ki(css`
      :host([appearance='lightweight']) {
        color: ${ii.ButtonText};
      }
      :host([appearance="lightweight"]) .control:hover,
        :host([appearance="lightweight"]) .control:${Ti} {
        forced-color-adjust: none;
        background: ${ii.ButtonFace};
        color: ${ii.Highlight};
      }
      :host([appearance="lightweight"]) .control:hover .content::before,
        :host([appearance="lightweight"]) .control:${Ti} .content::before {
        background: ${ii.Highlight};
      }

      :host([appearance="lightweight"][href]) .control:hover,
        :host([appearance="lightweight"][href]) .control:${Ti} {
        background: ${ii.ButtonFace};
        box-shadow: none;
        color: ${ii.LinkText};
      }

      :host([appearance="lightweight"][href]) .control:hover .content::before,
        :host([appearance="lightweight"][href]) .control:${Ti} .content::before {
        background: ${ii.LinkText};
      }
    `)),Hs=css`
  :host([appearance='outline']) {
    background: transparent;
    border-color: ${Cs};
  }

  :host([appearance='outline']:hover) {
    border-color: ${ks};
  }

  :host([appearance='outline']:active) {
    border-color: ${Ts};
  }

  :host([appearance='outline']) .control {
    border-color: inherit;
  }

  :host([appearance="outline"]) .control:${Ti} {
    box-shadow: 0 0 0 calc((${ji} - ${zi}) * 1px) ${Ps};
    border-color: ${Ps};
  }
`.withBehaviors(ki(css`
      :host([appearance='outline']) {
        border-color: ${ii.ButtonText};
      }
      :host([appearance='outline'][href]) {
        border-color: ${ii.LinkText};
      }
    `)),Bs=css`
  :host([appearance='stealth']) {
    background: ${ms};
  }

  :host([appearance='stealth']:hover) {
    background: ${vs};
  }

  :host([appearance='stealth']:active) {
    background: ${bs};
  }
`.withBehaviors(ki(css`
      :host([appearance='stealth']),
      :host([appearance='stealth']) .control {
        forced-color-adjust: none;
        background: ${ii.ButtonFace};
        border-color: transparent;
        color: ${ii.ButtonText};
        fill: currentcolor;
      }

      :host([appearance='stealth']:hover) .control {
        background: ${ii.Highlight};
        border-color: ${ii.Highlight};
        color: ${ii.HighlightText};
        fill: currentcolor;
      }

      :host([appearance="stealth"]:${Ti}) .control {
        background: ${ii.Highlight};
        box-shadow: 0 0 0 1px ${ii.Highlight};
        color: ${ii.HighlightText};
        fill: currentcolor;
      }

      :host([appearance='stealth'][href]) .control {
        color: ${ii.LinkText};
      }

      :host([appearance="stealth"]:hover[href]) .control,
        :host([appearance="stealth"]:${Ti}[href]) .control {
        background: ${ii.LinkText};
        border-color: ${ii.LinkText};
        color: ${ii.HighlightText};
        fill: currentcolor;
      }

      :host([appearance="stealth"]:${Ti}[href]) .control {
        box-shadow: 0 0 0 1px ${ii.LinkText};
      }
    `));function appearanceBehavior(e,t){return new PropertyStyleSheetBehavior("appearance",e,t)}class Button extends Button$1{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){const e=this.defaultSlottedContent.filter((e=>e.nodeType===Node.ELEMENT_NODE));1===e.length&&e[0]instanceof SVGElement?this.control.classList.add("icon-only"):this.control.classList.remove("icon-only")}}__decorate$x([attr],Button.prototype,"appearance",void 0);const qs=Button.compose({baseName:"button",baseClass:Button$1,template:(e,t)=>html`
    <button
        class="control"
        part="control"
        ?autofocus="${e=>e.autofocus}"
        ?disabled="${e=>e.disabled}"
        form="${e=>e.formId}"
        formaction="${e=>e.formaction}"
        formenctype="${e=>e.formenctype}"
        formmethod="${e=>e.formmethod}"
        formnovalidate="${e=>e.formnovalidate}"
        formtarget="${e=>e.formtarget}"
        name="${e=>e.name}"
        type="${e=>e.type}"
        value="${e=>e.value}"
        aria-atomic="${e=>e.ariaAtomic}"
        aria-busy="${e=>e.ariaBusy}"
        aria-controls="${e=>e.ariaControls}"
        aria-current="${e=>e.ariaCurrent}"
        aria-describedby="${e=>e.ariaDescribedby}"
        aria-details="${e=>e.ariaDetails}"
        aria-disabled="${e=>e.ariaDisabled}"
        aria-errormessage="${e=>e.ariaErrormessage}"
        aria-expanded="${e=>e.ariaExpanded}"
        aria-flowto="${e=>e.ariaFlowto}"
        aria-haspopup="${e=>e.ariaHaspopup}"
        aria-hidden="${e=>e.ariaHidden}"
        aria-invalid="${e=>e.ariaInvalid}"
        aria-keyshortcuts="${e=>e.ariaKeyshortcuts}"
        aria-label="${e=>e.ariaLabel}"
        aria-labelledby="${e=>e.ariaLabelledby}"
        aria-live="${e=>e.ariaLive}"
        aria-owns="${e=>e.ariaOwns}"
        aria-pressed="${e=>e.ariaPressed}"
        aria-relevant="${e=>e.ariaRelevant}"
        aria-roledescription="${e=>e.ariaRoledescription}"
        ${ref("control")}
    >
        ${startSlotTemplate(0,t)}
        <span class="content" part="content">
            <slot ${slotted("defaultSlottedContent")}></slot>
        </span>
        ${endSlotTemplate(0,t)}
    </button>
`,styles:(e,t)=>css`
    :host([disabled]),
    :host([disabled]:hover),
    :host([disabled]:active) {
      opacity: ${$i};
      background-color: ${ss};
      cursor: ${"not-allowed"};
    }

    ${css`
    ${display("inline-flex")} :host {
      font-family: ${Vi};
      outline: none;
      font-size: ${Gi};
      line-height: ${Ki};
      height: calc(${$s} * 1px);
      min-width: calc(${$s} * 1px);
      background-color: ${ss};
      color: ${Ds};
      border-radius: calc(${Bi} * 1px);
      fill: currentcolor;
      cursor: pointer;
    }

    .control {
      background: transparent;
      height: inherit;
      flex-grow: 1;
      box-sizing: border-box;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 0 calc((10 + (${Hi} * 2 * ${Fi})) * 1px);
      white-space: nowrap;
      outline: none;
      text-decoration: none;
      border: calc(${zi} * 1px) solid transparent;
      color: inherit;
      border-radius: inherit;
      fill: inherit;
      cursor: inherit;
      font-family: inherit;
    }

    .control,
    .end,
    .start {
      font: inherit;
    }

    .control.icon-only {
      padding: 0;
      line-height: 0;
    }

    :host(:hover) {
      background-color: ${as};
    }

    :host(:active) {
      background-color: ${ls};
    }

    .control:${Ti} {
      border: calc(${zi} * 1px) solid ${Ps};
      box-shadow: 0 0 0 calc((${ji} - ${zi}) * 1px) ${Ps};
    }

    .control::-moz-focus-inner {
      border: 0;
    }

    .content {
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
      pointer-events: none;
    }

    ::slotted(svg) {
      ${""} width: 16px;
      height: 16px;
      pointer-events: none;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }
  `.withBehaviors(ki(css`
        :host,
        :host([appearance="neutral"]) .control {
          background-color: ${ii.ButtonFace};
          border-color: ${ii.ButtonText};
          color: ${ii.ButtonText};
          fill: currentcolor;
        }

        :host(:not([disabled][href]):hover),
        :host([appearance="neutral"]:not([disabled]):hover) .control {
          forced-color-adjust: none;
          background-color: ${ii.Highlight};
          color: ${ii.HighlightText};
        }

        .control:${Ti},
        :host([appearance="outline"]) .control:${Ti},
        :host([appearance="neutral"]:${Ti}) .control {
          forced-color-adjust: none;
          background-color: ${ii.Highlight};
          border-color: ${ii.ButtonText};
          box-shadow: 0 0 0 calc((${ji} - ${zi}) * 1px) ${ii.ButtonText};
          color: ${ii.HighlightText};
        }

        .control:not([disabled]):hover,
        :host([appearance="outline"]) .control:hover {
          border-color: ${ii.ButtonText};
        }

        :host([href]) .control {
          border-color: ${ii.LinkText};
          color: ${ii.LinkText};
        }

        :host([href]) .control:hover,
        :host(.neutral[href]) .control:hover,
        :host(.outline[href]) .control:hover,
        :host([href]) .control:${Ti}{
          forced-color-adjust: none;
          background: ${ii.ButtonFace};
          border-color: ${ii.LinkText};
          box-shadow: 0 0 0 1px ${ii.LinkText} inset;
          color: ${ii.LinkText};
          fill: currentcolor;
        }
    `))}
  `.withBehaviors(ki(css`
        :host([disabled]),
        :host([disabled]:hover),
        :host([disabled]:active),
        :host([disabled]) .control,
        :host([disabled]) .control:hover,
        :host([appearance='neutral'][disabled]:hover) .control {
          forced-color-adjust: none;
          background-color: ${ii.ButtonFace};
          border-color: ${ii.GrayText};
          color: ${ii.GrayText};
          opacity: 1;
        }
      `),appearanceBehavior("accent",css`
        :host([appearance='accent'][disabled]),
        :host([appearance='accent'][disabled]:hover),
        :host([appearance='accent'][disabled]:active) {
          background: ${Gn};
        }

        ${Us}
      `.withBehaviors(ki(css`
            :host([appearance='accent'][disabled]) .control,
            :host([appearance='accent'][disabled]) .control:hover {
              background: ${ii.ButtonFace};
              border-color: ${ii.GrayText};
              color: ${ii.GrayText};
            }
          `))),appearanceBehavior("lightweight",css`
        :host([appearance='lightweight'][disabled]:hover),
        :host([appearance='lightweight'][disabled]:active) {
          background-color: transparent;
          color: ${rs};
        }

        :host([appearance='lightweight'][disabled]) .content::before,
        :host([appearance='lightweight'][disabled]:hover) .content::before,
        :host([appearance='lightweight'][disabled]:active) .content::before {
          background: transparent;
        }

        ${Fs}
      `.withBehaviors(ki(css`
            :host([appearance='lightweight'][disabled]) .control {
              forced-color-adjust: none;
              color: ${ii.GrayText};
            }

            :host([appearance='lightweight'][disabled]) .control:hover .content::before {
              background: none;
            }
          `))),appearanceBehavior("outline",css`
        :host([appearance='outline'][disabled]:hover),
        :host([appearance='outline'][disabled]:active) {
          background: transparent;
          border-color: ${Cs};
        }

        ${Hs}
      `.withBehaviors(ki(css`
            :host([appearance='outline'][disabled]) .control {
              border-color: ${ii.GrayText};
            }
          `))),appearanceBehavior("stealth",css`
        :host([appearance='stealth'][disabled]),
        :host([appearance='stealth'][disabled]:hover),
        :host([appearance='stealth'][disabled]:active) {
          background: ${ms};
        }

        ${Bs}
      `.withBehaviors(ki(css`
            :host([appearance='stealth'][disabled]),
            :host([appearance='stealth'][disabled]:hover) {
              background: ${ii.ButtonFace};
            }

            :host([appearance='stealth'][disabled]) .control {
              background: ${ii.ButtonFace};
              border-color: transparent;
              color: ${ii.GrayText};
            }
          `)))),shadowOptions:{delegatesFocus:!0}});class Card extends Card$1{cardFillColorChanged(e,t){if(t){const e=parseColorHexRGB(t);null!==e&&(this.neutralPaletteSource=t,zn.setValueFor(this,Ii.create(e.r,e.g,e.b)))}}neutralPaletteSourceChanged(e,t){if(t){const e=parseColorHexRGB(t),r=Ii.create(e.r,e.g,e.b);Dn.setValueFor(this,Ai.create(r))}}handleChange(e,t){this.cardFillColor||zn.setValueFor(this,(t=>fs.getValueFor(t).evaluate(t,zn.getValueFor(e))))}connectedCallback(){super.connectedCallback();const e=composedParent(this);if(e){const t=yo.getNotifier(e);t.subscribe(this,"fillColor"),t.subscribe(this,"neutralPalette"),this.handleChange(e,"fillColor")}}}__decorate$x([attr({attribute:"card-fill-color",mode:"fromView"})],Card.prototype,"cardFillColor",void 0),__decorate$x([attr({attribute:"neutral-palette-source",mode:"fromView"})],Card.prototype,"neutralPaletteSource",void 0);const zs=Card.compose({baseName:"card",baseClass:Card$1,template:(e,t)=>html`
    <slot></slot>
`,styles:(e,t)=>css`
      ${display("block")} :host {
        --elevation: 4;
        display: block;
        contain: content;
        height: var(--card-height, 100%);
        width: var(--card-width, 100%);
        box-sizing: border-box;
        background: ${zn};
        color: ${Ds};
        border-radius: calc(${qi} * 1px);
        ${"box-shadow: 0 0 calc((var(--elevation) * 0.225px) + 2px) rgba(0, 0, 0, calc(.11 * (2 - var(--background-luminance, 1)))), 0 calc(var(--elevation) * 0.4px) calc((var(--elevation) * 0.9px)) rgba(0, 0, 0, calc(.13 * (2 - var(--background-luminance, 1))));"}
      }

      :host(:hover) {
        --elevation: 8;
      }

      :host(:focus-within) {
        --elevation: 8;
      }

      :host {
        content-visibility: auto;
      }
    `.withBehaviors(ki(css`
          :host {
            forced-color-adjust: none;
            background: ${ii.Canvas};
            box-shadow: 0 0 0 1px ${ii.CanvasText};
          }
        `))}),js=Checkbox.compose({baseName:"checkbox",template:(e,t)=>html`
    <template
        role="checkbox"
        aria-checked="${e=>e.checked}"
        aria-required="${e=>e.required}"
        aria-disabled="${e=>e.disabled}"
        aria-readonly="${e=>e.readOnly}"
        tabindex="${e=>e.disabled?null:0}"
        @keypress="${(e,t)=>e.keypressHandler(t.event)}"
        @click="${(e,t)=>e.clickHandler(t.event)}"
        class="${e=>e.readOnly?"readonly":""} ${e=>e.checked?"checked":""} ${e=>e.indeterminate?"indeterminate":""}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${t.checkedIndicator||""}
            </slot>
            <slot name="indeterminate-indicator">
                ${t.indeterminateIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${e=>e.defaultSlottedNodes&&e.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${slotted("defaultSlottedNodes")}></slot>
        </label>
    </template>
`,styles:(e,t)=>css`
    ${display("inline-flex")} :host {
      align-items: center;
      outline: none;
      margin: calc(${Hi} * 1px) 0;
      ${""} user-select: none;
    }

    .control {
      position: relative;
      width: calc((${$s} / 2 + ${Hi}) * 1px);
      height: calc((${$s} / 2 + ${Hi}) * 1px);
      box-sizing: border-box;
      border-radius: calc(${Bi} * 1px);
      border: calc(${zi} * 1px) solid ${Es};
      background: ${ds};
      outline: none;
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      font-family: ${Vi};
      color: ${Ds};
      ${""} padding-inline-start: calc(${Hi} * 2px + 2px);
      margin-inline-end: calc(${Hi} * 2px + 2px);
      cursor: pointer;
      font-size: ${Gi};
      line-height: ${Ki};
    }

    .checked-indicator {
      width: 100%;
      height: 100%;
      display: block;
      fill: ${Ds};
      opacity: 0;
      pointer-events: none;
    }

    .indeterminate-indicator {
      border-radius: calc((${Bi} / 2) * 1px);
      background: ${Ds};
      position: absolute;
      top: 50%;
      left: 50%;
      width: 50%;
      height: 50%;
      transform: translate(-50%, -50%);
      opacity: 0;
    }

    :host(:enabled) .control:hover {
      background: ${us};
      border-color: ${Is};
    }

    :host(:enabled) .control:active {
      background: ${hs};
      border-color: ${xs};
    }

    :host(:${Ti}) .control {
      box-shadow: 0 0 0 2px ${zn}, 0 0 0 4px ${Ps};
      border-color: ${Ps};
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${"not-allowed"};
    }

    :host(.checked:not(.indeterminate)) .checked-indicator,
    :host(.indeterminate) .indeterminate-indicator {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${$i};
    }
  `.withBehaviors(ki(css`
        .control {
          forced-color-adjust: none;
          border-color: ${ii.FieldText};
          background: ${ii.Field};
        }
        :host(:enabled) .control:hover,
        .control:active {
          border-color: ${ii.Highlight};
          background: ${ii.Field};
        }
        .checked-indicator {
          fill: ${ii.FieldText};
        }
        .indeterminate-indicator {
          background: ${ii.FieldText};
        }
        :host(:${Ti}) .control {
          border-color: ${ii.Highlight};
          box-shadow: 0 0 0 2px ${ii.Field}, 0 0 0 4px ${ii.FieldText};
        }
        :host(.checked:${Ti}:enabled) .control {
          box-shadow: 0 0 0 2px ${ii.Field}, 0 0 0 4px ${ii.FieldText};
        }
        :host(.checked) .control {
          background: ${ii.Highlight};
          border-color: ${ii.Highlight};
        }
        :host(.checked) .control:hover,
        .control:active {
          background: ${ii.HighlightText};
        }
        :host(.checked) .checked-indicator {
          fill: ${ii.HighlightText};
        }
        :host(.checked) .control:hover .checked-indicator {
          fill: ${ii.Highlight};
        }
        :host(.checked) .indeterminate-indicator {
          background: ${ii.HighlightText};
        }
        :host(.checked) .control:hover .indeterminate-indicator {
          background: ${ii.Highlight};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .control {
          forced-color-adjust: none;
          border-color: ${ii.GrayText};
          background: ${ii.Field};
        }
        :host(.disabled) .indeterminate-indicator,
        :host(.checked.disabled) .control:hover .indeterminate-indicator {
          forced-color-adjust: none;
          background: ${ii.GrayText};
        }
        :host(.disabled) .checked-indicator,
        :host(.checked.disabled) .control:hover .checked-indicator {
          forced-color-adjust: none;
          fill: ${ii.GrayText};
        }
      `)),checkedIndicator:'\n    <svg\n        aria-hidden="true"\n        part="checked-indicator"\n        class="checked-indicator"\n        viewBox="0 0 20 20"\n        xmlns="http://www.w3.org/2000/svg"\n    >\n        <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M8.143 12.6697L15.235 4.5L16.8 5.90363L8.23812 15.7667L3.80005 11.2556L5.27591 9.7555L8.143 12.6697Z"\n        />\n    </svg>\n  ',indeterminateIndicator:'\n    <div part="indeterminate-indicator" class="indeterminate-indicator"></div>\n  '});const Vs=class Progress extends BaseProgress{}.compose({baseName:"progress",template:(e,t)=>html`
    <template
        role="progressbar"
        aria-valuenow="${e=>e.value}"
        aria-valuemin="${e=>e.min}"
        aria-valuemax="${e=>e.max}"
        class="${e=>e.paused?"paused":""}"
    >
        ${when((e=>"number"==typeof e.value),html`
                <div class="progress" part="progress" slot="determinate">
                    <div
                        class="determinate"
                        part="determinate"
                        style="width: ${e=>e.percentComplete}%"
                    ></div>
                </div>
            `)}
        ${when((e=>"number"!=typeof e.value),html`
                <div class="progress" part="progress" slot="indeterminate">
                    <slot class="indeterminate" name="indeterminate">
                        ${t.indeterminateIndicator1||""}
                        ${t.indeterminateIndicator2||""}
                    </slot>
                </div>
            `)}
    </template>
`,styles:(e,t)=>css`
    ${display("flex")} :host {
      align-items: center;
      outline: none;
      height: calc(${Hi} * 1px);
      margin: calc(${Hi} * 1px) 0;
    }

    .progress {
      background-color: ${ss};
      border-radius: calc(${Hi} * 1px);
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      position: relative;
    }

    .determinate {
      background-color: ${Gn};
      border-radius: calc(${Hi} * 1px);
      height: 100%;
      transition: all 0.2s ease-in-out;
      display: flex;
    }

    .indeterminate {
      height: 100%;
      border-radius: calc(${Hi} * 1px);
      display: flex;
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .indeterminate-indicator-1 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${Gn};
      border-radius: calc(${Hi} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 40%;
      animation: indeterminate-1 2s infinite;
    }

    .indeterminate-indicator-2 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${Gn};
      border-radius: calc(${Hi} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 60%;
      animation: indeterminate-2 2s infinite;
    }

    :host(.paused) .indeterminate-indicator-1,
    :host(.paused) .indeterminate-indicator-2 {
      animation-play-state: paused;
      background-color: ${ss};
    }

    :host(.paused) .determinate {
      background-color: ${Ms};
    }

    @keyframes indeterminate-1 {
      0% {
        opacity: 1;
        transform: translateX(-100%);
      }
      70% {
        opacity: 1;
        transform: translateX(300%);
      }
      70.01% {
        opacity: 0;
      }
      100% {
        opacity: 0;
        transform: translateX(300%);
      }
    }

    @keyframes indeterminate-2 {
      0% {
        opacity: 0;
        transform: translateX(-150%);
      }
      29.99% {
        opacity: 0;
      }
      30% {
        opacity: 1;
        transform: translateX(-150%);
      }
      100% {
        transform: translateX(166.66%);
        opacity: 1;
      }
    }
  `.withBehaviors(ki(css`
        .indeterminate-indicator-1,
        .indeterminate-indicator-2,
        .determinate {
          forced-color-adjust: none;
          background-color: ${ii.FieldText};
        }
        .progress {
          background-color: ${ii.Field};
          border: calc(${zi} * 1px) solid ${ii.FieldText};
        }
        :host(.paused) .indeterminate-indicator-1,
        .indeterminate-indicator-2 {
          background-color: ${ii.Field};
        }
        :host(.paused) .determinate {
          background-color: ${ii.GrayText};
        }
      `)),indeterminateIndicator1:'\n    <span class="indeterminate-indicator-1" part="indeterminate-indicator-1"></span>\n  ',indeterminateIndicator2:'\n    <span class="indeterminate-indicator-1" part="indeterminate-indicator-1"></span>\n  '});const Gs=class ProgressRing extends BaseProgress{}.compose({baseName:"progress-ring",template:(e,t)=>html`
    <template
        role="progressbar"
        aria-valuenow="${e=>e.value}"
        aria-valuemin="${e=>e.min}"
        aria-valuemax="${e=>e.max}"
        class="${e=>e.paused?"paused":""}"
    >
        ${when((e=>"number"==typeof e.value),html`
                <svg
                    class="progress"
                    part="progress"
                    viewBox="0 0 16 16"
                    slot="determinate"
                >
                    <circle
                        class="background"
                        part="background"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                    <circle
                        class="determinate"
                        part="determinate"
                        style="stroke-dasharray: ${e=>44*e.percentComplete/100}px ${44}px"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                </svg>
            `)}
        ${when((e=>"number"!=typeof e.value),html`
                <slot name="indeterminate" slot="indeterminate">
                    ${t.indeterminateIndicator||""}
                </slot>
            `)}
    </template>
`,styles:(e,t)=>css`
      ${display("flex")} :host {
        align-items: center;
        outline: none;
        height: calc(${$s} * 1px);
        width: calc(${$s} * 1px);
        margin: calc(${$s} * 1px) 0;
      }

      .progress {
        height: 100%;
        width: 100%;
      }

      .background {
        stroke: ${ss};
        fill: none;
        stroke-width: 2px;
      }

      .determinate {
        stroke: ${Gn};
        fill: none;
        stroke-width: 2px;
        stroke-linecap: round;
        transform-origin: 50% 50%;
        transform: rotate(-90deg);
        transition: all 0.2s ease-in-out;
      }

      .indeterminate-indicator-1 {
        stroke: ${Gn};
        fill: none;
        stroke-width: 2px;
        stroke-linecap: round;
        transform-origin: 50% 50%;
        transform: rotate(-90deg);
        transition: all 0.2s ease-in-out;
        animation: spin-infinite 2s linear infinite;
      }

      :host(.paused) .indeterminate-indicator-1 {
        animation-play-state: paused;
        stroke: ${ss};
      }

      :host(.paused) .determinate {
        stroke: ${Ms};
      }

      @keyframes spin-infinite {
        0% {
          stroke-dasharray: 0.01px 43.97px;
          transform: rotate(0deg);
        }
        50% {
          stroke-dasharray: 21.99px 21.99px;
          transform: rotate(450deg);
        }
        100% {
          stroke-dasharray: 0.01px 43.97px;
          transform: rotate(1080deg);
        }
      }
    `.withBehaviors(ki(css`
          .indeterminate-indicator-1,
          .determinate {
            stroke: ${ii.FieldText};
          }
          .background {
            stroke: ${ii.Field};
          }
          :host(.paused) .indeterminate-indicator-1 {
            stroke: ${ii.Field};
          }
          :host(.paused) .determinate {
            stroke: ${ii.GrayText};
          }
        `)),indeterminateIndicator:'\n    <svg class="progress" part="progress" viewBox="0 0 16 16">\n        <circle\n            class="background"\n            part="background"\n            cx="8px"\n            cy="8px"\n            r="7px"\n        ></circle>\n        <circle\n            class="indeterminate-indicator-1"\n            part="indeterminate-indicator-1"\n            cx="8px"\n            cy="8px"\n            r="7px"\n        ></circle>\n    </svg>\n  '}),Ks=Tab.compose({baseName:"tab",template:(e,t)=>html`
    <template slot="tab" role="tab" aria-disabled="${e=>e.disabled}">
        <slot></slot>
    </template>
`,styles:(e,t)=>css`
      ${display("inline-flex")} :host {
        box-sizing: border-box;
        font-family: ${Vi};
        font-size: ${Gi};
        font-weight: 400;
        line-height: ${Ki};
        height: calc(${$s} * 1px);
        padding: 0 calc((6 + (${Hi} * 2 * ${Fi})) * 1px);
        color: ${Ds};
        border-radius: calc(${Bi} * 1px);
        border: calc(${zi} * 1px) solid transparent;
        align-items: center;
        justify-content: center;
        grid-row: 1;
        cursor: pointer;
      }

      :host([aria-selected='true']) {
        z-index: 2;
      }

      :host(:hover),
      :host(:active) {
        color: ${Ds};
      }

      :host(:${Ti}) {
        outline: none;
        border: calc(${zi} * 1px) solid ${Ps};
        box-shadow: 0 0 0 calc((${ji} - ${zi}) * 1px) ${Ps};
      }

      :host(:focus) {
        outline: none;
      }

      :host(.vertical) {
        justify-content: end;
        grid-column: 2;
      }

      :host(.vertical[aria-selected='true']) {
        z-index: 2;
      }

      :host(.vertical:hover),
      :host(.vertical:active) {
        color: ${Ds};
      }

      :host(.vertical:hover[aria-selected='true']) {
      }
    `.withBehaviors(ki(css`
          :host {
            forced-color-adjust: none;
            border-color: transparent;
            color: ${ii.ButtonText};
            fill: currentcolor;
          }
          :host(:hover),
          :host(.vertical:hover),
          :host([aria-selected='true']:hover) {
            background: ${ii.Highlight};
            color: ${ii.HighlightText};
            fill: currentcolor;
          }
          :host([aria-selected='true']) {
            background: ${ii.HighlightText};
            color: ${ii.Highlight};
            fill: currentcolor;
          }
          :host(:${Ti}) {
            border-color: ${ii.ButtonText};
            box-shadow: none;
          }
        `))}),Ws=class TabPanel extends FoundationElement{}.compose({baseName:"tab-panel",template:(e,t)=>html`
    <template slot="tabpanel" role="tabpanel">
        <slot></slot>
    </template>
`,styles:(e,t)=>css`
  ${display("block")} :host {
    box-sizing: border-box;
    font-family: ${Vi};
    font-size: ${Wi};
    font-weight: 400;
    line-height: ${Qi};
    padding: 0 calc((6 + (${Hi} * 2 * ${Fi})) * 1px);
  }
`}),Qs=Tabs.compose({baseName:"tabs",template:(e,t)=>html`
    <template class="${e=>e.orientation}">
        ${startSlotTemplate(0,t)}
        <div class="tablist" part="tablist" role="tablist">
            <slot class="tab" name="tab" part="tab" ${slotted("tabs")}></slot>

            ${when((e=>e.showActiveIndicator),html`
                    <div
                        ${ref("activeIndicatorRef")}
                        class="activeIndicator"
                        part="activeIndicator"
                    ></div>
                `)}
        </div>
        ${endSlotTemplate(0,t)}
        <div class="tabpanel">
            <slot name="tabpanel" part="tabpanel" ${slotted("tabpanels")}></slot>
        </div>
    </template>
`,styles:(e,t)=>css`
      ${display("grid")} :host {
        box-sizing: border-box;
        font-family: ${Vi};
        font-size: ${Gi};
        line-height: ${Ki};
        color: ${Ds};
        grid-template-columns: auto 1fr auto;
        grid-template-rows: auto 1fr;
      }

      .tablist {
        display: grid;
        grid-template-rows: auto auto;
        grid-template-columns: auto;
        position: relative;
        width: max-content;
        align-self: end;
      }

      .start,
      .end {
        align-self: center;
      }

      .activeIndicator {
        grid-row: 2;
        grid-column: 1;
        width: 20px;
        height: 3px;
        border-radius: calc(${Bi} * 1px);
        justify-self: center;
        background: ${Gn};
      }

      .activeIndicatorTransition {
        transition: transform 0.2s ease-in-out;
      }

      .tabpanel {
        grid-row: 2;
        grid-column-start: 1;
        grid-column-end: 4;
        position: relative;
      }

      :host(.vertical) {
        grid-template-rows: auto 1fr auto;
        grid-template-columns: auto 1fr;
      }

      :host(.vertical) .tablist {
        grid-row-start: 2;
        grid-row-end: 2;
        display: grid;
        grid-template-rows: auto;
        grid-template-columns: auto 1fr;
        position: relative;
        width: max-content;
        justify-self: end;
        width: 100%;
      }

      :host(.vertical) .tabpanel {
        grid-column: 2;
        grid-row-start: 1;
        grid-row-end: 4;
      }

      :host(.vertical) .end {
        grid-row: 3;
      }

      :host(.vertical) .activeIndicator {
        grid-column: 1;
        grid-row: 1;
        width: 3px;
        height: 20px;
        border-radius: calc(${Bi} * 1px);
        align-self: center;
        background: ${Gn};
      }

      :host(.vertical) .activeIndicatorTransition {
        transition: transform 0.2s linear;
      }
    `.withBehaviors(ki(css`
          .activeIndicator,
          :host(.vertical) .activeIndicator {
            forced-color-adjust: none;
            background: ${ii.Highlight};
          }
        `))}),textFieldFilledStyles=(e,t)=>css`
    :host([appearance='filled']) .root {
      background: ${ss};
      border-color: transparent;
    }

    :host([appearance='filled']:hover:not(.disabled)) .root {
      background: ${as};
      border-color: transparent;
    }

    :host([appearance='filled']:focus-within:not(.disabled)) .root {
      border-color: transparent;
      box-shadow: none;
    }
    ${css`
  :host([appearance='filled']:not(.disabled):active)::after,
  :host([appearance='filled']:not(.disabled):focus-within:not(:active))::after {
    content: '';
    position: absolute;
    bottom: 0;
    border-bottom: calc(${ji} * 1px) solid ${Gn};
    border-bottom-left-radius: calc(${Bi} * 1px);
    border-bottom-right-radius: calc(${Bi} * 1px);
    z-index: 2;
    transition: all 300ms cubic-bezier(0.1, 0.9, 0.2, 1);
  }

  :host([appearance='filled']:not(.disabled):active)::after {
    left: 50%;
    width: 40%;
    transform: translateX(-50%);
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
  }

  :host([appearance='filled']:not(.disabled):focus-within:not(:active))::after {
    left: 0;
    width: 100%;
  }
`}
  `.withBehaviors(ki(css`
        :host([appearance='filled']) .root {
          background: ${ii.Field};
          border-color: ${ii.FieldText};
        }
        :host([appearance='filled']:hover:not([disabled])) .root,
        :host([appearance='filled']:focus-within:not([disabled])) .root {
          background: ${ii.Field};
          border-color: ${ii.FieldText};
        }
        :host([appearance='filled']:active:not([disabled])) .root {
          background: ${ii.Field};
          border-color: ${ii.FieldText};
        }
        :host([appearance='filled']:not([disabled]):active)::after,
        :host([appearance='filled']:not([disabled]):focus-within:not(:active))::after {
          border-bottom-color: ${ii.Highlight};
        }
        :host([appearance='filled'][disabled]) .root {
          border-color: ${ii.GrayText};
          background: ${ii.Field};
        }
      `));class TextField extends TextField$1{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}}__decorate$x([attr],TextField.prototype,"appearance",void 0);const Ys=TextField.compose({baseName:"text-field",baseClass:TextField$1,template:(e,t)=>html`
    <template
        class="
            ${e=>e.readOnly?"readonly":""}
        "
    >
        <label
            part="label"
            for="control"
            class="${e=>e.defaultSlottedNodes&&e.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot
                ${slotted({property:"defaultSlottedNodes",filter:whitespaceFilter})}
            ></slot>
        </label>
        <div class="root" part="root">
            ${startSlotTemplate(0,t)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${e=>e.handleTextInput()}"
                @change="${e=>e.handleChange()}"
                ?autofocus="${e=>e.autofocus}"
                ?disabled="${e=>e.disabled}"
                list="${e=>e.list}"
                maxlength="${e=>e.maxlength}"
                minlength="${e=>e.minlength}"
                pattern="${e=>e.pattern}"
                placeholder="${e=>e.placeholder}"
                ?readonly="${e=>e.readOnly}"
                ?required="${e=>e.required}"
                size="${e=>e.size}"
                ?spellcheck="${e=>e.spellcheck}"
                :value="${e=>e.value}"
                type="${e=>e.type}"
                aria-atomic="${e=>e.ariaAtomic}"
                aria-busy="${e=>e.ariaBusy}"
                aria-controls="${e=>e.ariaControls}"
                aria-current="${e=>e.ariaCurrent}"
                aria-describedby="${e=>e.ariaDescribedby}"
                aria-details="${e=>e.ariaDetails}"
                aria-disabled="${e=>e.ariaDisabled}"
                aria-errormessage="${e=>e.ariaErrormessage}"
                aria-flowto="${e=>e.ariaFlowto}"
                aria-haspopup="${e=>e.ariaHaspopup}"
                aria-hidden="${e=>e.ariaHidden}"
                aria-invalid="${e=>e.ariaInvalid}"
                aria-keyshortcuts="${e=>e.ariaKeyshortcuts}"
                aria-label="${e=>e.ariaLabel}"
                aria-labelledby="${e=>e.ariaLabelledby}"
                aria-live="${e=>e.ariaLive}"
                aria-owns="${e=>e.ariaOwns}"
                aria-relevant="${e=>e.ariaRelevant}"
                aria-roledescription="${e=>e.ariaRoledescription}"
                ${ref("control")}
            />
            ${endSlotTemplate(0,t)}
        </div>
    </template>
`,styles:(e,t)=>css`
    ${display("inline-block")} :host {
      font-family: ${Vi};
      outline: none;
      user-select: none;
      position: relative;
    }

    .root {
      box-sizing: border-box;
      position: relative;
      display: flex;
      flex-direction: row;
      color: ${Ds};
      background: ${ds};
      border-radius: calc(${Bi} * 1px);
      border: calc(${zi} * 1px) solid ${Cs};
      height: calc(${$s} * 1px);
    }

    .control {
      -webkit-appearance: none;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      width: 100%;
      margin-top: auto;
      margin-bottom: auto;
      border: none;
      padding: 0 calc(${Hi} * 2px + 1px);
      color: ${Ds};
      font-family: inherit;
      font-size: ${Gi};
      line-height: ${Ki};
    }

    .control:hover,
    .control:${Ti},
    .control:disabled,
    .control:active {
      outline: none;
    }

    .label {
      display: block;
      color: ${Ds};
      cursor: pointer;
      font-size: ${Gi};
      line-height: ${Ki};
      margin-bottom: 4px;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .start,
    .end {
      display: flex;
      margin: auto;
      fill: currentcolor;
    }

    ::slotted(svg) {
      ${""} width: 16px;
      height: 16px;
    }

    .start {
      margin-inline-start: 11px;
    }

    .end {
      margin-inline-end: 11px;
    }

    :host(:hover:not(.disabled)) .root {
      background: ${us};
      border-color: ${ks};
    }

    :host(:focus-within:not(.disabled)) .root {
      border-color: ${Ps};
      box-shadow: 0 0 0 1px ${Ps} inset;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${"not-allowed"};
    }

    :host(.disabled) {
      opacity: ${$i};
    }
  `.withBehaviors(appearanceBehavior("filled",textFieldFilledStyles()),ki(css`
        .root {
          forced-color-adjust: none;
          background: ${ii.Field};
          border-color: ${ii.FieldText};
        }
        :host(:hover:not(.disabled)) .root {
          background: ${ii.Field};
          border-color: ${ii.Highlight};
        }
        .start,
        .end {
          fill: ${ii.ButtonText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .root {
          border-color: ${ii.GrayText};
          background: ${ii.Field};
        }
        :host(:focus-within:enabled) .root {
          border-color: ${ii.Highlight};
          box-shadow: 0 0 0 1px ${ii.Highlight} inset;
        }
        .control {
          color: ${ii.ButtonText};
        }
        ::placeholder,
        ::-webkit-input-placeholder {
          color: ${ii.FieldText};
        }
        :host(.disabled) ::placeholder,
        :host(.disabled) ::-webkit-input-placeholder,
        :host([disabled]) .label {
          color: ${ii.GrayText};
        }
      `)),shadowOptions:{delegatesFocus:!0}});const Js=function provideFluentDesignSystem(e){return yi.getOrCreate(e).withPrefix("fluent")}(),registerFluentComponents=(...e)=>{if(e&&e.length)for(const t of e)Js.register(t())};var __decorate$n=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$m=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$o=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};registerFluentComponents(Vs,qs,js,zs);let Zs=class MgtFileUpload extends MgtBaseComponent{constructor(){super(),this._dragCounter=0,this._dropEffect="copy",this._maxChunckSize=4194304,this._dialogTitle="",this._dialogContent="",this._dialogPrimaryButton="",this._dialogSecondaryButton="",this._dialogCheckBox="",this._applyAll=!1,this._applyAllConflitBehavior=null,this._maximumFiles=!1,this._maximumFileSize=!1,this._excludedFileType=!1,this.handleonDragOver=e=>__awaiter$o(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation(),e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.dropEffect=e.dataTransfer.dropEffect=this._dropEffect)})),this.handleonDragEnter=e=>__awaiter$o(this,void 0,void 0,(function*(){if(e.preventDefault(),e.stopPropagation(),this._dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0){e.dataTransfer.dropEffect=this._dropEffect;this.renderRoot.querySelector("#file-upload-border").classList.add("visible")}})),this.handleonDragLeave=e=>{if(e.preventDefault(),e.stopPropagation(),this._dragCounter--,0===this._dragCounter){this.renderRoot.querySelector("#file-upload-border").classList.remove("visible")}},this.handleonDrop=e=>__awaiter$o(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),e.dataTransfer&&e.dataTransfer.items&&this.getSelectedFiles(yield this.getFilesFromUploadArea(e.dataTransfer.items)),e.dataTransfer.clearData(),this._dragCounter=0})),this.filesToUpload=[]}static get styles(){return no}get strings(){return so}static get requiredScopes(){return[...new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"])]}render(){if(null!==this.parentElement){const e=this.parentElement;e.addEventListener("dragenter",this.handleonDragEnter),e.addEventListener("dragleave",this.handleonDragLeave),e.addEventListener("dragover",this.handleonDragOver),e.addEventListener("drop",this.handleonDrop)}return html$1`
        <div id="file-upload-dialog" class="file-upload-dialog">
          <!-- Modal content -->
          <fluent-card class="file-upload-dialog-content">
            <span class="file-upload-dialog-close" id="file-upload-dialog-close" >${getSvg($r.Cancel)}</span>
            <div class="file-upload-dialog-content-text">
              <h2 class="file-upload-dialog-title">${this._dialogTitle}</h2>
              <div>${this._dialogContent}</div>
              <div class="file-upload-dialog-check-wrapper">
                <fluent-checkbox id="file-upload-dialog-check" class="file-upload-dialog-check" >
                  <span>${this._dialogCheckBox}</span>
                </fluent-checkbox>
              </div>
            </div>
            <div class="file-upload-dialog-editor">
              <fluent-button class="file-upload-dialog-ok">
              ${this._dialogPrimaryButton}
              </fluent-button>
              <fluent-button class="file-upload-dialog-cancel">
              ${this._dialogSecondaryButton}
              </fluent-button>
            </div>
          </fluent-card>
        </div>
        <div id="file-upload-border" >
        </div>
        <div class="file-upload-area-button">
        <div>
          <input
            id="file-upload-input"
            type="file"
            multiple="true"
            @change="${this.onFileUploadChange}"
          />
          <fluent-button class="file-upload-button" @click=${this.onFileUploadClick}>
            ${getSvg($r.Upload)}${so.buttonUploadFile}
          </fluent-button>
        </div>
        </div>
        <div class="file-upload-Template">
        ${this.renderFolderTemplate(this.filesToUpload)}
        </div>
       `}renderFolderTemplate(e){let t=[];if(e.length>0){const r=e.map((e=>-1===t.indexOf(e.fullPath.substring(0,e.fullPath.lastIndexOf("/")))?""!==e.fullPath.substring(0,e.fullPath.lastIndexOf("/"))?(t.push(e.fullPath.substring(0,e.fullPath.lastIndexOf("/"))),html$1`
            <div class='file-upload-table'>
              <div class='file-upload-cell'>
                <mgt-file
                  .fileDetails=${{name:e.fullPath.substring(1,e.fullPath.lastIndexOf("/")),folder:"Folder"}}
                  .view=${Mr.oneline}
                  class="mgt-file-item"
                >
                </mgt-file>
              </div>
            </div>
            ${this.renderFileTemplate(e,"file-upload-folder-tab")}`):html$1`${this.renderFileTemplate(e,"")}`:html$1`${this.renderFileTemplate(e,"file-upload-folder-tab")}`));return html$1`${r}`}return null}renderFileTemplate(e,t){return html$1`
        <div class="${e.completed?"file-upload-table":"file-upload-table upload"}">
          <div class="${t+("lastModifiedDateTime"===e.fieldUploadResponse?" file-upload-dialog-success":"")}">
            <div class='file-upload-cell'>
              <div style=${"description"===e.fieldUploadResponse?"opacity: 0.5;":""}>
                <div class="file-upload-status">
                  ${e.iconStatus}
                </div>
                <mgt-file
                  .fileDetails=${e.driveItem}
                  .view=${e.view}
                  .line2Property=${e.fieldUploadResponse}
                  class="mgt-file-item"
                  >
                </mgt-file>
              </div>
            </div>
              ${!1===e.completed?this.renderFileUploadTemplate(e):null}
            </div>
          </div>
        </div>
        `}renderFileUploadTemplate(e){return html$1`
    <div class='file-upload-cell'>
      <div class='file-upload-table file-upload-name' >
        <div class='file-upload-cell'>
          <div title="${e.file.name}" class='file-upload-filename'>${e.file.name}</div>
        </div>
      </div>
      <div class='file-upload-table'>
        <div class='file-upload-cell'>
          <div class="${e.completed?"file-upload-table":"file-upload-table upload"}">
            <fluent-progress class="file-upload-bar" value="${e.percent}" ></fluent-progress>
            <div class='file-upload-cell' style="padding-left:5px">
              <span>${e.percent}%</span>
              <span
                class="file-upload-cancel"
                @click=${t=>this.deleteFileUploadSession(e)}>
                ${getSvg($r.Cancel)}
              </span>
            </div>
          <div>
        </div>
      </div>
    </div>
    `}onFileUploadChange(e){return __awaiter$o(this,void 0,void 0,(function*(){!e||e.target.files.length<1||(this.getSelectedFiles(yield this.getFilesFromUploadArea(e.target.files)),e.target.value=null)}))}onFileUploadClick(){this.renderRoot.querySelector("#file-upload-input").click()}deleteFileUploadSession(e){return __awaiter$o(this,void 0,void 0,(function*(){try{if(void 0!==e.uploadUrl){yield function deleteSessionFile(e,t){return __awaiter$q(this,void 0,void 0,(function*(){try{const r="files.readwrite";let o;try{o=yield e.client.api(t).middlewareOptions(prepScopes(r)).delete((e=>e))}catch(e){}return o||null}catch(e){return null}}))}(this.fileUploadList.graph,e.uploadUrl);e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,so.cancelUploadFile)}else e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,so.cancelUploadFile)}catch(t){e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,so.cancelUploadFile)}}))}getSelectedFiles(e){return __awaiter$o(this,void 0,void 0,(function*(){let t=[],r=[];this._applyAll=!1,this._applyAllConflitBehavior=null,this._maximumFiles=!1,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach((e=>__awaiter$o(this,void 0,void 0,(function*(){e.completed?r.push(e):t.push(e)}))));for(var o=0;o<e.length;o++){const r=e[o],i=""===r.fullPath?"/"+r.name:r.fullPath;if(0===t.filter((e=>e.fullPath===i)).length){let r=!0;if(t.length>=this.fileUploadList.maxUploadFile&&(r=!1,!this._maximumFiles)){const t=yield this.getFileUploadStatus(e[o],i,"MaxFiles",this.fileUploadList);if(null!==t){if(0===t[0])return null;1===t[0]&&(this._maximumFiles=!0)}}if(void 0!==this.fileUploadList.maxFileSize&&r&&e[o].size>1024*this.fileUploadList.maxFileSize&&(r=!1,!1===this._maximumFileSize)){const t=yield this.getFileUploadStatus(e[o],i,"MaxFileSize",this.fileUploadList);null!==t&&1===t[0]&&(this._maximumFileSize=!0)}if(void 0!==this.fileUploadList.excludedFileExtensions&&this.fileUploadList.excludedFileExtensions.length>0&&r&&this.fileUploadList.excludedFileExtensions.filter((t=>e[o].name.toLowerCase().indexOf(t.toLowerCase())>-1)).length>0&&(r=!1,!1===this._excludedFileType)){const t=yield this.getFileUploadStatus(e[o],i,"ExcludedFileType",this.fileUploadList);null!==t&&1===t[0]&&(this._excludedFileType=!0)}if(r){const r=yield this.getFileUploadStatus(e[o],i,"Upload",this.fileUploadList);let n=!1;null!==r&&(-1===r[0]?n=!0:(this._applyAll=Boolean(r[0]),this._applyAllConflitBehavior=r[1]?1:0)),t.push({file:e[o],driveItem:{name:e[o].name},fullPath:i,conflictBehavior:null!==r?r[1]?1:0:null,iconStatus:null,percent:1,view:Mr.image,completed:n,maxSize:this._maxChunckSize,minSize:0})}}}t=t.sort(((e,t)=>e.fullPath.substring(0,e.fullPath.lastIndexOf("/")).localeCompare(t.fullPath.substring(0,t.fullPath.lastIndexOf("/"))))),t.forEach((e=>{if(0!==r.filter((t=>t.fullPath===e.fullPath)).length){let t=r.findIndex((t=>t.fullPath===e.fullPath));r.splice(t,1)}})),t.push(...r),this.filesToUpload=t,this.filesToUpload.forEach((e=>__awaiter$o(this,void 0,void 0,(function*(){yield this.sendFileItemGraph(e)}))))}))}getFileUploadStatus(e,t,r,o){const i=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return __awaiter$o(this,void 0,void 0,(function*(){const n=this.renderRoot.querySelector("#file-upload-dialog");switch(r){case"Upload":return null!==(yield function getGraphfile(e,t){return __awaiter$q(this,void 0,void 0,(function*(){try{const r="files.read";let o;try{o=yield e.api(t).middlewareOptions(prepScopes(r)).get().catch((e=>null))}catch(e){}return o||null}catch(e){return null}}))}(this.fileUploadList.graph,`${this.getGrapQuery(t)}?$select=id`))?!0===this._applyAll?[this._applyAll,this._applyAllConflitBehavior]:(n.classList.add("visible"),this._dialogTitle=so.fileReplaceTitle,this._dialogContent=so.fileReplace.replace("{FileName}",e.name),this._dialogCheckBox=so.checkApplyAll,this._dialogPrimaryButton=so.buttonReplace,this._dialogSecondaryButton=so.buttonKeep,i.requestStateUpdate.call(this,!0),new Promise((e=>__awaiter$o(this,void 0,void 0,(function*(){let t=this.renderRoot.querySelector(".file-upload-dialog-close"),r=this.renderRoot.querySelector(".file-upload-dialog-ok"),o=this.renderRoot.querySelector(".file-upload-dialog-cancel"),i=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){n.classList.remove("visible"),e([i.checked?1:0,1])}function onCancelDialogClick(){n.classList.remove("visible"),e([i.checked?1:0,0])}function onCloseDialogClick(){n.classList.remove("visible"),e([-1])}i.checked=!1,i.classList.remove("hide"),r.removeEventListener("click",onOkDialogClick),o.removeEventListener("click",onCancelDialogClick),t.removeEventListener("click",onCloseDialogClick),r.addEventListener("click",onOkDialogClick),o.addEventListener("click",onCancelDialogClick),t.addEventListener("click",onCloseDialogClick)}))))):null;case"MaxFiles":return n.classList.add("visible"),this._dialogTitle=so.maximumFilesTitle,this._dialogContent=so.maximumFiles.split("{MaxNumber}").join(o.maxUploadFile.toString()),this._dialogCheckBox=so.checkApplyAll,this._dialogPrimaryButton=so.buttonUpload,this._dialogSecondaryButton=so.buttonReselect,i.requestStateUpdate.call(this,!0),new Promise((e=>__awaiter$o(this,void 0,void 0,(function*(){let t=this.renderRoot.querySelector(".file-upload-dialog-ok"),r=this.renderRoot.querySelector(".file-upload-dialog-cancel"),o=this.renderRoot.querySelector(".file-upload-dialog-close"),i=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){n.classList.remove("visible"),e([1])}function onCancelDialogClick(){n.classList.remove("visible"),e([0])}i.checked=!1,i.classList.add("hide"),t.removeEventListener("click",onOkDialogClick),r.removeEventListener("click",onCancelDialogClick),o.removeEventListener("click",onCancelDialogClick),t.addEventListener("click",onOkDialogClick),r.addEventListener("click",onCancelDialogClick),o.addEventListener("click",onCancelDialogClick)}))));case"ExcludedFileType":return n.classList.add("visible"),this._dialogTitle=so.fileTypeTitle,this._dialogContent=so.fileType.replace("{FileName}",e.name)+" ("+o.excludedFileExtensions.join(",")+")",this._dialogCheckBox=so.checkAgain,this._dialogPrimaryButton=so.buttonOk,this._dialogSecondaryButton=so.buttonCancel,i.requestStateUpdate.call(this,!0),new Promise((e=>__awaiter$o(this,void 0,void 0,(function*(){let t=this.renderRoot.querySelector(".file-upload-dialog-ok"),r=this.renderRoot.querySelector(".file-upload-dialog-cancel"),o=this.renderRoot.querySelector(".file-upload-dialog-close"),i=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){n.classList.remove("visible"),e([i.checked?1:0])}function onCancelDialogClick(){n.classList.remove("visible"),e([0])}i.checked=!1,i.classList.remove("hide"),t.removeEventListener("click",onOkDialogClick),r.removeEventListener("click",onCancelDialogClick),o.removeEventListener("click",onCancelDialogClick),t.addEventListener("click",onOkDialogClick),r.addEventListener("click",onCancelDialogClick),o.addEventListener("click",onCancelDialogClick)}))));case"MaxFileSize":return n.classList.add("visible"),this._dialogTitle=so.maximumFileSizeTitle,this._dialogContent=so.maximumFileSize.replace("{FileSize}",formatBytes(o.maxFileSize)).replace("{FileName}",e.name)+formatBytes(e.size)+".",this._dialogCheckBox=so.checkAgain,this._dialogPrimaryButton=so.buttonOk,this._dialogSecondaryButton=so.buttonCancel,i.requestStateUpdate.call(this,!0),new Promise((e=>__awaiter$o(this,void 0,void 0,(function*(){let t=this.renderRoot.querySelector(".file-upload-dialog-ok"),r=this.renderRoot.querySelector(".file-upload-dialog-cancel"),o=this.renderRoot.querySelector(".file-upload-dialog-close"),i=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){n.classList.remove("visible"),e([i.checked?1:0])}function onCancelDialogClick(){n.classList.remove("visible"),e([0])}i.checked=!1,i.classList.remove("hide"),t.removeEventListener("click",onOkDialogClick),r.removeEventListener("click",onCancelDialogClick),o.removeEventListener("click",onCancelDialogClick),t.addEventListener("click",onOkDialogClick),r.addEventListener("click",onCancelDialogClick),o.addEventListener("click",onCancelDialogClick)}))))}}))}getGrapQuery(e){let t="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(t="/"===this.fileUploadList.itemPath.substring(0,1)?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?`/users/${this.fileUploadList.userId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.userId&&this.fileUploadList.itemPath?`/users/${this.fileUploadList.userId}/drive/root:${t}${e}`:this.fileUploadList.groupId&&this.fileUploadList.itemId?`/groups/${this.fileUploadList.groupId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.groupId&&this.fileUploadList.itemPath?`/groups/${this.fileUploadList.groupId}/drive/root:${t}${e}`:this.fileUploadList.driveId&&this.fileUploadList.itemId?`/drives/${this.fileUploadList.driveId}/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.driveId&&this.fileUploadList.itemPath?`/drives/${this.fileUploadList.driveId}/root:${t}${e}`:this.fileUploadList.siteId&&this.fileUploadList.itemId?`/sites/${this.fileUploadList.siteId}/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.siteId&&this.fileUploadList.itemPath?`/sites/${this.fileUploadList.siteId}/drive/root:${t}${e}`:this.fileUploadList.itemId?`/me/drive/items/${this.fileUploadList.itemId}:${e}`:this.fileUploadList.itemPath?`/me/drive/root:${t}${e}`:`/me/drive/root:${e}`}sendFileItemGraph(e){return __awaiter$o(this,void 0,void 0,(function*(){const t=this.fileUploadList.graph;let r="";if(e.file.size<this._maxChunckSize)try{e.completed||(null!==e.conflictBehavior&&1!==e.conflictBehavior||(r=`${this.getGrapQuery(e.fullPath)}:/content`),0===e.conflictBehavior&&(r=`${this.getGrapQuery(e.fullPath)}:/content?@microsoft.graph.conflictBehavior=rename`),e.driveItem=yield function sendFileContent(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){try{const o="files.readwrite";let i;try{i=yield e.client.api(t).middlewareOptions(prepScopes(o)).put(r)}catch(e){}return i||null}catch(e){return null}}))}(t,r,e.file),null!==e.driveItem?this.setUploadSuccess(e):(e.driveItem={name:e.file.name},this.setUploadFail(e,so.failUploadFile)))}catch(t){this.setUploadFail(e,so.failUploadFile)}else if(!e.completed&&void 0===e.uploadUrl){const r=yield function getUploadSession(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){try{const o="files.readwrite",i={item:{"@microsoft.graph.conflictBehavior":0===r||null===r?"rename":"replace"}};let n;try{n=yield e.api(t).middlewareOptions(prepScopes(o)).post(JSON.stringify(i))}catch(e){}return n||null}catch(e){return null}}))}(t,`${this.getGrapQuery(e.fullPath)}:/createUploadSession`,e.conflictBehavior);try{if(null!==r){e.uploadUrl=r.uploadUrl;const o=yield this.sendSessionUrlGraph(t,e);null!==o?(e.driveItem=o,this.setUploadSuccess(e)):this.setUploadFail(e,so.failUploadFile)}else this.setUploadFail(e,so.failUploadFile)}catch(e){}}}))}sendSessionUrlGraph(e,t){const r=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return __awaiter$o(this,void 0,void 0,(function*(){for(;t.file.size>t.minSize;){void 0===t.mimeStreamString&&(t.mimeStreamString=yield this.readFileContent(t.file));const o=new Blob([t.mimeStreamString.slice(t.minSize,t.maxSize)]);if(t.percent=Math.round(t.maxSize/t.file.size*100),r.requestStateUpdate.call(this,!0),void 0===t.uploadUrl)return null;{const r=yield sendFileChunck(e,t.uploadUrl,""+(t.maxSize-t.minSize),`bytes ${t.minSize}-${t.maxSize-1}/${t.file.size}`,o);if(null===r)return null;if(void 0!==r.id)return r;void 0!==r.nextExpectedRanges&&(t.minSize=parseInt(r.nextExpectedRanges[0].split("-")[0]),t.maxSize=t.minSize+this._maxChunckSize,t.maxSize>t.file.size&&(t.maxSize=t.file.size))}}}))}setUploadSuccess(e){e.percent=100,super.requestStateUpdate(!0),setTimeout((()=>{e.iconStatus=getSvg($r.Success),e.view=Mr.twolines,e.fieldUploadResponse="lastModifiedDateTime",e.completed=!0,super.requestStateUpdate(!0),clearFilesCache()}),500)}setUploadFail(e,t){setTimeout((()=>{e.iconStatus=getSvg($r.Fail),e.view=Mr.twolines,e.driveItem.description=t,e.fieldUploadResponse="description",e.completed=!0,super.requestStateUpdate(!0)}),500)}readFileContent(e){return new Promise(((t,r)=>{const o=new FileReader;o.onloadend=e=>{t(o.result)},o.onerror=e=>{r(e)},o.readAsArrayBuffer(e)}))}getFilesFromUploadArea(e){return __awaiter$o(this,void 0,void 0,(function*(){const t=[];let r;const o=[];for(let i=0;i<e.length;i++){const n=e[i];if("file"!==n.kind){const e=n;e&&(e.fullPath="",o.push(e))}else if(n.getAsEntry)if(r=n.getAsEntry(),r.isDirectory)t.push(r);else{const e=n.getAsFile();e&&(e.fullPath="",o.push(e))}else if(n.webkitGetAsEntry)if(r=n.webkitGetAsEntry(),r.isDirectory)t.push(r);else{const e=n.getAsFile();e&&(e.fullPath="",o.push(e))}else if("function"==typeof n.getAsFile){const e=n.getAsFile();e&&(e.fullPath="",o.push(e))}}if(t.length>0){const e=yield this.getFolderFiles(t);o.push(...e)}return o}))}getFolderFiles(e){return new Promise((t=>{let r=0;const o=[];function readEntry(e,i){e.isDirectory?function readReaderContent(e){r++,e.readEntries((e=>{r--;for(const t of e)readEntry(t,t.fullPath);0===r&&t(o)}))}(e.createReader()):(r++,e.file((e=>{r--,e.fullPath=i,o.push(e),0===r&&t(o)})))}e.forEach((e=>{readEntry(e,"")}))}))}};__decorate$n([property({type:Object}),__metadata$m("design:type",Array)],Zs.prototype,"filesToUpload",void 0),__decorate$n([property({type:Object}),__metadata$m("design:type",Object)],Zs.prototype,"fileUploadList",void 0),Zs=__decorate$n([customElement("mgt-file-upload"),__metadata$m("design:paramtypes",[])],Zs);const Xs=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host{font-family:var(--default-font-family);font-size:var(--default-font-size)}:host .file-list-wrapper,mgt-file-item .file-list-wrapper{background-color:var(--file-list-background-color,#fff);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--file-list-border-radius,4px);border:var(--file-list-border,none);position:relative;color:var(--color-sub1,#323130);display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .file-list,mgt-file-item .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,4px 0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item,mgt-file-item .file-list-wrapper .file-list .file-item{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);margin:var(--file-item-margin,0 4px);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-list-wrapper .file-list .file-item mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item mgt-file{--file-background-color:$background-color}:host .file-list-wrapper .file-list .file-item.focused,:host .file-list-wrapper .file-list .file-item:hover,mgt-file-item .file-list-wrapper .file-list .file-item.focused,mgt-file-item .file-list-wrapper .file-list .file-item:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1));border-radius:4px}:host .file-list-wrapper .file-list .file-item.focused mgt-file,:host .file-list-wrapper .file-list .file-item:hover mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.focused mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-list-wrapper .file-list .file-item.selected,:host .file-list-wrapper .file-list .file-item:active,mgt-file-item .file-list-wrapper .file-list .file-item.selected,mgt-file-item .file-list-wrapper .file-list .file-item:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-list-wrapper .file-list .file-item.selected mgt-file,:host .file-list-wrapper .file-list .file-item:active mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.selected mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:active mgt-file{--file-background-color:$file-item-background-color--active}:host .file-list-wrapper .progress-ring,mgt-file-item .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more,mgt-file-item .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,6px);border-bottom-right-radius:var(--show-more-button-border-bottom-right-radius,8px);border-bottom-left-radius:var(--show-more-button-border-bottom-left-radius,8px);cursor:pointer;background-color:var(--show-more-button-background-color,var(--background-color-sub2,#f3f2f1))}:host .file-list-wrapper .show-more:hover,mgt-file-item .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color--hover,var(--file-item-background-color--hover,rgba(0,0,0,.1)))}
`],ea={showMoreSubtitle:"Show more items"};var __decorate$m=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$n=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};registerFluentComponents(Gs);let ta=class MgtFileList extends MgtTemplatedComponent{constructor(){super(),this._focusedItemIndex=-1,this.pageSize=10,this.itemView=Mr.twolines,this.maxUploadFile=10,this.enableFileUpload=!1,this._preloadedFiles=[]}static get styles(){return Xs}get strings(){return ea}get fileListQuery(){return this._fileListQuery}set fileListQuery(e){e!==this._fileListQuery&&(this._fileListQuery=e,this.requestStateUpdate(!0))}get fileQueries(){return this._fileQueries}set fileQueries(e){arraysAreEqual(this._fileQueries,e)||(this._fileQueries=e,this.requestStateUpdate(!0))}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate(!0))}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate(!0))}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate(!0))}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate(!0))}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate(!0))}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate(!0))}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate(!0))}get fileExtensions(){return this._fileExtensions}set fileExtensions(e){arraysAreEqual(this._fileExtensions,e)||(this._fileExtensions=e,this.requestStateUpdate(!0))}get pageSize(){return this._pageSize}set pageSize(e){e!==this._pageSize&&(this._pageSize=e,this.requestStateUpdate(!0))}get maxFileSize(){return this._maxFileSize}set maxFileSize(e){e!==this._maxFileSize&&(this._maxFileSize=e,this.requestStateUpdate(!0))}get maxUploadFile(){return this._maxUploadFile}set maxUploadFile(e){e!==this._maxUploadFile&&(this._maxUploadFile=e,this.requestStateUpdate(!0))}get excludedFileExtensions(){return this._excludedFileExtensions}set excludedFileExtensions(e){arraysAreEqual(this._excludedFileExtensions,e)||(this._excludedFileExtensions=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set([...io.requiredScopes])]}requestStateUpdate(e){return this.clearState(),super.requestStateUpdate(e)}clearState(){super.clearState(),this.files=null}render(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this.renderTemplate("default",{files:this.files})||this.renderFiles():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||html$1``}renderNoData(){return this.renderTemplate("no-data",null)||(!0===this.enableFileUpload&&void 0!==Providers.globalProvider?html$1`
      <fluent-design-system-provider use-defaults>
        <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
          ${this.renderFileUpload()}
        </div>
      </fluent-design-system-provider>
      `:html$1``)}renderFiles(){return html$1`
    <fluent-design-system-provider use-defaults>
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        ${this.enableFileUpload?this.renderFileUpload():null}
        <ul
          id="file-list"
          class="file-list"
          tabindex="0"
          @keydown="${this.onFileListKeyDown}"
          @keyup="${this.onFileListKeyUp}"
          @blur="${this.onFileListOut}"
        >
          ${Yr(this.files,(e=>e.id),(e=>html$1`
              <li class="file-item" @click=${t=>this.handleItemSelect(e,t)}>
                ${this.renderFile(e)}
              </li>
            `))}
        </ul>
        ${!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)?this.renderMoreFileButton():null}
      </div>
    </fluent-design-system-provider>
    `}renderFile(e){const t=this.itemView;return this.renderTemplate("file",{file:e},e.id)||html$1`
        <mgt-file .fileDetails=${e} .view=${t}></mgt-file>
      `}renderMoreFileButton(){return this._isLoadingMore?html$1`
        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>
      `:html$1`<a id="show-more" class="show-more" @click=${()=>this.renderNextPage()} tabindex="0" @keydown=${this.onShowMoreKeyDown}><span>${this.strings.showMoreSubtitle}<span></a>`}renderFileUpload(){const e={graph:Providers.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return html$1`
        <mgt-file-upload .fileUploadList=${e} ></mgt-file-upload>
      `}onShowMoreKeyDown(e){e&&"Enter"===e.code&&(e.preventDefault(),this.renderNextPage())}onFileListKeyUp(e){const t=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),null==t||t.classList.remove("selected"),null==t||t.classList.add("focused"))}onFileListKeyDown(e){const t=this.renderRoot.querySelector(".file-list");let r;if(t&&t.children.length){if("ArrowUp"!==e.code&&"ArrowDown"!==e.code||("ArrowUp"===e.code&&(-1===this._focusedItemIndex&&(this._focusedItemIndex=t.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+t.children.length)%t.children.length),"ArrowDown"===e.code&&(this._focusedItemIndex=(this._focusedItemIndex+1)%t.children.length),r=t.children[this._focusedItemIndex],this.updateItemBackgroundColor(t,r,"focused")),"Enter"===e.code||"Space"===e.code){r=t.children[this._focusedItemIndex];const o=r.children[0];e.preventDefault(),this.fireCustomEvent("itemClick",o.fileDetails),this.updateItemBackgroundColor(t,r,"selected")}"Tab"===e.code&&(r=t.children[this._focusedItemIndex],null==r||r.classList.remove("focused"))}}onFileListOut(){const e=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];null==e||e.classList.remove("focused")}loadState(){return __awaiter$n(this,void 0,void 0,(function*(){const e=Providers.globalProvider;if(!e||e.state===or.Loading)return;if(e.state===or.SignedOut)return void(this.files=null);const t=e.graph.forComponent(this);let r,o;const i=!(this.driveId||this.siteId||this.groupId||this.userId);if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){let e;if(this.fileListQuery?o=yield function getFilesByListQueryIterator(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){let o,i;const n=Nr.stores.fileLists;i=CacheService.getCache(Nr,n);const s=yield getFileListFromCache(i,n,t);if(s)return o=yield getFilesPageIteratorFromCache(e,s.files,s.nextLink),o;const a=["files.read","sites.read.all"];let l;try{l=yield e.api(t).middlewareOptions(prepScopes(...a)),r&&l.top(r),o=yield getFilesPageIteratorFromRequest(e,l),getIsFileListsCacheEnabled()&&i.putValue(t,{files:o.value,nextLink:o._nextLink})}catch(e){}return o||null}))}(t,this.fileListQuery,this.pageSize):this.fileQueries?r=yield function getFilesByQueries(e,t){return __awaiter$q(this,void 0,void 0,(function*(){if(!t||0===t.length)return[];const r=e.createBatch(),o=[],i=["files.read"];let n,s;getIsFilesCacheEnabled()&&(n=CacheService.getCache(Or,Or.stores.fileQueries));for(const e of t)getIsFilesCacheEnabled()&&(s=yield n.getValue(e)),getIsFilesCacheEnabled()&&s&&getFileInvalidationTime()>Date.now()-s.timeCached?o.push(JSON.parse(s.file)):""!==e&&r.get(e,e,i);try{const e=yield r.executeAll();for(const r of t){const t=e.get(r);t&&t.content&&(o.push(t.content),getIsFilesCacheEnabled()&&n.putValue(r,{file:JSON.stringify(t.content)}))}return o}catch(r){try{return Promise.all(t.filter((e=>e&&""!==e)).map((t=>__awaiter$q(this,void 0,void 0,(function*(){const r=yield getDriveItemByQuery(e,t);if(r)return getIsFilesCacheEnabled()&&n.putValue(t,{file:JSON.stringify(r)}),r})))))}catch(e){return[]}}}))}(t,this.fileQueries):i?this.itemId?o=yield function getFilesByIdIterator(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/me/drive/items/${t}/children`;let i,n;const s=Nr.stores.fileLists;n=CacheService.getCache(Nr,s);const a=yield getFileListFromCache(n,s,o);if(a)return i=yield getFilesPageIteratorFromCache(e,a.files,a.nextLink),i;let l;try{l=e.api(o).middlewareOptions(prepScopes("files.read")),r&&l.top(r),i=yield getFilesPageIteratorFromRequest(e,l),getIsFileListsCacheEnabled()&&n.putValue(o,{files:i.value,nextLink:i._nextLink})}catch(e){}return i||null}))}(t,this.itemId,this.pageSize):this.itemPath?o=yield function getFilesByPathIterator(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/me/drive/root:/${t}:/children`;let i,n;const s=Nr.stores.fileLists;n=CacheService.getCache(Nr,s);const a=yield getFileListFromCache(n,s,o);if(a)return i=yield getFilesPageIteratorFromCache(e,a.files,a.nextLink),i;let l;try{l=e.api(o).middlewareOptions(prepScopes("files.read")),r&&l.top(r),i=yield getFilesPageIteratorFromRequest(e,l),getIsFileListsCacheEnabled()&&n.putValue(o,{files:i.value,nextLink:i._nextLink})}catch(e){}return i||null}))}(t,this.itemPath,this.pageSize):this.insightType?r=yield function getMyInsightsFiles(e,t){return __awaiter$q(this,void 0,void 0,(function*(){const r=`/me/insights/${t}`;let o;const i=Nr.stores.insightfileLists;o=CacheService.getCache(Nr,i);const n=yield getFileListFromCache(o,i,r);if(n)return n.files;const s=["sites.read.all"];let a;try{a=yield e.api(r).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(prepScopes(...s)).get()}catch(e){}const l=yield getDriveItemsByInsights(e,a,s);return getIsFileListsCacheEnabled()&&o.putValue(r,{files:l}),l||null}))}(t,this.insightType):o=yield function getFilesIterator(e,t){return __awaiter$q(this,void 0,void 0,(function*(){const r="/me/drive/root/children";let o,i;const n=Nr.stores.fileLists;i=CacheService.getCache(Nr,n);const s=yield getFileListFromCache(i,n,r);if(s)return o=yield getFilesPageIteratorFromCache(e,s.files,s.nextLink),o;let a;try{a=e.api(r).middlewareOptions(prepScopes("files.read")),t&&a.top(t),o=yield getFilesPageIteratorFromRequest(e,a),getIsFileListsCacheEnabled()&&i.putValue(r,{files:o.value,nextLink:o._nextLink})}catch(e){}return o||null}))}(t,this.pageSize):this.driveId?this.itemId?o=yield function getDriveFilesByIdIterator(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/drives/${t}/items/${r}/children`;let n,s;const a=Nr.stores.fileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,i);if(l)return n=yield getFilesPageIteratorFromCache(e,l.files,l.nextLink),n;let c;try{c=e.api(i).middlewareOptions(prepScopes("files.read")),o&&c.top(o),n=yield getFilesPageIteratorFromRequest(e,c),getIsFileListsCacheEnabled()&&s.putValue(i,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(t,this.driveId,this.itemId,this.pageSize):this.itemPath&&(o=yield function getDriveFilesByPathIterator(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/drives/${t}/root:/${r}:/children`;let n,s;const a=Nr.stores.fileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,i);if(l)return n=yield getFilesPageIteratorFromCache(e,l.files,l.nextLink),n;let c;try{c=e.api(i).middlewareOptions(prepScopes("files.read")),o&&c.top(o),n=yield getFilesPageIteratorFromRequest(e,c),getIsFileListsCacheEnabled()&&s.putValue(i,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(t,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?o=yield function getGroupFilesByIdIterator(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/groups/${t}/drive/items/${r}/children`;let n,s;const a=Nr.stores.fileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,i);if(l)return n=yield getFilesPageIteratorFromCache(e,l.files,l.nextLink),n;let c;try{c=e.api(i).middlewareOptions(prepScopes("files.read")),o&&c.top(o),n=yield getFilesPageIteratorFromRequest(e,c),getIsFileListsCacheEnabled()&&s.putValue(i,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(t,this.groupId,this.itemId,this.pageSize):this.itemPath&&(o=yield function getGroupFilesByPathIterator(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/groups/${t}/drive/root:/${r}:/children`;let n,s;const a=Nr.stores.fileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,i);if(l)return n=yield getFilesPageIteratorFromCache(e,l.files,l.nextLink),n;let c;try{c=e.api(i).middlewareOptions(prepScopes("files.read")),o&&c.top(o),n=yield getFilesPageIteratorFromRequest(e,c),getIsFileListsCacheEnabled()&&s.putValue(i,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(t,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?o=yield function getSiteFilesByIdIterator(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/sites/${t}/drive/items/${r}/children`;let n,s;const a=Nr.stores.fileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,i);if(l)return n=yield getFilesPageIteratorFromCache(e,l.files,l.nextLink),n;let c;try{c=e.api(i).middlewareOptions(prepScopes("files.read")),o&&c.top(o),n=yield getFilesPageIteratorFromRequest(e,c),getIsFileListsCacheEnabled()&&s.putValue(i,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(t,this.siteId,this.itemId,this.pageSize):this.itemPath&&(o=yield function getSiteFilesByPathIterator(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/sites/${t}/drive/root:/${r}:/children`;let n,s;const a=Nr.stores.fileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,i);if(l)return n=yield getFilesPageIteratorFromCache(e,l.files,l.nextLink),n;let c;try{c=e.api(i).middlewareOptions(prepScopes("files.read")),o&&c.top(o),n=yield getFilesPageIteratorFromRequest(e,c),getIsFileListsCacheEnabled()&&s.putValue(i,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(t,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?o=yield function getUserFilesByIdIterator(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/users/${t}/drive/items/${r}/children`;let n,s;const a=Nr.stores.fileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,i);if(l)return n=yield getFilesPageIteratorFromCache(e,l.files,l.nextLink),n;let c;try{c=e.api(i).middlewareOptions(prepScopes("files.read")),o&&c.top(o),n=yield getFilesPageIteratorFromRequest(e,c),getIsFileListsCacheEnabled()&&s.putValue(i,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(t,this.userId,this.itemId,this.pageSize):this.itemPath?o=yield function getUserFilesByPathIterator(e,t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/users/${t}/drive/root:/${r}:/children`;let n,s;const a=Nr.stores.fileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,i);if(l)return n=yield getFilesPageIteratorFromCache(e,l.files,l.nextLink),n;let c;try{c=e.api(i).middlewareOptions(prepScopes("files.read")),o&&c.top(o),n=yield getFilesPageIteratorFromRequest(e,c),getIsFileListsCacheEnabled()&&s.putValue(i,{files:n.value,nextLink:n._nextLink})}catch(e){}return n||null}))}(t,this.userId,this.itemPath,this.pageSize):this.insightType&&(r=yield function getUserInsightsFiles(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){let o,i;"shared"===r?(o="/me/insights/shared",i=`((lastshared/sharedby/id eq '${t}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(o=`/users/${t}/insights/${r}`,i="resourceReference/type eq 'microsoft.graph.driveItem'");const n=`${o}?$filter=${i}`;let s;const a=Nr.stores.insightfileLists;s=CacheService.getCache(Nr,a);const l=yield getFileListFromCache(s,a,n);if(l)return l.files;const c=["sites.read.all"];let d;try{d=yield e.api(o).filter(i).middlewareOptions(prepScopes(...c)).get()}catch(e){}const u=yield getDriveItemsByInsights(e,d,c);return getIsFileListsCacheEnabled()&&s.putValue(o,{files:u}),u||null}))}(t,this.userId,this.insightType))),o&&(this.pageIterator=o,this._preloadedFiles=[...this.pageIterator.value],r=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),this.fileExtensions&&null!==this.fileExtensions){if(this.pageIterator&&this.pageIterator.value){for(;this.pageIterator.hasNext;)yield fetchNextAndCacheForFilesPageIterator(this.pageIterator);r=this.pageIterator.value,this._preloadedFiles=[]}e=r.filter((e=>{for(const t of this.fileExtensions)if(t==this.getFileExtension(e.name))return e}))}e&&e.length>=0?this.files=e:this.files=r}}))}handleItemSelect(e,t){if(this.fireCustomEvent("itemClick",e),t){const e=this.renderRoot.querySelector(".file-list"),r=Array.from(e.children),o=t.target.closest("li"),i=r.indexOf(o);this._focusedItemIndex=i;for(let t=0;t<e.children.length;t++)e.children[t].classList.remove("focused")}}renderNextPage(){return __awaiter$n(this,void 0,void 0,(function*(){if(this._preloadedFiles.length>0)this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))];else if(this.pageIterator.hasNext){this._isLoadingMore=!0;const e=this.renderRoot.querySelector("file-list-wrapper");e&&e.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),yield fetchNextAndCacheForFilesPageIterator(this.pageIterator),this._isLoadingMore=!1,this.files=this.pageIterator.value}this.requestUpdate()}))}getFileExtension(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}updateItemBackgroundColor(e,t,r){for(let t=0;t<e.children.length;t++)e.children[t].classList.remove(r);t&&(t.classList.add(r),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}reload(e=!1){e&&clearFilesCache(),this.requestStateUpdate(!0)}};__decorate$m([property({attribute:"file-list-query"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],ta.prototype,"fileListQuery",null),__decorate$m([property({attribute:"file-queries",converter:(e,t)=>e?e.split(",").map((e=>e.trim())):null}),__metadata$l("design:type",Array),__metadata$l("design:paramtypes",[Array])],ta.prototype,"fileQueries",null),__decorate$m([property({type:Object}),__metadata$l("design:type",Array)],ta.prototype,"files",void 0),__decorate$m([property({attribute:"site-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],ta.prototype,"siteId",null),__decorate$m([property({attribute:"drive-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],ta.prototype,"driveId",null),__decorate$m([property({attribute:"group-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],ta.prototype,"groupId",null),__decorate$m([property({attribute:"item-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],ta.prototype,"itemId",null),__decorate$m([property({attribute:"item-path"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],ta.prototype,"itemPath",null),__decorate$m([property({attribute:"user-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],ta.prototype,"userId",null),__decorate$m([property({attribute:"insight-type"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],ta.prototype,"insightType",null),__decorate$m([property({attribute:"item-view",converter:e=>e&&0!==e.length?(e=e.toLowerCase(),void 0===Mr[e]?Mr.threelines:Mr[e]):Mr.threelines}),__metadata$l("design:type",Number)],ta.prototype,"itemView",void 0),__decorate$m([property({attribute:"file-extensions",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),__metadata$l("design:type",Array),__metadata$l("design:paramtypes",[Array])],ta.prototype,"fileExtensions",null),__decorate$m([property({attribute:"page-size",type:Number}),__metadata$l("design:type",Number),__metadata$l("design:paramtypes",[Number])],ta.prototype,"pageSize",null),__decorate$m([property({attribute:"hide-more-files-button",type:Boolean}),__metadata$l("design:type",Boolean)],ta.prototype,"hideMoreFilesButton",void 0),__decorate$m([property({attribute:"max-file-size",type:Number}),__metadata$l("design:type",Number),__metadata$l("design:paramtypes",[Number])],ta.prototype,"maxFileSize",null),__decorate$m([property({attribute:"enable-file-upload",type:Boolean}),__metadata$l("design:type",Boolean)],ta.prototype,"enableFileUpload",void 0),__decorate$m([property({attribute:"max-upload-file",type:Number}),__metadata$l("design:type",Number),__metadata$l("design:paramtypes",[Number])],ta.prototype,"maxUploadFile",null),__decorate$m([property({attribute:"excluded-file-extensions",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),__metadata$l("design:type",Array),__metadata$l("design:paramtypes",[Array])],ta.prototype,"excludedFileExtensions",null),__decorate$m([internalProperty(),__metadata$l("design:type",Boolean)],ta.prototype,"_isLoadingMore",void 0),ta=__decorate$m([customElement("mgt-file-list"),__metadata$l("design:paramtypes",[])],ta);var ra,__decorate$l=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$k=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$m=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};!function(e){e.json="json",e.image="image"}(ra||(ra={}));const getIsResponseCacheEnabled=()=>CacheService.config.response.isEnabled&&CacheService.config.isEnabled;let oa=class MgtGet extends MgtTemplatedComponent{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type=ra.json,this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),this.requestStateUpdate()}refresh(e=!1){this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.response=null}render(){if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&this.response&&this.response.value){let e;if(Array.isArray(this.response.value)){let t=null;this.isLoadingState&&!this.isPolling&&(t=this.renderTemplate("loading",null)),e=html$1`
          ${this.response.value.map((e=>this.renderTemplate("value",e,e.id)))} ${t}
        `}else e=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){const t=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?html$1`
            ${t}${e}
          `:html$1`
            ${e}${t}
          `}return e}return this.response?this.renderTemplate("default",this.response)||html$1``:this.hasTemplate("no-data")?this.renderTemplate("no-data",null):html$1``}loadState(){return __awaiter$m(this,void 0,void 0,(function*(){const e=Providers.globalProvider;if(this.error=null,e&&e.state===or.SignedIn){if(this.resource){try{let t;const r=`${this.version}${this.resource}`;let o=null;if(this.shouldRetrieveCache()){t=CacheService.getCache(Rr,Rr.stores.responses);const e=getIsResponseCacheEnabled()?yield t.getValue(r):null;e&&(this.cacheInvalidationPeriod||CacheService.config.response.invalidationPeriod||CacheService.config.defaultInvalidationPeriod)>Date.now()-e.timeCached&&(o=JSON.parse(e.response))}if(!o){let i=this.resource,s=!1;this.response&&this.response["@odata.deltaLink"]?(i=this.response["@odata.deltaLink"],s=!0):s=new URL(i,"https://graph.microsoft.com").pathname.endsWith("delta");const a=e.graph.forComponent(this);let l=a.api(i).version(this.version);if(this.scopes&&this.scopes.length&&(l=l.middlewareOptions(prepScopes(...this.scopes))),this.type===ra.json){if(o=yield l.get(),s&&this.response&&Array.isArray(this.response.value)&&Array.isArray(o.value)&&(o.value=this.response.value.concat(o.value)),this.isPolling||equals(this.response,o)||(this.response=o),o&&Array.isArray(o.value)&&o["@odata.nextLink"]){let e=1,t=o;for(;(e<this.maxPages||this.maxPages<=0||s&&this.pollingRate)&&t&&t["@odata.nextLink"];){e++;const r=t["@odata.nextLink"].split(this.version)[1];t=yield a.client.api(r).version(this.version).get(),t&&t.value&&t.value.length&&(t.value=o.value.concat(t.value),o=t,this.isPolling||(this.response=o))}}}else{if(-1===this.resource.indexOf("/photo/$value")&&-1===this.resource.indexOf("/thumbnails/"))throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");let e;if(this.resource.indexOf("/photo/$value")>-1){const t=this.resource.replace("/photo/$value",""),r=yield getPhotoForResource(a,t,this.scopes);r&&(e=r.photo)}else if(this.resource.indexOf("/thumbnails/")>-1){const t=yield function getDocumentThumbnail(e,t,r){return __awaiter$q(this,void 0,void 0,(function*(){try{const o=yield e.api(t).responseType(n.RAW).middlewareOptions(prepScopes(...r)).get();if(404===o.status)return{eTag:null,thumbnail:null};if(!o.ok)return null;return{eTag:o.headers.get("eTag"),thumbnail:yield blobToBase64(yield o.blob())}}catch(e){return null}}))}(a,this.resource,this.scopes);t&&(e=t.thumbnail)}e&&(o={image:e})}this.shouldUpdateCache()&&o&&(t=CacheService.getCache(Rr,Rr.stores.responses),t.putValue(r,{response:JSON.stringify(o)}))}equals(this.response,o)||(this.response=o)}catch(e){this.error=e}this.response&&(this.error=null,this.pollingRate&&setTimeout((()=>__awaiter$m(this,void 0,void 0,(function*(){this.isPolling=!0,yield this.loadState(),this.isPolling=!1}))),this.pollingRate))}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}}))}shouldRetrieveCache(){return getIsResponseCacheEnabled()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return getIsResponseCacheEnabled()&&this.cacheEnabled}};__decorate$l([property({attribute:"resource",reflect:!0,type:String}),__metadata$k("design:type",String)],oa.prototype,"resource",void 0),__decorate$l([property({attribute:"scopes",converter:(e,t)=>e?e.toLowerCase().split(","):null,reflect:!0}),__metadata$k("design:type",Array)],oa.prototype,"scopes",void 0),__decorate$l([property({attribute:"version",reflect:!0,type:String}),__metadata$k("design:type",String)],oa.prototype,"version",void 0),__decorate$l([property({attribute:"type",reflect:!0,type:ra}),__metadata$k("design:type",String)],oa.prototype,"type",void 0),__decorate$l([property({attribute:"max-pages",reflect:!0,type:Number}),__metadata$k("design:type",Number)],oa.prototype,"maxPages",void 0),__decorate$l([property({attribute:"polling-rate",reflect:!0,type:Number}),__metadata$k("design:type",Number)],oa.prototype,"pollingRate",void 0),__decorate$l([property({attribute:"cache-enabled",reflect:!0,type:Boolean}),__metadata$k("design:type",Boolean)],oa.prototype,"cacheEnabled",void 0),__decorate$l([property({attribute:"cache-invalidation-period",reflect:!0,type:Number}),__metadata$k("design:type",Number)],oa.prototype,"cacheInvalidationPeriod",void 0),__decorate$l([property({attribute:!1}),__metadata$k("design:type",Object)],oa.prototype,"response",void 0),__decorate$l([property({attribute:!1}),__metadata$k("design:type",Object)],oa.prototype,"error",void 0),oa=__decorate$l([customElement("mgt-get")],oa);const ia=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}:host,mgt-login{--font-size:14px;--font-weight:600;--width:'100%';--height:'100%';--margin:0;--padding:12px 20px;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--button-color,#323130);background-color:var(--button-background-color,transparent);border:none;cursor:pointer;transition:color .3s,background-color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-button mgt-person,mgt-login .login-button mgt-person{--color-sub1:set-var(button__color, $theme-default, $login)}:host .login-button:hover,mgt-login .login-button:hover{color:var(--button-color--hover,#023b8f);--color:var(--button-color--hover, #023b8f);background-color:var(--button-background-color--hover,var(--background-color--hover,#edebe9));--color-sub1:var(--button-color--hover, #023b8f);border-radius:4px}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-button.no-click,mgt-login .login-button.no-click{pointer-events:none}:host .login-icon+span,mgt-login .login-icon+span{margin-left:6px}:host .popup,mgt-login .popup{font-family:var(--default-font-family);background-color:var(--popup-background-color,var(--background-color,#fff));min-width:240px;z-index:1;color:var(--popup-color,#323130);border-radius:8px}:host .popup mgt-person,mgt-login .popup mgt-person{--color-sub1:set-var(popup__color, $theme-default, $login)}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding);border-radius:8px}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:#023b8f;background-color:var(--popup-background-color,var(--background-color,#fff));border:none;padding:0;cursor:pointer;transition:color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .popup-command:hover,mgt-login .popup-command:hover{color:#005a9e}[dir=rtl]{--popup-padding:24px 24px 16px 48px}[dir=rtl] mgt-person .details{--details-spacing:0px 12px 0px 0px}[dir=rtl] mgt-person .details.small{--details-spacing:0px 6px 0px 0px}
`],na={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out"};var __decorate$k=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$j=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$l=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};let sa=class MgtLogin extends MgtTemplatedComponent{constructor(){super(),this._isFlyoutOpen=!1}static get styles(){return ia}get strings(){return na}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...Gr.requiredScopes])]}connectedCallback(){super.connectedCallback(),this.addEventListener("click",(e=>e.stopPropagation()))}login(){return __awaiter$l(this,void 0,void 0,(function*(){if(this.userDetails||!this.fireCustomEvent("loginInitiated"))return;const e=Providers.globalProvider;e&&e.login&&(yield e.login(),e.state===or.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))}))}logout(){return __awaiter$l(this,void 0,void 0,(function*(){if(!this.fireCustomEvent("logoutInitiated"))return;const e=Providers.globalProvider;e&&e.logout&&(yield e.logout(),this.userDetails=null,this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))}))}render(){return html$1`
      <div class="root" dir=${this.direction}>
        <div>
          ${this.renderButton()}
        </div>
        ${this.renderFlyout()}
      </div>
    `}loadState(){return __awaiter$l(this,void 0,void 0,(function*(){const e=Providers.globalProvider;e&&!this.userDetails&&(e.state===or.SignedIn?(this.userDetails=yield getUserWithPhoto(e.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),this.fireCustomEvent("loginCompleted")):this.userDetails=null)}))}renderButton(){const e=Providers.globalProvider,t=or.SignedIn;let r=this.strings.signInLinkSubtitle;e&&e.state===t&&(r=this.userDetails?this.userDetails.displayName:this.strings.signInLinkSubtitle);const o={"login-button":!0,"no-click":this._isFlyoutOpen};return html$1`
      <button aria-label=${r} ?disabled="${this.isLoadingState}" @click=${this.onClick} class=${Sr(o)} role="button">
        ${this.renderButtonContent()}
      </button>
    `}renderFlyout(){return html$1`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${()=>this._isFlyoutOpen=!0}
        @closed=${()=>this._isFlyoutOpen=!1}
      >
        <div slot="flyout">
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `}renderFlyoutContent(){if(this.userDetails)return html$1`
      <div class="popup">
        <div class="popup-content">
          <div>
            ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
          </div>
          <div class="popup-commands">
            ${this.renderFlyoutCommands()}
          </div>
        </div>
      </div>
    `}renderFlyoutPersonDetails(e,t){return this.renderTemplate("flyout-person-details",{personDetails:e,personImage:t})||html$1`
        <mgt-person .personDetails=${e} .personImage=${t} .view=${Mr.twolines} />
      `}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||html$1`
        <ul>
          <li>
            <button class="popup-command" @click=${this.logout} aria-label=${this.strings.signOutLinkSubtitle}>
              ${this.strings.signOutLinkSubtitle}
            </button>
          </li>
        </ul>
      `}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderSignedInButtonContent(e,t){return this.renderTemplate("signed-in-button-content",{personDetails:e,personImage:t})||html$1`
        <mgt-person .personDetails=${this.userDetails} .personImage=${this._image} .view=${Mr.oneline} />
      `}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||html$1`
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
        <span>${this.strings.signInLinkSubtitle}</span>
      `}showFlyout(){const e=this.flyout;e&&e.open()}hideFlyout(){const e=this.flyout;e&&e.close()}onClick(){this.userDetails?this.showFlyout():this.login()}};__decorate$k([property({attribute:"user-details",type:Object}),__metadata$j("design:type",Object)],sa.prototype,"userDetails",void 0),__decorate$k([property({attribute:!1}),__metadata$j("design:type",Boolean)],sa.prototype,"_isFlyoutOpen",void 0),sa=__decorate$k([customElement("mgt-login"),__metadata$j("design:paramtypes",[])],sa);var aa,__awaiter$k=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};!function(e){e[e.any=0]="any",e[e.unified=1]="unified",e[e.security=2]="security",e[e.mailenabledsecurity=4]="mailenabledsecurity",e[e.distribution=8]="distribution"}(aa||(aa={}));const getGroupsInvalidationTime=()=>CacheService.config.groups.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsGroupsCacheEnabled=()=>CacheService.config.groups.isEnabled&&CacheService.config.isEnabled;function findGroups(e,t,r=10,o=aa.any,i=""){return __awaiter$k(this,void 0,void 0,(function*(){const n="Group.Read.All";let s;const a=`${t||"*"}*${o}*${i}`;if(getIsGroupsCacheEnabled()){s=CacheService.getCache(Pr,Pr.stores.groupsQuery);const e=yield s.getValue(a);if(e&&getGroupsInvalidationTime()>Date.now()-e.timeCached&&e.top>=r)return e.groups.map((e=>JSON.parse(e))).slice(0,r+1)}let l,c="",d=[];if(""!==t&&(c=`(startswith(displayName,'${t}') or startswith(mailNickname,'${t}') or startswith(mail,'${t}'))`),i&&(c+=`${t?" and ":""}${i}`),o!==aa.any){const t=e.createBatch(),i=[];aa.unified===(o&aa.unified)&&i.push("groupTypes/any(c:c+eq+'Unified')"),aa.security===(o&aa.security)&&i.push("(mailEnabled eq false and securityEnabled eq true)"),aa.mailenabledsecurity===(o&aa.mailenabledsecurity)&&i.push("(mailEnabled eq true and securityEnabled eq true)"),aa.distribution===(o&aa.distribution)&&i.push("(mailEnabled eq true and securityEnabled eq false)"),c=c?`${c} and `:"";for(let e of i)t.get(e,`/groups?$filter=${c+e}`,["Group.Read.All"]);try{l=yield t.executeAll();for(let e=0;e<i.length;e++)if(l.get(i[e]).content.value)for(let t of l.get(i[e]).content.value){let e=d.filter((e=>e.id===t.id));0===e.length&&d.push(t),e=[]}}catch(t){try{let t=[];for(let o of i)t.push(yield e.api("groups").filter(`${c} and ${o}`).top(r).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes(n)).get());return Promise.all(t)}catch(e){return[]}}}else if(0===d.length){const t=yield e.api("groups").filter(c).top(r).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes(n)).get();return getIsGroupsCacheEnabled()&&t&&s.putValue(a,{groups:t.value.map((e=>JSON.stringify(e))),top:r}),t?t.value:null}return d}))}function getGroup(e,t,r){return __awaiter$k(this,void 0,void 0,(function*(){let o;if(getIsGroupsCacheEnabled()){o=CacheService.getCache(Pr,Pr.stores.groups);const e=yield o.getValue(t);if(e&&getGroupsInvalidationTime()>Date.now()-e.timeCached){const t=e.group?JSON.parse(e.group):null,o=r&&t?r.filter((e=>!Object.keys(t).includes(e))):null;if(!o||o.length<=1)return t}}let i=`/groups/${t}`;r&&(i=i+"?$select="+r.toString());const n=yield e.api(i).middlewareOptions(prepScopes("Group.Read.All")).get();return getIsGroupsCacheEnabled()&&o.putValue(t,{group:JSON.stringify(n)}),n}))}const la=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .spinner{border:2px solid #c7e0f4;border-top:2px solid #0078d4;border-radius:50%;width:20px;height:20px;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
`];var __decorate$j=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s};let ca=class MgtSpinner extends MgtBaseComponent{static get styles(){return la}render(){return html$1`
      <div class="spinner"></div>
    `}};ca=__decorate$j([customElement("mgt-spinner")],ca);const da=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--selected-person-background-color:#f0f0f0}.mgt-dark{--selected-person-background-color:#4f4f4f}:host{font-family:var(--default-font-family);font-size:14px;height:24px;display:contents;overflow:hidden;position:absolute;width:135px;left:0;top:0;border-radius:12px}:host .root,mgt-people-picker .root{display:block}.people-picker{background-color:var(--input-background-color,#fff);border-top:var(--input-border-top,var(--input-border,2px solid #605e5c));border-right:var(--input-border-right,var(--input-border,2px solid #605e5c));border-bottom:var(--input-border-bottom,var(--input-border,2px solid #605e5c));border-left:var(--input-border-left,var(--input-border,2px solid #605e5c));padding:6px 0 0}.people-picker:hover{border-color:var(--input-border-color--hover,#323130)}.people-picker.focused{border-color:var(--input-border-color--focus,#023b8f)}.people-picker.disabled{pointer-events:none}.people-picker .selected-list{flex:1 0 auto;display:flex;flex-wrap:wrap;vertical-align:middle;list-style-type:none;font-style:normal;font-weight:400;overflow:hidden}.people-picker .selected-list__options{display:contents}.people-picker .selected-list__person-wrapper,.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{display:flex;margin:0 5px 6px 0;align-items:center;border-radius:12px;height:24px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;background-color:var(--selected-person-background-color,#f0f0f0)}.people-picker .selected-list__person-wrapper-highlighted:hover,.people-picker .selected-list__person-wrapper:hover{background-color:#fafafa}.people-picker .selected-list__person-wrapper-highlighted__person,.people-picker .selected-list__person-wrapper__person{overflow:hidden;min-width:100%;--avatar-size-s:24px;margin-left:0;--color:var(--color-sub1, #323130);color:var(--color-sub1,#323130);padding-bottom:1px;padding-right:4px}.people-picker .selected-list__person-wrapper-highlighted__overflow,.people-picker .selected-list__person-wrapper__overflow{margin-left:25px}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,.people-picker .selected-list__person-wrapper__overflow__gradient{content:'';position:absolute;margin-right:23px;width:10px;height:90%;top:0;right:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f0f0f0) 100%);background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,.people-picker .selected-list__person-wrapper__overflow__close-icon{font-family:FabricMDL2Icons;cursor:pointer;color:var(--color-sub1,#323130);display:flex;flex-direction:column;align-items:center;position:absolute;height:24px;width:24px;right:0;top:0;border-radius:12px;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon:hover,.people-picker .selected-list__person-wrapper__overflow__close-icon:hover{color:#0078d4}.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{background:#005393}.people-picker .selected-list__person-wrapper-highlighted__person{color:#fff;--color:white}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient{background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon{background:#005393;color:#fff;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted:hover{background-color:#006cbe}.people-picker .selected-list .flyout .search-box{margin:1px 2px 8px}.people-picker .selected-list .flyout .search-box.search-box-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.people-picker .selected-list .flyout .search-box__input{box-sizing:border-box;border-width:0;border-style:none;width:100%;display:flex;flex:1 0 auto;font-family:var(--default-font-family);position:relative;outline:0;font-style:normal;font-weight:400;font-size:14px;background-color:var(--input-background-color,#fff);color:var(--color-sub1,#323130);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}.people-picker .selected-list .flyout .search-box__input::placeholder{color:var(--placeholder-color,#605e5c)}.people-picker .selected-list .flyout .flyout-root{padding:0;border-radius:2px;min-width:260px;overflow-y:auto;text-align:left;list-style-type:none;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));max-height:var(--mgt-flyout-set-height,unset);border-radius:8px}.people-picker .selected-list .flyout .flyout-root li{cursor:pointer}.people-picker .selected-list .flyout .flyout-root .people-list .list-person{display:flex;flex-direction:row;align-items:center;padding:12px;font-style:normal;font-weight:600;font-size:14px;margin:var(--file-item-margin,4px);border-radius:4px}.people-picker .selected-list .flyout .flyout-root .people-list .list-person:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .selected-list .flyout .flyout-root .people-list .list-person.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px;overflow:hidden;color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text.highlight-search-text{font-weight:700}mgt-person{--avatar-size-s:32px;margin-left:12px;cursor:default}:host .loading-text,:host .search-error-text,mgt-people-picker .loading-text,mgt-people-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;margin-left:50px;margin-right:50px;color:#023b8f}:host .message-parent,mgt-people-picker .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px}:host .people-person-job-title.uppercase,mgt-people-picker .people-person-job-title.uppercase{text-transform:uppercase}mgt-flyout{flex:1 0 auto}[dir=rtl] mgt-person{margin:0 12px 0 0}[dir=rtl] .selected-list{margin-right:8px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted,[dir=rtl] .selected-list__person-wrapper{margin-left:6px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__person,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__person,[dir=rtl] .selected-list__person-wrapper__person{margin-right:0!important;margin-left:4px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .selected-list__person-wrapper__overflow__gradient{right:auto!important;position:absolute!important;margin-right:0!important;width:10px!important;height:90%;top:0}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .selected-list__person-wrapper__overflow__close-icon{right:auto!important;margin-left:5px!important;left:0!important}[dir=rtl] .people-person-text-area{margin-right:13px;margin-left:0!important}[dir=rtl] .flyout-root{text-align:right!important}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}.flyout-root{border:1px solid #fff}.people-list .list-person{border:solid 1px #fff}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}.flyout-root{border:1px solid #000}.people-list .list-person{border:solid 1px #000}}
`],ua={inputPlaceholderText:"Start typing a name",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",suggestedContact:"suggested contact",suggestedContacts:"suggested contacts",selected:"selected"};var __decorate$i=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$i=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$j=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};let ha=class MgtPeoplePicker extends MgtTemplatedComponent{constructor(){super(),this._type=Dr.person,this._groupType=aa.any,this._userType=Lr.any,this._arrowSelectionCount=0,this._highlightedUsers=[],this._currentHighlightedUserPos=0,this._isFocused=!1,this._isKeyboardFocus=!0,this.clearState(),this._showLoading=!0,this.showMax=6,this.disableImages=!1,this.disabled=!1,this.allowAnyEmail=!1,this.addEventListener("copy",this.handleCopy),this.addEventListener("cut",this.handleCut),this.addEventListener("paste",this.handlePaste)}static get styles(){return da}get strings(){return ua}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector(".search-box__input")}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get type(){return this._type}set type(e){this._type!==e&&(this._type=e,this.requestStateUpdate(!0))}get groupType(){return this._groupType}set groupType(e){this._groupType!==e&&(this._groupType=e,this.requestStateUpdate(!0))}get userType(){return this._userType}set userType(e){this._userType!==e&&(this._userType=e,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(e){arraysAreEqual(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}get userFilters(){return this._userFilters}set userFilters(e){this._userFilters=e,this.requestStateUpdate(!0)}get peopleFilters(){return this._peopleFilters}set peopleFilters(e){this._peopleFilters=e,this.requestStateUpdate(!0)}get groupFilters(){return this._groupFilters}set groupFilters(e){this._groupFilters=e,this.requestStateUpdate(!0)}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all",...Gr.requiredScopes])]}focus(e){this.gainedFocus(),this.input&&(this.input.focus(e),this.input.select())}selectUsersById(e){return __awaiter$j(this,void 0,void 0,(function*(){const t=Providers.globalProvider,r=Providers.globalProvider.graph;if(t&&t.state===or.SignedIn)for(const t in e){const o=e[t];try{const e=yield getUser(r,o);this.addPerson(e)}catch(e){if(e.message&&e.message.includes("does not exist")&&this.allowAnyEmail&&isValidEmail(o)){const e={mail:o,displayName:o};this.addPerson(e)}}}}))}selectGroupsById(e){return __awaiter$j(this,void 0,void 0,(function*(){const t=Providers.globalProvider,r=Providers.globalProvider.graph;if(t&&t.state===or.SignedIn)for(const t in e)try{const o=yield getGroup(r,e[t]);this.addPerson(o)}catch(e){}}))}render(){const e=this.renderTemplate("default",{people:this._foundPeople});if(e)return e;const t=this.renderSelectedPeople(this.selectedPeople),r=this.renderInput(),o=this.renderFlyout(r),i={focused:this._isFocused,"people-picker":!0,disabled:this.disabled};return html$1`
       <div dir=${this.direction} class=${Sr(i)} @click=${e=>this.focus(e)}>
         <div
          aria-expanded="false"
          aria-haspopup="listbox"
          role="combobox"
          class="selected-list"
          id="selected-list">
           ${t} ${o}
         </div>
       </div>
     `}clearState(){this._groupId=null,this.selectedPeople=[],this.userInput="",this._highlightedUsers=[],this._currentHighlightedUserPos=0}requestStateUpdate(e){return e&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[]),super.requestStateUpdate(e)}renderInput(){const e=!!this.selectedPeople.length,t=this.disabled?this.placeholder||"":this.placeholder?this.placeholder:this.strings.inputPlaceholderText,r={"search-box":!0,"search-box-start":e};if("single"===(this.selectionMode?this.selectionMode:"multiple")&&this.selectedPeople.length>=1)return this.lostFocus(),null;const o=(void 0!==this._currentSelectedUser?this.strings.selected+" "+this._currentSelectedUser.displayName+" ":"")+" ' people-picker-input'";return html$1`
       <div class="${Sr(r)}">
         <input
           id="people-picker-input"
           class="search-box__input"
           type="text"
           role="combobox"
           placeholder=${t}
           label="people-picker-input"
           autocomplete="off"
           aria-label=${o}
           aria-autocomplete="list"
           aria-expanded="false"
           tabindex="0"
           @keydown="${this.onUserKeyDown}"
           @keyup="${this.onUserKeyUp}"
           @blur=${this.lostFocus}
           @click=${this.handleFlyout}
           ?disabled=${this.disabled}
         />
       </div>
     `}renderSelectedPeople(e){return e=e||this.selectedPeople,this.selectedPeople&&this.selectedPeople.length?html$1`
       <div
        tabindex="0"
        aria-label="selected-people"
        aria-orientation="vertical"
        role="listbox"
        class="selected-list__options">${e.slice(0,e.length).map((e=>html$1`
             <div
             role="option"
             tabindex="0"
             aria-label=${e.displayName}
             class="selected-list__person-wrapper">
               ${this.renderTemplate("selected-person",{person:e},`selected-${e.id?e.id:e.displayName}`)||this.renderSelectedPerson(e)}

               <div class="selected-list__person-wrapper__overflow">
                 <div class="selected-list__person-wrapper__overflow__gradient"></div>
                 <div
                   tabindex="0"
                   aria-label="close-icon"
                   class="selected-list__person-wrapper__overflow__close-icon"
                   @click="${t=>this.removePerson(e,t)}"
                 >
                   \uE711
                 </div>
               </div>
             </div>
           `))}</div>
     `:null}renderFlyout(e){return html$1`
       <mgt-flyout light-dismiss class="flyout">
         ${e}
         <div slot="flyout" class="flyout-root" @wheel=${e=>this.handleSectionScroll(e)}>
           ${this.renderFlyoutContent()}
         </div>
       </mgt-flyout>
     `}renderFlyoutContent(){if(this.isLoadingState||this._showLoading)return this.renderLoading();let e=this._foundPeople;if(!e||0===e.length||0===this.showMax)return this.renderNoData();for(const t of e)t.isFocused=!1;return e=e.slice(0,this.showMax),e[0].isFocused=!0,this.renderSearchResults(e)}renderLoading(){return this.renderTemplate("loading",null)||html$1`
         <div class="message-parent">
           <mgt-spinner></mgt-spinner>
           <div label="loading-text" aria-label="loading" class="loading-text">
             ${this.strings.loadingMessage}
           </div>
         </div>
       `}renderNoData(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||html$1`
         <div class="message-parent">
           <div label="search-error-text" aria-label=${this.strings.noResultsFound} class="search-error-text">
             ${this.strings.noResultsFound}
           </div>
         </div>
       `}renderSearchResults(e){let t=(e=e||this._foundPeople).filter((e=>e.id));this.renderRoot.querySelector(".selected-list");let r="";for(let e=0;e<t.length;e++)r+=t[e].displayName.toString()+" ";return html$1`
      <div
        id="suggestions-list"
        class="people-list"
        aria-expanded="true"
        role="list"
        aria-label="people-picker-input input text ${0===this.userInput.length?this.strings.inputPlaceholderText:this.userInput} ${this.strings.suggestedContacts} ${r}"
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}>
         ${Yr(t,(e=>e.id),(e=>{const t={focused:this._isKeyboardFocus&&0===this._arrowSelectionCount?e.isFocused:"","list-person":!0};return html$1`
               <li
                role="option"
                @keydown="${this.onUserKeyDown}"
                aria-label=" ${this.strings.suggestedContact} ${e.displayName}"
                id="${e.displayName}"
                tabindex="0"
                class="${Sr(t)}"
                @click="${t=>this.onPersonClick(e)}">
                 ${this.renderPersonResult(e)}
               </li>
             `}))}
       </div>
     `}renderPersonResult(e){const t=e,r=t.jobTitle||t.mail,o={"people-person-job-title":!0,uppercase:!!t.jobTitle};return this.renderTemplate("person",{person:e},e.id)||html$1`
         <mgt-person .personDetails=${e} .fetchImage=${!this.disableImages}></mgt-person>
         <div class="people-person-text-area" id="${e.displayName}">
           ${this.renderHighlightText(e)}
           <span class="${Sr(o)}">${r}</span>
         </div>
       `}renderSelectedPerson(e){return html$1`
       <mgt-person
         tabindex="-1"
         class="selected-list__person-wrapper__person"
         .personDetails=${e}
         .fetchImage=${!this.disableImages}
         .view=${Mr.oneline}
         .personCardInteraction=${Hr.click}
       ></mgt-person>
     `}loadState(){return __awaiter$j(this,void 0,void 0,(function*(){let e=this.people;const t=this.userInput.toLowerCase(),r=Providers.globalProvider;if(!e&&r&&r.state===or.SignedIn){const o=r.graph.forComponent(this);if(!t.length&&this._isFocused)if(this.defaultPeople)e=this.defaultPeople;else{if(this.groupId){if(null===this._groupPeople)try{this._groupPeople=yield findGroupMembers(o,null,this.groupId,this.showMax,this.type,this.transitiveSearch,this._groupFilters)}catch(e){this._groupPeople=[]}e=this._groupPeople||[]}else if(this.type===Dr.person||this.type===Dr.any)if(this.userIds)e=yield getUsersForUserIds(o,this.userIds,"",this.userFilters);else{const t=this.userType===Lr.user||this.userType===Lr.contact;e=this._userFilters&&t?yield function getUsers(e,t="",r=10){return __awaiter$x(this,void 0,void 0,(function*(){let o;const i=""===t?"*":t,n={maxResults:r,results:null};if(getIsUsersCacheEnabled()){o=CacheService.getCache(Ir,Ir.stores.userFilters);const e=yield o.getValue(i);if(e&&getUserInvalidationTime()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}const s=e.api("/users").top(r);t&&s.filter(t);try{const e=yield s.middlewareOptions(prepScopes("user.read")).get();return getIsUsersCacheEnabled()&&e&&(n.results=e.value.map((e=>JSON.stringify(e))),o.putValue(t,n)),e.value}catch(e){}}))}(o,this._userFilters,this.showMax):yield getPeople(o,this.userType,this._peopleFilters)}else if(this.type===Dr.group){let t=(yield findGroups(o,"",this.showMax,this.groupType,this._groupFilters))||[];t.length>0&&t[0].value&&(t=t[0].value),e=t}this.defaultPeople=e}if(this._showLoading=!1,!this.defaultSelectedUserIds&&!this.defaultSelectedGroupIds||this.selectedPeople.length||this.defaultSelectedUsers||(this.defaultSelectedUsers=yield getUsersForUserIds(o,this.defaultSelectedUserIds,"",this._userFilters),this.defaultSelectedGroups=yield function getGroupsForGroupIds(e,t,r=""){return __awaiter$k(this,void 0,void 0,(function*(){if(!t||0===t.length)return[];const o=e.createBatch(),i={},n=[];let s;getIsGroupsCacheEnabled()&&(s=CacheService.getCache(Pr,Pr.stores.groups));for(const e of t){i[e]=null;let t=null;if(getIsGroupsCacheEnabled()&&(t=yield s.getValue(e)),t&&getGroupsInvalidationTime()>Date.now()-t.timeCached)i[e]=t.group?JSON.parse(t.group):null;else if(""!==e){let t=`/groups/${e}`;r&&(t+=`${t}?$filters=${r}`),o.get(e,t,["Group.Read.All"]),n.push(e)}}try{const e=yield o.executeAll();for(const r of t){const t=e.get(r);t&&t.content&&(i[r]=t.content,getIsGroupsCacheEnabled()&&s.putValue(r,{group:JSON.stringify(t.content)}))}return Promise.all(Object.values(i))}catch(r){try{return t.filter((e=>n.includes(e))).forEach((t=>i[t]=getGroup(e,t))),getIsGroupsCacheEnabled()&&t.filter((e=>n.includes(e))).forEach((e=>__awaiter$k(this,void 0,void 0,(function*(){return s.putValue(e,{group:JSON.stringify(yield i[e])})})))),Promise.all(Object.values(i))}catch(e){return[]}}}))}(o,this.defaultSelectedGroupIds,this._groupFilters),this.defaultSelectedGroups=this.defaultSelectedGroups.filter((e=>null!==e)),this.defaultSelectedUsers=this.defaultSelectedUsers.filter((e=>null!==e)),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.requestUpdate(),this.fireCustomEvent("selectionChanged",this.selectedPeople)),t)if(e=[],this.groupId)e=(yield findGroupMembers(o,t,this.groupId,this.showMax,this.type,this.transitiveSearch,this._groupFilters))||[];else{if(this.type===Dr.person||this.type===Dr.any){try{e=this.userType===Lr.contact||this.userType===Lr.user?this.userIds&&this.userIds.length?yield getUsersForUserIds(o,this.userIds,t,this._userFilters):yield findUsers(o,t,this.showMax,this._userFilters):this.userIds&&this.userIds.length?yield getUsersForUserIds(o,this.userIds,t,this._userFilters):(yield findPeople(o,t,this.showMax,this.userType,this._peopleFilters))||[]}catch(e){}if(e.length<this.showMax&&this.userType!==Lr.contact&&this.type!==Dr.person)try{const r=(yield findUsers(o,t,this.showMax,this._userFilters))||[],i=new Set(e.map((e=>e.id)));for(const t of r)i.has(t.id)||e.push(t)}catch(e){}}if((this.type===Dr.group||this.type===Dr.any)&&e.length<this.showMax){let r=[];try{r=(yield findGroups(o,t,this.showMax,this.groupType,this._groupFilters))||[],e=e.concat(r)}catch(e){}}}}this._foundPeople=this.filterPeople(e)}))}hideFlyout(){const e=this.flyout;e&&e.close()}showFlyout(){const e=this.flyout;e&&e.open()}removePerson(e,t){t.stopPropagation();const r=this.selectedPeople.filter((t=>!e.id&&t.displayName?t.displayName!==e.displayName:t.id!==e.id));this.selectedPeople=r,this.loadState(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}addPerson(e){if(e){setTimeout((()=>{this.clearInput()}),50);0===this.selectedPeople.filter((t=>!e.id&&t.displayName?t.displayName===e.displayName:t.id===e.id)).length&&(this.selectedPeople=[...this.selectedPeople,e],this.fireCustomEvent("selectionChanged",this.selectedPeople),this.loadState(),this._foundPeople=[])}}clearInput(){this.clearHighlighted(),"single"!==this.selectionMode&&(this.input.value=""),this.userInput=""}handleFlyout(){const e=this.filterPeople(this.defaultPeople);let t=!0;e&&0===e.length&&(t=!1),t&&window.requestAnimationFrame((()=>{this.showFlyout()}))}gainedFocus(){this.clearHighlighted(),this._isFocused=!0,this.input&&this.input.focus(),this._showLoading=!0,this.loadState()}lostFocus(){this._isFocused=!1,this.requestUpdate()}handleMouseEnter(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseEnterTimeout=setTimeout(this.hideKeyboardFocus.bind(this),100)}handleMouseLeave(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this.showKeyboardFocus.bind(this),100)}hideKeyboardFocus(){this._isKeyboardFocus=!1,this.requestUpdate();const e=this.renderRoot.querySelector(".people-list");if(e&&e.children.length)for(let t=0;t<e.children.length;t++)e.children[t].classList.remove("focused")}showKeyboardFocus(){this._isKeyboardFocus=!0,this.handleArrowSelection()}renderHighlightText(e){let t="",r="",o="";const i=e.displayName,n=i.toLowerCase().indexOf(this.userInput.toLowerCase());if(-1!==n){const e=this.userInput.length;0===n?(t="",o=i.slice(0,e),r=i.slice(e,i.length)):n===i.length?(t=i.slice(0,n),o=i.slice(n,i.length),r=""):(t=i.slice(0,n),o=i.slice(n,n+e),r=i.slice(n+e,i.length))}else t=e.displayName;return html$1`
       <div>
         <span class="people-person-text">${t}</span
         ><span class="people-person-text highlight-search-text">${o}</span
         ><span class="people-person-text">${r}</span>
       </div>
     `}onUserKeyUp(e){const t=["ControlLeft","ControlRight"].includes(e.code)||e.ctrlKey||e.metaKey,r=["ArrowDown","ArrowRight","ArrowUp","ArrowLeft"].includes(e.code);if(t||r)return void((t||["ArrowLeft","ArrowRight"].includes(e.code))&&this.hideFlyout());"Tab"!==e.code||this.flyout.isOpen||this.allowAnyEmail&&this.gainedFocus(),e.shiftKey&&this.gainedFocus();const o=e.target;if("Escape"===e.code)this.clearInput(),this._foundPeople=[];else if("Backspace"===e.code&&0===this.userInput.length&&this.selectedPeople.length>0)this.clearHighlighted(),this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople);else{if("Comma"===e.code||"Semicolon"===e.code)return void(this.allowAnyEmail&&(e.preventDefault(),e.stopPropagation()));this.userInput=o.value;isValidEmail(this.userInput)||this.handleUserSearch()}}handleAnyEmail(){if(this._showLoading=!1,this._arrowSelectionCount=0,isValidEmail(this.userInput)){const e={mail:this.userInput,displayName:this.userInput};this.addPerson(e)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}onPersonClick(e){this._currentSelectedUser=e,this.addPerson(e),this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0,this.hideFlyout(),this.selectionMode)}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=debounce((()=>__awaiter$j(this,void 0,void 0,(function*(){const e=setTimeout((()=>{this._showLoading=!0}),50);yield this.loadState(),clearTimeout(e),this._showLoading=!1,this.showFlyout(),this._arrowSelectionCount=0}))),400)),this._debouncedSearch()}onUserKeyDown(e){const t=this.renderRoot.querySelector(".selected-list"),r=e.ctrlKey||e.metaKey;if(r&&t){const o=t.querySelectorAll("mgt-person.selected-list__person-wrapper__person");if(this.hideFlyout(),r&&"ArrowLeft"===e.code)this._currentHighlightedUserPos=(this._currentHighlightedUserPos-1+o.length)%o.length,this._currentHighlightedUserPos>=0&&NaN!==this._currentHighlightedUserPos?this._highlightedUsers.push(o[this._currentHighlightedUserPos]):this._currentHighlightedUserPos=0;else if(r&&"ArrowRight"===e.code){const e=this._highlightedUsers.pop();if(e){const t=e.parentElement;t&&(this.clearHighlighted(t),this._currentHighlightedUserPos++)}}else r&&"KeyA"===e.code&&(this._highlightedUsers=[],o.forEach((e=>this._highlightedUsers.push(e))));return void(this._highlightedUsers&&this.highlightSelectedPeople(this._highlightedUsers))}if(this.clearHighlighted(),!this.flyout.isOpen)return;40!==e.keyCode&&38!==e.keyCode||(this.handleArrowSelection(e),this.input.value.length>0&&e.preventDefault());const o=e.target;if("Tab"===e.code||"Enter"===e.code){if(!e.shiftKey&&this._foundPeople){e.preventDefault(),e.stopPropagation(),this._foundPeople.length&&this.fireCustomEvent("blur");const t=this._foundPeople[this._arrowSelectionCount];t?this.addPerson(t):this.allowAnyEmail&&this.handleAnyEmail()}this.hideFlyout(),e.target.value=""}else"Comma"!==e.code&&"Semicolon"!==e.code||this.allowAnyEmail&&(e.preventDefault(),e.stopPropagation(),this.userInput=o.value,this.handleAnyEmail())}writeHighlightedText(){return __awaiter$j(this,void 0,void 0,(function*(){const e=[];for(let t=0;t<this._highlightedUsers.length;t++){const r=this._highlightedUsers[t]._personDetails,{id:o,displayName:i,email:n,userPrincipalName:s,scoredEmailAddresses:a}=r;let l;l=a&&a.length>0?a.pop().address:s||n,e.push({id:o,displayName:i,email:l})}let t="";e.length>0&&(t=JSON.stringify(e)),yield navigator.clipboard.writeText(t)}))}handleCut(){return __awaiter$j(this,void 0,void 0,(function*(){yield this.writeHighlightedText(),this.removeHighlightedOnCut()}))}handleCopy(){return __awaiter$j(this,void 0,void 0,(function*(){yield this.writeHighlightedText()}))}handlePaste(){return __awaiter$j(this,void 0,void 0,(function*(){try{const e=yield navigator.clipboard.readText();if(e)try{const t=JSON.parse(e);if(t&&t.length>0)for(const e of t)this.addPerson(e)}catch(t){if(t instanceof SyntaxError){const t=[",",";"];let r;try{for(let o=0;o<t.length;o++)if(r=e.split(t[o]),r.length>1){this.hideFlyout(),this.selectUsersById(r);break}}catch(e){}}}}catch(e){}}))}removeHighlightedOnCut(){this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-this._highlightedUsers.length),this._highlightedUsers=[],this._currentHighlightedUserPos=0,this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}highlightSelectedPeople(e){for(let t=0;t<e.length;t++){const r=e[t].parentElement;r.setAttribute("class","selected-list__person-wrapper-highlighted");const o=Array.from(r.getElementsByClassName("selected-list__person-wrapper__person"));if(o&&o.length>0){o.pop().setAttribute("class","selected-list__person-wrapper-highlighted__person")}const i=Array.from(r.getElementsByClassName("selected-list__person-wrapper__overflow__gradient"));if(i&&i.length>0){i.pop().setAttribute("class","selected-list__person-wrapper-highlighted__overflow__gradient")}const n=Array.from(r.getElementsByClassName("selected-list__person-wrapper__overflow__close-icon"));if(n&&n.length>0){n.pop().setAttribute("class","selected-list__person-wrapper-highlighted__overflow__close-icon")}}}clearHighlighted(e){if(e)this.clearNodeHighlights(e);else{for(let e=0;e<this._highlightedUsers.length;e++){const t=this._highlightedUsers[e].parentElement;t&&this.clearNodeHighlights(t)}this._highlightedUsers=[],this._currentHighlightedUserPos=0}}clearNodeHighlights(e){e.setAttribute("class","selected-list__person-wrapper");const t=Array.from(e.getElementsByClassName("selected-list__person-wrapper-highlighted__person"));if(t&&t.length>0){t.pop().setAttribute("class","selected-list__person-wrapper__person")}const r=Array.from(e.getElementsByClassName("selected-list__person-wrapper-highlighted__overflow__gradient"));if(r&&r.length>0){r.pop().setAttribute("class","selected-list__person-wrapper__overflow__gradient")}const o=Array.from(e.getElementsByClassName("selected-list__person-wrapper-highlighted__overflow__close-icon"));if(o&&o.length>0){o.pop().setAttribute("class","selected-list__person-wrapper__overflow__close-icon")}}handleArrowSelection(e){const t=this.renderRoot.querySelector(".people-list");if(!1!==this._isKeyboardFocus&&t&&t.children.length){e&&(38===e.keyCode&&(this._arrowSelectionCount=(this._arrowSelectionCount-1+t.children.length)%t.children.length),40===e.keyCode&&(this._arrowSelectionCount=(this._arrowSelectionCount+1)%t.children.length));for(let e=0;e<t.children.length;e++)t.children[e].classList.remove("focused");const r=t.children[this._arrowSelectionCount];r&&(r.classList.add("focused"),r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),r.focus())}}filterPeople(e){if(e&&e.length>0){e=e.filter((e=>e));const t=this.selectedPeople.map((e=>e.id?e.id:e.displayName));return e.filter((e=>e.id?-1===t.indexOf(e.id):-1===t.indexOf(e.displayName)))}}handleSectionScroll(e){const t=this.renderRoot.querySelector(".flyout-root");t&&(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1||e.stopPropagation())}};__decorate$i([property({attribute:"group-id"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[Object])],ha.prototype,"groupId",null),__decorate$i([property({attribute:"type",converter:(e,t)=>(e=e.toLowerCase())&&0!==e.length?void 0===Dr[e]?Dr.any:Dr[e]:Dr.any}),__metadata$i("design:type",Object),__metadata$i("design:paramtypes",[Object])],ha.prototype,"type",null),__decorate$i([property({attribute:"group-type",converter:(e,t)=>{if(!e||0===e.length)return aa.any;const r=e.split(","),o=[];for(let e of r)e=e.trim(),void 0!==aa[e]&&o.push(aa[e]);return 0===o.length?aa.any:o.reduce(((e,t)=>e|t))}}),__metadata$i("design:type",Number),__metadata$i("design:paramtypes",[Object])],ha.prototype,"groupType",null),__decorate$i([property({attribute:"user-type",converter:(e,t)=>(e=e.toLowerCase())&&0!==e.length?void 0===Lr[e]?Lr.any:Lr[e]:Lr.any}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[Object])],ha.prototype,"userType",null),__decorate$i([property({attribute:"transitive-search",type:Boolean}),__metadata$i("design:type",Boolean)],ha.prototype,"transitiveSearch",void 0),__decorate$i([property({attribute:"people",type:Object}),__metadata$i("design:type",Array)],ha.prototype,"people",void 0),__decorate$i([property({attribute:"show-max",type:Number}),__metadata$i("design:type",Number)],ha.prototype,"showMax",void 0),__decorate$i([property({attribute:"disable-images",type:Boolean}),__metadata$i("design:type",Boolean)],ha.prototype,"disableImages",void 0),__decorate$i([property({attribute:"selected-people",type:Array}),__metadata$i("design:type",Array)],ha.prototype,"selectedPeople",void 0),__decorate$i([property({attribute:"default-selected-user-ids",converter:e=>e.split(",").map((e=>e.trim())),type:String}),__metadata$i("design:type",Array)],ha.prototype,"defaultSelectedUserIds",void 0),__decorate$i([property({attribute:"default-selected-group-ids",converter:e=>e.split(",").map((e=>e.trim())),type:String}),__metadata$i("design:type",Array)],ha.prototype,"defaultSelectedGroupIds",void 0),__decorate$i([property({attribute:"placeholder",type:String}),__metadata$i("design:type",String)],ha.prototype,"placeholder",void 0),__decorate$i([property({attribute:"disabled",type:Boolean}),__metadata$i("design:type",Boolean)],ha.prototype,"disabled",void 0),__decorate$i([property({attribute:"allow-any-email",type:Boolean}),__metadata$i("design:type",Boolean)],ha.prototype,"allowAnyEmail",void 0),__decorate$i([property({attribute:"selection-mode",type:String}),__metadata$i("design:type",String)],ha.prototype,"selectionMode",void 0),__decorate$i([property({attribute:"user-ids",converter:e=>e.split(",").map((e=>e.trim())),type:String}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Array])],ha.prototype,"userIds",null),__decorate$i([property({attribute:"user-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],ha.prototype,"userFilters",null),__decorate$i([property({attribute:"people-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],ha.prototype,"peopleFilters",null),__decorate$i([property({attribute:"group-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],ha.prototype,"groupFilters",null),__decorate$i([property({attribute:!1}),__metadata$i("design:type",Boolean)],ha.prototype,"_showLoading",void 0),__decorate$i([internalProperty(),__metadata$i("design:type",Object)],ha.prototype,"_isFocused",void 0),__decorate$i([internalProperty(),__metadata$i("design:type",Array)],ha.prototype,"_foundPeople",void 0),ha=__decorate$i([customElement("mgt-people-picker"),__metadata$i("design:paramtypes",[])],ha);var __awaiter$i=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};const pa="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id",fa="directReports",ga="files",ma="messages",va="people",ba="person";function getPersonCardGraphData(e,t,r,o){return __awaiter$i(this,void 0,void 0,(function*(){const i=t.id,n=getEmailFromGraphEntity(t),s="classification"in t||"personType"in t&&("PersonalContact"===t.personType.subclass||"Group"===t.personType.class),a=e.createBatch();let l;s||o.sections.organization&&(!function buildOrgStructureRequest(e,t){const r=`manager($levels=max;$select=${pa})`;e.get(ba,`users/${t}?$expand=${r}&$select=${pa}&$count=true`,["user.read.all"],{ConsistencyLevel:"eventual"}),e.get(fa,`users/${t}/directReports?$select=${pa}`)}(a,i),"boolean"!=typeof o.sections.organization&&o.sections.organization.showWorksWith&&function buildWorksWithRequest(e,t){e.get(va,`users/${t}/people?$filter=personType/class eq 'Person'`,["People.Read.All"])}(a,i)),o.sections.mailMessages&&n&&function buildMessagesWithUserRequest(e,t){e.get(ma,`me/messages?$search="from:${t}"`,["Mail.Read"])}(a,n),o.sections.files&&function buildFilesRequest(e,t){let r;r=t?`me/insights/shared?$filter=lastshared/sharedby/address eq '${t}'`:"me/insights/used";e.get(ga,r,["Sites.Read.All"])}(a,r?null:n);const c={};try{l=yield a.executeAll()}catch(e){}if(l)for(const[e,t]of l)c[e]=t.content.value||t.content;if(!s&&o.sections.profile)try{const t=yield function getProfile(e,t){return __awaiter$i(this,void 0,void 0,(function*(){return yield e.api(`/users/${t}/profile`).version("beta").get()}))}(e,i);t&&(c.profile=t)}catch(e){}return c}))}const ya=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}:host{background:var(--person-card-background-color,var(--background-color,#fff));width:var(--mgt-flyout-set-width,375px);font-family:var(--default-font-family);overflow:hidden;user-select:none;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border:1px solid var(--background-color-sub1,#faf9f8);border-radius:2px}:host .nav{height:0;position:relative;z-index:100}:host .nav .nav__back{padding:8px;height:32px;width:32px;align-items:center;justify-content:center}:host .nav .nav__back svg{fill:var(--person-card-nav-back-arrow-color,#023b8f)}:host .nav .nav__back:hover{cursor:pointer}:host .nav .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,#000)}:host .close-card-container .close-button{--focus-stroke-width:none;--control-corner-radius:2;--accent-foreground-active:none;position:absolute;right:10px;margin-top:9px;z-index:1;--accent-foreground-hover:none;border:1px solid transparent}:host .close-card-container .close-button svg{width:9px;height:9px}:host .person-details-container{display:flex;flex-direction:column;width:calc(var(--mgt-flyout-set-width,375px) - 40px);padding:20px 20px 13px 20px}:host .person-details-container .person-image{--presence-background-color:var(--person-card-background-color, var(--background-color, #ffffff));--presence-icon-color:var(--person-card-background-color, var(--background-color, #ffffff));--avatar-size:75px;--font-size:var(--person-card-display-name-font-size, 20px);--color:var(--person-card-display-name-color, var(--color-sub1, #323130));--line2-font-size:var(--person-card-title-font-size, 14px);--line2-color:var(--person-card-title-color);--line3-font-size:var(--person-card-subtitle-font-size, 12px);--line3-color:var(--person-card-subtitle-color)}:host .person-details-container .base-icons{display:flex;-webkit-align-items:center;align-items:center;font-family:'Segoe Fluent Icons';margin-left:-8px}:host .person-details-container .base-icons .icon{display:flex;align-items:center;cursor:pointer;font-size:13px;white-space:nowrap;padding:6px 8px 6px 8px;border:1px solid transparent}:host .person-details-container .base-icons .icon:focus-visible{outline:0!important;border:1px solid #2b2b2b;border-radius:2px}:host .person-details-container .base-icons .icon:not(:last-child){margin-right:11px}:host .person-details-container .base-icons .icon svg{fill:var(--icon-color,#605e5c)}:host .person-details-container .base-icons .icon:hover{color:#005a9e}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;align-items:center;height:28px;background:var(--person-card-background-color,var(--background-color,#fff));border-top:1px solid var(--line-seperator-color,#edebe9)}:host .expanded-details-container .expanded-details-button:hover{background-color:var(--background-color--hover,#edebe9)}:host .expanded-details-container .expanded-details-button:focus-visible{background-color:var(--background-color--hover,#edebe9);outline:0!important;border:1px solid #2b2b2b;border-bottom-left-radius:4px;border-bottom-right-radius:4px}:host .section-nav{border-bottom:1px solid var(--tab-line-color,#edebe9);height:36px;padding-bottom:7px;border:1px solid transparent}:host .section-nav fluent-tabs{background-color:var(--person-card-background-color,var(--background-color,#fff));grid-template-columns:minmax(1px,.1fr)}:host .section-nav fluent-tabs .activeIndicator{width:10px}:host .section-nav fluent-tabs fluent-tab-panel{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden;padding:0;border-top:1px solid var(--tab-line-color,#edebe9);scrollbar-width:thin}:host .section-nav fluent-tabs fluent-tab-panel .inserted{max-width:var(--mgt-flyout-set-width,375px);min-width:var(--mgt-flyout-set-width,360px)}:host .section-nav fluent-tabs fluent-tab-panel .overview-panel{max-width:var(--mgt-flyout-set-width,375px)}:host .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-button{background:var(--person-card-background-color,var(--background-color,#fff));height:1px}:host .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track{background:var(--person-card-background-color,var(--background-color,#fff));border-radius:10px}:host .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track-piece{background:var(--person-card-background-color,var(--background-color,#fff))}:host .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .section-nav fluent-tab{padding-bottom:4px!important;margin-bottom:-3px!important;border:1px solid transparent!important}:host .section-nav fluent-tab:focus-visible{border:1px solid #2b2b2b!important}:host .section-nav .section-nav__icon{all:initial;box-sizing:border-box;width:48px;padding:12px;display:flex;align-items:center;justify-content:center;border-bottom:2px solid transparent;margin-bottom:-1px;cursor:pointer}:host .section-nav .section-nav__icon svg{width:20px;height:20px;fill:var(--icon-color,#605e5c)}:host .section-nav .section-nav__icon:hover{background:var(--tab-background-color--hover,#edebe9);border-radius:2px}:host .section-nav .section-nav__icon.active svg{fill:var(--person-card-tab-nav-color,#023b8f)}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .message-section{border-bottom:1px solid var(--tab-line-color,#edebe9);--background-color:$background-color}:host .message-section fluent-text-field{margin:4px 0;width:83%;width:300px;padding:4px 10px}:host .message-section fluent-text-field::after{border:none}:host .message-section .send-message-icon{max-width:15px}:host .message-section svg{height:17px;width:16px;margin-bottom:6px;fill:var(--icon-color,#605e5c)}:host .message-section svg:hover{filter:brightness(.5)}:host .section-host{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden}:host .section-host::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .section-host::-webkit-scrollbar-button{background:#fff}:host .section-host::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .section-host::-webkit-scrollbar-track-piece{background:#fff}:host .section-host::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .quick-message{display:flex;flex-direction:row;border-bottom:1px solid var(--tab-line-color,#edebe9);padding:12px 10px 8px 10px}:host .quick-message .quick-message__input{flex-grow:1;padding-left:8px;border:none;border-radius:2px;color:var(--color-sub1,#323130);background-color:var(--background-color-sub2,#f3f2f1)}:host .quick-message .quick-message__send{all:initial;height:32px;width:32px;display:flex;align-items:center;justify-content:center}:host .quick-message .quick-message__send svg{fill:var(--color-sub2,#717171);height:18px;width:18px}:host .quick-message .quick-message__send:hover svg{fill:var(--color-sub1,#323130)}:host .sections .section{padding:14px 0;display:flex;flex-direction:column;position:relative}:host .sections .section:not(:last-child):after{position:absolute;content:'';width:90%;transform:translateX(-50%);border-bottom:1px solid var(--tab-line-color,#edebe9);left:50%;bottom:0}:host .sections .section .section__header{display:flex;flex-direction:row;padding:0 20px}:host .sections .section .section__header fluent-button{background-color:var(--person-card-background-color,var(--background-color,#fff));--neutral-fill-stealth-rest:$background-color;--accent-foreground-hover:$background-color;--accent-foreground-active:$background-color;--base-height-multiplier:5;vertical-align:top}:host .sections .section .section__title{flex-grow:1;color:var(--title-color-subtitle,#323130);font-size:14px;font-weight:600}:host .sections .section .section__show-more{color:#023b8f;font-size:12px;font-weight:600;align-self:center}:host .sections .section .section__show-more:hover{cursor:pointer;color:var(--person-card-show-more-hover-color,#005a9e)}:host .sections .section .section__content{margin-top:14px}:host .sections .section .additional-details{padding:0 20px}[dir=rtl] .base-icons span{margin-right:8px}[dir=rtl] .nav__back{width:20px!important;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}[dir=rtl] .close-card-container .close-button{right:auto;left:10px}[dir=rtl] .message-section svg{transform:scale(-1,1)}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __decorate$h=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};class BasePersonCardSection extends MgtTemplatedComponent{constructor(){super(),this._isCompact=!1,this._personDetails=null}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.requestStateUpdate())}get isCompact(){return this._isCompact}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this.requestUpdate(),this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return html$1`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `}renderNoData(){return html$1`
      <div class="no-data">No data</div>
    `}navigateCard(e){let t=this.parentNode;for(;t;)if(t=t.parentNode,t&&t.host&&"MGT-PERSON-CARD"===t.host.tagName){t=t.host;break}t.navigate(e)}}__decorate$h([property({attribute:"person-details",type:Object}),__metadata$h("design:type",Object),__metadata$h("design:paramtypes",[Object])],BasePersonCardSection.prototype,"personDetails",null);const wa=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--title-color-sub2,#717171);line-height:16px}:host .root .part .part__details .part__value{grid-column:2;color:var(--color-sub1,#323130);font-size:14px;font-weight:400;line-height:19px}:host .root .part .part__details .part__value .part__link{color:var(--person-card-contact-link-color,#023b8f);font-family:var(--default-font-family);font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:#012e7f}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--background-color-sub2,#f3f2f1);visibility:hidden;display:flex;align-items:center;justify-content:center}:host .root .part .part__copy svg{fill:var(--color-sub1,#323130);cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],Ca={contactSectionTitle:"Contact"};var __decorate$g=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ka=class MgtPersonCardContact extends BasePersonCardSection{constructor(e){super(),this._contactParts={email:{icon:getSvg($r.Email,"#929292"),onClick:()=>this.sendEmail(),showCompact:!0,title:"Email"},chat:{icon:getSvg($r.Chat,"#929292"),onClick:()=>this.sendChat(),showCompact:!1,title:"Teams"},businessPhone:{icon:getSvg($r.CellPhone,"#929292"),onClick:()=>this.sendCall("businessPhone"),showCompact:!0,title:"Business Phone"},cellPhone:{icon:getSvg($r.CellPhone,"#929292"),onClick:()=>this.sendCall("cellPhone"),showCompact:!0,title:"Mobile Phone"},department:{icon:getSvg($r.Department,"#929292"),showCompact:!1,title:"Department"},title:{icon:getSvg($r.Person,"#929292"),showCompact:!1,title:"Title"},officeLocation:{icon:getSvg($r.OfficeLocation,"#929292"),showCompact:!0,title:"Office Location"}},this._person=e,this._contactParts.email.value=getEmailFromGraphEntity(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,this._person.businessPhones&&this._person.businessPhones.length&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}static get styles(){return wa}get strings(){return Ca}get hasData(){if(!this._contactParts)return!1;return!!Object.values(this._contactParts).filter((e=>!!e.value)).length}get displayName(){return this.strings.contactSectionTitle}renderIcon(){return getSvg($r.Contact)}clearState(){super.clearState();for(const e of Object.keys(this._contactParts))this._contactParts[e].value=null}renderCompactView(){let e;if(!this.hasData)return null;const t=Object.values(this._contactParts).filter((e=>!!e.value));let r=Object.values(t).filter((e=>!!e.value&&e.showCompact));return r&&r.length||(r=Object.values(t).slice(0,2)),e=html$1`
      ${r.map((e=>this.renderContactPart(e)))}
    `,html$1`
      <div class="root compact" dir=${this.direction}>
        ${e}
      </div>
    `}renderFullView(){let e;if(this.hasData){const t=Object.values(this._contactParts).filter((e=>!!e.value));e=html$1`
        ${t.map((e=>this.renderContactPart(e)))}
      `}return html$1`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.displayName}</div>
        ${e}
      </div>
    `}renderContactPart(e){let t=!1;"Mobile Phone"!==e.title&&"Business Phone"!==e.title||(t=!0);const r={part__link:!0,phone:t},o=e.onClick?html$1`
          <span class=${Sr(r)} @click=${t=>e.onClick(t)}>${e.value}</span>
        `:html$1`
          ${e.value}
        `;return html$1`
      <div class="part" @click=${t=>this.handlePartClick(t,e.value)}>
        <div class="part__icon">${e.icon}</div>
        <div class="part__details">
          <div class="part__title">${e.title}</div>
          <div class="part__value">${o}</div>
        </div>
        <div class="part__copy">
          ${getSvg($r.Copy)}
        </div>
      </div>
    `}handlePartClick(e,t){t&&navigator.clipboard.writeText(t)}sendChat(){const e=this._contactParts.chat.value;if(!e)return;const t=`https://teams.microsoft.com/l/chat/0/0?users=${e}`,openWindow=()=>window.open(t,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(t,(e=>{e||openWindow()})):openWindow()}sendEmail(){const e=this._contactParts.email.value;e&&window.open("mailto:"+e,"_blank","noreferrer")}sendCall(e){const t=this._contactParts.cellPhone.value,r=this._contactParts.businessPhone.value;"cellPhone"===e?window.open("tel:"+t,"_blank","noreferrer"):"businessPhone"===e&&window.open("tel:"+r,"_blank","noreferrer")}};ka=__decorate$g([customElement("mgt-person-card-contact"),__metadata$g("design:paramtypes",[Object])],ka);const Ta=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .file{display:flex;align-items:center;padding:11px 20px}:host .root .file:hover{background-color:#f7f7f7;cursor:pointer}:host .root .file:last-child{margin-bottom:unset}:host .root .file .file__icon{width:28px;min-width:28px;height:28px;margin-right:12px;display:flex;align-items:center;justify-content:center}:host .root .file .file__icon img{height:28px;width:28px}:host .root .file .file__details{min-width:0;margin-right:40px}:host .root .file .file__details .file__name{font-size:14px;color:var(--color-sub1,#323130)}:host .root .file .file__details .file__last-modified{font-size:12px;color:var(--color-sub2,#717171)}:host .root .file .file__details>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[dir=rtl] .file__icon{margin-right:0!important}[dir=rtl] .file__details{margin-right:12px!important}
`],_a={filesSectionTitle:"Files",sharedTextSubtitle:"Shared"};var __decorate$f=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Sa=class MgtPersonCardFiles extends BasePersonCardSection{constructor(e){super(),this._files=e}static get styles(){return Ta}get strings(){return _a}get displayName(){return this.strings.filesSectionTitle}clearState(){super.clearState(),this._files=null}renderIcon(){return getSvg($r.Files)}renderCompactView(){let e;return e=this.isLoadingState?this.renderLoading():this._files&&this._files.length?html$1`
        ${this._files.slice(0,3).map((e=>this.renderFile(e)))}
      `:this.renderNoData(),html$1`
      <div class="root compact" dir=${this.direction}>
        ${e}
      </div>
    `}renderFullView(){let e;return e=this.isLoadingState?this.renderLoading():this._files&&this._files.length?html$1`
        ${this._files.map((e=>this.renderFile(e)))}
      `:this.renderNoData(),html$1`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.filesSectionTitle}</div>
        ${e}
      </div>
    `}renderFile(e){const t=e.lastShared?html$1`
          <div class="file__last-modified">
            ${this.strings.sharedTextSubtitle} ${getRelativeDisplayDate(new Date(e.lastShared.sharedDateTime))}
          </div>
        `:null;return html$1`
      <div class="file" @click=${t=>this.handleFileClick(e)}>
        <div class="file__icon">
          <img alt="${e.resourceVisualization.title}" src=${function getFileTypeIconUri(e,t,r){const o=to[e]||"genericfile";return`${ro}/${t.toString()}/${o}.${r}`}(e.resourceVisualization.type,48,"svg")} />
        </div>
        <div class="file__details">
          <div class="file__name">${e.resourceVisualization.title}</div>
          ${t}
        </div>
      </div>
    `}handleFileClick(e){e.resourceReference&&e.resourceReference.webUrl&&window.open(e.resourceReference.webUrl,"_blank","noreferrer")}};Sa=__decorate$f([customElement("mgt-person-card-files"),__metadata$f("design:paramtypes",[Array])],Sa);const Ea=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:#f7f7f7;cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--color,#000);font-size:14px}:host .root .message .message__detail .message__from{font-size:12px;color:var(--color-sub1,#323130);line-height:16px}:host .root .message .message__detail .message__message{font-size:12px;color:var(--color-sub2,#717171);line-height:16px}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{font-size:12px;color:var(--color-sub2,#717171);margin-left:10px;white-space:nowrap}
`],Ia={emailsSectionTitle:"Emails"};var __decorate$e=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$e=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let xa=class MgtPersonCardMessages extends BasePersonCardSection{constructor(e){super(),this._messages=e}static get styles(){return Ea}get strings(){return Ia}get displayName(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return getSvg($r.Messages)}renderCompactView(){let e;if(this.isLoadingState)e=this.renderLoading();else if(this._messages&&this._messages.length){const t=this._messages?this._messages.slice(0,3).map((e=>this.renderMessage(e))):[];e=html$1`
        ${t}
      `}else e=this.renderNoData();return html$1`
      <div class="root compact">
        ${e}
      </div>
    `}renderFullView(){let e;return e=this.isLoadingState?this.renderLoading():this._messages&&this._messages.length?html$1`
        ${this._messages.slice(0,5).map((e=>this.renderMessage(e)))}
      `:this.renderNoData(),html$1`
      <div class="root">
        <div class="title">${this.strings.emailsSectionTitle}</div>
        ${e}
      </div>
    `}renderMessage(e){return html$1`
      <div class="message" @click=${()=>this.handleMessageClick(e)}>
        <div class="message__detail">
          <div class="message__subject">${e.subject}</div>
          <div class="message__from">${e.from.emailAddress.name}</div>
          <div class="message__message">${e.bodyPreview}</div>
        </div>
        <div class="message__date">${getRelativeDisplayDate(new Date(e.receivedDateTime))}</div>
      </div>
    `}handleMessageClick(e){window.open(e.webLink,"_blank","noreferrer")}};xa=__decorate$e([customElement("mgt-person-card-messages"),__metadata$e("design:paramtypes",[Array])],xa);const Aa=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 20px 20px;line-height:19px}:host .root .subtitle{color:var(--title-color-sub2,#717171);font-size:14px;margin:0 20px 8px 20px}:host .root .divider{display:flex;background:var(--line-seperator-color,#edebe9);height:1px;margin-top:26px;margin-bottom:18px;margin-left:20px;margin-right:20px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:#fbfbfb;border:1px solid #023b8f}:host .root .org-member.org-member--target mgt-person{--line2-color:#000000}:host .root .org-member:not(.org-member--target){border:1px solid var(--line-seperator-color,#edebe9)}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:#f7f7f7}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--color-sub1,#323130);font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--color-sub2,#717171)}:host .root .org-member__separator:not(:last-child){border:1px solid var(--line-seperator-color,#edebe9);box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:#f7f7f7}:host .root .coworker .coworker__person{height:46px;border-radius:46px;margin-right:8px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],Pa={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"};var __decorate$d=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ra=class MgtPersonCardOrganization extends BasePersonCardSection{constructor(e,t){super(),this._state=e,this._me=t}static get styles(){return Aa}get strings(){return Pa}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){const{person:e,directReports:t}=this._state;return!e.manager&&t&&t.length?`${this.strings.directReportsSectionTitle} (${t.length})`:this.strings.reportsToSectionTitle}renderIcon(){return getSvg($r.Organization)}renderCompactView(){let e;if(!this._state||!this._state.person)return null;const{person:t,directReports:r}=this._state;return t?(t.manager?e=this.renderCoworker(t.manager):r&&r.length&&(e=this.renderCompactDirectReports()),html$1`
      <div class="root compact">
        ${e}
      </div>
    `):null}renderFullView(){let e;if(!this._state||!this._state.person)return null;const{person:t,directReports:r,people:o}=this._state;if(!(t||r||o))return null;{const t=this.renderManagers(),r=this.renderCurrentUser(),o=this.renderDirectReports(),i=this.renderCoworkers();e=html$1`
        ${t} ${r} ${o} ${i}
      `}return html$1`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.organizationSectionTitle}</div>
        ${e}
      </div>
    `}renderManager(e){return html$1`
      <div class="org-member" @click=${()=>this.navigateCard(e)}>
        <div class="org-member__person">
          <mgt-person
            .personDetails=${e}
            .fetchImage=${!0}
            .view=${Mr.twolines}
            .showPresence=${!0}
          ></mgt-person>
        </div>
        <div class="org-member__more">
          ${getSvg($r.ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
    `}renderManagers(){const{person:e}=this._state;if(!e||!e.manager)return null;const t=[];let r=e;for(;r.manager;)t.push(r.manager),r=r.manager;return t.length?t.reverse().map((e=>this.renderManager(e))):null}renderDirectReports(){const{directReports:e}=this._state;return e&&e.length?html$1`
      <div class="org-member__separator"></div>
      <div>
        ${e.map((e=>html$1`
            <div class="org-member org-member--direct-report" @click=${()=>this.navigateCard(e)}>
              <div class="org-member__person">
                <mgt-person
                  .personDetails=${e}
                  .fetchImage=${!0}
                  .showPresence=${!0}
                  .view=${Mr.twolines}
                ></mgt-person>
              </div>
              <div class="org-member__more">
                ${getSvg($r.ExpandRight)}
              </div>
            </div>
            <div class="org-member__separator"></div>
          `))}
      </div>
    `:null}renderCompactDirectReports(){const{directReports:e}=this._state;return html$1`
      <div class="direct-report__compact">
        ${e.slice(0,6).map((e=>html$1`
            <div class="direct-report" @click=${()=>this.navigateCard(e)}>
              <mgt-person 
                .personDetails=${e} 
                .fetchImage=${!0} 
                .showPresence=${!0} 
                .view=${Mr.twolines}
              ></mgt-person>
            </div>
          `))}
      </div>
    `}renderCurrentUser(){const{person:e}=this._state;return html$1`
      <div class="org-member org-member--target">
        <div class="org-member__person">
          <mgt-person
            .personDetails=${e}
            .fetchImage=${!0}
            .showPresence=${!0}
            .view=${Mr.twolines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworker(e){return html$1`
      <div class="coworker" @click=${()=>this.navigateCard(e)}>
        <div class="coworker__person">
          <mgt-person
            .personDetails=${e}
            .fetchImage=${!0}
            .showPresence=${!0}
            .view=${Mr.twolines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworkers(){const{people:e}=this._state;if(!e||!e.length)return null;const t=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return html$1`
      <div class="divider"></div>
      <div class="subtitle">${t}</div>
      <div>
        ${e.slice(0,6).map((e=>this.renderCoworker(e)))}
      </div>
    `}};Ra=__decorate$d([customElement("mgt-person-card-organization"),__metadata$d("design:paramtypes",[Object,Object])],Ra);const Oa=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--title-color-sub2,#717171)}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--background-color-sub2,#f3f2f1);border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item:hover{color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset;background:0 0;color:#023b8f}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--color-sub2,#717171);margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--title-color-subtitle,#323130)}:host .root .data-list__item .data-list__item__date-range{color:var(--color-sub2,#717171);font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#023b8f}:host .root .work-position .work-position__location{font-size:10px;color:var(--color-sub2,#717171);line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--color-sub3,#727170)}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--color-sub1,#323130)}[dir=rtl] .token-list__item{margin-right:0!important}
`],Na={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current",socialMediaSubSectionTitle:"Social Media"};var __decorate$c=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Da=class MgtPersonCardProfile extends BasePersonCardSection{constructor(e){super(),this.profile=e}static get styles(){return Oa}get strings(){return Na}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get hasData(){if(!this.profile)return!1;const{languages:e,skills:t,positions:r,educationalActivities:o}=this.profile;return[this._birthdayAnniversary,this._personalInterests&&this._personalInterests.length,this._professionalInterests&&this._professionalInterests.length,e&&e.length,t&&t.length,r&&r.length,o&&o.length].filter((e=>!!e)).length>0}get profile(){return this._profile}set profile(e){e!==this._profile&&(this._profile=e,this._birthdayAnniversary=e&&e.anniversaries?e.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=e&&e.interests?e.interests.filter(this.isPersonalInterest):null,this._professionalInterests=e&&e.interests?e.interests.filter(this.isProfessionalInterest):null)}renderIcon(){return getSvg($r.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return html$1`
      <div class="root compact" dir=${this.direction}>
        ${this.renderSubSections().slice(0,2)}
      </div>
    `}renderFullView(){return this.initPostRenderOperations(),html$1`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.AboutCompactSectionTitle}</div>
        ${this.renderSubSections()}
      </div>
    `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter((e=>!!e))}renderLanguages(){const{languages:e}=this._profile;if(!e||!e.length)return null;const t=[];for(const r of e){let e=null;r.proficiency&&r.proficiency.length&&(e=html$1`
          <span class="language__proficiency">
            &nbsp;(${r.proficiency})
          </span>
        `),t.push(html$1`
        <div class="token-list__item language">
          <span class="language__title">${r.displayName}</span>
          ${e}
        </div>
      `)}const r=t.length?this.strings.LanguagesSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title">${r}</div>
        <div class="section__content">
          <div class="token-list">
            ${t}
          </div>
        </div>
      </section>
    `}renderSkills(){const{skills:e}=this._profile;if(!e||!e.length)return null;const t=[];for(const r of e)t.push(html$1`
        <div class="token-list__item skill">
          ${r.displayName}
        </div>
      `);const r=t.length?this.strings.SkillsSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title">${r}</div>
        <div class="section__content">
          <div class="token-list">
            ${t}
          </div>
        </div>
      </section>
    `}renderWorkExperience(){var e,t,r,o,i,n,s,a,l;const{positions:c}=this._profile;if(!c||!c.length)return null;const d=[];for(const c of this._profile.positions)(c.detail.description||""!==c.detail.jobTitle)&&d.push(html$1`
          <div class="data-list__item work-position">
            <div class="data-list__item__header">
              <div class="data-list__item__title">${null===(e=c.detail)||void 0===e?void 0:e.jobTitle}</div>
              <div class="data-list__item__date-range">
                ${this.getDisplayDateRange(c.detail)}
              </div>
            </div>
            <div class="data-list__item__content">
              <div class="work-position__company">
                ${null===(r=null===(t=null==c?void 0:c.detail)||void 0===t?void 0:t.company)||void 0===r?void 0:r.displayName}
              </div>
              <div class="work-position__location">
                ${null===(n=null===(i=null===(o=null==c?void 0:c.detail)||void 0===o?void 0:o.company)||void 0===i?void 0:i.address)||void 0===n?void 0:n.city}, ${null===(l=null===(a=null===(s=null==c?void 0:c.detail)||void 0===s?void 0:s.company)||void 0===a?void 0:a.address)||void 0===l?void 0:l.state}
              </div>
            </div>
          </div>
        `);const u=d.length?this.strings.WorkExperienceSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title">${u}</div>
        <div class="section__content">
          <div class="data-list">
            ${d}
          </div>
        </div>
      </section>
    `}renderEducation(){const{educationalActivities:e}=this._profile;if(!e||!e.length)return null;const t=[];for(const r of e)t.push(html$1`
        <div class="data-list__item educational-activity">
          <div class="data-list__item__header">
            <div class="data-list__item__title">${r.institution.displayName}</div>
            <div class="data-list__item__date-range">
              ${this.getDisplayDateRange(r)}
            </div>
          </div>
          <div class="data-list__item__content">
            <div class="educational-activity__degree">
              ${r.program.displayName||"Bachelors Degree"}
            </div>
          </div>
        </div>
      `);const r=t.length?this.strings.EducationSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title">${r}</div>
        <div class="section__content">
          <div class="data-list">
            ${t}
          </div>
        </div>
      </section>
    `}renderProfessionalInterests(){if(!this._professionalInterests||!this._professionalInterests.length)return null;const e=[];for(const t of this._professionalInterests)e.push(html$1`
        <div class="token-list__item interest interest--professional">
          ${t.displayName}
        </div>
      `);const t=e.length?this.strings.professionalInterestsSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title">${t}</div>
        <div class="section__content">
          <div class="token-list">
            ${e}
          </div>
        </div>
      </section>
    `}renderPersonalInterests(){if(!this._personalInterests||!this._personalInterests.length)return null;const e=[];for(const t of this._personalInterests)e.push(html$1`
        <div class="token-list__item interest interest--personal">
          ${t.displayName}
        </div>
      `);const t=e.length?this.strings.personalInterestsSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title">${t}</div>
        <div class="section__content">
          <div class="token-list">
            ${e}
          </div>
        </div>
      </section>
    `}renderBirthday(){return this._birthdayAnniversary&&this._birthdayAnniversary.date?html$1`
      <section>
        <div class="section__title">Birthday</div>
        <div class="section__content">
          <div class="birthday">
            <div class="birthday__icon">
              ${getSvg($r.Birthday)}
            </div>
            <div class="birthday__date">
              ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
            </div>
          </div>
        </div>
      </section>
    `:null}isPersonalInterest(e){return e.categories&&e.categories.includes("personal")}isProfessionalInterest(e){return e.categories&&e.categories.includes("professional")}isBirthdayAnniversary(e){return"birthday"===e.type}getDisplayDate(e){return e.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(e){const t=new Date(e.startMonthYear).getFullYear();if(0===t)return null;return`${t}  ${e.endMonthYear?new Date(e.endMonthYear).getFullYear():this.strings.currentYearSubtitle}`}initPostRenderOperations(){setTimeout((()=>{try{this.shadowRoot.querySelectorAll("section").forEach((e=>{this.handleTokenOverflow(e)}))}catch(e){}}),0)}handleTokenOverflow(e){const t=e.querySelectorAll(".token-list");if(t&&t.length)for(const e of Array.from(t)){const t=e.querySelectorAll(".token-list__item");if(!t||!t.length)continue;let r=null,o=t[0].getBoundingClientRect();const i=e.getBoundingClientRect(),n=2*o.height+i.top;for(let e=0;e<t.length-1;e++)if(o=t[e].getBoundingClientRect(),o.top>n){r=Array.from(t).slice(e,t.length);break}if(r){r.forEach((e=>e.classList.add("overflow")));const t=document.createElement("div");t.classList.add("token-list__item"),t.classList.add("token-list__item--show-overflow"),t.innerText=`+ ${r.length} more`,t.addEventListener("click",(e=>{t.remove(),r.forEach((e=>e.classList.remove("overflow")))})),e.appendChild(t)}}}};Da=__decorate$c([customElement("mgt-person-card-profile"),__metadata$c("design:paramtypes",[Object])],Da);const La={sendEmailLinkSubtitle:"Send email",startChatLinkSubtitle:"Start chat",startVideoLinkSubtitle:"Video call",showMoreSectionButton:"Show more",quickMessagePlaceholder:"Type your message here"};var Ma,__decorate$b=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$b=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$h=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};registerFluentComponents(Qs,Ks,Ws,qs,Ys);let $a=Ma=class MgtPersonCard extends MgtTemplatedComponent{constructor(){super(),this._chatInput="",this._currentSection=null,this._history=[],this.sections=[]}static get styles(){return ya}get strings(){return La}static get requiredScopes(){return Ma.getScopes()}static getScopes(){const e=[];return this.config.sections.files&&e.push("Sites.Read.All"),this.config.sections.mailMessages&&e.push("Mail.ReadBasic"),this.config.sections.organization&&(e.push("User.Read.All"),"boolean"!=typeof this.config.sections.organization&&this.config.sections.organization.showWorksWith&&e.push("People.Read.All")),this.config.sections.profile&&e.push("User.Read.All"),this.config.useContactApis&&e.push("Contacts.Read"),e.indexOf("User.Read.All")<0&&(e.push("User.ReadBasic.All"),e.push("User.Read")),e.indexOf("People.Read.All")<0&&e.push("People.Read"),[...new Set(e)]}static get config(){return this._config}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.personImage=this.getImage(),this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this.state=null,this.requestStateUpdate())}get internalPersonDetails(){return this.state&&this.state.person||this.personDetails}attributeChangedCallback(e,t,r){if(super.attributeChangedCallback(e,t,r),t!==r&&"person-query"===e)this.personDetails=null,this.state=null,this.requestStateUpdate()}navigate(e){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this.state}),this._personDetails=e,this.state=null,this.personImage=null,this._currentSection=null,this.sections=[],this.requestStateUpdate()}goBack(){if(!this._history||!this._history.length)return;const e=this._history.pop();this._currentSection=null;const t=this.renderRoot.querySelector("fluent-tab");t&&t.click(),this.state=e.state,this._personDetails=e.state,this.personImage=e.personImage,this.loadSections()}clearHistory(){if(this._currentSection=null,!this._history||!this._history.length)return;const e=this._history[0];this._history=[],this.state=e.state,this._personDetails=e.state,this.personImage=e.personImage,this.loadSections()}render(){if(!this.internalPersonDetails)return this.renderNoData();this.internalPersonDetails;const e=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:e});const t=this._history&&this._history.length?html$1`
             <div class="nav">
               <div class="nav__back" @click=${()=>this.goBack()}>${getSvg($r.Back)}</div>
             </div>
           `:null;let r=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:e});if(!r){const e=this.renderPerson();r=html$1`
         ${e}
       `}const o=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();return html$1`
       <div class="root" dir=${this.direction}>
         ${t}
         <div class="close-card-container">
           <fluent-button appearance="lightweight" class="close-button" @click=${()=>this.closeCard()} >
               ${getSvg($r.Close)}
           </fluent-button>
         </div>
         <div class="person-details-container">${r}</div>
         <div class="expanded-details-container">${o}</div>
       </div>
     `}closeCard(){this.updateCurrentSection(null);const e=this.parentElement.parentElement;e&&e.close(),this.isExpanded=!1}renderNoData(){return this.renderTemplate("no-data",null)||html$1``}renderPerson(){const e=this.internalPersonDetails,t=this.renderContactIcons(e);return html$1`
        <mgt-person
          class="person-image"
          .personDetails=${this.internalPersonDetails}
          .personImage=${this.getImage()}
          .personPresence=${this.personPresence}
          .showPresence=${this.showPresence}
          .avatarSize=${"large"}
          .view=${Mr.fourlines}
        >
        <template data-type="line4">
            <div>
              ${t}
            </div>
          </template>
        </mgt-person>
      `}renderPersonSubtitle(e){if((e=e||this.internalPersonDetails).department)return html$1`
       <div class="department">${e.department}</div>
     `}renderContactIcons(e){const t=e=e||this.internalPersonDetails||this.personDetails;let r,o,i,n;return getEmailFromGraphEntity(e)&&(r=html$1`
         <div class="icon" @click=${()=>this.emailUser()} tabindex=0>
          ${getSvg($r.SmallEmail)}
        </div>
       `),t.userPrincipalName&&(o=html$1`
         <div class="icon" @click=${()=>this.chatUser()} tabindex=0>
          ${getSvg($r.SmallChat)}
        </div>
       `),i=html$1`
       <div class="icon" @click=${()=>this.videoCallUser()} tabindex=0>
          ${getSvg($r.Video)}
        </div>
     `,n=html$1`
      <div class="icon" @click=${()=>this.callUser()} tabindex=0>
       ${getSvg($r.Phone)}
      </div>
    `,html$1`
       <div class="base-icons">
         ${r} ${o} ${i} ${n}
       </div>
     `}renderExpandedDetailsButton(){return html$1`
       <div class="expanded-details-button" @click=${()=>this.showExpandedDetails()} @keydown=${e=>this.handleKeyDown(e)} tabindex=0>
         ${getSvg($r.ExpandDown)}
       </div>
     `}renderExpandedDetails(e){if(!this.state&&this.isStateLoading)return html$1`
         <div class="loading">
           <mgt-spinner></mgt-spinner>
         </div>
       `;Providers.globalProvider.state===or.SignedOut&&this.loadSections(),e=e||this.internalPersonDetails;const t=this.renderSectionNavigation();return html$1`
       <div class="section-nav">
         ${t}
       </div>
       <div class="section-host" @wheel=${e=>this.handleSectionScroll(e)}>
       </div>
     `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;const e=this._currentSection?this.sections.indexOf(this._currentSection):-1,t=this.sections.map(((t,r)=>{let o=t.tagName.toLowerCase();const i=Sr({active:r===e,"section-nav__icon":!0}),n=t.tagName;return n.substring(16,n.length).toLowerCase(),html$1`
         <fluent-tab id="${o}-Tab" class=${i}
           slot="tab" @keyup="${()=>this.updateCurrentSection(t)}" @click=${()=>this.updateCurrentSection(t)}>${t.renderIcon()}
         </fluent-tab>
       `})),r=this.sections.map(((e,t)=>html$1`
         <fluent-tab-panel  slot="tabpanel">
               <div class="inserted">${this._currentSection?e.asFullView():null}</div>
         </fluent-tab-panel>
       `)),o=Sr({active:-1===e,"section-nav__icon":!0,overviewTab:!0});return html$1`
         <fluent-tabs  orientation="horizontal" activeindicator  @wheel=${e=>this.handleSectionScroll(e)}> 
           <fluent-tab class="${o}"  slot="tab" @keyup="${()=>this.updateCurrentSection(null)}" @click=${()=>this.updateCurrentSection(null)}>
             <div>${getSvg($r.Overview)}</div>
           </fluent-tab>
           ${t}
           <fluent-tab-panel slot="tabpanel" >
             <div class="overview-panel">${this._currentSection?null:this.renderOverviewSection()}</div>
           </fluent-tab-panel>
           ${r}
       </fluent-tabs>
     `}renderOverviewSection(){const e=this.sections.map((e=>html$1`
         <div class="section">
           <div class="section__header">
             <div class="section__title">${e.displayName}</div>
               <fluent-button appearance="lightweight" class="section__show-more" @click=${()=>this.updateCurrentSection(e)}>
                 ${this.strings.showMoreSectionButton}
               </fluent-button>
           </div>
           <div class="section__content">${e.asCompactView()}</div>
         </div>
       `)),t=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this.state});return t&&e.splice(1,0,html$1`
           <div class="section">
             <div class="additional-details">${t}</div>
           </div>
         `),html$1`
       <div class="sections">
         ${e}
       </div>
     `}renderCurrentSection(){if(this.sections&&this.sections.length||this.hasTemplate("additional-details"))return 1!==this.sections.length||this.hasTemplate("additional-details")?this._currentSection?html$1`
       ${this._currentSection.asFullView()}
     `:this.renderOverviewSection():html$1`
         ${this.sections[0].asFullView()}
       `}loadState(){var e;return __awaiter$h(this,void 0,void 0,(function*(){if(this.state)return;if(!this.personDetails&&this.inheritDetails){let e=this.parentElement;for(;e&&"MGT-PERSON"!==e.tagName;)e=e.parentElement;e&&e.personDetails&&(this.personDetails=e.personDetails,this.personImage=e.personImage)}const t=Providers.globalProvider;if(!t||t.state!==or.SignedIn)return;const r=t.graph.forComponent(this);if(this.isStateLoading=!0,this._me||(this._me=yield Providers.me()),this.personDetails){const e=this.personDetails,t=e.userPrincipalName||e.id;if(t&&!getEmailFromGraphEntity(e)){const e=yield getUserWithPhoto(r,t);this.personDetails=e,this.personImage=this.getImage()}}else if(this.userId||"me"===this.personQuery){const e=yield getUserWithPhoto(r,this.userId);this.personDetails=e,this.personImage=this.getImage()}else if(this.personQuery){const e=yield findPeople(r,this.personQuery,1);e&&e.length&&(this.personDetails=e[0],getPersonImage(r,this.personDetails,Ma.config.useContactApis).then((e=>{e&&(this.personDetails.personImage=e,this.personImage=e)})))}const o={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{this.personDetails&&this.personDetails.id?getUserPresence(r,this.personDetails.id).then((e=>{this.personPresence=e})):this.personPresence=o}catch(e){this.personPresence=o}(null===(e=this.personDetails)||void 0===e?void 0:e.id)&&(this.state=yield getPersonCardGraphData(r,this.personDetails,this._me===this.personDetails.id,Ma.config)),this.loadSections(),this.isStateLoading=!1}))}sendQuickMessage(){const e=this._chatInput.trim();e&&e.length&&this.chatUser(e)}emailUser(){const e=this.internalPersonDetails;if(e){const t=getEmailFromGraphEntity(e);t&&window.open("mailto:"+t,"_blank","noreferrer")}}callUser(){const e=this.personDetails,t=this.personDetails;if(e&&e.businessPhones&&e.businessPhones.length){const t=e.businessPhones[0];t&&window.open("tel:"+t,"_blank","noreferrer")}else if(t&&t.phones&&t.phones.length){const e=this.getPersonBusinessPhones(t)[0];e&&window.open("tel:"+e,"_blank","noreferrer")}}chatUser(e=null){const t=this.personDetails;if(t&&t.userPrincipalName){let r=`https://teams.microsoft.com/l/chat/0/0?users=${t.userPrincipalName}`;e&&e.length&&(r+=`&message=${e}`);const openWindow=()=>window.open(r,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(r,(e=>{e||openWindow()})):openWindow()}}videoCallUser(){const e=this.personDetails;if(e&&e.userPrincipalName){let t=`https://teams.microsoft.com/l/call/0/0?users=${e.userPrincipalName}&withVideo=true`;const openWindow=()=>window.open(t,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(t,(e=>{e||openWindow()})):openWindow()}}showExpandedDetails(){const e=this.renderRoot.querySelector(".root");e&&e.animate&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;const e=new ka(this.internalPersonDetails);if(e.hasData&&this.sections.push(e),!this.state)return;const{person:t,directReports:r,messages:o,files:i,profile:n}=this.state;if(Ma.config.sections.organization&&(t&&t.manager||r&&r.length)&&this.sections.push(new Ra(this.state,this._me)),Ma.config.sections.mailMessages&&o&&o.length&&this.sections.push(new xa(o)),Ma.config.sections.files&&i&&i.length&&this.sections.push(new Sa(i)),Ma.config.sections.profile&&n){const e=new Da(n);e.hasData&&this.sections.push(e)}}getImage(){if(this.personImage)return this.personImage;const e=this.personDetails;return e&&e.personImage?e.personImage:null}getPersonBusinessPhones(e){const t=e.phones,r=[];for(const e of t)"business"===e.type&&r.push(e.number);return r}updateCurrentSection(e){if(e){const t=e.tagName.toLowerCase();this.renderRoot.querySelector(`#${t}-Tab`).click()}const t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(let e=0;e<t.length;e++){t[e].scrollTop=0}this._currentSection=e,this.requestUpdate()}handleSectionScroll(e){let t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(let r=0;r<t.length;r++){let o=t[r];o&&(e.deltaY<0&&0===o.scrollTop||e.deltaY>0&&o.clientHeight+o.scrollTop>=o.scrollHeight-1||e.stopPropagation())}}handleKeyDown(e){e&&"Enter"===e.code&&this.showExpandedDetails()}};$a._config={sections:{files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0},useContactApis:!0,isSendMessageVisible:!0},__decorate$b([property({attribute:"person-details",type:Object}),__metadata$b("design:type",Object),__metadata$b("design:paramtypes",[Object])],$a.prototype,"personDetails",null),__decorate$b([property({attribute:"person-query"}),__metadata$b("design:type",String)],$a.prototype,"personQuery",void 0),__decorate$b([property({attribute:"user-id"}),__metadata$b("design:type",String),__metadata$b("design:paramtypes",[String])],$a.prototype,"userId",null),__decorate$b([property({attribute:"person-image",type:String}),__metadata$b("design:type",String)],$a.prototype,"personImage",void 0),__decorate$b([property({attribute:"fetch-image",type:Boolean}),__metadata$b("design:type",Boolean)],$a.prototype,"fetchImage",void 0),__decorate$b([property({attribute:"is-expanded",type:Boolean}),__metadata$b("design:type",Boolean)],$a.prototype,"isExpanded",void 0),__decorate$b([property({attribute:"inherit-details",type:Boolean}),__metadata$b("design:type",Boolean)],$a.prototype,"inheritDetails",void 0),__decorate$b([property({attribute:"show-presence",type:Boolean}),__metadata$b("design:type",Boolean)],$a.prototype,"showPresence",void 0),__decorate$b([property({attribute:"person-presence",type:Object}),__metadata$b("design:type",Object)],$a.prototype,"personPresence",void 0),__decorate$b([internalProperty(),__metadata$b("design:type",Object)],$a.prototype,"state",void 0),__decorate$b([internalProperty(),__metadata$b("design:type",Boolean)],$a.prototype,"isStateLoading",void 0),$a=Ma=__decorate$b([customElement("mgt-person-card"),__metadata$b("design:paramtypes",[])],$a);const Ua=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#717171));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,#717171)}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{margin-right:28px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, "Segoe UI");font-size:14px;line-height:20px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130))}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __awaiter$g=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};function assignPeopleToPlannerTask(e,t,r,o){return setPlannerTaskDetails(e,t,{assignments:r},o)}function setPlannerTaskDetails(e,t,r,o){return __awaiter$g(this,void 0,void 0,(function*(){return yield e.api(`/planner/tasks/${t}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.ReadWrite.All")).header("If-Match",o).patch(JSON.stringify(r))}))}var __awaiter$f=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};function setTodoTaskDetails(e,t,r,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield e.api(`/me/outlook/tasks/${t}`).header("Cache-Control","no-store").header("If-Match",o).middlewareOptions(prepScopes("Tasks.ReadWrite")).patch(r)}))}var __awaiter$e=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class TaskSourceBase{constructor(e){this.graph=BetaGraph.fromGraph(e)}}class PlannerTaskSource extends TaskSourceBase{getTaskGroups(){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getAllMyPlannerPlans(e){return __awaiter$g(this,void 0,void 0,(function*(){const t=yield e.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return t&&t.value}))}(this.graph)).map((e=>({id:e.id,title:e.title})))}))}getTaskGroupsForGroup(e){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getPlansForGroup(e,t){return __awaiter$g(this,void 0,void 0,(function*(){const r=`/groups/${t}/planner/plans`,o=yield e.api(r).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return o?o.value:null}))}(this.graph,e)).map((e=>({id:e.id,title:e.title})))}))}getTaskGroup(e){return __awaiter$e(this,void 0,void 0,(function*(){const t=yield function getSinglePlannerPlan(e,t){return __awaiter$g(this,void 0,void 0,(function*(){return yield e.api(`/planner/plans/${t}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get()}))}(this.graph,e);return{id:t.id,title:t.title,_raw:t}}))}getTaskFoldersForTaskGroup(e){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getBucketsForPlannerPlan(e,t){return __awaiter$g(this,void 0,void 0,(function*(){const r=yield e.api(`/planner/plans/${t}/buckets`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return r&&r.value}))}(this.graph,e)).map((e=>({_raw:e,id:e.id,name:e.name,parentId:e.planId})))}))}getTasksForTaskFolder(e){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getTasksForPlannerBucket(e,t){return __awaiter$g(this,void 0,void 0,(function*(){const r=yield e.api(`/planner/buckets/${t}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return r&&r.value}))}(this.graph,e)).map((e=>({_raw:e,assignments:e.assignments,completed:100===e.percentComplete,dueDate:e.dueDateTime&&new Date(e.dueDateTime),eTag:e["@odata.etag"],id:e.id,immediateParentId:e.bucketId,name:e.title,topParentId:e.planId})))}))}setTaskComplete(e,t){return __awaiter$e(this,void 0,void 0,(function*(){return yield function setPlannerTaskComplete(e,t,r){return setPlannerTaskDetails(e,t,{percentComplete:100},r)}(this.graph,e,t)}))}setTaskIncomplete(e,t){return __awaiter$e(this,void 0,void 0,(function*(){return yield function setPlannerTaskIncomplete(e,t,r){return setPlannerTaskDetails(e,t,{percentComplete:0},r)}(this.graph,e,t)}))}addTask(e){return __awaiter$e(this,void 0,void 0,(function*(){return yield function addPlannerTask(e,t){return e.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.ReadWrite.All")).post(t)}(this.graph,{assignments:e.assignments,bucketId:e.immediateParentId,dueDateTime:e.dueDate&&e.dueDate.toISOString(),planId:e.topParentId,title:e.name})}))}assignPeopleToTask(e,t,r){return __awaiter$e(this,void 0,void 0,(function*(){return yield assignPeopleToPlannerTask(this.graph,e,t,r)}))}removeTask(e,t){return __awaiter$e(this,void 0,void 0,(function*(){return yield function removePlannerTask(e,t,r){return e.api(`/planner/tasks/${t}`).header("Cache-Control","no-store").header("If-Match",r).middlewareOptions(prepScopes("Group.ReadWrite.All")).delete()}(this.graph,e,t)}))}isAssignedToMe(e,t){return Object.keys(e.assignments).includes(t)}}class TodoTaskSource extends TaskSourceBase{getTaskGroups(){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getAllMyTodoGroups(e){return __awaiter$f(this,void 0,void 0,(function*(){const t=yield e.api("/me/outlook/taskGroups").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return t&&t.value}))}(this.graph)).map((e=>({_raw:e,id:e.id,secondaryId:e.groupKey,title:e.name})))}))}getTaskGroup(e){return __awaiter$e(this,void 0,void 0,(function*(){const t=yield function getSingleTodoGroup(e,t){return __awaiter$f(this,void 0,void 0,(function*(){return yield e.api(`/me/outlook/taskGroups/${t}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get()}))}(this.graph,e);return{id:t.id,secondaryId:t.groupKey,title:t.name,_raw:t}}))}getTaskFoldersForTaskGroup(e){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getFoldersForTodoGroup(e,t){return __awaiter$f(this,void 0,void 0,(function*(){const r=yield e.api(`/me/outlook/taskGroups/${t}/taskFolders`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return r&&r.value}))}(this.graph,e)).map((t=>({_raw:t,id:t.id,name:t.name,parentId:e})))}))}getTasksForTaskFolder(e,t){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getAllTodoTasksForFolder(e,t){return __awaiter$f(this,void 0,void 0,(function*(){const r=yield e.api(`/me/outlook/taskFolders/${t}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return r&&r.value}))}(this.graph,e)).map((r=>({_raw:r,assignments:{},completed:!!r.completedDateTime,dueDate:r.dueDateTime&&new Date(r.dueDateTime.dateTime+"Z"),eTag:r["@odata.etag"],id:r.id,immediateParentId:e,name:r.subject,topParentId:t})))}))}setTaskComplete(e,t){return __awaiter$e(this,void 0,void 0,(function*(){return yield function setTodoTaskComplete(e,t,r){return __awaiter$f(this,void 0,void 0,(function*(){return yield setTodoTaskDetails(e,t,{isReminderOn:!1,status:"completed"},r)}))}(this.graph,e,t)}))}assignPeopleToTask(e,t,r){return __awaiter$e(this,void 0,void 0,(function*(){return yield assignPeopleToPlannerTask(this.graph,e,t,r)}))}setTaskIncomplete(e,t){return __awaiter$e(this,void 0,void 0,(function*(){return yield function setTodoTaskIncomplete(e,t,r){return __awaiter$f(this,void 0,void 0,(function*(){return yield setTodoTaskDetails(e,t,{isReminderOn:!0,status:"notStarted"},r)}))}(this.graph,e,t)}))}addTask(e){return __awaiter$e(this,void 0,void 0,(function*(){const t={parentFolderId:e.immediateParentId,subject:e.name};return e.dueDate&&(t.dueDateTime={dateTime:e.dueDate.toISOString(),timeZone:"UTC"}),yield function addTodoTask(e,t){return __awaiter$f(this,void 0,void 0,(function*(){const{parentFolderId:r=null}=t;return r?yield e.api(`/me/outlook/taskFolders/${r}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(t):yield e.api("/me/outlook/tasks").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(t)}))}(this.graph,t)}))}removeTask(e,t){return __awaiter$e(this,void 0,void 0,(function*(){return yield function removeTodoTask(e,t,r){return __awaiter$f(this,void 0,void 0,(function*(){return yield e.api(`/me/outlook/tasks/${t}`).header("Cache-Control","no-store").header("If-Match",r).middlewareOptions(prepScopes("Tasks.ReadWrite")).delete()}))}(this.graph,e,t)}))}isAssignedToMe(e,t){return!0}getTaskGroupsForGroup(e){return __awaiter$e(this,void 0,void 0,(function*(){}))}}const Fa=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host,mgt-arrow-options{position:relative;font-family:var(--default-font-family)}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:var(--arrow-options-left,0);box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background-color:var(--background-color--hover,#edebe9)}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background-color:var(--background-color--active,#e1dfdd)}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#023b8f}
`];var __decorate$a=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ha=class MgtArrowOptions extends MgtBaseComponent{constructor(){super(),this.value="",this.options={},this._clickHandler=e=>this.open=!1}static get styles(){return Fa}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}onHeaderClick(e){Object.keys(this.options).length>1&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}render(){return html$1`
      <span class="Header" @click=${e=>this.onHeaderClick(e)}>
        <span class="CurrentValue">${this.value}</span>
      </span>
      <div class=${Sr({Menu:!0,Open:this.open,Closed:!this.open})}>
        ${this.getMenuOptions()}
      </div>
    `}getMenuOptions(){const e=Object.keys(this.options),t=this.options;return e.map((e=>html$1`
        <div
          class="MenuOption"
          @click="${r=>{this.open=!1,t[e](r)}}"
        >
          <span class=${Sr({MenuOptionCheck:!0,CurrentValue:this.value===e})}>
            \uE73E
          </span>
          <span class="MenuOptionName">${e}</span>
        </div>
      `))}};__decorate$a([property({type:Boolean}),__metadata$a("design:type",Boolean)],Ha.prototype,"open",void 0),__decorate$a([property({type:String}),__metadata$a("design:type",String)],Ha.prototype,"value",void 0),__decorate$a([property({type:Object}),__metadata$a("design:type",Object)],Ha.prototype,"options",void 0),Ha=__decorate$a([customElement("mgt-arrow-options"),__metadata$a("design:paramtypes",[])],Ha);const Ba=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}:host,mgt-dot-options{font-family:var(--default-font-family)}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap;transform:var(--dot-options-translateX,translateX(-50px))}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:var(--background-color--hover,#edebe9)}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:var(--background-color--active,#e1dfdd)}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}
`];var __decorate$9=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$9=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let qa=class MgtDotOptions extends MgtBaseComponent{constructor(){super(),this._clickHandler=null,this._clickHandler=e=>this.open=!1}static get styles(){return Ba}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){return html$1`
      <div class=${Sr({DotMenu:!0,Open:this.open})} @click=${e=>this.onDotClick(e)}>
        <span class="DotIcon">\uE712</span>
        <div class="Menu">
          ${Object.keys(this.options).map((e=>this.getMenuOption(e,this.options[e])))}
        </div>
      </div>
    `}getMenuOption(e,t){return html$1`
      <div
        class="DotItem"
        @click="${e=>{e.preventDefault(),e.stopPropagation(),t(e),this.open=!1}}"
      >
        <span class="DotItemName">
          ${e}
        </span>
      </div>
    `}onDotClick(e){e.preventDefault(),e.stopPropagation(),this.open=!this.open}};__decorate$9([property({type:Boolean}),__metadata$9("design:type",Boolean)],qa.prototype,"open",void 0),__decorate$9([property({type:Object}),__metadata$9("design:type",Object)],qa.prototype,"options",void 0),qa=__decorate$9([customElement("mgt-dot-options"),__metadata$9("design:paramtypes",[])],qa);const za={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add"};var ja,__decorate$8=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$8=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$d=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};!function(e){e[e.planner=0]="planner",e[e.todo=1]="todo"}(ja||(ja={}));const Va={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},Ga={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},Ka={"@odata.type":"microsoft.graph.plannerAssignment",orderHint:"string !"};let Wa=class MgtTasks extends MgtTemplatedComponent{constructor(){super(),this.dataSource=ja.planner,this._me=null,this.clearState(),this.previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}get res(){switch(this.dataSource){case ja.todo:return Va;case ja.planner:default:return Ga}}static get styles(){return Ua}get strings(){return za}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(e){this._isNewTaskVisible=e,e||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...Zr.requiredScopes,...ha.requiredScopes])]}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),"data-source"===e&&(this.dataSource===ja.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===ja.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this.clearState(),this.requestStateUpdate())}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1}firstUpdated(e){super.firstUpdated(e),this.initialId&&!this._currentGroup&&(this.dataSource===ja.planner?this._currentGroup=this.initialId:this.dataSource===ja.todo&&(this._currentFolder=this.initialId)),this.dataSource===ja.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}render(){let e=this._tasks.filter((e=>this.isTaskInSelectedGroupFilter(e))).filter((e=>this.isTaskInSelectedFolderFilter(e))).filter((e=>!this._hiddenTasks.includes(e.id)));this.taskFilter&&(e=e.filter((e=>this.taskFilter(e._raw))));const t=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;let r;return this.hideHeader||(r=html$1`
        <div class="Header" dir=${this.direction}>
          ${this.renderPlanOptions()}
        </div>
      `),html$1`
      ${r}
      <div class="Tasks" dir=${this.direction}>
        ${this._isNewTaskVisible?this.renderNewTask():null} ${t}
        ${Yr(e,(e=>e.id),(e=>this.renderTask(e)))}
      </div>
    `}loadState(){return __awaiter$d(this,void 0,void 0,(function*(){const e=this.getTaskSource();if(!e)return;const t=Providers.globalProvider;if(!t||t.state!==or.SignedIn)return;let r;if(this._inTaskLoad=!0,!this._me){r=getMe(t.graph.forComponent(this))}this.groupId&&this.dataSource===ja.planner?yield this._loadTasksForGroup(e):this.targetId?this.dataSource===ja.todo?yield this._loadTargetTodoTasks(e):yield this._loadTargetPlannerTasks(e):yield this._loadAllTasks(e),r&&(this._me=yield r),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0}))}onResize(){this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())}_loadTargetTodoTasks(e){return __awaiter$d(this,void 0,void 0,(function*(){const t=yield e.getTaskGroups(),r=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]),o=(yield Promise.all(r.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=o,this._folders=r,this._groups=t,this._currentGroup=null}))}_loadTargetPlannerTasks(e){return __awaiter$d(this,void 0,void 0,(function*(){const t=yield e.getTaskGroup(this.targetId);let r=yield e.getTaskFoldersForTaskGroup(t.id);this.targetBucketId&&(r=r.filter((e=>e.id===this.targetBucketId)));const o=(yield Promise.all(r.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=o,this._folders=r,this._groups=[t]}))}_loadAllTasks(e){return __awaiter$d(this,void 0,void 0,(function*(){const t=yield e.getTaskGroups(),r=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]);if(!this.initialId&&this.dataSource===ja.todo&&!this._todoDefaultSet){this._todoDefaultSet=!0;const e=r.find((e=>e._raw.isDefaultFolder));e&&(this._currentFolder=e.id)}const o=(yield Promise.all(r.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=o,this._folders=r,this._groups=t}))}_loadTasksForGroup(e){return __awaiter$d(this,void 0,void 0,(function*(){const t=yield e.getTaskGroupsForGroup(this.groupId),r=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]),o=(yield Promise.all(r.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=o,this._folders=r,this._groups=t}))}addTask(e,t,r,o,i={}){return __awaiter$d(this,void 0,void 0,(function*(){const n=this.getTaskSource();if(!n)return;const s={assignments:i,dueDate:t,immediateParentId:o,name:e,topParentId:r};this._newTaskBeingAdded=!0;const a=yield n.addTask(s);this.fireCustomEvent("taskAdded",a),yield this.requestStateUpdate(),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1}))}completeTask(e){return __awaiter$d(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskComplete(e.id,e.eTag),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}uncompleteTask(e){return __awaiter$d(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskIncomplete(e.id,e.eTag),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}removeTask(e){return __awaiter$d(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._hiddenTasks=[...this._hiddenTasks,e.id],yield t.removeTask(e.id,e.eTag),this.fireCustomEvent("taskRemoved",e),yield this.requestStateUpdate(),this._hiddenTasks=this._hiddenTasks.filter((t=>t!==e.id)))}))}assignPeople(e,t){return __awaiter$d(this,void 0,void 0,(function*(){const r=this.getTaskSource();if(!r)return;let o=[];e&&e.assignments&&(o=Object.keys(e.assignments).sort());const i=t.map((e=>e.id));if(i.length===o.length&&i.sort().every(((e,t)=>e===o[t])))return;const n={};if(0===t.length)for(let e=0;e<o.length;e++)n[o[e]]=null;if(t){for(let e=0;e<o.length;e++)for(let r=0;r<t.length;r++){if(o[e]!==t[r].id){n[o[e]]=null;break}n[o[e]]=Ka}for(let e=0;e<t.length;e++)n[t[e].id]=Ka}e&&(this._loadingTasks=[...this._loadingTasks,e.id],yield r.assignPeopleToTask(e.id,n,e.eTag),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}onAddTaskClick(e){const t=this.getPeoplePicker(null),r={};if(t)for(const e of t.selectedPeople)t.selectedPeople.length&&(r[e.id]=Ka);!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,r)}renderPlanOptions(){const e=Providers.globalProvider;if(!e||e.state!==or.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return html$1`
        <span class="LoadingHeader"></span>
      `;const t=this.readOnly||this._isNewTaskVisible?null:html$1`
            <div
              class="AddBarItem NewTaskButton"
              @click="${()=>{this.isNewTaskVisible=!this.isNewTaskVisible}}"
            >
              <span class="TaskIcon"></span>
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
          `;if(this.dataSource===ja.planner){const e=this._groups.find((e=>e.id===this._currentGroup))||{title:this.res.BASE_SELF_ASSIGNED},r={[this.res.BASE_SELF_ASSIGNED]:e=>{this._currentGroup=null,this._currentFolder=null}};for(const e of this._groups)r[e.title]=t=>{this._currentGroup=e.id,this._currentFolder=null};const o=html$1`
        <mgt-arrow-options .options="${r}" .value="${e.title}"></mgt-arrow-options>
      `,i=this._currentGroup?html$1`
            <span class="TaskIcon Divider">/</span>
          `:null,n=this._folders.find((e=>e.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},s={[this.res.BUCKETS_SELF_ASSIGNED]:e=>{this._currentFolder=null}};for(const e of this._folders.filter((e=>e.parentId===this._currentGroup)))s[e.name]=t=>{this._currentFolder=e.id};const a=this.targetBucketId?html$1`
            <span class="PlanTitle">
              ${this._folders[0]&&this._folders[0].name}
            </span>
          `:html$1`
            <mgt-arrow-options .options="${s}" .value="${n.name}"></mgt-arrow-options>
          `;return html$1`
        <div class="TitleCont">
          ${o} ${i} ${this._currentGroup?a:null}
        </div>
        ${t}
      `}{const e=this._folders.find((e=>e.id===this.targetId))||{name:this.res.BUCKETS_SELF_ASSIGNED},r=this._folders.find((e=>e.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},o={};for(const e of this._folders)o[e.name]=()=>{this._currentFolder=e.id};o[this.res.BUCKETS_SELF_ASSIGNED]=e=>{this._currentFolder=null};const i=this.targetId?html$1`
            <span class="PlanTitle">
              ${e.name}
            </span>
          `:html$1`
            <mgt-arrow-options .value="${r.name}" .options="${o}"></mgt-arrow-options>
          `;return html$1`
        <span class="TitleCont">
          ${i}
        </span>
        ${t}
      `}}renderNewTask(){const e=html$1`
      <input
        type="text"
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="input"
        @input="${e=>{this._newTaskName=e.target.value}}"
      />
    `,t=this._groups;t.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=t[0].id);const r=this.dataSource===ja.todo?null:this._currentGroup?html$1`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <span>${this.getPlanTitle(this._currentGroup)}</span>
            </span>
          `:html$1`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <select
                .value="${this._newTaskGroupId}"
                @change="${e=>{this._newTaskGroupId=e.target.value}}"
              >
                ${this._groups.map((e=>html$1`
                    <option value="${e.id}">${e.title}</option>
                  `))}
              </select>
            </span>
          `,o=this._folders.filter((e=>this._currentGroup&&e.parentId===this._currentGroup||!this._currentGroup&&e.parentId===this._newTaskGroupId));o.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=o[0].id);const i=this._currentFolder?html$1`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `:html$1`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskFolderId}"
              @change="${e=>{this._newTaskFolderId=e.target.value}}"
            >
              ${o.map((e=>html$1`
                  <option value="${e.id}">${e.name}</option>
                `))}
            </select>
          </span>
        `,n=html$1`
      <span class="NewTaskDue">
      ${this.renderCalendarIcon()}
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="input"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null}}"
        />
      </span>
    `,s=this.dataSource===ja.todo?null:this.renderAssignedPeople(null),a=this._newTaskBeingAdded?html$1`
          <div class="TaskAddButtonContainer"></div>
        `:html$1`
          <div class="TaskAddButtonContainer ${""===this._newTaskName?"Disabled":""}">
            <div class="TaskIcon TaskAdd" @click="${this.onAddTaskClick}">
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
            <div class="TaskIcon TaskCancel" @click="${()=>this.isNewTaskVisible=!1}">
              <span>${this.strings.cancelNewTaskSubtitle}</span>
            </div>
          </div>
        `;return html$1`
      <div class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${e}
            </div>
            <div class="TaskDetails">
              ${r} ${i} ${n} ${s}
            </div>
          </div>
        </div>
        ${a}
      </div>
    `}togglePeoplePicker(e){const t=this.getPeoplePicker(e),r=this.getMgtPeople(e),o=this.getFlyout(e);t&&r&&o&&(o.isOpen?o.close():(t.selectedPeople=r.people,o.open(),window.requestAnimationFrame((()=>{t.focus()}))))}updateAssignedPeople(e){const t=this.getPeoplePicker(e),r=this.getMgtPeople(e);t&&t.selectedPeople!==r.people&&(r.people=t.selectedPeople,this.assignPeople(e,t.selectedPeople))}getPeoplePicker(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(`.picker-${t}`)}getMgtPeople(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(`.people-${t}`)}getFlyout(e){const t=e?e.id:"newTask";return this.renderRoot.querySelector(`.flyout-${t}`)}renderTask(e){const{name:t="Task",completed:r=!1,dueDate:o}=e,i=this._loadingTasks.includes(e.id),n=i?html$1`
          
        `:r?html$1`
          
        `:null,s=html$1`
      <span class=${Sr({Complete:!i&&r,Loading:i,TaskCheck:!0,TaskIcon:!0})}><span class="TaskCheckContent">${n}</span></span>
    `,a=this._currentGroup?null:this.getPlanTitle(e.topParentId),l=this._currentFolder?null:this.getFolderName(e.immediateParentId),c={task:Object.assign(Object.assign({},e._raw),{groupTitle:a,folderTitle:l})},d=this.renderTemplate("task",c,e.id);if(d)return d;let u=this.renderTemplate("task-details",c,`task-details-${e.id}`);if(!u){const r=this.dataSource===ja.todo||this._currentGroup?null:html$1`
              <div class="TaskDetail TaskGroup">
                ${this.renderPlannerIcon()}
                <span>${this.getPlanTitle(e.topParentId)}</span>
              </div>
            `,i=this._currentFolder?null:html$1`
            <div class="TaskDetail TaskBucket">
              ${this.renderBucketIcon()}
              <span>${this.getFolderName(e.immediateParentId)}</span>
            </div>
          `,n=o?html$1`
            <div class="TaskDetail TaskDue">
              <span>Due ${getShortDateString(o)}</span>
            </div>
          `:null,s=this.dataSource!==ja.todo?this.renderAssignedPeople(e):null;u=html$1`
        <div class="TaskTitle">
          ${t}
        </div>
        ${r} ${i} ${s} ${n}
      `}const h=this.readOnly||this.hideOptions?null:html$1`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:()=>this.removeTask(e)}}"
              ></mgt-dot-options>
            </div>
          `;return html$1`
      <div
        class=${Sr({Complete:r,Incomplete:!r,ReadOnly:this.readOnly,Task:!0})}
      >
        <div
          class="TaskContent"
          @click=${()=>{this.handleTaskClick(e)}}
        >
          <span
            class=${Sr({Complete:r,Incomplete:!r,TaskCheckContainer:!0})}
            @click="${t=>{this.readOnly||(e.completed?this.uncompleteTask(e):this.completeTask(e),t.stopPropagation(),t.preventDefault())}}"
          >
            ${s}
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery} ${this._currentGroup?"NoPlan":""}">
            ${u}
          </div>
          ${h}

        </div>
      </div>
    `}renderAssignedPeople(e){let t=null;const r={NewTaskAssignee:null===e,TaskAssignee:null!==e,TaskDetail:null!==e},o=e?Object.keys(e.assignments).map((e=>e)):[],i=html$1`
      <template data-type="no-data">
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
      </template>
    `,n=e?e.id:"newTask";return r[`flyout-${n}`]=!0,t=html$1`
      <mgt-people
        class="people-${n}"
        .userIds="${o}"
        .personCardInteraction=${Hr.none}
        @click=${t=>{this.togglePeoplePicker(e),t.stopPropagation()}}
        >${i}
      </mgt-people>
    `,html$1`
      <mgt-flyout light-dismiss class=${Sr(r)} @closed=${t=>this.updateAssignedPeople(e)}>
        ${t}
        <div slot="flyout" class=${Sr({Picker:!0})}>
          <mgt-people-picker
            class="picker-${n}"
            @click=${e=>e.stopPropagation()}
          ></mgt-people-picker>
        </div>
      </mgt-flyout>
    `}handleTaskClick(e){e&&this.fireCustomEvent("taskClick",{task:e._raw})}renderLoadingTask(){return html$1`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderPlannerIcon(){return html$1`
      <svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.223 1.156C6.98 1.26 6.769 1.404 6.586 1.586C6.403 1.768 6.261 1.98 6.157 2.223C6.052 2.465 6 2.724 6 3H2V17H14V3H10C10 2.724 9.948 2.465 9.844 2.223C9.74 1.98 9.596 1.768 9.414 1.586C9.231 1.404 9.02 1.26 8.777 1.156C8.535 1.053 8.276 1 8 1C7.723 1 7.465 1.053 7.223 1.156ZM5 4H7V3C7 2.86 7.026 2.729 7.078 2.609C7.13 2.49 7.202 2.385 7.293 2.293C7.384 2.202 7.49 2.131 7.609 2.079C7.73 2.026 7.859 2 8 2C8.14 2 8.271 2.026 8.39 2.079C8.511 2.131 8.616 2.202 8.707 2.293C8.798 2.385 8.87 2.49 8.922 2.609C8.974 2.729 9 2.86 9 3V4H11V5H5V4ZM12 6V4H13V16H3V4H4V6H12Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 12.3517L5.49956 14.2037L4.14856 12.8517L4.85156 12.1487L5.49956 12.7967L6.64856 11.6487L7.35156 12.3517Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 8.35168L5.49956 10.2037L4.14856 8.85168L4.85156 8.14868L5.49956 8.79668L6.64856 7.64868L7.35156 8.35168Z"
          fill="#3C3C3C"
        />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H12.001V13H8V14Z" fill="#3C3C3C" />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10H12.001V9H8V10Z" fill="#3C3C3C" />
      </svg>
    `}renderBucketIcon(){return html$1`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}renderCalendarIcon(){return html$1`
          <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 11C5.55228 11 6 10.5523 6 10C6 9.44771 5.55228 9 5 9C4.44772 9 4 9.44771 4 10C4 10.5523 4.44772 11 5 11ZM6 13C6 13.5523 5.55228 14 5 14C4.44772 14 4 13.5523 4 13C4 12.4477 4.44772 12 5 12C5.55228 12 6 12.4477 6 13ZM8 11C8.55229 11 9 10.5523 9 10C9 9.44771 8.55229 9 8 9C7.44771 9 7 9.44771 7 10C7 10.5523 7.44771 11 8 11ZM9 13C9 13.5523 8.55229 14 8 14C7.44771 14 7 13.5523 7 13C7 12.4477 7.44771 12 8 12C8.55229 12 9 12.4477 9 13ZM11 11C11.5523 11 12 10.5523 12 10C12 9.44771 11.5523 9 11 9C10.4477 9 10 9.44771 10 10C10 10.5523 10.4477 11 11 11ZM15 5.5C15 4.11929 13.8807 3 12.5 3H3.5C2.11929 3 1 4.11929 1 5.5V14.5C1 15.8807 2.11929 17 3.5 17H12.5C13.8807 17 15 15.8807 15 14.5V5.5ZM2 7H14V14.5C14 15.3284 13.3284 16 12.5 16H3.5C2.67157 16 2 15.3284 2 14.5V7ZM3.5 4H12.5C13.3284 4 14 4.67157 14 5.5V6H2V5.5C2 4.67157 2.67157 4 3.5 4Z" fill="#717171"/>
          </svg>
        `}getTaskSource(){const e=Providers.globalProvider;if(!e||e.state!==or.SignedIn)return null;const t=e.graph.forComponent(this);return this.dataSource===ja.planner?new PlannerTaskSource(t):this.dataSource===ja.todo?new TodoTaskSource(t):null}getPlanTitle(e){return e?e===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find((t=>t.id===e))||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}getFolderName(e){return e?(this._folders.find((t=>t.id===e))||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}isTaskInSelectedGroupFilter(e){return e.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(e,this._me.id)}isTaskInSelectedFolderFilter(e){return e.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}};__decorate$8([property({attribute:"read-only",type:Boolean}),__metadata$8("design:type",Boolean)],Wa.prototype,"readOnly",void 0),__decorate$8([property({attribute:"data-source",converter:(e,t)=>(e=e.toLowerCase(),ja[e]||ja.planner)}),__metadata$8("design:type",Number)],Wa.prototype,"dataSource",void 0),__decorate$8([property({attribute:"target-id",type:String}),__metadata$8("design:type",String)],Wa.prototype,"targetId",void 0),__decorate$8([property({attribute:"target-bucket-id",type:String}),__metadata$8("design:type",String)],Wa.prototype,"targetBucketId",void 0),__decorate$8([property({attribute:"initial-id",type:String}),__metadata$8("design:type",String)],Wa.prototype,"initialId",void 0),__decorate$8([property({attribute:"initial-bucket-id",type:String}),__metadata$8("design:type",String)],Wa.prototype,"initialBucketId",void 0),__decorate$8([property({attribute:"hide-header",type:Boolean}),__metadata$8("design:type",Boolean)],Wa.prototype,"hideHeader",void 0),__decorate$8([property({attribute:"hide-options",type:Boolean}),__metadata$8("design:type",Boolean)],Wa.prototype,"hideOptions",void 0),__decorate$8([property({attribute:"group-id",type:String}),__metadata$8("design:type",String)],Wa.prototype,"groupId",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],Wa.prototype,"_isNewTaskVisible",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],Wa.prototype,"_newTaskBeingAdded",void 0),__decorate$8([property(),__metadata$8("design:type",String)],Wa.prototype,"_newTaskName",void 0),__decorate$8([property(),__metadata$8("design:type",Date)],Wa.prototype,"_newTaskDueDate",void 0),__decorate$8([property(),__metadata$8("design:type",String)],Wa.prototype,"_newTaskGroupId",void 0),__decorate$8([property(),__metadata$8("design:type",String)],Wa.prototype,"_newTaskFolderId",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],Wa.prototype,"_groups",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],Wa.prototype,"_folders",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],Wa.prototype,"_tasks",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],Wa.prototype,"_hiddenTasks",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],Wa.prototype,"_loadingTasks",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],Wa.prototype,"_inTaskLoad",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],Wa.prototype,"_hasDoneInitialLoad",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],Wa.prototype,"_todoDefaultSet",void 0),__decorate$8([property(),__metadata$8("design:type",String)],Wa.prototype,"_currentGroup",void 0),__decorate$8([property(),__metadata$8("design:type",String)],Wa.prototype,"_currentFolder",void 0),Wa=__decorate$8([customElement("mgt-tasks"),__metadata$8("design:paramtypes",[])],Wa);const Qa=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}:host{font-family:var(--default-font-family)}.root{position:relative}.root .input-wrapper{font-family:var(--default-font-family);display:flex;flex-wrap:wrap;align-items:center;padding:4px 10px;position:relative;background-color:var(--input-background-color,#fff);font-size:14px;color:var(--color-sub1,#323130);height:29px;line-height:19px;cursor:text;border-top:var(--input-border-top,var(--input-border,2px solid #605e5c));border-right:var(--input-border-right,var(--input-border,2px solid #605e5c));border-bottom:var(--input-border-bottom,var(--input-border,2px solid #605e5c));border-left:var(--input-border-left,var(--input-border,2px solid #605e5c))}.root .input-wrapper:hover{border-color:var(--input-border-color--hover,#323130)}.root .input-wrapper.focused{border-color:var(--input-border-color--focus,#023b8f)}.root .input-wrapper .selected-team{padding-right:10px;border:none;display:flex;position:relative;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;align-items:center;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.root .input-wrapper .selected-team .arrow{margin-left:8px;margin-right:8px}.root .input-wrapper .selected-team .selected-team-name{font-weight:700}.root .input-wrapper .selected-team .search-wrapper{margin-left:12px;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .search-wrapper{overflow:hidden;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .hide-icon{display:none}.root .input-wrapper .team-chosen-input{display:inline-block;border:none;line-height:normal;outline:0;font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:transparent;color:var(--color-sub1,#323130);padding-left:5px}.root .input-wrapper .team-chosen-input::placeholder{color:var(--placeholder-color,#605e5c)}.root .input-wrapper .team-chosen-input[contenteditable]:empty::after{content:attr(data-placeholder);color:var(--placeholder-color,#605e5c)}.root .input-wrapper .search-icon{margin-top:1px;align-self:flex-start;font-family:FabricMDL2Icons;color:var(--accent-color,#023b8f);line-height:normal}.root .input-wrapper .input-search{height:19px}.root .input-wrapper .input-search-start{white-space:nowrap;line-height:normal;margin-inline-start:0;margin-inline-end:0}.root .input-wrapper::after{content:'';position:absolute;width:100%;height:90%;top:2px;right:2px;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}.root .close-icon{display:inline-block;position:absolute;right:10px;top:12px;line-height:normal;font-family:FabricMDL2Icons;cursor:pointer;color:var(--placeholder-color,#605e5c);background-color:var(--input-background-color,#fff)}.root .close-icon:hover{color:var(--color-sub1,#323130)}.root .dropdown{padding-top:5px;padding-bottom:11px;position:absolute;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:8px;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));z-index:1;width:100%;text-align:left;list-style-type:none;font-family:var(--default-font-family);font-style:normal;font-weight:400;color:var(--color-sub1,#323130);display:none;max-height:346px;overflow-y:auto}.root .dropdown.visible{display:block}.root .dropdown .item .arrow svg{fill:var(--arrow-fill,#000)}.root .dropdown .item.list-team{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;display:flex;flex-direction:row;align-items:center;padding:5px 12px 6px 14px;margin:6px 4px 4px 4px;border-radius:4px;font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:16px;color:var(--color-sub1,#323130);flex-flow:nowrap;position:relative;overflow:hidden;white-space:nowrap;background-color:transparent}.root .dropdown .item.list-team:after{content:'';position:absolute;width:36px;height:100%;top:0;right:0;background-image:-webkit-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-moz-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-ms-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-o-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:linear-gradient(to left,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0))}.root .dropdown .item.list-team:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .item.list-team .arrow{margin-right:5px;margin-bottom:1px}.root .dropdown .item.selected{background-color:var(--dropdown-item-selected-background,#deecf9)}.root .dropdown .item.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .channel-display{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;cursor:pointer;padding-left:21px;padding-right:10px}.root .dropdown .channel-display .showing{padding-left:10px;padding-top:4px;padding-bottom:4px}.root .dropdown .channel-display .showing .channel-name-text{font-size:14px;font-weight:400;color:var(--color-sub1,#323130);margin:0;padding:0}.root .dropdown .channel-display .showing .channel-name-text.highlight-search-text{font-weight:700}.root .dropdown .channel-display:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .loading-text,.root .dropdown .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;color:var(--color-sub1,#323130);line-height:19px;text-align:center}.root .dropdown .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}.root .dropdown .message-parent .loading-text{margin-top:3px;margin-left:9px;color:#0078d4}[dir=rtl] .input-wrapper::after{content:'';position:absolute;width:99%;height:90%;top:2px;left:0;background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}[dir=rtl] .search-wrapper{margin-right:0!important}[dir=rtl] .search-icon{margin-left:8px!important}[dir=rtl] .channel-display{padding:0 34px 0 10px!important}[dir=rtl] .close-icon{right:auto;left:10px}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __awaiter$c=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};const Ya={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading..."};var Ja,__decorate$7=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$7=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$b=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};let Za=Ja=class MgtTeamsChannelPicker extends MgtTemplatedComponent{constructor(){super(),this._inputValue="",this._isFocused=!1,this._treeViewState=[],this._focusList=[],this._focusedIndex=-1,this.handleWindowClick=this.handleWindowClick.bind(this),this.addEventListener("keydown",(e=>this.onUserKeyDown(e))),this.addEventListener("focus",(e=>this.loadTeamsIfNotLoaded())),this.addEventListener("mouseover",(e=>this.loadTeamsIfNotLoaded()))}static get styles(){return Qa}get strings(){return Ya}static get config(){return this._config}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return this.config.useTeamsBasedScopes?["team.readbasic.all","channel.readbasic.all"]:["user.read.all","group.read.all"]}set items(e){this._items!==e&&(this._items=e,this._treeViewState=e?this.generateTreeViewState(e):[],this.resetFocusState())}get items(){return this._items}get _input(){return this.renderRoot.querySelector(".team-chosen-input")}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),super.disconnectedCallback()}selectChannelById(e){return __awaiter$b(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(t&&t.state===or.SignedIn){this.items||(yield this.requestStateUpdate());for(const t of this._treeViewState)for(const r of t.channels)if(r.item.id===e)return this.selectChannel(r),!0}return!1}))}render(){const e={focused:this._isFocused,"input-wrapper":!0};this._isFocused&&this._selectedItemState;const t={dropdown:!0,visible:this._isDropdownVisible},r={"hide-icon":!!this._selectedItemState,"search-wrapper":!0};return this.renderTemplate("default",{teams:this.items})||html$1`
        <div class="root" @blur=${this.lostFocus} dir=${this.direction}>
          <div class=${Sr(e)} @click=${this.gainedFocus}>
            ${this.renderSelected()}
            <div class=${Sr(r)}>${this.renderSearchIcon()} ${this.renderInput()}</div>
          </div>
          ${this.renderCloseButton()}
          <div class=${Sr(t)}>${this.renderDropdown()}</div>
        </div>
      `}renderSelected(){return this._selectedItemState?html$1`
      <li class="selected-team" title=${this._selectedItemState.item.displayName}>
        <div class="selected-team-name">${this._selectedItemState.parent.item.displayName}</div>
        <div class="arrow">${getSvg($r.TeamSeparator,"#B3B0AD")}</div>
        ${this._selectedItemState.item.displayName}
        <div class="search-wrapper">${this.renderSearchIcon()} ${this.renderInput()}</div>
      </li>
    `:html$1``}clearState(){this._items=[],this._inputValue="",this._treeViewState=[],this._focusList=[]}renderSearchIcon(){return html$1`
      <div class="search-icon">
        ${getSvg($r.Search,"#252424")}
      </div>
    `}renderInput(){const e={"input-search":!!this._selectedItemState,"input-search-start":!this._selectedItemState};return html$1`
      <div class="${Sr(e)}">
        <span
          id="teams-channel-picker-input"
          class="team-chosen-input"
          type="text"
          label="teams-channel-picker-input"
          aria-label="Select a channel"
          data-placeholder="${this._selectedItemState?"":this.strings.inputPlaceholderText} "
          role="input"
          @keyup=${e=>this.handleInputChanged(e)}
          contenteditable
        ></span>
      </div>
    `}renderCloseButton(){return html$1`
      <div class="close-icon" @click="${()=>this.selectChannel(null)}">
        
      </div>
    `}renderDropdown(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):html$1``}renderDropdownList(e,t=0){return e&&e.length?e.map(((e,r)=>{const o=!!e.channels&&e.isExpanded;return html$1`
          ${this.renderItem(e)}
          ${o?this.renderDropdownList(e.channels,t+1):html$1``}
        `})):null}renderItem(e){let t=null;e.channels&&(t=e.isExpanded?getSvg($r.ArrowDown,"#252424"):getSvg($r.ArrowRight,"#252424"));let r=!1;this.selectedItem&&this.selectedItem.channel===e.item&&(r=!0);const o={focused:this._focusList[this._focusedIndex]===e,item:!0,"list-team":!!e.channels,selected:r},i=this.renderRoot.querySelector(".dropdown");return i.children[this._focusedIndex]&&i.children[this._focusedIndex].scrollIntoView(!1),html$1`
      <div @click=${()=>this.handleItemClick(e)} class="${Sr(o)}">
        <div class="arrow">
          ${t}
        </div>
        ${e.channels?e.item.displayName:this.renderHighlightedText(e.item)}
      </div>
    `}renderHighlightedText(e){let t={};const r=e.displayName.toLowerCase().indexOf(this._inputValue.toLowerCase());return-1!==r?0===r?(t.first="",t.highlight=e.displayName.slice(0,this._inputValue.length),t.last=e.displayName.slice(this._inputValue.length,e.displayName.length)):r===e.displayName.length?(t.first=e.displayName.slice(0,r),t.highlight=e.displayName.slice(r,e.displayName.length),t.last=""):(t.first=e.displayName.slice(0,r),t.highlight=e.displayName.slice(r,r+this._inputValue.length),t.last=e.displayName.slice(r+this._inputValue.length,e.displayName.length)):t.last=e.displayName,html$1`
      <div class="channel-display">
        <div class="showing">
          <span class="channel-name-text">${t.first}</span
          ><span class="channel-name-text highlight-search-text">${t.highlight}</span
          ><span class="channel-name-text">${t.last}</span>
        </div>
      </div>
    `}renderError(){return this.renderTemplate("error",null,"error")||html$1`
        <div class="message-parent">
          <div label="search-error-text" aria-label="We didn't find any matches." class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderLoading(){return this.renderTemplate("loading",null,"loading")||html$1`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}loadState(){return __awaiter$b(this,void 0,void 0,(function*(){const e=Providers.globalProvider;let t;if(e&&e.state===or.SignedIn){const r=e.graph.forComponent(this);if(!(yield e.getAccessTokenForScopes(...Ja.requiredScopes)))return;t=yield function getAllMyTeams(e){return __awaiter$c(this,void 0,void 0,(function*(){const t=yield e.api("/me/joinedTeams").select(["displayName","id","isArchived"]).middlewareOptions(prepScopes("team.readbasic.all")).get();return t?t.value:null}))}(r),t=t.filter((e=>!e.isArchived));const o=r.createBatch(),i=["team.readbasic.all"];for(const e of t)o.get(e.id,`teams/${e.id}/channels`,i);const n=yield o.executeAll();for(const e of t){const t=n.get(e.id);t&&t.content&&t.content.value&&(e.channels=t.content.value.map((e=>({item:e}))))}this.items=t.map((e=>({channels:e.channels,item:e})))}this.filterList(),this.resetFocusState()}))}handleItemClick(e){e.channels?e.isExpanded=!e.isExpanded:this.selectChannel(e),this._focusedIndex=-1,this.resetFocusState()}handleInputChanged(e){this._inputValue!==e.target.textContent&&(this._inputValue=e.target.textContent,this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=debounce((()=>{this.filterList()}),400)),this.debouncedSearch())}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this._focusedIndex=-1,this.resetFocusState())}generateTreeViewState(e,t="",r=null){const o=[];if(t=t.toLowerCase(),e)for(const i of e){let e;if(0===t.length||i.item.displayName.toLowerCase().includes(t))e={item:i.item,parent:r},i.channels&&(e.channels=this.generateTreeViewState(i.channels,"",e),e.isExpanded=t.length>0);else if(i.channels){const o={item:i.item,parent:r},n=this.generateTreeViewState(i.channels,t,o);n.length>0&&(e=o,e.channels=n,e.isExpanded=!0)}e&&o.push(e)}return o}generateFocusList(e){if(!e||0===e.length)return[];let t=[];for(const r of e)t.push(r),r.channels&&r.isExpanded&&(t=[...t,...this.generateFocusList(r.channels)]);return t}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}loadTeamsIfNotLoaded(){this.items||this.isLoadingState||this.requestStateUpdate()}handleWindowClick(e){e.target!==this&&this.lostFocus()}onUserKeyDown(e){if(13===e.keyCode&&e.preventDefault(),0===this._treeViewState.length)return;const t=this._focusList[this._focusedIndex];switch(e.keyCode){case 40:this._focusedIndex=(this._focusedIndex+1)%this._focusList.length,this.requestUpdate(),e.preventDefault();break;case 38:-1===this._focusedIndex&&(this._focusedIndex=this._focusList.length),this._focusedIndex=(this._focusedIndex-1+this._focusList.length)%this._focusList.length,this.requestUpdate(),e.preventDefault();break;case 39:t&&t.channels&&!t.isExpanded&&(t.isExpanded=!0,this.resetFocusState(),e.preventDefault());break;case 37:t&&t.channels&&t.isExpanded&&(t.isExpanded=!1,this.resetFocusState(),e.preventDefault());break;case 9:if(!t){this.lostFocus();break}case 13:t&&t.channels?(t.isExpanded=!t.isExpanded,this.resetFocusState(),e.preventDefault()):t&&!t.channels&&(this.selectChannel(t),this.resetFocusState(),this._focusedIndex=-1,e.preventDefault());break;case 8:0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),e.preventDefault());break;case 27:this.selectChannel(this._selectedItemState),this._focusedIndex=-1,this.resetFocusState(),e.preventDefault()}}gainedFocus(){this._isFocused=!0;const e=this._input;e&&e.focus(),this._isDropdownVisible=!0}lostFocus(){this._isFocused=!1;const e=this._input;e&&(e.textContent=this._inputValue=""),this._isDropdownVisible=!1,this.filterList()}selectChannel(e){this._selectedItemState!==e&&(this._selectedItemState=e,this.fireCustomEvent("selectionChanged",e?[this.selectedItem]:[]));const t=this._input;t&&(t.textContent=this._inputValue=""),this.requestUpdate(),this.lostFocus()}};Za._config={useTeamsBasedScopes:!1},__decorate$7([property({attribute:!1}),__metadata$7("design:type",Object)],Za.prototype,"_isDropdownVisible",void 0),Za=Ja=__decorate$7([customElement("mgt-teams-channel-picker"),__metadata$7("design:paramtypes",[])],Za);const Xa={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var __decorate$6=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$6=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$a=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class MgtTasksBase extends MgtTemplatedComponent{constructor(){super(),this.clearState(),this._previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}get newTaskName(){return this._newTaskName}get strings(){return Xa}attributeChangedCallback(e,t,r){switch(super.attributeChangedCallback(e,t,r),e){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate()}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){const e=Providers.globalProvider;if(!e||e.state!==or.SignedIn)return html$1``;if(this.isLoadingState)return this.renderLoadingTask();const t=this.hideHeader?null:this.renderHeader(),r=this._isNewTaskVisible?this.renderNewTaskPanel():null,o=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return html$1`
      ${t} ${r}
      <div class="Tasks" dir=${this.direction}>
        ${o}
      </div>
    `}renderHeader(){const e=this.renderHeaderContent(),t=Sr({AddBarItem:!0,NewTaskButton:!0,hidden:this.readOnly||this._isNewTaskVisible});return html$1`
      <div class="Header" dir=${this.direction}>
        ${e}
        <button class="${t}" @click="${()=>this.showNewTaskPanel()}">
          <span class="TaskIcon"></span>
          <span>${this.strings.addTaskButtonSubtitle}</span>
        </button>
      </div>
    `}renderLoadingTask(){return html$1`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderNewTaskPanel(){const e=this._newTaskName,t=html$1`
      <input
        type="text"
        placeholder="${this.strings.newTaskPlaceholder}"
        .value="${e}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="input"
        @input="${e=>{this._newTaskName=e.target.value,this.requestUpdate()}}"
      />
    `,r=Sr({Disabled:!(this._isNewTaskBeingAdded||e&&e.length),TaskAddButtonContainer:!0}),o=this._isNewTaskBeingAdded?null:html$1`
          <div
            tabindex='0'
            class="TaskIcon TaskAdd"
            @click="${()=>this.addTask()}"
            @keypress="${e=>{"Enter"!==e.key&&" "!==e.key||this.addTask()}}"
          >
          <span>${this.strings.addTaskButtonSubtitle}</span>
          </div>
          <div
            role='button'
            tabindex='0'
            class="TaskIcon TaskCancel"
            @click="${()=>this.hideNewTaskPanel()}"
            @keypress="${e=>{"Enter"!==e.key&&" "!==e.key||this.hideNewTaskPanel()}}">
            <span>${this.strings.cancelNewTaskSubtitle}</span>
          </div>
        `,i=this.renderNewTaskDetails();return html$1`
      <div dir=${this.direction} class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${t}
            </div>
            <div class="TaskDetails">
              ${i}
            </div>
          </div>
        </div>
        <div class="${r}">
          ${o}
        </div>
      </div>
    `}renderBucketIcon(){return html$1`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}renderCalendarIcon(){return html$1`
        <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 11C5.55228 11 6 10.5523 6 10C6 9.44771 5.55228 9 5 9C4.44772 9 4 9.44771 4 10C4 10.5523 4.44772 11 5 11ZM6 13C6 13.5523 5.55228 14 5 14C4.44772 14 4 13.5523 4 13C4 12.4477 4.44772 12 5 12C5.55228 12 6 12.4477 6 13ZM8 11C8.55229 11 9 10.5523 9 10C9 9.44771 8.55229 9 8 9C7.44771 9 7 9.44771 7 10C7 10.5523 7.44771 11 8 11ZM9 13C9 13.5523 8.55229 14 8 14C7.44771 14 7 13.5523 7 13C7 12.4477 7.44771 12 8 12C8.55229 12 9 12.4477 9 13ZM11 11C11.5523 11 12 10.5523 12 10C12 9.44771 11.5523 9 11 9C10.4477 9 10 9.44771 10 10C10 10.5523 10.4477 11 11 11ZM15 5.5C15 4.11929 13.8807 3 12.5 3H3.5C2.11929 3 1 4.11929 1 5.5V14.5C1 15.8807 2.11929 17 3.5 17H12.5C13.8807 17 15 15.8807 15 14.5V5.5ZM2 7H14V14.5C14 15.3284 13.3284 16 12.5 16H3.5C2.67157 16 2 15.3284 2 14.5V7ZM3.5 4H12.5C13.3284 4 14 4.67157 14 5.5V6H2V5.5C2 4.67157 2.67157 4 3.5 4Z" fill="#717171"/>
        </svg>
      `}addTask(){return __awaiter$a(this,void 0,void 0,(function*(){if(!this._isNewTaskBeingAdded&&this.newTaskName){this._isNewTaskBeingAdded=!0,yield this.requestUpdate();try{yield this.createNewTask()}finally{this._isNewTaskBeingAdded=!1,this._isNewTaskVisible=!1,this.requestUpdate()}}}))}clearNewTaskData(){this._newTaskName=""}clearState(){this.clearNewTaskData(),this._isNewTaskVisible=!1,this.requestUpdate()}handleTaskClick(e,t){this.fireCustomEvent("taskClick",{task:t})}dateToInputValue(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}showNewTaskPanel(){this._isNewTaskVisible=!0,this.requestUpdate()}hideNewTaskPanel(){this._isNewTaskVisible=!1,this.clearNewTaskData(),this.requestUpdate()}onResize(){this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())}}__decorate$6([property({attribute:"read-only",type:Boolean}),__metadata$6("design:type",Boolean)],MgtTasksBase.prototype,"readOnly",void 0),__decorate$6([property({attribute:"hide-header",type:Boolean}),__metadata$6("design:type",Boolean)],MgtTasksBase.prototype,"hideHeader",void 0),__decorate$6([property({attribute:"hide-options",type:Boolean}),__metadata$6("design:type",Boolean)],MgtTasksBase.prototype,"hideOptions",void 0),__decorate$6([property({attribute:"target-id",type:String}),__metadata$6("design:type",String)],MgtTasksBase.prototype,"targetId",void 0),__decorate$6([property({attribute:"initial-id",type:String}),__metadata$6("design:type",String)],MgtTasksBase.prototype,"initialId",void 0);var el,tl,rl,__awaiter$9=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};!function(e){e[e.notStarted=0]="notStarted",e[e.inProgress=1]="inProgress",e[e.completed=2]="completed",e[e.deferred=3]="deferred",e[e.waitingOnOthers=4]="waitingOnOthers"}(el||(el={})),function(e){e[e.low=0]="low",e[e.normal=1]="normal",e[e.high=2]="high"}(tl||(tl={})),function(e){e[e.none=0]="none",e[e.default=1]="default",e[e.flaggedEmails=2]="flaggedEmails",e[e.unknownFutureValue=3]="unknownFutureValue"}(rl||(rl={}));const ol=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#023b8f;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#023b8f;--list-background-color:#161514;--list-item-background-color--hover:#323130}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#717171));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,#717171)}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .ReadOnly.Task .TaskCheckContainer{cursor:default}:host .Complete.Task{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Complete.Task .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .NewTask.Task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .NewTask.Task .SelfAssign{display:none}:host .NewTask.Task .AssignTo{border:0;background:0 0}:host .NewTask.Task .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .NewTask.Task .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .NewTask.Task .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .NewTask.Task .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .NewTask.Task .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .NewTask.Task .TaskAddButtonContainer{margin-right:28px}:host .NewTask.Task .TaskAddButtonContainer .TaskAdd,:host .NewTask.Task .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, "Segoe UI");font-size:14px;line-height:20px}:host .NewTask.Task .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .NewTask.Task .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130))}:host .NewTask.Task .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .LoadingTask.Task .TaskCheckContainer{cursor:default}:host .LoadingTask.Task .TaskDetails{display:flex}:host .LoadingTask.Task .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .LoadingTask.Task .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .LoadingTask.Task .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .LoadingTask.Task .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .LoadingTask.Task .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px}:host .Task{border:none}
`],il={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var __decorate$5=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$5=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter$8=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};let nl=class MgtTodo extends MgtTasksBase{constructor(){super(),this._graph=null,this._newTaskDueDate=null,this._newTaskListId="",this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}static get styles(){return ol}get strings(){return il}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}renderTasks(){if(this._isLoadingTasks)return this.renderLoadingTask();let e=this._tasks;e&&this.taskFilter&&(e=e.filter((e=>this.taskFilter(e))));const t=Yr(e,(e=>e.id),(e=>this.renderTask(e)));return html$1`
      ${t}
    `}renderNewTaskDetails(){const e=this._lists.filter((e=>this._currentList&&e.id===this._currentList.id||!this._currentList&&e.id===this._newTaskListId));e.length>0&&!this._newTaskListId&&(this._newTaskListId=e[0].id);const t=this._currentList?html$1`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <span>${this._currentList.displayName}</span>
          </span>
        `:html$1`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskListId}"
              @change="${e=>{this._newTaskListId=e.target.value}}"
            >
              ${e.map((e=>html$1`
                  <option value="${e.id}">${e.displayName}</option>
                `))}
            </select>
          </span>
        `,r=html$1`
      <span class="NewTaskDue">
        ${this.renderCalendarIcon()}
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="input"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null}}"
        />
      </span>
    `;return html$1`
      ${t} ${r}
    `}renderHeaderContent(){if(this.isLoadingState)return html$1`
        <div class="header__loading"></div>
      `;const e=this._lists||[],t=this._currentList,r=this.targetId;let o;if(r&&e.length){const t=e.find((e=>e.id===r));t&&(o=html$1`
          <span class="PlanTitle">
            ${t.displayName}
          </span>
        `)}else if(t){const r={};for(const t of e)r[t.displayName]=()=>this.loadTaskList(t);o=html$1`
        <mgt-arrow-options .value="${t.displayName}" .options="${r}"></mgt-arrow-options>
      `}return html$1`
      <span class="TitleCont">
        ${o}
      </span>
    `}renderTask(e){const t={task:e,list:this._currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",t,e.id);const r=el[e.status]===el.completed,o=this._loadingTasks.includes(e.id),i={Complete:!o&&r,Loading:o,TaskCheck:!0,TaskIcon:!0},n=o?html$1`
          
        `:r?html$1`
          
        `:null;let s=null;if(this.hasTemplate("task-details"))s=this.renderTemplate("task-details",t,`task-details-${e.id}`);else{const t=e.dueDateTime?html$1`
            <div class="TaskDetail TaskDue">
              <span>Due ${getShortDateString(new Date(e.dueDateTime.dateTime))}</span>
            </div>
          `:null;s=html$1`
        <div class="TaskTitle">
          ${e.title}
        </div>
        <div class="TaskDetail TaskBucket">
          ${this.renderBucketIcon()}
          <span>${this._currentList.displayName}</span>
        </div>
        ${t}
      `}const a=this.readOnly||this.hideOptions?null:html$1`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:t=>this.removeTask(t,e.id)}}"
              ></mgt-dot-options>
            </div>
          `,l=Sr({Complete:r,Incomplete:!r,ReadOnly:this.readOnly,Task:!0}),c=Sr({Complete:r,Incomplete:!r,TaskCheckContainer:!0});return html$1`
      <div class=${l}>
        <div class="TaskContent" @click="${t=>this.handleTaskClick(t,e)}}">
          <span class=${c} @click="${t=>this.handleTaskCheckClick(t,e)}">
            <span class=${Sr(i)}>
              <span class="TaskCheckContent">${n}</span>
            </span>
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery}">
            ${s}
          </div>
          ${a}
          <div class="Divider"></div>
        </div>
      </div>
    `}loadState(){return __awaiter$8(this,void 0,void 0,(function*(){const e=Providers.globalProvider;if(!e||e.state!==or.SignedIn)return;if(!this._graph){const t=e.graph.forComponent(this);this._graph=t}let t=this._lists;if(!t||!t.length){if(this.targetId){const e=yield function getTodoTaskList(e,t){return __awaiter$9(this,void 0,void 0,(function*(){return yield e.api(`/me/todo/lists/${t}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get()}))}(this._graph,this.targetId);t=e?[e]:[]}else t=yield function getTodoTaskLists(e){return __awaiter$9(this,void 0,void 0,(function*(){const t=yield e.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return t&&t.value}))}(this._graph);this._tasks=[],this._currentList=null,this._lists=t}let r=this._currentList;!r&&t&&t.length&&(this.initialId&&(r=t.find((e=>e.id===this.initialId))),r||(r=t[0]),this._tasks=[],this._currentList=r),r&&(yield this.loadTaskList(r))}))}createNewTask(){return __awaiter$8(this,void 0,void 0,(function*(){const e=this._currentList.id,t={title:this.newTaskName};this._newTaskDueDate&&(t.dueDateTime={dateTime:this._newTaskDueDate.toLocaleDateString(),timeZone:"UTC"});const r=yield function createTodoTask(e,t,r){return __awaiter$9(this,void 0,void 0,(function*(){return yield e.api(`/me/todo/lists/${t}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(r)}))}(this._graph,e,t);this._tasks.unshift(r)}))}clearNewTaskData(){super.clearNewTaskData(),this._newTaskDueDate=null,this._newTaskListId=null}clearState(){super.clearState(),this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}loadTaskList(e){return __awaiter$8(this,void 0,void 0,(function*(){this._isLoadingTasks=!0,this._currentList=e,this.requestUpdate(),this._tasks=yield function getTodoTasks(e,t){return __awaiter$9(this,void 0,void 0,(function*(){const r=yield e.api(`/me/todo/lists/${t}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return r&&r.value}))}(this._graph,e.id),this._isLoadingTasks=!1,this.requestUpdate()}))}updateTaskStatus(e,t){return __awaiter$8(this,void 0,void 0,(function*(){this._loadingTasks=[...this._loadingTasks,e.id],this.requestUpdate(),e.status=t;const r=this._currentList.id;e=yield function updateTodoTask(e,t,r,o){return __awaiter$9(this,void 0,void 0,(function*(){return yield e.api(`/me/todo/lists/${t}/tasks/${r}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).patch(o)}))}(this._graph,r,e.id,e);const o=this._tasks.findIndex((t=>t.id===e.id));this._tasks[o]=e,this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)),this.requestUpdate()}))}removeTask(e,t){return __awaiter$8(this,void 0,void 0,(function*(){this._tasks=this._tasks.filter((e=>e.id!==t)),this.requestUpdate();const e=this._currentList.id;yield function deleteTodoTask(e,t,r){return __awaiter$9(this,void 0,void 0,(function*(){yield e.api(`/me/todo/lists/${t}/tasks/${r}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).delete()}))}(this._graph,e,t),this._tasks=this._tasks.filter((e=>e.id!==t))}))}handleTaskCheckClick(e,t){this.readOnly||(el[t.status]===el.completed?this.updateTaskStatus(t,el.notStarted):this.updateTaskStatus(t,el.completed),e.stopPropagation(),e.preventDefault())}};nl=__decorate$5([customElement("mgt-todo"),__metadata$5("design:paramtypes",[])],nl);var __awaiter$7=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class MsalProvider extends IProvider{constructor(e){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.initProvider(e)}get userAgentApplication(){return this._userAgentApplication}get name(){return"MgtMsalProvider"}trySilentSignIn(){return __awaiter$7(this,void 0,void 0,(function*(){try{if(this._userAgentApplication.isCallback(window.location.hash))return;this._userAgentApplication.getAccount()&&(yield this.getAccessToken(null))?this.setState(or.SignedIn):this.setState(or.SignedOut)}catch(e){this.setState(or.SignedOut)}}))}login(e){return __awaiter$7(this,void 0,void 0,(function*(){let t=e||{loginHint:this._loginHint,scopes:this.scopes};if(this._prompt&&(t.prompt=this._prompt),this._domainHint&&(t.extraQueryParameters={domain_hint:this._domainHint}),this._loginType===rr.Popup){const e=yield this._userAgentApplication.loginPopup(t);this.setState(e.account?or.SignedIn:or.SignedOut)}else this._userAgentApplication.loginRedirect(t)}))}logout(){return __awaiter$7(this,void 0,void 0,(function*(){this._userAgentApplication.logout(),this.setState(or.SignedOut)}))}getAccessToken(e){return __awaiter$7(this,void 0,void 0,(function*(){const t=e&&e.scopes||this.scopes,r={loginHint:this._loginHint,scopes:t};this._domainHint&&(r.extraQueryParameters={domain_hint:this._domainHint});try{return(yield this._userAgentApplication.acquireTokenSilent(r)).accessToken}catch(e){if(!this.requiresInteraction(e))throw this.setState(or.SignedOut),e;if(this._loginType===rr.Redirect){if(this.areScopesDenied(t))throw e;this.setRequestedScopes(t),this._userAgentApplication.acquireTokenRedirect(r)}else try{return(yield this._userAgentApplication.acquireTokenPopup(r)).accessToken}catch(e){throw e}}throw null}))}updateScopes(e){this.scopes=e}requiresInteraction(e){return!(!e||!e.errorCode)&&(-1!==e.errorCode.indexOf("consent_required")||-1!==e.errorCode.indexOf("interaction_required")||-1!==e.errorCode.indexOf("login_required"))}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}getRequestedScopes(){const e=sessionStorage.getItem(this.sessionStorageRequestedScopesKey);return e?JSON.parse(e):null}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let r=t.indexOf("openid");-1!==r&&t.splice(r,1),r=t.indexOf("profile"),-1!==r&&t.splice(r,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){const e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){const t=this.getDeniedScopes();if(t&&t.filter((t=>-1!==e.indexOf(t))).length>0)return!0}return!1}initProvider(e){let t,r;if(this.scopes=void 0!==e.scopes?e.scopes:["user.read"],this._loginType=void 0!==e.loginType?e.loginType:rr.Redirect,this._loginHint=e.loginHint,this._domainHint=e.domainHint,this._prompt=void 0!==e.prompt?e.prompt:"select_account","clientId"in e){if(!e.clientId)throw new Error("clientId must be provided");{const o=e.options||{auth:{clientId:e.clientId}};o.auth.clientId=e.clientId,o.cache=o.cache||{},o.cache.cacheLocation=o.cache.cacheLocation||"localStorage",void 0!==o.cache.storeAuthStateInCookie&&null!==o.cache.storeAuthStateInCookie||(o.cache.storeAuthStateInCookie=!0),e.authority&&(o.auth.authority=e.authority),e.redirectUri&&(o.auth.redirectUri=e.redirectUri),r=e.clientId,t=new Nt(o)}}else{if(!("userAgentApplication"in e))throw new Error("either clientId or userAgentApplication must be provided");if(!e.userAgentApplication)throw new Error("userAgentApplication must be provided");t=e.userAgentApplication;r=t.getCurrentConfiguration().auth.clientId}this.clientId=r,this._userAgentApplication=t,this._userAgentApplication.handleRedirectCallback((e=>this.tokenReceivedCallback(e)),((e,t)=>this.errorReceivedCallback(e,t))),this.graph=createFromProvider(this),this.trySilentSignIn()}tokenReceivedCallback(e){"id_token"===e.tokenType&&this.setState(or.SignedIn),this.clearRequestedScopes()}errorReceivedCallback(e,t){const r=this.getRequestedScopes();r&&this.addDeniedScopes(r),this.clearRequestedScopes()}}var __decorate$4=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$4=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let sl=class MgtMsalProvider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const e={clientId:this.clientId,domainHint:this.domainHint,prompt:this.prompt};if(this.loginType&&this.loginType.length>1){let t=this.loginType.toLowerCase();t=t[0].toUpperCase()+t.slice(1);const r=rr[t];e.loginType=r}if(this.authority&&(e.authority=this.authority),this.scopes){const t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}this.redirectUri&&(e.redirectUri=this.redirectUri),this.provider=new MsalProvider(e),Providers.globalProvider=this.provider}}};__decorate$4([property({attribute:"client-id",type:String}),__metadata$4("design:type",Object)],sl.prototype,"clientId",void 0),__decorate$4([property({attribute:"login-type",type:String}),__metadata$4("design:type",Object)],sl.prototype,"loginType",void 0),__decorate$4([property(),__metadata$4("design:type",Object)],sl.prototype,"authority",void 0),__decorate$4([property({attribute:"scopes",type:String}),__metadata$4("design:type",Object)],sl.prototype,"scopes",void 0),__decorate$4([property({attribute:"redirect-uri",type:String}),__metadata$4("design:type",Object)],sl.prototype,"redirectUri",void 0),__decorate$4([property({attribute:"domain-hint",type:String}),__metadata$4("design:type",Object)],sl.prototype,"domainHint",void 0),__decorate$4([property({attribute:"prompt",type:String}),__metadata$4("design:type",Object)],sl.prototype,"prompt",void 0),sl=__decorate$4([customElement("mgt-msal-provider")],sl);var __awaiter$6=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class TeamsProvider extends MsalProvider{constructor(e){super({clientId:e.clientId,loginType:rr.Redirect,options:e.msalOptions,scopes:e.scopes}),this._msalOptions=e.msalOptions,this._authPopupUrl=e.authPopupUrl;TeamsHelper.microsoftTeamsLib.initialize()}static get isAvailable(){return TeamsHelper.isAvailable}static get microsoftTeamsLib(){return TeamsHelper.microsoftTeamsLib}static set microsoftTeamsLib(e){TeamsHelper.microsoftTeamsLib=e}get name(){return"MgtTeamsProvider"}static handleAuth(){return __awaiter$6(this,void 0,void 0,(function*(){const e=TeamsHelper.microsoftTeamsLib;if(!e)return void console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsProvider");e.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&e.authentication.notifySuccess();const t=new URL(window.location.href).searchParams.get("signout"),r=localStorage.getItem(this._localStorageParametersKey);let o;if(o=r?JSON.parse(r):{},!o.clientId)return void e.authentication.notifyFailure("no clientId provided");const i=o.scopes?o.scopes.split(","):null,n=o.options||{auth:{clientId:o.clientId}};n.system=n.system||{},n.system.loadFrameTimeout=1e4;const s=new MsalProvider({clientId:o.clientId,options:n,scopes:i});if(s.userAgentApplication.urlContainsHash(window.location.hash))return;const handleProviderState=()=>__awaiter$6(this,void 0,void 0,(function*(){if(s.state===or.SignedOut){if(t)return void e.authentication.notifySuccess();sessionStorage.getItem(this._sessionStorageLoginInProgress)||(sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),s.login({loginHint:o.loginHint,scopes:i||s.scopes}))}else if(s.state===or.SignedIn){if(t)return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),void(yield s.logout());try{const t=yield s.getAccessTokenForScopes(...s.scopes);e.authentication.notifySuccess(t)}catch(t){e.authentication.notifyFailure(t)}}}));s.onStateChanged(handleProviderState),handleProviderState()}))}login(){return __awaiter$6(this,void 0,void 0,(function*(){this.setState(or.Loading);const e=TeamsHelper.microsoftTeamsLib;return new Promise(((t,r)=>{e.getContext((o=>{this.teamsContext=o;const i={clientId:this.clientId,loginHint:o.loginHint,options:this._msalOptions,scopes:this.scopes.join(",")};localStorage.setItem(TeamsProvider._localStorageParametersKey,JSON.stringify(i));const n=new URL(this._authPopupUrl,new URL(window.location.href));e.authentication.authenticate({failureCallback:e=>{this.setState(or.SignedOut),r()},successCallback:e=>{this.trySilentSignIn(),t()},url:n.href})}))}))}))}logout(){return __awaiter$6(this,void 0,void 0,(function*(){const e=TeamsHelper.microsoftTeamsLib;return new Promise(((t,r)=>{e.getContext((o=>{this.teamsContext=o;const i=new URL(this._authPopupUrl,new URL(window.location.href));i.searchParams.append("signout","true"),e.authentication.authenticate({failureCallback:e=>{this.trySilentSignIn(),r()},successCallback:e=>{this.trySilentSignIn(),t()},url:i.href})}))}))}))}getAccessToken(e){return __awaiter$6(this,void 0,void 0,(function*(){if(!this.teamsContext&&TeamsHelper.microsoftTeamsLib){const e=TeamsHelper.microsoftTeamsLib;e.initialize(),this.teamsContext=yield e.getContext()}const t={scopes:e&&e.scopes||this.scopes};this.teamsContext&&this.teamsContext.loginHint&&(t.loginHint=this.teamsContext.loginHint);try{return(yield this.userAgentApplication.acquireTokenSilent(t)).accessToken}catch(e){if(this.requiresInteraction(e))return null;throw e}}))}}TeamsProvider._localStorageParametersKey="msg-teamsprovider-auth-parameters",TeamsProvider._sessionStorageLoginInProgress="msg-teamsprovider-login-in-progress",TeamsProvider._sessionStorageLogoutInProgress="msg-teamsprovider-logout-in-progress";var __decorate$3=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$3=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let al=class MgtTeamsProvider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId="",this.authPopupUrl=""}get isAvailable(){return TeamsProvider.isAvailable}initializeProvider(){if(this.clientId&&this.authPopupUrl){const e={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){const t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}if(this.authority){const t={auth:{authority:this.authority,clientId:this.clientId}};e.msalOptions=t}this.provider=new TeamsProvider(e),Providers.globalProvider=this.provider}}};__decorate$3([property({attribute:"client-id",type:String}),__metadata$3("design:type",Object)],al.prototype,"clientId",void 0),__decorate$3([property({attribute:"auth-popup-url",type:String}),__metadata$3("design:type",Object)],al.prototype,"authPopupUrl",void 0),__decorate$3([property(),__metadata$3("design:type",Object)],al.prototype,"authority",void 0),__decorate$3([property({attribute:"scopes",type:String}),__metadata$3("design:type",Object)],al.prototype,"scopes",void 0),al=__decorate$3([customElement("mgt-teams-provider")],al);var __awaiter$5=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class CustomHeaderMiddleware{constructor(e){this._getCustomHeaders=e}execute(e){return __awaiter$5(this,void 0,void 0,(function*(){if(this._getCustomHeaders){const t=yield this._getCustomHeaders();for(const r in t)t.hasOwnProperty(r)&&setRequestHeader(e.request,e.options,r,t[r])}return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}class ProxyGraph extends Graph{constructor(e,t){const r=[new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new SdkVersionMiddleware("2.5.3"),new CustomHeaderMiddleware(t),new HTTPMessageHandler];super(Client.initWithMiddleware({baseUrl:e,middleware:chainMiddleware(...r)}))}}class ProxyProvider extends IProvider{constructor(e,t=null){super(),this.graph=new ProxyGraph(e,t),this.graph.api("me").get().then((e=>{null!=e?this.setState(or.SignedIn):this.setState(or.SignedOut)}),(e=>{this.setState(or.SignedOut)}))}get name(){return"MgtProxyProvider"}getAccessToken(){return null}}var __decorate$2=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$2=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ll=class MgtProxyProvider extends MgtBaseProvider{get isAvailable(){return!0}initializeProvider(){void 0!==this.graphProxyUrl&&(this.provider=new ProxyProvider(this.graphProxyUrl),Providers.globalProvider=this.provider)}};__decorate$2([property({attribute:"graph-proxy-url"}),__metadata$2("design:type",String)],ll.prototype,"graphProxyUrl",void 0),ll=__decorate$2([customElement("mgt-proxy-provider")],ll);var __awaiter$4=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};class SharePointProvider extends IProvider{constructor(e){super(),e.aadTokenProviderFactory.getTokenProvider().then((e=>{this._provider=e,this.graph=createFromProvider(this),this.internalLogin()}))}get provider(){return this._provider}get isLoggedIn(){return!!this._idToken}get name(){return"MgtSharePointProvider"}getAccessToken(){return __awaiter$4(this,void 0,void 0,(function*(){let e;try{e=yield this.provider.getToken("https://graph.microsoft.com")}catch(e){throw e}return e}))}updateScopes(e){this.scopes=e}internalLogin(){return __awaiter$4(this,void 0,void 0,(function*(){this._idToken=yield this.getAccessToken(),this.setState(this._idToken?or.SignedIn:or.SignedOut)}))}}
/*! @azure/msal-browser v2.26.0 2022-06-13 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics$1=function(e,t){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},extendStatics$1(e,t)};function __extends$1(e,t){function __(){this.constructor=e}extendStatics$1(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}var __assign$1=function(){return __assign$1=Object.assign||function __assign(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign$1.apply(this,arguments)};function __awaiter$3(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))}function __generator$1(e,t){var r,o,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function verb(n){return function(a){return function step(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,i,n=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}
/*! @azure/msal-common v7.0.0 2022-06-13 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},extendStatics(e,t)};function __extends(e,t){function __(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}var __assign=function(){return __assign=Object.assign||function __assign(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__assign.apply(this,arguments)};function __awaiter$2(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))}function __generator(e,t){var r,o,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function verb(n){return function(a){return function step(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}function __spreadArrays(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<r;t++)for(var n=arguments[t],s=0,a=n.length;s<a;s++,i++)o[i]=n[s];return o}
/*! @azure/msal-common v7.0.0 2022-06-13 */var cl,dl,ul,hl,pl,fl={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token"},gl=[fl.OPENID_SCOPE,fl.PROFILE_SCOPE,fl.OFFLINE_ACCESS_SCOPE],ml=__spreadArrays(gl,[fl.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info"}(cl||(cl={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account"}(dl||(dl={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(ul||(ul={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(hl||(hl={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(pl||(pl={}));var vl,bl={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(vl||(vl={}));var yl,wl,Cl,kl,Tl,_l,Sl,El={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(yl||(yl={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(wl||(wl={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(Cl||(Cl={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(kl||(kl={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(Tl||(Tl={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(_l||(_l={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(Sl||(Sl={}));var Il,xl="authority-metadata",Al=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(Il||(Il={}));var Pl,Rl={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(Pl||(Pl={}));var Ol,Nl,Dl,Ll,Ml,$l,Ul=60,Fl=3600,Hl="throttling",Bl="retry-after, h429",ql="invalid_grant",zl="client_mismatch";!function(e){e.username="username",e.password="password"}(Ol||(Ol={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(Nl||(Nl={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(Dl||(Dl={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(Ll||(Ll={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(Ml||(Ml={})),function(e){e.Jwt="JWT",e.Jwk="JWK"}($l||($l={}));
/*! @azure/msal-common v7.0.0 2022-06-13 */
var jl,Vl={code:"unexpected_error",desc:"Unexpected error in authentication."},Gl=function(e){function AuthError(t,r,o){var i=this,n=r?t+": "+r:t;return i=e.call(this,n)||this,Object.setPrototypeOf(i,AuthError.prototype),i.errorCode=t||fl.EMPTY_STRING,i.errorMessage=r||fl.EMPTY_STRING,i.subError=o||fl.EMPTY_STRING,i.name="AuthError",i}return __extends(AuthError,e),AuthError.prototype.setCorrelationId=function(e){this.correlationId=e},AuthError.createUnexpectedError=function(e){return new AuthError(Vl.code,Vl.desc+": "+e)},AuthError}(Error),Kl={createNewGuid:function(){throw Gl.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw Gl.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw Gl.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",Gl.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",Gl.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",Gl.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",Gl.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",Gl.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Crypto interface - hashString() has not been implemented",Gl.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},Wl={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},Ql={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},Yl={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},Jl={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},Zl={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},Xl={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},ec={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},tc={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},rc={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},oc={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},ic={code:"state_not_found",desc:"State not found"},nc={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},sc={code:"nonce_not_found",desc:"nonce not found"},ac={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},lc={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},cc={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},dc={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},uc={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},hc={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},pc={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},fc={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},gc={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},mc={code:"device_code_expired",desc:"Device code is expired."},vc={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},bc={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},yc={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},wc={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},Cc={code:"no_account_found",desc:"No account found in cache for given key."},kc={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},Tc={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},_c={code:"invalid_cache_type",desc:"Invalid cache type"},Sc={code:"unexpected_account_type",desc:"Unexpected account type."},Ec={code:"unexpected_credential_type",desc:"Unexpected credential type."},Ic={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},xc={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},Ac={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},Pc={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},Rc={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},Oc={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},Nc={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},Dc={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},Lc={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},Mc=function(e){function ClientAuthError(t,r){var o=e.call(this,t,r)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,ClientAuthError.prototype),o}return __extends(ClientAuthError,e),ClientAuthError.createClientInfoDecodingError=function(e){return new ClientAuthError(Wl.code,Wl.desc+" Failed with error: "+e)},ClientAuthError.createClientInfoEmptyError=function(){return new ClientAuthError(Ql.code,""+Ql.desc)},ClientAuthError.createTokenParsingError=function(e){return new ClientAuthError(Yl.code,Yl.desc+" Failed with error: "+e)},ClientAuthError.createTokenNullOrEmptyError=function(e){return new ClientAuthError(Jl.code,Jl.desc+" Raw Token Value: "+e)},ClientAuthError.createEndpointDiscoveryIncompleteError=function(e){return new ClientAuthError(Zl.code,Zl.desc+" Detail: "+e)},ClientAuthError.createNetworkError=function(e,t){return new ClientAuthError(Xl.code,Xl.desc+" | Fetch client threw: "+t+" | Attempted to reach: "+e.split("?")[0])},ClientAuthError.createUnableToGetOpenidConfigError=function(e){return new ClientAuthError(ec.code,ec.desc+" Attempted to retrieve endpoints from: "+e)},ClientAuthError.createHashNotDeserializedError=function(e){return new ClientAuthError(tc.code,tc.desc+" Given Object: "+e)},ClientAuthError.createInvalidStateError=function(e,t){return new ClientAuthError(rc.code,rc.desc+" Invalid State: "+e+", Root Err: "+t)},ClientAuthError.createStateMismatchError=function(){return new ClientAuthError(oc.code,oc.desc)},ClientAuthError.createStateNotFoundError=function(e){return new ClientAuthError(ic.code,ic.desc+":  "+e)},ClientAuthError.createNonceMismatchError=function(){return new ClientAuthError(nc.code,nc.desc)},ClientAuthError.createNonceNotFoundError=function(e){return new ClientAuthError(sc.code,sc.desc+":  "+e)},ClientAuthError.createMultipleMatchingTokensInCacheError=function(){return new ClientAuthError(ac.code,ac.desc+".")},ClientAuthError.createMultipleMatchingAccountsInCacheError=function(){return new ClientAuthError(lc.code,lc.desc)},ClientAuthError.createMultipleMatchingAppMetadataInCacheError=function(){return new ClientAuthError(cc.code,cc.desc)},ClientAuthError.createTokenRequestCannotBeMadeError=function(){return new ClientAuthError(dc.code,dc.desc)},ClientAuthError.createAppendEmptyScopeToSetError=function(e){return new ClientAuthError(uc.code,uc.desc+" Given Scope: "+e)},ClientAuthError.createRemoveEmptyScopeFromSetError=function(e){return new ClientAuthError(hc.code,hc.desc+" Given Scope: "+e)},ClientAuthError.createAppendScopeSetError=function(e){return new ClientAuthError(pc.code,pc.desc+" Detail Error: "+e)},ClientAuthError.createEmptyInputScopeSetError=function(){return new ClientAuthError(fc.code,""+fc.desc)},ClientAuthError.createDeviceCodeCancelledError=function(){return new ClientAuthError(gc.code,""+gc.desc)},ClientAuthError.createDeviceCodeExpiredError=function(){return new ClientAuthError(mc.code,""+mc.desc)},ClientAuthError.createDeviceCodeUnknownError=function(){return new ClientAuthError(vc.code,""+vc.desc)},ClientAuthError.createNoAccountInSilentRequestError=function(){return new ClientAuthError(bc.code,""+bc.desc)},ClientAuthError.createNullOrUndefinedCacheRecord=function(){return new ClientAuthError(yc.code,yc.desc)},ClientAuthError.createInvalidCacheEnvironmentError=function(){return new ClientAuthError(wc.code,wc.desc)},ClientAuthError.createNoAccountFoundError=function(){return new ClientAuthError(Cc.code,Cc.desc)},ClientAuthError.createCachePluginError=function(){return new ClientAuthError(kc.code,""+kc.desc)},ClientAuthError.createNoCryptoObjectError=function(e){return new ClientAuthError(Tc.code,""+Tc.desc+e)},ClientAuthError.createInvalidCacheTypeError=function(){return new ClientAuthError(_c.code,""+_c.desc)},ClientAuthError.createUnexpectedAccountTypeError=function(){return new ClientAuthError(Sc.code,""+Sc.desc)},ClientAuthError.createUnexpectedCredentialTypeError=function(){return new ClientAuthError(Ec.code,""+Ec.desc)},ClientAuthError.createInvalidAssertionError=function(){return new ClientAuthError(Ic.code,""+Ic.desc)},ClientAuthError.createInvalidCredentialError=function(){return new ClientAuthError(xc.code,""+xc.desc)},ClientAuthError.createRefreshRequiredError=function(){return new ClientAuthError(Ac.code,Ac.desc)},ClientAuthError.createUserTimeoutReachedError=function(){return new ClientAuthError(Pc.code,Pc.desc)},ClientAuthError.createTokenClaimsRequiredError=function(){return new ClientAuthError(Rc.code,Rc.desc)},ClientAuthError.createNoAuthCodeInServerResponseError=function(){return new ClientAuthError(Oc.code,Oc.desc)},ClientAuthError.createBindingKeyNotRemovedError=function(){return new ClientAuthError(Nc.code,Nc.desc)},ClientAuthError.createLogoutNotSupportedError=function(){return new ClientAuthError(Dc.code,Dc.desc)},ClientAuthError.createKeyIdMissingError=function(){return new ClientAuthError(Lc.code,Lc.desc)},ClientAuthError}(Gl),$c=function(){function StringUtils(){}return StringUtils.decodeAuthToken=function(e){if(StringUtils.isEmpty(e))throw Mc.createTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw Mc.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},StringUtils.isEmpty=function(e){return void 0===e||!e||0===e.length},StringUtils.isEmptyObj=function(e){if(e&&!StringUtils.isEmpty(e))try{var t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0},StringUtils.startsWith=function(e,t){return 0===e.indexOf(t)},StringUtils.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},StringUtils.queryStringToObject=function(e){var t={},r=e.split("&"),decode=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[decode(o)]=decode(i))}})),t},StringUtils.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},StringUtils.removeEmptyStringsFromArray=function(e){return e.filter((function(e){return!StringUtils.isEmpty(e)}))},StringUtils.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},StringUtils.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},StringUtils}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(jl||(jl={}));var Uc,Fc=function(){function Logger(e,t,r){this.level=jl.Info;this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level="number"==typeof e.logLevel?e.logLevel:jl.Info,this.correlationId=e.correlationId||fl.EMPTY_STRING,this.packageName=t||fl.EMPTY_STRING,this.packageVersion=r||fl.EMPTY_STRING}return Logger.prototype.clone=function(e,t,r){return new Logger({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)},Logger.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),o=($c.isEmpty(t.correlationId)?$c.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+jl[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,o,t.containsPii||!1)}},Logger.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},Logger.prototype.error=function(e,t){this.logMessage(e,{logLevel:jl.Error,containsPii:!1,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:jl.Error,containsPii:!0,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.warning=function(e,t){this.logMessage(e,{logLevel:jl.Warning,containsPii:!1,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:jl.Warning,containsPii:!0,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.info=function(e,t){this.logMessage(e,{logLevel:jl.Info,containsPii:!1,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:jl.Info,containsPii:!0,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:jl.Verbose,containsPii:!1,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:jl.Verbose,containsPii:!0,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.trace=function(e,t){this.logMessage(e,{logLevel:jl.Trace,containsPii:!1,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:jl.Trace,containsPii:!0,correlationId:t||fl.EMPTY_STRING})},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Logger}();
/*! @azure/msal-common v7.0.0 2022-06-13 */!function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(Uc||(Uc={}));
/*! @azure/msal-common v7.0.0 2022-06-13 */
var Hc,Bc=function(){function CredentialEntity(){}return CredentialEntity.prototype.generateAccountId=function(){return CredentialEntity.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},CredentialEntity.prototype.generateCredentialId=function(){return CredentialEntity.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},CredentialEntity.prototype.generateTarget=function(){return CredentialEntity.generateTargetForCacheKey(this.target)},CredentialEntity.prototype.generateCredentialKey=function(){return CredentialEntity.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},CredentialEntity.prototype.generateType=function(){switch(this.credentialType){case Tl.ID_TOKEN:return Sl.ID_TOKEN;case Tl.ACCESS_TOKEN:case Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Sl.ACCESS_TOKEN;case Tl.REFRESH_TOKEN:return Sl.REFRESH_TOKEN;default:throw Mc.createUnexpectedCredentialTypeError()}},CredentialEntity.getCredentialType=function(e){return-1!==e.indexOf(Tl.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME:Tl.ACCESS_TOKEN:-1!==e.indexOf(Tl.ID_TOKEN.toLowerCase())?Tl.ID_TOKEN:-1!==e.indexOf(Tl.REFRESH_TOKEN.toLowerCase())?Tl.REFRESH_TOKEN:fl.NOT_DEFINED},CredentialEntity.generateCredentialCacheKey=function(e,t,r,o,i,n,s,a,l){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,o,i,s),this.generateTargetForCacheKey(n),this.generateClaimsHashForCacheKey(l),this.generateSchemeForCacheKey(a)].join(kl.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateAccountIdForCacheKey=function(e,t){return[e,t].join(kl.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateCredentialIdForCacheKey=function(e,t,r,o){return[e,e===Tl.REFRESH_TOKEN&&o||t,r||fl.EMPTY_STRING].join(kl.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateTargetForCacheKey=function(e){return(e||fl.EMPTY_STRING).toLowerCase()},CredentialEntity.generateClaimsHashForCacheKey=function(e){return(e||fl.EMPTY_STRING).toLowerCase()},CredentialEntity.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==Pl.BEARER.toLowerCase()?e.toLowerCase():fl.EMPTY_STRING},CredentialEntity}(),qc={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},zc={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},jc={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Vc={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Gc={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},Kc={code:"empty_url_error",desc:"URL was empty or null."},Wc={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},Qc={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},Yc={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},Jc={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},Zc={code:"token_request_empty",desc:"Token request was empty and not found in cache."},Xc={code:"logout_request_empty",desc:"The logout request was null or undefined."},ed={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},td={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},rd={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},od={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},id={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},nd={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},sd={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},ad={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},ld={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},cd={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},dd=function(e){function ClientConfigurationError(t,r){var o=e.call(this,t,r)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,ClientConfigurationError.prototype),o}return __extends(ClientConfigurationError,e),ClientConfigurationError.createRedirectUriEmptyError=function(){return new ClientConfigurationError(qc.code,qc.desc)},ClientConfigurationError.createPostLogoutRedirectUriEmptyError=function(){return new ClientConfigurationError(zc.code,zc.desc)},ClientConfigurationError.createClaimsRequestParsingError=function(e){return new ClientConfigurationError(jc.code,jc.desc+" Given value: "+e)},ClientConfigurationError.createInsecureAuthorityUriError=function(e){return new ClientConfigurationError(Vc.code,Vc.desc+" Given URI: "+e)},ClientConfigurationError.createUrlParseError=function(e){return new ClientConfigurationError(Gc.code,Gc.desc+" Given Error: "+e)},ClientConfigurationError.createUrlEmptyError=function(){return new ClientConfigurationError(Kc.code,Kc.desc)},ClientConfigurationError.createEmptyScopesArrayError=function(){return new ClientConfigurationError(Wc.code,""+Wc.desc)},ClientConfigurationError.createClientIdSingleScopeError=function(e){return new ClientConfigurationError(Qc.code,Qc.desc+" Given Scopes: "+e)},ClientConfigurationError.createInvalidPromptError=function(e){return new ClientConfigurationError(Yc.code,Yc.desc+" Given value: "+e)},ClientConfigurationError.createInvalidClaimsRequestError=function(){return new ClientConfigurationError(Jc.code,Jc.desc)},ClientConfigurationError.createEmptyLogoutRequestError=function(){return new ClientConfigurationError(Xc.code,Xc.desc)},ClientConfigurationError.createEmptyTokenRequestError=function(){return new ClientConfigurationError(Zc.code,Zc.desc)},ClientConfigurationError.createInvalidCodeChallengeMethodError=function(){return new ClientConfigurationError(ed.code,ed.desc)},ClientConfigurationError.createInvalidCodeChallengeParamsError=function(){return new ClientConfigurationError(td.code,td.desc)},ClientConfigurationError.createInvalidCloudDiscoveryMetadataError=function(){return new ClientConfigurationError(rd.code,rd.desc)},ClientConfigurationError.createInvalidAuthorityMetadataError=function(){return new ClientConfigurationError(od.code,od.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(){return new ClientConfigurationError(id.code,id.desc)},ClientConfigurationError.createInvalidAzureCloudInstanceError=function(){return new ClientConfigurationError(nd.code,nd.desc)},ClientConfigurationError.createMissingSshJwkError=function(){return new ClientConfigurationError(sd.code,sd.desc)},ClientConfigurationError.createMissingSshKidError=function(){return new ClientConfigurationError(ad.code,ad.desc)},ClientConfigurationError.createMissingNonceAuthenticationHeadersError=function(){return new ClientConfigurationError(ld.code,ld.desc)},ClientConfigurationError.createInvalidAuthenticationHeaderError=function(e,t){return new ClientConfigurationError(cd.code,cd.desc+". Invalid header: "+e+". Details: "+t)},ClientConfigurationError}(Mc),ud=function(){function ScopeSet(e){var t=this,r=e?$c.trimArrayEntries(__spreadArrays(e)):[],o=r?$c.removeEmptyStringsFromArray(r):[];this.validateInputScopes(o),this.scopes=new Set,o.forEach((function(e){return t.scopes.add(e)}))}return ScopeSet.fromString=function(e){return new ScopeSet((e||fl.EMPTY_STRING).split(" "))},ScopeSet.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw dd.createEmptyScopesArrayError()},ScopeSet.prototype.containsScope=function(e){var t=new ScopeSet(this.printScopesLowerCase().split(" "));return!$c.isEmpty(e)&&t.scopes.has(e.toLowerCase())},ScopeSet.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},ScopeSet.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return ml.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},ScopeSet.prototype.appendScope=function(e){$c.isEmpty(e)||this.scopes.add(e.trim())},ScopeSet.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw Mc.createAppendScopeSetError(e)}},ScopeSet.prototype.removeScope=function(e){if($c.isEmpty(e))throw Mc.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},ScopeSet.prototype.removeOIDCScopes=function(){var e=this;ml.forEach((function(t){e.scopes.delete(t)}))},ScopeSet.prototype.unionScopeSets=function(e){if(!e)throw Mc.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},ScopeSet.prototype.intersectingScopeSets=function(e){if(!e)throw Mc.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),o=this.getScopeCount();return t.size<o+r},ScopeSet.prototype.getScopeCount=function(){return this.scopes.size},ScopeSet.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},ScopeSet.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):fl.EMPTY_STRING},ScopeSet.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},ScopeSet}();
/*! @azure/msal-common v7.0.0 2022-06-13 */
/*! @azure/msal-common v7.0.0 2022-06-13 */
function buildClientInfo(e,t){if($c.isEmpty(e))throw Mc.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw Mc.createClientInfoDecodingError(e)}}function buildClientInfoFromHomeAccountId(e){if($c.isEmpty(e))throw Mc.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(kl.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?fl.EMPTY_STRING:t[1]}}
/*! @azure/msal-common v7.0.0 2022-06-13 */!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(Hc||(Hc={}));
/*! @azure/msal-common v7.0.0 2022-06-13 */
var hd=function(){function AccountEntity(){}return AccountEntity.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(kl.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.prototype.generateAccountKey=function(){return AccountEntity.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},AccountEntity.prototype.generateType=function(){switch(this.authorityType){case Cl.ADFS_ACCOUNT_TYPE:return Sl.ADFS;case Cl.MSAV1_ACCOUNT_TYPE:return Sl.MSA;case Cl.MSSTS_ACCOUNT_TYPE:return Sl.MSSTS;case Cl.GENERIC_ACCOUNT_TYPE:return Sl.GENERIC;default:throw Mc.createUnexpectedAccountTypeError()}},AccountEntity.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},AccountEntity.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||fl.EMPTY_STRING,e.tenantId||fl.EMPTY_STRING].join(kl.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.createAccount=function(e,t,r,o,i,n,s,a){var l,c,d,u,h,p,f=new AccountEntity;f.authorityType=Cl.MSSTS_ACCOUNT_TYPE,f.clientInfo=e,f.homeAccountId=t,f.nativeAccountId=a;var g=s||o&&o.getPreferredCache();if(!g)throw Mc.createInvalidCacheEnvironmentError();return f.environment=g,f.realm=(null===(l=null==r?void 0:r.claims)||void 0===l?void 0:l.tid)||fl.EMPTY_STRING,r&&(f.idTokenClaims=r.claims,f.localAccountId=(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.oid)||(null===(d=null==r?void 0:r.claims)||void 0===d?void 0:d.sub)||fl.EMPTY_STRING,f.username=(null===(u=null==r?void 0:r.claims)||void 0===u?void 0:u.preferred_username)||((null===(h=null==r?void 0:r.claims)||void 0===h?void 0:h.emails)?r.claims.emails[0]:fl.EMPTY_STRING),f.name=null===(p=null==r?void 0:r.claims)||void 0===p?void 0:p.name),f.cloudGraphHostName=i,f.msGraphHost=n,f},AccountEntity.createGenericAccount=function(e,t,r,o,i,n){var s,a,l,c,d=new AccountEntity;d.authorityType=r&&r.authorityType===Hc.Adfs?Cl.ADFS_ACCOUNT_TYPE:Cl.GENERIC_ACCOUNT_TYPE,d.homeAccountId=e,d.realm=fl.EMPTY_STRING;var u=n||r&&r.getPreferredCache();if(!u)throw Mc.createInvalidCacheEnvironmentError();return t&&(d.localAccountId=(null===(s=null==t?void 0:t.claims)||void 0===s?void 0:s.oid)||(null===(a=null==t?void 0:t.claims)||void 0===a?void 0:a.sub)||fl.EMPTY_STRING,d.username=(null===(l=null==t?void 0:t.claims)||void 0===l?void 0:l.upn)||fl.EMPTY_STRING,d.name=(null===(c=null==t?void 0:t.claims)||void 0===c?void 0:c.name)||fl.EMPTY_STRING,d.idTokenClaims=null==t?void 0:t.claims),d.environment=u,d.cloudGraphHostName=o,d.msGraphHost=i,d},AccountEntity.generateHomeAccountId=function(e,t,r,o,i){var n,s=(null===(n=null==i?void 0:i.claims)||void 0===n?void 0:n.sub)?i.claims.sub:fl.EMPTY_STRING;if(t===Hc.Adfs)return s;if(e)try{var a=buildClientInfo(e,o);if(!$c.isEmpty(a.uid)&&!$c.isEmpty(a.utid))return""+a.uid+kl.CLIENT_INFO_SEPARATOR+a.utid}catch(e){}return r.verbose("No client info in response"),s},AccountEntity.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},AccountEntity.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var o=!0;if(r){var i=e.idTokenClaims||{},n=t.idTokenClaims||{};o=i.iat===n.iat&&i.nonce===n.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o},AccountEntity}(),pd=function(){function AuthToken(e,t){if($c.isEmpty(e))throw Mc.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=AuthToken.extractTokenClaims(e,t)}return AuthToken.extractTokenClaims=function(e,t){var r=$c.decodeAuthToken(e);try{var o=r.JWSPayload,i=t.base64Decode(o);return JSON.parse(i)}catch(e){throw Mc.createTokenParsingError(e)}},AuthToken}(),fd=function(){function CacheManager(e,t){this.clientId=e,this.cryptoImpl=t}return CacheManager.prototype.getAllAccounts=function(){var e=this,t=this.getAccountsFilteredBy(),r=Object.keys(t).map((function(e){return t[e]}));return r.length<1?[]:r.map((function(t){var r=CacheManager.toObject(new hd,t).getAccountInfo(),o=e.readIdTokenFromCache(e.clientId,r);return o&&!r.idTokenClaims&&(r.idTokenClaims=new pd(o.secret,e.cryptoImpl).claims),r}))},CacheManager.prototype.saveCacheRecord=function(e){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:if(!e)throw Mc.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},CacheManager.prototype.saveAccessToken=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r,o,i,n=this;return __generator(this,(function(s){switch(s.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash}),r=ud.fromString(e.target),(o=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]})))?(i=[],o.forEach((function(e){ud.fromString(e.target).intersectingScopeSets(r)&&i.push(n.removeCredential(e))})),[4,Promise.all(i)]):[3,2];case 1:s.sent(),s.label=2;case 2:return this.setAccessTokenCredential(e),[2]}}))}))},CacheManager.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:fl.EMPTY_STRING,e?e.environment:fl.EMPTY_STRING,e?e.realm:fl.EMPTY_STRING)},CacheManager.prototype.getAccountsFilteredByInternal=function(e,t,r){var o=this,i=this.getKeys(),n={};return i.forEach((function(i){var s=o.getAccount(i);s&&(e&&!o.matchHomeAccountId(s,e)||t&&!o.matchEnvironment(s,t)||r&&!o.matchRealm(s,r)||(n[i]=s))})),n},CacheManager.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.userAssertionHash,e.tokenType,e.keyId,e.requestedClaimsHash)},CacheManager.prototype.getCredentialsFilteredByInternal=function(e,t,r,o,i,n,s,a,l,c,d){var u=this,h=this.getKeys(),p={idTokens:{},accessTokens:{},refreshTokens:{}};return h.forEach((function(h){var f=Bc.getCredentialType(h);if(f!==fl.NOT_DEFINED){var g=u.getSpecificCredential(h,f);if(g&&(!a||u.matchUserAssertionHash(g,a))&&(!e||u.matchHomeAccountId(g,e))&&(!t||u.matchEnvironment(g,t))&&(!n||u.matchRealm(g,n))&&(!r||u.matchCredentialType(g,r))&&(!o||u.matchClientId(g,o))&&(!i||u.matchFamilyId(g,i))&&(!s||u.matchTarget(g,s))&&(!d&&!g.requestedClaimsHash||g.requestedClaimsHash===d)){if(r===Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(l&&!u.matchTokenType(g,l))return;if(l===Pl.SSH&&c&&!u.matchKeyId(g,c))return}var m=u.updateCredentialCacheKey(h,g);switch(f){case Tl.ID_TOKEN:p.idTokens[m]=g;break;case Tl.ACCESS_TOKEN:case Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME:p.accessTokens[m]=g;break;case Tl.REFRESH_TOKEN:p.refreshTokens[m]=g}}}})),p},CacheManager.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},CacheManager.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,o=this.getKeys(),i={};return o.forEach((function(o){if(r.isAppMetadata(o)){var n=r.getAppMetadata(o);n&&(e&&!r.matchEnvironment(n,e)||t&&!r.matchClientId(n,t)||(i[o]=n))}})),i},CacheManager.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),o=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var i=t.getAuthorityMetadata(r);i&&-1!==i.aliases.indexOf(e)&&(o=i)}})),o},CacheManager.prototype.removeAllAccounts=function(){return __awaiter$2(this,void 0,void 0,(function(){var e,t,r=this;return __generator(this,(function(o){switch(o.label){case 0:return e=this.getKeys(),t=[],e.forEach((function(e){r.getAccount(e)&&t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return o.sent(),[2,!0]}}))}))},CacheManager.prototype.removeAccount=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw Mc.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,r.sent()&&this.removeItem(e,_l.ACCOUNT)]}}))}))},CacheManager.prototype.removeAccountContext=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r,o,i=this;return __generator(this,(function(n){switch(n.label){case 0:return t=this.getKeys(),r=e.generateAccountId(),o=[],t.forEach((function(e){var t=Bc.getCredentialType(e);if(t!==fl.NOT_DEFINED){var n=i.getSpecificCredential(e,t);n&&r===n.generateAccountId()&&o.push(i.removeCredential(n))}})),[4,Promise.all(o)];case 1:return n.sent(),[2,!0]}}))}))},CacheManager.prototype.removeCredential=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r;return __generator(this,(function(o){switch(o.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(e.tokenType!==Pl.POP)return[3,4];if(!(r=e.keyId))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return o.sent(),[3,4];case 3:throw o.sent(),Mc.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,_l.CREDENTIAL)]}}))}))},CacheManager.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,_l.APP_METADATA)})),!0},CacheManager.prototype.readCacheRecord=function(e,t,r,o){var i=this.readAccountFromCache(e),n=this.readIdTokenFromCache(t,e),s=this.readAccessTokenFromCache(t,e,r),a=this.readRefreshTokenFromCache(t,e,!1),l=this.readAppMetadataFromCache(o,t);return i&&n&&(i.idTokenClaims=new pd(n.secret,this.cryptoImpl).claims),{account:i,idToken:n,accessToken:s,refreshToken:a,appMetadata:l}},CacheManager.prototype.readAccountFromCache=function(e){var t=hd.generateAccountCacheKey(e);return this.getAccount(t)},CacheManager.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:Tl.ID_TOKEN,clientId:e,realm:t.tenantId},o=this.getCredentialsFilteredBy(r),i=Object.keys(o.idTokens).map((function(e){return o.idTokens[e]})),n=i.length;if(n<1)return null;if(n>1)throw Mc.createMultipleMatchingTokensInCacheError();return i[0]},CacheManager.prototype.readAccessTokenFromCache=function(e,t,r){var o=new ud(r.scopes||[]),i=r.authenticationScheme||Pl.BEARER,n=i&&i.toLowerCase()!==Pl.BEARER.toLowerCase()?Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME:Tl.ACCESS_TOKEN,s={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:n,clientId:e,realm:t.tenantId,target:o.printScopesLowerCase(),tokenType:i,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},a=this.getCredentialsFilteredBy(s),l=Object.keys(a.accessTokens).map((function(e){return a.accessTokens[e]})),c=l.length;if(c<1)return null;if(c>1)throw Mc.createMultipleMatchingTokensInCacheError();return l[0]},CacheManager.prototype.readRefreshTokenFromCache=function(e,t,r){var o=r?"1":void 0,i={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:Tl.REFRESH_TOKEN,clientId:e,familyId:o},n=this.getCredentialsFilteredBy(i),s=Object.keys(n.refreshTokens).map((function(e){return n.refreshTokens[e]}));return s.length<1?null:s[0]},CacheManager.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},o=this.getAppMetadataFilteredBy(r),i=Object.keys(o).map((function(e){return o[e]})),n=i.length;if(n<1)return null;if(n>1)throw Mc.createMultipleMatchingAppMetadataInCacheError();return i[0]},CacheManager.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||"1"!==r.familyId)},CacheManager.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},CacheManager.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},CacheManager.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},CacheManager.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},CacheManager.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},CacheManager.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},CacheManager.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},CacheManager.prototype.matchTarget=function(e,t){if(e.credentialType!==Tl.ACCESS_TOKEN&&e.credentialType!==Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var r=ud.fromString(e.target),o=ud.fromString(t);return o.containsOnlyOIDCScopes()?o.removeScope(fl.OFFLINE_ACCESS_SCOPE):o.removeOIDCScopes(),r.containsScopeSet(o)},CacheManager.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},CacheManager.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},CacheManager.prototype.isAppMetadata=function(e){return-1!==e.indexOf("appmetadata")},CacheManager.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(xl)},CacheManager.prototype.generateAuthorityMetadataCacheKey=function(e){return xl+"-"+this.clientId+"-"+e},CacheManager.prototype.getSpecificCredential=function(e,t){switch(t){case Tl.ID_TOKEN:return this.getIdTokenCredential(e);case Tl.ACCESS_TOKEN:case Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case Tl.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},CacheManager.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},CacheManager}(),gd=function(e){function DefaultStorageClass(){return null!==e&&e.apply(this,arguments)||this}return __extends(DefaultStorageClass,e),DefaultStorageClass.prototype.setAccount=function(){throw Gl.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccount=function(){throw Gl.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setIdTokenCredential=function(){throw Gl.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getIdTokenCredential=function(){throw Gl.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAccessTokenCredential=function(){throw Gl.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccessTokenCredential=function(){throw Gl.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setRefreshTokenCredential=function(){throw Gl.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getRefreshTokenCredential=function(){throw Gl.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAppMetadata=function(){throw Gl.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAppMetadata=function(){throw Gl.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setServerTelemetry=function(){throw Gl.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getServerTelemetry=function(){throw Gl.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAuthorityMetadata=function(){throw Gl.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadata=function(){throw Gl.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadataKeys=function(){throw Gl.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setThrottlingCache=function(){throw Gl.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getThrottlingCache=function(){throw Gl.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.removeItem=function(){throw Gl.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.containsKey=function(){throw Gl.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getKeys=function(){throw Gl.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.clear=function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",Gl.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},DefaultStorageClass.prototype.updateCredentialCacheKey=function(){throw Gl.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass}(fd),md={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1,proxyUrl:fl.EMPTY_STRING},vd={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:jl.Info,correlationId:fl.EMPTY_STRING},bd={sendGetRequestAsync:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",Gl.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",Gl.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},yd={sku:fl.SKU,version:"7.0.0",cpu:fl.EMPTY_STRING,os:fl.EMPTY_STRING},wd={clientSecret:fl.EMPTY_STRING,clientAssertion:void 0},Cd={azureCloudInstance:Uc.None,tenant:""+fl.DEFAULT_COMMON_TENANT},kd={application:{appName:"",appVersion:""}};
/*! @azure/msal-common v7.0.0 2022-06-13 */
/*! @azure/msal-common v7.0.0 2022-06-13 */
var Td,_d=function(e){function ServerError(t,r,o){var i=e.call(this,t,r,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,ServerError.prototype),i}return __extends(ServerError,e),ServerError}(Gl),Sd=function(){function ThrottlingUtils(){}return ThrottlingUtils.generateThrottlingStorageKey=function(e){return Hl+"."+JSON.stringify(e)},ThrottlingUtils.preProcess=function(e,t){var r,o=ThrottlingUtils.generateThrottlingStorageKey(t),i=e.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void e.removeItem(o,_l.THROTTLING);throw new _d((null===(r=i.errorCodes)||void 0===r?void 0:r.join(" "))||fl.EMPTY_STRING,i.errorMessage,i.subError)}},ThrottlingUtils.postProcess=function(e,t,r){if(ThrottlingUtils.checkResponseStatus(r)||ThrottlingUtils.checkResponseForRetryAfter(r)){var o={throttleTime:ThrottlingUtils.calculateThrottleTime(parseInt(r.headers[cl.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(ThrottlingUtils.generateThrottlingStorageKey(t),o)}},ThrottlingUtils.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},ThrottlingUtils.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(cl.RETRY_AFTER)&&(e.status<200||e.status>=300))},ThrottlingUtils.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||Ul),r+Fl))},ThrottlingUtils.removeThrottle=function(e,t,r,o){var i={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:o,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},n=this.generateThrottlingStorageKey(i);return e.removeItem(n,_l.THROTTLING)},ThrottlingUtils}(),Ed=function(){function NetworkManager(e,t){this.networkClient=e,this.cacheManager=t}return NetworkManager.prototype.sendPostRequest=function(e,t,r){return __awaiter$2(this,void 0,void 0,(function(){var o,i;return __generator(this,(function(n){switch(n.label){case 0:Sd.preProcess(this.cacheManager,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return o=n.sent(),[3,4];case 3:throw(i=n.sent())instanceof Gl?i:Mc.createNetworkError(t,i);case 4:return Sd.postProcess(this.cacheManager,e,o),[2,o]}}))}))},NetworkManager}();
/*! @azure/msal-common v7.0.0 2022-06-13 */!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(Td||(Td={}));
/*! @azure/msal-common v7.0.0 2022-06-13 */
var Id,xd=function(){function BaseClient(e){this.config=function buildClientConfiguration(e){var t,r=e.authOptions,o=e.systemOptions,i=e.loggerOptions,n=e.storageInterface,s=e.networkInterface,a=e.cryptoInterface,l=e.clientCredentials,c=e.libraryInfo,d=e.telemetry,u=e.serverTelemetryManager,h=e.persistencePlugin,p=e.serializableCache,f=__assign(__assign({},vd),i);return{authOptions:(t=r,__assign({clientCapabilities:[],azureCloudOptions:Cd},t)),systemOptions:__assign(__assign({},md),o),loggerOptions:f,storageInterface:n||new gd(r.clientId,Kl),networkInterface:s||bd,cryptoInterface:a||Kl,clientCredentials:l||wd,libraryInfo:__assign(__assign({},yd),c),telemetry:__assign(__assign({},kd),d),serverTelemetryManager:u||null,persistencePlugin:h||null,serializableCache:p||null}}(e),this.logger=new Fc(this.config.loggerOptions,"@azure/msal-common","7.0.0"),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Ed(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return BaseClient.prototype.createTokenRequestHeaders=function(e){var t={};if(t[cl.CONTENT_TYPE]=fl.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Td.HOME_ACCOUNT_ID:try{var r=buildClientInfoFromHomeAccountId(e.credential);t[cl.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Td.UPN:t[cl.CCS_HEADER]="UPN: "+e.credential}return t},BaseClient.prototype.executePostToTokenEndpoint=function(e,t,r,o){return __awaiter$2(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.networkManager.sendPostRequest(o,e,{body:t,headers:r,proxyUrl:this.config.systemOptions.proxyUrl})];case 1:return i=n.sent(),this.config.serverTelemetryManager&&i.status<500&&429!==i.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,i]}}))}))},BaseClient.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw Mc.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},BaseClient}(),Ad=function(){function RequestValidator(){}return RequestValidator.validateRedirectUri=function(e){if($c.isEmpty(e))throw dd.createRedirectUriEmptyError()},RequestValidator.validatePrompt=function(e){var t=[];for(var r in bl)t.push(bl[r]);if(t.indexOf(e)<0)throw dd.createInvalidPromptError(e)},RequestValidator.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw dd.createInvalidClaimsRequestError()}},RequestValidator.validateCodeChallengeParams=function(e,t){if($c.isEmpty(e)||$c.isEmpty(t))throw dd.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},RequestValidator.validateCodeChallengeMethod=function(e){if([El.PLAIN,El.S256].indexOf(e)<0)throw dd.createInvalidCodeChallengeMethodError()},RequestValidator.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},RequestValidator}(),Pd=function(){function RequestParameterBuilder(){this.parameters=new Map}return RequestParameterBuilder.prototype.addResponseTypeCode=function(){this.parameters.set(hl.RESPONSE_TYPE,encodeURIComponent(fl.CODE_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(hl.RESPONSE_TYPE,encodeURIComponent(fl.TOKEN_RESPONSE_TYPE+" "+fl.ID_TOKEN_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseMode=function(e){this.parameters.set(hl.RESPONSE_MODE,encodeURIComponent(e||yl.QUERY))},RequestParameterBuilder.prototype.addNativeBroker=function(){this.parameters.set(hl.NATIVE_BROKER,encodeURIComponent("1"))},RequestParameterBuilder.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?__spreadArrays(e||[],gl):e||[],o=new ud(r);this.parameters.set(hl.SCOPE,encodeURIComponent(o.printScopes()))},RequestParameterBuilder.prototype.addClientId=function(e){this.parameters.set(hl.CLIENT_ID,encodeURIComponent(e))},RequestParameterBuilder.prototype.addRedirectUri=function(e){Ad.validateRedirectUri(e),this.parameters.set(hl.REDIRECT_URI,encodeURIComponent(e))},RequestParameterBuilder.prototype.addPostLogoutRedirectUri=function(e){Ad.validateRedirectUri(e),this.parameters.set(hl.POST_LOGOUT_URI,encodeURIComponent(e))},RequestParameterBuilder.prototype.addIdTokenHint=function(e){this.parameters.set(hl.ID_TOKEN_HINT,encodeURIComponent(e))},RequestParameterBuilder.prototype.addDomainHint=function(e){this.parameters.set(vl.DOMAIN_HINT,encodeURIComponent(e))},RequestParameterBuilder.prototype.addLoginHint=function(e){this.parameters.set(vl.LOGIN_HINT,encodeURIComponent(e))},RequestParameterBuilder.prototype.addCcsUpn=function(e){this.parameters.set(cl.CCS_HEADER,encodeURIComponent("UPN:"+e))},RequestParameterBuilder.prototype.addCcsOid=function(e){this.parameters.set(cl.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},RequestParameterBuilder.prototype.addSid=function(e){this.parameters.set(vl.SID,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Ad.validateClaims(r),this.parameters.set(hl.CLAIMS,encodeURIComponent(r))},RequestParameterBuilder.prototype.addCorrelationId=function(e){this.parameters.set(hl.CLIENT_REQUEST_ID,encodeURIComponent(e))},RequestParameterBuilder.prototype.addLibraryInfo=function(e){this.parameters.set(hl.X_CLIENT_SKU,e.sku),this.parameters.set(hl.X_CLIENT_VER,e.version),e.os&&this.parameters.set(hl.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(hl.X_CLIENT_CPU,e.cpu)},RequestParameterBuilder.prototype.addApplicationTelemetry=function(e){(null==e?void 0:e.appName)&&this.parameters.set(hl.X_APP_NAME,e.appName),(null==e?void 0:e.appVersion)&&this.parameters.set(hl.X_APP_VER,e.appVersion)},RequestParameterBuilder.prototype.addPrompt=function(e){Ad.validatePrompt(e),this.parameters.set(""+hl.PROMPT,encodeURIComponent(e))},RequestParameterBuilder.prototype.addState=function(e){$c.isEmpty(e)||this.parameters.set(hl.STATE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addNonce=function(e){this.parameters.set(hl.NONCE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addCodeChallengeParams=function(e,t){if(Ad.validateCodeChallengeParams(e,t),!e||!t)throw dd.createInvalidCodeChallengeParamsError();this.parameters.set(hl.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(hl.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},RequestParameterBuilder.prototype.addAuthorizationCode=function(e){this.parameters.set(hl.CODE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addDeviceCode=function(e){this.parameters.set(hl.DEVICE_CODE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addRefreshToken=function(e){this.parameters.set(hl.REFRESH_TOKEN,encodeURIComponent(e))},RequestParameterBuilder.prototype.addCodeVerifier=function(e){this.parameters.set(hl.CODE_VERIFIER,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClientSecret=function(e){this.parameters.set(hl.CLIENT_SECRET,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClientAssertion=function(e){$c.isEmpty(e)||this.parameters.set(hl.CLIENT_ASSERTION,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClientAssertionType=function(e){$c.isEmpty(e)||this.parameters.set(hl.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addOboAssertion=function(e){this.parameters.set(hl.OBO_ASSERTION,encodeURIComponent(e))},RequestParameterBuilder.prototype.addRequestTokenUse=function(e){this.parameters.set(hl.REQUESTED_TOKEN_USE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addGrantType=function(e){this.parameters.set(hl.GRANT_TYPE,encodeURIComponent(e))},RequestParameterBuilder.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},RequestParameterBuilder.prototype.addExtraQueryParameters=function(e){var t=this;Ad.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},RequestParameterBuilder.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw dd.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(pl.ACCESS_TOKEN)||(r[pl.ACCESS_TOKEN]={}),r[pl.ACCESS_TOKEN][pl.XMS_CC]={values:t}),JSON.stringify(r)},RequestParameterBuilder.prototype.addUsername=function(e){this.parameters.set(Ol.username,encodeURIComponent(e))},RequestParameterBuilder.prototype.addPassword=function(e){this.parameters.set(Ol.password,encodeURIComponent(e))},RequestParameterBuilder.prototype.addPopToken=function(e){$c.isEmpty(e)||(this.parameters.set(hl.TOKEN_TYPE,Pl.POP),this.parameters.set(hl.REQ_CNF,encodeURIComponent(e)))},RequestParameterBuilder.prototype.addSshJwk=function(e){$c.isEmpty(e)||(this.parameters.set(hl.TOKEN_TYPE,Pl.SSH),this.parameters.set(hl.REQ_CNF,encodeURIComponent(e)))},RequestParameterBuilder.prototype.addServerTelemetry=function(e){this.parameters.set(hl.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(hl.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},RequestParameterBuilder.prototype.addThrottling=function(){this.parameters.set(hl.X_MS_LIB_CAPABILITY,Bl)},RequestParameterBuilder.prototype.addLogoutHint=function(e){this.parameters.set(hl.LOGOUT_HINT,encodeURIComponent(e))},RequestParameterBuilder.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},RequestParameterBuilder}(),Rd=function(e){function IdTokenEntity(){return null!==e&&e.apply(this,arguments)||this}return __extends(IdTokenEntity,e),IdTokenEntity.createIdTokenEntity=function(e,t,r,o,i){var n=new IdTokenEntity;return n.credentialType=Tl.ID_TOKEN,n.homeAccountId=e,n.environment=t,n.clientId=o,n.secret=r,n.realm=i,n},IdTokenEntity.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Tl.ID_TOKEN)},IdTokenEntity}(Bc),Od=function(){function TimeUtils(){}return TimeUtils.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.isTokenExpired=function(e,t){var r=Number(e)||0;return TimeUtils.nowSeconds()+t>r},TimeUtils.wasClockTurnedBack=function(e){return Number(e)>TimeUtils.nowSeconds()},TimeUtils.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},TimeUtils}(),Nd=function(e){function AccessTokenEntity(){return null!==e&&e.apply(this,arguments)||this}return __extends(AccessTokenEntity,e),AccessTokenEntity.createAccessTokenEntity=function(e,t,r,o,i,n,s,a,l,c,d,u,h,p,f){var g,m,v=new AccessTokenEntity;v.homeAccountId=e,v.credentialType=Tl.ACCESS_TOKEN,v.secret=r;var b=Od.nowSeconds();if(v.cachedAt=b.toString(),v.expiresOn=s.toString(),v.extendedExpiresOn=a.toString(),c&&(v.refreshOn=c.toString()),v.environment=t,v.clientId=o,v.realm=i,v.target=n,v.userAssertionHash=u,v.tokenType=$c.isEmpty(d)?Pl.BEARER:d,p&&(v.requestedClaims=p,v.requestedClaimsHash=f),(null===(g=v.tokenType)||void 0===g?void 0:g.toLowerCase())!==Pl.BEARER.toLowerCase())switch(v.credentialType=Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME,v.tokenType){case Pl.POP:var y=pd.extractTokenClaims(r,l);if(!(null===(m=null==y?void 0:y.cnf)||void 0===m?void 0:m.kid))throw Mc.createTokenClaimsRequiredError();v.keyId=y.cnf.kid;break;case Pl.SSH:v.keyId=h}return v},AccessTokenEntity.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===Tl.ACCESS_TOKEN||e.credentialType===Tl.ACCESS_TOKEN_WITH_AUTH_SCHEME))},AccessTokenEntity}(Bc),Dd=function(e){function RefreshTokenEntity(){return null!==e&&e.apply(this,arguments)||this}return __extends(RefreshTokenEntity,e),RefreshTokenEntity.createRefreshTokenEntity=function(e,t,r,o,i,n){var s=new RefreshTokenEntity;return s.clientId=o,s.credentialType=Tl.REFRESH_TOKEN,s.environment=t,s.homeAccountId=e,s.secret=r,s.userAssertionHash=n,i&&(s.familyId=i),s},RefreshTokenEntity.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Tl.REFRESH_TOKEN)},RefreshTokenEntity}(Bc),Ld=["interaction_required","consent_required","login_required"],Md=["message_only","additional_action","basic_action","user_password_expired","consent_required"],$d={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},Ud=function(e){function InteractionRequiredAuthError(t,r,o){var i=e.call(this,t,r,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,InteractionRequiredAuthError.prototype),i}return __extends(InteractionRequiredAuthError,e),InteractionRequiredAuthError.isInteractionRequiredError=function(e,t,r){var o=!!e&&Ld.indexOf(e)>-1,i=!!r&&Md.indexOf(r)>-1,n=!!t&&Ld.some((function(e){return t.indexOf(e)>-1}));return o||n||i},InteractionRequiredAuthError.createNoTokensFoundError=function(){return new InteractionRequiredAuthError($d.code,$d.desc)},InteractionRequiredAuthError}(Gl),Fd=function Fd(e,t,r,o,i){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=o||null,this.appMetadata=i||null},Hd=function(){function ProtocolUtils(){}return ProtocolUtils.setRequestState=function(e,t,r){var o=ProtocolUtils.generateLibraryState(e,r);return $c.isEmpty(t)?o:""+o+fl.RESOURCE_DELIM+t},ProtocolUtils.generateLibraryState=function(e,t){if(!e)throw Mc.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var o=JSON.stringify(r);return e.base64Encode(o)},ProtocolUtils.parseRequestState=function(e,t){if(!e)throw Mc.createNoCryptoObjectError("parseRequestState");if($c.isEmpty(t))throw Mc.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(fl.RESOURCE_DELIM),o=r[0],i=r.length>1?r.slice(1).join(fl.RESOURCE_DELIM):fl.EMPTY_STRING,n=e.base64Decode(o),s=JSON.parse(n);return{userRequestState:$c.isEmpty(i)?fl.EMPTY_STRING:i,libraryState:s}}catch(e){throw Mc.createInvalidStateError(t,e)}},ProtocolUtils}(),Bd=function(){function UrlString(e){if(this._urlString=e,$c.isEmpty(this._urlString))throw dd.createUrlEmptyError();$c.isEmpty(this.getHash())&&(this._urlString=UrlString.canonicalizeUri(e))}return Object.defineProperty(UrlString.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),UrlString.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return $c.endsWith(t,"?")?t=t.slice(0,-1):$c.endsWith(t,"?/")&&(t=t.slice(0,-2)),$c.endsWith(t,"/")||(t+="/"),t}return e},UrlString.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw dd.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw dd.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw dd.createInsecureAuthorityUriError(this.urlString)},UrlString.appendQueryString=function(e,t){return $c.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},UrlString.removeHashFromUrl=function(e){return UrlString.canonicalizeUri(e.split("#")[0])},UrlString.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==ul.COMMON&&r[0]!==ul.ORGANIZATIONS||(r[0]=e),UrlString.constructAuthorityUriFromObject(t)},UrlString.prototype.getHash=function(){return UrlString.parseHash(this.urlString)},UrlString.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw dd.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=r.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),r.PathSegments=o,!$c.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},UrlString.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw dd.createUrlParseError("Given url string: "+e);return r[2]},UrlString.getAbsoluteUrl=function(e,t){if(e[0]===fl.FORWARD_SLASH){var r=new UrlString(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e},UrlString.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):fl.EMPTY_STRING},UrlString.constructAuthorityUriFromObject=function(e){return new UrlString(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},UrlString.getDeserializedHash=function(e){if($c.isEmpty(e))return{};var t=UrlString.parseHash(e),r=$c.queryStringToObject($c.isEmpty(t)?e:t);if(!r)throw Mc.createHashNotDeserializedError(JSON.stringify(r));return r},UrlString.hashContainsKnownProperties=function(e){if($c.isEmpty(e)||e.indexOf("=")<0)return!1;var t=UrlString.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},UrlString}();
/*! @azure/msal-common v7.0.0 2022-06-13 */!function(e){e.SW="sw",e.UHW="uhw"}(Id||(Id={}));var qd,zd=function(){function PopTokenGenerator(e){this.cryptoUtils=e}return PopTokenGenerator.prototype.generateCnf=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r,o;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.generateKid(e)];case 1:return t=i.sent(),r=this.cryptoUtils.base64Encode(JSON.stringify(t)),o={kid:t.kid,reqCnfString:r},[4,this.cryptoUtils.hashString(r)];case 2:return[2,(o.reqCnfHash=i.sent(),o)]}}))}))},PopTokenGenerator.prototype.generateKid=function(e){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:t.sent(),xms_ksl:Id.SW}]}}))}))},PopTokenGenerator.prototype.signPopToken=function(e,t,r){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(o){return[2,this.signPayload(e,t,r)]}))}))},PopTokenGenerator.prototype.signPayload=function(e,t,r,o){return __awaiter$2(this,void 0,void 0,(function(){var i,n,s,a,l,c;return __generator(this,(function(d){switch(d.label){case 0:return i=r.resourceRequestMethod,n=r.resourceRequestUri,s=r.shrClaims,a=r.shrNonce,l=n?new Bd(n):void 0,c=null==l?void 0:l.getUrlComponents(),[4,this.cryptoUtils.signJwt(__assign({at:e,ts:Od.nowSeconds(),m:null==i?void 0:i.toUpperCase(),u:null==c?void 0:c.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:null==c?void 0:c.AbsolutePath,q:(null==c?void 0:c.QueryString)?[[],c.QueryString]:void 0,client_claims:s||void 0},o),t,r.correlationId)];case 1:return[2,d.sent()]}}))}))},PopTokenGenerator}(),jd=function(){function AppMetadataEntity(){}return AppMetadataEntity.prototype.generateAppMetadataKey=function(){return AppMetadataEntity.generateAppMetadataCacheKey(this.environment,this.clientId)},AppMetadataEntity.generateAppMetadataCacheKey=function(e,t){return["appmetadata",e,t].join(kl.CACHE_KEY_SEPARATOR).toLowerCase()},AppMetadataEntity.createAppMetadataEntity=function(e,t,r){var o=new AppMetadataEntity;return o.clientId=e,o.environment=t,r&&(o.familyId=r),o},AppMetadataEntity.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf("appmetadata")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},AppMetadataEntity}(),Vd=function(){function TokenCacheContext(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(TokenCacheContext.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(TokenCacheContext.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),TokenCacheContext}(),Gd=function(){function ResponseHandler(e,t,r,o,i,n){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=o,this.serializableCache=i,this.persistencePlugin=n}return ResponseHandler.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?Mc.createStateNotFoundError("Cached State"):Mc.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw Mc.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Ud.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ud(e.error||fl.EMPTY_STRING,e.error_description,e.suberror);throw new _d(e.error||fl.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&buildClientInfo(e.client_info,r)},ResponseHandler.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Ud.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Ud(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new _d(e.error,t,e.suberror)}},ResponseHandler.prototype.handleServerTokenResponse=function(e,t,r,o,i,n,s){return __awaiter$2(this,void 0,void 0,(function(){var a,l,c,d,u;return __generator(this,(function(h){switch(h.label){case 0:if(e.id_token&&(a=new pd(e.id_token||fl.EMPTY_STRING,this.cryptoObj),i&&!$c.isEmpty(i.nonce)&&a.claims.nonce!==i.nonce))throw Mc.createNonceMismatchError();this.homeAccountIdentifier=hd.generateHomeAccountId(e.client_info||fl.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,a),i&&i.state&&(l=Hd.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0,c=this.generateCacheRecord(e,t,r,o,a,n,i),h.label=1;case 1:return h.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),d=new Vd(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(d)]):[3,3];case 2:h.sent(),h.label=3;case 3:return!s||!c.account||(u=c.account.generateAccountKey(),this.cacheStorage.getAccount(u))?[4,this.cacheStorage.saveCacheRecord(c)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,t,c,!1,o,a,l)]);case 4:return h.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&d?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(d)]):[3,7];case 6:h.sent(),h.label=7;case 7:return[7];case 8:return[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,t,c,!1,o,a,l,e.spa_code)]}}))}))},ResponseHandler.prototype.generateCacheRecord=function(e,t,r,o,i,n,s){var a,l,c=t.getPreferredCache();if($c.isEmpty(c))throw Mc.createInvalidCacheEnvironmentError();!$c.isEmpty(e.id_token)&&i&&(a=Rd.createIdTokenEntity(this.homeAccountIdentifier,c,e.id_token||fl.EMPTY_STRING,this.clientId,i.claims.tid||fl.EMPTY_STRING),l=this.generateAccountEntity(e,i,t,s));var d=null;if(!$c.isEmpty(e.access_token)){var u=e.scope?ud.fromString(e.scope):new ud(o.scopes||[]),h=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,p=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,f=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,g=r+h,m=g+p,v=f&&f>0?r+f:void 0;d=Nd.createAccessTokenEntity(this.homeAccountIdentifier,c,e.access_token||fl.EMPTY_STRING,this.clientId,i?i.claims.tid||fl.EMPTY_STRING:t.tenant,u.printScopes(),g,m,this.cryptoObj,v,e.token_type,n,e.key_id,o.claims,o.requestedClaimsHash)}var b=null;$c.isEmpty(e.refresh_token)||(b=Dd.createRefreshTokenEntity(this.homeAccountIdentifier,c,e.refresh_token||fl.EMPTY_STRING,this.clientId,e.foci,n));var y=null;return $c.isEmpty(e.foci)||(y=jd.createAppMetadataEntity(this.clientId,c,e.foci)),new Fd(l,a,d,b,y)},ResponseHandler.prototype.generateAccountEntity=function(e,t,r,o){var i=r.authorityType,n=o?o.cloud_graph_host_name:fl.EMPTY_STRING,s=o?o.msgraph_host:fl.EMPTY_STRING;if(i===Hc.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),hd.createGenericAccount(this.homeAccountIdentifier,t,r,n,s);if($c.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw Mc.createClientInfoEmptyError();return e.client_info?hd.createAccount(e.client_info,this.homeAccountIdentifier,t,r,n,s):hd.createGenericAccount(this.homeAccountIdentifier,t,r,n,s)},ResponseHandler.generateAuthenticationResult=function(e,t,r,o,i,n,s,a){var l,c,d;return __awaiter$2(this,void 0,void 0,(function(){var u,h,p,f,g,m,v,b,y,w,k;return __generator(this,(function(T){switch(T.label){case 0:if(u=fl.EMPTY_STRING,h=[],p=null,g=fl.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==Pl.POP)return[3,2];if(m=new zd(e),v=r.accessToken,b=v.secret,!(y=v.keyId))throw Mc.createKeyIdMissingError();return[4,m.signPopToken(b,y,i)];case 1:return u=T.sent(),[3,3];case 2:u=r.accessToken.secret,T.label=3;case 3:h=ud.fromString(r.accessToken.target).asArray(),p=new Date(1e3*Number(r.accessToken.expiresOn)),f=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),T.label=4;case 4:return r.appMetadata&&(g="1"===r.appMetadata.familyId?"1":fl.EMPTY_STRING),w=(null==n?void 0:n.claims.oid)||(null==n?void 0:n.claims.sub)||fl.EMPTY_STRING,k=(null==n?void 0:n.claims.tid)||fl.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:w,tenantId:k,scopes:h,account:r.account?r.account.getAccountInfo():null,idToken:n?n.rawToken:fl.EMPTY_STRING,idTokenClaims:n?n.claims:{},accessToken:u,fromCache:o,expiresOn:p,correlationId:i.correlationId,extExpiresOn:f,familyId:g,tokenType:(null===(l=r.accessToken)||void 0===l?void 0:l.tokenType)||fl.EMPTY_STRING,state:s?s.userRequestState:fl.EMPTY_STRING,cloudGraphHostName:(null===(c=r.account)||void 0===c?void 0:c.cloudGraphHostName)||fl.EMPTY_STRING,msGraphHost:(null===(d=r.account)||void 0===d?void 0:d.msGraphHost)||fl.EMPTY_STRING,code:a,fromNativeBroker:!1}]}}))}))},ResponseHandler}(),Kd=function(e){function AuthorizationCodeClient(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!0,r}return __extends(AuthorizationCodeClient,e),AuthorizationCodeClient.prototype.getAuthCodeUrl=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this.createAuthCodeUrlQueryString(e)];case 1:return t=r.sent(),[2,Bd.appendQueryString(this.authority.authorizationEndpoint,t)]}}))}))},AuthorizationCodeClient.prototype.acquireToken=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){var r,o,i;return __generator(this,(function(n){switch(n.label){case 0:if(this.logger.info("in acquireToken call"),!e||$c.isEmpty(e.code))throw Mc.createTokenRequestCannotBeMadeError();return r=Od.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return o=n.sent(),(i=new Gd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,r,e,t)];case 2:return[2,n.sent()]}}))}))},AuthorizationCodeClient.prototype.handleFragmentResponse=function(e,t){var r=new Gd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),o=new Bd(e),i=Bd.getDeserializedHash(o.getHash());if(r.validateServerAuthorizationCodeResponse(i,t,this.cryptoUtils),!i.code)throw Mc.createNoAuthCodeInServerResponseError();return __assign(__assign({},i),{code:i.code})},AuthorizationCodeClient.prototype.getLogoutUri=function(e){if(!e)throw dd.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return Bd.appendQueryString(this.authority.endSessionEndpoint,t)},AuthorizationCodeClient.prototype.executeTokenRequest=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){var r,o,i,n,s,a,l;return __generator(this,(function(c){switch(c.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[4,this.createTokenRequestBody(t)];case 1:if(o=c.sent(),i=this.createTokenQueryParameters(t),n=void 0,t.clientInfo)try{s=buildClientInfo(t.clientInfo,this.cryptoUtils),n={credential:""+s.uid+kl.CLIENT_INFO_SEPARATOR+s.utid,type:Td.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return a=this.createTokenRequestHeaders(n||t.ccsCredential),l=$c.isEmpty(i)?e.tokenEndpoint:e.tokenEndpoint+"?"+i,[2,this.executePostToTokenEndpoint(l,o,a,r)]}}))}))},AuthorizationCodeClient.prototype.createTokenQueryParameters=function(e){var t=new Pd;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},AuthorizationCodeClient.prototype.createTokenRequestBody=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r,o,i,n,s,a;return __generator(this,(function(l){switch(l.label){case 0:return(t=new Pd).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Ad.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(wl.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme!==Pl.POP?[3,2]:[4,new zd(this.cryptoUtils).generateCnf(e)];case 1:return o=l.sent(),t.addPopToken(o.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Pl.SSH){if(!e.sshJwk)throw dd.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}l.label=3;case 3:if(i=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(i),(!$c.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),n=void 0,e.clientInfo)try{s=buildClientInfo(e.clientInfo,this.cryptoUtils),n={credential:""+s.uid+kl.CLIENT_INFO_SEPARATOR+s.utid,type:Td.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case Td.HOME_ACCOUNT_ID:try{s=buildClientInfoFromHomeAccountId(n.credential),t.addCcsOid(s)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Td.UPN:t.addCcsUpn(n.credential)}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[hl.RETURN_SPA_CODE]||t.addExtraQueryParameters(((a={})[hl.RETURN_SPA_CODE]="1",a)),[2,t.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createAuthCodeUrlQueryString=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r,o,i,n,s;return __generator(this,(function(a){switch(a.label){case 0:if((t=new Pd).addClientId(this.config.authOptions.clientId),r=__spreadArrays(e.scopes||[],e.extraScopesToConsent||[]),t.addScopes(r),t.addRedirectUri(e.redirectUri),o=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==bl.SELECT_ACCOUNT)if(e.sid&&e.prompt===bl.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){if((i=this.extractAccountSid(e.account))&&e.prompt===bl.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(i);try{n=buildClientInfoFromHomeAccountId(e.account.homeAccountId),t.addCcsOid(n)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{n=buildClientInfoFromHomeAccountId(e.account.homeAccountId),t.addCcsOid(n)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!$c.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(t.addNativeBroker(),e.authenticationScheme!==Pl.POP?[3,2]:[4,new zd(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:s=a.sent(),t.addPopToken(s.reqCnfHash),a.label=2;case 2:return[2,t.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createLogoutUrlQueryString=function(e){var t=new Pd;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},AuthorizationCodeClient.prototype.extractAccountSid=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},AuthorizationCodeClient}(xd),Wd=function(e){function RefreshTokenClient(t){return e.call(this,t)||this}return __extends(RefreshTokenClient,e),RefreshTokenClient.prototype.acquireToken=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r,o;return __generator(this,(function(i){switch(i.label){case 0:return t=Od.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return r=i.sent(),(o=new Gd(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,o.handleServerTokenResponse(r.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},RefreshTokenClient.prototype.acquireTokenByRefreshToken=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r;return __generator(this,(function(o){if(!e)throw dd.createEmptyTokenRequestError();if(!e.account)throw Mc.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(o){if(t=o instanceof Ud&&o.errorCode===$d.code,r=o instanceof _d&&o.errorCode===ql&&o.subError===zl,t||r)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw o}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},RefreshTokenClient.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){var r,o;return __generator(this,(function(i){if(!(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw Ud.createNoTokensFoundError();return o=__assign(__assign({},e),{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Pl.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Td.HOME_ACCOUNT_ID}}),[2,this.acquireToken(o)]}))}))},RefreshTokenClient.prototype.executeTokenRequest=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){var r,o,i,n,s;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return r=a.sent(),o=this.createTokenQueryParameters(e),i=this.createTokenRequestHeaders(e.ccsCredential),n={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},s=Bd.appendQueryString(t.tokenEndpoint,o),[2,this.executePostToTokenEndpoint(s,r,i,n)]}}))}))},RefreshTokenClient.prototype.createTokenQueryParameters=function(e){var t=new Pd;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},RefreshTokenClient.prototype.createTokenRequestBody=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t,r,o,i,n;return __generator(this,(function(s){switch(s.label){case 0:return(t=new Pd).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(wl.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,t.addClientAssertion(o.assertion),t.addClientAssertionType(o.assertionType)),e.authenticationScheme!==Pl.POP?[3,2]:[4,new zd(this.cryptoUtils).generateCnf(e)];case 1:return i=s.sent(),t.addPopToken(i.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Pl.SSH){if(!e.sshJwk)throw dd.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}s.label=3;case 3:if((!$c.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Td.HOME_ACCOUNT_ID:try{n=buildClientInfoFromHomeAccountId(e.ccsCredential.credential),t.addCcsOid(n)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Td.UPN:t.addCcsUpn(e.ccsCredential.credential)}return[2,t.createQueryString()]}}))}))},RefreshTokenClient}(xd),Qd=function(e){function SilentFlowClient(t){return e.call(this,t)||this}return __extends(SilentFlowClient,e),SilentFlowClient.prototype.acquireToken=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof Mc&&t.errorCode===Ac.code)return[2,new Wd(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},SilentFlowClient.prototype.acquireCachedToken=function(e){var t,r,o,i;return __awaiter$2(this,void 0,void 0,(function(){var n,s;return __generator(this,(function(a){switch(a.label){case 0:if(!e)throw dd.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(Ml.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),Mc.createRefreshRequiredError();if(!e.account)throw Mc.createNoAccountInSilentRequestError();if(n=e.authority||this.authority.getPreferredCache(),!(s=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,e,n)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(Ml.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),Mc.createRefreshRequiredError();if(Od.wasClockTurnedBack(s.accessToken.cachedAt)||Od.isTokenExpired(s.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(Ml.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),Mc.createRefreshRequiredError();if(s.accessToken.refreshOn&&Od.isTokenExpired(s.accessToken.refreshOn,0))throw null===(i=this.serverTelemetryManager)||void 0===i||i.setCacheOutcome(Ml.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),Mc.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(s,e)];case 1:return[2,a.sent()]}}))}))},SilentFlowClient.prototype.generateResultFromCacheRecord=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){var r;return __generator(this,(function(o){switch(o.label){case 0:return e.idToken&&(r=new pd(e.idToken.secret,this.config.cryptoInterface)),[4,Gd.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,o.sent()]}}))}))},SilentFlowClient}(xd);
/*! @azure/msal-common v7.0.0 2022-06-13 */
/*! @azure/msal-common v7.0.0 2022-06-13 */
function isOpenIdConfigResponse(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")}
/*! @azure/msal-common v7.0.0 2022-06-13 */!function(e){e.AAD="AAD",e.OIDC="OIDC"}(qd||(qd={}));
/*! @azure/msal-common v7.0.0 2022-06-13 */
var Yd=function(){function AuthorityMetadataEntity(){this.expiresAt=Od.nowSeconds()+Al}return AuthorityMetadataEntity.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},AuthorityMetadataEntity.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},AuthorityMetadataEntity.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},AuthorityMetadataEntity.prototype.resetExpiresAt=function(){this.expiresAt=Od.nowSeconds()+Al},AuthorityMetadataEntity.prototype.isExpired=function(){return this.expiresAt<=Od.nowSeconds()},AuthorityMetadataEntity.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(xl)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt"))},AuthorityMetadataEntity}();
/*! @azure/msal-common v7.0.0 2022-06-13 */
/*! @azure/msal-common v7.0.0 2022-06-13 */
var Jd,Zd,Xd=function(){function RegionDiscovery(e){this.networkInterface=e}return RegionDiscovery.prototype.detectRegion=function(e,t,r){return __awaiter$2(this,void 0,void 0,(function(){var o,i,n,s,a;return __generator(this,(function(l){switch(l.label){case 0:if(o=e)return[3,8];i=RegionDiscovery.IMDS_OPTIONS,r&&(i.proxyUrl=r),l.label=1;case 1:return l.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(fl.IMDS_VERSION,i)];case 2:return(n=l.sent()).status===Nl.httpSuccess&&(o=n.body,t.region_source=Dl.IMDS),n.status!==Nl.httpBadRequest?[3,5]:[4,this.getCurrentVersion(i)];case 3:return(s=l.sent())?[4,this.getRegionFromIMDS(s,i)]:(t.region_source=Dl.FAILED_AUTO_DETECTION,[2,null]);case 4:(a=l.sent()).status===Nl.httpSuccess&&(o=a.body,t.region_source=Dl.IMDS),l.label=5;case 5:return[3,7];case 6:return l.sent(),t.region_source=Dl.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=Dl.ENVIRONMENT_VARIABLE,l.label=9;case 9:return o||(t.region_source=Dl.FAILED_AUTO_DETECTION),[2,o||null]}}))}))},RegionDiscovery.prototype.getRegionFromIMDS=function(e,t){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,this.networkInterface.sendGetRequestAsync(fl.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,fl.IMDS_TIMEOUT)]}))}))},RegionDiscovery.prototype.getCurrentVersion=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(fl.IMDS_ENDPOINT+"?format=json",e)];case 1:return(t=r.sent()).status===Nl.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return r.sent(),[2,null];case 3:return[2]}}))}))},RegionDiscovery.IMDS_OPTIONS={headers:{Metadata:"true"}},RegionDiscovery}(),eu=function(){function Authority(e,t,r,o,i){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=o,this.regionDiscovery=new Xd(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.proxyUrl=i||fl.EMPTY_STRING}return Object.defineProperty(Authority.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===fl.ADFS?Hc.Adfs:Hc.Default},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Bd(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw Mc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw Mc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw Mc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Mc.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw Mc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw Mc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Authority.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},Authority.prototype.replacePath=function(e){var t=e,r=new Bd(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,o){var i=r[o];e!==i&&(t=t.replace("/"+i+"/","/"+e+"/"))})),t},Object.defineProperty(Authority.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===Hc.Adfs||this.protocolMode===qd.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),Authority.prototype.discoveryComplete=function(){return!!this.metadata},Authority.prototype.resolveEndpointsAsync=function(){return __awaiter$2(this,void 0,void 0,(function(){var e,t,r,o;return __generator(this,(function(i){switch(i.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new Yd).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=i.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=i.sent(),t!==Il.CACHE&&r!==Il.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e,[2]}}))}))},Authority.prototype.updateEndpointMetadata=function(e){var t;return __awaiter$2(this,void 0,void 0,(function(){var r,o,i;return __generator(this,(function(n){switch(n.label){case 0:return(r=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(r,!1),[2,Il.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,Il.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(r=n.sent())?(null===(t=this.authorityOptions.azureRegionConfiguration)||void 0===t?void 0:t.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata,this.proxyUrl)]:[3,3]:[3,4];case 2:o=n.sent(),i=this.authorityOptions.azureRegionConfiguration.azureRegion===fl.AZURE_REGION_AUTO_DISCOVER_FLAG?o:this.authorityOptions.azureRegionConfiguration.azureRegion,this.authorityOptions.azureRegionConfiguration.azureRegion===fl.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=o?Ll.AUTO_DETECTION_REQUESTED_SUCCESSFUL:Ll.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=o?this.authorityOptions.azureRegionConfiguration.azureRegion===o?Ll.CONFIGURED_MATCHES_DETECTED:Ll.CONFIGURED_NOT_DETECTED:Ll.CONFIGURED_NO_AUTO_DETECTION,i&&(this.regionDiscoveryMetadata.region_used=i,r=Authority.replaceWithRegionalInformation(r,i)),n.label=3;case 3:return e.updateEndpointMetadata(r,!0),[2,Il.NETWORK];case 4:throw Mc.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},Authority.prototype.isAuthoritySameType=function(e){return new Bd(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},Authority.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw dd.createInvalidAuthorityMetadataError()}return null},Authority.prototype.getEndpointMetadataFromNetwork=function(){return __awaiter$2(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(r){switch(r.label){case 0:e={},this.proxyUrl&&(e.proxyUrl=this.proxyUrl),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,e)];case 2:return[2,isOpenIdConfigResponse((t=r.sent()).body)?t.body:null];case 3:return r.sent(),[2,null];case 4:return[2]}}))}))},Authority.prototype.updateCloudDiscoveryMetadata=function(e){return __awaiter$2(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,Il.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,Il.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,Il.NETWORK];throw dd.createUntrustedAuthorityError()}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Authority.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(t)return t}catch(e){throw dd.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},Authority.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return __awaiter$2(this,void 0,void 0,(function(){var e,t,r,o,i;return __generator(this,(function(n){switch(n.label){case 0:e=""+fl.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",t={},this.proxyUrl&&(t.proxyUrl=this.proxyUrl),r=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(e,t)];case 2:return o=n.sent(),i=function isCloudInstanceDiscoveryResponse(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(o.body)?o.body.metadata:[],0===i.length?[2,null]:(r=Authority.getCloudDiscoveryMetadataFromNetworkResponse(i,this.hostnameAndPort),[3,4]);case 3:return n.sent(),[2,null];case 4:return r||(r=Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}}))}))},Authority.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return Bd.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},Authority.generateAuthority=function(e,t){var r;if(t&&t.azureCloudInstance!==Uc.None){var o=t.tenant?t.tenant:fl.DEFAULT_COMMON_TENANT;r=t.azureCloudInstance+"/"+o+"/"}return r||e},Authority.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},Authority.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var o=e[r];if(o.aliases.indexOf(t)>-1)return o}return null},Authority.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw Mc.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},Authority.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},Authority.isPublicCloudAuthority=function(e){return fl.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},Authority.buildRegionalAuthorityString=function(e,t,r){var o=new Bd(e);o.validateAsUri();var i=o.getUrlComponents(),n=t+"."+i.HostNameAndPort;this.isPublicCloudAuthority(i.HostNameAndPort)&&(n=t+"."+fl.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=Bd.constructAuthorityUriFromObject(__assign(__assign({},o.getUrlComponents()),{HostNameAndPort:n})).urlString;return r?s+"?"+r:s},Authority.replaceWithRegionalInformation=function(e,t){return e.authorization_endpoint=Authority.buildRegionalAuthorityString(e.authorization_endpoint,t),e.token_endpoint=Authority.buildRegionalAuthorityString(e.token_endpoint,t,"allowestsrnonmsi=true"),e.end_session_endpoint&&(e.end_session_endpoint=Authority.buildRegionalAuthorityString(e.end_session_endpoint,t)),e},Authority}(),tu=function(){function AuthorityFactory(){}return AuthorityFactory.createDiscoveredInstance=function(e,t,r,o,i){return __awaiter$2(this,void 0,void 0,(function(){var n,s;return __generator(this,(function(a){switch(a.label){case 0:n=AuthorityFactory.createInstance(e,t,r,o,i),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.resolveEndpointsAsync()];case 2:return a.sent(),[2,n];case 3:throw s=a.sent(),Mc.createEndpointDiscoveryIncompleteError(s);case 4:return[2]}}))}))},AuthorityFactory.createInstance=function(e,t,r,o,i){if($c.isEmpty(e))throw dd.createUrlEmptyError();return new eu(e,t,r,o,i)},AuthorityFactory}(),ru=function(){function ServerTelemetryEntity(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return ServerTelemetryEntity.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(Rl.CACHE_KEY),o=!0;return t&&(o=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&o},ServerTelemetryEntity}(),ou=function(){function ThrottlingEntity(){}return ThrottlingEntity.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(Hl));var o=!0;return t&&(o=t.hasOwnProperty("throttleTime")),r&&o},ThrottlingEntity}(),iu={sendGetRequestAsync:function(){return Promise.reject(Gl.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(Gl.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},nu={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},su={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},au=function(e){function JoseHeaderError(t,r){var o=e.call(this,t,r)||this;return o.name="JoseHeaderError",Object.setPrototypeOf(o,JoseHeaderError.prototype),o}return __extends(JoseHeaderError,e),JoseHeaderError.createMissingKidError=function(){return new JoseHeaderError(nu.code,nu.desc)},JoseHeaderError.createMissingAlgError=function(){return new JoseHeaderError(su.code,su.desc)},JoseHeaderError}(Gl),lu=function(){function JoseHeader(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return JoseHeader.getShrHeaderString=function(e){if(!e.kid)throw au.createMissingKidError();if(!e.alg)throw au.createMissingAlgError();var t=new JoseHeader({typ:e.typ||$l.Jwt,kid:e.kid,alg:e.alg});return JSON.stringify(t)},JoseHeader}(),cu=function(){function ServerTelemetryManager(e,t){this.cacheOutcome=Ml.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||fl.EMPTY_STRING,this.wrapperVer=e.wrapperVer||fl.EMPTY_STRING,this.telemetryCacheKey=Rl.CACHE_KEY+kl.CACHE_KEY_SEPARATOR+e.clientId}return ServerTelemetryManager.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+Rl.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(Rl.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(Rl.VALUE_SEPARATOR);return[Rl.SCHEMA_VERSION,r,t].join(Rl.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=ServerTelemetryManager.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(Rl.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(Rl.VALUE_SEPARATOR),i=e.errors.length,n=[i,t<i?Rl.OVERFLOW_TRUE:Rl.OVERFLOW_FALSE].join(Rl.VALUE_SEPARATOR);return[Rl.SCHEMA_VERSION,e.cacheHits,r,o,n].join(Rl.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=Rl.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),$c.isEmpty(e.subError)?$c.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Rl.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},ServerTelemetryManager.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},ServerTelemetryManager.prototype.getLastRequests=function(){var e=new ru;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},ServerTelemetryManager.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=ServerTelemetryManager.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var r=new ru;r.failedRequests=e.failedRequests.slice(2*t),r.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}},ServerTelemetryManager.maxErrorsToSend=function(e){var t,r=0,o=0,i=e.errors.length;for(t=0;t<i;t++){var n=e.failedRequests[2*t]||fl.EMPTY_STRING,s=e.failedRequests[2*t+1]||fl.EMPTY_STRING,a=e.errors[t]||fl.EMPTY_STRING;if(!((o+=n.toString().length+s.toString().length+a.length+3)<Rl.MAX_LAST_HEADER_BYTES))break;r+=1}return r},ServerTelemetryManager.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||fl.EMPTY_STRING),e.push(this.regionSource||fl.EMPTY_STRING),e.push(this.regionOutcome||fl.EMPTY_STRING),e.join(",")},ServerTelemetryManager.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},ServerTelemetryManager.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},ServerTelemetryManager}();
/*! @azure/msal-common v7.0.0 2022-06-13 */!function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken"}(Jd||(Jd={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(Zd||(Zd={}));
/*! @azure/msal-common v7.0.0 2022-06-13 */
var du,uu,hu,pu,fu,gu,mu,vu,bu=function(){function PerformanceClient(e,t,r,o,i,n){this.authority=t,this.libraryName=o,this.libraryVersion=i,this.applicationTelemetry=n,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.measurementsById=new Map}return PerformanceClient.prototype.startMeasurement=function(e,t){var r,o,i=this,n=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",n),this.logger.trace("PerformanceClient: Performance measurement started for "+e,n);var s=this.startPerformanceMeasuremeant(e,n);s.startMeasurement();var a={eventId:this.generateId(),status:Zd.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,appName:null===(r=this.applicationTelemetry)||void 0===r?void 0:r.appName,appVersion:null===(o=this.applicationTelemetry)||void 0===o?void 0:o.appVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:n};return this.cacheEventByCorrelationId(a),this.cacheMeasurement(a,s),{endMeasurement:function(e){var t=i.endMeasurement(__assign(__assign({},a),e));return t&&i.cacheEventByCorrelationId(t),t},flushMeasurement:function(){return i.flushMeasurements(a.name,a.correlationId)},discardMeasurement:function(){return i.discardMeasurements(a.correlationId)},measurement:s,event:a}},PerformanceClient.prototype.endMeasurement=function(e){var t=this.measurementsById.get(e.eventId);if(t){this.measurementsById.delete(e.eventId),t.endMeasurement();var r=t.flushMeasurement();if(null!==r)return this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+r+" ms",e.correlationId),__assign(__assign({durationMs:Math.round(r)},e),{status:Zd.Completed});this.logger.trace("PerformanceClient: Performance measurement not taken",e.correlationId)}else this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId);return null},PerformanceClient.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.set(e.eventId,e)):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,(new Map).set(e.eventId,e)))},PerformanceClient.prototype.cacheMeasurement=function(e,t){this.measurementsById.set(e.eventId,t)},PerformanceClient.prototype.flushMeasurements=function(e,t){var r=this;this.logger.trace("PerformanceClient: Performance measurements flushed for "+e,t);var o=this.eventsByCorrelationId.get(t);if(o){this.discardMeasurements(t);var i=[];o.forEach((function(o){if(o.name!==e&&o.status!==Zd.Completed){r.logger.trace("PerformanceClient: Incomplete submeasurement "+o.name+" found for "+e,t);var n=r.endMeasurement(o);n&&i.push(n)}i.push(o)}));var n=i.sort((function(e,t){return e.startTimeMs-t.startTimeMs})),s=n.filter((function(t){return t.name===e&&t.status===Zd.Completed}));if(s.length>0){s.length>1&&this.logger.verbose("PerformanceClient: Multiple distinct top-level performance events found, using the first",t);var a=s[0];this.logger.verbose("PerformanceClient: Measurement found for "+e,t);var l=n.reduce((function(o,i){if(i.name!==e){r.logger.trace("PerformanceClient: Complete submeasurement found for "+i.name,t);var n=i.name+"DurationMs";o[n]?r.logger.verbose("PerformanceClient: Submeasurement for "+e+" already exists for "+i.name+", ignoring",t):o[n]=i.durationMs}return o}),a);this.emitEvents([l],l.correlationId)}else this.logger.verbose("PerformanceClient: No completed top-level measurements found for "+e,t)}else this.logger.verbose("PerformanceClient: No measurements found",t)},PerformanceClient.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},PerformanceClient.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},PerformanceClient.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},PerformanceClient.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(o,i){r.logger.trace("PerformanceClient: Emitting event to callback "+i,t),o.apply(null,[e])}))},PerformanceClient}(),yu=function(){function StubPerformanceMeasurement(){}return StubPerformanceMeasurement.prototype.startMeasurement=function(){},StubPerformanceMeasurement.prototype.endMeasurement=function(){},StubPerformanceMeasurement.prototype.flushMeasurement=function(){return null},StubPerformanceMeasurement}(),wu=function(e){function StubPerformanceClient(){return null!==e&&e.apply(this,arguments)||this}return __extends(StubPerformanceClient,e),StubPerformanceClient.prototype.generateId=function(){return"callback-id"},StubPerformanceClient.prototype.startPerformanceMeasuremeant=function(){return new yu},StubPerformanceClient}(bu),Cu={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},ku={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},Tu={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},_u={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},Su={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},Eu={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},Iu={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},xu={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},Au={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},Pu={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},Ru={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},Ou={code:"empty_window_error",desc:"window.open returned null or undefined window object."},Nu={code:"user_cancelled",desc:"User cancelled the flow."},Du={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Lu={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Mu={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},$u={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},Uu={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},Fu={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},Hu={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},Bu={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},qu={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},zu={code:"no_token_request_cache_error",desc:"No token request found in cache."},ju={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},Vu={code:"no_cached_authority_error",desc:"No cached authority found."},Gu={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},Ku={code:"invalid_cache_type",desc:"Invalid cache type"},Wu={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},Qu={code:"database_not_open",desc:"Database is not open!"},Yu={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},Ju={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},Zu={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},Xu={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},eh={code:"unable_to_load_token",desc:"Error loading token to cache."},th={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},rh={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},oh={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},ih={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},nh={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},sh={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},ah={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},lh={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},ch={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},dh={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},uh=function(e){function BrowserAuthError(t,r){var o=e.call(this,t,r)||this;return Object.setPrototypeOf(o,BrowserAuthError.prototype),o.name="BrowserAuthError",o}return __extends$1(BrowserAuthError,e),BrowserAuthError.createPkceNotGeneratedError=function(e){return new BrowserAuthError(Cu.code,Cu.desc+" Detail:"+e)},BrowserAuthError.createCryptoNotAvailableError=function(e){return new BrowserAuthError(ku.code,ku.desc+" Detail:"+e)},BrowserAuthError.createHttpMethodNotImplementedError=function(e){return new BrowserAuthError(Tu.code,Tu.desc+" Given Method: "+e)},BrowserAuthError.createEmptyNavigationUriError=function(){return new BrowserAuthError(_u.code,_u.desc)},BrowserAuthError.createEmptyHashError=function(e){return new BrowserAuthError(Su.code,Su.desc+" Given Url: "+e)},BrowserAuthError.createHashDoesNotContainStateError=function(){return new BrowserAuthError(Eu.code,Eu.desc)},BrowserAuthError.createHashDoesNotContainKnownPropertiesError=function(){return new BrowserAuthError(Iu.code,Iu.desc)},BrowserAuthError.createUnableToParseStateError=function(){return new BrowserAuthError(xu.code,xu.desc)},BrowserAuthError.createStateInteractionTypeMismatchError=function(){return new BrowserAuthError(Au.code,Au.desc)},BrowserAuthError.createInteractionInProgressError=function(){return new BrowserAuthError(Pu.code,Pu.desc)},BrowserAuthError.createPopupWindowError=function(e){var t=Ru.desc;return t=$c.isEmpty(e)?t:t+" Details: "+e,new BrowserAuthError(Ru.code,t)},BrowserAuthError.createEmptyWindowCreatedError=function(){return new BrowserAuthError(Ou.code,Ou.desc)},BrowserAuthError.createUserCancelledError=function(){return new BrowserAuthError(Nu.code,Nu.desc)},BrowserAuthError.createMonitorPopupTimeoutError=function(){return new BrowserAuthError(Du.code,Du.desc)},BrowserAuthError.createMonitorIframeTimeoutError=function(){return new BrowserAuthError(Lu.code,Lu.desc)},BrowserAuthError.createRedirectInIframeError=function(e){return new BrowserAuthError(Mu.code,Mu.desc+" (window.parent !== window) => "+e)},BrowserAuthError.createBlockReloadInHiddenIframeError=function(){return new BrowserAuthError($u.code,$u.desc)},BrowserAuthError.createBlockAcquireTokenInPopupsError=function(){return new BrowserAuthError(Uu.code,Uu.desc)},BrowserAuthError.createIframeClosedPrematurelyError=function(){return new BrowserAuthError(Fu.code,Fu.desc)},BrowserAuthError.createSilentLogoutUnsupportedError=function(){return new BrowserAuthError(Hu.code,Hu.desc)},BrowserAuthError.createNoAccountError=function(){return new BrowserAuthError(Bu.code,Bu.desc)},BrowserAuthError.createSilentPromptValueError=function(e){return new BrowserAuthError(qu.code,qu.desc+" Given value: "+e)},BrowserAuthError.createUnableToParseTokenRequestCacheError=function(){return new BrowserAuthError(ju.code,ju.desc)},BrowserAuthError.createNoTokenRequestCacheError=function(){return new BrowserAuthError(zu.code,zu.desc)},BrowserAuthError.createAuthRequestNotSetError=function(){return new BrowserAuthError(Gu.code,Gu.desc)},BrowserAuthError.createNoCachedAuthorityError=function(){return new BrowserAuthError(Vu.code,Vu.desc)},BrowserAuthError.createInvalidCacheTypeError=function(){return new BrowserAuthError(Ku.code,""+Ku.desc)},BrowserAuthError.createNonBrowserEnvironmentError=function(){return new BrowserAuthError(Wu.code,Wu.desc)},BrowserAuthError.createDatabaseNotOpenError=function(){return new BrowserAuthError(Qu.code,Qu.desc)},BrowserAuthError.createNoNetworkConnectivityError=function(){return new BrowserAuthError(Yu.code,Yu.desc)},BrowserAuthError.createPostRequestFailedError=function(e,t){return new BrowserAuthError(Ju.code,Ju.desc+" | Network client threw: "+e+" | Attempted to reach: "+t.split("?")[0])},BrowserAuthError.createGetRequestFailedError=function(e,t){return new BrowserAuthError(Zu.code,Zu.desc+" | Network client threw: "+e+" | Attempted to reach: "+t.split("?")[0])},BrowserAuthError.createFailedToParseNetworkResponseError=function(e){return new BrowserAuthError(Xu.code,Xu.desc+" | Attempted to reach: "+e.split("?")[0])},BrowserAuthError.createUnableToLoadTokenError=function(e){return new BrowserAuthError(eh.code,eh.desc+" | "+e)},BrowserAuthError.createSigningKeyNotFoundInStorageError=function(e){return new BrowserAuthError(th.code,th.desc+" | No match found for KeyId: "+e)},BrowserAuthError.createAuthCodeRequiredError=function(){return new BrowserAuthError(rh.code,rh.desc)},BrowserAuthError.createAuthCodeOrNativeAccountIdRequiredError=function(){return new BrowserAuthError(oh.code,oh.desc)},BrowserAuthError.createDatabaseUnavailableError=function(){return new BrowserAuthError(ih.code,ih.desc)},BrowserAuthError.createUnableToAcquireTokenFromNativePlatformError=function(){return new BrowserAuthError(nh.code,nh.desc)},BrowserAuthError.createNativeHandshakeTimeoutError=function(){return new BrowserAuthError(sh.code,sh.desc)},BrowserAuthError.createNativeExtensionNotInstalledError=function(){return new BrowserAuthError(ah.code,ah.desc)},BrowserAuthError.createNativeConnectionNotEstablishedError=function(){return new BrowserAuthError(lh.code,lh.desc)},BrowserAuthError.createNativeBrokerCalledBeforeInitialize=function(){return new BrowserAuthError(ch.code,ch.desc)},BrowserAuthError.createNativePromptParameterNotSupportedError=function(){return new BrowserAuthError(dh.code,dh.desc)},BrowserAuthError}(Gl),hh="invalid_grant",ph=483,fh=600,gh="msal",mh=50,vh="msal.js.browser",bh="53ee284d-920a-4b59-9d30-a60315b26836",yh="ppnbnpeolgkicgegkbkbjmhlideopiji",wh="MATS";
/*! @azure/msal-common v7.0.0 2022-06-13 */!function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(du||(du={})),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(uu||(uu={})),function(e){e.GET="GET",e.POST="POST"}(hu||(hu={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native"}(pu||(pu={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(fu||(fu={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(gu||(gu={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(mu||(mu={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(vu||(vu={}));var Ch,kh={scopes:gl};!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(Ch||(Ch={}));var Th,_h,Sh={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Eh={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Ih={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},xh={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Ah={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},Ph={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},Rh=function(e){function BrowserConfigurationAuthError(t,r){var o=e.call(this,t,r)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,BrowserConfigurationAuthError.prototype),o}return __extends$1(BrowserConfigurationAuthError,e),BrowserConfigurationAuthError.createRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Sh.code,Sh.desc)},BrowserConfigurationAuthError.createPostLogoutRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Eh.code,Eh.desc)},BrowserConfigurationAuthError.createStorageNotSupportedError=function(e){return new BrowserConfigurationAuthError(Ih.code,Ih.desc+" Given Location: "+e)},BrowserConfigurationAuthError.createRedirectCallbacksNotSetError=function(){return new BrowserConfigurationAuthError(xh.code,xh.desc)},BrowserConfigurationAuthError.createStubPcaInstanceCalledError=function(){return new BrowserConfigurationAuthError(Ah.code,Ah.desc)},BrowserConfigurationAuthError.createInMemoryRedirectUnavailableError=function(){return new BrowserConfigurationAuthError(Ph.code,Ph.desc)},BrowserConfigurationAuthError}(Gl),Oh=function(){function BrowserStorage(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return BrowserStorage.prototype.validateWindowStorage=function(e){if(e!==uu.LocalStorage&&e!==uu.SessionStorage)throw Rh.createStorageNotSupportedError(e);if(!!!window[e])throw Rh.createStorageNotSupportedError(e)},BrowserStorage.prototype.getItem=function(e){return this.windowStorage.getItem(e)},BrowserStorage.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},BrowserStorage.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},BrowserStorage.prototype.getKeys=function(){return Object.keys(this.windowStorage)},BrowserStorage.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},BrowserStorage}(),Nh=function(){function MemoryStorage(){this.cache=new Map}return MemoryStorage.prototype.getItem=function(e){return this.cache.get(e)||null},MemoryStorage.prototype.setItem=function(e,t){this.cache.set(e,t)},MemoryStorage.prototype.removeItem=function(e){this.cache.delete(e)},MemoryStorage.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},MemoryStorage.prototype.containsKey=function(e){return this.cache.has(e)},MemoryStorage.prototype.clear=function(){this.cache.clear()},MemoryStorage}(),Dh=function(){function BrowserProtocolUtils(){}return BrowserProtocolUtils.extractBrowserRequestState=function(e,t){if($c.isEmpty(t))return null;try{return Hd.parseRequestState(e,t).libraryState.meta}catch(e){throw Mc.createInvalidStateError(t,e)}},BrowserProtocolUtils.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Bd(e);return Bd.getDeserializedHash(t.getHash())},BrowserProtocolUtils}(),Lh=function(e){function BrowserCacheManager(t,r,o,i){var n=e.call(this,t,o)||this;return n.COOKIE_LIFE_MULTIPLIER=864e5,n.cacheConfig=r,n.logger=i,n.internalStorage=new Nh,n.browserStorage=n.setupBrowserStorage(n.cacheConfig.cacheLocation),n.temporaryCacheStorage=n.setupTemporaryCacheStorage(n.cacheConfig.cacheLocation),n.migrateCacheEntries(),n}return __extends$1(BrowserCacheManager,e),BrowserCacheManager.prototype.setupBrowserStorage=function(e){switch(e){case uu.LocalStorage:case uu.SessionStorage:try{return new Oh(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=uu.MemoryStorage,new Nh},BrowserCacheManager.prototype.setupTemporaryCacheStorage=function(e){switch(e){case uu.LocalStorage:case uu.SessionStorage:try{return new Oh(uu.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case uu.MemoryStorage:default:return this.internalStorage}},BrowserCacheManager.prototype.migrateCacheEntries=function(){var e=this,t=fl.CACHE_PREFIX+"."+dl.ID_TOKEN,r=fl.CACHE_PREFIX+"."+dl.CLIENT_INFO,o=fl.CACHE_PREFIX+"."+dl.ERROR,i=fl.CACHE_PREFIX+"."+dl.ERROR_DESC,n=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(o),this.browserStorage.getItem(i)];[dl.ID_TOKEN,dl.CLIENT_INFO,dl.ERROR,dl.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,n[r])}))},BrowserCacheManager.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},BrowserCacheManager.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},BrowserCacheManager.prototype.getItem=function(e){return this.browserStorage.getItem(e)},BrowserCacheManager.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},BrowserCacheManager.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&hd.isAccountEntity(r)?fd.toObject(new hd,r):null},BrowserCacheManager.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},BrowserCacheManager.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Rd.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),fd.toObject(new Rd,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},BrowserCacheManager.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Nd.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),fd.toObject(new Nd,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},BrowserCacheManager.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Dd.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),fd.toObject(new Dd,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},BrowserCacheManager.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},BrowserCacheManager.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&jd.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),fd.toObject(new jd,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},BrowserCacheManager.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},BrowserCacheManager.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&ru.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),fd.toObject(new ru,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},BrowserCacheManager.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},BrowserCacheManager.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Yd.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),fd.toObject(new Yd,r)):null},BrowserCacheManager.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},BrowserCacheManager.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(fu.WRAPPER_SKU,e),this.internalStorage.setItem(fu.WRAPPER_VER,t)},BrowserCacheManager.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(fu.WRAPPER_SKU)||fl.EMPTY_STRING,this.internalStorage.getItem(fu.WRAPPER_VER)||fl.EMPTY_STRING]},BrowserCacheManager.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},BrowserCacheManager.prototype.getActiveAccount=function(){var e=this.generateCacheKey(dl.ACTIVE_ACCOUNT),t=this.browserStorage.getItem(e);return t&&this.getAccountInfoByFilter({localAccountId:t})[0]||null},BrowserCacheManager.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(dl.ACTIVE_ACCOUNT);e?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(t,e.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t))},BrowserCacheManager.prototype.getAccountInfoByFilter=function(e){return this.getAllAccounts().filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},BrowserCacheManager.prototype.getAccountInfoByHints=function(e,t){var r=this.getAllAccounts().filter((function(r){if(t){var o=r.idTokenClaims&&r.idTokenClaims.sid;return t===o}return!!e&&e===r.username}));if(1===r.length)return r[0];if(r.length>1)throw Mc.createMultipleMatchingAccountsInCacheError();return null},BrowserCacheManager.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&ou.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),fd.toObject(new ou,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},BrowserCacheManager.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},BrowserCacheManager.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var o=this.getItemCookie(r);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),o}var i=this.temporaryCacheStorage.getItem(r);if(!i){if(this.cacheConfig.cacheLocation===uu.LocalStorage){var n=this.browserStorage.getItem(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),n}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i},BrowserCacheManager.prototype.setTemporaryCache=function(e,t,r){var o=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(o,t))},BrowserCacheManager.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},BrowserCacheManager.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},BrowserCacheManager.prototype.getKeys=function(){return __spread(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},BrowserCacheManager.prototype.clear=function(){return __awaiter$3(this,void 0,void 0,(function(){var e=this;return __generator$1(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(fl.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},BrowserCacheManager.prototype.setItemCookie=function(e,t,r){var o=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(o+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(o+="Secure;"),document.cookie=o},BrowserCacheManager.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var i=r[o];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return fl.EMPTY_STRING},BrowserCacheManager.prototype.clearMsalCookies=function(){var e=this,t=fl.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var o=r.split("=")[0];e.clearItemCookie(o)}}))},BrowserCacheManager.prototype.clearItemCookie=function(e){this.setItemCookie(e,fl.EMPTY_STRING,-1)},BrowserCacheManager.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},BrowserCacheManager.prototype.getCache=function(){return this.browserStorage},BrowserCacheManager.prototype.setCache=function(){},BrowserCacheManager.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):$c.startsWith(e,fl.CACHE_PREFIX)||$c.startsWith(e,dl.ADAL_ID_TOKEN)?e:fl.CACHE_PREFIX+"."+this.clientId+"."+e},BrowserCacheManager.prototype.generateAuthorityKey=function(e){var t=Hd.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(pu.AUTHORITY+"."+t)},BrowserCacheManager.prototype.generateNonceKey=function(e){var t=Hd.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(pu.NONCE_IDTOKEN+"."+t)},BrowserCacheManager.prototype.generateStateKey=function(e){var t=Hd.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(pu.REQUEST_STATE+"."+t)},BrowserCacheManager.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var o=this.generateAuthorityKey(r);return this.getTemporaryCache(o)},BrowserCacheManager.prototype.updateCacheEntries=function(e,t,r,o,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var n=this.generateStateKey(e);this.setTemporaryCache(n,e,!1);var s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);var a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,r,!1),i){var l={credential:i.homeAccountId,type:Td.HOME_ACCOUNT_ID};this.setTemporaryCache(pu.CCS_CREDENTIAL,JSON.stringify(l),!0)}else if(!$c.isEmpty(o)){l={credential:o,type:Td.UPN};this.setTemporaryCache(pu.CCS_CREDENTIAL,JSON.stringify(l),!0)}},BrowserCacheManager.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),$c.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(pu.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(pu.ORIGIN_URI)),this.removeItem(this.generateCacheKey(pu.URL_HASH)),this.removeItem(this.generateCacheKey(pu.CORRELATION_ID)),this.removeItem(this.generateCacheKey(pu.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(pu.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||fl.EMPTY_STRING)}this.clearMsalCookies()},BrowserCacheManager.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(pu.REQUEST_STATE)){var o=t.temporaryCacheStorage.getItem(r);if(o){var i=Dh.extractBrowserRequestState(t.cryptoImpl,o);i&&i.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+o),t.resetRequestCache(o))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(pu.REQUEST_PARAMS,r,!0)},BrowserCacheManager.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(pu.REQUEST_PARAMS,!0);if(!r)throw uh.createNoTokenRequestCacheError();var o=this.validateAndParseJson(t.base64Decode(r));if(!o)throw uh.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(pu.REQUEST_PARAMS)),$c.isEmpty(o.authority)){var i=this.generateAuthorityKey(e),n=this.getTemporaryCache(i);if(!n)throw uh.createNoCachedAuthorityError();o.authority=n}return o},BrowserCacheManager.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(pu.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},BrowserCacheManager.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},BrowserCacheManager.prototype.getInteractionInProgress=function(){var e=fl.CACHE_PREFIX+"."+pu.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},BrowserCacheManager.prototype.setInteractionInProgress=function(e){var t=fl.CACHE_PREFIX+"."+pu.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw uh.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},BrowserCacheManager.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(dl.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(dl.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(dl.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(dl.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var o=new pd(r,this.cryptoImpl);if(o.claims&&o.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),o.claims.preferred_username;if(o.claims&&o.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),o.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},BrowserCacheManager.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var o=this.getItem(e);if(o)return this.removeItem(e),this.setItem(r,o),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},BrowserCacheManager}(fd),Mh="@azure/msal-browser",$h=function(){function FetchClient(){}return FetchClient.prototype.sendGetRequestAsync=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i;return __generator$1(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,fetch(e,{method:hu.GET,headers:this.getFetchHeaders(t)})];case 1:return r=n.sent(),[3,3];case 2:throw o=n.sent(),window.navigator.onLine?uh.createGetRequestFailedError(o,e):uh.createNoNetworkConnectivityError();case 3:return n.trys.push([3,5,,6]),i={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(i.body=n.sent(),i.status=r.status,i)];case 5:throw n.sent(),uh.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},FetchClient.prototype.sendPostRequestAsync=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,n;return __generator$1(this,(function(s){switch(s.label){case 0:r=t&&t.body||fl.EMPTY_STRING,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:hu.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return o=s.sent(),[3,4];case 3:throw i=s.sent(),window.navigator.onLine?uh.createPostRequestFailedError(i,e):uh.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),n={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 5:return[2,(n.body=s.sent(),n.status=o.status,n)];case 6:throw s.sent(),uh.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},FetchClient.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},FetchClient.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},FetchClient}(),Uh=function(){function XhrClient(){}return XhrClient.prototype.sendGetRequestAsync=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,this.sendRequestAsync(e,hu.GET,t)]}))}))},XhrClient.prototype.sendPostRequestAsync=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,this.sendRequestAsync(e,hu.POST,t)]}))}))},XhrClient.prototype.sendRequestAsync=function(e,t,r){var o=this;return new Promise((function(i,n){var s=new XMLHttpRequest;if(s.open(t,e,!0),o.setXhrHeaders(s,r),s.onload=function(){(s.status<200||s.status>=300)&&(t===hu.POST?n(uh.createPostRequestFailedError("Failed with status "+s.status,e)):n(uh.createGetRequestFailedError("Failed with status "+s.status,e)));try{var r=JSON.parse(s.responseText),a={headers:o.getHeaderDict(s),body:r,status:s.status};i(a)}catch(t){n(uh.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===hu.POST?n(uh.createPostRequestFailedError("Failed with status "+s.status,e)):n(uh.createGetRequestFailedError("Failed with status "+s.status,e)):n(uh.createNoNetworkConnectivityError())},t===hu.POST&&r&&r.body)s.send(r.body);else{if(t!==hu.GET)throw uh.createHttpMethodNotImplementedError(t);s.send()}}))},XhrClient.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},XhrClient.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),o=t.shift(),i=t.join(": ");o&&i&&(r[o]=i)})),r},XhrClient}(),Fh=function(){function BrowserUtils(){}return BrowserUtils.clearHash=function(e){e.location.hash=fl.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,fl.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},BrowserUtils.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):fl.EMPTY_STRING},BrowserUtils.isInIframe=function(){return window.parent!==window},BrowserUtils.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(gh+".")},BrowserUtils.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},BrowserUtils.getHomepage=function(){var e=new Bd(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},BrowserUtils.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new $h:new Uh},BrowserUtils.blockReloadInHiddenIframes=function(){if(Bd.hashContainsKnownProperties(window.location.hash)&&BrowserUtils.isInIframe())throw uh.createBlockReloadInHiddenIframeError()},BrowserUtils.blockRedirectInIframe=function(e,t){var r=BrowserUtils.isInIframe();if(e===mu.Redirect&&r&&!t)throw uh.createRedirectInIframeError(r)},BrowserUtils.blockAcquireTokenInPopups=function(){if(BrowserUtils.isInPopup())throw uh.createBlockAcquireTokenInPopupsError()},BrowserUtils.blockNonBrowserEnvironment=function(e){if(!e)throw uh.createNonBrowserEnvironmentError()},BrowserUtils.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw uh.createNativeBrokerCalledBeforeInitialize()},BrowserUtils.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),o=e.indexOf("Edge/");return t>0||r>0||o>0},BrowserUtils}(),Hh=function(){function BaseInteractionClient(e,t,r,o,i,n,s,a,l){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=n,this.nativeMessageHandler=a,this.correlationId=l||this.browserCrypto.createNewGuid(),this.logger=o.clone(vh,"2.26.0",this.correlationId),this.performanceClient=s}return BaseInteractionClient.prototype.clearCacheOnLogout=function(e){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];hd.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(hd.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},BaseInteractionClient.prototype.initializeBaseRequest=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i;return __generator$1(this,(function(n){switch(n.label){case 0:if(this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,r=__spread(e&&e.scopes||[]),(o=__assign$1(__assign$1({},e),{correlationId:this.correlationId,authority:t,scopes:r})).authenticationScheme){if(o.authenticationScheme===Pl.SSH){if(!e.sshJwk)throw dd.createMissingSshJwkError();if(!e.sshKid)throw dd.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+o.authenticationScheme+'" as configured in Auth request')}else o.authenticationScheme=Pl.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!e.claims||$c.isEmpty(e.claims)?[3,2]:(i=o,[4,this.browserCrypto.hashString(e.claims)]);case 1:i.requestedClaimsHash=n.sent(),n.label=2;case 2:return[2,o]}}))}))},BaseInteractionClient.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||Fh.getCurrentUri();return Bd.getAbsoluteUrl(t,Fh.getCurrentUri())},BaseInteractionClient.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new cu(r,this.browserStorage)},BaseInteractionClient.prototype.getDiscoveredAuthority=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,tu.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,tu.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t)]}}))}))},BaseInteractionClient}(),Bh=function(e){function StandardInteractionClient(){return null!==e&&e.apply(this,arguments)||this}return __extends$1(StandardInteractionClient,e),StandardInteractionClient.prototype.initializeAuthorizationCodeRequest=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(o){switch(o.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=o.sent(),r=__assign$1(__assign$1({},e),{redirectUri:e.redirectUri,code:fl.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=fl.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},StandardInteractionClient.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=__assign$1({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Bd.getAbsoluteUrl(e.postLogoutRedirectUri,Fh.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Bd.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Fh.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Bd.getAbsoluteUrl(Fh.getCurrentUri(),Fh.getCurrentUri())),t},StandardInteractionClient.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},StandardInteractionClient.prototype.createAuthCodeClient=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(i){switch(i.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return o=i.sent(),[2,new Kd(o)]}}))}))},StandardInteractionClient.prototype.getClientConfiguration=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(i){switch(i.label){case 0:return this.logger.verbose("getClientConfiguration called",this.correlationId),[4,this.getDiscoveredAuthority(t,r)];case 1:return o=i.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:vh,version:"2.26.0",cpu:fl.EMPTY_STRING,os:fl.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},StandardInteractionClient.prototype.validateAndExtractStateFromHash=function(e,t,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!e.state)throw uh.createHashDoesNotContainStateError();var o=Dh.extractBrowserRequestState(this.browserCrypto,e.state);if(!o)throw uh.createUnableToParseStateError();if(o.interactionType!==t)throw uh.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),e.state},StandardInteractionClient.prototype.getDiscoveredAuthority=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,n;return __generator$1(this,(function(s){switch(s.label){case 0:return this.logger.verbose("getDiscoveredAuthority called",this.correlationId),r=this.performanceClient.startMeasurement(Jd.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},i=e||this.config.auth.authority,n=eu.generateAuthority(i,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),[4,tu.createDiscoveredInstance(n,this.config.system.networkClient,this.browserStorage,o).then((function(e){return r.endMeasurement({success:!0}),e})).catch((function(e){throw r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,s.sent()]}}))}))},StandardInteractionClient.prototype.initializeAuthorizationRequest=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,n,s,a,l;return __generator$1(this,(function(c){switch(c.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(e.redirectUri),o={interactionType:t},i=Hd.setRequestState(this.browserCrypto,e&&e.state||fl.EMPTY_STRING,o),s=[{}],[4,this.initializeBaseRequest(e)];case 1:return n=__assign$1.apply(void 0,[__assign$1.apply(void 0,s.concat([c.sent()])),{redirectUri:r,state:i,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:yl.FRAGMENT}]),(a=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+a.homeAccountId,this.correlationId),n.account=a),$c.isEmpty(n.loginHint)&&!a&&(l=this.browserStorage.getLegacyLoginHint())&&(n.loginHint=l),[2,n]}}))}))},StandardInteractionClient}(Hh),qh=function(){function InteractionHandler(e,t,r,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=o}return InteractionHandler.prototype.handleCodeResponseFromHash=function(e,t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i,n,s;return __generator$1(this,(function(a){if(this.logger.verbose("InteractionHandler.handleCodeResponse called"),$c.isEmpty(e))throw uh.createEmptyHashError(e);if(i=this.browserStorage.generateStateKey(t),!(n=this.browserStorage.getTemporaryCache(i)))throw Mc.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,n)}catch(e){throw e instanceof _d&&e.subError===Nu.code?uh.createUserCancelledError():e}return[2,this.handleCodeResponseFromServer(s,t,r,o)]}))}))},InteractionHandler.prototype.handleCodeResponseFromServer=function(e,t,r,o,i){return void 0===i&&(i=!0),__awaiter$3(this,void 0,void 0,(function(){var n,s,a,l,c,d;return __generator$1(this,(function(u){switch(u.label){case 0:if(this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),n=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(n)))throw Mc.createStateNotFoundError("Cached State");return a=this.browserStorage.generateNonceKey(s),l=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,o)]:[3,2];case 1:u.sent(),u.label=2;case 2:return i&&(e.nonce=l||void 0),e.state=s,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(c=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=c),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return d=u.sent(),this.browserStorage.cleanRequestByState(t),[2,d]}}))}))},InteractionHandler.prototype.updateTokenEndpointAuthority=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i;return __generator$1(this,(function(n){switch(n.label){case 0:return o="https://"+e+"/"+t.tenant+"/",[4,tu.createDiscoveredInstance(o,r,this.browserStorage,t.options)];case 1:return i=n.sent(),this.authModule.updateAuthority(i),[2]}}))}))},InteractionHandler.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(pu.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},InteractionHandler}(),zh=function(e){function RedirectHandler(t,r,o,i,n){var s=e.call(this,t,r,o,i)||this;return s.browserCrypto=n,s}return __extends$1(RedirectHandler,e),RedirectHandler.prototype.initiateAuthRequest=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){switch(o.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),$c.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(pu.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(pu.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:gu.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:case 5:return o.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),uh.createEmptyNavigationUriError();case 8:return[2]}}))}))},RedirectHandler.prototype.handleCodeResponseFromHash=function(e,t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i,n,s,a,l,c,d;return __generator$1(this,(function(u){switch(u.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),$c.isEmpty(e))throw uh.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),i=this.browserStorage.generateStateKey(t),!(n=this.browserStorage.getTemporaryCache(i)))throw Mc.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,n)}catch(e){throw e instanceof _d&&e.subError===Nu.code?uh.createUserCancelledError():e}return a=this.browserStorage.generateNonceKey(n),l=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,r,o)]:[3,2];case 1:u.sent(),u.label=2;case 2:return s.nonce=l||void 0,s.state=n,s.client_info?this.authCodeRequest.clientInfo=s.client_info:(c=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=c),[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return d=u.sent(),this.browserStorage.cleanRequestByState(t),[2,d]}}))}))},RedirectHandler}(qh);!function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(Th||(Th={})),function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED"}(_h||(_h={}));var jh={code:"ContentError"},Vh={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Gh=function(e){function NativeAuthError(t,r,o){var i=e.call(this,t,r)||this;return Object.setPrototypeOf(i,NativeAuthError.prototype),i.name="NativeAuthError",i.ext=o,i}return __extends$1(NativeAuthError,e),NativeAuthError.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==_h.PERSISTENT_ERROR&&this.ext.status!==_h.DISABLED)||this.errorCode===jh.code},NativeAuthError.createError=function(e,t,r){if(r&&r.status)switch(r.status){case _h.USER_INTERACTION_REQUIRED:return new Ud(e,t);case _h.USER_CANCEL:return uh.createUserCancelledError();case _h.NO_NETWORK:return uh.createNoNetworkConnectivityError()}return new NativeAuthError(e,t,r)},NativeAuthError.createUserSwitchError=function(){return new NativeAuthError(Vh.code,Vh.desc)},NativeAuthError}(Gl),Kh=function(e){function NativeInteractionClient(t,r,o,i,n,s,a,l,c,d,u){var h=e.call(this,t,r,o,i,n,s,l,c,u)||this;return h.apiId=a,h.accountId=d,h.nativeMessageHandler=c,h}return __extends$1(NativeInteractionClient,e),NativeInteractionClient.prototype.acquireToken=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s;return __generator$1(this,(function(a){switch(a.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(Jd.NativeInteractionClientAcquireToken,e.correlationId),[4,this.initializeNativeRequest(e)];case 1:return r=a.sent(),o={method:du.GetToken,request:r},i=Od.nowSeconds(),[4,this.nativeMessageHandler.sendMessage(o)];case 2:return n=a.sent(),s=this.validateNativeResponse(n),[2,this.handleNativeResponse(s,r,i).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},NativeInteractionClient.prototype.acquireTokenRedirect=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s;return __generator$1(this,(function(a){switch(a.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(e)];case 1:t=a.sent(),r={method:du.GetToken,request:t},a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(r)];case 3:return o=a.sent(),this.validateNativeResponse(o),[3,5];case 4:if((i=a.sent())instanceof Gh&&i.isFatal())throw i;return[3,5];case 5:return this.browserStorage.setTemporaryCache(pu.NATIVE_REQUEST,JSON.stringify(t),!0),n={apiId:gu.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri),[4,this.navigationClient.navigateExternal(s,n)];case 6:return a.sent(),[2]}}))}))},NativeInteractionClient.prototype.handleRedirectPromise=function(){return __awaiter$3(this,void 0,void 0,(function(){var e,t,r,o,i,n;return __generator$1(this,(function(s){switch(s.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];this.browserStorage.removeItem(this.browserStorage.generateCacheKey(pu.NATIVE_REQUEST)),t={method:du.GetToken,request:e},r=Od.nowSeconds(),s.label=1;case 1:return s.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(t)];case 2:return o=s.sent(),this.validateNativeResponse(o),i=this.handleNativeResponse(o,e,r),this.browserStorage.setInteractionInProgress(!1),[2,i];case 3:throw n=s.sent(),this.browserStorage.setInteractionInProgress(!1),n;case 4:return[2]}}))}))},NativeInteractionClient.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},NativeInteractionClient.prototype.handleNativeResponse=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i,n,s,a,l,c,d,u,h,p,f,g,m,v,b=this;return __generator$1(this,(function(y){switch(y.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw Gh.createUserSwitchError();return o=new pd(e.id_token||fl.EMPTY_STRING,this.browserCrypto),[4,this.getDiscoveredAuthority(t.authority)];case 1:return i=y.sent(),n=i.getPreferredCache(),s=hd.generateHomeAccountId(e.client_info||fl.EMPTY_STRING,Hc.Default,this.logger,this.browserCrypto,o),a=hd.createAccount(e.client_info,s,o,void 0,void 0,void 0,n,e.account.id),this.browserStorage.setAccount(a),l=e.scopes?ud.fromString(e.scopes):ud.fromString(t.scopes),c=e.account.properties||{},d=c.UID||o.claims.oid||o.claims.sub||fl.EMPTY_STRING,u=c.TenantId||o.claims.tid||fl.EMPTY_STRING,p=Pl.BEARER,t.tokenType===Pl.POP?[3,2]:[3,4];case 2:if(p=Pl.POP,e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),h=e.shr,[3,5];if(f=new zd(this.browserCrypto),g={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce},!t.keyId)throw Mc.createKeyIdMissingError();return[4,f.signPopToken(e.access_token,t.keyId,g)];case 3:return h=y.sent(),[3,5];case 4:h=e.access_token,y.label=5;case 5:return m=this.getMATSFromResponse(e),v={authority:i.canonicalAuthority,uniqueId:d,tenantId:u,scopes:l.asArray(),account:a.getAccountInfo(),idToken:e.id_token,idTokenClaims:o.claims,accessToken:h,fromCache:!!m&&this.isResponseFromCache(m),expiresOn:new Date(1e3*Number(r+e.expires_in)),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0},this.browserStorage.removeAccountContext(a).catch((function(e){b.logger.error("Error occurred while removing account context from browser storage. "+e)})),[2,v]}}))}))},NativeInteractionClient.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expires_in"))return e;throw Gh.createUnexpectedError("Response missing expected properties.")},NativeInteractionClient.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},NativeInteractionClient.prototype.isResponseFromCache=function(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},NativeInteractionClient.prototype.initializeNativeRequest=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s,a;return __generator$1(this,(function(l){switch(l.label){case 0:if(this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),t=e.authority||this.config.auth.authority,(r=new Bd(t)).validateAsUri(),o=e&&e.scopes||[],(i=new ud(o)).appendScopes(gl),e.prompt)switch(e.prompt){case bl.NONE:case bl.CONSENT:this.logger.trace("initializeNativeRequest: prompt is compatible with native flow");break;default:throw this.logger.trace("initializeNativeRequest: prompt = "+e.prompt+" is not compatible with native flow"),uh.createNativePromptParameterNotSupportedError()}return n=__assign$1(__assign$1({},e),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scopes:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:__assign$1(__assign$1(__assign$1({},e.extraQueryParameters),e.tokenQueryParameters),{telemetry:wh}),extendedExpiryToken:!1}),e.authenticationScheme!==Pl.POP?[3,2]:(s={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},[4,new zd(this.browserCrypto).generateCnf(s)]);case 1:a=l.sent(),n.reqCnf=a.reqCnfHash,n.keyId=a.kid,l.label=2;case 2:return this.apiId!==gu.ssoSilent&&this.apiId!==gu.acquireTokenSilent_silentFlow||(n.prompt=bl.NONE),[2,n]}}))}))},NativeInteractionClient}(Hh),Wh=function(){function NativeMessageHandler(e,t,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this)}return NativeMessageHandler.prototype.sendMessage=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r=this;return __generator$1(this,(function(o){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:bh,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,o){r.resolvers.set(t.responseId,{resolve:e,reject:o})}))]}))}))},NativeMessageHandler.createProvider=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r,o;return __generator$1(this,(function(i){switch(i.label){case 0:e.trace("NativeMessageHandler - createProvider called."),i.label=1;case 1:return i.trys.push([1,3,,5]),[4,(r=new NativeMessageHandler(e,t,yh)).sendHandshakeRequest()];case 2:return i.sent(),[2,r];case 3:return i.sent(),[4,(o=new NativeMessageHandler(e,t)).sendHandshakeRequest()];case 4:return i.sent(),[2,o];case 5:return[2]}}))}))},NativeMessageHandler.prototype.sendHandshakeRequest=function(){return __awaiter$3(this,void 0,void 0,(function(){var e,t=this;return __generator$1(this,(function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:bh,extensionId:this.extensionId,responseId:this.responseId++,body:{method:du.HandshakeRequest}},this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(r,o){t.handshakeResolvers.set(e.responseId,{resolve:r,reject:o}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),o(uh.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},NativeMessageHandler.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===bh&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===du.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&r.reject(uh.createNativeExtensionNotInstalledError())}}},NativeMessageHandler.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),o=this.handshakeResolvers.get(t.responseId);try{var i=t.body.method;if(i===du.Response){if(!r)return;var n=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(n)),"Success"!==n.status)r.reject(Gh.createError(n.code,n.description,n.ext));else{if(!n.result)throw Gl.createUnexpectedError("Event does not contain result.");n.result.code&&n.result.description?r.reject(Gh.createError(n.result.code,n.result.description,n.result.ext)):r.resolve(n.result)}this.resolvers.delete(t.responseId)}else if(i===du.HandshakeResponse){if(!o)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),o.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+t.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(t):o&&o.reject(t)}},NativeMessageHandler.isNativeAvailable=function(e,t,r,o){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case Pl.BEARER:case Pl.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},NativeMessageHandler}(),Qh=function(e){function RedirectClient(){return null!==e&&e.apply(this,arguments)||this}return __extends$1(RedirectClient,e),RedirectClient.prototype.acquireToken=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s,a,l,c,d=this;return __generator$1(this,(function(u){switch(u.label){case 0:return[4,this.initializeAuthorizationRequest(e,mu.Redirect)];case 1:t=u.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||fl.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(gu.acquireTokenRedirect),o=function(e){e.persisted&&(d.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),d.browserStorage.cleanRequestByState(t.state))},u.label=2;case 2:return u.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return i=u.sent(),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return n=u.sent(),this.logger.verbose("Auth code client created"),s=new zh(n,this.browserStorage,i,this.logger,this.browserCrypto),[4,n.getAuthCodeUrl(__assign$1(__assign$1({},t),{nativeBroker:Wh.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}))];case 5:return a=u.sent(),l=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+l),window.addEventListener("pageshow",o),[4,s.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,u.sent()];case 7:throw(c=u.sent())instanceof Gl&&c.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",o),r.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(t.state),c;case 8:return[2]}}))}))},RedirectClient.prototype.handleRedirectPromise=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s,a,l,c,d,u,h;return __generator$1(this,(function(p){switch(p.label){case 0:t=this.initializeServerTelemetryManager(gu.handleRedirectPromise),p.label=1;case 1:if(p.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(mu.Redirect),[2,null];o=void 0;try{i=Bd.getDeserializedHash(r),o=this.validateAndExtractStateFromHash(i,mu.Redirect),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType(mu.Redirect),[2,null]}return n=this.browserStorage.getTemporaryCache(pu.ORIGIN_URI,!0)||fl.EMPTY_STRING,s=Bd.removeHashFromUrl(n),a=Bd.removeHashFromUrl(window.location.href),s===a&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,o,t)]):[3,3];case 2:return l=p.sent(),n.indexOf("#")>-1&&Fh.replaceHash(n),[2,l];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,o,t)]);case 4:return Fh.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(pu.URL_HASH,r,!0),c={apiId:gu.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},d=!0,n&&"null"!==n?[3,6]:(u=Fh.getHomepage(),this.browserStorage.setTemporaryCache(pu.ORIGIN_URI,u,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(u,c)]));case 5:return d=p.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+n),[4,this.navigationClient.navigateInternal(n,c)];case 7:d=p.sent(),p.label=8;case 8:if(!d)return[2,this.handleHash(r,o,t)];p.label=9;case 9:return[2,null];case 10:throw(h=p.sent())instanceof Gl&&h.setCorrelationId(this.correlationId),t.cacheFailedRequest(h),this.browserStorage.cleanRequestByInteractionType(mu.Redirect),h;case 11:return[2]}}))}))},RedirectClient.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),Bd.hashContainsKnownProperties(e))return Fh.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(pu.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(pu.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},RedirectClient.prototype.handleHash=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i,n,s,a,l,c=this;return __generator$1(this,(function(d){switch(d.label){case 0:if(o=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(i=Bd.getDeserializedHash(e)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw uh.createNativeConnectionNotEstablishedError();return n=new Kh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,gu.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,i.accountId,o.correlationId),s=Hd.parseRequestState(this.browserCrypto,t).userRequestState,[2,n.acquireToken(__assign$1(__assign$1({},o),{state:s,prompt:void 0})).finally((function(){c.browserStorage.cleanRequestByState(t)}))]}if(!(a=this.browserStorage.getCachedAuthority(t)))throw uh.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(r,a)];case 1:return l=d.sent(),this.logger.verbose("Auth code client created"),Sd.removeThrottle(this.browserStorage,this.config.auth.clientId,o),[4,new zh(l,this.browserStorage,o,this.logger,this.browserCrypto).handleCodeResponseFromHash(e,t,l.authority,this.networkClient)];case 2:return[2,d.sent()]}}))}))},RedirectClient.prototype.logout=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s;return __generator$1(this,(function(a){switch(a.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(gu.logout),a.label=1;case 1:return a.trys.push([1,10,,11]),this.eventHandler.emitEvent(Th.LOGOUT_START,mu.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return a.sent(),o={apiId:gu.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return i=a.sent(),this.logger.verbose("Auth code client created"),n=i.getLogoutUri(t),this.eventHandler.emitEvent(Th.LOGOUT_SUCCESS,mu.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(n)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(n,o)]):[3,7];case 4:return a.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),a.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(n,o)];case 8:return a.sent(),[2];case 9:return[3,11];case 10:throw(s=a.sent())instanceof Gl&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.eventHandler.emitEvent(Th.LOGOUT_FAILURE,mu.Redirect,null,s),this.eventHandler.emitEvent(Th.LOGOUT_END,mu.Redirect),s;case 11:return this.eventHandler.emitEvent(Th.LOGOUT_END,mu.Redirect),[2]}}))}))},RedirectClient.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return Bd.getAbsoluteUrl(t,Fh.getCurrentUri())},RedirectClient}(Bh),Yh=function(e){function PopupClient(t,r,o,i,n,s,a,l,c){var d=e.call(this,t,r,o,i,n,s,a,l,c)||this;return d.unloadWindow=d.unloadWindow.bind(d),d}return __extends$1(PopupClient,e),PopupClient.prototype.acquireToken=function(e){try{var t=this.generatePopupName(e.scopes||gl,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var o=this.openSizedPopup("about:blank",t,r);return this.acquireTokenPopupAsync(e,t,r,o)}catch(e){return Promise.reject(e)}},PopupClient.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(t),o=e&&e.authority,i=e&&e.mainWindowRedirectUri,n=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,o,void 0,i);this.logger.verbose("asyncPopup set to false, opening popup");var s=this.openSizedPopup("about:blank",r,n);return this.logoutPopupAsync(t,r,n,o,s,i)}catch(e){return Promise.reject(e)}},PopupClient.prototype.acquireTokenPopupAsync=function(e,t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i,n,s,a,l,c,d,u,h,p,f,g,m,v,b,y,w=this;return __generator$1(this,(function(k){switch(k.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),i=this.initializeServerTelemetryManager(gu.acquireTokenPopup),[4,this.initializeAuthorizationRequest(e,mu.Popup)];case 1:n=k.sent(),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||fl.EMPTY_STRING,n.account||null),k.label=2;case 2:return k.trys.push([2,8,,9]),[4,this.initializeAuthorizationCodeRequest(n)];case 3:return s=k.sent(),[4,this.createAuthCodeClient(i,n.authority,n.azureCloudOptions)];case 4:return a=k.sent(),this.logger.verbose("Auth code client created"),l=Wh.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),c=void 0,l&&(c=this.performanceClient.startMeasurement(Jd.FetchAccountIdWithNativeBroker,e.correlationId)),[4,a.getAuthCodeUrl(__assign$1(__assign$1({},n),{nativeBroker:l}))];case 5:return d=k.sent(),u=new qh(a,this.browserStorage,s,this.logger),h={popup:o,popupName:t,popupWindowAttributes:r},p=this.initiateAuthRequest(d,h),this.eventHandler.emitEvent(Th.POPUP_OPENED,mu.Popup,{popupWindow:p},null),[4,this.monitorPopupForHash(p)];case 6:if(f=k.sent(),g=Bd.getDeserializedHash(f),m=this.validateAndExtractStateFromHash(g,mu.Popup,n.correlationId),Sd.removeThrottle(this.browserStorage,this.config.auth.clientId,s),g.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw uh.createNativeConnectionNotEstablishedError();return v=new Kh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,gu.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,g.accountId,n.correlationId),b=Hd.parseRequestState(this.browserCrypto,m).userRequestState,[2,v.acquireToken(__assign$1(__assign$1({},n),{state:b,prompt:void 0})).finally((function(){w.browserStorage.cleanRequestByState(m)}))]}return[4,u.handleCodeResponseFromHash(f,m,a.authority,this.networkClient)];case 7:return[2,k.sent()];case 8:throw y=k.sent(),o&&o.close(),y instanceof Gl&&y.setCorrelationId(this.correlationId),i.cacheFailedRequest(y),this.browserStorage.cleanRequestByState(n.state),y;case 9:return[2]}}))}))},PopupClient.prototype.logoutPopupAsync=function(e,t,r,o,i,n){return __awaiter$3(this,void 0,void 0,(function(){var s,a,l,c,d,u,h;return __generator$1(this,(function(p){switch(p.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Th.LOGOUT_START,mu.Popup,e),s=this.initializeServerTelemetryManager(gu.logoutPopup),p.label=1;case 1:return p.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(e.account)];case 2:return p.sent(),[4,this.createAuthCodeClient(s,o)];case 3:return a=p.sent(),this.logger.verbose("Auth code client created"),l=a.getLogoutUri(e),this.eventHandler.emitEvent(Th.LOGOUT_SUCCESS,mu.Popup,e),c=this.openPopup(l,{popupName:t,popupWindowAttributes:r,popup:i}),this.eventHandler.emitEvent(Th.POPUP_OPENED,mu.Popup,{popupWindow:c},null),[4,this.waitForLogoutPopup(c)];case 4:return p.sent(),n?(d={apiId:gu.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=Bd.getAbsoluteUrl(n,Fh.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+u),this.navigationClient.navigateInternal(u,d)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw h=p.sent(),i&&i.close(),h instanceof Gl&&h.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Th.LOGOUT_FAILURE,mu.Popup,null,h),this.eventHandler.emitEvent(Th.LOGOUT_END,mu.Popup),s.cacheFailedRequest(h),h;case 6:return this.eventHandler.emitEvent(Th.LOGOUT_END,mu.Popup),[2]}}))}))},PopupClient.prototype.initiateAuthRequest=function(e,t){if($c.isEmpty(e))throw this.logger.error("Navigate url is empty"),uh.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},PopupClient.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(r,o){var i=t.config.system.windowHashTimeout/mh,n=0;t.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var s=setInterval((function(){if(e.closed)return t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(s),void o(uh.createUserCancelledError());var a=fl.EMPTY_STRING,l=fl.EMPTY_STRING;try{a=e.location.href,l=e.location.hash}catch(e){}$c.isEmpty(a)||"about:blank"===a||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),n++,l?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(s),t.cleanPopup(e),Bd.hashContainsKnownProperties(l)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(l)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+l),o(uh.createHashDoesNotContainKnownPropertiesError()))):n>i&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(s),o(uh.createMonitorPopupTimeoutError())))}),mh)}))},PopupClient.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(r){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var o=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(o),r());var i=fl.EMPTY_STRING;try{i=e.location.href}catch(e){}$c.isEmpty(i)||"about:blank"===i||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(o),t.cleanPopup(e),r())}),mh)}))},PopupClient.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!r)throw uh.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),uh.createPopupWindowError(e.toString())}},PopupClient.prototype.openSizedPopup=function(e,t,r){var o,i,n,s,a=window.screenLeft?window.screenLeft:window.screenX,l=window.screenTop?window.screenTop:window.screenY,c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=null===(o=r.popupSize)||void 0===o?void 0:o.width,h=null===(i=r.popupSize)||void 0===i?void 0:i.height,p=null===(n=r.popupPosition)||void 0===n?void 0:n.top,f=null===(s=r.popupPosition)||void 0===s?void 0:s.left;return(!u||u<0||u>c)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),u=ph),(!h||h<0||h>d)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=fh),(!p||p<0||p>d)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),p=Math.max(0,d/2-fh/2+l)),(!f||f<0||f>c)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),f=Math.max(0,c/2-ph/2+a)),window.open(e,t,"width="+u+", height="+h+", top="+p+", left="+f+", scrollbars=yes")},PopupClient.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(mu.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},PopupClient.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},PopupClient.prototype.generatePopupName=function(e,t){return gh+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},PopupClient.prototype.generateLogoutPopupName=function(e){var t=e.account&&e.account.homeAccountId;return gh+"."+this.config.auth.clientId+"."+t+"."+this.correlationId},PopupClient}(Bh),Jh=function(){function NavigationClient(){}return NavigationClient.prototype.navigateInternal=function(e,t){return NavigationClient.defaultNavigateWindow(e,t)},NavigationClient.prototype.navigateExternal=function(e,t){return NavigationClient.defaultNavigateWindow(e,t)},NavigationClient.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},NavigationClient}();
/*! @azure/msal-browser v2.26.0 2022-06-13 */
var Zh,Xh=function(e){function SilentHandler(t,r,o,i,n){var s=e.call(this,t,r,o,i)||this;return s.navigateFrameWait=n,s}return __extends$1(SilentHandler,e),SilentHandler.prototype.initiateAuthRequest=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){switch(r.label){case 0:if($c.isEmpty(e))throw this.logger.info("Navigate url is empty"),uh.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=this.loadFrameSync(e),r.label=3;case 3:return[2,t]}}))}))},SilentHandler.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise((function(o,i){t<6e3&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default (6000ms). This may result in timeouts.");var n=window.performance.now()+t,s=setInterval((function(){if(window.performance.now()>n)return r.removeHiddenIframe(e),clearInterval(s),void i(uh.createMonitorIframeTimeoutError());var t=fl.EMPTY_STRING,a=e.contentWindow;try{t=a?a.location.href:fl.EMPTY_STRING}catch(e){}if(!$c.isEmpty(t)){var l=a?a.location.hash:fl.EMPTY_STRING;return Bd.hashContainsKnownProperties(l)?(r.removeHiddenIframe(e),clearInterval(s),void o(l)):void 0}}),mh)}))},SilentHandler.prototype.loadFrame=function(e){var t=this;return new Promise((function(r,o){var i=t.createHiddenIframe();setTimeout((function(){i?(i.src=e,r(i)):o("Unable to load iframe")}),t.navigateFrameWait)}))},SilentHandler.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},SilentHandler.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},SilentHandler.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},SilentHandler}(qh),ep=function(e){function SilentIframeClient(t,r,o,i,n,s,a,l,c,d){var u=e.call(this,t,r,o,i,n,s,l,c,d)||this;return u.apiId=a,u}return __extends$1(SilentIframeClient,e),SilentIframeClient.prototype.acquireToken=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n;return __generator$1(this,(function(s){switch(s.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),t=this.performanceClient.startMeasurement(Jd.SilentIframeClientAcquireToken,e.correlationId),$c.isEmpty(e.loginHint)&&$c.isEmpty(e.sid)&&(!e.account||$c.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==bl.NONE)throw t.endMeasurement({success:!1}),uh.createSilentPromptValueError(e.prompt);return[4,this.initializeAuthorizationRequest(__assign$1(__assign$1({},e),{prompt:bl.NONE}),mu.Silent)];case 1:r=s.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||fl.EMPTY_STRING,r.account||null),o=this.initializeServerTelemetryManager(this.apiId),s.label=2;case 2:return s.trys.push([2,5,,6]),[4,this.createAuthCodeClient(o,r.authority,r.azureCloudOptions)];case 3:return i=s.sent(),this.logger.verbose("Auth code client created"),[4,this.silentTokenHelper(i,r).then((function(e){return t.endMeasurement({success:!0,fromCache:!1}),e}))];case 4:return[2,s.sent()];case 5:throw(n=s.sent())instanceof Gl&&n.setCorrelationId(this.correlationId),o.cacheFailedRequest(n),this.browserStorage.cleanRequestByState(r.state),t.endMeasurement({errorCode:n instanceof Gl&&n.errorCode||void 0,subErrorCode:n instanceof Gl&&n.subError||void 0,success:!1}),n;case 6:return[2]}}))}))},SilentIframeClient.prototype.logout=function(){return Promise.reject(uh.createSilentLogoutUnsupportedError())},SilentIframeClient.prototype.silentTokenHelper=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,n,s,a,l,c,d,u=this;return __generator$1(this,(function(h){switch(h.label){case 0:return[4,this.initializeAuthorizationCodeRequest(t)];case 1:return r=h.sent(),[4,e.getAuthCodeUrl(__assign$1(__assign$1({},t),{nativeBroker:Wh.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 2:return o=h.sent(),[4,(i=new Xh(e,this.browserStorage,r,this.logger,this.config.system.navigateFrameWait)).initiateAuthRequest(o)];case 3:return n=h.sent(),[4,i.monitorIframeForHash(n,this.config.system.iframeHashTimeout)];case 4:if(s=h.sent(),a=Bd.getDeserializedHash(s),l=this.validateAndExtractStateFromHash(a,mu.Silent,r.correlationId),a.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw uh.createNativeConnectionNotEstablishedError();return c=new Kh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,a.accountId,this.correlationId),d=Hd.parseRequestState(this.browserCrypto,l).userRequestState,[2,c.acquireToken(__assign$1(__assign$1({},t),{state:d,prompt:bl.NONE})).finally((function(){u.browserStorage.cleanRequestByState(l)}))]}return[2,i.handleCodeResponseFromHash(s,l,e.authority,this.networkClient)]}}))}))},SilentIframeClient}(Bh),tp=function(e){function SilentCacheClient(){return null!==e&&e.apply(this,arguments)||this}return __extends$1(SilentCacheClient,e),SilentCacheClient.prototype.acquireToken=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n;return __generator$1(this,(function(s){switch(s.label){case 0:return t=this.performanceClient.startMeasurement(Jd.SilentCacheClientAcquireToken,e.correlationId),r=this.initializeServerTelemetryManager(gu.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(r,e.authority,e.azureCloudOptions)];case 1:o=s.sent(),this.logger.verbose("Silent auth client created"),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,o.acquireCachedToken(e)];case 3:return i=s.sent(),t.endMeasurement({success:!0,fromCache:!0}),[2,i];case 4:throw(n=s.sent())instanceof uh&&n.errorCode===th.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.endMeasurement({errorCode:n instanceof Gl&&n.errorCode||void 0,subErrorCode:n instanceof Gl&&n.subError||void 0,success:!1}),n;case 5:return[2]}}))}))},SilentCacheClient.prototype.logout=function(){return Promise.reject(uh.createSilentLogoutUnsupportedError())},SilentCacheClient.prototype.createSilentFlowClient=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(i){switch(i.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return o=i.sent(),[2,new Qd(o)]}}))}))},SilentCacheClient.prototype.initializeSilentRequest=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){switch(o.label){case 0:return r=[__assign$1({},e)],[4,this.initializeBaseRequest(e)];case 1:return[2,__assign$1.apply(void 0,[__assign$1.apply(void 0,r.concat([o.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},SilentCacheClient}(Bh),rp=function(e){function SilentRefreshClient(){return null!==e&&e.apply(this,arguments)||this}return __extends$1(SilentRefreshClient,e),SilentRefreshClient.prototype.acquireToken=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s=this;return __generator$1(this,(function(a){switch(a.label){case 0:return r=[__assign$1({},e)],[4,this.initializeBaseRequest(e)];case 1:return t=__assign$1.apply(void 0,r.concat([a.sent()])),o=this.performanceClient.startMeasurement(Jd.SilentRefreshClientAcquireToken,t.correlationId),i=this.initializeServerTelemetryManager(gu.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(i,t.authority,t.azureCloudOptions)];case 2:return n=a.sent(),this.logger.verbose("Refresh token client created"),[2,n.acquireTokenByRefreshToken(t).then((function(e){return o.endMeasurement({success:!0,fromCache:e.fromCache}),e})).catch((function(e){throw e instanceof Gl&&e.setCorrelationId(s.correlationId),i.cacheFailedRequest(e),o.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},SilentRefreshClient.prototype.logout=function(){return Promise.reject(uh.createSilentLogoutUnsupportedError())},SilentRefreshClient.prototype.createRefreshTokenClient=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(i){switch(i.label){case 0:return[4,this.getClientConfiguration(e,t,r)];case 1:return o=i.sent(),[2,new Wd(o)]}}))}))},SilentRefreshClient}(Bh),op=function(){function EventHandler(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return EventHandler.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},EventHandler.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},EventHandler.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},EventHandler.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},EventHandler.prototype.emitEvent=function(e,t,r,o){var i=this;if("undefined"!=typeof window){var n={eventType:e,interactionType:t||null,payload:r||null,error:o||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){i.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[n])}))}},EventHandler.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!hd.isAccountEntity(r))return;var o=fd.toObject(new hd,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Th.ACCOUNT_ADDED,void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Th.ACCOUNT_REMOVED,void 0,o))}catch(e){return}},EventHandler}(),ip=function(){function MathUtils(){}return MathUtils.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},MathUtils}(),np=function(){function GuidGenerator(e){this.cryptoObj=e}return GuidGenerator.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,ip.decimalToHex(e[0])+ip.decimalToHex(e[1])+ip.decimalToHex(e[2])+ip.decimalToHex(e[3])+"-"+ip.decimalToHex(e[4])+ip.decimalToHex(e[5])+"-"+ip.decimalToHex(e[6])+ip.decimalToHex(e[7])+"-"+ip.decimalToHex(e[8])+ip.decimalToHex(e[9])+"-"+ip.decimalToHex(e[10])+ip.decimalToHex(e[11])+ip.decimalToHex(e[12])+ip.decimalToHex(e[13])+ip.decimalToHex(e[14])+ip.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i=fl.EMPTY_STRING,n=0;n<36;n++)"-"!==t[n]&&"4"!==t[n]&&(o=16*Math.random()|0),"x"===t[n]?i+=r[o]:"y"===t[n]?(o&=3,i+=r[o|=8]):i+=t[n];return i}},GuidGenerator.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},GuidGenerator}(),sp=function(){function BrowserStringUtils(){}return BrowserStringUtils.stringToUtf8Arr=function(e){for(var t,r=0,o=e.length,i=0;i<o;i++)r+=(t=e.charCodeAt(i))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var n=new Uint8Array(r),s=0,a=0;s<r;a++)(t=e.charCodeAt(a))<128?n[s++]=t:t<2048?(n[s++]=192+(t>>>6),n[s++]=128+(63&t)):t<65536?(n[s++]=224+(t>>>12),n[s++]=128+(t>>>6&63),n[s++]=128+(63&t)):t<2097152?(n[s++]=240+(t>>>18),n[s++]=128+(t>>>12&63),n[s++]=128+(t>>>6&63),n[s++]=128+(63&t)):t<67108864?(n[s++]=248+(t>>>24),n[s++]=128+(t>>>18&63),n[s++]=128+(t>>>12&63),n[s++]=128+(t>>>6&63),n[s++]=128+(63&t)):(n[s++]=252+(t>>>30),n[s++]=128+(t>>>24&63),n[s++]=128+(t>>>18&63),n[s++]=128+(t>>>12&63),n[s++]=128+(t>>>6&63),n[s++]=128+(63&t));return n},BrowserStringUtils.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return t},BrowserStringUtils.utf8ArrToString=function(e){for(var t=fl.EMPTY_STRING,r=void 0,o=e.length,i=0;i<o;i++)r=e[i],t+=String.fromCharCode(r>251&&r<254&&i+5<o?1073741824*(r-252)+(e[++i]-128<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>247&&r<252&&i+4<o?(r-248<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>239&&r<248&&i+3<o?(r-240<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>223&&r<240&&i+2<o?(r-224<<12)+(e[++i]-128<<6)+e[++i]-128:r>191&&r<224&&i+1<o?(r-192<<6)+e[++i]-128:r);return t},BrowserStringUtils}(),ap=function(){function Base64Encode(){}return Base64Encode.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,fl.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},Base64Encode.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,fl.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},Base64Encode.prototype.encode=function(e){var t=sp.stringToUtf8Arr(e);return this.base64EncArr(t)},Base64Encode.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=fl.EMPTY_STRING,o=void 0,i=e.length,n=0,s=0;s<i;s++)o=s%3,n|=e[s]<<(16>>>o&24),2!==o&&e.length-s!=1||(r+=String.fromCharCode(this.uint6ToB64(n>>>18&63),this.uint6ToB64(n>>>12&63),this.uint6ToB64(n>>>6&63),this.uint6ToB64(63&n)),n=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},Base64Encode.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},Base64Encode}(),lp=function(){function Base64Decode(){}return Base64Decode.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return sp.utf8ArrToString(r)},Base64Decode.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,fl.EMPTY_STRING),o=r.length,i=t?Math.ceil((3*o+1>>>2)/t)*t:3*o+1>>>2,n=new Uint8Array(i),s=void 0,a=void 0,l=0,c=0,d=0;d<o;d++)if(a=3&d,l|=this.b64ToUint6(r.charCodeAt(d))<<18-6*a,3===a||o-d==1){for(s=0;s<3&&c<i;s++,c++)n[c]=l>>>(16>>>s&24)&255;l=0}return n},Base64Decode.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},Base64Decode}(),cp=function(){function PkceGenerator(e){this.base64Encode=new ap,this.cryptoObj=e}return PkceGenerator.prototype.generateCodes=function(){return __awaiter$3(this,void 0,void 0,(function(){var e,t;return __generator$1(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},PkceGenerator.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw uh.createPkceNotGeneratedError(e)}},PkceGenerator.prototype.generateCodeChallengeFromVerifier=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=o.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=o.sent(),uh.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},PkceGenerator}(),dp=new Uint8Array([1,0,1]),up=function(){function BrowserCrypto(e){if(this.logger=e,!this.hasCryptoAPI())throw uh.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256",modulusLength:2048,publicExponent:dp}}return BrowserCrypto.prototype.sha256Digest=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){return t=sp.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest("SHA-256",t):this.getSubtleCryptoDigest("SHA-256",t)]}))}))},BrowserCrypto.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw uh.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},BrowserCrypto.prototype.generateKeyPair=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},BrowserCrypto.prototype.exportJwk=function(e){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey("jwk",e)]}))}))},BrowserCrypto.prototype.importJwk=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i;return __generator$1(this,(function(n){return o=BrowserCrypto.getJwkString(e),i=sp.stringToArrayBuffer(o),[2,this.hasIECrypto()?this.msCryptoImportKey(i,t,r):window.crypto.subtle.importKey("jwk",e,this._keygenAlgorithmOptions,t,r)]}))}))},BrowserCrypto.prototype.sign=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},BrowserCrypto.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},BrowserCrypto.prototype.hasIECrypto=function(){return"msCrypto"in window},BrowserCrypto.prototype.hasBrowserCrypto=function(){return"crypto"in window},BrowserCrypto.prototype.getSubtleCryptoDigest=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},BrowserCrypto.prototype.getMSCryptoDigest=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,new Promise((function(r,o){var i=window.msCrypto.subtle.digest(e,t.buffer);i.addEventListener("complete",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},BrowserCrypto.prototype.msCryptoGenerateKey=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r=this;return __generator$1(this,(function(o){return[2,new Promise((function(o,i){var n=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);n.addEventListener("complete",(function(e){o(e.target.result)})),n.addEventListener("error",(function(e){i(e)}))}))]}))}))},BrowserCrypto.prototype.msCryptoExportJwk=function(e){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return[2,new Promise((function(t,r){var o=window.msCrypto.subtle.exportKey("jwk",e);o.addEventListener("complete",(function(e){var o=e.target.result,i=sp.utf8ArrToString(new Uint8Array(o)).replace(/\r/g,fl.EMPTY_STRING).replace(/\n/g,fl.EMPTY_STRING).replace(/\t/g,fl.EMPTY_STRING).split(" ").join(fl.EMPTY_STRING).replace("\0",fl.EMPTY_STRING);try{t(JSON.parse(i))}catch(e){r(e)}})),o.addEventListener("error",(function(e){r(e)}))}))]}))}))},BrowserCrypto.prototype.msCryptoImportKey=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(i){return[2,new Promise((function(i,n){var s=window.msCrypto.subtle.importKey("jwk",e,o._keygenAlgorithmOptions,t,r);s.addEventListener("complete",(function(e){i(e.target.result)})),s.addEventListener("error",(function(e){n(e)}))}))]}))}))},BrowserCrypto.prototype.msCryptoSign=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r=this;return __generator$1(this,(function(o){return[2,new Promise((function(o,i){var n=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);n.addEventListener("complete",(function(e){o(e.target.result)})),n.addEventListener("error",(function(e){i(e)}))}))]}))}))},BrowserCrypto.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},BrowserCrypto}(),hp=function(){function DatabaseStorage(){this.dbName="msal.db",this.version=1,this.tableName="msal.db.keys",this.dbOpen=!1}return DatabaseStorage.prototype.open=function(){return __awaiter$3(this,void 0,void 0,(function(){var e=this;return __generator$1(this,(function(t){return[2,new Promise((function(t,r){var o=window.indexedDB.open(e.dbName,e.version);o.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),o.addEventListener("success",(function(r){var o=r;e.db=o.target.result,e.dbOpen=!0,t()})),o.addEventListener("error",(function(){return r(uh.createDatabaseUnavailableError())}))}))]}))}))},DatabaseStorage.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},DatabaseStorage.prototype.validateDbIsOpen=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},DatabaseStorage.prototype.getItem=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,o){if(!t.db)return o(uh.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);i.addEventListener("success",(function(e){var o=e;t.closeConnection(),r(o.target.result)})),i.addEventListener("error",(function(e){t.closeConnection(),o(e)}))}))]}}))}))},DatabaseStorage.prototype.setItem=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r=this;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise((function(o,i){if(!r.db)return i(uh.createDatabaseNotOpenError());var n=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);n.addEventListener("success",(function(){r.closeConnection(),o()})),n.addEventListener("error",(function(e){r.closeConnection(),i(e)}))}))]}}))}))},DatabaseStorage.prototype.removeItem=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,o){if(!t.db)return o(uh.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);i.addEventListener("success",(function(){t.closeConnection(),r()})),i.addEventListener("error",(function(e){t.closeConnection(),o(e)}))}))]}}))}))},DatabaseStorage.prototype.getKeys=function(){return __awaiter$3(this,void 0,void 0,(function(){var e=this;return __generator$1(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(uh.createDatabaseNotOpenError());var o=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();o.addEventListener("success",(function(r){var o=r;e.closeConnection(),t(o.target.result)})),o.addEventListener("error",(function(t){e.closeConnection(),r(t)}))}))]}}))}))},DatabaseStorage.prototype.containsKey=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,o){if(!t.db)return o(uh.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);i.addEventListener("success",(function(e){var o=e;t.closeConnection(),r(1===o.target.result)})),i.addEventListener("error",(function(e){t.closeConnection(),o(e)}))}))]}}))}))},DatabaseStorage.prototype.deleteDatabase=function(){return __awaiter$3(this,void 0,void 0,(function(){var e;return __generator$1(this,(function(t){switch(t.label){case 0:return this.db&&this.dbOpen&&this.closeConnection(),[4,window.indexedDB.databases()];case 1:return e=t.sent(),e.find((function(e){return"msal.db"===e.name}))?[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase("msal.db");r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]:[2,!0]}}))}))},DatabaseStorage}(),pp=function(){function AsyncMemoryStorage(e,t){this.inMemoryCache=new Nh,this.indexedDBCache=new hp,this.logger=e,this.storeName=t}return AsyncMemoryStorage.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof uh&&e.errorCode===ih.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},AsyncMemoryStorage.prototype.getItem=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(o){switch(o.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,o.sent()];case 3:return r=o.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},AsyncMemoryStorage.prototype.setItem=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){switch(o.label){case 0:this.inMemoryCache.setItem(e,t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.removeItem=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.getKeys=function(){return __awaiter$3(this,void 0,void 0,(function(){var e,t;return __generator$1(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},AsyncMemoryStorage.prototype.containsKey=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(o){switch(o.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,o.sent()];case 3:return r=o.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},AsyncMemoryStorage.prototype.clear=function(){return __awaiter$3(this,void 0,void 0,(function(){var e,t;return __generator$1(this,(function(r){switch(r.label){case 0:this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted"),this.logger.verbose("Deleting persistent keystore "+this.storeName),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.deleteDatabase()];case 2:return(e=r.sent())&&this.logger.verbose("Persistent keystore "+this.storeName+" deleted"),[2,e];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 4:return[2]}}))}))},AsyncMemoryStorage}();
/*! @azure/msal-browser v2.26.0 2022-06-13 */!function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(Zh||(Zh={}));var fp,gp=function(){function CryptoOps(e,t){this.logger=e,this.browserCrypto=new up(this.logger),this.b64Encode=new ap,this.b64Decode=new lp,this.guidGenerator=new np(this.browserCrypto),this.pkceGenerator=new cp(this.browserCrypto),this.cache={asymmetricKeys:new pp(this.logger,Zh.asymmetricKeys),symmetricKeys:new pp(this.logger,Zh.symmetricKeys)},this.performanceClient=t}return CryptoOps.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},CryptoOps.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},CryptoOps.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},CryptoOps.prototype.generatePkceCodes=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},CryptoOps.prototype.getPublicKeyThumbprint=function(e){var t;return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,n,s,a,l,c;return __generator$1(this,(function(d){switch(d.label){case 0:return r=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(Jd.CryptoOptsGetPublicKeyThumbprint,e.correlationId),[4,this.browserCrypto.generateKeyPair(CryptoOps.EXTRACTABLE,CryptoOps.POP_KEY_USAGES)];case 1:return o=d.sent(),[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return i=d.sent(),n={e:i.e,kty:i.kty,n:i.n},s=up.getJwkString(n),[4,this.hashString(s)];case 3:return a=d.sent(),[4,this.browserCrypto.exportJwk(o.privateKey)];case 4:return l=d.sent(),[4,this.browserCrypto.importJwk(l,!1,["sign"])];case 5:return c=d.sent(),[4,this.cache.asymmetricKeys.setItem(a,{privateKey:c,publicKey:o.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri})];case 6:return d.sent(),r&&r.endMeasurement({success:!0}),[2,a]}}))}))},CryptoOps.prototype.removeTokenBindingKey=function(e){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},CryptoOps.prototype.clearKeystore=function(){return __awaiter$3(this,void 0,void 0,(function(){var e;return __generator$1(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),this.logger.verbose("Deleting in-memory and persistent asymmetric key stores"),[4,this.cache.asymmetricKeys.clear()];case 1:return t.sent(),this.logger.verbose("Successfully deleted asymmetric key stores"),this.logger.verbose("Deleting in-memory and persistent symmetric key stores"),[4,this.cache.symmetricKeys.clear()];case 2:return t.sent(),this.logger.verbose("Successfully deleted symmetric key stores"),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},CryptoOps.prototype.signJwt=function(e,t,r){var o;return __awaiter$3(this,void 0,void 0,(function(){var i,n,s,a,l,c,d,u,h,p,f,g,m;return __generator$1(this,(function(v){switch(v.label){case 0:return i=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(Jd.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(n=v.sent()))throw uh.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(n.publicKey)];case 2:return s=v.sent(),a=up.getJwkString(s),l=this.b64Encode.urlEncode(JSON.stringify({kid:t})),c=lu.getShrHeaderString({kid:l,alg:s.alg}),d=this.b64Encode.urlEncode(c),e.cnf={jwk:JSON.parse(a)},u=this.b64Encode.urlEncode(JSON.stringify(e)),h=d+"."+u,p=sp.stringToArrayBuffer(h),[4,this.browserCrypto.sign(n.privateKey,p)];case 3:return f=v.sent(),g=this.b64Encode.urlEncodeArr(new Uint8Array(f)),m=h+"."+g,i&&i.endMeasurement({success:!0}),[2,m]}}))}))},CryptoOps.prototype.hashString=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=o.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}}))}))},CryptoOps.POP_KEY_USAGES=["sign","verify"],CryptoOps.EXTRACTABLE=!0,CryptoOps}(),mp=function(){function TokenCache(e,t,r,o){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=o}return TokenCache.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw uh.createUnableToLoadTokenError("Please ensure server response includes id token.");if(e.account)this.loadIdToken(t.id_token,e.account.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadAccessToken(e,t,e.account.homeAccountId,e.account.environment,e.account.tenantId,r);else{if(!e.authority)throw uh.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var o=eu.generateAuthority(e.authority,e.azureCloudOptions),i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},n=new eu(o,this.config.system.networkClient,this.storage,i);if(r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(t.id_token,r.clientInfo,n.hostnameAndPort,n.tenant,r),this.loadAccessToken(e,t,r.clientInfo,n.hostnameAndPort,n.tenant,r);else{if(!t.client_info)throw uh.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(t.id_token,t.client_info,n.hostnameAndPort,n.tenant,r),this.loadAccessToken(e,t,t.client_info,n.hostnameAndPort,n.tenant,r)}}},TokenCache.prototype.loadIdToken=function(e,t,r,o,i){var n=Rd.createIdTokenEntity(t,r,e,this.config.auth.clientId,o),s=new pd(e,this.cryptoObj),a=i.clientInfo?hd.createAccount(i.clientInfo,t,s,void 0,void 0,void 0,r):hd.createGenericAccount(t,s,void 0,void 0,void 0,r);if(!this.isBrowserEnvironment)throw uh.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(a),this.storage.setIdTokenCredential(n)},TokenCache.prototype.loadAccessToken=function(e,t,r,o,i,n){if(t.access_token){if(!t.expires_in)throw uh.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!n.extendedExpiresOn)throw uh.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var s=new ud(e.scopes).printScopes(),a=n.expiresOn||t.expires_in+(new Date).getTime()/1e3,l=n.extendedExpiresOn,c=Nd.createAccessTokenEntity(r,o,t.access_token,this.config.auth.clientId,i,s,a,l,this.cryptoObj);if(!this.isBrowserEnvironment)throw uh.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(c)}else this.logger.verbose("TokenCache - No access token provided for caching")},TokenCache}(),vp=function(e){function HybridSpaAuthorizationCodeClient(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return __extends$1(HybridSpaAuthorizationCodeClient,e),HybridSpaAuthorizationCodeClient}(Kd),bp=function(e){function SilentAuthCodeClient(t,r,o,i,n,s,a,l,c,d){var u=e.call(this,t,r,o,i,n,s,l,c,d)||this;return u.apiId=a,u}return __extends$1(SilentAuthCodeClient,e),SilentAuthCodeClient.prototype.acquireToken=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s;return __generator$1(this,(function(a){switch(a.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw uh.createAuthCodeRequiredError();return[4,this.initializeAuthorizationRequest(e,mu.Silent)];case 1:t=a.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||fl.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,4,,5]),o=__assign$1(__assign$1({},t),{code:e.code}),[4,this.getClientConfiguration(r,t.authority)];case 3:return i=a.sent(),n=new vp(i),this.logger.verbose("Auth code client created"),[2,new Xh(n,this.browserStorage,o,this.logger,this.config.system.navigateFrameWait).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,n.authority,this.networkClient,!1)];case 4:throw(s=a.sent())instanceof Gl&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(t.state),s;case 5:return[2]}}))}))},SilentAuthCodeClient.prototype.logout=function(){return Promise.reject(uh.createSilentLogoutUnsupportedError())},SilentAuthCodeClient}(Bh),yp=function(){function BrowserPerformanceMeasurement(e,t){this.correlationId=t,this.measureName="msal.measure."+e+"."+this.correlationId,this.startMark="msal.start."+e+"."+this.correlationId,this.endMark="msal.end."+e+"."+this.correlationId}return BrowserPerformanceMeasurement.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},BrowserPerformanceMeasurement.prototype.startMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}},BrowserPerformanceMeasurement.prototype.endMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}},BrowserPerformanceMeasurement.prototype.flushMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{var e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){var t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch(e){}return null},BrowserPerformanceMeasurement}(),wp=function(e){function BrowserPerformanceClient(t,r,o,i,n,s){var a=e.call(this,t,r,o,i,n,s)||this;return a.browserCrypto=new up(a.logger),a.guidGenerator=new np(a.browserCrypto),a}return __extends$1(BrowserPerformanceClient,e),BrowserPerformanceClient.prototype.startPerformanceMeasuremeant=function(e,t){return new yp(e,t)},BrowserPerformanceClient.prototype.generateId=function(){return this.guidGenerator.generateGuid()},BrowserPerformanceClient.prototype.getPageVisibility=function(){var e;return(null===(e=document.visibilityState)||void 0===e?void 0:e.toString())||null},BrowserPerformanceClient.prototype.startMeasurement=function(t,r){var o=this,i=this.getPageVisibility(),n=e.prototype.startMeasurement.call(this,t,r);return __assign$1(__assign$1({},n),{endMeasurement:function(e){return n.endMeasurement(__assign$1({startPageVisibility:i,endPageVisibility:o.getPageVisibility()},e))}})},BrowserPerformanceClient}(bu),Cp=function(){function ClientApplication(e){var t,r,o;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function buildConfiguration(e,t){var r=e.auth,o=e.cache,i=e.system,n=e.telemetry,s={clientId:fl.EMPTY_STRING,authority:""+fl.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:fl.EMPTY_STRING,authorityMetadata:fl.EMPTY_STRING,redirectUri:fl.EMPTY_STRING,postLogoutRedirectUri:fl.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:qd.AAD,azureCloudOptions:{azureCloudInstance:Uc.None,tenant:fl.EMPTY_STRING}},a={cacheLocation:uu.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},l={loggerCallback:function(){},logLevel:jl.Info,piiLoggingEnabled:!1},c=__assign$1(__assign$1({},md),{loggerOptions:l,networkClient:t?Fh.getBrowserNetworkClient():iu,navigationClient:new Jh,loadFrameTimeout:0,windowHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e4,iframeHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e3,navigateFrameWait:t&&Fh.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==i?void 0:i.nativeBrokerHandshakeTimeout)||2e3}),d={application:{appName:fl.EMPTY_STRING,appVersion:fl.EMPTY_STRING}};return{auth:__assign$1(__assign$1({},s),r),cache:__assign$1(__assign$1({},a),o),system:__assign$1(__assign$1({},c),i),telemetry:__assign$1(__assign$1({},d),n)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new Fc(this.config.system.loggerOptions,Mh,"2.26.0"),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new wp(this.config.auth.clientId,this.config.auth.authority,this.logger,Mh,"2.26.0",this.config.telemetry.application):new wu(this.config.auth.clientId,this.config.auth.authority,this.logger,Mh,"2.26.0",this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new gp(this.logger,this.performanceClient):Kl,this.eventHandler=new op(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Lh(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(t=this.config.auth.clientId,r=this.logger,o={cacheLocation:uu.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},new Lh(t,o,Kl,r)),this.tokenCache=new mp(this.config,this.browserStorage,this.logger,this.browserCrypto)}return ClientApplication.prototype.initialize=function(){return __awaiter$3(this,void 0,void 0,(function(){var e,t;return __generator$1(this,(function(r){switch(r.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(this.eventHandler.emitEvent(Th.INITIALIZE_START),!this.config.system.allowNativeBroker)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this,[4,Wh.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout)];case 2:return e.nativeExtensionProvider=r.sent(),[3,4];case 3:return t=r.sent(),this.logger.verbose(t),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(Th.INITIALIZE_END),[2]}}))}))},ClientApplication.prototype.handleRedirectPromise=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s,a,l,c=this;return __generator$1(this,(function(d){return this.logger.verbose("handleRedirectPromise called"),Fh.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||fl.EMPTY_STRING,void 0===(o=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(Th.HANDLE_REDIRECT_START,mu.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),i=this.browserStorage.getCachedNativeRequest(),n=void 0,i&&Wh.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),s=new Kh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,gu.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,i.accountId,i.correlationId),n=s.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),a=this.browserStorage.getTemporaryCache(pu.CORRELATION_ID,!0)||fl.EMPTY_STRING,l=this.createRedirectClient(a),n=l.handleRedirectPromise(e)),o=n.then((function(e){e&&(t.length<c.getAllAccounts().length?(c.eventHandler.emitEvent(Th.LOGIN_SUCCESS,mu.Redirect,e),c.logger.verbose("handleRedirectResponse returned result, login success")):(c.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_SUCCESS,mu.Redirect,e),c.logger.verbose("handleRedirectResponse returned result, acquire token success")));return c.eventHandler.emitEvent(Th.HANDLE_REDIRECT_END,mu.Redirect),e})).catch((function(e){throw t.length>0?c.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_FAILURE,mu.Redirect,null,e):c.eventHandler.emitEvent(Th.LOGIN_FAILURE,mu.Redirect,null,e),c.eventHandler.emitEvent(Th.HANDLE_REDIRECT_END,mu.Redirect),e})),this.redirectResponse.set(r,o)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,o]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},ClientApplication.prototype.acquireTokenRedirect=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s=this;return __generator$1(this,(function(a){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(mu.Redirect),(r=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_START,mu.Redirect,e):this.eventHandler.emitEvent(Th.LOGIN_START,mu.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(i=new Kh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,gu.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),e.correlationId),o=i.acquireTokenRedirect(e).catch((function(t){if(t instanceof Gh&&t.isFatal())return s.nativeExtensionProvider=void 0,s.createRedirectClient(e.correlationId).acquireToken(e);throw t}))):(n=this.createRedirectClient(e.correlationId),o=n.acquireToken(e)),[2,o.catch((function(e){throw r?s.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_FAILURE,mu.Redirect,null,e):s.eventHandler.emitEvent(Th.LOGIN_FAILURE,mu.Redirect,null,e),e}))]}))}))},ClientApplication.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),o=this.performanceClient.startMeasurement(Jd.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(mu.Popup)}catch(e){return Promise.reject(e)}var i,n=this.getAllAccounts();(n.length>0?this.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_START,mu.Popup,e):this.eventHandler.emitEvent(Th.LOGIN_START,mu.Popup,e),this.canUseNative(e))?i=this.acquireTokenNative(e,gu.acquireTokenPopup).then((function(e){return t.browserStorage.setInteractionInProgress(!1),o.endMeasurement({success:!0,isNativeBroker:!0}),o.flushMeasurement(),e})).catch((function(r){if(r instanceof Gh&&r.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);throw r})):i=this.createPopupClient(e.correlationId).acquireToken(e);return i.then((function(e){return n.length<t.getAllAccounts().length?t.eventHandler.emitEvent(Th.LOGIN_SUCCESS,mu.Popup,e):t.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_SUCCESS,mu.Popup,e),o.endMeasurement({success:!0}),o.flushMeasurement(),e})).catch((function(e){return n.length>0?t.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_FAILURE,mu.Popup,null,e):t.eventHandler.emitEvent(Th.LOGIN_FAILURE,mu.Popup,null,e),o.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),o.flushMeasurement(),Promise.reject(e)}))},ClientApplication.prototype.ssoSilent=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s=this;return __generator$1(this,(function(a){return t=this.getRequestCorrelationId(e),r=__assign$1(__assign$1({},e),{prompt:bl.NONE,correlationId:t}),this.preflightBrowserEnvironmentCheck(mu.Silent),o=this.performanceClient.startMeasurement(Jd.SsoSilent,t),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(Th.SSO_SILENT_START,mu.Silent,r),this.canUseNative(r)?i=this.acquireTokenNative(r,gu.ssoSilent).catch((function(e){if(e instanceof Gh&&e.isFatal())return s.nativeExtensionProvider=void 0,s.createSilentIframeClient(r.correlationId).acquireToken(r);throw e})):(n=this.createSilentIframeClient(r.correlationId),i=n.acquireToken(r)),[2,i.then((function(e){return s.eventHandler.emitEvent(Th.SSO_SILENT_SUCCESS,mu.Silent,e),o.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker}),o.flushMeasurement(),e})).catch((function(e){throw s.eventHandler.emitEvent(Th.SSO_SILENT_FAILURE,mu.Silent,null,e),o.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),o.flushMeasurement(),e}))]}))}))},ClientApplication.prototype.acquireTokenByCode=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n=this;return __generator$1(this,(function(s){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(mu.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_BY_CODE_START,mu.Silent,e),r=this.performanceClient.startMeasurement(Jd.AcquireTokenByCode,e.correlationId);try{if(e.code)return o=e.code,(i=this.hybridAuthCodeResponses.get(o))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.endMeasurement({success:!0}),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync(__assign$1(__assign$1({},e),{correlationId:t})).then((function(e){return n.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_BY_CODE_SUCCESS,mu.Silent,e),n.hybridAuthCodeResponses.delete(o),r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker}),r.flushMeasurement(),e})).catch((function(e){throw n.hybridAuthCodeResponses.delete(o),n.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_BY_CODE_FAILURE,mu.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),r.flushMeasurement(),e})),this.hybridAuthCodeResponses.set(o,i)),[2,i];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,gu.acquireTokenByCode,e.nativeAccountId).catch((function(e){throw e instanceof Gh&&e.isFatal()&&(n.nativeExtensionProvider=void 0),e}))];throw uh.createUnableToAcquireTokenFromNativePlatformError()}throw uh.createAuthCodeOrNativeAccountIdRequiredError()}catch(e){throw this.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_BY_CODE_FAILURE,mu.Silent,null,e),r.endMeasurement({errorCode:e instanceof Gl&&e.errorCode||void 0,subErrorCode:e instanceof Gl&&e.subError||void 0,success:!1}),e}return[2]}))}))},ClientApplication.prototype.acquireTokenByCodeAsync=function(e){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e)];case 1:return[2,t.sent()]}}))}))},ClientApplication.prototype.acquireTokenByRefreshToken=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r=this;return __generator$1(this,(function(o){return Fh.blockReloadInHiddenIframes(),t=this.performanceClient.startMeasurement(Jd.AcquireTokenByRefreshToken,e.correlationId),this.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_NETWORK_START,mu.Silent,e),[2,this.createSilentRefreshClient(e.correlationId).acquireToken(e).then((function(e){return t.endMeasurement({success:!0,fromCache:e.fromCache}),e})).catch((function(o){var i=o instanceof _d,n=o instanceof Ud,s=o.errorCode===hh;if(i&&s&&!n)return r.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",e.correlationId),r.createSilentIframeClient(e.correlationId).acquireToken(e).then((function(e){return t.endMeasurement({success:!0,fromCache:e.fromCache}),e})).catch((function(e){throw t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}));throw t.endMeasurement({success:!1}),o}))]}))}))},ClientApplication.prototype.logout=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(__assign$1({correlationId:t},e))]}))}))},ClientApplication.prototype.logoutRedirect=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(mu.Redirect),[2,this.createRedirectClient(t).logout(e)]}))}))},ClientApplication.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(mu.Popup),this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}},ClientApplication.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},ClientApplication.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!$c.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!$c.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter((function(t){return t.homeAccountId===e}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!$c.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter((function(t){return t.localAccountId===e}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},ClientApplication.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},ClientApplication.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},ClientApplication.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),Fh.blockNonBrowserEnvironment(this.isBrowserEnvironment),Fh.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),Fh.blockReloadInHiddenIframes(),Fh.blockAcquireTokenInPopups(),Fh.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===mu.Redirect&&this.config.cache.cacheLocation===uu.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Rh.createInMemoryRedirectUnavailableError();e!==mu.Redirect&&e!==mu.Popup||this.preflightInteractiveRequest(t)},ClientApplication.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),Fh.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},ClientApplication.prototype.acquireTokenNative=function(e,t,r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw uh.createNativeConnectionNotEstablishedError();return[2,new Kh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),e.correlationId).acquireToken(e)]}))}))},ClientApplication.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!Wh.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case bl.NONE:case bl.CONSENT:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},ClientApplication.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},ClientApplication.prototype.createPopupClient=function(e){return new Yh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},ClientApplication.prototype.createRedirectClient=function(e){return new Qh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},ClientApplication.prototype.createSilentIframeClient=function(e){return new ep(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,gu.ssoSilent,this.performanceClient,this.nativeExtensionProvider,e)},ClientApplication.prototype.createSilentCacheClient=function(e){return new tp(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},ClientApplication.prototype.createSilentRefreshClient=function(e){return new rp(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},ClientApplication.prototype.createSilentAuthCodeClient=function(e){return new bp(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,gu.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},ClientApplication.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},ClientApplication.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},ClientApplication.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},ClientApplication.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},ClientApplication.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},ClientApplication.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},ClientApplication.prototype.getTokenCache=function(){return this.tokenCache},ClientApplication.prototype.getLogger=function(){return this.logger},ClientApplication.prototype.setLogger=function(e){this.logger=e},ClientApplication.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},ClientApplication.prototype.setNavigationClient=function(e){this.navigationClient=e},ClientApplication.prototype.getConfiguration=function(){return this.config},ClientApplication.prototype.getRequestCorrelationId=function(e){return(null==e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():fl.EMPTY_STRING},ClientApplication}(),kp=function(e){function PublicClientApplication(t){var r=e.call(this,t)||this;return r.activeSilentTokenRequests=new Map,r}return __extends$1(PublicClientApplication,e),PublicClientApplication.prototype.loginRedirect=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(__assign$1({correlationId:t},e||kh))]}))}))},PublicClientApplication.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(__assign$1({correlationId:t},e||kh))},PublicClientApplication.prototype.acquireTokenSilent=function(e){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,n,s,a,l=this;return __generator$1(this,(function(c){if(t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(Jd.AcquireTokenSilent,t),this.preflightBrowserEnvironmentCheck(mu.Silent),this.logger.verbose("acquireTokenSilent called",t),!(o=e.account||this.getActiveAccount()))throw uh.createNoAccountError();return i={clientId:this.config.auth.clientId,authority:e.authority||fl.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},n=JSON.stringify(i),void 0===(s=this.activeSilentTokenRequests.get(n))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),a=this.acquireTokenSilentAsync(__assign$1(__assign$1({},e),{correlationId:t}),o).then((function(e){return l.activeSilentTokenRequests.delete(n),r.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),r.flushMeasurement(),e})).catch((function(e){throw l.activeSilentTokenRequests.delete(n),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),r.flushMeasurement(),e})),this.activeSilentTokenRequests.set(n,a),[2,a]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.endMeasurement({success:!0}),r.discardMeasurement(),[2,s])}))}))},PublicClientApplication.prototype.acquireTokenSilentAsync=function(e,t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,n,s,a=this;return __generator$1(this,(function(l){switch(l.label){case 0:return this.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_START,mu.Silent,e),r=this.performanceClient.startMeasurement(Jd.AcquireTokenSilentAsync,e.correlationId),Wh.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),i=__assign$1(__assign$1({},e),{account:t}),o=this.acquireTokenNative(i,gu.acquireTokenSilent_silentFlow).catch((function(t){return __awaiter$3(a,void 0,void 0,(function(){return __generator$1(this,(function(r){if(t instanceof Gh&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),[4,(n=this.createSilentCacheClient(e.correlationId)).initializeSilentRequest(e,t)];case 2:s=l.sent(),o=n.acquireToken(s).catch((function(){return __awaiter$3(a,void 0,void 0,(function(){return __generator$1(this,(function(e){return[2,this.acquireTokenByRefreshToken(s)]}))}))})),l.label=3;case 3:return[2,o.then((function(e){return a.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_SUCCESS,mu.Silent,e),r.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e})).catch((function(e){throw a.eventHandler.emitEvent(Th.ACQUIRE_TOKEN_FAILURE,mu.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},PublicClientApplication}(Cp),__awaiter$1=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};
/*! @azure/msal-browser v2.26.0 2022-06-13 */!function(e){e.SELECT_ACCOUNT="select_account",e.LOGIN="login",e.CONSENT="consent"}(fp||(fp={}));class Msal2Provider extends IProvider{constructor(e){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.homeAccountKey="275f3731-e4a4-468a-bf9c-baca24b31e26",this.initProvider(e)}get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}initProvider(e){return __awaiter$1(this,void 0,void 0,(function*(){const t=e.options||{auth:{clientId:""}};if(this.ms_config=t,this.ms_config.cache=t.cache||{},this.ms_config.cache.cacheLocation=t.cache.cacheLocation||"localStorage",void 0!==this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,e.authority&&(this.ms_config.auth.authority=e.authority),e.redirectUri&&(this.ms_config.auth.redirectUri=e.redirectUri),"clientId"in e){if(!e.clientId)throw new Error("clientId must be provided");this.ms_config.auth.clientId=e.clientId,this._publicClientApplication=new kp(this.ms_config)}else{if(!("publicClientApplication"in e))throw new Error("either clientId or publicClientApplication must be provided");if(!e.publicClientApplication)throw new Error("publicClientApplication must be provided");this._publicClientApplication=e.publicClientApplication}this._loginType=void 0!==e.loginType?e.loginType:rr.Redirect,this._loginHint=void 0!==e.loginHint?e.loginHint:null,this._sid=void 0!==e.sid?e.sid:null,this.isIncrementalConsentDisabled=void 0!==e.isIncrementalConsentDisabled&&e.isIncrementalConsentDisabled,this._domainHint=void 0!==e.domainHint?e.domainHint:null,this.scopes=void 0!==e.scopes?e.scopes:["user.read"],this._prompt=void 0!==e.prompt?e.prompt:fp.SELECT_ACCOUNT,this.graph=createFromProvider(this);try{const e=yield this._publicClientApplication.handleRedirectPromise();null!==e?this.handleResponse(null==e?void 0:e.account):this.trySilentSignIn()}catch(e){throw e}}))}trySilentSignIn(){return __awaiter$1(this,void 0,void 0,(function*(){let e={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){e.sid=this._sid,e.loginHint=this._loginHint;try{this.setState(or.Loading);const t=yield this._publicClientApplication.ssoSilent(e);t&&this.handleResponse(null==t?void 0:t.account)}catch(e){this.setState(or.SignedOut)}}else{const e=this.getAccount();if(e&&(yield this.getAccessToken(null)))return void this.handleResponse(e);this.setState(or.SignedOut)}}))}login(){return __awaiter$1(this,void 0,void 0,(function*(){const e={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType==rr.Popup){const t=yield this._publicClientApplication.loginPopup(e);this.handleResponse(null==t?void 0:t.account)}else{const t=Object.assign({},e);this._publicClientApplication.loginRedirect(t)}}))}getAllAccounts(){let e=[];return this._publicClientApplication.getAllAccounts().forEach((t=>{e.push({username:t.username,id:t.homeAccountId})})),e}setActiveAccount(e){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(e.id)),this.setStoredAccount(),super.setActiveAccount(e)}handleResponse(e){null!==e?(this.setActiveAccount({username:e.name,id:e.homeAccountId}),this.setState(or.SignedIn)):this.setState(or.SignedOut),this.clearRequestedScopes()}setStoredAccount(){this.clearStoredAccount(),window[this.ms_config.cache.cacheLocation].setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){let e=null;return e=window[this.ms_config.cache.cacheLocation].getItem(this.homeAccountKey),this._publicClientApplication.getAccountByHomeId(e)}clearStoredAccount(){window[this.ms_config.cache.cacheLocation].removeItem(this.homeAccountKey)}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let r=t.indexOf("openid");-1!==r&&t.splice(r,1),r=t.indexOf("profile"),-1!==r&&t.splice(r,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){const e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){const t=this.getDeniedScopes();if(t&&t.filter((t=>-1!==e.indexOf(t))).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){const e=this.getStoredAccount();return e||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return __awaiter$1(this,void 0,void 0,(function*(){const e={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType==rr.Redirect?(this._publicClientApplication.logoutRedirect(e),this.setState(or.SignedOut)):(yield this._publicClientApplication.logoutPopup(Object.assign({},e)),this.setState(or.SignedOut))}))}getAccessToken(e){return __awaiter$1(this,void 0,void 0,(function*(){const t=e&&e.scopes||this.scopes,r={scopes:t,account:this.getAccount()};try{const e=r;return(yield this._publicClientApplication.acquireTokenSilent(e)).accessToken}catch(e){if(e instanceof Ud){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===rr.Redirect){if(this.areScopesDenied(t))throw e;this.setRequestedScopes(t),this._publicClientApplication.acquireTokenRedirect(r)}else try{return(yield this._publicClientApplication.acquireTokenPopup(r)).accessToken}catch(e){throw e}}else this.setState(or.SignedOut)}throw null}))}}var __decorate$1=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata$1=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Tp=class MgtMsal2Provider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const e={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){let t=this.loginType.toLowerCase();t=t[0].toUpperCase()+t.slice(1);const r=rr[t];e.loginType=r}if(this.authority&&(e.authority=this.authority),this.scopes){const t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}if(this.redirectUri&&(e.redirectUri=this.redirectUri),this.prompt){let t=this.prompt.toUpperCase();const r=fp[t];e.prompt=r}this.isIncrementalConsentDisabled&&(e.isIncrementalConsentDisabled=!0),this.provider=new Msal2Provider(e),Providers.globalProvider=this.provider}}};__decorate$1([property({attribute:"client-id",type:String}),__metadata$1("design:type",Object)],Tp.prototype,"clientId",void 0),__decorate$1([property({attribute:"login-type",type:String}),__metadata$1("design:type",Object)],Tp.prototype,"loginType",void 0),__decorate$1([property(),__metadata$1("design:type",Object)],Tp.prototype,"authority",void 0),__decorate$1([property({attribute:"scopes",type:String}),__metadata$1("design:type",Object)],Tp.prototype,"scopes",void 0),__decorate$1([property({attribute:"redirect-uri",type:String}),__metadata$1("design:type",Object)],Tp.prototype,"redirectUri",void 0),__decorate$1([property({attribute:"prompt",type:String}),__metadata$1("design:type",String)],Tp.prototype,"prompt",void 0),__decorate$1([property({attribute:"incremental-consent-disabled",type:Boolean}),__metadata$1("design:type",Boolean)],Tp.prototype,"isIncrementalConsentDisabled",void 0),Tp=__decorate$1([customElement("mgt-msal2-provider")],Tp);var _p,__awaiter=function(e,t,r,o){return new(r||(r=Promise))((function(i,n){function fulfilled(e){try{step(o.next(e))}catch(e){n(e)}}function rejected(e){try{step(o.throw(e))}catch(e){n(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))};!function(e){e.GET="GET",e.POST="POST"}(_p||(_p={}));class TeamsMsal2Provider extends Msal2Provider{constructor(e){super({clientId:e.clientId,loginType:rr.Redirect,options:e.msalOptions,scopes:e.scopes}),this.clientId=e.clientId,this._msalOptions=e.msalOptions,this._authPopupUrl=e.authPopupUrl,this._ssoUrl=e.ssoUrl,this._autoConsent=void 0===e.autoConsent||e.autoConsent,this._httpMethod=void 0!==e.httpMethod?e.httpMethod:_p.GET;TeamsHelper.microsoftTeamsLib.initialize(),this._ssoUrl&&this.internalLogin()}static get isAvailable(){return TeamsHelper.isAvailable}static get microsoftTeamsLib(){return TeamsHelper.microsoftTeamsLib}static set microsoftTeamsLib(e){TeamsHelper.microsoftTeamsLib=e}get name(){return"MgtTeamsMsal2Provider"}static handleAuth(){return __awaiter(this,void 0,void 0,(function*(){const e=TeamsHelper.microsoftTeamsLib;if(!e)return void console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsMsal2Provider");e.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&e.authentication.notifySuccess();const t=new URL(window.location.href).searchParams.get("signout"),r=localStorage.getItem(this._localStorageParametersKey);let o;if(o=r?JSON.parse(r):{},!o.clientId)return void e.authentication.notifyFailure("no clientId provided");const i=o.scopes?o.scopes.split(","):null,n=o.isConsent?fp.CONSENT:fp.SELECT_ACCOUNT,s=o.options||{auth:{clientId:o.clientId}};s.system=s.system||{},s.system.loadFrameTimeout=1e4;const a=new Msal2Provider({clientId:o.clientId,options:s,scopes:i,loginHint:o.loginHint,prompt:n}),handleProviderState=()=>__awaiter(this,void 0,void 0,(function*(){if(a.state===or.SignedOut){if(t)return void e.authentication.notifySuccess();if(!sessionStorage.getItem(this._sessionStorageLoginInProgress)){window.parent!==window?console.warn("handleProviderState - Is in iframe... will try to login anyway... but will not set session storage variable"):sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),a.login()}}else if(a.state===or.SignedIn){if(t)return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),void(yield a.logout());try{const t=yield a.getAccessTokenForScopes(...a.scopes);e.authentication.notifySuccess(t)}catch(t){e.authentication.notifyFailure(t)}}}));a.onStateChanged(handleProviderState),handleProviderState()}))}login(){return __awaiter(this,void 0,void 0,(function*(){if(this._ssoUrl&&!this._needsConsent)return;this.setState(or.Loading);const e=TeamsHelper.microsoftTeamsLib;return new Promise(((t,r)=>{e.getContext((o=>{this.teamsContext=o;const i={clientId:this.clientId,loginHint:o.loginHint,options:this._msalOptions,scopes:this.scopes.join(","),isConsent:this._autoConsent};localStorage.setItem(TeamsMsal2Provider._localStorageParametersKey,JSON.stringify(i));const n=new URL(this._authPopupUrl,new URL(window.location.href));e.authentication.authenticate({failureCallback:e=>{this.setState(or.SignedOut),r()},successCallback:e=>{this._ssoUrl?(this.setState(or.SignedIn),t()):(this.trySilentSignIn(),t())},url:n.href})}))}))}))}logout(){return __awaiter(this,void 0,void 0,(function*(){if(this._ssoUrl)return;const e=TeamsHelper.microsoftTeamsLib;return new Promise(((t,r)=>{e.getContext((o=>{this.teamsContext=o;const i=new URL(this._authPopupUrl,new URL(window.location.href));i.searchParams.append("signout","true"),e.authentication.authenticate({failureCallback:e=>{this.trySilentSignIn(),r()},successCallback:e=>{this.trySilentSignIn(),t()},url:i.href})}))}))}))}getAccessToken(e){return __awaiter(this,void 0,void 0,(function*(){if(!this.teamsContext&&TeamsHelper.microsoftTeamsLib){TeamsHelper.microsoftTeamsLib.initialize(),this.teamsContext=yield this.getTeamsContext()}const t=e&&e.scopes||this.scopes;if(!this._ssoUrl)return new Promise(((e,r)=>__awaiter(this,void 0,void 0,(function*(){const o={scopes:t,account:this.getAccount()};try{const t=yield this.publicClientApplication.acquireTokenSilent(o);e(t.accessToken)}catch(t){t instanceof Ud?e(null):r(t)}}))));{const e=yield this.getClientToken();let r,o=new URL(this._ssoUrl,new URL(window.location.href));if(this._httpMethod===_p.GET){const i=new URLSearchParams({ssoToken:e,scopes:t.join(","),clientId:this.clientId});r=yield fetch(`${o.href}?${i}`,{method:"GET",mode:"cors",cache:"default"})}else r=yield fetch(o.href,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${e}`},body:JSON.stringify({scopes:t,clientid:this.clientId}),mode:"cors",cache:"default"});const i=yield r.json().catch(this.unhandledFetchError);if(r.ok||"consent_required"!==i.error){if(r.ok)return this._needsConsent=!1,i.access_token;throw i}this._needsConsent=!0}}))}internalLogin(){return __awaiter(this,void 0,void 0,(function*(){if(yield this.getAccessToken(null))this.setState(or.SignedIn);else if(this._needsConsent){if(this._autoConsent){if(this.scopes)return void this.login();throw new Error("For auto consent, scopes must be provided")}throw new Error("Auto consent is not configured. You need to consent to additional scopes")}}))}getClientToken(){return __awaiter(this,void 0,void 0,(function*(){const e=TeamsHelper.microsoftTeamsLib;return new Promise(((t,r)=>{e.authentication.getAuthToken({successCallback:e=>{t(e)},failureCallback:e=>{this.setState(or.SignedOut),r()}})}))}))}getTeamsContext(){return __awaiter(this,void 0,void 0,(function*(){return new Promise((e=>{const t=TeamsHelper.microsoftTeamsLib;t.initialize(),t.getContext((t=>{e(t)}))}))}))}unhandledFetchError(e){console.error(`There was an error during the server side token exchange:${e}`)}}TeamsMsal2Provider._localStorageParametersKey="msg-TeamsMsal2Provider-auth-parameters",TeamsMsal2Provider._sessionStorageLoginInProgress="msg-TeamsMsal2Provider-login-in-progress",TeamsMsal2Provider._sessionStorageLogoutInProgress="msg-TeamsMsal2Provider-logout-in-progress";var __decorate=function(e,t,r,o){var i,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n<3?i(s):n>3?i(t,r,s):i(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Sp=class MgtTeamsMsal2Provider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId="",this.authPopupUrl="",this.ssoUrl=""}get isAvailable(){return TeamsMsal2Provider.isAvailable}initializeProvider(){if(this.clientId&&this.authPopupUrl){const e={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){const t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}if(this.authority){const t={auth:{authority:this.authority,clientId:this.clientId}};e.msalOptions=t}if(this.ssoUrl&&(e.ssoUrl=this.ssoUrl),this.isAutoConsentDisabled&&(e.autoConsent=!1),this.httpMethod){let t=this.httpMethod.toUpperCase();const r=_p[t];e.httpMethod=r}this.provider=new TeamsMsal2Provider(e),Providers.globalProvider=this.provider}}};__decorate([property({attribute:"client-id",type:String}),__metadata("design:type",Object)],Sp.prototype,"clientId",void 0),__decorate([property({attribute:"auth-popup-url",type:String}),__metadata("design:type",Object)],Sp.prototype,"authPopupUrl",void 0),__decorate([property({attribute:"sso-url",type:String}),__metadata("design:type",Object)],Sp.prototype,"ssoUrl",void 0),__decorate([property(),__metadata("design:type",Object)],Sp.prototype,"authority",void 0),__decorate([property({attribute:"scopes",type:String}),__metadata("design:type",Object)],Sp.prototype,"scopes",void 0),__decorate([property({attribute:"auto-consent-disabled",type:Boolean}),__metadata("design:type",Object)],Sp.prototype,"isAutoConsentDisabled",void 0),__decorate([property({attribute:"http-method",type:String}),__metadata("design:type",Object)],Sp.prototype,"httpMethod",void 0),Sp=__decorate([customElement("mgt-teams-msal2-provider")],Sp);export{BatchResponse,BetaGraph,CacheService,CacheStore,nr as ComponentMediaQuery,EventDispatcher,Graph,GraphPageIterator,aa as GroupType,_p as HttpMethod,IProvider,LocalizationHelper,rr as LoginType,Xr as MgtAgenda,MgtBaseComponent,MgtBaseProvider,io as MgtFile,ta as MgtFileList,Zs as MgtFileUpload,oa as MgtGet,sa as MgtLogin,vr as MgtMockProvider,Tp as MgtMsal2Provider,sl as MgtMsalProvider,Zr as MgtPeople,ha as MgtPeoplePicker,Gr as MgtPerson,$a as MgtPersonCard,ll as MgtProxyProvider,Wa as MgtTasks,Za as MgtTeamsChannelPicker,Sp as MgtTeamsMsal2Provider,al as MgtTeamsProvider,MgtTemplatedComponent,nl as MgtTodo,MockProvider,Msal2Provider,MsalProvider,Hr as PersonCardInteraction,Dr as PersonType,zr as PersonViewType,fp as PromptType,or as ProviderState,Providers,ir as ProvidersChangedState,ProxyProvider,ra as ResponseType,SharePointProvider,SimpleProvider,ja as TasksSource,TeamsHelper,TeamsMsal2Provider,TeamsProvider,TemplateHelper,Lr as UserType,Mr as ViewType,arraysAreEqual,jr as avatarType,chainMiddleware,createFromProvider,equals,prepScopes};
