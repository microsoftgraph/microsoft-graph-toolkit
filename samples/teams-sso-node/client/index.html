<!-- Copyright (c) Microsoft Corporation.
Licensed under the MIT License. -->

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
  <title>Teams SSO Sample for Microsoft Graph Toolkit in Node.js</title>

  <script src="https://unpkg.com/@microsoft/teams-js/dist/MicrosoftTeams.min.js" crossorigin="anonymous"></script>
  <script src="./mgt/mgt-loader.js"></script>
</head>

<body>
  <main id="main-container" role="main" class="container">
    <!-- One way of using the TeamsSSOProvider with SSO is to use the component provider as below  -->
    <!-- <mgt-teams-sso-provider client-id="{ YOUR CLIENT ID }"
      scopes="user.read,user.read.all,mail.readBasic,people.read.all,sites.read.all,user.readbasic.all,contacts.read,presence.read,presence.read.all,tasks.readwrite,tasks.read"
      sso-url="/api/token" http-method="POST">
    </mgt-teams-sso-provider> -->

    <h2>Person component</h2>
    <mgt-person person-query="me" view="twoLines" person-card="hover" show-presence></mgt-person>
    <h2>Todo component</h2>
    <mgt-todo></mgt-todo>
  </main>

  <script>
    // This is the way to use the TeamsProvider with SSO in code
    const scopes = [
      'user.read',
      'user.read.all',
      'mail.readBasic',
      'people.read.all',
      'sites.read.all',
      'user.readbasic.all',
      'contacts.read',
      'presence.read',
      'presence.read.all',
      'tasks.readwrite',
      'tasks.read'
    ];
    const config = {
      authPopupUrl: '/auth.html',
      ssoUrl: '/api/token',
      clientId: '{ YOUR CLIENT ID }',
      scopes: scopes,
      autoConsent: true,
      httpMethod: mgt.HttpMethod.POST
    };
    const provider = new mgt.TeamsSSOProvider(config);
    mgt.Providers.globalProvider = provider;
  </script>
</body>

</html>